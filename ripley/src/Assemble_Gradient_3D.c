Ripley_Assemble_Gradient_3D(Ripley_Grid *grid, Escript in, Escript out)
{
   /* GENERATOR SNIP TOP */
   if (out_data_type==RIPLEY_ELEMENTS) {
      const double tmp0_70 = -0.1/h2;
      const double tmp0_52 = 0.056350832689629155741/h1;
      const double tmp0_82 = 0.44364916731037084426/h2;
      const double tmp0_1 = -0.1/h0;
      const double tmp0_72 = 0.78729833462074168852/h2;
      const double tmp0_49 = 0.25/h1;
      const double tmp0_50 = -0.056350832689629155741/h1;
      const double tmp0_3 = -0.012701665379258311482/h0;
      const double tmp0_74 = -0.78729833462074168852/h2;
      const double tmp0_39 = 0.44364916731037084426/h1;
      const double tmp0_56 = -0.78729833462074168852/h1;
      const double tmp0_76 = -0.012701665379258311482/h2;
      const double tmp0_54 = -0.012701665379258311483/h1;
      const double tmp0_78 = -0.25/h2;
      const double tmp0_35 = 0.012701665379258311482/h1;
      const double tmp0_41 = -0.012701665379258311482/h1;
      const double tmp0_37 = -0.056350832689629155741/h1;
      const double tmp0_28 = 0.012701665379258311482/h0;
      const double tmp0_43 = 0.012701665379258311482/h1;
      const double tmp0_31 = -0.1/h1;
      const double tmp0_45 = 0.78729833462074168852/h1;
      const double tmp0_33 = 0.1/h1;
      const double tmp0_47 = 0.1/h1;
      const double tmp0_22 = -0.44364916731037084426/h0;
      const double tmp0_17 = 0.1/h0;
      const double tmp0_20 = -0.056350832689629155741/h0;
      const double tmp0_15 = 0.78729833462074168852/h0;
      const double tmp0_26 = 0.1/h0;
      const double tmp0_13 = -0.1/h0;
      const double tmp0_24 = -0.012701665379258311483/h0;
      const double tmp0_11 = -0.012701665379258311482/h0;
      const double tmp0_89 = 0.78729833462074168852/h2;
      const double tmp0_68 = 0.056350832689629155741/h2;
      const double tmp0_8 = 0.056350832689629155741/h0;
      const double tmp0_66 = -0.44364916731037084426/h2;
      const double tmp0_85 = 0.012701665379258311483/h2;
      const double tmp0_64 = -0.012701665379258311482/h2;
      const double tmp0_59 = 0.78729833462074168852/h1;
      const double tmp0_87 = -0.1/h2;
      const double tmp0_4 = 0.78729833462074168852/h0;
      const double tmp0_19 = 0.25/h0;
      const double tmp0_62 = 0.1/h2;
      const double tmp0_81 = 0.056350832689629155741/h2;
      const double tmp0_6 = -0.44364916731037084426/h0;
      const double tmp0_60 = -0.78729833462074168852/h2;
      const double tmp0_83 = -0.44364916731037084426/h2;
      const double tmp0_0 = -0.78729833462074168852/h0;
      const double tmp0_71 = 0.1/h2;
      const double tmp0_53 = 0.44364916731037084426/h1;
      const double tmp0_2 = 0.1/h0;
      const double tmp0_73 = 0.012701665379258311482/h2;
      const double tmp0_48 = -0.25/h1;
      const double tmp0_38 = 0.056350832689629155741/h1;
      const double tmp0_51 = -0.44364916731037084426/h1;
      const double tmp0_75 = -0.1/h2;
      const double tmp0_57 = 0.1/h1;
      const double tmp0_77 = 0.1/h2;
      const double tmp0_34 = 0.78729833462074168852/h1;
      const double tmp0_55 = -0.1/h1;
      const double tmp0_79 = 0.25/h2;
      const double tmp0_36 = -0.44364916731037084426/h1;
      const double tmp0_29 = 0.78729833462074168852/h0;
      const double tmp0_40 = -0.1/h1;
      const double tmp0_30 = -0.78729833462074168852/h1;
      const double tmp0_42 = -0.1/h1;
      const double tmp0_32 = -0.012701665379258311482/h1;
      const double tmp0_44 = -0.78729833462074168852/h1;
      const double tmp0_23 = 0.44364916731037084426/h0;
      const double tmp0_46 = 0.1/h1;
      const double tmp0_16 = -0.78729833462074168852/h0;
      const double tmp0_21 = 0.056350832689629155741/h0;
      const double tmp0_14 = 0.1/h0;
      const double tmp0_27 = -0.78729833462074168852/h0;
      const double tmp0_12 = 0.012701665379258311482/h0;
      const double tmp0_25 = -0.1/h0;
      const double tmp0_10 = -0.1/h0;
      const double tmp0_69 = -0.056350832689629155741/h2;
      const double tmp0_88 = -0.78729833462074168852/h2;
      const double tmp0_67 = 0.44364916731037084426/h2;
      const double tmp0_9 = 0.44364916731037084426/h0;
      const double tmp0_65 = 0.012701665379258311482/h2;
      const double tmp0_58 = 0.012701665379258311483/h1;
      const double tmp0_84 = -0.012701665379258311483/h2;
      const double tmp0_18 = -0.25/h0;
      const double tmp0_63 = -0.1/h2;
      const double tmp0_86 = 0.1/h2;
      const double tmp0_5 = 0.012701665379258311482/h0;
      const double tmp0_61 = 0.78729833462074168852/h2;
      const double tmp0_80 = -0.056350832689629155741/h2;
      const double tmp0_7 = -0.056350832689629155741/h0;
      #pragma omp parallel for private(i,k2,k1,k0)
      for (k2 =0; k2 < N2; ++k2) {
         for (k1 =0; k1 < N1; ++k1) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,k1,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,k1+1,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,k1,k2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,k1+1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_0 + f_011*tmp0_3 + f_100*tmp0_4 + f_111*tmp0_5 + tmp0_1*(f_001 + f_010) + tmp0_2*(f_101 + f_110);
                  out[INDEX4(i,1,0,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_30 + f_010*tmp0_34 + f_101*tmp0_32 + f_111*tmp0_35 + tmp0_31*(f_001 + f_100) + tmp0_33*(f_011 + f_110);
                  out[INDEX4(i,2,0,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_60 + f_001*tmp0_61 + f_110*tmp0_64 + f_111*tmp0_65 + tmp0_62*(f_011 + f_101) + tmp0_63*(f_010 + f_100);
                  out[INDEX4(i,0,1,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_0 + f_011*tmp0_3 + f_100*tmp0_4 + f_111*tmp0_5 + tmp0_1*(f_001 + f_010) + tmp0_2*(f_101 + f_110);
                  out[INDEX4(i,1,1,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_36*(f_000 + f_100) + tmp0_37*(f_001 + f_101) + tmp0_38*(f_011 + f_111) + tmp0_39*(f_010 + f_110);
                  out[INDEX4(i,2,1,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_66*(f_000 + f_100) + tmp0_67*(f_001 + f_101) + tmp0_68*(f_011 + f_111) + tmp0_69*(f_010 + f_110);
                  out[INDEX4(i,0,2,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_0 + f_011*tmp0_3 + f_100*tmp0_4 + f_111*tmp0_5 + tmp0_1*(f_001 + f_010) + tmp0_2*(f_101 + f_110);
                  out[INDEX4(i,1,2,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_40 + f_001*tmp0_41 + f_010*tmp0_46 + f_011*tmp0_43 + f_100*tmp0_44 + f_101*tmp0_42 + f_110*tmp0_45 + f_111*tmp0_47;
                  out[INDEX4(i,2,2,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_70 + f_001*tmp0_71 + f_010*tmp0_76 + f_011*tmp0_73 + f_100*tmp0_74 + f_101*tmp0_72 + f_110*tmp0_75 + f_111*tmp0_77;
                  out[INDEX4(i,0,3,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_6*(f_000 + f_010) + tmp0_7*(f_001 + f_011) + tmp0_8*(f_101 + f_111) + tmp0_9*(f_100 + f_110);
                  out[INDEX4(i,1,3,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_30 + f_010*tmp0_34 + f_101*tmp0_32 + f_111*tmp0_35 + tmp0_31*(f_001 + f_100) + tmp0_33*(f_011 + f_110);
                  out[INDEX4(i,2,3,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_66*(f_000 + f_010) + tmp0_67*(f_001 + f_011) + tmp0_68*(f_101 + f_111) + tmp0_69*(f_100 + f_110);
                  out[INDEX4(i,0,4,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_6*(f_000 + f_010) + tmp0_7*(f_001 + f_011) + tmp0_8*(f_101 + f_111) + tmp0_9*(f_100 + f_110);
                  out[INDEX4(i,1,4,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_36*(f_000 + f_100) + tmp0_37*(f_001 + f_101) + tmp0_38*(f_011 + f_111) + tmp0_39*(f_010 + f_110);
                  out[INDEX4(i,2,4,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_78*(f_000 + f_010 + f_100 + f_110) + tmp0_79*(f_001 + f_011 + f_101 + f_111);
                  out[INDEX4(i,0,5,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_6*(f_000 + f_010) + tmp0_7*(f_001 + f_011) + tmp0_8*(f_101 + f_111) + tmp0_9*(f_100 + f_110);
                  out[INDEX4(i,1,5,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_40 + f_001*tmp0_41 + f_010*tmp0_46 + f_011*tmp0_43 + f_100*tmp0_44 + f_101*tmp0_42 + f_110*tmp0_45 + f_111*tmp0_47;
                  out[INDEX4(i,2,5,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_80*(f_000 + f_010) + tmp0_81*(f_001 + f_011) + tmp0_82*(f_101 + f_111) + tmp0_83*(f_100 + f_110);
                  out[INDEX4(i,0,6,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_10 + f_001*tmp0_11 + f_010*tmp0_16 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_12 + f_110*tmp0_15 + f_111*tmp0_17;
                  out[INDEX4(i,1,6,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_30 + f_010*tmp0_34 + f_101*tmp0_32 + f_111*tmp0_35 + tmp0_31*(f_001 + f_100) + tmp0_33*(f_011 + f_110);
                  out[INDEX4(i,2,6,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_70 + f_001*tmp0_71 + f_010*tmp0_74 + f_011*tmp0_72 + f_100*tmp0_76 + f_101*tmp0_73 + f_110*tmp0_75 + f_111*tmp0_77;
                  out[INDEX4(i,0,7,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_10 + f_001*tmp0_11 + f_010*tmp0_16 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_12 + f_110*tmp0_15 + f_111*tmp0_17;
                  out[INDEX4(i,1,7,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_36*(f_000 + f_100) + tmp0_37*(f_001 + f_101) + tmp0_38*(f_011 + f_111) + tmp0_39*(f_010 + f_110);
                  out[INDEX4(i,2,7,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_80*(f_000 + f_100) + tmp0_81*(f_001 + f_101) + tmp0_82*(f_011 + f_111) + tmp0_83*(f_010 + f_110);
                  out[INDEX4(i,0,8,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_10 + f_001*tmp0_11 + f_010*tmp0_16 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_12 + f_110*tmp0_15 + f_111*tmp0_17;
                  out[INDEX4(i,1,8,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_40 + f_001*tmp0_41 + f_010*tmp0_46 + f_011*tmp0_43 + f_100*tmp0_44 + f_101*tmp0_42 + f_110*tmp0_45 + f_111*tmp0_47;
                  out[INDEX4(i,2,8,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_84 + f_001*tmp0_85 + f_110*tmp0_88 + f_111*tmp0_89 + tmp0_86*(f_011 + f_101) + tmp0_87*(f_010 + f_100);
                  out[INDEX4(i,0,9,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_6*(f_000 + f_001) + tmp0_7*(f_010 + f_011) + tmp0_8*(f_110 + f_111) + tmp0_9*(f_100 + f_101);
                  out[INDEX4(i,1,9,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_36*(f_000 + f_001) + tmp0_37*(f_100 + f_101) + tmp0_38*(f_110 + f_111) + tmp0_39*(f_010 + f_011);
                  out[INDEX4(i,2,9,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_60 + f_001*tmp0_61 + f_110*tmp0_64 + f_111*tmp0_65 + tmp0_62*(f_011 + f_101) + tmp0_63*(f_010 + f_100);
                  out[INDEX4(i,0,10,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_6*(f_000 + f_001) + tmp0_7*(f_010 + f_011) + tmp0_8*(f_110 + f_111) + tmp0_9*(f_100 + f_101);
                  out[INDEX4(i,1,10,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_48*(f_000 + f_001 + f_100 + f_101) + tmp0_49*(f_010 + f_011 + f_110 + f_111);
                  out[INDEX4(i,2,10,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_66*(f_000 + f_100) + tmp0_67*(f_001 + f_101) + tmp0_68*(f_011 + f_111) + tmp0_69*(f_010 + f_110);
                  out[INDEX4(i,0,11,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_6*(f_000 + f_001) + tmp0_7*(f_010 + f_011) + tmp0_8*(f_110 + f_111) + tmp0_9*(f_100 + f_101);
                  out[INDEX4(i,1,11,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_50*(f_000 + f_001) + tmp0_51*(f_100 + f_101) + tmp0_52*(f_010 + f_011) + tmp0_53*(f_110 + f_111);
                  out[INDEX4(i,2,11,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_70 + f_001*tmp0_71 + f_010*tmp0_76 + f_011*tmp0_73 + f_100*tmp0_74 + f_101*tmp0_72 + f_110*tmp0_75 + f_111*tmp0_77;
                  out[INDEX4(i,0,12,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_18*(f_000 + f_001 + f_010 + f_011) + tmp0_19*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,12,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_36*(f_000 + f_001) + tmp0_37*(f_100 + f_101) + tmp0_38*(f_110 + f_111) + tmp0_39*(f_010 + f_011);
                  out[INDEX4(i,2,12,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_66*(f_000 + f_010) + tmp0_67*(f_001 + f_011) + tmp0_68*(f_101 + f_111) + tmp0_69*(f_100 + f_110);
                  out[INDEX4(i,0,13,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_18*(f_000 + f_001 + f_010 + f_011) + tmp0_19*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,13,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_48*(f_000 + f_001 + f_100 + f_101) + tmp0_49*(f_010 + f_011 + f_110 + f_111);
                  out[INDEX4(i,2,13,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_78*(f_000 + f_010 + f_100 + f_110) + tmp0_79*(f_001 + f_011 + f_101 + f_111);
                  out[INDEX4(i,0,14,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_18*(f_000 + f_001 + f_010 + f_011) + tmp0_19*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,14,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_50*(f_000 + f_001) + tmp0_51*(f_100 + f_101) + tmp0_52*(f_010 + f_011) + tmp0_53*(f_110 + f_111);
                  out[INDEX4(i,2,14,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_80*(f_000 + f_010) + tmp0_81*(f_001 + f_011) + tmp0_82*(f_101 + f_111) + tmp0_83*(f_100 + f_110);
                  out[INDEX4(i,0,15,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_20*(f_000 + f_001) + tmp0_21*(f_100 + f_101) + tmp0_22*(f_010 + f_011) + tmp0_23*(f_110 + f_111);
                  out[INDEX4(i,1,15,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_36*(f_000 + f_001) + tmp0_37*(f_100 + f_101) + tmp0_38*(f_110 + f_111) + tmp0_39*(f_010 + f_011);
                  out[INDEX4(i,2,15,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_70 + f_001*tmp0_71 + f_010*tmp0_74 + f_011*tmp0_72 + f_100*tmp0_76 + f_101*tmp0_73 + f_110*tmp0_75 + f_111*tmp0_77;
                  out[INDEX4(i,0,16,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_20*(f_000 + f_001) + tmp0_21*(f_100 + f_101) + tmp0_22*(f_010 + f_011) + tmp0_23*(f_110 + f_111);
                  out[INDEX4(i,1,16,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_48*(f_000 + f_001 + f_100 + f_101) + tmp0_49*(f_010 + f_011 + f_110 + f_111);
                  out[INDEX4(i,2,16,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_80*(f_000 + f_100) + tmp0_81*(f_001 + f_101) + tmp0_82*(f_011 + f_111) + tmp0_83*(f_010 + f_110);
                  out[INDEX4(i,0,17,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_20*(f_000 + f_001) + tmp0_21*(f_100 + f_101) + tmp0_22*(f_010 + f_011) + tmp0_23*(f_110 + f_111);
                  out[INDEX4(i,1,17,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_50*(f_000 + f_001) + tmp0_51*(f_100 + f_101) + tmp0_52*(f_010 + f_011) + tmp0_53*(f_110 + f_111);
                  out[INDEX4(i,2,17,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_84 + f_001*tmp0_85 + f_110*tmp0_88 + f_111*tmp0_89 + tmp0_86*(f_011 + f_101) + tmp0_87*(f_010 + f_100);
                  out[INDEX4(i,0,18,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_10 + f_001*tmp0_16 + f_010*tmp0_11 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_15 + f_110*tmp0_12 + f_111*tmp0_17;
                  out[INDEX4(i,1,18,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_40 + f_001*tmp0_44 + f_010*tmp0_46 + f_011*tmp0_45 + f_100*tmp0_41 + f_101*tmp0_42 + f_110*tmp0_43 + f_111*tmp0_47;
                  out[INDEX4(i,2,18,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_60 + f_001*tmp0_61 + f_110*tmp0_64 + f_111*tmp0_65 + tmp0_62*(f_011 + f_101) + tmp0_63*(f_010 + f_100);
                  out[INDEX4(i,0,19,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_10 + f_001*tmp0_16 + f_010*tmp0_11 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_15 + f_110*tmp0_12 + f_111*tmp0_17;
                  out[INDEX4(i,1,19,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_50*(f_000 + f_100) + tmp0_51*(f_001 + f_101) + tmp0_52*(f_010 + f_110) + tmp0_53*(f_011 + f_111);
                  out[INDEX4(i,2,19,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_66*(f_000 + f_100) + tmp0_67*(f_001 + f_101) + tmp0_68*(f_011 + f_111) + tmp0_69*(f_010 + f_110);
                  out[INDEX4(i,0,20,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_10 + f_001*tmp0_16 + f_010*tmp0_11 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_15 + f_110*tmp0_12 + f_111*tmp0_17;
                  out[INDEX4(i,1,20,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_54 + f_010*tmp0_58 + f_101*tmp0_56 + f_111*tmp0_59 + tmp0_55*(f_001 + f_100) + tmp0_57*(f_011 + f_110);
                  out[INDEX4(i,2,20,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_70 + f_001*tmp0_71 + f_010*tmp0_76 + f_011*tmp0_73 + f_100*tmp0_74 + f_101*tmp0_72 + f_110*tmp0_75 + f_111*tmp0_77;
                  out[INDEX4(i,0,21,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_20*(f_000 + f_010) + tmp0_21*(f_100 + f_110) + tmp0_22*(f_001 + f_011) + tmp0_23*(f_101 + f_111);
                  out[INDEX4(i,1,21,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_40 + f_001*tmp0_44 + f_010*tmp0_46 + f_011*tmp0_45 + f_100*tmp0_41 + f_101*tmp0_42 + f_110*tmp0_43 + f_111*tmp0_47;
                  out[INDEX4(i,2,21,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_66*(f_000 + f_010) + tmp0_67*(f_001 + f_011) + tmp0_68*(f_101 + f_111) + tmp0_69*(f_100 + f_110);
                  out[INDEX4(i,0,22,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_20*(f_000 + f_010) + tmp0_21*(f_100 + f_110) + tmp0_22*(f_001 + f_011) + tmp0_23*(f_101 + f_111);
                  out[INDEX4(i,1,22,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_50*(f_000 + f_100) + tmp0_51*(f_001 + f_101) + tmp0_52*(f_010 + f_110) + tmp0_53*(f_011 + f_111);
                  out[INDEX4(i,2,22,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_78*(f_000 + f_010 + f_100 + f_110) + tmp0_79*(f_001 + f_011 + f_101 + f_111);
                  out[INDEX4(i,0,23,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_20*(f_000 + f_010) + tmp0_21*(f_100 + f_110) + tmp0_22*(f_001 + f_011) + tmp0_23*(f_101 + f_111);
                  out[INDEX4(i,1,23,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_54 + f_010*tmp0_58 + f_101*tmp0_56 + f_111*tmp0_59 + tmp0_55*(f_001 + f_100) + tmp0_57*(f_011 + f_110);
                  out[INDEX4(i,2,23,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_80*(f_000 + f_010) + tmp0_81*(f_001 + f_011) + tmp0_82*(f_101 + f_111) + tmp0_83*(f_100 + f_110);
                  out[INDEX4(i,0,24,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_24 + f_011*tmp0_27 + f_100*tmp0_28 + f_111*tmp0_29 + tmp0_25*(f_001 + f_010) + tmp0_26*(f_101 + f_110);
                  out[INDEX4(i,1,24,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_40 + f_001*tmp0_44 + f_010*tmp0_46 + f_011*tmp0_45 + f_100*tmp0_41 + f_101*tmp0_42 + f_110*tmp0_43 + f_111*tmp0_47;
                  out[INDEX4(i,2,24,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_70 + f_001*tmp0_71 + f_010*tmp0_74 + f_011*tmp0_72 + f_100*tmp0_76 + f_101*tmp0_73 + f_110*tmp0_75 + f_111*tmp0_77;
                  out[INDEX4(i,0,25,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_24 + f_011*tmp0_27 + f_100*tmp0_28 + f_111*tmp0_29 + tmp0_25*(f_001 + f_010) + tmp0_26*(f_101 + f_110);
                  out[INDEX4(i,1,25,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_50*(f_000 + f_100) + tmp0_51*(f_001 + f_101) + tmp0_52*(f_010 + f_110) + tmp0_53*(f_011 + f_111);
                  out[INDEX4(i,2,25,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = tmp0_80*(f_000 + f_100) + tmp0_81*(f_001 + f_101) + tmp0_82*(f_011 + f_111) + tmp0_83*(f_010 + f_110);
                  out[INDEX4(i,0,26,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_24 + f_011*tmp0_27 + f_100*tmp0_28 + f_111*tmp0_29 + tmp0_25*(f_001 + f_010) + tmp0_26*(f_101 + f_110);
                  out[INDEX4(i,1,26,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_54 + f_010*tmp0_58 + f_101*tmp0_56 + f_111*tmp0_59 + tmp0_55*(f_001 + f_100) + tmp0_57*(f_011 + f_110);
                  out[INDEX4(i,2,26,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,27)] = f_000*tmp0_84 + f_001*tmp0_85 + f_110*tmp0_88 + f_111*tmp0_89 + tmp0_86*(f_011 + f_101) + tmp0_87*(f_010 + f_100);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k1 loop */
      } /* close k2 loop */
   } else if (out_data_type==RIPLEY_REDUCED_ELEMENTS) {
      const double tmp0_0 = -0.25/h0;
      const double tmp0_4 = -0.25/h2;
      const double tmp0_1 = 0.25/h0;
      const double tmp0_5 = 0.25/h2;
      const double tmp0_2 = -0.25/h1;
      const double tmp0_3 = 0.25/h1;
      #pragma omp parallel for private(i,k2,k1,k0)
      for (k2 =0; k2 < N2; ++k2) {
         for (k1 =0; k1 < N1; ++k1) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,k1,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,k1+1,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,k1,k2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,k1+1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_000 + f_001 + f_010 + f_011) + tmp0_1*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,0,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_000 + f_001 + f_100 + f_101) + tmp0_3*(f_010 + f_011 + f_110 + f_111);
                  out[INDEX4(i,2,0,INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_000 + f_010 + f_100 + f_110) + tmp0_5*(f_001 + f_011 + f_101 + f_111);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k1 loop */
      } /* close k2 loop */
   } else if (out_data_type==RIPLEY_BOUNDARY_ELEMENTS) {
      if (face_offset(0)>-1) {
         const double tmp0_22 = -0.44364916731037084426/h0;
         const double tmp0_16 = -0.78729833462074168852/h0;
         const double tmp0_33 = 0.88729833462074168852/h1;
         const double tmp0_0 = -0.78729833462074168852/h0;
         const double tmp0_21 = 0.056350832689629155741/h0;
         const double tmp0_17 = 0.1/h0;
         const double tmp0_1 = -0.1/h0;
         const double tmp0_20 = -0.056350832689629155741/h0;
         const double tmp0_14 = 0.1/h0;
         const double tmp0_49 = -0.88729833462074168852/h2;
         const double tmp0_2 = 0.1/h0;
         const double tmp0_27 = -0.78729833462074168852/h0;
         const double tmp0_15 = 0.78729833462074168852/h0;
         const double tmp0_48 = 0.88729833462074168852/h2;
         const double tmp0_3 = -0.012701665379258311482/h0;
         const double tmp0_26 = 0.1/h0;
         const double tmp0_12 = 0.012701665379258311482/h0;
         const double tmp0_25 = -0.1/h0;
         const double tmp0_13 = -0.1/h0;
         const double tmp0_24 = -0.012701665379258311483/h0;
         const double tmp0_10 = -0.1/h0;
         const double tmp0_11 = -0.012701665379258311482/h0;
         const double tmp0_38 = 0.88729833462074168852/h1;
         const double tmp0_34 = -0.5/h1;
         const double tmp0_42 = 0.11270166537925831148/h2;
         const double tmp0_35 = 0.5/h1;
         const double tmp0_36 = -0.11270166537925831148/h1;
         const double tmp0_41 = 0.88729833462074168852/h2;
         const double tmp0_8 = 0.056350832689629155741/h0;
         const double tmp0_37 = -0.88729833462074168852/h1;
         const double tmp0_29 = 0.78729833462074168852/h0;
         const double tmp0_40 = -0.88729833462074168852/h2;
         const double tmp0_9 = 0.44364916731037084426/h0;
         const double tmp0_30 = -0.88729833462074168852/h1;
         const double tmp0_28 = 0.012701665379258311482/h0;
         const double tmp0_43 = -0.11270166537925831148/h2;
         const double tmp0_32 = 0.11270166537925831148/h1;
         const double tmp0_31 = -0.11270166537925831148/h1;
         const double tmp0_39 = 0.11270166537925831148/h1;
         const double tmp0_18 = -0.25/h0;
         const double tmp0_45 = 0.5/h2;
         const double tmp0_4 = 0.78729833462074168852/h0;
         const double tmp0_19 = 0.25/h0;
         const double tmp0_44 = -0.5/h2;
         const double tmp0_5 = 0.012701665379258311482/h0;
         const double tmp0_47 = 0.11270166537925831148/h2;
         const double tmp0_6 = -0.44364916731037084426/h0;
         const double tmp0_23 = 0.44364916731037084426/h0;
         const double tmp0_46 = -0.11270166537925831148/h2;
         const double tmp0_7 = -0.056350832689629155741/h0;
         #pragma omp parallel for private(i,k2,k1)
         for (k2 =0; k2 < N2; ++k2) {
            for (k1 =0; k1 < N1; ++k1) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(0,k1,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(0,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(1,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(0,k1+1,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(1,k1,k2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(1,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(0,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(1,k1+1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_011*tmp0_3 + f_100*tmp0_4 + f_111*tmp0_5 + tmp0_1*(f_001 + f_010) + tmp0_2*(f_101 + f_110);
                  out[INDEX4(i,1,0,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_30 + f_001*tmp0_31 + f_010*tmp0_33 + f_011*tmp0_32;
                  out[INDEX4(i,2,0,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_40 + f_001*tmp0_41 + f_010*tmp0_43 + f_011*tmp0_42;
                  out[INDEX4(i,0,1,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_6*(f_000 + f_010) + tmp0_7*(f_001 + f_011) + tmp0_8*(f_101 + f_111) + tmp0_9*(f_100 + f_110);
                  out[INDEX4(i,1,1,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_30 + f_001*tmp0_31 + f_010*tmp0_33 + f_011*tmp0_32;
                  out[INDEX4(i,2,1,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_000 + f_010) + tmp0_45*(f_001 + f_011);
                  out[INDEX4(i,0,2,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_001*tmp0_11 + f_010*tmp0_16 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_12 + f_110*tmp0_15 + f_111*tmp0_17;
                  out[INDEX4(i,1,2,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_30 + f_001*tmp0_31 + f_010*tmp0_33 + f_011*tmp0_32;
                  out[INDEX4(i,2,2,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_46 + f_001*tmp0_47 + f_010*tmp0_49 + f_011*tmp0_48;
                  out[INDEX4(i,0,3,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_6*(f_000 + f_001) + tmp0_7*(f_010 + f_011) + tmp0_8*(f_110 + f_111) + tmp0_9*(f_100 + f_101);
                  out[INDEX4(i,1,3,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_34*(f_000 + f_001) + tmp0_35*(f_010 + f_011);
                  out[INDEX4(i,2,3,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_40 + f_001*tmp0_41 + f_010*tmp0_43 + f_011*tmp0_42;
                  out[INDEX4(i,0,4,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_18*(f_000 + f_001 + f_010 + f_011) + tmp0_19*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,4,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_34*(f_000 + f_001) + tmp0_35*(f_010 + f_011);
                  out[INDEX4(i,2,4,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_000 + f_010) + tmp0_45*(f_001 + f_011);
                  out[INDEX4(i,0,5,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_20*(f_000 + f_001) + tmp0_21*(f_100 + f_101) + tmp0_22*(f_010 + f_011) + tmp0_23*(f_110 + f_111);
                  out[INDEX4(i,1,5,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_34*(f_000 + f_001) + tmp0_35*(f_010 + f_011);
                  out[INDEX4(i,2,5,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_46 + f_001*tmp0_47 + f_010*tmp0_49 + f_011*tmp0_48;
                  out[INDEX4(i,0,6,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_001*tmp0_16 + f_010*tmp0_11 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_15 + f_110*tmp0_12 + f_111*tmp0_17;
                  out[INDEX4(i,1,6,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_36 + f_001*tmp0_37 + f_010*tmp0_39 + f_011*tmp0_38;
                  out[INDEX4(i,2,6,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_40 + f_001*tmp0_41 + f_010*tmp0_43 + f_011*tmp0_42;
                  out[INDEX4(i,0,7,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_20*(f_000 + f_010) + tmp0_21*(f_100 + f_110) + tmp0_22*(f_001 + f_011) + tmp0_23*(f_101 + f_111);
                  out[INDEX4(i,1,7,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_36 + f_001*tmp0_37 + f_010*tmp0_39 + f_011*tmp0_38;
                  out[INDEX4(i,2,7,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_000 + f_010) + tmp0_45*(f_001 + f_011);
                  out[INDEX4(i,0,8,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_24 + f_011*tmp0_27 + f_100*tmp0_28 + f_111*tmp0_29 + tmp0_25*(f_001 + f_010) + tmp0_26*(f_101 + f_110);
                  out[INDEX4(i,1,8,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_36 + f_001*tmp0_37 + f_010*tmp0_39 + f_011*tmp0_38;
                  out[INDEX4(i,2,8,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_46 + f_001*tmp0_47 + f_010*tmp0_49 + f_011*tmp0_48;
               } /* close component loop i */
            } /* close k1 loop */
         } /* close k2 loop */
      } /* end of face 0 */
      if (face_offset(1)>-1) {
         const double tmp0_22 = -0.44364916731037084426/h0;
         const double tmp0_16 = -0.78729833462074168852/h0;
         const double tmp0_33 = 0.11270166537925831148/h1;
         const double tmp0_0 = -0.78729833462074168852/h0;
         const double tmp0_21 = 0.056350832689629155741/h0;
         const double tmp0_17 = 0.1/h0;
         const double tmp0_1 = -0.1/h0;
         const double tmp0_20 = -0.056350832689629155741/h0;
         const double tmp0_14 = 0.1/h0;
         const double tmp0_49 = 0.88729833462074168852/h2;
         const double tmp0_2 = 0.1/h0;
         const double tmp0_27 = -0.78729833462074168852/h0;
         const double tmp0_15 = 0.78729833462074168852/h0;
         const double tmp0_48 = -0.88729833462074168852/h2;
         const double tmp0_3 = -0.012701665379258311482/h0;
         const double tmp0_26 = 0.1/h0;
         const double tmp0_12 = 0.012701665379258311482/h0;
         const double tmp0_25 = -0.1/h0;
         const double tmp0_13 = -0.1/h0;
         const double tmp0_24 = -0.012701665379258311483/h0;
         const double tmp0_10 = -0.1/h0;
         const double tmp0_11 = -0.012701665379258311482/h0;
         const double tmp0_38 = 0.11270166537925831148/h1;
         const double tmp0_34 = -0.5/h1;
         const double tmp0_42 = -0.11270166537925831148/h2;
         const double tmp0_35 = 0.5/h1;
         const double tmp0_36 = -0.88729833462074168852/h1;
         const double tmp0_41 = -0.88729833462074168852/h2;
         const double tmp0_8 = 0.056350832689629155741/h0;
         const double tmp0_37 = -0.11270166537925831148/h1;
         const double tmp0_29 = 0.78729833462074168852/h0;
         const double tmp0_40 = 0.88729833462074168852/h2;
         const double tmp0_9 = 0.44364916731037084426/h0;
         const double tmp0_30 = -0.11270166537925831148/h1;
         const double tmp0_28 = 0.012701665379258311482/h0;
         const double tmp0_43 = 0.11270166537925831148/h2;
         const double tmp0_32 = 0.88729833462074168852/h1;
         const double tmp0_31 = -0.88729833462074168852/h1;
         const double tmp0_39 = 0.88729833462074168852/h1;
         const double tmp0_18 = -0.25/h0;
         const double tmp0_45 = -0.5/h2;
         const double tmp0_4 = 0.78729833462074168852/h0;
         const double tmp0_19 = 0.25/h0;
         const double tmp0_44 = 0.5/h2;
         const double tmp0_5 = 0.012701665379258311482/h0;
         const double tmp0_47 = -0.11270166537925831148/h2;
         const double tmp0_6 = -0.44364916731037084426/h0;
         const double tmp0_23 = 0.44364916731037084426/h0;
         const double tmp0_46 = 0.11270166537925831148/h2;
         const double tmp0_7 = -0.056350832689629155741/h0;
         #pragma omp parallel for private(i,k2,k1)
         for (k2 =0; k2 < N2; ++k2) {
            for (k1 =0; k1 < N1; ++k1) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(M0-2,k1,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(M0-2,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(M0-1,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(M0-2,k1+1,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(M0-1,k1,k2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(M0-1,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(M0-2,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(M0-1,k1+1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_011*tmp0_3 + f_100*tmp0_4 + f_111*tmp0_5 + tmp0_1*(f_001 + f_010) + tmp0_2*(f_101 + f_110);
                  out[INDEX4(i,1,0,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_31 + f_101*tmp0_30 + f_110*tmp0_32 + f_111*tmp0_33;
                  out[INDEX4(i,2,0,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_41 + f_101*tmp0_40 + f_110*tmp0_42 + f_111*tmp0_43;
                  out[INDEX4(i,0,1,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_6*(f_000 + f_010) + tmp0_7*(f_001 + f_011) + tmp0_8*(f_101 + f_111) + tmp0_9*(f_100 + f_110);
                  out[INDEX4(i,1,1,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_31 + f_101*tmp0_30 + f_110*tmp0_32 + f_111*tmp0_33;
                  out[INDEX4(i,2,1,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_101 + f_111) + tmp0_45*(f_100 + f_110);
                  out[INDEX4(i,0,2,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_001*tmp0_11 + f_010*tmp0_16 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_12 + f_110*tmp0_15 + f_111*tmp0_17;
                  out[INDEX4(i,1,2,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_31 + f_101*tmp0_30 + f_110*tmp0_32 + f_111*tmp0_33;
                  out[INDEX4(i,2,2,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_47 + f_101*tmp0_46 + f_110*tmp0_48 + f_111*tmp0_49;
                  out[INDEX4(i,0,3,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_6*(f_000 + f_001) + tmp0_7*(f_010 + f_011) + tmp0_8*(f_110 + f_111) + tmp0_9*(f_100 + f_101);
                  out[INDEX4(i,1,3,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_34*(f_100 + f_101) + tmp0_35*(f_110 + f_111);
                  out[INDEX4(i,2,3,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_41 + f_101*tmp0_40 + f_110*tmp0_42 + f_111*tmp0_43;
                  out[INDEX4(i,0,4,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_18*(f_000 + f_001 + f_010 + f_011) + tmp0_19*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,4,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_34*(f_100 + f_101) + tmp0_35*(f_110 + f_111);
                  out[INDEX4(i,2,4,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_101 + f_111) + tmp0_45*(f_100 + f_110);
                  out[INDEX4(i,0,5,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_20*(f_000 + f_001) + tmp0_21*(f_100 + f_101) + tmp0_22*(f_010 + f_011) + tmp0_23*(f_110 + f_111);
                  out[INDEX4(i,1,5,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_34*(f_100 + f_101) + tmp0_35*(f_110 + f_111);
                  out[INDEX4(i,2,5,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_47 + f_101*tmp0_46 + f_110*tmp0_48 + f_111*tmp0_49;
                  out[INDEX4(i,0,6,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_001*tmp0_16 + f_010*tmp0_11 + f_011*tmp0_13 + f_100*tmp0_14 + f_101*tmp0_15 + f_110*tmp0_12 + f_111*tmp0_17;
                  out[INDEX4(i,1,6,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_37 + f_101*tmp0_36 + f_110*tmp0_38 + f_111*tmp0_39;
                  out[INDEX4(i,2,6,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_41 + f_101*tmp0_40 + f_110*tmp0_42 + f_111*tmp0_43;
                  out[INDEX4(i,0,7,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_20*(f_000 + f_010) + tmp0_21*(f_100 + f_110) + tmp0_22*(f_001 + f_011) + tmp0_23*(f_101 + f_111);
                  out[INDEX4(i,1,7,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_37 + f_101*tmp0_36 + f_110*tmp0_38 + f_111*tmp0_39;
                  out[INDEX4(i,2,7,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_101 + f_111) + tmp0_45*(f_100 + f_110);
                  out[INDEX4(i,0,8,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_24 + f_011*tmp0_27 + f_100*tmp0_28 + f_111*tmp0_29 + tmp0_25*(f_001 + f_010) + tmp0_26*(f_101 + f_110);
                  out[INDEX4(i,1,8,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_37 + f_101*tmp0_36 + f_110*tmp0_38 + f_111*tmp0_39;
                  out[INDEX4(i,2,8,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_100*tmp0_47 + f_101*tmp0_46 + f_110*tmp0_48 + f_111*tmp0_49;
               } /* close component loop i */
            } /* close k1 loop */
         } /* close k2 loop */
      } /* end of face 1 */
      if (face_offset(2)>-1) {
         const double tmp0_22 = -0.1/h1;
         const double tmp0_16 = -0.44364916731037084426/h1;
         const double tmp0_33 = 0.44364916731037084426/h1;
         const double tmp0_0 = -0.88729833462074168852/h0;
         const double tmp0_21 = -0.012701665379258311482/h1;
         const double tmp0_17 = -0.056350832689629155741/h1;
         const double tmp0_1 = -0.11270166537925831148/h0;
         const double tmp0_20 = -0.1/h1;
         const double tmp0_14 = 0.78729833462074168852/h1;
         const double tmp0_49 = -0.88729833462074168852/h2;
         const double tmp0_2 = 0.11270166537925831148/h0;
         const double tmp0_27 = 0.1/h1;
         const double tmp0_15 = 0.012701665379258311482/h1;
         const double tmp0_48 = 0.88729833462074168852/h2;
         const double tmp0_3 = 0.88729833462074168852/h0;
         const double tmp0_26 = 0.1/h1;
         const double tmp0_12 = -0.012701665379258311482/h1;
         const double tmp0_25 = 0.78729833462074168852/h1;
         const double tmp0_13 = 0.1/h1;
         const double tmp0_24 = 0.012701665379258311482/h1;
         const double tmp0_10 = -0.78729833462074168852/h1;
         const double tmp0_11 = -0.1/h1;
         const double tmp0_38 = 0.012701665379258311483/h1;
         const double tmp0_34 = -0.012701665379258311483/h1;
         const double tmp0_42 = 0.11270166537925831148/h2;
         const double tmp0_35 = -0.1/h1;
         const double tmp0_36 = -0.78729833462074168852/h1;
         const double tmp0_41 = 0.88729833462074168852/h2;
         const double tmp0_8 = 0.88729833462074168852/h0;
         const double tmp0_37 = 0.1/h1;
         const double tmp0_29 = 0.25/h1;
         const double tmp0_40 = -0.88729833462074168852/h2;
         const double tmp0_9 = 0.11270166537925831148/h0;
         const double tmp0_30 = -0.056350832689629155741/h1;
         const double tmp0_28 = -0.25/h1;
         const double tmp0_43 = -0.11270166537925831148/h2;
         const double tmp0_32 = 0.056350832689629155741/h1;
         const double tmp0_31 = -0.44364916731037084426/h1;
         const double tmp0_39 = 0.78729833462074168852/h1;
         const double tmp0_18 = 0.056350832689629155741/h1;
         const double tmp0_45 = 0.5/h2;
         const double tmp0_4 = -0.5/h0;
         const double tmp0_19 = 0.44364916731037084426/h1;
         const double tmp0_44 = -0.5/h2;
         const double tmp0_5 = 0.5/h0;
         const double tmp0_47 = 0.11270166537925831148/h2;
         const double tmp0_6 = -0.11270166537925831148/h0;
         const double tmp0_23 = -0.78729833462074168852/h1;
         const double tmp0_46 = -0.11270166537925831148/h2;
         const double tmp0_7 = -0.88729833462074168852/h0;
         #pragma omp parallel for private(i,k2,k0)
         for (k2 =0; k2 < N2; ++k2) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,0,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,0,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,0,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,0,k2, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,1,k2+1, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_001*tmp0_1 + f_100*tmp0_3 + f_101*tmp0_2;
                  out[INDEX4(i,1,0,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_010*tmp0_14 + f_101*tmp0_12 + f_111*tmp0_15 + tmp0_11*(f_001 + f_100) + tmp0_13*(f_011 + f_110);
                  out[INDEX4(i,2,0,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_40 + f_001*tmp0_41 + f_100*tmp0_43 + f_101*tmp0_42;
                  out[INDEX4(i,0,1,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_001*tmp0_1 + f_100*tmp0_3 + f_101*tmp0_2;
                  out[INDEX4(i,1,1,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_16*(f_000 + f_100) + tmp0_17*(f_001 + f_101) + tmp0_18*(f_011 + f_111) + tmp0_19*(f_010 + f_110);
                  out[INDEX4(i,2,1,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_000 + f_100) + tmp0_45*(f_001 + f_101);
                  out[INDEX4(i,0,2,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_001*tmp0_1 + f_100*tmp0_3 + f_101*tmp0_2;
                  out[INDEX4(i,1,2,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_20 + f_001*tmp0_21 + f_010*tmp0_26 + f_011*tmp0_24 + f_100*tmp0_23 + f_101*tmp0_22 + f_110*tmp0_25 + f_111*tmp0_27;
                  out[INDEX4(i,2,2,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_46 + f_001*tmp0_47 + f_100*tmp0_49 + f_101*tmp0_48;
                  out[INDEX4(i,0,3,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_000 + f_001) + tmp0_5*(f_100 + f_101);
                  out[INDEX4(i,1,3,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_16*(f_000 + f_001) + tmp0_17*(f_100 + f_101) + tmp0_18*(f_110 + f_111) + tmp0_19*(f_010 + f_011);
                  out[INDEX4(i,2,3,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_40 + f_001*tmp0_41 + f_100*tmp0_43 + f_101*tmp0_42;
                  out[INDEX4(i,0,4,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_000 + f_001) + tmp0_5*(f_100 + f_101);
                  out[INDEX4(i,1,4,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_28*(f_000 + f_001 + f_100 + f_101) + tmp0_29*(f_010 + f_011 + f_110 + f_111);
                  out[INDEX4(i,2,4,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_000 + f_100) + tmp0_45*(f_001 + f_101);
                  out[INDEX4(i,0,5,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_000 + f_001) + tmp0_5*(f_100 + f_101);
                  out[INDEX4(i,1,5,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_30*(f_000 + f_001) + tmp0_31*(f_100 + f_101) + tmp0_32*(f_010 + f_011) + tmp0_33*(f_110 + f_111);
                  out[INDEX4(i,2,5,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_46 + f_001*tmp0_47 + f_100*tmp0_49 + f_101*tmp0_48;
                  out[INDEX4(i,0,6,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_6 + f_001*tmp0_7 + f_100*tmp0_9 + f_101*tmp0_8;
                  out[INDEX4(i,1,6,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_20 + f_001*tmp0_23 + f_010*tmp0_26 + f_011*tmp0_25 + f_100*tmp0_21 + f_101*tmp0_22 + f_110*tmp0_24 + f_111*tmp0_27;
                  out[INDEX4(i,2,6,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_40 + f_001*tmp0_41 + f_100*tmp0_43 + f_101*tmp0_42;
                  out[INDEX4(i,0,7,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_6 + f_001*tmp0_7 + f_100*tmp0_9 + f_101*tmp0_8;
                  out[INDEX4(i,1,7,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_30*(f_000 + f_100) + tmp0_31*(f_001 + f_101) + tmp0_32*(f_010 + f_110) + tmp0_33*(f_011 + f_111);
                  out[INDEX4(i,2,7,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_000 + f_100) + tmp0_45*(f_001 + f_101);
                  out[INDEX4(i,0,8,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_6 + f_001*tmp0_7 + f_100*tmp0_9 + f_101*tmp0_8;
                  out[INDEX4(i,1,8,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_34 + f_010*tmp0_38 + f_101*tmp0_36 + f_111*tmp0_39 + tmp0_35*(f_001 + f_100) + tmp0_37*(f_011 + f_110);
                  out[INDEX4(i,2,8,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_46 + f_001*tmp0_47 + f_100*tmp0_49 + f_101*tmp0_48;
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k2 loop */
      } /* end of face 2 */
      if (face_offset(3)>-1) {
         const double tmp0_22 = 0.1/h1;
         const double tmp0_16 = 0.056350832689629155741/h1;
         const double tmp0_33 = -0.44364916731037084426/h1;
         const double tmp0_0 = -0.11270166537925831148/h0;
         const double tmp0_21 = 0.78729833462074168852/h1;
         const double tmp0_17 = 0.44364916731037084426/h1;
         const double tmp0_1 = 0.88729833462074168852/h0;
         const double tmp0_20 = 0.012701665379258311482/h1;
         const double tmp0_14 = -0.012701665379258311482/h1;
         const double tmp0_49 = 0.88729833462074168852/h2;
         const double tmp0_2 = -0.88729833462074168852/h0;
         const double tmp0_27 = -0.78729833462074168852/h1;
         const double tmp0_15 = -0.1/h1;
         const double tmp0_48 = -0.11270166537925831148/h2;
         const double tmp0_3 = 0.11270166537925831148/h0;
         const double tmp0_26 = -0.012701665379258311482/h1;
         const double tmp0_12 = 0.012701665379258311482/h1;
         const double tmp0_25 = -0.1/h1;
         const double tmp0_13 = -0.78729833462074168852/h1;
         const double tmp0_24 = -0.1/h1;
         const double tmp0_10 = 0.1/h1;
         const double tmp0_11 = 0.78729833462074168852/h1;
         const double tmp0_38 = -0.78729833462074168852/h1;
         const double tmp0_34 = 0.1/h1;
         const double tmp0_42 = -0.88729833462074168852/h2;
         const double tmp0_35 = 0.012701665379258311483/h1;
         const double tmp0_36 = 0.78729833462074168852/h1;
         const double tmp0_41 = -0.11270166537925831148/h2;
         const double tmp0_8 = -0.11270166537925831148/h0;
         const double tmp0_37 = -0.012701665379258311483/h1;
         const double tmp0_29 = -0.25/h1;
         const double tmp0_40 = 0.88729833462074168852/h2;
         const double tmp0_9 = 0.88729833462074168852/h0;
         const double tmp0_30 = 0.056350832689629155741/h1;
         const double tmp0_28 = 0.25/h1;
         const double tmp0_43 = 0.11270166537925831148/h2;
         const double tmp0_32 = -0.056350832689629155741/h1;
         const double tmp0_31 = 0.44364916731037084426/h1;
         const double tmp0_39 = -0.1/h1;
         const double tmp0_18 = -0.44364916731037084426/h1;
         const double tmp0_45 = -0.5/h2;
         const double tmp0_4 = -0.5/h0;
         const double tmp0_19 = -0.056350832689629155741/h1;
         const double tmp0_44 = 0.5/h2;
         const double tmp0_5 = 0.5/h0;
         const double tmp0_47 = -0.88729833462074168852/h2;
         const double tmp0_6 = -0.88729833462074168852/h0;
         const double tmp0_23 = 0.1/h1;
         const double tmp0_46 = 0.11270166537925831148/h2;
         const double tmp0_7 = 0.11270166537925831148/h0;
         #pragma omp parallel for private(i,k2,k0)
         for (k2 =0; k2 < N2; ++k2) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,M1-1,k2+1, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,M1-1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,M1-1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,M1-1,k2+1, M0,M1),NCOMP)];
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,M1-2,k2, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,M1-2,k2+1, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,M1-2,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,M1-2,k2, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_2 + f_011*tmp0_0 + f_110*tmp0_1 + f_111*tmp0_3;
                  out[INDEX4(i,1,0,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_13 + f_010*tmp0_11 + f_101*tmp0_14 + f_111*tmp0_12 + tmp0_10*(f_011 + f_110) + tmp0_15*(f_001 + f_100);
                  out[INDEX4(i,2,0,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_42 + f_011*tmp0_40 + f_110*tmp0_41 + f_111*tmp0_43;
                  out[INDEX4(i,0,1,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_2 + f_011*tmp0_0 + f_110*tmp0_1 + f_111*tmp0_3;
                  out[INDEX4(i,1,1,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_16*(f_011 + f_111) + tmp0_17*(f_010 + f_110) + tmp0_18*(f_000 + f_100) + tmp0_19*(f_001 + f_101);
                  out[INDEX4(i,2,1,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_011 + f_111) + tmp0_45*(f_010 + f_110);
                  out[INDEX4(i,0,2,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_2 + f_011*tmp0_0 + f_110*tmp0_1 + f_111*tmp0_3;
                  out[INDEX4(i,1,2,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_24 + f_001*tmp0_26 + f_010*tmp0_22 + f_011*tmp0_20 + f_100*tmp0_27 + f_101*tmp0_25 + f_110*tmp0_21 + f_111*tmp0_23;
                  out[INDEX4(i,2,2,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_48 + f_011*tmp0_46 + f_110*tmp0_47 + f_111*tmp0_49;
                  out[INDEX4(i,0,3,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_010 + f_011) + tmp0_5*(f_110 + f_111);
                  out[INDEX4(i,1,3,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_16*(f_110 + f_111) + tmp0_17*(f_010 + f_011) + tmp0_18*(f_000 + f_001) + tmp0_19*(f_100 + f_101);
                  out[INDEX4(i,2,3,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_42 + f_011*tmp0_40 + f_110*tmp0_41 + f_111*tmp0_43;
                  out[INDEX4(i,0,4,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_010 + f_011) + tmp0_5*(f_110 + f_111);
                  out[INDEX4(i,1,4,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_28*(f_010 + f_011 + f_110 + f_111) + tmp0_29*(f_000 + f_001 + f_100 + f_101);
                  out[INDEX4(i,2,4,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_011 + f_111) + tmp0_45*(f_010 + f_110);
                  out[INDEX4(i,0,5,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_010 + f_011) + tmp0_5*(f_110 + f_111);
                  out[INDEX4(i,1,5,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_30*(f_010 + f_011) + tmp0_31*(f_110 + f_111) + tmp0_32*(f_000 + f_001) + tmp0_33*(f_100 + f_101);
                  out[INDEX4(i,2,5,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_48 + f_011*tmp0_46 + f_110*tmp0_47 + f_111*tmp0_49;
                  out[INDEX4(i,0,6,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_8 + f_011*tmp0_6 + f_110*tmp0_7 + f_111*tmp0_9;
                  out[INDEX4(i,1,6,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_24 + f_001*tmp0_27 + f_010*tmp0_22 + f_011*tmp0_21 + f_100*tmp0_26 + f_101*tmp0_25 + f_110*tmp0_20 + f_111*tmp0_23;
                  out[INDEX4(i,2,6,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_42 + f_011*tmp0_40 + f_110*tmp0_41 + f_111*tmp0_43;
                  out[INDEX4(i,0,7,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_8 + f_011*tmp0_6 + f_110*tmp0_7 + f_111*tmp0_9;
                  out[INDEX4(i,1,7,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_30*(f_010 + f_110) + tmp0_31*(f_011 + f_111) + tmp0_32*(f_000 + f_100) + tmp0_33*(f_001 + f_101);
                  out[INDEX4(i,2,7,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_44*(f_011 + f_111) + tmp0_45*(f_010 + f_110);
                  out[INDEX4(i,0,8,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_8 + f_011*tmp0_6 + f_110*tmp0_7 + f_111*tmp0_9;
                  out[INDEX4(i,1,8,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_37 + f_010*tmp0_35 + f_101*tmp0_38 + f_111*tmp0_36 + tmp0_34*(f_011 + f_110) + tmp0_39*(f_001 + f_100);
                  out[INDEX4(i,2,8,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_010*tmp0_48 + f_011*tmp0_46 + f_110*tmp0_47 + f_111*tmp0_49;
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k2 loop */
      } /* end of face 3 */
      if (face_offset(4)>-1) {
         const double tmp0_22 = -0.012701665379258311482/h2;
         const double tmp0_16 = -0.11270166537925831148/h1;
         const double tmp0_33 = -0.012701665379258311482/h2;
         const double tmp0_0 = -0.88729833462074168852/h0;
         const double tmp0_21 = -0.1/h2;
         const double tmp0_17 = -0.88729833462074168852/h1;
         const double tmp0_1 = 0.88729833462074168852/h0;
         const double tmp0_20 = -0.78729833462074168852/h2;
         const double tmp0_14 = -0.5/h1;
         const double tmp0_49 = 0.78729833462074168852/h2;
         const double tmp0_2 = 0.11270166537925831148/h0;
         const double tmp0_27 = -0.056350832689629155741/h2;
         const double tmp0_15 = 0.5/h1;
         const double tmp0_48 = 0.1/h2;
         const double tmp0_3 = -0.11270166537925831148/h0;
         const double tmp0_26 = -0.44364916731037084426/h2;
         const double tmp0_12 = 0.11270166537925831148/h1;
         const double tmp0_25 = 0.012701665379258311482/h2;
         const double tmp0_13 = 0.88729833462074168852/h1;
         const double tmp0_24 = 0.1/h2;
         const double tmp0_10 = -0.88729833462074168852/h1;
         const double tmp0_11 = -0.11270166537925831148/h1;
         const double tmp0_38 = -0.25/h2;
         const double tmp0_34 = 0.1/h2;
         const double tmp0_42 = 0.056350832689629155741/h2;
         const double tmp0_35 = 0.78729833462074168852/h2;
         const double tmp0_36 = 0.012701665379258311482/h2;
         const double tmp0_41 = -0.44364916731037084426/h2;
         const double tmp0_8 = 0.88729833462074168852/h0;
         const double tmp0_37 = 0.1/h2;
         const double tmp0_29 = 0.056350832689629155741/h2;
         const double tmp0_40 = -0.056350832689629155741/h2;
         const double tmp0_9 = -0.88729833462074168852/h0;
         const double tmp0_30 = -0.1/h2;
         const double tmp0_28 = 0.44364916731037084426/h2;
         const double tmp0_43 = 0.44364916731037084426/h2;
         const double tmp0_32 = -0.1/h2;
         const double tmp0_31 = -0.78729833462074168852/h2;
         const double tmp0_39 = 0.25/h2;
         const double tmp0_18 = 0.88729833462074168852/h1;
         const double tmp0_45 = -0.1/h2;
         const double tmp0_4 = -0.5/h0;
         const double tmp0_19 = 0.11270166537925831148/h1;
         const double tmp0_44 = -0.012701665379258311483/h2;
         const double tmp0_5 = 0.5/h0;
         const double tmp0_47 = 0.012701665379258311483/h2;
         const double tmp0_6 = -0.11270166537925831148/h0;
         const double tmp0_23 = 0.78729833462074168852/h2;
         const double tmp0_46 = -0.78729833462074168852/h2;
         const double tmp0_7 = 0.11270166537925831148/h0;
         #pragma omp parallel for private(i,k1,k0)
         for (k1 =0; k1 < N1; ++k1) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,k1,0, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,k1,0, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,k1+1,0, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,k1+1,0, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,k1,1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,k1,1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,k1+1,1, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,k1+1,1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_010*tmp0_3 + f_100*tmp0_1 + f_110*tmp0_2;
                  out[INDEX4(i,1,0,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_010*tmp0_13 + f_100*tmp0_11 + f_110*tmp0_12;
                  out[INDEX4(i,2,0,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_20 + f_001*tmp0_23 + f_110*tmp0_22 + f_111*tmp0_25 + tmp0_21*(f_010 + f_100) + tmp0_24*(f_011 + f_101);
                  out[INDEX4(i,0,1,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_010*tmp0_3 + f_100*tmp0_1 + f_110*tmp0_2;
                  out[INDEX4(i,1,1,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_14*(f_000 + f_100) + tmp0_15*(f_010 + f_110);
                  out[INDEX4(i,2,1,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_26*(f_000 + f_100) + tmp0_27*(f_010 + f_110) + tmp0_28*(f_001 + f_101) + tmp0_29*(f_011 + f_111);
                  out[INDEX4(i,0,2,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_0 + f_010*tmp0_3 + f_100*tmp0_1 + f_110*tmp0_2;
                  out[INDEX4(i,1,2,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_16 + f_010*tmp0_19 + f_100*tmp0_17 + f_110*tmp0_18;
                  out[INDEX4(i,2,2,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_30 + f_001*tmp0_34 + f_010*tmp0_33 + f_011*tmp0_36 + f_100*tmp0_31 + f_101*tmp0_35 + f_110*tmp0_32 + f_111*tmp0_37;
                  out[INDEX4(i,0,3,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_000 + f_010) + tmp0_5*(f_100 + f_110);
                  out[INDEX4(i,1,3,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_010*tmp0_13 + f_100*tmp0_11 + f_110*tmp0_12;
                  out[INDEX4(i,2,3,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_26*(f_000 + f_010) + tmp0_27*(f_100 + f_110) + tmp0_28*(f_001 + f_011) + tmp0_29*(f_101 + f_111);
                  out[INDEX4(i,0,4,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_000 + f_010) + tmp0_5*(f_100 + f_110);
                  out[INDEX4(i,1,4,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_14*(f_000 + f_100) + tmp0_15*(f_010 + f_110);
                  out[INDEX4(i,2,4,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_38*(f_000 + f_010 + f_100 + f_110) + tmp0_39*(f_001 + f_011 + f_101 + f_111);
                  out[INDEX4(i,0,5,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_000 + f_010) + tmp0_5*(f_100 + f_110);
                  out[INDEX4(i,1,5,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_16 + f_010*tmp0_19 + f_100*tmp0_17 + f_110*tmp0_18;
                  out[INDEX4(i,2,5,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_40*(f_000 + f_010) + tmp0_41*(f_100 + f_110) + tmp0_42*(f_001 + f_011) + tmp0_43*(f_101 + f_111);
                  out[INDEX4(i,0,6,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_6 + f_010*tmp0_9 + f_100*tmp0_7 + f_110*tmp0_8;
                  out[INDEX4(i,1,6,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_10 + f_010*tmp0_13 + f_100*tmp0_11 + f_110*tmp0_12;
                  out[INDEX4(i,2,6,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_30 + f_001*tmp0_34 + f_010*tmp0_31 + f_011*tmp0_35 + f_100*tmp0_33 + f_101*tmp0_36 + f_110*tmp0_32 + f_111*tmp0_37;
                  out[INDEX4(i,0,7,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_6 + f_010*tmp0_9 + f_100*tmp0_7 + f_110*tmp0_8;
                  out[INDEX4(i,1,7,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_14*(f_000 + f_100) + tmp0_15*(f_010 + f_110);
                  out[INDEX4(i,2,7,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_40*(f_000 + f_100) + tmp0_41*(f_010 + f_110) + tmp0_42*(f_001 + f_101) + tmp0_43*(f_011 + f_111);
                  out[INDEX4(i,0,8,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_6 + f_010*tmp0_9 + f_100*tmp0_7 + f_110*tmp0_8;
                  out[INDEX4(i,1,8,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_16 + f_010*tmp0_19 + f_100*tmp0_17 + f_110*tmp0_18;
                  out[INDEX4(i,2,8,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_44 + f_001*tmp0_47 + f_110*tmp0_46 + f_111*tmp0_49 + tmp0_45*(f_010 + f_100) + tmp0_48*(f_011 + f_101);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k1 loop */
      } /* end of face 4 */
      if (face_offset(5)>-1) {
         const double tmp0_22 = 0.012701665379258311482/h2;
         const double tmp0_16 = -0.11270166537925831148/h1;
         const double tmp0_33 = 0.1/h2;
         const double tmp0_0 = -0.88729833462074168852/h0;
         const double tmp0_21 = 0.1/h2;
         const double tmp0_17 = -0.88729833462074168852/h1;
         const double tmp0_1 = 0.88729833462074168852/h0;
         const double tmp0_20 = 0.78729833462074168852/h2;
         const double tmp0_14 = -0.5/h1;
         const double tmp0_49 = -0.78729833462074168852/h2;
         const double tmp0_2 = -0.11270166537925831148/h0;
         const double tmp0_27 = 0.056350832689629155741/h2;
         const double tmp0_15 = 0.5/h1;
         const double tmp0_48 = -0.1/h2;
         const double tmp0_3 = 0.11270166537925831148/h0;
         const double tmp0_26 = 0.44364916731037084426/h2;
         const double tmp0_12 = 0.88729833462074168852/h1;
         const double tmp0_25 = -0.012701665379258311482/h2;
         const double tmp0_13 = 0.11270166537925831148/h1;
         const double tmp0_24 = -0.1/h2;
         const double tmp0_10 = -0.88729833462074168852/h1;
         const double tmp0_11 = -0.11270166537925831148/h1;
         const double tmp0_38 = 0.25/h2;
         const double tmp0_34 = -0.1/h2;
         const double tmp0_42 = -0.056350832689629155741/h2;
         const double tmp0_35 = -0.78729833462074168852/h2;
         const double tmp0_36 = -0.1/h2;
         const double tmp0_41 = 0.44364916731037084426/h2;
         const double tmp0_8 = -0.88729833462074168852/h0;
         const double tmp0_37 = -0.012701665379258311482/h2;
         const double tmp0_29 = -0.056350832689629155741/h2;
         const double tmp0_40 = 0.056350832689629155741/h2;
         const double tmp0_9 = 0.88729833462074168852/h0;
         const double tmp0_30 = 0.1/h2;
         const double tmp0_28 = -0.44364916731037084426/h2;
         const double tmp0_43 = -0.44364916731037084426/h2;
         const double tmp0_32 = 0.012701665379258311482/h2;
         const double tmp0_31 = 0.78729833462074168852/h2;
         const double tmp0_39 = -0.25/h2;
         const double tmp0_18 = 0.11270166537925831148/h1;
         const double tmp0_45 = 0.1/h2;
         const double tmp0_4 = -0.5/h0;
         const double tmp0_19 = 0.88729833462074168852/h1;
         const double tmp0_44 = 0.012701665379258311483/h2;
         const double tmp0_5 = 0.5/h0;
         const double tmp0_47 = -0.012701665379258311483/h2;
         const double tmp0_6 = -0.11270166537925831148/h0;
         const double tmp0_23 = -0.78729833462074168852/h2;
         const double tmp0_46 = 0.78729833462074168852/h2;
         const double tmp0_7 = 0.11270166537925831148/h0;
         #pragma omp parallel for private(i,k1,k0)
         for (k1 =0; k1 < N1; ++k1) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,k1,M2-1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,k1,M2-1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,k1+1,M2-1, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,k1+1,M2-1, M0,M1),NCOMP)];
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,k1,M2-2, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,k1,M2-2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,k1+1,M2-2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,k1+1,M2-2, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_0 + f_011*tmp0_2 + f_101*tmp0_1 + f_111*tmp0_3;
                  out[INDEX4(i,1,0,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_10 + f_011*tmp0_12 + f_101*tmp0_11 + f_111*tmp0_13;
                  out[INDEX4(i,2,0,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_23 + f_001*tmp0_20 + f_110*tmp0_25 + f_111*tmp0_22 + tmp0_21*(f_011 + f_101) + tmp0_24*(f_010 + f_100);
                  out[INDEX4(i,0,1,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_0 + f_011*tmp0_2 + f_101*tmp0_1 + f_111*tmp0_3;
                  out[INDEX4(i,1,1,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_14*(f_001 + f_101) + tmp0_15*(f_011 + f_111);
                  out[INDEX4(i,2,1,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_26*(f_001 + f_101) + tmp0_27*(f_011 + f_111) + tmp0_28*(f_000 + f_100) + tmp0_29*(f_010 + f_110);
                  out[INDEX4(i,0,2,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_0 + f_011*tmp0_2 + f_101*tmp0_1 + f_111*tmp0_3;
                  out[INDEX4(i,1,2,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_16 + f_011*tmp0_18 + f_101*tmp0_17 + f_111*tmp0_19;
                  out[INDEX4(i,2,2,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_34 + f_001*tmp0_30 + f_010*tmp0_37 + f_011*tmp0_32 + f_100*tmp0_35 + f_101*tmp0_31 + f_110*tmp0_36 + f_111*tmp0_33;
                  out[INDEX4(i,0,3,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_001 + f_011) + tmp0_5*(f_101 + f_111);
                  out[INDEX4(i,1,3,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_10 + f_011*tmp0_12 + f_101*tmp0_11 + f_111*tmp0_13;
                  out[INDEX4(i,2,3,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_26*(f_001 + f_011) + tmp0_27*(f_101 + f_111) + tmp0_28*(f_000 + f_010) + tmp0_29*(f_100 + f_110);
                  out[INDEX4(i,0,4,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_001 + f_011) + tmp0_5*(f_101 + f_111);
                  out[INDEX4(i,1,4,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_14*(f_001 + f_101) + tmp0_15*(f_011 + f_111);
                  out[INDEX4(i,2,4,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_38*(f_001 + f_011 + f_101 + f_111) + tmp0_39*(f_000 + f_010 + f_100 + f_110);
                  out[INDEX4(i,0,5,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_4*(f_001 + f_011) + tmp0_5*(f_101 + f_111);
                  out[INDEX4(i,1,5,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_16 + f_011*tmp0_18 + f_101*tmp0_17 + f_111*tmp0_19;
                  out[INDEX4(i,2,5,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_40*(f_001 + f_011) + tmp0_41*(f_101 + f_111) + tmp0_42*(f_000 + f_010) + tmp0_43*(f_100 + f_110);
                  out[INDEX4(i,0,6,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_6 + f_011*tmp0_8 + f_101*tmp0_7 + f_111*tmp0_9;
                  out[INDEX4(i,1,6,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_10 + f_011*tmp0_12 + f_101*tmp0_11 + f_111*tmp0_13;
                  out[INDEX4(i,2,6,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_34 + f_001*tmp0_30 + f_010*tmp0_35 + f_011*tmp0_31 + f_100*tmp0_37 + f_101*tmp0_32 + f_110*tmp0_36 + f_111*tmp0_33;
                  out[INDEX4(i,0,7,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_6 + f_011*tmp0_8 + f_101*tmp0_7 + f_111*tmp0_9;
                  out[INDEX4(i,1,7,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_14*(f_001 + f_101) + tmp0_15*(f_011 + f_111);
                  out[INDEX4(i,2,7,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = tmp0_40*(f_001 + f_101) + tmp0_41*(f_011 + f_111) + tmp0_42*(f_000 + f_100) + tmp0_43*(f_010 + f_110);
                  out[INDEX4(i,0,8,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_6 + f_011*tmp0_8 + f_101*tmp0_7 + f_111*tmp0_9;
                  out[INDEX4(i,1,8,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_001*tmp0_16 + f_011*tmp0_18 + f_101*tmp0_17 + f_111*tmp0_19;
                  out[INDEX4(i,2,8,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,9)] = f_000*tmp0_47 + f_001*tmp0_44 + f_110*tmp0_49 + f_111*tmp0_46 + tmp0_45*(f_011 + f_101) + tmp0_48*(f_010 + f_100);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k1 loop */
      } /* end of face 5 */
   } else if (out_data_type==RIPLEY_REDUCED_BOUNDARY_ELEMENTS) {
      if (face_offset(0)>-1) {
         const double tmp0_0 = -0.25/h0;
         const double tmp0_4 = -0.5/h2;
         const double tmp0_1 = 0.25/h0;
         const double tmp0_5 = 0.5/h2;
         const double tmp0_2 = -0.5/h1;
         const double tmp0_3 = 0.5/h1;
         #pragma omp parallel for private(i,k2,k1)
         for (k2 =0; k2 < N2; ++k2) {
            for (k1 =0; k1 < N1; ++k1) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(0,k1,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(0,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(1,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(0,k1+1,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(1,k1,k2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(1,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(0,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(1,k1+1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_000 + f_001 + f_010 + f_011) + tmp0_1*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,0,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_000 + f_001) + tmp0_3*(f_010 + f_011);
                  out[INDEX4(i,2,0,face_offset(0)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_000 + f_010) + tmp0_5*(f_001 + f_011);
               } /* close component loop i */
            } /* close k1 loop */
         } /* close k2 loop */
      } /* end of face 0 */
      if (face_offset(1)>-1) {
         const double tmp0_0 = -0.25/h0;
         const double tmp0_4 = 0.5/h2;
         const double tmp0_1 = 0.25/h0;
         const double tmp0_5 = -0.5/h2;
         const double tmp0_2 = -0.5/h1;
         const double tmp0_3 = 0.5/h1;
         #pragma omp parallel for private(i,k2,k1)
         for (k2 =0; k2 < N2; ++k2) {
            for (k1 =0; k1 < N1; ++k1) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(M0-2,k1,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(M0-2,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(M0-1,k1,k2+1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(M0-2,k1+1,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(M0-1,k1,k2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(M0-1,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(M0-2,k1+1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(M0-1,k1+1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_000 + f_001 + f_010 + f_011) + tmp0_1*(f_100 + f_101 + f_110 + f_111);
                  out[INDEX4(i,1,0,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_100 + f_101) + tmp0_3*(f_110 + f_111);
                  out[INDEX4(i,2,0,face_offset(1)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_101 + f_111) + tmp0_5*(f_100 + f_110);
               } /* close component loop i */
            } /* close k1 loop */
         } /* close k2 loop */
      } /* end of face 1 */
      if (face_offset(2)>-1) {
         const double tmp0_0 = -0.5/h0;
         const double tmp0_4 = -0.5/h2;
         const double tmp0_1 = 0.5/h0;
         const double tmp0_5 = 0.5/h2;
         const double tmp0_2 = -0.25/h1;
         const double tmp0_3 = 0.25/h1;
         #pragma omp parallel for private(i,k2,k0)
         for (k2 =0; k2 < N2; ++k2) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,0,k2, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,0,k2+1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,0,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,0,k2, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,1,k2+1, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,1,k2+1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_000 + f_001) + tmp0_1*(f_100 + f_101);
                  out[INDEX4(i,1,0,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_000 + f_001 + f_100 + f_101) + tmp0_3*(f_010 + f_011 + f_110 + f_111);
                  out[INDEX4(i,2,0,face_offset(2)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_000 + f_100) + tmp0_5*(f_001 + f_101);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k2 loop */
      } /* end of face 2 */
      if (face_offset(3)>-1) {
         const double tmp0_0 = -0.5/h0;
         const double tmp0_4 = 0.5/h2;
         const double tmp0_1 = 0.5/h0;
         const double tmp0_5 = -0.5/h2;
         const double tmp0_2 = 0.25/h1;
         const double tmp0_3 = -0.25/h1;
         #pragma omp parallel for private(i,k2,k0)
         for (k2 =0; k2 < N2; ++k2) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,M1-1,k2+1, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,M1-1,k2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,M1-1,k2, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,M1-1,k2+1, M0,M1),NCOMP)];
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,M1-2,k2, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,M1-2,k2+1, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,M1-2,k2+1, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,M1-2,k2, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_010 + f_011) + tmp0_1*(f_110 + f_111);
                  out[INDEX4(i,1,0,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_010 + f_011 + f_110 + f_111) + tmp0_3*(f_000 + f_001 + f_100 + f_101);
                  out[INDEX4(i,2,0,face_offset(3)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_011 + f_111) + tmp0_5*(f_010 + f_110);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k2 loop */
      } /* end of face 3 */
      if (face_offset(4)>-1) {
         const double tmp0_0 = -0.5/h0;
         const double tmp0_4 = -0.25/h2;
         const double tmp0_1 = 0.5/h0;
         const double tmp0_5 = 0.25/h2;
         const double tmp0_2 = -0.5/h1;
         const double tmp0_3 = 0.5/h1;
         #pragma omp parallel for private(i,k1,k0)
         for (k1 =0; k1 < N1; ++k1) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,k1,0, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,k1,0, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,k1+1,0, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,k1+1,0, M0,M1),NCOMP)];
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,k1,1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,k1,1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,k1+1,1, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,k1+1,1, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_000 + f_010) + tmp0_1*(f_100 + f_110);
                  out[INDEX4(i,1,0,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_000 + f_100) + tmp0_3*(f_010 + f_110);
                  out[INDEX4(i,2,0,face_offset(4)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_000 + f_010 + f_100 + f_110) + tmp0_5*(f_001 + f_011 + f_101 + f_111);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k1 loop */
      } /* end of face 4 */
      if (face_offset(5)>-1) {
         const double tmp0_0 = -0.5/h0;
         const double tmp0_4 = 0.25/h2;
         const double tmp0_1 = 0.5/h0;
         const double tmp0_5 = -0.25/h2;
         const double tmp0_2 = -0.5/h1;
         const double tmp0_3 = 0.5/h1;
         #pragma omp parallel for private(i,k1,k0)
         for (k1 =0; k1 < N1; ++k1) {
            for (k0 =0; k0 < N0; ++k0) {
               for (i =0; i < NCOMP; ++i) {
                  register const double f_001 = in[INDEX2(i,INDEX3(k0,k1,M2-1, M0,M1),NCOMP)];
                  register const double f_101 = in[INDEX2(i,INDEX3(k0+1,k1,M2-1, M0,M1),NCOMP)];
                  register const double f_011 = in[INDEX2(i,INDEX3(k0,k1+1,M2-1, M0,M1),NCOMP)];
                  register const double f_111 = in[INDEX2(i,INDEX3(k0+1,k1+1,M2-1, M0,M1),NCOMP)];
                  register const double f_000 = in[INDEX2(i,INDEX3(k0,k1,M2-2, M0,M1),NCOMP)];
                  register const double f_100 = in[INDEX2(i,INDEX3(k0+1,k1,M2-2, M0,M1),NCOMP)];
                  register const double f_110 = in[INDEX2(i,INDEX3(k0+1,k1+1,M2-2, M0,M1),NCOMP)];
                  register const double f_010 = in[INDEX2(i,INDEX3(k0,k1+1,M2-2, M0,M1),NCOMP)];
                  out[INDEX4(i,0,0,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_0*(f_001 + f_011) + tmp0_1*(f_101 + f_111);
                  out[INDEX4(i,1,0,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_2*(f_001 + f_101) + tmp0_3*(f_011 + f_111);
                  out[INDEX4(i,2,0,face_offset(5)+INDEX3(k0,k1,k2,N0,N1),NCOMP,3,1)] = tmp0_4*(f_001 + f_011 + f_101 + f_111) + tmp0_5*(f_000 + f_010 + f_100 + f_110);
               } /* close component loop i */
            } /* close k0 loop */
         } /* close k1 loop */
      } /* end of face 5 */
   } /* end of out_data_type branching
   /* GENERATOR SNIP BOTTOM */
}
