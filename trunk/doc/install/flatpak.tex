%!TEX root = install.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Copyright (c) 2012-2018 by The University of Queensland
% http://www.uq.edu.au
%
% Primary Business: Queensland, Australia
% Licensed under the Apache License, version 2.0
% http://www.apache.org/licenses/LICENSE-2.0
%
% Development until 2012 by Earth Systems Science Computational Center (ESSCC)
% Development 2012-2013 by School of Earth Sciences
% Development from 2014 by Centre for Geoscience Computing (GeoComp)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Notes about compilers

\chapter{Installing from flatpak}\label{chap:flatpak}

To install \escript on any linux distribution using flatpak, first install both flatpak and flatpak-builder version 1.20 or later\footnote{If using debian linux, this will require installing flatpak and flatpak-builder from the stretch backports repository.} then add the flathub repo and install the freedesktop SDK

\begin{smallShellCode}
flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
flatpak install flathub org.freedesktop.Platform//18.08 org.freedesktop.Sdk//18.08
\end{smallShellCode}

Now, download the flatpak manifest file\footnote{Available at \url{https://launchpad.net/escript-finley/}} and run the command

\begin{smallShellCode}
flatpak-builder --install --user [some build directory] [path to escript.json]
\end{smallShellCode}

This will install escript with both the Trilinos and PASO solver libraries, with openMP but without OPENMPI. You can now run escript by typing

\begin{smallShellCode}
flatpak run uq.esys.escript [other arguments to pass to escript]
\end{smallShellCode}

Unfortunately, flatpak runs applications inside an isolated environment called a `sandbox'. Consequently, \escript will not be able to access any python modules that have been installed on the system. To install a python module inside the flatpak sandbox, so that \escript can load them, type

\begin{smallShellCode}
flatpak run uq.esys.escript pip3 install [module name]
\end{smallShellCode}

Finally, to uninstall \escript, type

\begin{smallShellCode}
flatpak uninstall escript
\end{smallShellCode}
