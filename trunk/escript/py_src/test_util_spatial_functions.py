# $Id$
"""
basic tests for functions in util.py effecting the spatial distribution 

it is assumed that the domain is the usint square/cube 

not all these test will run for all domains. check the doc string for the assumptions of a particular test

@var __author__: name of author
@var __licence__: licence agreement
@var __url__: url entry point on documentation
@var __version__: version
@var __date__: date of the version
"""
__author__="Lutz Gross, l.gross@uq.edu.au"
__licence__="contact: esys@access.uq.edu.au"
__url__="http://www.iservo.edu.au/esys/escript"
__version__="$Revision$"
__date__="$Date$"

import unittest
from esys.escript import *
from numarray import array

class Test_Util_SpatialFunctions(unittest.TestCase):
   RES_TOL=1.e-8
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.465976690369)*x[0]**o+(-0.25136070196)*x[0]+(0.409576841566)*x[1]**o+(0.726707772754)*x[1]
        ref=(0.875553531935)/(o+1.)+(0.237673535397)
      else:
        arg=(0.567785895928)*x[0]**o+(0.928477128396)*x[0]+(-0.625720943088)*x[1]**o+(-0.681460841298)*x[1]+(-0.866801010069)*x[2]**o+(0.159594300637)*x[2]
        ref=(-0.924736057229)/(o+1.)+(0.203305293867)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(-0.839020088668)*x[0]**o+(-0.880288035177)*x[0]+(0.260951734364)*x[1]**o+(-0.624208000982)*x[1]
        arg[1]=(0.985421831314)*x[0]**o+(0.660399229451)*x[0]+(-0.514003848134)*x[1]**o+(0.0312162082593)*x[1]
        ref[0]=(-0.578068354304)/(o+1.)+(-0.75224801808)
        ref[1]=(0.47141798318)/(o+1.)+(0.345807718855)
      else:
        arg[0]=(-0.627307316929)*x[0]**o+(0.500432411035)*x[0]+(0.233895908313)*x[1]**o+(-0.125048135432)*x[1]+(0.0695114009632)*x[2]**o+(0.995170977074)*x[2]
        arg[1]=(0.760033715785)*x[0]**o+(0.48895905139)*x[0]+(0.240372023176)*x[1]**o+(0.33946689896)*x[1]+(-0.774638489419)*x[2]**o+(-0.0777240871074)*x[2]
        ref[0]=(-0.323900007653)/(o+1.)+(0.685277626338)
        ref[1]=(0.225767249542)/(o+1.)+(0.375350931622)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.844492048883)*x[0]**o+(0.727132679659)*x[0]+(-0.862576284722)*x[1]**o+(0.502937561417)*x[1]
        arg[0,1]=(-0.587157419309)*x[0]**o+(0.00327068097107)*x[0]+(0.422592349683)*x[1]**o+(0.167479615369)*x[1]
        arg[0,2]=(0.771156665672)*x[0]**o+(-0.371091138833)*x[0]+(-0.867750378658)*x[1]**o+(-0.744394290185)*x[1]
        arg[0,3]=(0.669718598855)*x[0]**o+(-0.0825909409121)*x[0]+(0.868872948791)*x[1]**o+(0.141891982204)*x[1]
        arg[0,4]=(-0.441072764653)*x[0]**o+(-0.929654649265)*x[0]+(-0.35883498816)*x[1]**o+(-0.84045480381)*x[1]
        arg[1,0]=(0.555668196622)*x[0]**o+(0.94306681043)*x[0]+(0.586512446245)*x[1]**o+(0.702007276327)*x[1]
        arg[1,1]=(0.792083771005)*x[0]**o+(-0.865830139617)*x[0]+(0.0929971631615)*x[1]**o+(0.620446289121)*x[1]
        arg[1,2]=(-0.201978375472)*x[0]**o+(-0.0777206885918)*x[0]+(0.798755459687)*x[1]**o+(-0.278086468846)*x[1]
        arg[1,3]=(0.063028419572)*x[0]**o+(-0.454786232294)*x[0]+(-0.0481393324293)*x[1]**o+(-0.612657132834)*x[1]
        arg[1,4]=(-0.743283787964)*x[0]**o+(0.854827303846)*x[0]+(0.94241635825)*x[1]**o+(0.436937526521)*x[1]
        arg[2,0]=(-0.814975695669)*x[0]**o+(0.579477783769)*x[0]+(0.00998264005965)*x[1]**o+(-0.913665878657)*x[1]
        arg[2,1]=(-0.526833976369)*x[0]**o+(-0.800386086232)*x[0]+(-0.487600053086)*x[1]**o+(0.00242562519003)*x[1]
        arg[2,2]=(-0.964119591874)*x[0]**o+(0.203212394214)*x[0]+(-0.96850837954)*x[1]**o+(-0.214886132512)*x[1]
        arg[2,3]=(-0.356249104564)*x[0]**o+(0.329769293221)*x[0]+(0.936664928754)*x[1]**o+(0.520603503283)*x[1]
        arg[2,4]=(0.255464219424)*x[0]**o+(-0.157783294516)*x[0]+(0.519451787865)*x[1]**o+(0.00960521397376)*x[1]
        arg[3,0]=(-0.117250486034)*x[0]**o+(0.192945431273)*x[0]+(-0.7580154297)*x[1]**o+(-0.308801650294)*x[1]
        arg[3,1]=(0.243931002845)*x[0]**o+(-0.626714191745)*x[0]+(-0.365870571265)*x[1]**o+(0.652257582021)*x[1]
        arg[3,2]=(-0.769756656122)*x[0]**o+(0.711106390017)*x[0]+(0.150749630653)*x[1]**o+(-0.0441309732448)*x[1]
        arg[3,3]=(0.92677837493)*x[0]**o+(0.507199859313)*x[0]+(-0.542275490828)*x[1]**o+(-0.0907270087228)*x[1]
        arg[3,4]=(-0.0306175885885)*x[0]**o+(-0.434666505018)*x[0]+(-0.815633427562)*x[1]**o+(-0.916424797903)*x[1]
        ref[0,0]=(-1.70706833361)/(o+1.)+(0.615035120538)
        ref[0,1]=(-0.164565069626)/(o+1.)+(0.08537514817)
        ref[0,2]=(-0.0965937129851)/(o+1.)+(-0.557742714509)
        ref[0,3]=(1.53859154765)/(o+1.)+(0.0296505206459)
        ref[0,4]=(-0.799907752814)/(o+1.)+(-0.885054726537)
        ref[1,0]=(1.14218064287)/(o+1.)+(0.822537043379)
        ref[1,1]=(0.885080934167)/(o+1.)+(-0.122691925248)
        ref[1,2]=(0.596777084215)/(o+1.)+(-0.177903578719)
        ref[1,3]=(0.0148890871427)/(o+1.)+(-0.533721682564)
        ref[1,4]=(0.199132570285)/(o+1.)+(0.645882415184)
        ref[2,0]=(-0.80499305561)/(o+1.)+(-0.167094047444)
        ref[2,1]=(-1.01443402945)/(o+1.)+(-0.398980230521)
        ref[2,2]=(-1.93262797141)/(o+1.)+(-0.00583686914904)
        ref[2,3]=(0.580415824189)/(o+1.)+(0.425186398252)
        ref[2,4]=(0.774916007289)/(o+1.)+(-0.074089040271)
        ref[3,0]=(-0.875265915734)/(o+1.)+(-0.0579281095106)
        ref[3,1]=(-0.12193956842)/(o+1.)+(0.0127716951382)
        ref[3,2]=(-0.619007025469)/(o+1.)+(0.333487708386)
        ref[3,3]=(0.384502884102)/(o+1.)+(0.208236425295)
        ref[3,4]=(-0.846251016151)/(o+1.)+(-0.675545651461)
      else:
        arg[0,0]=(0.596538443259)*x[0]**o+(0.479462980373)*x[0]+(-0.334469126403)*x[1]**o+(0.784201085556)*x[1]+(-0.231474140531)*x[2]**o+(-0.368096345589)*x[2]
        arg[0,1]=(0.188945383338)*x[0]**o+(-0.95033024122)*x[0]+(0.567904901047)*x[1]**o+(-0.76703296351)*x[1]+(-0.0116083690376)*x[2]**o+(-0.211176589764)*x[2]
        arg[0,2]=(0.225412552449)*x[0]**o+(-0.731615155924)*x[0]+(-0.362727501637)*x[1]**o+(-0.195442119344)*x[1]+(-0.215444456285)*x[2]**o+(0.412715796392)*x[2]
        arg[0,3]=(-0.00941287481408)*x[0]**o+(-0.207271678463)*x[0]+(0.66582433583)*x[1]**o+(-0.297871484308)*x[1]+(-0.819460465536)*x[2]**o+(-0.3316307033)*x[2]
        arg[0,4]=(-0.172265683581)*x[0]**o+(0.881658164973)*x[0]+(0.0267816673708)*x[1]**o+(-0.526757427521)*x[1]+(-0.666953449252)*x[2]**o+(0.366533690002)*x[2]
        arg[1,0]=(-0.575272180021)*x[0]**o+(-0.707236339163)*x[0]+(-0.734723292219)*x[1]**o+(-0.872019568084)*x[1]+(-0.513269190461)*x[2]**o+(-0.95077853535)*x[2]
        arg[1,1]=(0.687652562435)*x[0]**o+(0.500668143461)*x[0]+(0.127678854367)*x[1]**o+(0.135196530391)*x[1]+(0.219757431874)*x[2]**o+(0.43373842168)*x[2]
        arg[1,2]=(-0.674120744855)*x[0]**o+(-0.792769889708)*x[0]+(0.0414602844391)*x[1]**o+(-0.159887164563)*x[1]+(0.406441555189)*x[2]**o+(-0.662210077269)*x[2]
        arg[1,3]=(-0.623120612358)*x[0]**o+(0.895951757448)*x[0]+(0.957407224559)*x[1]**o+(-0.472225118848)*x[1]+(-0.294551998847)*x[2]**o+(0.503584320886)*x[2]
        arg[1,4]=(-0.304220645545)*x[0]**o+(0.812321371589)*x[0]+(0.932257196386)*x[1]**o+(0.736014913915)*x[1]+(0.119140391025)*x[2]**o+(0.910696940879)*x[2]
        arg[2,0]=(0.275470013797)*x[0]**o+(-0.903754203548)*x[0]+(-0.443211232771)*x[1]**o+(0.78815938507)*x[1]+(-0.0802934106722)*x[2]**o+(0.096532189886)*x[2]
        arg[2,1]=(-0.4505392488)*x[0]**o+(-0.668542586506)*x[0]+(0.487967999984)*x[1]**o+(-0.642310745404)*x[1]+(-0.956530771836)*x[2]**o+(0.517544404873)*x[2]
        arg[2,2]=(-0.984032885692)*x[0]**o+(-0.606688527142)*x[0]+(0.0565483776156)*x[1]**o+(-0.945228520749)*x[1]+(0.433070187921)*x[2]**o+(-0.599983370996)*x[2]
        arg[2,3]=(-0.673469008741)*x[0]**o+(0.612144012035)*x[0]+(-0.169497339443)*x[1]**o+(0.267990057152)*x[1]+(0.431716413548)*x[2]**o+(0.188904436012)*x[2]
        arg[2,4]=(0.320782309844)*x[0]**o+(-0.830068082984)*x[0]+(0.900183436056)*x[1]**o+(-0.343951186189)*x[1]+(-0.00137135137854)*x[2]**o+(-0.655764522249)*x[2]
        arg[3,0]=(-0.936193981767)*x[0]**o+(0.885260284217)*x[0]+(0.00397725971098)*x[1]**o+(-0.0864751234501)*x[1]+(0.25001166345)*x[2]**o+(-0.127859505667)*x[2]
        arg[3,1]=(-0.0841986843231)*x[0]**o+(-0.95678469673)*x[0]+(0.867049114883)*x[1]**o+(0.154499266839)*x[1]+(0.0217146474622)*x[2]**o+(-0.945774319527)*x[2]
        arg[3,2]=(-0.668161122306)*x[0]**o+(0.779140555525)*x[0]+(0.217613826157)*x[1]**o+(0.900077039607)*x[1]+(-0.251881965789)*x[2]**o+(-0.331281723354)*x[2]
        arg[3,3]=(-0.95624079226)*x[0]**o+(-0.403226291225)*x[0]+(0.303340462877)*x[1]**o+(-0.269819286355)*x[1]+(0.605804508829)*x[2]**o+(-0.461404715818)*x[2]
        arg[3,4]=(-0.933059329973)*x[0]**o+(-0.00851461368762)*x[0]+(0.0588544443918)*x[1]**o+(-0.682939702389)*x[1]+(-0.213965742261)*x[2]**o+(-0.102965977964)*x[2]
        ref[0,0]=(0.0305951763245)/(o+1.)+(0.44778386017)
        ref[0,1]=(0.745241915348)/(o+1.)+(-0.964269897247)
        ref[0,2]=(-0.352759405473)/(o+1.)+(-0.257170739438)
        ref[0,3]=(-0.163049004521)/(o+1.)+(-0.418386933036)
        ref[0,4]=(-0.812437465462)/(o+1.)+(0.360717213727)
        ref[1,0]=(-1.8232646627)/(o+1.)+(-1.2650172213)
        ref[1,1]=(1.03508884868)/(o+1.)+(0.534801547766)
        ref[1,2]=(-0.226218905227)/(o+1.)+(-0.80743356577)
        ref[1,3]=(0.0397346133545)/(o+1.)+(0.463655479743)
        ref[1,4]=(0.747176941866)/(o+1.)+(1.22951661319)
        ref[2,0]=(-0.248034629647)/(o+1.)+(-0.00953131429598)
        ref[2,1]=(-0.919102020652)/(o+1.)+(-0.396654463518)
        ref[2,2]=(-0.494414320156)/(o+1.)+(-1.07595020944)
        ref[2,3]=(-0.411249934637)/(o+1.)+(0.534519252599)
        ref[2,4]=(1.21959439452)/(o+1.)+(-0.914891895711)
        ref[3,0]=(-0.682205058606)/(o+1.)+(0.33546282755)
        ref[3,1]=(0.804565078022)/(o+1.)+(-0.874029874709)
        ref[3,2]=(-0.702429261938)/(o+1.)+(0.673967935889)
        ref[3,3]=(-0.0470958205546)/(o+1.)+(-0.567225146699)
        ref[3,4]=(-1.08817062784)/(o+1.)+(-0.39721014702)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(0.401537399178)*x[0]**o+(-0.868937065568)*x[0]+(0.356734884346)*x[1]**o+(0.0137485089422)*x[1]
        arg[0,0,1]=(0.705383698155)*x[0]**o+(-0.884988282352)*x[0]+(-0.979185994641)*x[1]**o+(0.929576942519)*x[1]
        arg[0,1,0]=(-0.292540086272)*x[0]**o+(-0.223230840915)*x[0]+(0.717291109855)*x[1]**o+(-0.826233591275)*x[1]
        arg[0,1,1]=(0.55739919643)*x[0]**o+(0.2571407205)*x[0]+(0.00434404142287)*x[1]**o+(0.200305144451)*x[1]
        arg[1,0,0]=(0.451841947443)*x[0]**o+(-0.576279050146)*x[0]+(-0.128142118055)*x[1]**o+(0.316406960557)*x[1]
        arg[1,0,1]=(-0.07174792925)*x[0]**o+(-0.392935435009)*x[0]+(-0.343535485172)*x[1]**o+(0.619131193274)*x[1]
        arg[1,1,0]=(-0.667031669611)*x[0]**o+(-0.184806094874)*x[0]+(-0.199375296384)*x[1]**o+(0.449351889815)*x[1]
        arg[1,1,1]=(-0.51924508404)*x[0]**o+(0.870508122509)*x[0]+(-0.274149433148)*x[1]**o+(-0.762367215962)*x[1]
        arg[2,0,0]=(-0.501546909709)*x[0]**o+(0.164122129343)*x[0]+(-0.601370828214)*x[1]**o+(0.888046948888)*x[1]
        arg[2,0,1]=(0.272472486899)*x[0]**o+(-0.958776296738)*x[0]+(-0.334676045163)*x[1]**o+(0.410943596779)*x[1]
        arg[2,1,0]=(0.363478201368)*x[0]**o+(0.753492598803)*x[0]+(-0.663726768274)*x[1]**o+(0.875443816963)*x[1]
        arg[2,1,1]=(0.995788536211)*x[0]**o+(-0.123932097555)*x[0]+(0.143025171293)*x[1]**o+(0.724918059214)*x[1]
        arg[3,0,0]=(-0.578717829755)*x[0]**o+(-0.899523186929)*x[0]+(0.58523203854)*x[1]**o+(0.751620714771)*x[1]
        arg[3,0,1]=(0.179841033744)*x[0]**o+(0.268015839688)*x[0]+(0.860292991989)*x[1]**o+(0.0117969420991)*x[1]
        arg[3,1,0]=(-0.575777000777)*x[0]**o+(0.170047012345)*x[0]+(-0.418743243278)*x[1]**o+(-0.278415849566)*x[1]
        arg[3,1,1]=(-0.913076795648)*x[0]**o+(0.486330450107)*x[0]+(-0.423570363453)*x[1]**o+(0.388575474946)*x[1]
        arg[4,0,0]=(0.16695368621)*x[0]**o+(0.133497460585)*x[0]+(-0.444434659151)*x[1]**o+(-0.895229636275)*x[1]
        arg[4,0,1]=(0.432018868106)*x[0]**o+(-0.281976075625)*x[0]+(-0.0455135209769)*x[1]**o+(0.76870037059)*x[1]
        arg[4,1,0]=(0.238542836112)*x[0]**o+(-0.806931884409)*x[0]+(-0.0365533871189)*x[1]**o+(0.731336634477)*x[1]
        arg[4,1,1]=(0.512035255059)*x[0]**o+(-0.683560978902)*x[0]+(-0.953782277737)*x[1]**o+(-0.311664210765)*x[1]
        arg[5,0,0]=(-0.842399299624)*x[0]**o+(0.460676816656)*x[0]+(-0.251781603841)*x[1]**o+(0.321792359074)*x[1]
        arg[5,0,1]=(-0.900576257062)*x[0]**o+(0.842393710528)*x[0]+(0.630445446843)*x[1]**o+(-0.647745144739)*x[1]
        arg[5,1,0]=(0.136687908652)*x[0]**o+(0.0252907890641)*x[0]+(0.813054611844)*x[1]**o+(-0.459930787056)*x[1]
        arg[5,1,1]=(-0.00242518550941)*x[0]**o+(-0.558785348137)*x[0]+(0.0568659980522)*x[1]**o+(0.689293614051)*x[1]
        ref[0,0,0]=(0.758272283524)/(o+1.)+(-0.427594278313)
        ref[0,0,1]=(-0.273802296487)/(o+1.)+(0.0222943300833)
        ref[0,1,0]=(0.424751023583)/(o+1.)+(-0.524732216095)
        ref[0,1,1]=(0.561743237852)/(o+1.)+(0.228722932476)
        ref[1,0,0]=(0.323699829388)/(o+1.)+(-0.129936044795)
        ref[1,0,1]=(-0.415283414421)/(o+1.)+(0.113097879133)
        ref[1,1,0]=(-0.866406965995)/(o+1.)+(0.132272897471)
        ref[1,1,1]=(-0.793394517189)/(o+1.)+(0.0540704532731)
        ref[2,0,0]=(-1.10291773792)/(o+1.)+(0.526084539115)
        ref[2,0,1]=(-0.0622035582637)/(o+1.)+(-0.273916349979)
        ref[2,1,0]=(-0.300248566906)/(o+1.)+(0.814468207883)
        ref[2,1,1]=(1.1388137075)/(o+1.)+(0.300492980829)
        ref[3,0,0]=(0.00651420878498)/(o+1.)+(-0.073951236079)
        ref[3,0,1]=(1.04013402573)/(o+1.)+(0.139906390894)
        ref[3,1,0]=(-0.994520244055)/(o+1.)+(-0.0541844186105)
        ref[3,1,1]=(-1.3366471591)/(o+1.)+(0.437452962527)
        ref[4,0,0]=(-0.27748097294)/(o+1.)+(-0.380866087845)
        ref[4,0,1]=(0.386505347129)/(o+1.)+(0.243362147483)
        ref[4,1,0]=(0.201989448993)/(o+1.)+(-0.0377976249661)
        ref[4,1,1]=(-0.441747022678)/(o+1.)+(-0.497612594833)
        ref[5,0,0]=(-1.09418090346)/(o+1.)+(0.391234587865)
        ref[5,0,1]=(-0.270130810219)/(o+1.)+(0.0973242828949)
        ref[5,1,0]=(0.949742520497)/(o+1.)+(-0.217319998996)
        ref[5,1,1]=(0.0544408125428)/(o+1.)+(0.0652541329568)
      else:
        arg[0,0,0]=(0.411788818613)*x[0]**o+(0.324151698669)*x[0]+(0.656551349616)*x[1]**o+(0.801577401197)*x[1]+(0.690440431022)*x[2]**o+(0.776409870151)*x[2]
        arg[0,0,1]=(-0.224985947659)*x[0]**o+(-0.564703086188)*x[0]+(-0.37196336116)*x[1]**o+(-0.114979853172)*x[1]+(0.274462080499)*x[2]**o+(-0.988489021983)*x[2]
        arg[0,1,0]=(0.512331530009)*x[0]**o+(0.519617843594)*x[0]+(-0.515174861158)*x[1]**o+(-0.675953902994)*x[1]+(0.796111490716)*x[2]**o+(0.229569489858)*x[2]
        arg[0,1,1]=(0.347765144376)*x[0]**o+(-0.0110194730031)*x[0]+(-0.593936645599)*x[1]**o+(-0.372786558089)*x[1]+(-0.604691321362)*x[2]**o+(-0.888002521077)*x[2]
        arg[1,0,0]=(-0.575954903433)*x[0]**o+(0.0160235655616)*x[0]+(0.305335632724)*x[1]**o+(-0.259402553796)*x[1]+(-0.221276854741)*x[2]**o+(-0.519932341069)*x[2]
        arg[1,0,1]=(-0.674987647238)*x[0]**o+(-0.45852667934)*x[0]+(-0.758937440978)*x[1]**o+(0.80566898197)*x[1]+(-0.961619154322)*x[2]**o+(0.861564430243)*x[2]
        arg[1,1,0]=(-0.297475412437)*x[0]**o+(0.881828705604)*x[0]+(-0.823267615874)*x[1]**o+(-0.0232728101313)*x[1]+(-0.676220001453)*x[2]**o+(-0.382414036981)*x[2]
        arg[1,1,1]=(-0.31008204616)*x[0]**o+(0.805195900401)*x[0]+(-0.758209772143)*x[1]**o+(0.861379709073)*x[1]+(0.0631063866518)*x[2]**o+(0.356607080553)*x[2]
        arg[2,0,0]=(0.305214964591)*x[0]**o+(0.815106526139)*x[0]+(0.138797156005)*x[1]**o+(-0.241921896332)*x[1]+(-0.103783035058)*x[2]**o+(-0.161952044984)*x[2]
        arg[2,0,1]=(-0.925375677635)*x[0]**o+(0.0341347568201)*x[0]+(-0.706905924964)*x[1]**o+(-0.193304368451)*x[1]+(-0.449866757104)*x[2]**o+(-0.894963680869)*x[2]
        arg[2,1,0]=(0.822676224279)*x[0]**o+(-0.28758006682)*x[0]+(-0.869025918917)*x[1]**o+(0.0107602044744)*x[1]+(-0.832322765163)*x[2]**o+(0.748440319389)*x[2]
        arg[2,1,1]=(-0.415326508997)*x[0]**o+(-0.879521424817)*x[0]+(-0.971781441062)*x[1]**o+(0.527586634108)*x[1]+(0.336682669856)*x[2]**o+(-0.948414041149)*x[2]
        arg[3,0,0]=(-0.345788531715)*x[0]**o+(0.626583498807)*x[0]+(-0.186418683649)*x[1]**o+(0.3141628424)*x[1]+(-0.781119787783)*x[2]**o+(0.972708430266)*x[2]
        arg[3,0,1]=(0.175536279095)*x[0]**o+(-0.150027774295)*x[0]+(-0.506653680683)*x[1]**o+(-0.482544397029)*x[1]+(-0.59090996152)*x[2]**o+(0.618123625026)*x[2]
        arg[3,1,0]=(0.737984493124)*x[0]**o+(0.650901680297)*x[0]+(-0.361389200009)*x[1]**o+(-0.784304665396)*x[1]+(-0.954132232142)*x[2]**o+(0.684341934348)*x[2]
        arg[3,1,1]=(-0.385757579645)*x[0]**o+(0.251136919845)*x[0]+(0.95143939933)*x[1]**o+(0.501860043225)*x[1]+(-0.675673011184)*x[2]**o+(0.337315450579)*x[2]
        arg[4,0,0]=(-0.740183402139)*x[0]**o+(-0.828278760743)*x[0]+(0.88000889117)*x[1]**o+(-0.0226801022184)*x[1]+(0.6811397662)*x[2]**o+(-0.254627446498)*x[2]
        arg[4,0,1]=(-0.194128952361)*x[0]**o+(-0.524854896388)*x[0]+(0.341100326577)*x[1]**o+(-0.26072443499)*x[1]+(-0.197396331776)*x[2]**o+(-0.589037632112)*x[2]
        arg[4,1,0]=(0.261995024865)*x[0]**o+(0.214193793699)*x[0]+(0.572024600244)*x[1]**o+(0.230659327198)*x[1]+(0.420971705453)*x[2]**o+(0.333445049827)*x[2]
        arg[4,1,1]=(-0.0679525054395)*x[0]**o+(0.0756646296473)*x[0]+(-0.299865836239)*x[1]**o+(-0.828294764914)*x[1]+(0.606170745631)*x[2]**o+(0.624267827393)*x[2]
        arg[5,0,0]=(0.312565542211)*x[0]**o+(-0.368815496171)*x[0]+(-0.0615973473105)*x[1]**o+(0.205012835971)*x[1]+(0.310818553076)*x[2]**o+(-0.287393908304)*x[2]
        arg[5,0,1]=(-0.409626309069)*x[0]**o+(0.977953573562)*x[0]+(0.583013544138)*x[1]**o+(0.542907128677)*x[1]+(0.488538336366)*x[2]**o+(-0.85823611123)*x[2]
        arg[5,1,0]=(-0.899607109395)*x[0]**o+(-0.0459053040522)*x[0]+(0.938423293041)*x[1]**o+(-0.112431665317)*x[1]+(0.620609328687)*x[2]**o+(-0.663082429319)*x[2]
        arg[5,1,1]=(0.00370253144626)*x[0]**o+(0.503733497956)*x[0]+(0.362457785043)*x[1]**o+(0.417891957303)*x[1]+(0.404543677829)*x[2]**o+(0.117828669122)*x[2]
        ref[0,0,0]=(1.75878059925)/(o+1.)+(0.951069485009)
        ref[0,0,1]=(-0.32248722832)/(o+1.)+(-0.834085980672)
        ref[0,1,0]=(0.793268159567)/(o+1.)+(0.036616715229)
        ref[0,1,1]=(-0.850862822585)/(o+1.)+(-0.635904276085)
        ref[1,0,0]=(-0.49189612545)/(o+1.)+(-0.381655664652)
        ref[1,0,1]=(-2.39554424254)/(o+1.)+(0.604353366437)
        ref[1,1,0]=(-1.79696302976)/(o+1.)+(0.238070929246)
        ref[1,1,1]=(-1.00518543165)/(o+1.)+(1.01159134501)
        ref[2,0,0]=(0.340229085537)/(o+1.)+(0.205616292412)
        ref[2,0,1]=(-2.0821483597)/(o+1.)+(-0.52706664625)
        ref[2,1,0]=(-0.878672459802)/(o+1.)+(0.235810228522)
        ref[2,1,1]=(-1.0504252802)/(o+1.)+(-0.650174415929)
        ref[3,0,0]=(-1.31332700315)/(o+1.)+(0.956727385736)
        ref[3,0,1]=(-0.922027363109)/(o+1.)+(-0.00722427314892)
        ref[3,1,0]=(-0.577536939027)/(o+1.)+(0.275469474624)
        ref[3,1,1]=(-0.109991191499)/(o+1.)+(0.545156206825)
        ref[4,0,0]=(0.820965255231)/(o+1.)+(-0.55279315473)
        ref[4,0,1]=(-0.0504249575602)/(o+1.)+(-0.687308481745)
        ref[4,1,0]=(1.25499133056)/(o+1.)+(0.389149085362)
        ref[4,1,1]=(0.238352403952)/(o+1.)+(-0.0641811539369)
        ref[5,0,0]=(0.561786747976)/(o+1.)+(-0.225598284252)
        ref[5,0,1]=(0.661925571434)/(o+1.)+(0.331312295504)
        ref[5,1,0]=(0.659425512333)/(o+1.)+(-0.410709699344)
        ref[5,1,1]=(0.770703994319)/(o+1.)+(0.519727062191)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.164405890316)*x[0]**o+(-0.323303939764)*x[0]+(-0.0516829984856)*x[1]**o+(-0.220765052533)*x[1]
        arg[0,0,0,1]=(0.152172612108)*x[0]**o+(-0.166242164365)*x[0]+(0.807177808571)*x[1]**o+(0.0404817109573)*x[1]
        arg[0,0,1,0]=(0.016912808567)*x[0]**o+(0.623923316774)*x[0]+(-0.542886934905)*x[1]**o+(0.0110784560205)*x[1]
        arg[0,0,1,1]=(-0.663885786909)*x[0]**o+(-0.55563355485)*x[0]+(0.191993284382)*x[1]**o+(0.734973556043)*x[1]
        arg[0,0,2,0]=(-0.110316754183)*x[0]**o+(-0.584022783672)*x[0]+(0.56471376011)*x[1]**o+(0.846317747143)*x[1]
        arg[0,0,2,1]=(-0.767988009278)*x[0]**o+(0.440997912352)*x[0]+(0.45366348093)*x[1]**o+(0.376620990318)*x[1]
        arg[0,1,0,0]=(-0.138006508051)*x[0]**o+(0.8450564766)*x[0]+(-0.273559897633)*x[1]**o+(0.683678615645)*x[1]
        arg[0,1,0,1]=(-0.467521625474)*x[0]**o+(0.32289306962)*x[0]+(0.340974562152)*x[1]**o+(-0.58109391053)*x[1]
        arg[0,1,1,0]=(0.76867991208)*x[0]**o+(0.683527735131)*x[0]+(0.762986872389)*x[1]**o+(-0.189342734286)*x[1]
        arg[0,1,1,1]=(0.125150175351)*x[0]**o+(-0.175190872876)*x[0]+(-0.569766488076)*x[1]**o+(0.787503755206)*x[1]
        arg[0,1,2,0]=(-0.339695860559)*x[0]**o+(0.119452596206)*x[0]+(0.474378864192)*x[1]**o+(0.845982555265)*x[1]
        arg[0,1,2,1]=(0.820551334836)*x[0]**o+(-0.200024721285)*x[0]+(-0.525871855871)*x[1]**o+(-0.714639297791)*x[1]
        arg[0,2,0,0]=(-0.145788788262)*x[0]**o+(-0.695717636982)*x[0]+(0.736564332801)*x[1]**o+(0.634307016587)*x[1]
        arg[0,2,0,1]=(-0.25142006947)*x[0]**o+(0.027028767127)*x[0]+(-0.614777438028)*x[1]**o+(-0.691417785617)*x[1]
        arg[0,2,1,0]=(0.366081140839)*x[0]**o+(0.477490533426)*x[0]+(-0.116611335116)*x[1]**o+(-0.863552165712)*x[1]
        arg[0,2,1,1]=(-0.467659558308)*x[0]**o+(0.0836299545334)*x[0]+(0.903093252833)*x[1]**o+(-0.956858182533)*x[1]
        arg[0,2,2,0]=(0.870921031579)*x[0]**o+(-0.801681014465)*x[0]+(-0.951819608329)*x[1]**o+(-0.626222917084)*x[1]
        arg[0,2,2,1]=(0.414973183041)*x[0]**o+(-0.444580205703)*x[0]+(-0.346458764208)*x[1]**o+(-0.679140100745)*x[1]
        arg[0,3,0,0]=(-0.725326935158)*x[0]**o+(-0.914034759513)*x[0]+(0.702614377806)*x[1]**o+(0.819004276317)*x[1]
        arg[0,3,0,1]=(0.617099932352)*x[0]**o+(-0.155182850011)*x[0]+(-0.066428715129)*x[1]**o+(-0.286480585435)*x[1]
        arg[0,3,1,0]=(0.710942545488)*x[0]**o+(-0.734509277268)*x[0]+(-0.807474546329)*x[1]**o+(0.307631760449)*x[1]
        arg[0,3,1,1]=(-0.709966924732)*x[0]**o+(-0.462297022374)*x[0]+(0.773787774038)*x[1]**o+(0.762137020991)*x[1]
        arg[0,3,2,0]=(-0.425660932209)*x[0]**o+(-0.562130300181)*x[0]+(-0.516719014647)*x[1]**o+(-0.547832887369)*x[1]
        arg[0,3,2,1]=(0.149573176879)*x[0]**o+(-0.208999629436)*x[0]+(-0.191426033553)*x[1]**o+(-0.119046538873)*x[1]
        arg[0,4,0,0]=(-0.99932317151)*x[0]**o+(-0.832461558068)*x[0]+(-0.847073271676)*x[1]**o+(0.882046887729)*x[1]
        arg[0,4,0,1]=(0.14235557233)*x[0]**o+(-0.352572053276)*x[0]+(-0.231989519255)*x[1]**o+(0.146855135398)*x[1]
        arg[0,4,1,0]=(0.550561449012)*x[0]**o+(0.530745681425)*x[0]+(0.198889689472)*x[1]**o+(0.165503108658)*x[1]
        arg[0,4,1,1]=(0.059663401309)*x[0]**o+(0.168377411751)*x[0]+(-0.224682723925)*x[1]**o+(-0.255406907757)*x[1]
        arg[0,4,2,0]=(-0.747776894683)*x[0]**o+(-0.281763358533)*x[0]+(0.660369838923)*x[1]**o+(0.348541234687)*x[1]
        arg[0,4,2,1]=(-0.886248366716)*x[0]**o+(0.665256341312)*x[0]+(-0.118041122298)*x[1]**o+(0.192284814559)*x[1]
        arg[1,0,0,0]=(-0.212291422817)*x[0]**o+(-0.16123490382)*x[0]+(-0.884220059537)*x[1]**o+(-0.40104775897)*x[1]
        arg[1,0,0,1]=(0.389745305389)*x[0]**o+(0.544302066739)*x[0]+(-0.504770065056)*x[1]**o+(0.903371132654)*x[1]
        arg[1,0,1,0]=(0.983764499357)*x[0]**o+(0.0707766278425)*x[0]+(-0.119851167133)*x[1]**o+(0.668490934432)*x[1]
        arg[1,0,1,1]=(-0.61333738947)*x[0]**o+(-0.515837139916)*x[0]+(-0.825015725806)*x[1]**o+(-0.858420009384)*x[1]
        arg[1,0,2,0]=(0.838488008532)*x[0]**o+(0.320020900158)*x[0]+(0.265140913892)*x[1]**o+(0.493460973766)*x[1]
        arg[1,0,2,1]=(-0.957171379585)*x[0]**o+(0.911667647687)*x[0]+(0.0634495769152)*x[1]**o+(-0.244783653159)*x[1]
        arg[1,1,0,0]=(0.854312398231)*x[0]**o+(0.0177604750376)*x[0]+(-0.263135825468)*x[1]**o+(0.196452389095)*x[1]
        arg[1,1,0,1]=(0.496952473267)*x[0]**o+(-0.505581680291)*x[0]+(0.227653536528)*x[1]**o+(-0.138354150837)*x[1]
        arg[1,1,1,0]=(0.569682536816)*x[0]**o+(-0.523174667456)*x[0]+(-0.434073415962)*x[1]**o+(-0.853667257479)*x[1]
        arg[1,1,1,1]=(0.636882167235)*x[0]**o+(-0.122206427025)*x[0]+(0.934361025063)*x[1]**o+(-0.43037160177)*x[1]
        arg[1,1,2,0]=(0.0798318147504)*x[0]**o+(0.825231320185)*x[0]+(0.810701650808)*x[1]**o+(-0.544356371381)*x[1]
        arg[1,1,2,1]=(-0.426710170704)*x[0]**o+(0.200697079677)*x[0]+(0.242027752153)*x[1]**o+(0.746762119874)*x[1]
        arg[1,2,0,0]=(-0.497091856216)*x[0]**o+(0.0953816987137)*x[0]+(-0.388615292775)*x[1]**o+(0.794962452203)*x[1]
        arg[1,2,0,1]=(0.484769626964)*x[0]**o+(0.700484219762)*x[0]+(-0.230377697673)*x[1]**o+(-0.110327221848)*x[1]
        arg[1,2,1,0]=(-0.791806541129)*x[0]**o+(0.0199911517557)*x[0]+(-0.441657020836)*x[1]**o+(-0.972999930466)*x[1]
        arg[1,2,1,1]=(-0.566750983493)*x[0]**o+(0.193689535753)*x[0]+(0.659310468709)*x[1]**o+(0.209045229813)*x[1]
        arg[1,2,2,0]=(0.852553900341)*x[0]**o+(-0.869275488172)*x[0]+(-0.308429715369)*x[1]**o+(0.096335995297)*x[1]
        arg[1,2,2,1]=(0.169351018917)*x[0]**o+(0.269577471686)*x[0]+(-0.226840840616)*x[1]**o+(-0.94229540867)*x[1]
        arg[1,3,0,0]=(0.481711489234)*x[0]**o+(0.293576608201)*x[0]+(0.101998881767)*x[1]**o+(-0.10730442531)*x[1]
        arg[1,3,0,1]=(-0.824144820539)*x[0]**o+(0.174754759038)*x[0]+(-0.251803196848)*x[1]**o+(-0.389656255459)*x[1]
        arg[1,3,1,0]=(0.438310633462)*x[0]**o+(-0.268051020546)*x[0]+(0.670456978527)*x[1]**o+(-0.547393352784)*x[1]
        arg[1,3,1,1]=(-0.95082246973)*x[0]**o+(0.739061218443)*x[0]+(0.209495253219)*x[1]**o+(-0.604801908581)*x[1]
        arg[1,3,2,0]=(0.696900724687)*x[0]**o+(0.501191311274)*x[0]+(0.982952568975)*x[1]**o+(0.1345704134)*x[1]
        arg[1,3,2,1]=(0.823865642457)*x[0]**o+(0.344980106206)*x[0]+(0.0740071873515)*x[1]**o+(-0.950460516779)*x[1]
        arg[1,4,0,0]=(-0.428525532814)*x[0]**o+(0.496012936411)*x[0]+(-0.0756953876324)*x[1]**o+(0.8382068924)*x[1]
        arg[1,4,0,1]=(0.950388644852)*x[0]**o+(-0.225116488186)*x[0]+(0.515802878592)*x[1]**o+(-0.51004230039)*x[1]
        arg[1,4,1,0]=(0.868733254296)*x[0]**o+(-0.506544709529)*x[0]+(0.28935579533)*x[1]**o+(0.100277736612)*x[1]
        arg[1,4,1,1]=(-0.104533384722)*x[0]**o+(0.598995288066)*x[0]+(-0.738946772839)*x[1]**o+(-0.23245555216)*x[1]
        arg[1,4,2,0]=(-0.286232179213)*x[0]**o+(-0.31267596034)*x[0]+(0.588681250431)*x[1]**o+(-0.579857978487)*x[1]
        arg[1,4,2,1]=(0.405666376198)*x[0]**o+(0.380029842735)*x[0]+(-0.646672003588)*x[1]**o+(0.419606979519)*x[1]
        arg[2,0,0,0]=(0.183075434304)*x[0]**o+(0.0929532345426)*x[0]+(-0.742007638693)*x[1]**o+(-0.521914593386)*x[1]
        arg[2,0,0,1]=(0.292878118412)*x[0]**o+(-0.427165220789)*x[0]+(0.540033289295)*x[1]**o+(0.997945616043)*x[1]
        arg[2,0,1,0]=(0.872801856197)*x[0]**o+(0.0427577769706)*x[0]+(0.595354626662)*x[1]**o+(-0.878459740609)*x[1]
        arg[2,0,1,1]=(-0.259988866684)*x[0]**o+(0.154043636253)*x[0]+(0.0580047878991)*x[1]**o+(0.40696744056)*x[1]
        arg[2,0,2,0]=(-0.602648518466)*x[0]**o+(0.30877596654)*x[0]+(-0.268563459489)*x[1]**o+(-0.526379663585)*x[1]
        arg[2,0,2,1]=(-0.375777994931)*x[0]**o+(-0.175440011709)*x[0]+(-0.578650003477)*x[1]**o+(0.822157683321)*x[1]
        arg[2,1,0,0]=(-0.44389226502)*x[0]**o+(0.683580346916)*x[0]+(0.471857559282)*x[1]**o+(-0.869624665398)*x[1]
        arg[2,1,0,1]=(0.768272315036)*x[0]**o+(-0.709688321973)*x[0]+(0.200727881948)*x[1]**o+(0.617326752785)*x[1]
        arg[2,1,1,0]=(-0.371169228982)*x[0]**o+(-0.0248248405104)*x[0]+(-0.899904749204)*x[1]**o+(0.796779883083)*x[1]
        arg[2,1,1,1]=(0.220088670807)*x[0]**o+(0.691718163435)*x[0]+(-0.0834793048429)*x[1]**o+(-0.748110928988)*x[1]
        arg[2,1,2,0]=(0.246045293748)*x[0]**o+(-0.669660154233)*x[0]+(0.601040129345)*x[1]**o+(-0.0893792369983)*x[1]
        arg[2,1,2,1]=(0.318708374425)*x[0]**o+(-0.973048583674)*x[0]+(-0.575891882633)*x[1]**o+(0.229050058038)*x[1]
        arg[2,2,0,0]=(0.358008410645)*x[0]**o+(-0.834388697702)*x[0]+(0.0931465346237)*x[1]**o+(0.503934981947)*x[1]
        arg[2,2,0,1]=(-0.257597986495)*x[0]**o+(-0.58070568528)*x[0]+(0.735541935653)*x[1]**o+(-0.704666216263)*x[1]
        arg[2,2,1,0]=(0.0207421250729)*x[0]**o+(-0.724644198871)*x[0]+(0.637124335031)*x[1]**o+(-0.547300138808)*x[1]
        arg[2,2,1,1]=(0.280179217797)*x[0]**o+(-0.387279903944)*x[0]+(0.516275341085)*x[1]**o+(0.781250973385)*x[1]
        arg[2,2,2,0]=(-0.97771111517)*x[0]**o+(-0.140997969015)*x[0]+(-0.495112130955)*x[1]**o+(0.151523726543)*x[1]
        arg[2,2,2,1]=(-0.48638258963)*x[0]**o+(-0.251363723104)*x[0]+(-0.484911659879)*x[1]**o+(-0.841285872322)*x[1]
        arg[2,3,0,0]=(-0.70159761565)*x[0]**o+(-0.661658396735)*x[0]+(-0.380920250292)*x[1]**o+(0.682598882025)*x[1]
        arg[2,3,0,1]=(0.477056088757)*x[0]**o+(0.697397619448)*x[0]+(0.28617323153)*x[1]**o+(-0.0443690469658)*x[1]
        arg[2,3,1,0]=(-0.823038323615)*x[0]**o+(-0.742146866184)*x[0]+(0.258604766787)*x[1]**o+(-0.740368164141)*x[1]
        arg[2,3,1,1]=(0.958751077013)*x[0]**o+(0.353976218746)*x[0]+(-0.954344840728)*x[1]**o+(0.436915389196)*x[1]
        arg[2,3,2,0]=(0.432342075923)*x[0]**o+(-0.0699761039653)*x[0]+(0.701490046186)*x[1]**o+(0.0888793443125)*x[1]
        arg[2,3,2,1]=(0.612536667525)*x[0]**o+(0.107433723026)*x[0]+(-0.611874456965)*x[1]**o+(-0.253338899867)*x[1]
        arg[2,4,0,0]=(-0.0234819568317)*x[0]**o+(-0.0642964170457)*x[0]+(0.556679188908)*x[1]**o+(0.865922901373)*x[1]
        arg[2,4,0,1]=(0.669235019483)*x[0]**o+(0.744361910609)*x[0]+(0.383397302403)*x[1]**o+(0.669587709042)*x[1]
        arg[2,4,1,0]=(-0.143461051192)*x[0]**o+(-0.0272388772724)*x[0]+(0.723868767782)*x[1]**o+(0.303617835707)*x[1]
        arg[2,4,1,1]=(-0.829765013546)*x[0]**o+(-0.784193619495)*x[0]+(0.384376849236)*x[1]**o+(0.280904709362)*x[1]
        arg[2,4,2,0]=(0.38737050935)*x[0]**o+(0.749614613361)*x[0]+(-0.340848293488)*x[1]**o+(0.96291850214)*x[1]
        arg[2,4,2,1]=(0.619896872679)*x[0]**o+(0.970694589398)*x[0]+(-0.300698305892)*x[1]**o+(0.794408153506)*x[1]
        arg[3,0,0,0]=(-0.808442463698)*x[0]**o+(-0.527555255968)*x[0]+(0.246776596713)*x[1]**o+(-0.719809811547)*x[1]
        arg[3,0,0,1]=(-0.390016002326)*x[0]**o+(-0.864168521951)*x[0]+(-0.154649478359)*x[1]**o+(0.210766031283)*x[1]
        arg[3,0,1,0]=(-0.941916382966)*x[0]**o+(-0.0352551994705)*x[0]+(-0.660026082442)*x[1]**o+(-0.869241000235)*x[1]
        arg[3,0,1,1]=(-0.287992443961)*x[0]**o+(0.292551506636)*x[0]+(-0.619953648778)*x[1]**o+(0.746095811695)*x[1]
        arg[3,0,2,0]=(-0.233659077726)*x[0]**o+(-0.568647415596)*x[0]+(-0.22048065705)*x[1]**o+(0.658105381132)*x[1]
        arg[3,0,2,1]=(0.871784854897)*x[0]**o+(-0.118389479971)*x[0]+(0.143290959871)*x[1]**o+(0.753198625961)*x[1]
        arg[3,1,0,0]=(0.993988451174)*x[0]**o+(0.451849763406)*x[0]+(-0.972805640824)*x[1]**o+(0.796893857099)*x[1]
        arg[3,1,0,1]=(-0.424353439197)*x[0]**o+(-0.575799061446)*x[0]+(-0.233936106648)*x[1]**o+(-0.451864349448)*x[1]
        arg[3,1,1,0]=(0.639821887614)*x[0]**o+(0.771041944334)*x[0]+(0.420297869214)*x[1]**o+(0.671734395857)*x[1]
        arg[3,1,1,1]=(0.398121897075)*x[0]**o+(0.647679737081)*x[0]+(-0.544457308885)*x[1]**o+(0.58955287395)*x[1]
        arg[3,1,2,0]=(-0.118222351008)*x[0]**o+(-0.943807502172)*x[0]+(0.866866987138)*x[1]**o+(-0.0793340319339)*x[1]
        arg[3,1,2,1]=(-0.157286204244)*x[0]**o+(-0.789214982692)*x[0]+(0.646008960971)*x[1]**o+(0.866687256647)*x[1]
        arg[3,2,0,0]=(-0.620625598995)*x[0]**o+(-0.12874444072)*x[0]+(0.4402928966)*x[1]**o+(-0.0344340173898)*x[1]
        arg[3,2,0,1]=(-0.714597102332)*x[0]**o+(0.730206152989)*x[0]+(0.795717819655)*x[1]**o+(0.0543647593833)*x[1]
        arg[3,2,1,0]=(0.698721346048)*x[0]**o+(0.599204472096)*x[0]+(0.323529910402)*x[1]**o+(0.362678869119)*x[1]
        arg[3,2,1,1]=(0.976107824554)*x[0]**o+(0.559889392243)*x[0]+(0.240016231718)*x[1]**o+(0.343322878078)*x[1]
        arg[3,2,2,0]=(0.609695396838)*x[0]**o+(0.786331471916)*x[0]+(-0.965489152976)*x[1]**o+(0.553653504493)*x[1]
        arg[3,2,2,1]=(0.897952533418)*x[0]**o+(0.227242627929)*x[0]+(-0.121752169524)*x[1]**o+(0.844617689997)*x[1]
        arg[3,3,0,0]=(-0.249698211819)*x[0]**o+(-0.400095108874)*x[0]+(-0.44300562221)*x[1]**o+(0.387777895056)*x[1]
        arg[3,3,0,1]=(0.626469203641)*x[0]**o+(0.741893669108)*x[0]+(0.261882509899)*x[1]**o+(-0.726628233604)*x[1]
        arg[3,3,1,0]=(-0.525223500134)*x[0]**o+(0.918314547123)*x[0]+(0.426441176651)*x[1]**o+(0.338058005974)*x[1]
        arg[3,3,1,1]=(-0.31358142709)*x[0]**o+(-0.411070225036)*x[0]+(0.0902340021221)*x[1]**o+(0.404135075929)*x[1]
        arg[3,3,2,0]=(0.528842663849)*x[0]**o+(0.474768688828)*x[0]+(0.697643730083)*x[1]**o+(-0.170335125341)*x[1]
        arg[3,3,2,1]=(0.875221054674)*x[0]**o+(-0.441830492507)*x[0]+(-0.60312069438)*x[1]**o+(0.664895429753)*x[1]
        arg[3,4,0,0]=(0.563422972203)*x[0]**o+(-0.595004250424)*x[0]+(0.888927367905)*x[1]**o+(0.553640735136)*x[1]
        arg[3,4,0,1]=(0.79563891979)*x[0]**o+(-0.461626171695)*x[0]+(0.700194671524)*x[1]**o+(-0.687505010217)*x[1]
        arg[3,4,1,0]=(0.655248139354)*x[0]**o+(0.588175755435)*x[0]+(-0.29236593461)*x[1]**o+(0.575186295035)*x[1]
        arg[3,4,1,1]=(0.405730566113)*x[0]**o+(-0.161117488254)*x[0]+(0.912224633472)*x[1]**o+(0.0292423764587)*x[1]
        arg[3,4,2,0]=(-0.405819525278)*x[0]**o+(-0.362840757195)*x[0]+(0.961950188511)*x[1]**o+(0.205213542149)*x[1]
        arg[3,4,2,1]=(0.703066280254)*x[0]**o+(-0.936055321446)*x[0]+(0.861070629413)*x[1]**o+(0.0856428368256)*x[1]
        ref[0,0,0,0]=(-0.216088888802)/(o+1.)+(-0.272034496148)
        ref[0,0,0,1]=(0.959350420679)/(o+1.)+(-0.062880226704)
        ref[0,0,1,0]=(-0.525974126338)/(o+1.)+(0.317500886397)
        ref[0,0,1,1]=(-0.471892502528)/(o+1.)+(0.0896700005967)
        ref[0,0,2,0]=(0.454397005927)/(o+1.)+(0.131147481736)
        ref[0,0,2,1]=(-0.314324528348)/(o+1.)+(0.408809451335)
        ref[0,1,0,0]=(-0.411566405684)/(o+1.)+(0.764367546122)
        ref[0,1,0,1]=(-0.126547063321)/(o+1.)+(-0.129100420455)
        ref[0,1,1,0]=(1.53166678447)/(o+1.)+(0.247092500423)
        ref[0,1,1,1]=(-0.444616312725)/(o+1.)+(0.306156441165)
        ref[0,1,2,0]=(0.134683003633)/(o+1.)+(0.482717575736)
        ref[0,1,2,1]=(0.294679478965)/(o+1.)+(-0.457332009538)
        ref[0,2,0,0]=(0.590775544538)/(o+1.)+(-0.0307053101973)
        ref[0,2,0,1]=(-0.866197507498)/(o+1.)+(-0.332194509245)
        ref[0,2,1,0]=(0.249469805723)/(o+1.)+(-0.193030816143)
        ref[0,2,1,1]=(0.435433694525)/(o+1.)+(-0.436614114)
        ref[0,2,2,0]=(-0.0808985767498)/(o+1.)+(-0.713951965774)
        ref[0,2,2,1]=(0.0685144188336)/(o+1.)+(-0.561860153224)
        ref[0,3,0,0]=(-0.0227125573528)/(o+1.)+(-0.0475152415978)
        ref[0,3,0,1]=(0.550671217223)/(o+1.)+(-0.220831717723)
        ref[0,3,1,0]=(-0.0965320008409)/(o+1.)+(-0.213438758409)
        ref[0,3,1,1]=(0.0638208493064)/(o+1.)+(0.149919999309)
        ref[0,3,2,0]=(-0.942379946856)/(o+1.)+(-0.554981593775)
        ref[0,3,2,1]=(-0.0418528566735)/(o+1.)+(-0.164023084154)
        ref[0,4,0,0]=(-1.84639644319)/(o+1.)+(0.0247926648306)
        ref[0,4,0,1]=(-0.0896339469252)/(o+1.)+(-0.102858458939)
        ref[0,4,1,0]=(0.749451138484)/(o+1.)+(0.348124395042)
        ref[0,4,1,1]=(-0.165019322616)/(o+1.)+(-0.0435147480027)
        ref[0,4,2,0]=(-0.0874070557597)/(o+1.)+(0.033388938077)
        ref[0,4,2,1]=(-1.00428948901)/(o+1.)+(0.428770577935)
        ref[1,0,0,0]=(-1.09651148235)/(o+1.)+(-0.281141331395)
        ref[1,0,0,1]=(-0.115024759667)/(o+1.)+(0.723836599697)
        ref[1,0,1,0]=(0.863913332224)/(o+1.)+(0.369633781137)
        ref[1,0,1,1]=(-1.43835311528)/(o+1.)+(-0.68712857465)
        ref[1,0,2,0]=(1.10362892242)/(o+1.)+(0.406740936962)
        ref[1,0,2,1]=(-0.893721802669)/(o+1.)+(0.333441997264)
        ref[1,1,0,0]=(0.591176572763)/(o+1.)+(0.107106432066)
        ref[1,1,0,1]=(0.724606009795)/(o+1.)+(-0.321967915564)
        ref[1,1,1,0]=(0.135609120854)/(o+1.)+(-0.688420962467)
        ref[1,1,1,1]=(1.5712431923)/(o+1.)+(-0.276289014397)
        ref[1,1,2,0]=(0.890533465558)/(o+1.)+(0.140437474402)
        ref[1,1,2,1]=(-0.184682418551)/(o+1.)+(0.473729599776)
        ref[1,2,0,0]=(-0.88570714899)/(o+1.)+(0.445172075458)
        ref[1,2,0,1]=(0.254391929291)/(o+1.)+(0.295078498957)
        ref[1,2,1,0]=(-1.23346356196)/(o+1.)+(-0.476504389355)
        ref[1,2,1,1]=(0.0925594852161)/(o+1.)+(0.201367382783)
        ref[1,2,2,0]=(0.544124184972)/(o+1.)+(-0.386469746437)
        ref[1,2,2,1]=(-0.057489821699)/(o+1.)+(-0.336358968492)
        ref[1,3,0,0]=(0.583710371001)/(o+1.)+(0.0931360914458)
        ref[1,3,0,1]=(-1.07594801739)/(o+1.)+(-0.107450748211)
        ref[1,3,1,0]=(1.10876761199)/(o+1.)+(-0.407722186665)
        ref[1,3,1,1]=(-0.741327216511)/(o+1.)+(0.0671296549307)
        ref[1,3,2,0]=(1.67985329366)/(o+1.)+(0.317880862337)
        ref[1,3,2,1]=(0.897872829808)/(o+1.)+(-0.302740205287)
        ref[1,4,0,0]=(-0.504220920447)/(o+1.)+(0.667109914405)
        ref[1,4,0,1]=(1.46619152344)/(o+1.)+(-0.367579394288)
        ref[1,4,1,0]=(1.15808904963)/(o+1.)+(-0.203133486458)
        ref[1,4,1,1]=(-0.843480157561)/(o+1.)+(0.183269867953)
        ref[1,4,2,0]=(0.302449071217)/(o+1.)+(-0.446266969414)
        ref[1,4,2,1]=(-0.24100562739)/(o+1.)+(0.399818411127)
        ref[2,0,0,0]=(-0.558932204389)/(o+1.)+(-0.214480679421)
        ref[2,0,0,1]=(0.832911407707)/(o+1.)+(0.285390197627)
        ref[2,0,1,0]=(1.46815648286)/(o+1.)+(-0.417850981819)
        ref[2,0,1,1]=(-0.201984078785)/(o+1.)+(0.280505538406)
        ref[2,0,2,0]=(-0.871211977955)/(o+1.)+(-0.108801848522)
        ref[2,0,2,1]=(-0.954427998409)/(o+1.)+(0.323358835806)
        ref[2,1,0,0]=(0.0279652942615)/(o+1.)+(-0.0930221592407)
        ref[2,1,0,1]=(0.969000196983)/(o+1.)+(-0.0461807845941)
        ref[2,1,1,0]=(-1.27107397819)/(o+1.)+(0.385977521287)
        ref[2,1,1,1]=(0.136609365964)/(o+1.)+(-0.0281963827764)
        ref[2,1,2,0]=(0.847085423093)/(o+1.)+(-0.379519695616)
        ref[2,1,2,1]=(-0.257183508208)/(o+1.)+(-0.371999262818)
        ref[2,2,0,0]=(0.451154945268)/(o+1.)+(-0.165226857878)
        ref[2,2,0,1]=(0.477943949158)/(o+1.)+(-0.642685950772)
        ref[2,2,1,0]=(0.657866460103)/(o+1.)+(-0.635972168839)
        ref[2,2,1,1]=(0.796454558882)/(o+1.)+(0.19698553472)
        ref[2,2,2,0]=(-1.47282324613)/(o+1.)+(0.00526287876389)
        ref[2,2,2,1]=(-0.971294249509)/(o+1.)+(-0.546324797713)
        ref[2,3,0,0]=(-1.08251786594)/(o+1.)+(0.0104702426452)
        ref[2,3,0,1]=(0.763229320287)/(o+1.)+(0.326514286241)
        ref[2,3,1,0]=(-0.564433556829)/(o+1.)+(-0.741257515163)
        ref[2,3,1,1]=(0.00440623628526)/(o+1.)+(0.395445803971)
        ref[2,3,2,0]=(1.13383212211)/(o+1.)+(0.0094516201736)
        ref[2,3,2,1]=(0.000662210559809)/(o+1.)+(-0.0729525884203)
        ref[2,4,0,0]=(0.533197232076)/(o+1.)+(0.400813242164)
        ref[2,4,0,1]=(1.05263232189)/(o+1.)+(0.706974809826)
        ref[2,4,1,0]=(0.580407716589)/(o+1.)+(0.138189479217)
        ref[2,4,1,1]=(-0.44538816431)/(o+1.)+(-0.251644455066)
        ref[2,4,2,0]=(0.0465222158616)/(o+1.)+(0.85626655775)
        ref[2,4,2,1]=(0.319198566788)/(o+1.)+(0.882551371452)
        ref[3,0,0,0]=(-0.561665866984)/(o+1.)+(-0.623682533758)
        ref[3,0,0,1]=(-0.544665480685)/(o+1.)+(-0.326701245334)
        ref[3,0,1,0]=(-1.60194246541)/(o+1.)+(-0.452248099853)
        ref[3,0,1,1]=(-0.907946092739)/(o+1.)+(0.519323659165)
        ref[3,0,2,0]=(-0.454139734776)/(o+1.)+(0.0447289827682)
        ref[3,0,2,1]=(1.01507581477)/(o+1.)+(0.317404572995)
        ref[3,1,0,0]=(0.0211828103496)/(o+1.)+(0.624371810253)
        ref[3,1,0,1]=(-0.658289545845)/(o+1.)+(-0.513831705447)
        ref[3,1,1,0]=(1.06011975683)/(o+1.)+(0.721388170095)
        ref[3,1,1,1]=(-0.14633541181)/(o+1.)+(0.618616305516)
        ref[3,1,2,0]=(0.74864463613)/(o+1.)+(-0.511570767053)
        ref[3,1,2,1]=(0.488722756727)/(o+1.)+(0.0387361369774)
        ref[3,2,0,0]=(-0.180332702395)/(o+1.)+(-0.0815892290549)
        ref[3,2,0,1]=(0.0811207173227)/(o+1.)+(0.392285456186)
        ref[3,2,1,0]=(1.02225125645)/(o+1.)+(0.480941670608)
        ref[3,2,1,1]=(1.21612405627)/(o+1.)+(0.45160613516)
        ref[3,2,2,0]=(-0.355793756138)/(o+1.)+(0.669992488205)
        ref[3,2,2,1]=(0.776200363894)/(o+1.)+(0.535930158963)
        ref[3,3,0,0]=(-0.692703834029)/(o+1.)+(-0.00615860690903)
        ref[3,3,0,1]=(0.88835171354)/(o+1.)+(0.00763271775166)
        ref[3,3,1,0]=(-0.0987823234827)/(o+1.)+(0.628186276549)
        ref[3,3,1,1]=(-0.223347424968)/(o+1.)+(-0.00346757455392)
        ref[3,3,2,0]=(1.22648639393)/(o+1.)+(0.152216781743)
        ref[3,3,2,1]=(0.272100360294)/(o+1.)+(0.111532468623)
        ref[3,4,0,0]=(1.45235034011)/(o+1.)+(-0.0206817576441)
        ref[3,4,0,1]=(1.49583359131)/(o+1.)+(-0.574565590956)
        ref[3,4,1,0]=(0.362882204744)/(o+1.)+(0.581681025235)
        ref[3,4,1,1]=(1.31795519959)/(o+1.)+(-0.0659375558974)
        ref[3,4,2,0]=(0.556130663233)/(o+1.)+(-0.078813607523)
        ref[3,4,2,1]=(1.56413690967)/(o+1.)+(-0.42520624231)
      else:
        arg[0,0,0,0]=(0.956854727968)*x[0]**o+(-0.43263548815)*x[0]+(-0.1485543705)*x[1]**o+(-0.411060684134)*x[1]+(-0.306829513954)*x[2]**o+(0.89077924839)*x[2]
        arg[0,0,0,1]=(0.125905642347)*x[0]**o+(-0.645491335766)*x[0]+(-0.237571989123)*x[1]**o+(-0.239301942511)*x[1]+(-0.384215893518)*x[2]**o+(-0.371218179274)*x[2]
        arg[0,0,1,0]=(0.0204273419969)*x[0]**o+(0.354631489501)*x[0]+(0.235086936835)*x[1]**o+(0.647551574475)*x[1]+(-0.729066874572)*x[2]**o+(0.177733791046)*x[2]
        arg[0,0,1,1]=(-0.0938492166558)*x[0]**o+(-0.484339074939)*x[0]+(0.619333193491)*x[1]**o+(0.809157671781)*x[1]+(-0.28367956249)*x[2]**o+(-0.1758249267)*x[2]
        arg[0,0,2,0]=(-0.334944259519)*x[0]**o+(-0.126145567301)*x[0]+(-0.646972616146)*x[1]**o+(0.20287553181)*x[1]+(-0.383816067326)*x[2]**o+(-0.0265591031498)*x[2]
        arg[0,0,2,1]=(0.103308564583)*x[0]**o+(0.016108181951)*x[0]+(-0.367450237136)*x[1]**o+(0.657618788015)*x[1]+(-0.8327532511)*x[2]**o+(-0.267286876849)*x[2]
        arg[0,1,0,0]=(0.688995722152)*x[0]**o+(-0.982012541087)*x[0]+(-0.232339851099)*x[1]**o+(-0.097863461266)*x[1]+(0.25916639806)*x[2]**o+(0.0538637018789)*x[2]
        arg[0,1,0,1]=(0.446698337789)*x[0]**o+(-0.309434573629)*x[0]+(0.617004214016)*x[1]**o+(0.747666594435)*x[1]+(-0.869684246717)*x[2]**o+(0.75016186442)*x[2]
        arg[0,1,1,0]=(-0.559974353252)*x[0]**o+(0.966642794905)*x[0]+(-0.228473000256)*x[1]**o+(-0.435093965632)*x[1]+(0.426986383284)*x[2]**o+(0.131300817321)*x[2]
        arg[0,1,1,1]=(-0.696027598385)*x[0]**o+(-0.804778535506)*x[0]+(0.930171049019)*x[1]**o+(-0.900826020873)*x[1]+(0.844689166523)*x[2]**o+(0.0349718139676)*x[2]
        arg[0,1,2,0]=(0.359170897328)*x[0]**o+(0.992944582308)*x[0]+(0.579162388074)*x[1]**o+(0.743410851741)*x[1]+(-0.204325306226)*x[2]**o+(-0.992005484878)*x[2]
        arg[0,1,2,1]=(-0.883554988936)*x[0]**o+(0.486947073334)*x[0]+(-0.78078860326)*x[1]**o+(-0.134196299284)*x[1]+(-0.980852067031)*x[2]**o+(0.453023187355)*x[2]
        arg[0,2,0,0]=(0.804524524371)*x[0]**o+(0.397924403155)*x[0]+(0.712297039229)*x[1]**o+(0.713485622558)*x[1]+(-0.966783610543)*x[2]**o+(0.497869404576)*x[2]
        arg[0,2,0,1]=(-0.564706930001)*x[0]**o+(-0.482026983244)*x[0]+(0.284926154564)*x[1]**o+(0.844423322149)*x[1]+(0.444203847061)*x[2]**o+(0.333244188639)*x[2]
        arg[0,2,1,0]=(-0.630410083438)*x[0]**o+(-0.831218126629)*x[0]+(0.400237927956)*x[1]**o+(-0.70518378137)*x[1]+(-0.803754805917)*x[2]**o+(0.60059455602)*x[2]
        arg[0,2,1,1]=(0.198272547853)*x[0]**o+(0.0840356091496)*x[0]+(0.114385146155)*x[1]**o+(0.731057038288)*x[1]+(-0.976056408523)*x[2]**o+(-0.132565954304)*x[2]
        arg[0,2,2,0]=(0.983300141657)*x[0]**o+(-0.733168195162)*x[0]+(-0.948802450335)*x[1]**o+(-0.756616078178)*x[1]+(0.450302374372)*x[2]**o+(0.802115535717)*x[2]
        arg[0,2,2,1]=(-0.680853503774)*x[0]**o+(-0.910402862928)*x[0]+(0.583775613868)*x[1]**o+(0.741516645611)*x[1]+(-0.550498467533)*x[2]**o+(-0.610648481959)*x[2]
        arg[0,3,0,0]=(0.981909313325)*x[0]**o+(0.148145112359)*x[0]+(-0.989721117518)*x[1]**o+(0.0246558730659)*x[1]+(0.721439979982)*x[2]**o+(0.896052837889)*x[2]
        arg[0,3,0,1]=(0.109831691542)*x[0]**o+(-0.349555366958)*x[0]+(-0.54822642636)*x[1]**o+(0.121919022172)*x[1]+(-0.580228247481)*x[2]**o+(0.564276455713)*x[2]
        arg[0,3,1,0]=(0.106091093353)*x[0]**o+(0.410111742327)*x[0]+(-0.0669026478824)*x[1]**o+(-0.662684907574)*x[1]+(-0.351815520918)*x[2]**o+(-0.324802958038)*x[2]
        arg[0,3,1,1]=(0.857685803258)*x[0]**o+(-0.782627954043)*x[0]+(-0.555036389439)*x[1]**o+(-0.0126716685608)*x[1]+(0.260461379777)*x[2]**o+(0.117590260591)*x[2]
        arg[0,3,2,0]=(-0.987873674604)*x[0]**o+(0.0779662295512)*x[0]+(-0.928229202803)*x[1]**o+(0.508015712707)*x[1]+(0.248638760509)*x[2]**o+(-0.712158091156)*x[2]
        arg[0,3,2,1]=(-0.977973356138)*x[0]**o+(0.270015563339)*x[0]+(0.811157094127)*x[1]**o+(-0.756460384936)*x[1]+(-0.735557557504)*x[2]**o+(0.780333584929)*x[2]
        arg[0,4,0,0]=(-0.762444411646)*x[0]**o+(0.386894014691)*x[0]+(0.763898738855)*x[1]**o+(-0.422896581278)*x[1]+(0.428591445563)*x[2]**o+(-0.617626926396)*x[2]
        arg[0,4,0,1]=(-0.269524167286)*x[0]**o+(0.996895823788)*x[0]+(0.771396605337)*x[1]**o+(-0.993794940262)*x[1]+(-0.534803587481)*x[2]**o+(-0.928627946122)*x[2]
        arg[0,4,1,0]=(0.978497459584)*x[0]**o+(-0.343496507186)*x[0]+(-0.250581087884)*x[1]**o+(-0.855743445852)*x[1]+(-0.127512246124)*x[2]**o+(-0.133936486447)*x[2]
        arg[0,4,1,1]=(-0.844450818471)*x[0]**o+(0.263329730105)*x[0]+(0.411212783735)*x[1]**o+(-0.816379748952)*x[1]+(-0.443806901857)*x[2]**o+(0.1262969097)*x[2]
        arg[0,4,2,0]=(-0.326938381124)*x[0]**o+(-0.707054728551)*x[0]+(-0.725513874889)*x[1]**o+(0.655254977879)*x[1]+(0.772734170665)*x[2]**o+(-0.963856465024)*x[2]
        arg[0,4,2,1]=(0.896415185133)*x[0]**o+(-0.722431478737)*x[0]+(0.942058336843)*x[1]**o+(0.838230971246)*x[1]+(-0.279821311439)*x[2]**o+(-0.330130961206)*x[2]
        arg[1,0,0,0]=(-0.466537465363)*x[0]**o+(0.86493624537)*x[0]+(-0.943049537777)*x[1]**o+(0.658727518981)*x[1]+(-0.130355508544)*x[2]**o+(-0.158245981876)*x[2]
        arg[1,0,0,1]=(0.247046604605)*x[0]**o+(-0.287683750248)*x[0]+(0.266630203142)*x[1]**o+(0.372409648579)*x[1]+(-0.239411725166)*x[2]**o+(0.537339451105)*x[2]
        arg[1,0,1,0]=(-0.232312387253)*x[0]**o+(-0.0493954012747)*x[0]+(-0.461085479525)*x[1]**o+(-0.0744729096417)*x[1]+(-0.795163064273)*x[2]**o+(0.613075576806)*x[2]
        arg[1,0,1,1]=(-0.68570821748)*x[0]**o+(-0.492507082229)*x[0]+(-0.0673636097828)*x[1]**o+(0.569119992806)*x[1]+(-0.227653595613)*x[2]**o+(0.0337433636837)*x[2]
        arg[1,0,2,0]=(-0.124371489405)*x[0]**o+(-0.726635218442)*x[0]+(-0.835418167414)*x[1]**o+(-0.00414597707753)*x[1]+(0.8365917104)*x[2]**o+(-0.507314639615)*x[2]
        arg[1,0,2,1]=(-0.973228057052)*x[0]**o+(0.123228228923)*x[0]+(0.545712842666)*x[1]**o+(-0.451331566047)*x[1]+(0.299501907067)*x[2]**o+(-0.24898389883)*x[2]
        arg[1,1,0,0]=(-0.940690906836)*x[0]**o+(-0.357571197214)*x[0]+(0.98643983012)*x[1]**o+(-0.82113140872)*x[1]+(0.460009285424)*x[2]**o+(-0.0298714172583)*x[2]
        arg[1,1,0,1]=(-0.881543245921)*x[0]**o+(-0.640741814727)*x[0]+(-0.749244677096)*x[1]**o+(0.47161101909)*x[1]+(0.712893375828)*x[2]**o+(0.600151133959)*x[2]
        arg[1,1,1,0]=(-0.217214692405)*x[0]**o+(-0.504211076658)*x[0]+(0.857127736087)*x[1]**o+(0.0439761116172)*x[1]+(0.956380848189)*x[2]**o+(0.698482155013)*x[2]
        arg[1,1,1,1]=(-0.288969728734)*x[0]**o+(-0.63960886193)*x[0]+(-0.741293494258)*x[1]**o+(-0.125034323955)*x[1]+(-0.608855286755)*x[2]**o+(0.462427737944)*x[2]
        arg[1,1,2,0]=(0.126242043984)*x[0]**o+(0.811846484451)*x[0]+(-0.522920862127)*x[1]**o+(0.678142081935)*x[1]+(0.0392586436898)*x[2]**o+(0.403908304728)*x[2]
        arg[1,1,2,1]=(-0.290103861843)*x[0]**o+(0.336130241928)*x[0]+(-0.872641307678)*x[1]**o+(-0.372020796526)*x[1]+(0.172572077906)*x[2]**o+(-0.789431556966)*x[2]
        arg[1,2,0,0]=(-0.158114079913)*x[0]**o+(0.954919898537)*x[0]+(-0.711834968234)*x[1]**o+(-0.390487270434)*x[1]+(-0.086581514295)*x[2]**o+(0.442047084988)*x[2]
        arg[1,2,0,1]=(-0.914034594356)*x[0]**o+(0.521137372279)*x[0]+(0.12454416569)*x[1]**o+(0.627815188423)*x[1]+(0.770244577882)*x[2]**o+(-0.846691748091)*x[2]
        arg[1,2,1,0]=(0.769631824465)*x[0]**o+(0.988840796717)*x[0]+(-0.401836868027)*x[1]**o+(0.401846957832)*x[1]+(-0.877826997285)*x[2]**o+(0.857725824229)*x[2]
        arg[1,2,1,1]=(0.173539365276)*x[0]**o+(0.373206670706)*x[0]+(-0.597288730366)*x[1]**o+(-0.770220794555)*x[1]+(-0.586510454467)*x[2]**o+(-0.569370842441)*x[2]
        arg[1,2,2,0]=(0.673765155818)*x[0]**o+(-0.642914516709)*x[0]+(0.794438851788)*x[1]**o+(-0.17557754186)*x[1]+(0.997565143863)*x[2]**o+(0.722460144483)*x[2]
        arg[1,2,2,1]=(-0.878452482718)*x[0]**o+(-0.846862156166)*x[0]+(0.462351027504)*x[1]**o+(0.267435606154)*x[1]+(-0.452135086983)*x[2]**o+(0.701577407252)*x[2]
        arg[1,3,0,0]=(-0.0557389135964)*x[0]**o+(-0.781831460089)*x[0]+(0.214846092931)*x[1]**o+(0.597436260353)*x[1]+(0.713968428327)*x[2]**o+(-0.456335676572)*x[2]
        arg[1,3,0,1]=(0.288266531585)*x[0]**o+(-0.259529556521)*x[0]+(0.0286107975184)*x[1]**o+(0.465095455484)*x[1]+(-0.747648909025)*x[2]**o+(0.682866470382)*x[2]
        arg[1,3,1,0]=(-0.720339104668)*x[0]**o+(0.961100526257)*x[0]+(0.0814885381756)*x[1]**o+(-0.448775223649)*x[1]+(0.250972143198)*x[2]**o+(-0.240231439947)*x[2]
        arg[1,3,1,1]=(-0.459305786748)*x[0]**o+(0.272222143865)*x[0]+(-0.499164099401)*x[1]**o+(-0.225162547271)*x[1]+(-0.92261124167)*x[2]**o+(-0.436659790026)*x[2]
        arg[1,3,2,0]=(0.890752966329)*x[0]**o+(-0.775207922011)*x[0]+(0.715960284721)*x[1]**o+(0.843422841789)*x[1]+(0.513788850466)*x[2]**o+(-0.325733710281)*x[2]
        arg[1,3,2,1]=(0.958726172433)*x[0]**o+(-0.743672393249)*x[0]+(-0.523783133945)*x[1]**o+(0.133861976051)*x[1]+(-0.109230940116)*x[2]**o+(0.819716327751)*x[2]
        arg[1,4,0,0]=(0.54439729551)*x[0]**o+(0.0763503792087)*x[0]+(0.0634218657498)*x[1]**o+(-0.405471845044)*x[1]+(0.316327091756)*x[2]**o+(-0.539493863939)*x[2]
        arg[1,4,0,1]=(0.527330373182)*x[0]**o+(0.77531447123)*x[0]+(-0.481869315442)*x[1]**o+(0.556927692362)*x[1]+(-0.267215098309)*x[2]**o+(0.958919406465)*x[2]
        arg[1,4,1,0]=(0.540950372012)*x[0]**o+(-0.95002626611)*x[0]+(-0.523544509893)*x[1]**o+(-0.583056635057)*x[1]+(-0.00288409928193)*x[2]**o+(0.671385098427)*x[2]
        arg[1,4,1,1]=(-0.39802076092)*x[0]**o+(-0.583264022146)*x[0]+(-0.656261495961)*x[1]**o+(-0.527677078418)*x[1]+(-0.2632498932)*x[2]**o+(-0.537632951507)*x[2]
        arg[1,4,2,0]=(-0.77176416566)*x[0]**o+(0.812696440735)*x[0]+(0.0925789242005)*x[1]**o+(0.299698967601)*x[1]+(-0.0185377066587)*x[2]**o+(-0.883247318682)*x[2]
        arg[1,4,2,1]=(0.360949407452)*x[0]**o+(-0.463659754812)*x[0]+(0.799066387132)*x[1]**o+(0.0318151346916)*x[1]+(-0.380675976437)*x[2]**o+(-0.299341342112)*x[2]
        arg[2,0,0,0]=(-0.985332287141)*x[0]**o+(0.33398206098)*x[0]+(0.39204502373)*x[1]**o+(-0.586826360517)*x[1]+(0.868240161369)*x[2]**o+(-0.257897525907)*x[2]
        arg[2,0,0,1]=(-0.801369266967)*x[0]**o+(0.333496542809)*x[0]+(0.459444994717)*x[1]**o+(-0.950297568688)*x[1]+(-0.760722281765)*x[2]**o+(0.0933850221377)*x[2]
        arg[2,0,1,0]=(0.53372811812)*x[0]**o+(0.999551098511)*x[0]+(-0.761650890163)*x[1]**o+(-0.80456940786)*x[1]+(-0.452089806623)*x[2]**o+(-0.40841169158)*x[2]
        arg[2,0,1,1]=(-0.782294374468)*x[0]**o+(0.614736817827)*x[0]+(0.262995910218)*x[1]**o+(0.067349886804)*x[1]+(-0.167494656909)*x[2]**o+(-0.730462378769)*x[2]
        arg[2,0,2,0]=(0.261001857862)*x[0]**o+(0.959318765248)*x[0]+(-0.177224016298)*x[1]**o+(-0.979637664014)*x[1]+(0.858937930292)*x[2]**o+(-0.627116377798)*x[2]
        arg[2,0,2,1]=(-0.238083578675)*x[0]**o+(0.586367991705)*x[0]+(0.747378561289)*x[1]**o+(-0.540178926415)*x[1]+(-0.519781240185)*x[2]**o+(-0.42715014981)*x[2]
        arg[2,1,0,0]=(-0.21022574437)*x[0]**o+(-0.292359099348)*x[0]+(0.449614855785)*x[1]**o+(-0.416904619153)*x[1]+(0.507537288404)*x[2]**o+(0.943584716996)*x[2]
        arg[2,1,0,1]=(-0.410591525695)*x[0]**o+(-0.258796394127)*x[0]+(-0.474714731399)*x[1]**o+(-0.518288451462)*x[1]+(-0.15640903664)*x[2]**o+(0.97242574307)*x[2]
        arg[2,1,1,0]=(-0.930865834892)*x[0]**o+(0.961887630616)*x[0]+(0.688706862295)*x[1]**o+(-0.375163634404)*x[1]+(0.378954001649)*x[2]**o+(-0.747140890466)*x[2]
        arg[2,1,1,1]=(0.0454701384411)*x[0]**o+(-0.37651801332)*x[0]+(0.0808750051583)*x[1]**o+(-0.530355850075)*x[1]+(0.769675417234)*x[2]**o+(-0.767046792016)*x[2]
        arg[2,1,2,0]=(0.179573418696)*x[0]**o+(-0.0547918709025)*x[0]+(0.739792606043)*x[1]**o+(0.849619562235)*x[1]+(-0.92840796838)*x[2]**o+(-0.302941296337)*x[2]
        arg[2,1,2,1]=(0.160657807137)*x[0]**o+(0.551943403654)*x[0]+(0.649164334204)*x[1]**o+(0.298882266215)*x[1]+(0.33872360276)*x[2]**o+(-0.558910868754)*x[2]
        arg[2,2,0,0]=(-0.704330511528)*x[0]**o+(-0.326943167116)*x[0]+(0.626863819473)*x[1]**o+(-0.107147718189)*x[1]+(0.00668670393016)*x[2]**o+(0.572223662188)*x[2]
        arg[2,2,0,1]=(0.879695137799)*x[0]**o+(-0.313488700497)*x[0]+(-0.113134766565)*x[1]**o+(-0.131007759381)*x[1]+(0.55460969593)*x[2]**o+(0.898706374575)*x[2]
        arg[2,2,1,0]=(0.329932124981)*x[0]**o+(-0.624965470976)*x[0]+(0.82906774364)*x[1]**o+(-0.681403786977)*x[1]+(-0.447119491747)*x[2]**o+(0.143763601614)*x[2]
        arg[2,2,1,1]=(0.0367746207528)*x[0]**o+(0.47553259605)*x[0]+(-0.517723045973)*x[1]**o+(0.263932783195)*x[1]+(-0.131032589284)*x[2]**o+(-0.132729291841)*x[2]
        arg[2,2,2,0]=(-0.108349266564)*x[0]**o+(-0.684748849483)*x[0]+(0.203271582231)*x[1]**o+(-0.860842085896)*x[1]+(0.469684577785)*x[2]**o+(0.195736308182)*x[2]
        arg[2,2,2,1]=(0.915666799349)*x[0]**o+(0.383338953756)*x[0]+(-0.554011249579)*x[1]**o+(0.232285573367)*x[1]+(0.39288151674)*x[2]**o+(0.692592233016)*x[2]
        arg[2,3,0,0]=(0.81179207663)*x[0]**o+(0.786809236572)*x[0]+(-0.814758445611)*x[1]**o+(-0.78461653396)*x[1]+(0.171435802778)*x[2]**o+(0.660186909193)*x[2]
        arg[2,3,0,1]=(0.752694523669)*x[0]**o+(0.301473785296)*x[0]+(0.610379955695)*x[1]**o+(0.573729399495)*x[1]+(0.225983751859)*x[2]**o+(-0.349530143446)*x[2]
        arg[2,3,1,0]=(-0.647825490424)*x[0]**o+(-0.232573858642)*x[0]+(0.773519085771)*x[1]**o+(-0.224497979868)*x[1]+(-0.681726885952)*x[2]**o+(-0.217968759388)*x[2]
        arg[2,3,1,1]=(0.391888417642)*x[0]**o+(-0.240556139087)*x[0]+(-0.852397797723)*x[1]**o+(0.318342758913)*x[1]+(-0.773804983598)*x[2]**o+(-0.957590491908)*x[2]
        arg[2,3,2,0]=(0.7126582007)*x[0]**o+(0.806022164546)*x[0]+(0.232348951782)*x[1]**o+(-0.985774366344)*x[1]+(-0.365161907541)*x[2]**o+(0.0218977623299)*x[2]
        arg[2,3,2,1]=(-0.775068843872)*x[0]**o+(-0.595291330879)*x[0]+(0.681122481841)*x[1]**o+(0.152514252732)*x[1]+(0.510976191808)*x[2]**o+(-0.69539067488)*x[2]
        arg[2,4,0,0]=(-0.362761749405)*x[0]**o+(0.494347958562)*x[0]+(0.215244694522)*x[1]**o+(-0.527767969217)*x[1]+(-0.115976071059)*x[2]**o+(-0.998233415841)*x[2]
        arg[2,4,0,1]=(0.620291015098)*x[0]**o+(-0.222644358028)*x[0]+(0.0377714785847)*x[1]**o+(0.663978623913)*x[1]+(0.996481523389)*x[2]**o+(-0.689519418095)*x[2]
        arg[2,4,1,0]=(-0.0374746407394)*x[0]**o+(0.3186355021)*x[0]+(-0.704305640533)*x[1]**o+(-0.632264150766)*x[1]+(-0.166691199609)*x[2]**o+(-0.794128441334)*x[2]
        arg[2,4,1,1]=(0.117806334919)*x[0]**o+(-0.717334572919)*x[0]+(0.665341054571)*x[1]**o+(0.354208273372)*x[1]+(0.349883631586)*x[2]**o+(-0.260626035314)*x[2]
        arg[2,4,2,0]=(0.160337827685)*x[0]**o+(-0.92734430881)*x[0]+(0.872112181363)*x[1]**o+(-0.796372970466)*x[1]+(-0.776882702685)*x[2]**o+(0.246816968474)*x[2]
        arg[2,4,2,1]=(-0.317926812571)*x[0]**o+(-0.795779593996)*x[0]+(0.785287724793)*x[1]**o+(0.839033515634)*x[1]+(0.433187943714)*x[2]**o+(0.308175885606)*x[2]
        arg[3,0,0,0]=(-0.555193292291)*x[0]**o+(-0.0280452948283)*x[0]+(0.988455127227)*x[1]**o+(-0.637707060271)*x[1]+(-0.95062571916)*x[2]**o+(-0.563121211553)*x[2]
        arg[3,0,0,1]=(-0.169558534946)*x[0]**o+(0.886096637835)*x[0]+(-0.666307491933)*x[1]**o+(0.650321801985)*x[1]+(-0.268934932123)*x[2]**o+(-0.406617199906)*x[2]
        arg[3,0,1,0]=(0.497351781449)*x[0]**o+(0.768617651685)*x[0]+(0.200962956226)*x[1]**o+(0.694236078954)*x[1]+(0.0323702864321)*x[2]**o+(-0.666046265832)*x[2]
        arg[3,0,1,1]=(0.425151807387)*x[0]**o+(-0.886432438604)*x[0]+(-0.963257203569)*x[1]**o+(-0.698524427437)*x[1]+(0.0165810713355)*x[2]**o+(-0.142193988951)*x[2]
        arg[3,0,2,0]=(0.965746112788)*x[0]**o+(-0.333068915886)*x[0]+(0.331031372002)*x[1]**o+(-0.384004796757)*x[1]+(0.0144121092048)*x[2]**o+(-0.352607264387)*x[2]
        arg[3,0,2,1]=(-0.391557775789)*x[0]**o+(0.127020330586)*x[0]+(0.758832450081)*x[1]**o+(0.49669414469)*x[1]+(0.358403498634)*x[2]**o+(0.184963946351)*x[2]
        arg[3,1,0,0]=(0.978053897464)*x[0]**o+(-0.211787313494)*x[0]+(0.927706482976)*x[1]**o+(-0.451292956408)*x[1]+(0.592824645174)*x[2]**o+(0.896240907546)*x[2]
        arg[3,1,0,1]=(0.0780568875295)*x[0]**o+(0.130098698523)*x[0]+(-0.281871571918)*x[1]**o+(-0.596362849045)*x[1]+(-0.436455789199)*x[2]**o+(-0.657145053021)*x[2]
        arg[3,1,1,0]=(-0.278111817329)*x[0]**o+(-0.627384158565)*x[0]+(-0.995802044048)*x[1]**o+(0.42485189159)*x[1]+(0.483473275475)*x[2]**o+(-0.177928974458)*x[2]
        arg[3,1,1,1]=(0.127721047557)*x[0]**o+(0.93147711978)*x[0]+(-0.350992052283)*x[1]**o+(0.0993773637672)*x[1]+(0.29111744653)*x[2]**o+(-0.821710278883)*x[2]
        arg[3,1,2,0]=(-0.697941918276)*x[0]**o+(-0.585872232852)*x[0]+(0.697967779925)*x[1]**o+(-0.811186381728)*x[1]+(0.708726108998)*x[2]**o+(0.289602027081)*x[2]
        arg[3,1,2,1]=(-0.461424409147)*x[0]**o+(0.335089386385)*x[0]+(-0.964838280406)*x[1]**o+(0.828627561583)*x[1]+(-0.861416281013)*x[2]**o+(0.898354675269)*x[2]
        arg[3,2,0,0]=(0.752543705358)*x[0]**o+(0.164487088496)*x[0]+(0.756164002406)*x[1]**o+(-0.740019514032)*x[1]+(0.107245489678)*x[2]**o+(0.677707700079)*x[2]
        arg[3,2,0,1]=(0.763792557134)*x[0]**o+(0.725507550672)*x[0]+(0.171323949629)*x[1]**o+(-0.287172075258)*x[1]+(-0.94865226715)*x[2]**o+(-0.163093465336)*x[2]
        arg[3,2,1,0]=(-0.327892721048)*x[0]**o+(0.334145897353)*x[0]+(-0.936827293436)*x[1]**o+(0.0822687872593)*x[1]+(0.259794829604)*x[2]**o+(0.376908280759)*x[2]
        arg[3,2,1,1]=(0.595012545955)*x[0]**o+(0.617490014693)*x[0]+(-0.658036388462)*x[1]**o+(-0.921055393527)*x[1]+(-0.257878085344)*x[2]**o+(-0.623113089161)*x[2]
        arg[3,2,2,0]=(0.961175705937)*x[0]**o+(0.656031660842)*x[0]+(0.964101580317)*x[1]**o+(0.824033157042)*x[1]+(0.510244886658)*x[2]**o+(-0.236501162729)*x[2]
        arg[3,2,2,1]=(-0.128405588923)*x[0]**o+(-0.0327141502894)*x[0]+(0.909941485131)*x[1]**o+(0.79947258121)*x[1]+(0.635883050534)*x[2]**o+(0.841997575796)*x[2]
        arg[3,3,0,0]=(-0.906234907643)*x[0]**o+(-0.316076976009)*x[0]+(0.863208664533)*x[1]**o+(-0.968640170523)*x[1]+(0.791637381686)*x[2]**o+(-0.543353462098)*x[2]
        arg[3,3,0,1]=(-0.586709036832)*x[0]**o+(-0.299493216592)*x[0]+(-0.173966725899)*x[1]**o+(0.0971838711677)*x[1]+(0.385662922244)*x[2]**o+(0.288932625368)*x[2]
        arg[3,3,1,0]=(-0.33865322795)*x[0]**o+(0.442176445777)*x[0]+(0.706183231282)*x[1]**o+(0.62528018966)*x[1]+(-0.377746006979)*x[2]**o+(-0.261455124139)*x[2]
        arg[3,3,1,1]=(0.834855553776)*x[0]**o+(0.755005824764)*x[0]+(0.446589332183)*x[1]**o+(0.41883521757)*x[1]+(0.820177207209)*x[2]**o+(0.603811552083)*x[2]
        arg[3,3,2,0]=(-0.624282266193)*x[0]**o+(0.28109086861)*x[0]+(0.44286011655)*x[1]**o+(-0.117876187343)*x[1]+(-0.267660131821)*x[2]**o+(0.880359406159)*x[2]
        arg[3,3,2,1]=(-0.0722687033317)*x[0]**o+(-0.7013147214)*x[0]+(0.00614303249005)*x[1]**o+(-0.658138946692)*x[1]+(0.0557277088337)*x[2]**o+(0.614362766103)*x[2]
        arg[3,4,0,0]=(0.935244440586)*x[0]**o+(-0.0699305155896)*x[0]+(-0.849303362918)*x[1]**o+(0.728062537708)*x[1]+(0.404621498028)*x[2]**o+(0.611486631437)*x[2]
        arg[3,4,0,1]=(0.168117782017)*x[0]**o+(-0.0454396423181)*x[0]+(0.46021270423)*x[1]**o+(0.597343569492)*x[1]+(0.561215321486)*x[2]**o+(0.715771227777)*x[2]
        arg[3,4,1,0]=(-0.502675682461)*x[0]**o+(0.543910335185)*x[0]+(0.721732643536)*x[1]**o+(-0.862126899566)*x[1]+(0.794704104653)*x[2]**o+(-0.284248276797)*x[2]
        arg[3,4,1,1]=(-0.580751817984)*x[0]**o+(0.482838505281)*x[0]+(-0.426066109367)*x[1]**o+(-0.456724382007)*x[1]+(-0.770655426938)*x[2]**o+(-0.226232224569)*x[2]
        arg[3,4,2,0]=(0.199832861603)*x[0]**o+(-0.586239366436)*x[0]+(0.730019631541)*x[1]**o+(0.185265476259)*x[1]+(0.514243351617)*x[2]**o+(-0.757742857839)*x[2]
        arg[3,4,2,1]=(-0.941843068195)*x[0]**o+(0.211732407161)*x[0]+(-0.99705602485)*x[1]**o+(-0.198037742645)*x[1]+(0.154058794178)*x[2]**o+(0.0675962671791)*x[2]
        ref[0,0,0,0]=(0.501470843513)/(o+1.)+(0.0235415380528)
        ref[0,0,0,1]=(-0.495882240293)/(o+1.)+(-0.628005728776)
        ref[0,0,1,0]=(-0.47355259574)/(o+1.)+(0.589958427511)
        ref[0,0,1,1]=(0.241804414345)/(o+1.)+(0.0744968350706)
        ref[0,0,2,0]=(-1.36573294299)/(o+1.)+(0.0250854306796)
        ref[0,0,2,1]=(-1.09689492365)/(o+1.)+(0.203220046558)
        ref[0,1,0,0]=(0.715822269113)/(o+1.)+(-0.513006150237)
        ref[0,1,0,1]=(0.194018305088)/(o+1.)+(0.594196942613)
        ref[0,1,1,0]=(-0.361460970224)/(o+1.)+(0.331424823297)
        ref[0,1,1,1]=(1.07883261716)/(o+1.)+(-0.835316371206)
        ref[0,1,2,0]=(0.734007979175)/(o+1.)+(0.372174974585)
        ref[0,1,2,1]=(-2.64519565923)/(o+1.)+(0.402886980703)
        ref[0,2,0,0]=(0.550037953057)/(o+1.)+(0.804639715144)
        ref[0,2,0,1]=(0.164423071623)/(o+1.)+(0.347820263772)
        ref[0,2,1,0]=(-1.0339269614)/(o+1.)+(-0.46790367599)
        ref[0,2,1,1]=(-0.663398714515)/(o+1.)+(0.341263346566)
        ref[0,2,2,0]=(0.484800065694)/(o+1.)+(-0.343834368812)
        ref[0,2,2,1]=(-0.647576357439)/(o+1.)+(-0.389767349638)
        ref[0,3,0,0]=(0.713628175789)/(o+1.)+(0.534426911657)
        ref[0,3,0,1]=(-1.0186229823)/(o+1.)+(0.168320055464)
        ref[0,3,1,0]=(-0.312627075447)/(o+1.)+(-0.288688061643)
        ref[0,3,1,1]=(0.563110793595)/(o+1.)+(-0.338854681006)
        ref[0,3,2,0]=(-1.6674641169)/(o+1.)+(-0.0630880744491)
        ref[0,3,2,1]=(-0.902373819515)/(o+1.)+(0.146944381666)
        ref[0,4,0,0]=(0.430045772773)/(o+1.)+(-0.326814746492)
        ref[0,4,0,1]=(-0.0329311494305)/(o+1.)+(-0.462763531298)
        ref[0,4,1,0]=(0.600404125575)/(o+1.)+(-0.666588219743)
        ref[0,4,1,1]=(-0.877044936593)/(o+1.)+(-0.213376554573)
        ref[0,4,2,0]=(-0.279718085349)/(o+1.)+(-0.507828107848)
        ref[0,4,2,1]=(1.55865221054)/(o+1.)+(-0.107165734349)
        ref[1,0,0,0]=(-1.53994251168)/(o+1.)+(0.682708891237)
        ref[1,0,0,1]=(0.27426508258)/(o+1.)+(0.311032674718)
        ref[1,0,1,0]=(-1.48856093105)/(o+1.)+(0.244603632945)
        ref[1,0,1,1]=(-0.980725422876)/(o+1.)+(0.0551781371305)
        ref[1,0,2,0]=(-0.123197946419)/(o+1.)+(-0.619047917567)
        ref[1,0,2,1]=(-0.128013307318)/(o+1.)+(-0.288543617977)
        ref[1,1,0,0]=(0.505758208708)/(o+1.)+(-0.604287011596)
        ref[1,1,0,1]=(-0.917894547188)/(o+1.)+(0.215510169161)
        ref[1,1,1,0]=(1.59629389187)/(o+1.)+(0.119123594986)
        ref[1,1,1,1]=(-1.63911850975)/(o+1.)+(-0.15110772397)
        ref[1,1,2,0]=(-0.357420174452)/(o+1.)+(0.946948435557)
        ref[1,1,2,1]=(-0.990173091615)/(o+1.)+(-0.412661055782)
        ref[1,2,0,0]=(-0.956530562442)/(o+1.)+(0.503239856545)
        ref[1,2,0,1]=(-0.0192458507848)/(o+1.)+(0.151130406306)
        ref[1,2,1,0]=(-0.510032040848)/(o+1.)+(1.12420678939)
        ref[1,2,1,1]=(-1.01025981956)/(o+1.)+(-0.483192483145)
        ref[1,2,2,0]=(2.46576915147)/(o+1.)+(-0.0480159570431)
        ref[1,2,2,1]=(-0.868236542197)/(o+1.)+(0.0610754286198)
        ref[1,3,0,0]=(0.873075607662)/(o+1.)+(-0.320365438154)
        ref[1,3,0,1]=(-0.430771579922)/(o+1.)+(0.444216184672)
        ref[1,3,1,0]=(-0.387878423294)/(o+1.)+(0.13604693133)
        ref[1,3,1,1]=(-1.88108112782)/(o+1.)+(-0.194800096716)
        ref[1,3,2,0]=(2.12050210152)/(o+1.)+(-0.128759395251)
        ref[1,3,2,1]=(0.325712098372)/(o+1.)+(0.104952955276)
        ref[1,4,0,0]=(0.924146253016)/(o+1.)+(-0.434307664887)
        ref[1,4,0,1]=(-0.221754040568)/(o+1.)+(1.14558078503)
        ref[1,4,1,0]=(0.0145217628367)/(o+1.)+(-0.43084890137)
        ref[1,4,1,1]=(-1.31753215008)/(o+1.)+(-0.824287026036)
        ref[1,4,2,0]=(-0.697722948118)/(o+1.)+(0.114574044827)
        ref[1,4,2,1]=(0.779339818147)/(o+1.)+(-0.365592981116)
        ref[2,0,0,0]=(0.274952897958)/(o+1.)+(-0.255370912722)
        ref[2,0,0,1]=(-1.10264655401)/(o+1.)+(-0.261708001871)
        ref[2,0,1,0]=(-0.680012578665)/(o+1.)+(-0.106715000464)
        ref[2,0,1,1]=(-0.686793121159)/(o+1.)+(-0.0241878370688)
        ref[2,0,2,0]=(0.942715771856)/(o+1.)+(-0.323717638282)
        ref[2,0,2,1]=(-0.0104862575713)/(o+1.)+(-0.19048054226)
        ref[2,1,0,0]=(0.746926399818)/(o+1.)+(0.117160499248)
        ref[2,1,0,1]=(-1.04171529373)/(o+1.)+(0.0976704487401)
        ref[2,1,1,0]=(0.136795029052)/(o+1.)+(-0.0802084471266)
        ref[2,1,1,1]=(0.896020560833)/(o+1.)+(-0.836960327706)
        ref[2,1,2,0]=(-0.00904194364113)/(o+1.)+(0.245943197498)
        ref[2,1,2,1]=(1.1485457441)/(o+1.)+(0.145957400558)
        ref[2,2,0,0]=(-0.0707799881243)/(o+1.)+(0.0690663884416)
        ref[2,2,0,1]=(1.32117006716)/(o+1.)+(0.227104957348)
        ref[2,2,1,0]=(0.711880376874)/(o+1.)+(-0.58130282817)
        ref[2,2,1,1]=(-0.611981014504)/(o+1.)+(0.303368043702)
        ref[2,2,2,0]=(0.564606893452)/(o+1.)+(-0.674927313599)
        ref[2,2,2,1]=(0.754537066511)/(o+1.)+(0.654108380069)
        ref[2,3,0,0]=(0.168469433796)/(o+1.)+(0.331189805903)
        ref[2,3,0,1]=(1.58905823122)/(o+1.)+(0.262836520673)
        ref[2,3,1,0]=(-0.556033290604)/(o+1.)+(-0.337520298949)
        ref[2,3,1,1]=(-1.23431436368)/(o+1.)+(-0.439901936041)
        ref[2,3,2,0]=(0.579845244941)/(o+1.)+(-0.0789272197338)
        ref[2,3,2,1]=(0.417029829778)/(o+1.)+(-0.569083876513)
        ref[2,4,0,0]=(-0.263493125943)/(o+1.)+(-0.515826713248)
        ref[2,4,0,1]=(1.65454401707)/(o+1.)+(-0.124092576105)
        ref[2,4,1,0]=(-0.908471480882)/(o+1.)+(-0.553878545)
        ref[2,4,1,1]=(1.13303102108)/(o+1.)+(-0.31187616743)
        ref[2,4,2,0]=(0.255567306363)/(o+1.)+(-0.738450155401)
        ref[2,4,2,1]=(0.900548855936)/(o+1.)+(0.175714903622)
        ref[3,0,0,0]=(-0.517363884224)/(o+1.)+(-0.614436783326)
        ref[3,0,0,1]=(-1.104800959)/(o+1.)+(0.564900619957)
        ref[3,0,1,0]=(0.730685024108)/(o+1.)+(0.398403732404)
        ref[3,0,1,1]=(-0.521524324846)/(o+1.)+(-0.863575427496)
        ref[3,0,2,0]=(1.31118959399)/(o+1.)+(-0.534840488515)
        ref[3,0,2,1]=(0.725678172925)/(o+1.)+(0.404339210814)
        ref[3,1,0,0]=(2.49858502561)/(o+1.)+(0.116580318822)
        ref[3,1,0,1]=(-0.640270473588)/(o+1.)+(-0.561704601771)
        ref[3,1,1,0]=(-0.790440585902)/(o+1.)+(-0.190230620716)
        ref[3,1,1,1]=(0.0678464418036)/(o+1.)+(0.104572102332)
        ref[3,1,2,0]=(0.708751970646)/(o+1.)+(-0.553728293749)
        ref[3,1,2,1]=(-2.28767897057)/(o+1.)+(1.03103581162)
        ref[3,2,0,0]=(1.61595319744)/(o+1.)+(0.0510876372718)
        ref[3,2,0,1]=(-0.0135357603866)/(o+1.)+(0.137621005039)
        ref[3,2,1,0]=(-1.00492518488)/(o+1.)+(0.396661482686)
        ref[3,2,1,1]=(-0.320901927851)/(o+1.)+(-0.463339233997)
        ref[3,2,2,0]=(2.43552217291)/(o+1.)+(0.621781827577)
        ref[3,2,2,1]=(1.41741894674)/(o+1.)+(0.804378003359)
        ref[3,3,0,0]=(0.748611138576)/(o+1.)+(-0.914035304315)
        ref[3,3,0,1]=(-0.375012840487)/(o+1.)+(0.0433116399723)
        ref[3,3,1,0]=(-0.0102160036467)/(o+1.)+(0.403000755649)
        ref[3,3,1,1]=(2.10162209317)/(o+1.)+(0.888826297208)
        ref[3,3,2,0]=(-0.449082281464)/(o+1.)+(0.521787043713)
        ref[3,3,2,1]=(-0.0103979620079)/(o+1.)+(-0.372545450994)
        ref[3,4,0,0]=(0.490562575696)/(o+1.)+(0.634809326777)
        ref[3,4,0,1]=(1.18954580773)/(o+1.)+(0.633837577475)
        ref[3,4,1,0]=(1.01376106573)/(o+1.)+(-0.301232420589)
        ref[3,4,1,1]=(-1.77747335429)/(o+1.)+(-0.100059050648)
        ref[3,4,2,0]=(1.44409584476)/(o+1.)+(-0.579358374008)
        ref[3,4,2,1]=(-1.78484029887)/(o+1.)+(0.0406454658476)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Solution_rank0(self):
      """
      tests integral of rank 0 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.788336609161)*x[0]**o+(-0.46539601764)*x[0]+(0.0970136798824)*x[1]**o+(-0.120665298671)*x[1]
        ref=(-0.691322929278)/(o+1.)+(-0.293030658156)
      else:
        arg=(0.922255261003)*x[0]**o+(0.0862232364707)*x[0]+(-0.94152635039)*x[1]**o+(0.771078486789)*x[1]+(-0.487642191181)*x[2]**o+(0.971754960362)*x[2]
        ref=(-0.506913280568)/(o+1.)+(0.914528341811)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Solution_rank1(self):
      """
      tests integral of rank 1 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(-0.193071015033)*x[0]**o+(-0.281957941612)*x[0]+(0.269334552863)*x[1]**o+(0.0332262192804)*x[1]
        arg[1]=(-0.982634724425)*x[0]**o+(0.872638820737)*x[0]+(0.828028964603)*x[1]**o+(0.70464418136)*x[1]
        ref[0]=(0.0762635378296)/(o+1.)+(-0.124365861166)
        ref[1]=(-0.154605759822)/(o+1.)+(0.788641501048)
      else:
        arg[0]=(0.0746983082972)*x[0]**o+(0.281818436343)*x[0]+(-0.835321029206)*x[1]**o+(-0.349524270524)*x[1]+(-0.471905088601)*x[2]**o+(0.156327167402)*x[2]
        arg[1]=(-0.971935771255)*x[0]**o+(0.943151542057)*x[0]+(-0.60084258169)*x[1]**o+(0.458392855527)*x[1]+(-0.0173384187065)*x[2]**o+(0.538410338758)*x[2]
        ref[0]=(-1.23252780951)/(o+1.)+(0.0443106666103)
        ref[1]=(-1.59011677165)/(o+1.)+(0.969977368171)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Solution_rank2(self):
      """
      tests integral of rank 2 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(0.568783264759)*x[0]**o+(0.690377280868)*x[0]+(-0.689750922806)*x[1]**o+(-0.262828324126)*x[1]
        arg[0,1]=(-0.981657284673)*x[0]**o+(0.37118874852)*x[0]+(0.733992104146)*x[1]**o+(0.350268735699)*x[1]
        arg[0,2]=(0.713336100765)*x[0]**o+(0.737674447814)*x[0]+(0.239606043833)*x[1]**o+(0.814911366356)*x[1]
        arg[0,3]=(0.171706130967)*x[0]**o+(0.56324398491)*x[0]+(0.328884588679)*x[1]**o+(0.13307521808)*x[1]
        arg[0,4]=(-0.309130885049)*x[0]**o+(0.353596646674)*x[0]+(-0.282764686556)*x[1]**o+(-0.56977508596)*x[1]
        arg[1,0]=(0.974136161109)*x[0]**o+(-0.432477120938)*x[0]+(-0.841212164751)*x[1]**o+(-0.429211937256)*x[1]
        arg[1,1]=(0.0303890146585)*x[0]**o+(-0.712865964696)*x[0]+(0.572471431129)*x[1]**o+(-0.194324510922)*x[1]
        arg[1,2]=(-0.757134870981)*x[0]**o+(-0.018314520594)*x[0]+(0.250423290169)*x[1]**o+(-0.876678823729)*x[1]
        arg[1,3]=(-0.351885929068)*x[0]**o+(-0.561258605321)*x[0]+(0.208995575986)*x[1]**o+(0.428437856056)*x[1]
        arg[1,4]=(-0.313383912526)*x[0]**o+(-0.713484404328)*x[0]+(-0.279619274966)*x[1]**o+(0.72420661494)*x[1]
        arg[2,0]=(-0.686382641827)*x[0]**o+(0.678578408675)*x[0]+(-0.696532353786)*x[1]**o+(-0.154644995634)*x[1]
        arg[2,1]=(0.368548759951)*x[0]**o+(-0.674856247769)*x[0]+(0.908734263899)*x[1]**o+(0.331173572353)*x[1]
        arg[2,2]=(-0.1279136556)*x[0]**o+(-0.161474840876)*x[0]+(-0.775009015881)*x[1]**o+(-0.689552100815)*x[1]
        arg[2,3]=(-0.638450048485)*x[0]**o+(0.755485009392)*x[0]+(-0.793363159431)*x[1]**o+(0.255883452369)*x[1]
        arg[2,4]=(-0.831891512113)*x[0]**o+(-0.811678751836)*x[0]+(-0.487866621558)*x[1]**o+(0.240951890349)*x[1]
        arg[3,0]=(0.448249735424)*x[0]**o+(0.0809467993259)*x[0]+(0.232269153692)*x[1]**o+(0.477512628661)*x[1]
        arg[3,1]=(0.494093407104)*x[0]**o+(0.196761586998)*x[0]+(-0.702155296644)*x[1]**o+(-0.748641693731)*x[1]
        arg[3,2]=(0.432370067164)*x[0]**o+(-0.365671005874)*x[0]+(0.452009309356)*x[1]**o+(-0.951328172558)*x[1]
        arg[3,3]=(-0.993290240028)*x[0]**o+(0.172534714933)*x[0]+(0.00917693958413)*x[1]**o+(0.417515657393)*x[1]
        arg[3,4]=(0.541299019375)*x[0]**o+(0.479118172057)*x[0]+(-0.502475287154)*x[1]**o+(-0.04397899716)*x[1]
        ref[0,0]=(-0.120967658047)/(o+1.)+(0.213774478371)
        ref[0,1]=(-0.247665180527)/(o+1.)+(0.360728742109)
        ref[0,2]=(0.952942144598)/(o+1.)+(0.776292907085)
        ref[0,3]=(0.500590719646)/(o+1.)+(0.348159601495)
        ref[0,4]=(-0.591895571605)/(o+1.)+(-0.108089219643)
        ref[1,0]=(0.132923996358)/(o+1.)+(-0.430844529097)
        ref[1,1]=(0.602860445788)/(o+1.)+(-0.453595237809)
        ref[1,2]=(-0.506711580812)/(o+1.)+(-0.447496672161)
        ref[1,3]=(-0.142890353081)/(o+1.)+(-0.066410374632)
        ref[1,4]=(-0.593003187492)/(o+1.)+(0.00536110530621)
        ref[2,0]=(-1.38291499561)/(o+1.)+(0.261966706521)
        ref[2,1]=(1.27728302385)/(o+1.)+(-0.171841337708)
        ref[2,2]=(-0.902922671481)/(o+1.)+(-0.425513470846)
        ref[2,3]=(-1.43181320792)/(o+1.)+(0.505684230881)
        ref[2,4]=(-1.31975813367)/(o+1.)+(-0.285363430743)
        ref[3,0]=(0.680518889117)/(o+1.)+(0.279229713993)
        ref[3,1]=(-0.20806188954)/(o+1.)+(-0.275940053366)
        ref[3,2]=(0.88437937652)/(o+1.)+(-0.658499589216)
        ref[3,3]=(-0.984113300443)/(o+1.)+(0.295025186163)
        ref[3,4]=(0.0388237322207)/(o+1.)+(0.217569587448)
      else:
        arg[0,0]=(-0.866239193113)*x[0]**o+(0.479559390215)*x[0]+(0.512920648125)*x[1]**o+(-0.504775214511)*x[1]+(0.462210441279)*x[2]**o+(0.000249131516168)*x[2]
        arg[0,1]=(-0.11397206495)*x[0]**o+(0.0762933475692)*x[0]+(0.347716642793)*x[1]**o+(0.373262578958)*x[1]+(0.965468442129)*x[2]**o+(-0.743205128452)*x[2]
        arg[0,2]=(-0.214519408107)*x[0]**o+(-0.663675446512)*x[0]+(-0.424102625804)*x[1]**o+(-0.426644021856)*x[1]+(-0.0731662128704)*x[2]**o+(-0.375185307096)*x[2]
        arg[0,3]=(0.599595484989)*x[0]**o+(-0.303187098474)*x[0]+(0.278524134467)*x[1]**o+(-0.579432425528)*x[1]+(0.006698672684)*x[2]**o+(-0.820721120517)*x[2]
        arg[0,4]=(0.538847126305)*x[0]**o+(0.58093792853)*x[0]+(-0.21189097773)*x[1]**o+(0.637101424777)*x[1]+(0.0155994636183)*x[2]**o+(0.488675370945)*x[2]
        arg[1,0]=(-0.775581481064)*x[0]**o+(-0.968381856562)*x[0]+(-0.660755920498)*x[1]**o+(0.746481830633)*x[1]+(-0.300061615221)*x[2]**o+(-0.720031101537)*x[2]
        arg[1,1]=(0.990001351802)*x[0]**o+(-0.168997300944)*x[0]+(0.0134555819367)*x[1]**o+(0.969355591009)*x[1]+(-0.347553438064)*x[2]**o+(0.648537935984)*x[2]
        arg[1,2]=(-0.327760535516)*x[0]**o+(0.517489199537)*x[0]+(-0.0589046196438)*x[1]**o+(-0.893401439507)*x[1]+(-0.0821634552571)*x[2]**o+(0.861266440343)*x[2]
        arg[1,3]=(-0.808782893446)*x[0]**o+(-0.196363777506)*x[0]+(0.623837845847)*x[1]**o+(-0.05392424847)*x[1]+(0.616011657554)*x[2]**o+(0.800682023434)*x[2]
        arg[1,4]=(-0.425073222968)*x[0]**o+(-0.635248695204)*x[0]+(0.947222621311)*x[1]**o+(0.253198813179)*x[1]+(-0.907568459712)*x[2]**o+(-0.513049744062)*x[2]
        arg[2,0]=(-0.103867107528)*x[0]**o+(0.893031214224)*x[0]+(0.151292631908)*x[1]**o+(-0.407189878657)*x[1]+(0.618120612304)*x[2]**o+(0.983992964931)*x[2]
        arg[2,1]=(0.310432646627)*x[0]**o+(0.235143842057)*x[0]+(0.729683627093)*x[1]**o+(0.891778928523)*x[1]+(-0.148927367367)*x[2]**o+(0.913403960844)*x[2]
        arg[2,2]=(0.610293692912)*x[0]**o+(-0.28497731539)*x[0]+(-0.926462472232)*x[1]**o+(-0.427657211191)*x[1]+(0.467905160751)*x[2]**o+(0.195578740767)*x[2]
        arg[2,3]=(0.854869452114)*x[0]**o+(-0.752530632831)*x[0]+(0.0128220565485)*x[1]**o+(-0.726013651836)*x[1]+(-0.0979888078519)*x[2]**o+(-0.658955703807)*x[2]
        arg[2,4]=(0.536447848289)*x[0]**o+(-0.658205406579)*x[0]+(0.66427484293)*x[1]**o+(-0.250014589496)*x[1]+(-0.0654257159073)*x[2]**o+(0.538196496913)*x[2]
        arg[3,0]=(-0.514665034974)*x[0]**o+(-0.278189747423)*x[0]+(0.402996329453)*x[1]**o+(-0.0362969716175)*x[1]+(-0.707890815004)*x[2]**o+(-0.298762865096)*x[2]
        arg[3,1]=(0.7342439327)*x[0]**o+(-0.387336714116)*x[0]+(-0.67888634151)*x[1]**o+(0.647322640846)*x[1]+(-0.0346274738413)*x[2]**o+(0.985950301913)*x[2]
        arg[3,2]=(0.687555064124)*x[0]**o+(0.345506248144)*x[0]+(0.658692258064)*x[1]**o+(0.810796031447)*x[1]+(0.102608006398)*x[2]**o+(0.349877767777)*x[2]
        arg[3,3]=(-0.456241806837)*x[0]**o+(-0.181224535865)*x[0]+(0.401842456169)*x[1]**o+(-0.413936620519)*x[1]+(0.436794604974)*x[2]**o+(0.95051042082)*x[2]
        arg[3,4]=(-0.330739393408)*x[0]**o+(-0.261876658969)*x[0]+(0.287474017623)*x[1]**o+(0.463691723118)*x[1]+(0.757597823206)*x[2]**o+(0.49336246207)*x[2]
        ref[0,0]=(0.108891896292)/(o+1.)+(-0.01248334639)
        ref[0,1]=(1.19921301997)/(o+1.)+(-0.146824600962)
        ref[0,2]=(-0.711788246781)/(o+1.)+(-0.732752387732)
        ref[0,3]=(0.88481829214)/(o+1.)+(-0.85167032226)
        ref[0,4]=(0.342555612194)/(o+1.)+(0.853357362126)
        ref[1,0]=(-1.73639901678)/(o+1.)+(-0.470965563733)
        ref[1,1]=(0.655903495675)/(o+1.)+(0.724448113024)
        ref[1,2]=(-0.468828610417)/(o+1.)+(0.242677100186)
        ref[1,3]=(0.431066609955)/(o+1.)+(0.275196998729)
        ref[1,4]=(-0.385419061368)/(o+1.)+(-0.447549813044)
        ref[2,0]=(0.665546136685)/(o+1.)+(0.734917150249)
        ref[2,1]=(0.891188906354)/(o+1.)+(1.02016336571)
        ref[2,2]=(0.151736381432)/(o+1.)+(-0.258527892907)
        ref[2,3]=(0.76970270081)/(o+1.)+(-1.06874999424)
        ref[2,4]=(1.13529697531)/(o+1.)+(-0.185011749581)
        ref[3,0]=(-0.819559520525)/(o+1.)+(-0.306624792068)
        ref[3,1]=(0.020730117348)/(o+1.)+(0.622968114321)
        ref[3,2]=(1.44885532859)/(o+1.)+(0.753090023684)
        ref[3,3]=(0.382395254306)/(o+1.)+(0.177674632218)
        ref[3,4]=(0.714332447421)/(o+1.)+(0.34758876311)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Solution_rank3(self):
      """
      tests integral of rank 3 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(0.779261125448)*x[0]**o+(-0.640503838419)*x[0]+(0.589085035572)*x[1]**o+(-0.0426687544445)*x[1]
        arg[0,0,1]=(-0.419361292473)*x[0]**o+(0.0850684591011)*x[0]+(-0.440758336688)*x[1]**o+(0.151015611594)*x[1]
        arg[0,1,0]=(-0.727043966709)*x[0]**o+(0.711730063365)*x[0]+(0.657759819512)*x[1]**o+(-0.210981156609)*x[1]
        arg[0,1,1]=(-0.276491768644)*x[0]**o+(-0.324865684188)*x[0]+(-0.921856877627)*x[1]**o+(-0.246833902926)*x[1]
        arg[1,0,0]=(0.720541615152)*x[0]**o+(-0.0406851820986)*x[0]+(0.33976001267)*x[1]**o+(0.937989079378)*x[1]
        arg[1,0,1]=(0.239272962875)*x[0]**o+(0.482026352856)*x[0]+(0.159148474482)*x[1]**o+(0.680831564145)*x[1]
        arg[1,1,0]=(0.55170300456)*x[0]**o+(-0.261357073238)*x[0]+(0.298185649596)*x[1]**o+(-0.540598468483)*x[1]
        arg[1,1,1]=(0.508262701362)*x[0]**o+(-0.531692643817)*x[0]+(0.151424571021)*x[1]**o+(-0.77488755481)*x[1]
        arg[2,0,0]=(0.265201389846)*x[0]**o+(0.377300848247)*x[0]+(0.0402148688087)*x[1]**o+(0.0263806695524)*x[1]
        arg[2,0,1]=(0.321397565411)*x[0]**o+(-0.277650913698)*x[0]+(0.909430556637)*x[1]**o+(-0.43244155765)*x[1]
        arg[2,1,0]=(-0.671417887851)*x[0]**o+(-0.772328065901)*x[0]+(0.0896878386442)*x[1]**o+(0.584773963567)*x[1]
        arg[2,1,1]=(0.318995094412)*x[0]**o+(-0.396578444213)*x[0]+(-0.627767362562)*x[1]**o+(-0.588717342984)*x[1]
        arg[3,0,0]=(-0.154999830633)*x[0]**o+(-0.263434767944)*x[0]+(0.0704862479101)*x[1]**o+(0.216237505495)*x[1]
        arg[3,0,1]=(0.956868643095)*x[0]**o+(-0.0331644426873)*x[0]+(-0.236340025853)*x[1]**o+(-0.814705425837)*x[1]
        arg[3,1,0]=(-0.477985064084)*x[0]**o+(-0.368896833289)*x[0]+(0.208122873207)*x[1]**o+(-0.566525593432)*x[1]
        arg[3,1,1]=(-0.299257275248)*x[0]**o+(0.937022356746)*x[0]+(0.671724793932)*x[1]**o+(0.80705820341)*x[1]
        arg[4,0,0]=(0.857855249735)*x[0]**o+(0.537756541143)*x[0]+(0.611784225987)*x[1]**o+(0.944061991186)*x[1]
        arg[4,0,1]=(0.825779290308)*x[0]**o+(-0.636461636739)*x[0]+(-0.382007450888)*x[1]**o+(0.170178262303)*x[1]
        arg[4,1,0]=(0.275666857657)*x[0]**o+(-0.404983003194)*x[0]+(0.476932065223)*x[1]**o+(0.931645726493)*x[1]
        arg[4,1,1]=(0.956182179652)*x[0]**o+(0.543482655321)*x[0]+(0.60492494312)*x[1]**o+(0.384497838341)*x[1]
        arg[5,0,0]=(0.476937368598)*x[0]**o+(-0.588434801718)*x[0]+(0.865080125217)*x[1]**o+(-0.954493375041)*x[1]
        arg[5,0,1]=(0.151850214007)*x[0]**o+(0.252651124764)*x[0]+(-0.570132867968)*x[1]**o+(-0.0885902498736)*x[1]
        arg[5,1,0]=(-0.69330471578)*x[0]**o+(0.165874518143)*x[0]+(-0.610503496045)*x[1]**o+(-0.871951964138)*x[1]
        arg[5,1,1]=(-0.539191264945)*x[0]**o+(0.558474736927)*x[0]+(0.752045569996)*x[1]**o+(-0.5305308467)*x[1]
        ref[0,0,0]=(1.36834616102)/(o+1.)+(-0.341586296432)
        ref[0,0,1]=(-0.860119629161)/(o+1.)+(0.118042035348)
        ref[0,1,0]=(-0.0692841471964)/(o+1.)+(0.250374453378)
        ref[0,1,1]=(-1.19834864627)/(o+1.)+(-0.285849793557)
        ref[1,0,0]=(1.06030162782)/(o+1.)+(0.448651948639)
        ref[1,0,1]=(0.398421437357)/(o+1.)+(0.5814289585)
        ref[1,1,0]=(0.849888654155)/(o+1.)+(-0.400977770861)
        ref[1,1,1]=(0.659687272383)/(o+1.)+(-0.653290099314)
        ref[2,0,0]=(0.305416258655)/(o+1.)+(0.2018407589)
        ref[2,0,1]=(1.23082812205)/(o+1.)+(-0.355046235674)
        ref[2,1,0]=(-0.581730049206)/(o+1.)+(-0.0937770511668)
        ref[2,1,1]=(-0.30877226815)/(o+1.)+(-0.492647893598)
        ref[3,0,0]=(-0.0845135827233)/(o+1.)+(-0.0235986312242)
        ref[3,0,1]=(0.720528617241)/(o+1.)+(-0.423934934262)
        ref[3,1,0]=(-0.269862190877)/(o+1.)+(-0.46771121336)
        ref[3,1,1]=(0.372467518684)/(o+1.)+(0.872040280078)
        ref[4,0,0]=(1.46963947572)/(o+1.)+(0.740909266165)
        ref[4,0,1]=(0.44377183942)/(o+1.)+(-0.233141687218)
        ref[4,1,0]=(0.75259892288)/(o+1.)+(0.26333136165)
        ref[4,1,1]=(1.56110712277)/(o+1.)+(0.463990246831)
        ref[5,0,0]=(1.34201749382)/(o+1.)+(-0.771464088379)
        ref[5,0,1]=(-0.418282653961)/(o+1.)+(0.0820304374451)
        ref[5,1,0]=(-1.30380821182)/(o+1.)+(-0.353038722997)
        ref[5,1,1]=(0.212854305051)/(o+1.)+(0.0139719451134)
      else:
        arg[0,0,0]=(-0.825926001774)*x[0]**o+(0.418049316138)*x[0]+(0.668695279849)*x[1]**o+(-0.7323605258)*x[1]+(-0.637717742224)*x[2]**o+(0.257065974143)*x[2]
        arg[0,0,1]=(-0.169779448443)*x[0]**o+(-0.648612931029)*x[0]+(-0.643814352995)*x[1]**o+(0.396704595574)*x[1]+(-0.248766540261)*x[2]**o+(-0.736410673282)*x[2]
        arg[0,1,0]=(-0.371929441192)*x[0]**o+(0.438661796459)*x[0]+(-0.893450426264)*x[1]**o+(0.643494077636)*x[1]+(0.252099102122)*x[2]**o+(-0.0857798075076)*x[2]
        arg[0,1,1]=(0.336251711034)*x[0]**o+(-0.317426111079)*x[0]+(-0.801221986791)*x[1]**o+(0.281123033042)*x[1]+(0.921153543163)*x[2]**o+(0.497003835923)*x[2]
        arg[1,0,0]=(0.40897311872)*x[0]**o+(0.326894801733)*x[0]+(0.216268807497)*x[1]**o+(0.946235364974)*x[1]+(-0.480995485096)*x[2]**o+(0.869772937982)*x[2]
        arg[1,0,1]=(0.108715554449)*x[0]**o+(0.0847529231253)*x[0]+(0.866120965844)*x[1]**o+(0.43989772616)*x[1]+(0.67962061792)*x[2]**o+(0.90311988632)*x[2]
        arg[1,1,0]=(0.28571484173)*x[0]**o+(0.593050819853)*x[0]+(-0.384864010146)*x[1]**o+(-0.57920566259)*x[1]+(-0.304024223769)*x[2]**o+(-0.0279518764989)*x[2]
        arg[1,1,1]=(0.249126658892)*x[0]**o+(0.243355410215)*x[0]+(0.154816978135)*x[1]**o+(-0.260343533153)*x[1]+(-0.973133787852)*x[2]**o+(0.752545508531)*x[2]
        arg[2,0,0]=(0.103612497259)*x[0]**o+(0.0919234144108)*x[0]+(0.416394965635)*x[1]**o+(-0.0132359939268)*x[1]+(-0.522775855178)*x[2]**o+(-0.985811066906)*x[2]
        arg[2,0,1]=(-0.592641488144)*x[0]**o+(0.703703144485)*x[0]+(-0.0149046721584)*x[1]**o+(0.220368283581)*x[1]+(-0.656858164281)*x[2]**o+(0.165951102113)*x[2]
        arg[2,1,0]=(0.309492848012)*x[0]**o+(-0.301037623847)*x[0]+(-0.224814259669)*x[1]**o+(-0.950794406688)*x[1]+(-0.296088293363)*x[2]**o+(-0.712930293168)*x[2]
        arg[2,1,1]=(0.0592633594166)*x[0]**o+(-0.179007619512)*x[0]+(-0.922169690831)*x[1]**o+(-0.778228075089)*x[1]+(-0.135749453777)*x[2]**o+(-0.146265051618)*x[2]
        arg[3,0,0]=(-0.71773633584)*x[0]**o+(0.471551385738)*x[0]+(-0.041415831943)*x[1]**o+(0.343380640343)*x[1]+(-0.211821446187)*x[2]**o+(-0.661201893183)*x[2]
        arg[3,0,1]=(-0.159071045836)*x[0]**o+(0.216715127143)*x[0]+(-0.846847485213)*x[1]**o+(0.662226888693)*x[1]+(0.050806337433)*x[2]**o+(0.744071347051)*x[2]
        arg[3,1,0]=(-0.363431877105)*x[0]**o+(-0.461513470653)*x[0]+(-0.130947882739)*x[1]**o+(-0.624729599981)*x[1]+(0.778572567699)*x[2]**o+(0.324584316744)*x[2]
        arg[3,1,1]=(0.395432262346)*x[0]**o+(0.826450301981)*x[0]+(0.176721657975)*x[1]**o+(-0.370954952405)*x[1]+(-0.708437370609)*x[2]**o+(-0.150075114354)*x[2]
        arg[4,0,0]=(-0.18662583335)*x[0]**o+(-0.0120831234457)*x[0]+(0.805686139762)*x[1]**o+(0.30195413136)*x[1]+(0.648067854031)*x[2]**o+(0.28073240632)*x[2]
        arg[4,0,1]=(-0.913625644854)*x[0]**o+(-0.264637827098)*x[0]+(-0.6531590441)*x[1]**o+(0.396422722623)*x[1]+(0.280591271146)*x[2]**o+(0.498346191707)*x[2]
        arg[4,1,0]=(0.208029597907)*x[0]**o+(-0.295747909396)*x[0]+(-0.541509895186)*x[1]**o+(-0.511394562575)*x[1]+(-0.459197562982)*x[2]**o+(-0.749433614666)*x[2]
        arg[4,1,1]=(-0.29700028905)*x[0]**o+(-0.590932598278)*x[0]+(0.36219700213)*x[1]**o+(0.482759242709)*x[1]+(-0.135696240971)*x[2]**o+(0.49658807849)*x[2]
        arg[5,0,0]=(-0.800345624219)*x[0]**o+(0.259709746207)*x[0]+(0.480073493816)*x[1]**o+(0.499332550127)*x[1]+(0.691794186846)*x[2]**o+(-0.319369042249)*x[2]
        arg[5,0,1]=(0.300879052118)*x[0]**o+(-0.985396817441)*x[0]+(0.971136879002)*x[1]**o+(0.806560091745)*x[1]+(0.361308859099)*x[2]**o+(0.264277089732)*x[2]
        arg[5,1,0]=(0.271857906548)*x[0]**o+(0.338260411675)*x[0]+(-0.170292665803)*x[1]**o+(0.675491566142)*x[1]+(0.897921755421)*x[2]**o+(-0.829233864443)*x[2]
        arg[5,1,1]=(0.673366845241)*x[0]**o+(0.121940550422)*x[0]+(0.116054155545)*x[1]**o+(0.0456556938689)*x[1]+(-0.978127590673)*x[2]**o+(0.180985351995)*x[2]
        ref[0,0,0]=(-0.794948464148)/(o+1.)+(-0.0286226177598)
        ref[0,0,1]=(-1.0623603417)/(o+1.)+(-0.494159504368)
        ref[0,1,0]=(-1.01328076533)/(o+1.)+(0.498188033294)
        ref[0,1,1]=(0.456183267406)/(o+1.)+(0.230350378943)
        ref[1,0,0]=(0.144246441122)/(o+1.)+(1.07145155234)
        ref[1,0,1]=(1.65445713821)/(o+1.)+(0.713885267803)
        ref[1,1,0]=(-0.403173392185)/(o+1.)+(-0.0070533596178)
        ref[1,1,1]=(-0.569190150825)/(o+1.)+(0.367778692797)
        ref[2,0,0]=(-0.00276839228366)/(o+1.)+(-0.453561823211)
        ref[2,0,1]=(-1.26440432458)/(o+1.)+(0.545011265089)
        ref[2,1,0]=(-0.21140970502)/(o+1.)+(-0.982381161851)
        ref[2,1,1]=(-0.998655785191)/(o+1.)+(-0.55175037311)
        ref[3,0,0]=(-0.97097361397)/(o+1.)+(0.0768650664488)
        ref[3,0,1]=(-0.955112193616)/(o+1.)+(0.811506681444)
        ref[3,1,0]=(0.284192807855)/(o+1.)+(-0.380829376946)
        ref[3,1,1]=(-0.136283450288)/(o+1.)+(0.152710117611)
        ref[4,0,0]=(1.26712816044)/(o+1.)+(0.285301707117)
        ref[4,0,1]=(-1.28619341781)/(o+1.)+(0.315065543616)
        ref[4,1,0]=(-0.792677860261)/(o+1.)+(-0.778288043318)
        ref[4,1,1]=(-0.0704995278906)/(o+1.)+(0.194207361461)
        ref[5,0,0]=(0.371522056443)/(o+1.)+(0.219836627043)
        ref[5,0,1]=(1.63332479022)/(o+1.)+(0.0427201820182)
        ref[5,1,0]=(0.999486996166)/(o+1.)+(0.0922590566873)
        ref[5,1,1]=(-0.188706589887)/(o+1.)+(0.174290798143)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Solution_rank4(self):
      """
      tests integral of rank 4 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.647932589381)*x[0]**o+(-0.092686685918)*x[0]+(0.167888464541)*x[1]**o+(0.698445840627)*x[1]
        arg[0,0,0,1]=(0.413204959658)*x[0]**o+(0.772926029512)*x[0]+(-0.63702948026)*x[1]**o+(0.608392823861)*x[1]
        arg[0,0,1,0]=(0.303506932052)*x[0]**o+(0.650309664063)*x[0]+(-0.805238344485)*x[1]**o+(-0.62971680995)*x[1]
        arg[0,0,1,1]=(-0.205701190736)*x[0]**o+(-0.0834042840814)*x[0]+(-0.525839398431)*x[1]**o+(0.779973223005)*x[1]
        arg[0,0,2,0]=(-0.97954633631)*x[0]**o+(-0.298973871114)*x[0]+(0.858022652298)*x[1]**o+(0.667671796632)*x[1]
        arg[0,0,2,1]=(-0.790133712345)*x[0]**o+(-0.733743414808)*x[0]+(0.337185148145)*x[1]**o+(-0.927853051244)*x[1]
        arg[0,1,0,0]=(0.617198112458)*x[0]**o+(0.70438849416)*x[0]+(-0.861661596364)*x[1]**o+(-0.251796116219)*x[1]
        arg[0,1,0,1]=(0.37107453636)*x[0]**o+(-0.490440661153)*x[0]+(0.849252675242)*x[1]**o+(-0.896547775077)*x[1]
        arg[0,1,1,0]=(0.375080744007)*x[0]**o+(-0.609557663503)*x[0]+(-0.930846980977)*x[1]**o+(0.0623096843381)*x[1]
        arg[0,1,1,1]=(-0.809863615805)*x[0]**o+(-0.999724521803)*x[0]+(0.493027030633)*x[1]**o+(-0.672546253752)*x[1]
        arg[0,1,2,0]=(0.219294077412)*x[0]**o+(-0.7854819847)*x[0]+(-0.353026321798)*x[1]**o+(-0.965348418509)*x[1]
        arg[0,1,2,1]=(0.177236321722)*x[0]**o+(-0.860491592895)*x[0]+(-0.458724268899)*x[1]**o+(-0.476508229653)*x[1]
        arg[0,2,0,0]=(0.0760611767074)*x[0]**o+(-0.00296398964042)*x[0]+(-0.972843039436)*x[1]**o+(-0.0422057743881)*x[1]
        arg[0,2,0,1]=(-0.926737777701)*x[0]**o+(-0.895791593378)*x[0]+(-0.776529150964)*x[1]**o+(0.557115706978)*x[1]
        arg[0,2,1,0]=(0.353264702858)*x[0]**o+(0.632583933138)*x[0]+(-0.354112684469)*x[1]**o+(0.0541346174117)*x[1]
        arg[0,2,1,1]=(-0.124181989217)*x[0]**o+(-0.803262099858)*x[0]+(0.733246361984)*x[1]**o+(0.0639821744038)*x[1]
        arg[0,2,2,0]=(-0.446733845136)*x[0]**o+(-0.187373171381)*x[0]+(-0.312309043572)*x[1]**o+(0.830789380477)*x[1]
        arg[0,2,2,1]=(0.403889932995)*x[0]**o+(-0.243474625233)*x[0]+(0.35707779102)*x[1]**o+(0.29725421988)*x[1]
        arg[0,3,0,0]=(-0.856376546696)*x[0]**o+(0.448431504377)*x[0]+(-0.535187100108)*x[1]**o+(-0.90994242894)*x[1]
        arg[0,3,0,1]=(-0.321475754775)*x[0]**o+(0.0389358177737)*x[0]+(-0.0949733279735)*x[1]**o+(0.921937240884)*x[1]
        arg[0,3,1,0]=(0.591276336387)*x[0]**o+(-0.598236438303)*x[0]+(-0.829829995185)*x[1]**o+(0.539669346291)*x[1]
        arg[0,3,1,1]=(-0.944726366074)*x[0]**o+(-0.796928273271)*x[0]+(-0.424606656681)*x[1]**o+(0.35341306063)*x[1]
        arg[0,3,2,0]=(-0.850914599406)*x[0]**o+(0.791179202404)*x[0]+(-0.0220845565851)*x[1]**o+(0.594756136957)*x[1]
        arg[0,3,2,1]=(0.355862680641)*x[0]**o+(0.134261680432)*x[0]+(0.477798827075)*x[1]**o+(0.508452338499)*x[1]
        arg[0,4,0,0]=(0.481974944781)*x[0]**o+(0.259271175551)*x[0]+(0.953827692515)*x[1]**o+(0.364160709544)*x[1]
        arg[0,4,0,1]=(-0.316627315143)*x[0]**o+(-0.856616735533)*x[0]+(0.308508314695)*x[1]**o+(-0.677602758367)*x[1]
        arg[0,4,1,0]=(-0.76069824745)*x[0]**o+(0.282351651183)*x[0]+(-0.15964276552)*x[1]**o+(-0.344276428838)*x[1]
        arg[0,4,1,1]=(9.00669303738e-05)*x[0]**o+(0.948498888115)*x[0]+(0.690370267333)*x[1]**o+(0.619119188327)*x[1]
        arg[0,4,2,0]=(0.957692561039)*x[0]**o+(-0.147005436631)*x[0]+(-0.177840574215)*x[1]**o+(-0.28259452614)*x[1]
        arg[0,4,2,1]=(-0.431771943451)*x[0]**o+(-0.158132166651)*x[0]+(-0.134385316147)*x[1]**o+(0.751243590835)*x[1]
        arg[1,0,0,0]=(-0.816841420645)*x[0]**o+(0.55608373851)*x[0]+(-0.885838014201)*x[1]**o+(-0.467159163867)*x[1]
        arg[1,0,0,1]=(-0.543361117401)*x[0]**o+(0.329490019675)*x[0]+(0.942703992489)*x[1]**o+(-0.261273838803)*x[1]
        arg[1,0,1,0]=(0.865108106801)*x[0]**o+(-0.376972427024)*x[0]+(-0.0257304693919)*x[1]**o+(0.694210909726)*x[1]
        arg[1,0,1,1]=(0.428354498121)*x[0]**o+(0.962704601892)*x[0]+(-0.442636806139)*x[1]**o+(0.424724924149)*x[1]
        arg[1,0,2,0]=(-0.157277242299)*x[0]**o+(0.487588443251)*x[0]+(-0.813089096341)*x[1]**o+(0.0406316718829)*x[1]
        arg[1,0,2,1]=(0.345322702588)*x[0]**o+(0.224429042659)*x[0]+(-0.24109926586)*x[1]**o+(0.433141241931)*x[1]
        arg[1,1,0,0]=(0.956901263519)*x[0]**o+(0.48418062914)*x[0]+(0.14089030013)*x[1]**o+(-0.492352201717)*x[1]
        arg[1,1,0,1]=(-0.679781695411)*x[0]**o+(0.29857196636)*x[0]+(-0.234968984185)*x[1]**o+(0.114575919411)*x[1]
        arg[1,1,1,0]=(0.488378272934)*x[0]**o+(-0.358508327343)*x[0]+(-0.337958846849)*x[1]**o+(0.189303452912)*x[1]
        arg[1,1,1,1]=(-0.506993859574)*x[0]**o+(-0.682478021258)*x[0]+(-0.540344338899)*x[1]**o+(0.366965535976)*x[1]
        arg[1,1,2,0]=(-0.681151638572)*x[0]**o+(0.790837550009)*x[0]+(-0.810785716023)*x[1]**o+(-0.00739097962416)*x[1]
        arg[1,1,2,1]=(-0.355290573677)*x[0]**o+(-0.263294580108)*x[0]+(0.10469018402)*x[1]**o+(-0.650388283116)*x[1]
        arg[1,2,0,0]=(0.906212689905)*x[0]**o+(-0.673956103538)*x[0]+(0.305335278934)*x[1]**o+(-0.0805949628719)*x[1]
        arg[1,2,0,1]=(-0.98311373852)*x[0]**o+(-0.165316704542)*x[0]+(0.197637770603)*x[1]**o+(0.647989184342)*x[1]
        arg[1,2,1,0]=(0.415990736251)*x[0]**o+(-0.710476520822)*x[0]+(0.791512786296)*x[1]**o+(-0.10853188742)*x[1]
        arg[1,2,1,1]=(0.04337234954)*x[0]**o+(0.595650094449)*x[0]+(0.228098665648)*x[1]**o+(-0.868930899722)*x[1]
        arg[1,2,2,0]=(-0.791842482688)*x[0]**o+(-0.611246387621)*x[0]+(0.0504978789412)*x[1]**o+(0.624626300694)*x[1]
        arg[1,2,2,1]=(0.0207375595263)*x[0]**o+(0.560638072838)*x[0]+(0.44126312508)*x[1]**o+(0.169151353084)*x[1]
        arg[1,3,0,0]=(-0.0512069089279)*x[0]**o+(0.51110271913)*x[0]+(0.0785633458626)*x[1]**o+(0.836821453174)*x[1]
        arg[1,3,0,1]=(0.185737468851)*x[0]**o+(0.516071031227)*x[0]+(0.0995388802342)*x[1]**o+(0.25527909092)*x[1]
        arg[1,3,1,0]=(0.318240681435)*x[0]**o+(-0.442725217398)*x[0]+(0.533066616909)*x[1]**o+(0.679570707339)*x[1]
        arg[1,3,1,1]=(0.353367397644)*x[0]**o+(-0.396487189861)*x[0]+(-0.117773711001)*x[1]**o+(0.885897675293)*x[1]
        arg[1,3,2,0]=(-0.647645988694)*x[0]**o+(-0.755258662164)*x[0]+(0.288300257472)*x[1]**o+(0.505342385389)*x[1]
        arg[1,3,2,1]=(0.000781386924262)*x[0]**o+(0.190244787656)*x[0]+(0.589388834071)*x[1]**o+(0.669705413859)*x[1]
        arg[1,4,0,0]=(0.320107896841)*x[0]**o+(0.673508197912)*x[0]+(0.667026895874)*x[1]**o+(-0.818578971562)*x[1]
        arg[1,4,0,1]=(-0.226755915796)*x[0]**o+(0.71800207991)*x[0]+(0.850490212043)*x[1]**o+(0.261708964138)*x[1]
        arg[1,4,1,0]=(-0.0147350282361)*x[0]**o+(0.743889536542)*x[0]+(-0.898802067607)*x[1]**o+(0.711589170571)*x[1]
        arg[1,4,1,1]=(-0.816145493818)*x[0]**o+(0.405931568806)*x[0]+(0.159156576579)*x[1]**o+(0.143576116984)*x[1]
        arg[1,4,2,0]=(0.994791165013)*x[0]**o+(0.65054901122)*x[0]+(0.039218059733)*x[1]**o+(-0.662978657934)*x[1]
        arg[1,4,2,1]=(-0.792277825616)*x[0]**o+(-0.257224872111)*x[0]+(-0.244502392787)*x[1]**o+(-0.276042189495)*x[1]
        arg[2,0,0,0]=(0.133211578016)*x[0]**o+(0.10029141733)*x[0]+(-0.52480547182)*x[1]**o+(0.814652707336)*x[1]
        arg[2,0,0,1]=(0.836429340685)*x[0]**o+(-0.837709322969)*x[0]+(-0.442953015462)*x[1]**o+(-0.984757344044)*x[1]
        arg[2,0,1,0]=(0.893738853578)*x[0]**o+(-0.238050980408)*x[0]+(-0.913668527302)*x[1]**o+(0.895136777323)*x[1]
        arg[2,0,1,1]=(-0.0457361766611)*x[0]**o+(0.414814798208)*x[0]+(-0.57261759439)*x[1]**o+(-0.358969048076)*x[1]
        arg[2,0,2,0]=(-0.320394419991)*x[0]**o+(-0.990129952721)*x[0]+(0.890888895016)*x[1]**o+(0.241063301452)*x[1]
        arg[2,0,2,1]=(-0.604164679932)*x[0]**o+(-0.598939404114)*x[0]+(-0.606633388454)*x[1]**o+(-0.666879580873)*x[1]
        arg[2,1,0,0]=(0.68515547034)*x[0]**o+(0.892247437859)*x[0]+(0.642003383991)*x[1]**o+(0.569240970392)*x[1]
        arg[2,1,0,1]=(0.918713108587)*x[0]**o+(0.865547962284)*x[0]+(0.517952260633)*x[1]**o+(-0.307334010857)*x[1]
        arg[2,1,1,0]=(0.353382468404)*x[0]**o+(-0.542718692644)*x[0]+(-0.957182863451)*x[1]**o+(-0.889352632225)*x[1]
        arg[2,1,1,1]=(0.505185847817)*x[0]**o+(-0.71137143775)*x[0]+(0.853785404375)*x[1]**o+(-0.731028307335)*x[1]
        arg[2,1,2,0]=(-0.0805774093876)*x[0]**o+(0.949831911897)*x[0]+(0.511009248375)*x[1]**o+(-0.0192710206538)*x[1]
        arg[2,1,2,1]=(-0.987709862593)*x[0]**o+(-0.536077508064)*x[0]+(-0.0726882784026)*x[1]**o+(-0.27275457372)*x[1]
        arg[2,2,0,0]=(0.271001953238)*x[0]**o+(0.0446246860776)*x[0]+(0.103657462724)*x[1]**o+(0.359900072694)*x[1]
        arg[2,2,0,1]=(0.613460277623)*x[0]**o+(-0.23324730519)*x[0]+(0.188458167579)*x[1]**o+(-0.574087648909)*x[1]
        arg[2,2,1,0]=(-0.787444207567)*x[0]**o+(0.143772612473)*x[0]+(-0.720451072166)*x[1]**o+(0.936819171338)*x[1]
        arg[2,2,1,1]=(-0.219701379296)*x[0]**o+(-0.343100221149)*x[0]+(-0.972737482064)*x[1]**o+(-0.614208415137)*x[1]
        arg[2,2,2,0]=(0.0292070295438)*x[0]**o+(-0.694263454424)*x[0]+(0.188064440036)*x[1]**o+(0.0901763471697)*x[1]
        arg[2,2,2,1]=(0.407629585245)*x[0]**o+(-0.745619322197)*x[0]+(0.949044983116)*x[1]**o+(-0.316057288128)*x[1]
        arg[2,3,0,0]=(0.124212182643)*x[0]**o+(0.621703244759)*x[0]+(-0.0592136772296)*x[1]**o+(0.571981450786)*x[1]
        arg[2,3,0,1]=(-0.683989210442)*x[0]**o+(-0.318774594157)*x[0]+(0.850235115277)*x[1]**o+(-0.871075179838)*x[1]
        arg[2,3,1,0]=(0.478657634044)*x[0]**o+(-0.43702074673)*x[0]+(0.535572237843)*x[1]**o+(0.22354698199)*x[1]
        arg[2,3,1,1]=(0.0391087869133)*x[0]**o+(0.765140505702)*x[0]+(-0.66279875624)*x[1]**o+(-0.41964006149)*x[1]
        arg[2,3,2,0]=(-0.11123799186)*x[0]**o+(0.533398540082)*x[0]+(-0.931488199925)*x[1]**o+(-0.83080969281)*x[1]
        arg[2,3,2,1]=(-0.138259313941)*x[0]**o+(-0.508937684332)*x[0]+(0.583603445711)*x[1]**o+(-0.0782724872225)*x[1]
        arg[2,4,0,0]=(-0.316223936951)*x[0]**o+(0.329776289164)*x[0]+(-0.692491559115)*x[1]**o+(0.814572730294)*x[1]
        arg[2,4,0,1]=(0.74890960681)*x[0]**o+(-0.79167945549)*x[0]+(0.175328119487)*x[1]**o+(-0.253003240064)*x[1]
        arg[2,4,1,0]=(0.657827625141)*x[0]**o+(-0.268878597055)*x[0]+(0.247374286921)*x[1]**o+(0.414500041415)*x[1]
        arg[2,4,1,1]=(-0.187587046202)*x[0]**o+(-0.594983066039)*x[0]+(-0.203784406879)*x[1]**o+(0.122237566739)*x[1]
        arg[2,4,2,0]=(0.671210794607)*x[0]**o+(0.886706498415)*x[0]+(-0.368997114212)*x[1]**o+(0.0418311781187)*x[1]
        arg[2,4,2,1]=(-0.272424416171)*x[0]**o+(-0.537477247783)*x[0]+(0.0405655834868)*x[1]**o+(-0.179684833703)*x[1]
        arg[3,0,0,0]=(0.457602964193)*x[0]**o+(-0.186625111516)*x[0]+(-0.75244105343)*x[1]**o+(-0.278893445377)*x[1]
        arg[3,0,0,1]=(-0.690378721784)*x[0]**o+(0.0157608350188)*x[0]+(-0.203765434813)*x[1]**o+(0.69771096957)*x[1]
        arg[3,0,1,0]=(-0.884824688493)*x[0]**o+(0.26613451569)*x[0]+(0.226081491639)*x[1]**o+(0.597724298389)*x[1]
        arg[3,0,1,1]=(0.0372124540969)*x[0]**o+(-0.420242551812)*x[0]+(-0.625683613012)*x[1]**o+(0.279682305563)*x[1]
        arg[3,0,2,0]=(-0.570873872458)*x[0]**o+(-0.82361574923)*x[0]+(0.970204188337)*x[1]**o+(-0.242725003569)*x[1]
        arg[3,0,2,1]=(-0.714826095124)*x[0]**o+(-0.334939427182)*x[0]+(-0.730058530908)*x[1]**o+(0.287148154312)*x[1]
        arg[3,1,0,0]=(0.164234307274)*x[0]**o+(-0.388849394356)*x[0]+(0.391518896617)*x[1]**o+(0.00142750126236)*x[1]
        arg[3,1,0,1]=(-0.327700781196)*x[0]**o+(0.0442604682565)*x[0]+(-0.683834466536)*x[1]**o+(-0.665567774985)*x[1]
        arg[3,1,1,0]=(0.135979934041)*x[0]**o+(-0.822614011173)*x[0]+(-0.946061768113)*x[1]**o+(-0.585442102671)*x[1]
        arg[3,1,1,1]=(0.235568769871)*x[0]**o+(0.738233870703)*x[0]+(0.437750339594)*x[1]**o+(-0.44521724321)*x[1]
        arg[3,1,2,0]=(0.449256898185)*x[0]**o+(-0.464211755196)*x[0]+(0.616886411002)*x[1]**o+(0.885500269963)*x[1]
        arg[3,1,2,1]=(0.0851105760559)*x[0]**o+(0.888976499957)*x[0]+(0.0842441111314)*x[1]**o+(-0.366994083394)*x[1]
        arg[3,2,0,0]=(0.77120050858)*x[0]**o+(0.354835584949)*x[0]+(0.406813878866)*x[1]**o+(-0.600042478179)*x[1]
        arg[3,2,0,1]=(-0.747876879184)*x[0]**o+(0.527204926634)*x[0]+(0.134965492713)*x[1]**o+(0.497662739459)*x[1]
        arg[3,2,1,0]=(0.367550591163)*x[0]**o+(-0.700608509353)*x[0]+(0.0737696587931)*x[1]**o+(-0.164466899816)*x[1]
        arg[3,2,1,1]=(0.0908791429433)*x[0]**o+(-0.168468767791)*x[0]+(0.85978873292)*x[1]**o+(-0.785241412884)*x[1]
        arg[3,2,2,0]=(-0.296455818292)*x[0]**o+(-0.0277004420512)*x[0]+(0.409183414933)*x[1]**o+(-0.879831945543)*x[1]
        arg[3,2,2,1]=(0.971512010223)*x[0]**o+(-0.811249982262)*x[0]+(-0.846549204737)*x[1]**o+(0.689986186691)*x[1]
        arg[3,3,0,0]=(-0.800235545702)*x[0]**o+(-0.796021196346)*x[0]+(-0.0660744375539)*x[1]**o+(-0.826632192842)*x[1]
        arg[3,3,0,1]=(0.305678237361)*x[0]**o+(0.203936000462)*x[0]+(-0.583171879217)*x[1]**o+(0.924112859119)*x[1]
        arg[3,3,1,0]=(-0.937148913762)*x[0]**o+(-0.172547991203)*x[0]+(0.928491154238)*x[1]**o+(-0.502876301351)*x[1]
        arg[3,3,1,1]=(0.731413856616)*x[0]**o+(0.837213097155)*x[0]+(-0.650032764358)*x[1]**o+(0.96973961589)*x[1]
        arg[3,3,2,0]=(-0.501994458598)*x[0]**o+(-0.705938508685)*x[0]+(0.664394117366)*x[1]**o+(0.692950029135)*x[1]
        arg[3,3,2,1]=(-0.0948399323409)*x[0]**o+(-0.686744554674)*x[0]+(0.577765681583)*x[1]**o+(0.969310750204)*x[1]
        arg[3,4,0,0]=(-0.484011788432)*x[0]**o+(-0.560744139846)*x[0]+(0.072097608773)*x[1]**o+(-0.103052228904)*x[1]
        arg[3,4,0,1]=(-0.201158934695)*x[0]**o+(0.463105335811)*x[0]+(0.733365706682)*x[1]**o+(-0.330035241794)*x[1]
        arg[3,4,1,0]=(0.252379277102)*x[0]**o+(-0.110596657969)*x[0]+(0.763687257878)*x[1]**o+(-0.345598371263)*x[1]
        arg[3,4,1,1]=(0.0868412855617)*x[0]**o+(0.385098679406)*x[0]+(0.291487288978)*x[1]**o+(-0.112145846209)*x[1]
        arg[3,4,2,0]=(-0.913724685255)*x[0]**o+(-0.0348735884313)*x[0]+(0.550688528861)*x[1]**o+(0.798394152329)*x[1]
        arg[3,4,2,1]=(-0.92870523219)*x[0]**o+(0.177354002469)*x[0]+(0.350393765313)*x[1]**o+(-0.974997198741)*x[1]
        ref[0,0,0,0]=(0.815821053922)/(o+1.)+(0.302879577355)
        ref[0,0,0,1]=(-0.223824520603)/(o+1.)+(0.690659426687)
        ref[0,0,1,0]=(-0.501731412433)/(o+1.)+(0.0102964270565)
        ref[0,0,1,1]=(-0.731540589167)/(o+1.)+(0.348284469462)
        ref[0,0,2,0]=(-0.121523684012)/(o+1.)+(0.184348962759)
        ref[0,0,2,1]=(-0.4529485642)/(o+1.)+(-0.830798233026)
        ref[0,1,0,0]=(-0.244463483906)/(o+1.)+(0.226296188971)
        ref[0,1,0,1]=(1.2203272116)/(o+1.)+(-0.693494218115)
        ref[0,1,1,0]=(-0.55576623697)/(o+1.)+(-0.273623989583)
        ref[0,1,1,1]=(-0.316836585171)/(o+1.)+(-0.836135387777)
        ref[0,1,2,0]=(-0.133732244387)/(o+1.)+(-0.875415201605)
        ref[0,1,2,1]=(-0.281487947177)/(o+1.)+(-0.668499911274)
        ref[0,2,0,0]=(-0.896781862729)/(o+1.)+(-0.0225848820142)
        ref[0,2,0,1]=(-1.70326692867)/(o+1.)+(-0.1693379432)
        ref[0,2,1,0]=(-0.00084798161079)/(o+1.)+(0.343359275275)
        ref[0,2,1,1]=(0.609064372767)/(o+1.)+(-0.369639962727)
        ref[0,2,2,0]=(-0.759042888708)/(o+1.)+(0.321708104548)
        ref[0,2,2,1]=(0.760967724015)/(o+1.)+(0.0268897973234)
        ref[0,3,0,0]=(-1.3915636468)/(o+1.)+(-0.230755462281)
        ref[0,3,0,1]=(-0.416449082748)/(o+1.)+(0.480436529329)
        ref[0,3,1,0]=(-0.238553658798)/(o+1.)+(-0.029283546006)
        ref[0,3,1,1]=(-1.36933302275)/(o+1.)+(-0.221757606321)
        ref[0,3,2,0]=(-0.872999155991)/(o+1.)+(0.69296766968)
        ref[0,3,2,1]=(0.833661507716)/(o+1.)+(0.321357009466)
        ref[0,4,0,0]=(1.4358026373)/(o+1.)+(0.311715942547)
        ref[0,4,0,1]=(-0.00811900044778)/(o+1.)+(-0.76710974695)
        ref[0,4,1,0]=(-0.92034101297)/(o+1.)+(-0.0309623888275)
        ref[0,4,1,1]=(0.690460334263)/(o+1.)+(0.783809038221)
        ref[0,4,2,0]=(0.779851986824)/(o+1.)+(-0.214799981386)
        ref[0,4,2,1]=(-0.566157259598)/(o+1.)+(0.296555712092)
        ref[1,0,0,0]=(-1.70267943485)/(o+1.)+(0.0444622873215)
        ref[1,0,0,1]=(0.399342875087)/(o+1.)+(0.0341080904363)
        ref[1,0,1,0]=(0.839377637409)/(o+1.)+(0.158619241351)
        ref[1,0,1,1]=(-0.0142823080176)/(o+1.)+(0.693714763021)
        ref[1,0,2,0]=(-0.97036633864)/(o+1.)+(0.264110057567)
        ref[1,0,2,1]=(0.104223436728)/(o+1.)+(0.328785142295)
        ref[1,1,0,0]=(1.09779156365)/(o+1.)+(-0.00408578628855)
        ref[1,1,0,1]=(-0.914750679597)/(o+1.)+(0.206573942886)
        ref[1,1,1,0]=(0.150419426085)/(o+1.)+(-0.0846024372156)
        ref[1,1,1,1]=(-1.04733819847)/(o+1.)+(-0.157756242641)
        ref[1,1,2,0]=(-1.49193735459)/(o+1.)+(0.391723285192)
        ref[1,1,2,1]=(-0.250600389657)/(o+1.)+(-0.456841431612)
        ref[1,2,0,0]=(1.21154796884)/(o+1.)+(-0.377275533205)
        ref[1,2,0,1]=(-0.785475967917)/(o+1.)+(0.2413362399)
        ref[1,2,1,0]=(1.20750352255)/(o+1.)+(-0.409504204121)
        ref[1,2,1,1]=(0.271471015188)/(o+1.)+(-0.136640402636)
        ref[1,2,2,0]=(-0.741344603747)/(o+1.)+(0.00668995653618)
        ref[1,2,2,1]=(0.462000684606)/(o+1.)+(0.364894712961)
        ref[1,3,0,0]=(0.0273564369347)/(o+1.)+(0.673962086152)
        ref[1,3,0,1]=(0.285276349085)/(o+1.)+(0.385675061073)
        ref[1,3,1,0]=(0.851307298344)/(o+1.)+(0.118422744971)
        ref[1,3,1,1]=(0.235593686643)/(o+1.)+(0.244705242716)
        ref[1,3,2,0]=(-0.359345731222)/(o+1.)+(-0.124958138388)
        ref[1,3,2,1]=(0.590170220995)/(o+1.)+(0.429975100757)
        ref[1,4,0,0]=(0.987134792715)/(o+1.)+(-0.0725353868253)
        ref[1,4,0,1]=(0.623734296247)/(o+1.)+(0.489855522024)
        ref[1,4,1,0]=(-0.913537095843)/(o+1.)+(0.727739353556)
        ref[1,4,1,1]=(-0.656988917238)/(o+1.)+(0.274753842895)
        ref[1,4,2,0]=(1.03400922475)/(o+1.)+(-0.00621482335664)
        ref[1,4,2,1]=(-1.0367802184)/(o+1.)+(-0.266633530803)
        ref[2,0,0,0]=(-0.391593893803)/(o+1.)+(0.457472062333)
        ref[2,0,0,1]=(0.393476325223)/(o+1.)+(-0.911233333506)
        ref[2,0,1,0]=(-0.0199296737245)/(o+1.)+(0.328542898457)
        ref[2,0,1,1]=(-0.618353771051)/(o+1.)+(0.0279228750664)
        ref[2,0,2,0]=(0.570494475025)/(o+1.)+(-0.374533325635)
        ref[2,0,2,1]=(-1.21079806839)/(o+1.)+(-0.632909492494)
        ref[2,1,0,0]=(1.32715885433)/(o+1.)+(0.730744204126)
        ref[2,1,0,1]=(1.43666536922)/(o+1.)+(0.279106975714)
        ref[2,1,1,0]=(-0.603800395047)/(o+1.)+(-0.716035662434)
        ref[2,1,1,1]=(1.35897125219)/(o+1.)+(-0.721199872542)
        ref[2,1,2,0]=(0.430431838988)/(o+1.)+(0.465280445622)
        ref[2,1,2,1]=(-1.060398141)/(o+1.)+(-0.404416040892)
        ref[2,2,0,0]=(0.374659415961)/(o+1.)+(0.202262379386)
        ref[2,2,0,1]=(0.801918445202)/(o+1.)+(-0.403667477049)
        ref[2,2,1,0]=(-1.50789527973)/(o+1.)+(0.540295891905)
        ref[2,2,1,1]=(-1.19243886136)/(o+1.)+(-0.478654318143)
        ref[2,2,2,0]=(0.21727146958)/(o+1.)+(-0.302043553627)
        ref[2,2,2,1]=(1.35667456836)/(o+1.)+(-0.530838305162)
        ref[2,3,0,0]=(0.0649985054133)/(o+1.)+(0.596842347772)
        ref[2,3,0,1]=(0.166245904835)/(o+1.)+(-0.594924886997)
        ref[2,3,1,0]=(1.01422987189)/(o+1.)+(-0.10673688237)
        ref[2,3,1,1]=(-0.623689969327)/(o+1.)+(0.172750222106)
        ref[2,3,2,0]=(-1.04272619178)/(o+1.)+(-0.148705576364)
        ref[2,3,2,1]=(0.445344131771)/(o+1.)+(-0.293605085777)
        ref[2,4,0,0]=(-1.00871549607)/(o+1.)+(0.572174509729)
        ref[2,4,0,1]=(0.924237726297)/(o+1.)+(-0.522341347777)
        ref[2,4,1,0]=(0.905201912063)/(o+1.)+(0.0728107221801)
        ref[2,4,1,1]=(-0.391371453081)/(o+1.)+(-0.23637274965)
        ref[2,4,2,0]=(0.302213680395)/(o+1.)+(0.464268838267)
        ref[2,4,2,1]=(-0.231858832685)/(o+1.)+(-0.358581040743)
        ref[3,0,0,0]=(-0.294838089237)/(o+1.)+(-0.232759278447)
        ref[3,0,0,1]=(-0.894144156597)/(o+1.)+(0.356735902294)
        ref[3,0,1,0]=(-0.658743196854)/(o+1.)+(0.43192940704)
        ref[3,0,1,1]=(-0.588471158915)/(o+1.)+(-0.0702801231243)
        ref[3,0,2,0]=(0.399330315879)/(o+1.)+(-0.5331703764)
        ref[3,0,2,1]=(-1.44488462603)/(o+1.)+(-0.0238956364351)
        ref[3,1,0,0]=(0.555753203891)/(o+1.)+(-0.193710946547)
        ref[3,1,0,1]=(-1.01153524773)/(o+1.)+(-0.310653653364)
        ref[3,1,1,0]=(-0.810081834072)/(o+1.)+(-0.704028056922)
        ref[3,1,1,1]=(0.673319109465)/(o+1.)+(0.146508313746)
        ref[3,1,2,0]=(1.06614330919)/(o+1.)+(0.210644257384)
        ref[3,1,2,1]=(0.169354687187)/(o+1.)+(0.260991208281)
        ref[3,2,0,0]=(1.17801438745)/(o+1.)+(-0.122603446615)
        ref[3,2,0,1]=(-0.612911386471)/(o+1.)+(0.512433833047)
        ref[3,2,1,0]=(0.441320249956)/(o+1.)+(-0.432537704584)
        ref[3,2,1,1]=(0.950667875863)/(o+1.)+(-0.476855090338)
        ref[3,2,2,0]=(0.112727596641)/(o+1.)+(-0.453766193797)
        ref[3,2,2,1]=(0.124962805486)/(o+1.)+(-0.0606318977858)
        ref[3,3,0,0]=(-0.866309983256)/(o+1.)+(-0.811326694594)
        ref[3,3,0,1]=(-0.277493641857)/(o+1.)+(0.564024429791)
        ref[3,3,1,0]=(-0.00865775952435)/(o+1.)+(-0.337712146277)
        ref[3,3,1,1]=(0.0813810922576)/(o+1.)+(0.903476356523)
        ref[3,3,2,0]=(0.162399658768)/(o+1.)+(-0.00649423977499)
        ref[3,3,2,1]=(0.482925749243)/(o+1.)+(0.141283097765)
        ref[3,4,0,0]=(-0.411914179659)/(o+1.)+(-0.331898184375)
        ref[3,4,0,1]=(0.532206771987)/(o+1.)+(0.0665350470083)
        ref[3,4,1,0]=(1.01606653498)/(o+1.)+(-0.228097514616)
        ref[3,4,1,1]=(0.37832857454)/(o+1.)+(0.136476416599)
        ref[3,4,2,0]=(-0.363036156393)/(o+1.)+(0.381760281949)
        ref[3,4,2,1]=(-0.578311466877)/(o+1.)+(-0.398821598136)
      else:
        arg[0,0,0,0]=(0.860676142569)*x[0]**o+(-0.156046991162)*x[0]+(-0.0462355579656)*x[1]**o+(0.70842844961)*x[1]+(0.617299123548)*x[2]**o+(-0.865174329565)*x[2]
        arg[0,0,0,1]=(-0.284308060865)*x[0]**o+(0.788848579389)*x[0]+(0.629321669042)*x[1]**o+(0.066637849809)*x[1]+(0.114152381009)*x[2]**o+(-0.466687745846)*x[2]
        arg[0,0,1,0]=(-0.690823198517)*x[0]**o+(-0.141510804573)*x[0]+(0.969978831967)*x[1]**o+(0.307926382658)*x[1]+(0.710373009094)*x[2]**o+(-0.494828315907)*x[2]
        arg[0,0,1,1]=(0.953361413913)*x[0]**o+(-0.103742611936)*x[0]+(0.63934955554)*x[1]**o+(-0.0778114476564)*x[1]+(-0.221185122698)*x[2]**o+(-0.287432047404)*x[2]
        arg[0,0,2,0]=(0.378306380558)*x[0]**o+(-0.117743922672)*x[0]+(-0.0606376630208)*x[1]**o+(-0.59439189505)*x[1]+(0.10507320657)*x[2]**o+(0.856411423067)*x[2]
        arg[0,0,2,1]=(0.777734672779)*x[0]**o+(0.286956002007)*x[0]+(-0.931811626583)*x[1]**o+(-0.806626659661)*x[1]+(-0.420390949282)*x[2]**o+(0.854080006578)*x[2]
        arg[0,1,0,0]=(0.403426948964)*x[0]**o+(0.707099419296)*x[0]+(0.593137130456)*x[1]**o+(-0.757560771598)*x[1]+(0.369632217934)*x[2]**o+(-0.348480285397)*x[2]
        arg[0,1,0,1]=(-0.491454189782)*x[0]**o+(0.547276640565)*x[0]+(-0.955045542708)*x[1]**o+(0.529989872531)*x[1]+(-0.161086874799)*x[2]**o+(-0.181810040724)*x[2]
        arg[0,1,1,0]=(0.46282177104)*x[0]**o+(0.254346937251)*x[0]+(0.824797105546)*x[1]**o+(-0.449979162246)*x[1]+(0.22307703071)*x[2]**o+(-0.592072135668)*x[2]
        arg[0,1,1,1]=(0.329230675141)*x[0]**o+(-0.733034697145)*x[0]+(0.762195609347)*x[1]**o+(-0.639097591362)*x[1]+(0.765354927905)*x[2]**o+(0.313571493405)*x[2]
        arg[0,1,2,0]=(0.3874127072)*x[0]**o+(-0.0569429727569)*x[0]+(-0.203121198708)*x[1]**o+(-0.736379499164)*x[1]+(-0.980629375436)*x[2]**o+(0.955793660048)*x[2]
        arg[0,1,2,1]=(-0.656255469455)*x[0]**o+(0.711904808699)*x[0]+(-0.363253678399)*x[1]**o+(0.921875000807)*x[1]+(0.686394816431)*x[2]**o+(0.818500716704)*x[2]
        arg[0,2,0,0]=(-0.931555347846)*x[0]**o+(-0.249573400742)*x[0]+(0.617166716404)*x[1]**o+(-0.929587051108)*x[1]+(0.830928715064)*x[2]**o+(0.461637431613)*x[2]
        arg[0,2,0,1]=(-0.8677719945)*x[0]**o+(-0.176892180445)*x[0]+(-0.881887456464)*x[1]**o+(0.923355677513)*x[1]+(-0.978544668453)*x[2]**o+(-0.427009384287)*x[2]
        arg[0,2,1,0]=(-0.0707937433084)*x[0]**o+(-0.872892141393)*x[0]+(0.606234798381)*x[1]**o+(0.935845076847)*x[1]+(-0.97559052201)*x[2]**o+(-0.31138518209)*x[2]
        arg[0,2,1,1]=(0.450210597865)*x[0]**o+(0.842939440378)*x[0]+(-0.333422856577)*x[1]**o+(-0.492809679443)*x[1]+(-0.254728278043)*x[2]**o+(-0.0702767077952)*x[2]
        arg[0,2,2,0]=(-0.250463216903)*x[0]**o+(0.756576293763)*x[0]+(0.596902629953)*x[1]**o+(-0.887080794947)*x[1]+(0.027319948008)*x[2]**o+(0.552496782776)*x[2]
        arg[0,2,2,1]=(-0.0883102140591)*x[0]**o+(0.988759610101)*x[0]+(-0.208152392508)*x[1]**o+(0.938999108564)*x[1]+(-0.773883611417)*x[2]**o+(0.653413306338)*x[2]
        arg[0,3,0,0]=(-0.399644211606)*x[0]**o+(-0.978595776407)*x[0]+(0.99454650986)*x[1]**o+(0.143313668715)*x[1]+(0.328592750842)*x[2]**o+(-0.958804581101)*x[2]
        arg[0,3,0,1]=(-0.0667966885959)*x[0]**o+(0.332653574704)*x[0]+(-0.762025150916)*x[1]**o+(0.895044013374)*x[1]+(0.627013843362)*x[2]**o+(-0.682392672232)*x[2]
        arg[0,3,1,0]=(-0.834479453773)*x[0]**o+(-0.375930859033)*x[0]+(0.129507966861)*x[1]**o+(0.995364280408)*x[1]+(-0.126081191572)*x[2]**o+(0.0344262779491)*x[2]
        arg[0,3,1,1]=(0.796952126596)*x[0]**o+(0.310562243091)*x[0]+(0.854548623788)*x[1]**o+(-0.719100537284)*x[1]+(-0.236266783438)*x[2]**o+(-0.646647129209)*x[2]
        arg[0,3,2,0]=(0.844073289115)*x[0]**o+(0.423300345347)*x[0]+(0.126354796852)*x[1]**o+(0.180372257606)*x[1]+(-0.564712722146)*x[2]**o+(0.466988430183)*x[2]
        arg[0,3,2,1]=(0.228775824367)*x[0]**o+(0.40701094831)*x[0]+(0.223101054593)*x[1]**o+(-0.894937905383)*x[1]+(0.425392942773)*x[2]**o+(-0.844238667169)*x[2]
        arg[0,4,0,0]=(0.3363848738)*x[0]**o+(-0.985327066062)*x[0]+(-0.107847971678)*x[1]**o+(0.596121801488)*x[1]+(0.655589801663)*x[2]**o+(-0.729650731949)*x[2]
        arg[0,4,0,1]=(-0.176435679219)*x[0]**o+(0.382558711725)*x[0]+(-0.658212492337)*x[1]**o+(0.584904267612)*x[1]+(-0.534684876705)*x[2]**o+(-0.441262614915)*x[2]
        arg[0,4,1,0]=(0.281301737167)*x[0]**o+(-0.642486274791)*x[0]+(0.420753884869)*x[1]**o+(0.482835955591)*x[1]+(0.169431333788)*x[2]**o+(0.922841193825)*x[2]
        arg[0,4,1,1]=(0.235812590604)*x[0]**o+(-0.446233855396)*x[0]+(0.465015868566)*x[1]**o+(-0.780441276888)*x[1]+(0.513632761351)*x[2]**o+(-0.0576482811678)*x[2]
        arg[0,4,2,0]=(-0.617245874462)*x[0]**o+(0.183661473466)*x[0]+(-0.711148911239)*x[1]**o+(0.125228991306)*x[1]+(-0.500218603959)*x[2]**o+(0.70597577229)*x[2]
        arg[0,4,2,1]=(0.56330304117)*x[0]**o+(0.631284986628)*x[0]+(-0.222485175776)*x[1]**o+(0.0639235737228)*x[1]+(-0.276613868747)*x[2]**o+(0.407488564857)*x[2]
        arg[1,0,0,0]=(0.159032146915)*x[0]**o+(-0.716040989693)*x[0]+(0.410709172613)*x[1]**o+(-0.527667963652)*x[1]+(-0.160515156497)*x[2]**o+(0.294448742382)*x[2]
        arg[1,0,0,1]=(0.941139035835)*x[0]**o+(0.707410046094)*x[0]+(-0.172095410803)*x[1]**o+(-0.967035204304)*x[1]+(0.870395272646)*x[2]**o+(0.830870986802)*x[2]
        arg[1,0,1,0]=(0.731015285309)*x[0]**o+(0.450519048697)*x[0]+(-0.484568714675)*x[1]**o+(0.454201220108)*x[1]+(-0.161850459099)*x[2]**o+(-0.617463263396)*x[2]
        arg[1,0,1,1]=(-0.958841628847)*x[0]**o+(-0.0667813400021)*x[0]+(0.659551780082)*x[1]**o+(0.514424015304)*x[1]+(0.920583608125)*x[2]**o+(0.89564899572)*x[2]
        arg[1,0,2,0]=(0.0482630479817)*x[0]**o+(0.911326064322)*x[0]+(-0.275134422092)*x[1]**o+(0.216495232459)*x[1]+(-0.973586171195)*x[2]**o+(0.275694688611)*x[2]
        arg[1,0,2,1]=(0.769733688293)*x[0]**o+(0.771829018421)*x[0]+(-0.22434549079)*x[1]**o+(0.131966885817)*x[1]+(-0.109424705679)*x[2]**o+(-0.369585136379)*x[2]
        arg[1,1,0,0]=(-0.0160180905877)*x[0]**o+(-0.268260755267)*x[0]+(-0.213940412022)*x[1]**o+(0.665987805279)*x[1]+(0.968879828017)*x[2]**o+(-0.449435538913)*x[2]
        arg[1,1,0,1]=(0.361055351825)*x[0]**o+(0.463294478488)*x[0]+(0.692655668486)*x[1]**o+(0.151415573206)*x[1]+(0.902280461515)*x[2]**o+(0.690926934073)*x[2]
        arg[1,1,1,0]=(0.591998602299)*x[0]**o+(0.516482177709)*x[0]+(-0.298511909182)*x[1]**o+(0.281818071894)*x[1]+(0.207089953979)*x[2]**o+(0.917004722388)*x[2]
        arg[1,1,1,1]=(0.479832408236)*x[0]**o+(-0.643374914165)*x[0]+(0.370844835249)*x[1]**o+(0.560458499239)*x[1]+(-0.865852319767)*x[2]**o+(0.560572130123)*x[2]
        arg[1,1,2,0]=(0.709293526635)*x[0]**o+(-0.388347223155)*x[0]+(0.60797330273)*x[1]**o+(-0.847624783099)*x[1]+(-0.0476367756382)*x[2]**o+(0.637841988478)*x[2]
        arg[1,1,2,1]=(0.343458045422)*x[0]**o+(-0.764451449587)*x[0]+(-0.444256801761)*x[1]**o+(0.385385997921)*x[1]+(-0.722095136671)*x[2]**o+(0.677852473207)*x[2]
        arg[1,2,0,0]=(0.710372887392)*x[0]**o+(-0.628494679119)*x[0]+(-0.59513507905)*x[1]**o+(-0.527824874295)*x[1]+(-0.611189170789)*x[2]**o+(0.090651976806)*x[2]
        arg[1,2,0,1]=(-0.980160150289)*x[0]**o+(-0.0286097581598)*x[0]+(-0.407906975953)*x[1]**o+(-0.319422835951)*x[1]+(-0.489787310147)*x[2]**o+(-0.694386341354)*x[2]
        arg[1,2,1,0]=(-0.416867224376)*x[0]**o+(0.631406877489)*x[0]+(-0.93939195942)*x[1]**o+(0.266858600313)*x[1]+(0.982173221612)*x[2]**o+(0.112901364617)*x[2]
        arg[1,2,1,1]=(0.412001480348)*x[0]**o+(0.624281489887)*x[0]+(0.306558457751)*x[1]**o+(0.95864454419)*x[1]+(0.299175627954)*x[2]**o+(-0.0531991017347)*x[2]
        arg[1,2,2,0]=(-0.0342261621741)*x[0]**o+(-0.587245704486)*x[0]+(-0.976407464107)*x[1]**o+(-0.0157215030322)*x[1]+(-0.529857472095)*x[2]**o+(-0.419626697673)*x[2]
        arg[1,2,2,1]=(-0.681737301037)*x[0]**o+(-0.980349460702)*x[0]+(-0.839469631393)*x[1]**o+(-0.412417814907)*x[1]+(0.451717398947)*x[2]**o+(0.962167685987)*x[2]
        arg[1,3,0,0]=(0.283453965913)*x[0]**o+(0.204445403787)*x[0]+(-0.806150376236)*x[1]**o+(0.122187094069)*x[1]+(-0.679291367964)*x[2]**o+(-0.875353966489)*x[2]
        arg[1,3,0,1]=(0.115974475175)*x[0]**o+(0.701473497654)*x[0]+(0.298012120304)*x[1]**o+(0.567597901709)*x[1]+(0.721211831476)*x[2]**o+(-0.255389572775)*x[2]
        arg[1,3,1,0]=(0.393891431092)*x[0]**o+(-0.563382537925)*x[0]+(0.974194829106)*x[1]**o+(0.659688559688)*x[1]+(-0.394266143828)*x[2]**o+(0.875266200191)*x[2]
        arg[1,3,1,1]=(-0.456930975697)*x[0]**o+(0.334590626231)*x[0]+(-0.227176883362)*x[1]**o+(0.76775699173)*x[1]+(0.839371167887)*x[2]**o+(-0.155473916326)*x[2]
        arg[1,3,2,0]=(0.346761981787)*x[0]**o+(-0.625121706322)*x[0]+(0.340655154638)*x[1]**o+(-0.0646323546999)*x[1]+(-0.211347402677)*x[2]**o+(0.233661266919)*x[2]
        arg[1,3,2,1]=(-0.086096644956)*x[0]**o+(-0.845623653209)*x[0]+(-0.0866093549957)*x[1]**o+(-0.467286349011)*x[1]+(-0.0621455515357)*x[2]**o+(0.164779979085)*x[2]
        arg[1,4,0,0]=(0.42022138208)*x[0]**o+(0.136984451355)*x[0]+(0.664770979086)*x[1]**o+(-0.537368896193)*x[1]+(0.874256726691)*x[2]**o+(-0.58614100824)*x[2]
        arg[1,4,0,1]=(-0.805860964792)*x[0]**o+(0.758511304044)*x[0]+(-0.574686863541)*x[1]**o+(-0.410873101247)*x[1]+(0.932015171551)*x[2]**o+(0.439987195351)*x[2]
        arg[1,4,1,0]=(-0.515187049123)*x[0]**o+(0.308078404334)*x[0]+(0.940959771774)*x[1]**o+(0.466269579691)*x[1]+(-0.190617144843)*x[2]**o+(0.738172533582)*x[2]
        arg[1,4,1,1]=(0.283326036586)*x[0]**o+(-0.693631747857)*x[0]+(0.478965080319)*x[1]**o+(-0.0465389396775)*x[1]+(-0.72886286959)*x[2]**o+(-0.9346424149)*x[2]
        arg[1,4,2,0]=(-0.71539766285)*x[0]**o+(0.361875987071)*x[0]+(0.905270678876)*x[1]**o+(-0.675024725702)*x[1]+(0.378259473658)*x[2]**o+(0.0520394226711)*x[2]
        arg[1,4,2,1]=(-0.319600525923)*x[0]**o+(0.0449956327134)*x[0]+(0.707418658521)*x[1]**o+(0.210137972776)*x[1]+(-0.767860728688)*x[2]**o+(0.232340825758)*x[2]
        arg[2,0,0,0]=(0.92844243651)*x[0]**o+(0.956810319504)*x[0]+(0.762198571194)*x[1]**o+(-0.363107634629)*x[1]+(0.0750393505254)*x[2]**o+(-0.43573581041)*x[2]
        arg[2,0,0,1]=(-0.193613121742)*x[0]**o+(0.440027871839)*x[0]+(-0.607905506346)*x[1]**o+(0.894840354958)*x[1]+(0.601279436178)*x[2]**o+(0.46806560762)*x[2]
        arg[2,0,1,0]=(0.370901517567)*x[0]**o+(-0.738769905647)*x[0]+(-0.698692979664)*x[1]**o+(-0.286318840335)*x[1]+(-0.879367315688)*x[2]**o+(-0.959912132991)*x[2]
        arg[2,0,1,1]=(-0.278939533774)*x[0]**o+(0.183795552426)*x[0]+(-0.341943551466)*x[1]**o+(0.491847260291)*x[1]+(-0.141030429384)*x[2]**o+(0.256287855539)*x[2]
        arg[2,0,2,0]=(-0.135930357616)*x[0]**o+(-0.382515749949)*x[0]+(-0.43030873581)*x[1]**o+(-0.0211891159981)*x[1]+(-0.377865120002)*x[2]**o+(0.109942325029)*x[2]
        arg[2,0,2,1]=(0.288827267201)*x[0]**o+(-0.907970544468)*x[0]+(-0.622258309213)*x[1]**o+(-0.763273879894)*x[1]+(0.438715013671)*x[2]**o+(-0.93873140988)*x[2]
        arg[2,1,0,0]=(-0.963487369906)*x[0]**o+(0.899051290288)*x[0]+(-0.268257956548)*x[1]**o+(-0.229092726584)*x[1]+(0.427024112314)*x[2]**o+(0.0435138095138)*x[2]
        arg[2,1,0,1]=(0.89996926597)*x[0]**o+(-0.206500706229)*x[0]+(-0.191769123095)*x[1]**o+(-0.348924155298)*x[1]+(-0.74405653776)*x[2]**o+(0.0724946691864)*x[2]
        arg[2,1,1,0]=(0.338170397901)*x[0]**o+(-0.725761081242)*x[0]+(-0.45928272676)*x[1]**o+(0.795535326783)*x[1]+(-0.316443844644)*x[2]**o+(-0.844205401892)*x[2]
        arg[2,1,1,1]=(0.509131757681)*x[0]**o+(0.319175801535)*x[0]+(-0.807058926279)*x[1]**o+(0.63928269996)*x[1]+(0.219324073432)*x[2]**o+(0.351217517434)*x[2]
        arg[2,1,2,0]=(-0.534090721611)*x[0]**o+(0.27146424294)*x[0]+(0.250778065716)*x[1]**o+(-0.901322994167)*x[1]+(-0.57588768699)*x[2]**o+(0.405043003456)*x[2]
        arg[2,1,2,1]=(0.101699906269)*x[0]**o+(0.361960318738)*x[0]+(0.278974923593)*x[1]**o+(-0.336289352037)*x[1]+(-0.677353936215)*x[2]**o+(0.0726793347753)*x[2]
        arg[2,2,0,0]=(-0.734961283823)*x[0]**o+(-0.593268557578)*x[0]+(0.310896858565)*x[1]**o+(-0.482326137951)*x[1]+(0.886472957099)*x[2]**o+(-0.0403563476581)*x[2]
        arg[2,2,0,1]=(-0.166071725106)*x[0]**o+(-0.454245686818)*x[0]+(-0.892674508991)*x[1]**o+(0.581554190251)*x[1]+(0.995323654908)*x[2]**o+(-0.0336714433349)*x[2]
        arg[2,2,1,0]=(-0.437491848099)*x[0]**o+(-0.195039508213)*x[0]+(0.822011086215)*x[1]**o+(0.771044412863)*x[1]+(0.697534261252)*x[2]**o+(0.666510217725)*x[2]
        arg[2,2,1,1]=(-0.529148276275)*x[0]**o+(-0.093016460024)*x[0]+(0.663641010649)*x[1]**o+(0.940439359843)*x[1]+(0.754151159716)*x[2]**o+(0.852349310591)*x[2]
        arg[2,2,2,0]=(0.859523244682)*x[0]**o+(0.704825125128)*x[0]+(0.221832129598)*x[1]**o+(0.573940020456)*x[1]+(0.935673751591)*x[2]**o+(0.23235170475)*x[2]
        arg[2,2,2,1]=(0.0359047473512)*x[0]**o+(0.836816935443)*x[0]+(0.6411608273)*x[1]**o+(0.291526953908)*x[1]+(0.735564515362)*x[2]**o+(-0.465781621769)*x[2]
        arg[2,3,0,0]=(0.352740040216)*x[0]**o+(0.54224020581)*x[0]+(0.681356174115)*x[1]**o+(-0.97589117869)*x[1]+(0.880755719884)*x[2]**o+(0.562259403362)*x[2]
        arg[2,3,0,1]=(0.563708471054)*x[0]**o+(0.525523219723)*x[0]+(0.423068360374)*x[1]**o+(0.29239160821)*x[1]+(0.874360368885)*x[2]**o+(0.922265851359)*x[2]
        arg[2,3,1,0]=(0.694309936305)*x[0]**o+(-0.409224769672)*x[0]+(-0.748835864803)*x[1]**o+(-0.21841534641)*x[1]+(0.497059735624)*x[2]**o+(-0.753234694148)*x[2]
        arg[2,3,1,1]=(0.109706510352)*x[0]**o+(-0.0160720403678)*x[0]+(0.888778080744)*x[1]**o+(-0.938692716268)*x[1]+(0.529262951478)*x[2]**o+(0.481430680214)*x[2]
        arg[2,3,2,0]=(0.65368659132)*x[0]**o+(-0.988176396392)*x[0]+(0.989546739333)*x[1]**o+(0.23178715846)*x[1]+(-0.557645438328)*x[2]**o+(0.063228513147)*x[2]
        arg[2,3,2,1]=(0.286316141831)*x[0]**o+(0.668138463424)*x[0]+(-0.950430671533)*x[1]**o+(-0.978012107187)*x[1]+(-0.107618382464)*x[2]**o+(-0.684084421276)*x[2]
        arg[2,4,0,0]=(-0.63510659432)*x[0]**o+(0.264242935995)*x[0]+(0.960647241624)*x[1]**o+(0.58483379289)*x[1]+(0.7255270271)*x[2]**o+(-0.476151653985)*x[2]
        arg[2,4,0,1]=(-0.221953908705)*x[0]**o+(-0.994143786509)*x[0]+(-0.359525421944)*x[1]**o+(0.533966197668)*x[1]+(-0.29739666047)*x[2]**o+(-0.0824204124466)*x[2]
        arg[2,4,1,0]=(-0.447043625871)*x[0]**o+(-0.904485300564)*x[0]+(0.26179071803)*x[1]**o+(0.437320719437)*x[1]+(-0.56501466909)*x[2]**o+(0.129662379166)*x[2]
        arg[2,4,1,1]=(0.259809756366)*x[0]**o+(0.446788808701)*x[0]+(-0.143702396023)*x[1]**o+(0.879531090832)*x[1]+(0.410047703156)*x[2]**o+(0.755750006468)*x[2]
        arg[2,4,2,0]=(-0.730881615951)*x[0]**o+(-0.357110792705)*x[0]+(0.552722654621)*x[1]**o+(0.965623848242)*x[1]+(0.555951256049)*x[2]**o+(0.259021370764)*x[2]
        arg[2,4,2,1]=(-0.465880467377)*x[0]**o+(-0.840984822217)*x[0]+(0.665817382039)*x[1]**o+(-0.390932961529)*x[1]+(-0.0857939888315)*x[2]**o+(-0.712185917672)*x[2]
        arg[3,0,0,0]=(0.710281429223)*x[0]**o+(-0.723903639057)*x[0]+(-0.267455509065)*x[1]**o+(-0.731684188612)*x[1]+(-0.287442751768)*x[2]**o+(-0.266871749947)*x[2]
        arg[3,0,0,1]=(0.460723870663)*x[0]**o+(0.0502154310124)*x[0]+(-0.260241363193)*x[1]**o+(-0.516473088648)*x[1]+(-0.925984113039)*x[2]**o+(-0.0297616649018)*x[2]
        arg[3,0,1,0]=(0.523186648278)*x[0]**o+(0.937042293367)*x[0]+(0.811740916657)*x[1]**o+(0.0544805175015)*x[1]+(-0.543484279955)*x[2]**o+(0.244714198306)*x[2]
        arg[3,0,1,1]=(-0.69212630167)*x[0]**o+(0.868708276385)*x[0]+(0.473290025811)*x[1]**o+(0.137043602294)*x[1]+(-0.19291314113)*x[2]**o+(-0.755147036188)*x[2]
        arg[3,0,2,0]=(0.0472638421122)*x[0]**o+(0.403135551064)*x[0]+(0.290083188289)*x[1]**o+(0.96419060449)*x[1]+(-0.240544184077)*x[2]**o+(-0.183028108529)*x[2]
        arg[3,0,2,1]=(0.354253383908)*x[0]**o+(0.628816528774)*x[0]+(0.588194429756)*x[1]**o+(-0.852128734457)*x[1]+(-0.84774778925)*x[2]**o+(0.796310123562)*x[2]
        arg[3,1,0,0]=(0.528880495806)*x[0]**o+(-0.74176589205)*x[0]+(-0.447816938371)*x[1]**o+(0.611297564802)*x[1]+(0.742134198482)*x[2]**o+(-0.625840664202)*x[2]
        arg[3,1,0,1]=(0.419633746259)*x[0]**o+(-0.247742274578)*x[0]+(0.302328885303)*x[1]**o+(-0.629854480502)*x[1]+(0.493919301288)*x[2]**o+(0.902910119017)*x[2]
        arg[3,1,1,0]=(0.509160481656)*x[0]**o+(-0.388129364133)*x[0]+(-0.595185230598)*x[1]**o+(-0.289592836865)*x[1]+(0.615663908134)*x[2]**o+(-0.560687711511)*x[2]
        arg[3,1,1,1]=(0.647782473568)*x[0]**o+(0.935840881725)*x[0]+(0.440348212287)*x[1]**o+(-0.489797988572)*x[1]+(0.766592631787)*x[2]**o+(0.217399649246)*x[2]
        arg[3,1,2,0]=(0.64944026906)*x[0]**o+(0.487409918475)*x[0]+(-0.0322210593784)*x[1]**o+(0.281311337861)*x[1]+(-0.694252407571)*x[2]**o+(-0.659678386121)*x[2]
        arg[3,1,2,1]=(0.806357278285)*x[0]**o+(0.419430374567)*x[0]+(-0.0525796600116)*x[1]**o+(-0.556886341914)*x[1]+(-0.288209814683)*x[2]**o+(-0.309696771495)*x[2]
        arg[3,2,0,0]=(-0.300806388527)*x[0]**o+(-0.39334416908)*x[0]+(0.000711617540648)*x[1]**o+(-0.618539958736)*x[1]+(0.0574098223152)*x[2]**o+(-0.351595384168)*x[2]
        arg[3,2,0,1]=(-0.898675793892)*x[0]**o+(0.904479958277)*x[0]+(0.0781945046018)*x[1]**o+(-0.0461053392586)*x[1]+(0.844798127031)*x[2]**o+(-0.82306838709)*x[2]
        arg[3,2,1,0]=(-0.268742335093)*x[0]**o+(-0.532639944208)*x[0]+(0.0101227109551)*x[1]**o+(-0.438312865518)*x[1]+(0.104288648246)*x[2]**o+(-0.115669027311)*x[2]
        arg[3,2,1,1]=(0.639871308792)*x[0]**o+(0.260847628514)*x[0]+(-0.455670719167)*x[1]**o+(0.210619035618)*x[1]+(-0.401809068119)*x[2]**o+(-0.0625194517026)*x[2]
        arg[3,2,2,0]=(-0.713684223829)*x[0]**o+(0.214281604766)*x[0]+(-0.60152592324)*x[1]**o+(0.249807228316)*x[1]+(-0.939395078261)*x[2]**o+(-0.519744396388)*x[2]
        arg[3,2,2,1]=(-0.340588993443)*x[0]**o+(-0.0165543854997)*x[0]+(-0.366479789338)*x[1]**o+(0.316347630987)*x[1]+(-0.457055798679)*x[2]**o+(-0.132368055553)*x[2]
        arg[3,3,0,0]=(-0.745211736715)*x[0]**o+(0.0106787556884)*x[0]+(-0.448180943446)*x[1]**o+(0.694982281891)*x[1]+(0.924431258221)*x[2]**o+(-0.841633806168)*x[2]
        arg[3,3,0,1]=(0.368054364362)*x[0]**o+(0.19288251992)*x[0]+(0.565854068035)*x[1]**o+(0.747534544754)*x[1]+(0.473165789569)*x[2]**o+(-0.59399986706)*x[2]
        arg[3,3,1,0]=(-0.142707671693)*x[0]**o+(0.177095043535)*x[0]+(-0.348946846847)*x[1]**o+(-0.545430013244)*x[1]+(-0.671405653136)*x[2]**o+(-0.531699969702)*x[2]
        arg[3,3,1,1]=(0.783201055631)*x[0]**o+(0.899495042323)*x[0]+(0.117802924059)*x[1]**o+(-0.277400900172)*x[1]+(-0.351268362305)*x[2]**o+(0.52756480897)*x[2]
        arg[3,3,2,0]=(-0.866758006698)*x[0]**o+(0.293139875238)*x[0]+(-0.318394231317)*x[1]**o+(-0.783701622124)*x[1]+(-0.95137399655)*x[2]**o+(-0.474198736639)*x[2]
        arg[3,3,2,1]=(0.0428398560619)*x[0]**o+(-0.970180601102)*x[0]+(-0.753897573393)*x[1]**o+(-0.0873352699251)*x[1]+(-0.131440532574)*x[2]**o+(0.875241605077)*x[2]
        arg[3,4,0,0]=(0.32399493643)*x[0]**o+(0.67295092524)*x[0]+(-0.29221110671)*x[1]**o+(0.118066079866)*x[1]+(-0.566541154667)*x[2]**o+(-0.806367499079)*x[2]
        arg[3,4,0,1]=(0.278776399755)*x[0]**o+(0.472327826919)*x[0]+(-0.956871861949)*x[1]**o+(0.109236874792)*x[1]+(-0.494095116883)*x[2]**o+(-0.194313775518)*x[2]
        arg[3,4,1,0]=(0.650920037415)*x[0]**o+(0.977698516929)*x[0]+(-0.0730777837998)*x[1]**o+(-0.576543152032)*x[1]+(0.781481934657)*x[2]**o+(-0.389328840554)*x[2]
        arg[3,4,1,1]=(-0.798341529522)*x[0]**o+(-0.630245234712)*x[0]+(-0.444550323489)*x[1]**o+(-0.539189248295)*x[1]+(-0.904964423673)*x[2]**o+(-0.611560462796)*x[2]
        arg[3,4,2,0]=(-0.392991417685)*x[0]**o+(0.313599061567)*x[0]+(-0.215747337398)*x[1]**o+(-0.310316872476)*x[1]+(-0.269452617785)*x[2]**o+(0.684353794645)*x[2]
        arg[3,4,2,1]=(-0.586668781403)*x[0]**o+(-0.0711284937177)*x[0]+(0.408273850302)*x[1]**o+(0.761860299288)*x[1]+(0.902079242449)*x[2]**o+(0.70161017722)*x[2]
        ref[0,0,0,0]=(1.43173970815)/(o+1.)+(-0.156396435558)
        ref[0,0,0,1]=(0.459165989186)/(o+1.)+(0.194399341676)
        ref[0,0,1,0]=(0.989528642545)/(o+1.)+(-0.164206368911)
        ref[0,0,1,1]=(1.37152584676)/(o+1.)+(-0.234493053498)
        ref[0,0,2,0]=(0.422741924108)/(o+1.)+(0.0721378026728)
        ref[0,0,2,1]=(-0.574467903086)/(o+1.)+(0.167204674462)
        ref[0,1,0,0]=(1.36619629735)/(o+1.)+(-0.19947081885)
        ref[0,1,0,1]=(-1.60758660729)/(o+1.)+(0.447728236186)
        ref[0,1,1,0]=(1.5106959073)/(o+1.)+(-0.393852180331)
        ref[0,1,1,1]=(1.85678121239)/(o+1.)+(-0.529280397551)
        ref[0,1,2,0]=(-0.796337866944)/(o+1.)+(0.0812355940636)
        ref[0,1,2,1]=(-0.333114331422)/(o+1.)+(1.22614026311)
        ref[0,2,0,0]=(0.516540083621)/(o+1.)+(-0.358761510118)
        ref[0,2,0,1]=(-2.72820411942)/(o+1.)+(0.15972705639)
        ref[0,2,1,0]=(-0.440149466937)/(o+1.)+(-0.124216123318)
        ref[0,2,1,1]=(-0.137940536755)/(o+1.)+(0.13992652657)
        ref[0,2,2,0]=(0.373759361058)/(o+1.)+(0.210996140796)
        ref[0,2,2,1]=(-1.07034621798)/(o+1.)+(1.2905860125)
        ref[0,3,0,0]=(0.923495049095)/(o+1.)+(-0.897043344396)
        ref[0,3,0,1]=(-0.20180799615)/(o+1.)+(0.272652457923)
        ref[0,3,1,0]=(-0.831052678484)/(o+1.)+(0.326929849662)
        ref[0,3,1,1]=(1.41523396695)/(o+1.)+(-0.5275927117)
        ref[0,3,2,0]=(0.405715363821)/(o+1.)+(0.535330516568)
        ref[0,3,2,1]=(0.877269821733)/(o+1.)+(-0.666082812121)
        ref[0,4,0,0]=(0.884126703786)/(o+1.)+(-0.559427998262)
        ref[0,4,0,1]=(-1.36933304826)/(o+1.)+(0.263100182211)
        ref[0,4,1,0]=(0.871486955825)/(o+1.)+(0.381595437312)
        ref[0,4,1,1]=(1.21446122052)/(o+1.)+(-0.642161706726)
        ref[0,4,2,0]=(-1.82861338966)/(o+1.)+(0.507433118531)
        ref[0,4,2,1]=(0.0642039966469)/(o+1.)+(0.551348562604)
        ref[1,0,0,0]=(0.40922616303)/(o+1.)+(-0.474630105482)
        ref[1,0,0,1]=(1.63943889768)/(o+1.)+(0.285622914296)
        ref[1,0,1,0]=(0.0845961115353)/(o+1.)+(0.143628502705)
        ref[1,0,1,1]=(0.62129375936)/(o+1.)+(0.671645835511)
        ref[1,0,2,0]=(-1.2004575453)/(o+1.)+(0.701757992696)
        ref[1,0,2,1]=(0.435963491825)/(o+1.)+(0.26710538393)
        ref[1,1,0,0]=(0.738921325407)/(o+1.)+(-0.0258542444502)
        ref[1,1,0,1]=(1.95599148183)/(o+1.)+(0.652818492883)
        ref[1,1,1,0]=(0.500576647095)/(o+1.)+(0.857652485995)
        ref[1,1,1,1]=(-0.0151750762821)/(o+1.)+(0.238827857598)
        ref[1,1,2,0]=(1.26963005373)/(o+1.)+(-0.299065008888)
        ref[1,1,2,1]=(-0.82289389301)/(o+1.)+(0.14939351077)
        ref[1,2,0,0]=(-0.495951362447)/(o+1.)+(-0.532833788304)
        ref[1,2,0,1]=(-1.87785443639)/(o+1.)+(-0.521209467732)
        ref[1,2,1,0]=(-0.374085962184)/(o+1.)+(0.505583421209)
        ref[1,2,1,1]=(1.01773556605)/(o+1.)+(0.764863466171)
        ref[1,2,2,0]=(-1.54049109838)/(o+1.)+(-0.511296952595)
        ref[1,2,2,1]=(-1.06948953348)/(o+1.)+(-0.215299794811)
        ref[1,3,0,0]=(-1.20198777829)/(o+1.)+(-0.274360734317)
        ref[1,3,0,1]=(1.13519842695)/(o+1.)+(0.506840913294)
        ref[1,3,1,0]=(0.973820116369)/(o+1.)+(0.485786110977)
        ref[1,3,1,1]=(0.155263308828)/(o+1.)+(0.473436850817)
        ref[1,3,2,0]=(0.476069733748)/(o+1.)+(-0.228046397052)
        ref[1,3,2,1]=(-0.234851551487)/(o+1.)+(-0.574065011567)
        ref[1,4,0,0]=(1.95924908786)/(o+1.)+(-0.493262726539)
        ref[1,4,0,1]=(-0.448532656782)/(o+1.)+(0.393812699074)
        ref[1,4,1,0]=(0.235155577808)/(o+1.)+(0.756260258803)
        ref[1,4,1,1]=(0.0334282473144)/(o+1.)+(-0.837406551217)
        ref[1,4,2,0]=(0.568132489684)/(o+1.)+(-0.13055465798)
        ref[1,4,2,1]=(-0.380042596089)/(o+1.)+(0.243737215624)
        ref[2,0,0,0]=(1.76568035823)/(o+1.)+(0.0789834372326)
        ref[2,0,0,1]=(-0.20023919191)/(o+1.)+(0.901466917208)
        ref[2,0,1,0]=(-1.20715877778)/(o+1.)+(-0.992500439486)
        ref[2,0,1,1]=(-0.761913514624)/(o+1.)+(0.465965334128)
        ref[2,0,2,0]=(-0.944104213428)/(o+1.)+(-0.146881270459)
        ref[2,0,2,1]=(0.105283971659)/(o+1.)+(-1.30498791712)
        ref[2,1,0,0]=(-0.804721214141)/(o+1.)+(0.356736186609)
        ref[2,1,0,1]=(-0.0358563948854)/(o+1.)+(-0.24146509617)
        ref[2,1,1,0]=(-0.437556173502)/(o+1.)+(-0.387215578175)
        ref[2,1,1,1]=(-0.0786030951662)/(o+1.)+(0.654838009465)
        ref[2,1,2,0]=(-0.859200342885)/(o+1.)+(-0.112407873885)
        ref[2,1,2,1]=(-0.296679106354)/(o+1.)+(0.0491751507381)
        ref[2,2,0,0]=(0.462408531841)/(o+1.)+(-0.557975521593)
        ref[2,2,0,1]=(-0.0634225791893)/(o+1.)+(0.0468185300489)
        ref[2,2,1,0]=(1.08205349937)/(o+1.)+(0.621257561187)
        ref[2,2,1,1]=(0.88864389409)/(o+1.)+(0.849886105205)
        ref[2,2,2,0]=(2.01702912587)/(o+1.)+(0.755558425167)
        ref[2,2,2,1]=(1.41263009001)/(o+1.)+(0.331281133791)
        ref[2,3,0,0]=(1.91485193421)/(o+1.)+(0.0643042152414)
        ref[2,3,0,1]=(1.86113720031)/(o+1.)+(0.870090339646)
        ref[2,3,1,0]=(0.442533807126)/(o+1.)+(-0.690437405116)
        ref[2,3,1,1]=(1.52774754257)/(o+1.)+(-0.236667038211)
        ref[2,3,2,0]=(1.08558789233)/(o+1.)+(-0.346580362392)
        ref[2,3,2,1]=(-0.771732912166)/(o+1.)+(-0.49697903252)
        ref[2,4,0,0]=(1.0510676744)/(o+1.)+(0.18646253745)
        ref[2,4,0,1]=(-0.878875991119)/(o+1.)+(-0.271299000644)
        ref[2,4,1,0]=(-0.75026757693)/(o+1.)+(-0.168751100981)
        ref[2,4,1,1]=(0.526155063499)/(o+1.)+(1.041034953)
        ref[2,4,2,0]=(0.377792294719)/(o+1.)+(0.433767213151)
        ref[2,4,2,1]=(0.114142925831)/(o+1.)+(-0.972051850709)
        ref[3,0,0,0]=(0.15538316839)/(o+1.)+(-0.861229788808)
        ref[3,0,0,1]=(-0.725501605569)/(o+1.)+(-0.248009661269)
        ref[3,0,1,0]=(0.791443284981)/(o+1.)+(0.618118504587)
        ref[3,0,1,1]=(-0.411749416988)/(o+1.)+(0.125302421245)
        ref[3,0,2,0]=(0.0968028463245)/(o+1.)+(0.592149023513)
        ref[3,0,2,1]=(0.0947000244134)/(o+1.)+(0.286498958939)
        ref[3,1,0,0]=(0.823197755916)/(o+1.)+(-0.378154495725)
        ref[3,1,0,1]=(1.21588193285)/(o+1.)+(0.0126566819682)
        ref[3,1,1,0]=(0.529639159192)/(o+1.)+(-0.619204956255)
        ref[3,1,1,1]=(1.85472331764)/(o+1.)+(0.3317212712)
        ref[3,1,2,0]=(-0.0770331978898)/(o+1.)+(0.0545214351076)
        ref[3,1,2,1]=(0.46556780359)/(o+1.)+(-0.223576369421)
        ref[3,2,0,0]=(-0.242684948671)/(o+1.)+(-0.681739755992)
        ref[3,2,0,1]=(0.0243168377401)/(o+1.)+(0.0176531159642)
        ref[3,2,1,0]=(-0.154330975892)/(o+1.)+(-0.543310918519)
        ref[3,2,1,1]=(-0.217608478494)/(o+1.)+(0.204473606215)
        ref[3,2,2,0]=(-2.25460522533)/(o+1.)+(-0.0278277816531)
        ref[3,2,2,1]=(-1.16412458146)/(o+1.)+(0.0837125949668)
        ref[3,3,0,0]=(-0.26896142194)/(o+1.)+(-0.0679863842941)
        ref[3,3,0,1]=(1.40707422197)/(o+1.)+(0.173208598807)
        ref[3,3,1,0]=(-1.16306017168)/(o+1.)+(-0.450017469706)
        ref[3,3,1,1]=(0.549735617385)/(o+1.)+(0.57482947556)
        ref[3,3,2,0]=(-2.13652623456)/(o+1.)+(-0.482380241762)
        ref[3,3,2,1]=(-0.842498249905)/(o+1.)+(-0.0911371329748)
        ref[3,4,0,0]=(-0.534757324947)/(o+1.)+(-0.00767524698684)
        ref[3,4,0,1]=(-1.17219057908)/(o+1.)+(0.193625463097)
        ref[3,4,1,0]=(1.35932418827)/(o+1.)+(0.00591326217154)
        ref[3,4,1,1]=(-2.14785627668)/(o+1.)+(-0.890497472901)
        ref[3,4,2,0]=(-0.878191372868)/(o+1.)+(0.343817991868)
        ref[3,4,2,1]=(0.723684311348)/(o+1.)+(0.696170991395)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.729700679932)*x[0]+(-1.38329769179)*x[1]
        ref=(0.329728333821)/(o+1.)+(-0.491662672839)
      else:
        arg=(-1.75076012766)*x[0]+(-0.0862990889349)*x[1]+(0.637429232833)*x[2]
        ref=(-0.577517867896)/(o+1.)+(-0.311056057931)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(1.0296233191)*x[0]+(-0.347985432388)*x[1]
        arg[1]=(-0.182082548052)*x[0]+(0.114822539064)*x[1]
        ref[0]=(0.876900301573)/(o+1.)+(-0.0976312074308)
        ref[1]=(-1.09276229827)/(o+1.)+(0.512751144643)
      else:
        arg[0]=(0.390938934986)*x[0]+(-0.17813109236)*x[1]+(0.92611177061)*x[2]
        arg[1]=(0.169562781554)*x[0]+(-0.149625135256)*x[1]+(0.357445984273)*x[2]
        ref[0]=(1.07308269316)/(o+1.)+(0.0329184600363)
        ref[1]=(-1.07527269336)/(o+1.)+(0.726328161966)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.798668686601)*x[0]+(-0.502017718729)*x[1]
        arg[0,1]=(-0.682368031728)*x[0]+(-0.915048032379)*x[1]
        arg[0,2]=(-0.0237771508029)*x[0]+(0.177441262563)*x[1]
        arg[0,3]=(0.135600942216)*x[0]+(0.496697614771)*x[1]
        arg[0,4]=(0.495272681631)*x[0]+(-0.457599050745)*x[1]
        arg[1,0]=(-0.252415627225)*x[0]+(-0.820872546406)*x[1]
        arg[1,1]=(-0.183362696688)*x[0]+(-0.721277471492)*x[1]
        arg[1,2]=(0.401101418876)*x[0]+(0.0483185737314)*x[1]
        arg[1,3]=(0.251246583055)*x[0]+(-0.837901564153)*x[1]
        arg[1,4]=(0.2984760032)*x[0]+(0.0504569221307)*x[1]
        arg[2,0]=(1.18468310151)*x[0]+(-0.545612792222)*x[1]
        arg[2,1]=(-1.08451540544)*x[0]+(0.820927137753)*x[1]
        arg[2,2]=(0.85435600905)*x[0]+(-0.309819803422)*x[1]
        arg[2,3]=(-0.184148030844)*x[0]+(0.978315441698)*x[1]
        arg[2,4]=(1.36943188922)*x[0]+(-1.3176984733)*x[1]
        arg[3,0]=(0.42189213134)*x[0]+(1.23097633986)*x[1]
        arg[3,1]=(0.0409353425792)*x[0]+(-1.15555830367)*x[1]
        arg[3,2]=(0.557942070395)*x[0]+(-0.591659744114)*x[1]
        arg[3,3]=(-1.07432449167)*x[0]+(-0.665475086161)*x[1]
        arg[3,4]=(-1.00421972544)*x[0]+(1.16737316771)*x[1]
        ref[0,0]=(-0.400434079596)/(o+1.)+(-0.450126162867)
        ref[0,1]=(-1.35836659237)/(o+1.)+(-0.11952473587)
        ref[0,2]=(0.154775934077)/(o+1.)+(-0.000555911158727)
        ref[0,3]=(-0.177525502969)/(o+1.)+(0.404912029978)
        ref[0,4]=(1.00122501632)/(o+1.)+(-0.481775692719)
        ref[1,0]=(-1.37507083806)/(o+1.)+(0.150891332214)
        ref[1,1]=(-1.37429063854)/(o+1.)+(0.234825235182)
        ref[1,2]=(1.30069236547)/(o+1.)+(-0.425636186429)
        ref[1,3]=(-0.414658324515)/(o+1.)+(-0.0859983282917)
        ref[1,4]=(0.757097138678)/(o+1.)+(-0.204082106674)
        ref[2,0]=(1.09244584366)/(o+1.)+(-0.226687767185)
        ref[2,1]=(0.109481169277)/(o+1.)+(-0.186534718481)
        ref[2,2]=(0.587125473152)/(o+1.)+(-0.0212946337622)
        ref[2,3]=(0.00878695699842)/(o+1.)+(0.392690226928)
        ref[2,4]=(0.306810290785)/(o+1.)+(-0.127538437433)
        ref[3,0]=(0.317826050636)/(o+1.)+(0.667521210281)
        ref[3,1]=(-0.276254182573)/(o+1.)+(-0.419184389261)
        ref[3,2]=(-0.753831729065)/(o+1.)+(0.360057027673)
        ref[3,3]=(-1.40505001195)/(o+1.)+(-0.167374782943)
        ref[3,4]=(0.53112066724)/(o+1.)+(-0.183983612488)
      else:
        arg[0,0]=(1.54447818842)*x[0]+(-0.560568590939)*x[1]+(-1.33749549019)*x[2]
        arg[0,1]=(-0.535544800192)*x[0]+(-0.732513980801)*x[1]+(0.309855030569)*x[2]
        arg[0,2]=(-0.45251604551)*x[0]+(-0.0933932995351)*x[1]+(-0.465724167794)*x[2]
        arg[0,3]=(0.10344455234)*x[0]+(-0.0451254971766)*x[1]+(-1.39912042607)*x[2]
        arg[0,4]=(0.617585449939)*x[0]+(1.27357810776)*x[1]+(-0.840161322302)*x[2]
        arg[1,0]=(0.650274355535)*x[0]+(0.547805408891)*x[1]+(0.314350326062)*x[2]
        arg[1,1]=(0.697200474806)*x[0]+(0.558681734309)*x[1]+(-0.0277936766536)*x[2]
        arg[1,2]=(-0.508578328229)*x[0]+(-0.513894226666)*x[1]+(-0.528417418023)*x[2]
        arg[1,3]=(-1.50391414876)*x[0]+(0.174080260823)*x[1]+(-1.48528641514)*x[2]
        arg[1,4]=(0.859470776434)*x[0]+(-0.121348493404)*x[1]+(1.69796346547)*x[2]
        arg[2,0]=(1.00593912049)*x[0]+(0.794254020467)*x[1]+(-1.02770358461)*x[2]
        arg[2,1]=(-1.64586076188)*x[0]+(-0.83927167526)*x[1]+(-1.13088449805)*x[2]
        arg[2,2]=(0.0628777004357)*x[0]+(-1.27316091149)*x[1]+(0.417655047748)*x[2]
        arg[2,3]=(-1.43661526118)*x[0]+(0.0676042964527)*x[1]+(0.174947572442)*x[2]
        arg[2,4]=(0.504347051098)*x[0]+(-1.62976096707)*x[1]+(0.61579932957)*x[2]
        arg[3,0]=(1.05212645875)*x[0]+(-1.10517003049)*x[1]+(0.902242097595)*x[2]
        arg[3,1]=(-0.997611854104)*x[0]+(-1.53611378293)*x[1]+(0.322835276897)*x[2]
        arg[3,2]=(-0.815135194015)*x[0]+(0.357734619962)*x[1]+(0.684966069635)*x[2]
        arg[3,3]=(0.4545417685)*x[0]+(0.386262464083)*x[1]+(0.131414279708)*x[2]
        arg[3,4]=(-0.222694646001)*x[0]+(-0.470499833621)*x[1]+(-0.593290862391)*x[2]
        ref[0,0]=(-0.593803934901)/(o+1.)+(0.120109021094)
        ref[0,1]=(0.0569115377867)/(o+1.)+(-0.507557644105)
        ref[0,2]=(-0.202741590274)/(o+1.)+(-0.404445961283)
        ref[0,3]=(-0.516888777015)/(o+1.)+(-0.411956296948)
        ref[0,4]=(0.52292787417)/(o+1.)+(0.264037180616)
        ref[1,0]=(-0.102685279742)/(o+1.)+(0.807557685115)
        ref[1,1]=(1.44527264276)/(o+1.)+(-0.108592055148)
        ref[1,2]=(-0.448767718864)/(o+1.)+(-0.551061127027)
        ref[1,3]=(-1.19936004685)/(o+1.)+(-0.807880128113)
        ref[1,4]=(1.09918755605)/(o+1.)+(0.668449096223)
        ref[2,0]=(-0.873708007453)/(o+1.)+(0.823098781902)
        ref[2,1]=(-1.9697776018)/(o+1.)+(-0.823119666698)
        ref[2,2]=(0.598023292545)/(o+1.)+(-0.695325727928)
        ref[2,3]=(-0.486077421455)/(o+1.)+(-0.353992985415)
        ref[2,4]=(0.65037669171)/(o+1.)+(-0.579995639058)
        ref[3,0]=(0.115401170876)/(o+1.)+(0.366898677493)
        ref[3,1]=(-0.836209920174)/(o+1.)+(-0.68734021998)
        ref[3,2]=(0.753819223079)/(o+1.)+(-0.263126863749)
        ref[3,3]=(-0.75294945942)/(o+1.)+(0.862583985856)
        ref[3,4]=(-1.44356156537)/(o+1.)+(0.0785381116785)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.409425595197)*x[0]+(-0.992427840513)*x[1]
        arg[0,0,1]=(0.645693185569)*x[0]+(-1.38338827813)*x[1]
        arg[0,1,0]=(0.838847764041)*x[0]+(-1.01358491173)*x[1]
        arg[0,1,1]=(0.381938057912)*x[0]+(0.61979806953)*x[1]
        arg[1,0,0]=(-1.36783302742)*x[0]+(-0.132422986617)*x[1]
        arg[1,0,1]=(-0.137283745381)*x[0]+(0.633534018338)*x[1]
        arg[1,1,0]=(0.0698189930006)*x[0]+(-1.45980415637)*x[1]
        arg[1,1,1]=(-0.391725001578)*x[0]+(0.355258883756)*x[1]
        arg[2,0,0]=(-0.596091494216)*x[0]+(-0.911870026464)*x[1]
        arg[2,0,1]=(0.138007894626)*x[0]+(1.76859278751)*x[1]
        arg[2,1,0]=(-0.791803431843)*x[0]+(-0.813170959331)*x[1]
        arg[2,1,1]=(-1.05466714677)*x[0]+(-1.12822729059)*x[1]
        arg[3,0,0]=(-0.417845531677)*x[0]+(1.13689234148)*x[1]
        arg[3,0,1]=(-0.0323347813877)*x[0]+(1.14381520037)*x[1]
        arg[3,1,0]=(0.639524393892)*x[0]+(0.864696525716)*x[1]
        arg[3,1,1]=(0.593104139176)*x[0]+(0.812642260561)*x[1]
        arg[4,0,0]=(-0.0580034066457)*x[0]+(0.802938738147)*x[1]
        arg[4,0,1]=(0.722143376522)*x[0]+(0.843814429252)*x[1]
        arg[4,1,0]=(-0.574057925551)*x[0]+(-0.298232158953)*x[1]
        arg[4,1,1]=(0.422529038525)*x[0]+(0.841942812244)*x[1]
        arg[5,0,0]=(1.90272013575)*x[0]+(-1.84811498267)*x[1]
        arg[5,0,1]=(-1.52156314991)*x[0]+(-0.797833417606)*x[1]
        arg[5,1,0]=(0.723748480291)*x[0]+(0.8667659268)*x[1]
        arg[5,1,1]=(-0.70289499551)*x[0]+(-0.726595802952)*x[1]
        ref[0,0,0]=(-1.1719312491)/(o+1.)+(-0.114961093303)
        ref[0,0,1]=(0.229993657297)/(o+1.)+(-0.483844374927)
        ref[0,1,0]=(-0.630442924796)/(o+1.)+(0.227852888553)
        ref[0,1,1]=(-0.806392286115)/(o+1.)+(0.904064206778)
        ref[1,0,0]=(-1.38312106397)/(o+1.)+(-0.0585674750338)
        ref[1,0,1]=(0.595552955095)/(o+1.)+(-0.049651341069)
        ref[1,1,0]=(-1.63606241234)/(o+1.)+(0.123038624483)
        ref[1,1,1]=(-0.340463713286)/(o+1.)+(0.151998797732)
        ref[2,0,0]=(-1.31925158304)/(o+1.)+(-0.094354968822)
        ref[2,0,1]=(0.699277735512)/(o+1.)+(0.60366147331)
        ref[2,1,0]=(-0.219878898763)/(o+1.)+(-0.692547746205)
        ref[2,1,1]=(-1.46750249607)/(o+1.)+(-0.357695970647)
        ref[3,0,0]=(0.71941698906)/(o+1.)+(-0.000185089626866)
        ref[3,0,1]=(-0.526993313502)/(o+1.)+(0.819236866243)
        ref[3,1,0]=(1.51671320209)/(o+1.)+(-0.00624614123899)
        ref[3,1,1]=(1.05185683613)/(o+1.)+(0.176944781803)
        ref[4,0,0]=(1.20432711487)/(o+1.)+(-0.229695891683)
        ref[4,0,1]=(1.26863112516)/(o+1.)+(0.14866334031)
        ref[4,1,0]=(0.34377834331)/(o+1.)+(-0.608034213907)
        ref[4,1,1]=(-0.189568721058)/(o+1.)+(0.727020285914)
        ref[5,0,0]=(0.116981035747)/(o+1.)+(-0.0311879413343)
        ref[5,0,1]=(-0.638728138162)/(o+1.)+(-0.840334214679)
        ref[5,1,0]=(0.891634589919)/(o+1.)+(0.349439908586)
        ref[5,1,1]=(-0.552480077628)/(o+1.)+(-0.438505360418)
      else:
        arg[0,0,0]=(-0.662295604848)*x[0]+(1.04606412328)*x[1]+(-0.376008345205)*x[2]
        arg[0,0,1]=(1.25030158303)*x[0]+(-0.0735167236581)*x[1]+(1.31623868156)*x[2]
        arg[0,1,0]=(0.717953620717)*x[0]+(-0.700464709991)*x[1]+(0.0345381771501)*x[2]
        arg[0,1,1]=(0.225944321569)*x[0]+(-1.09510173632)*x[1]+(-0.371235420166)*x[2]
        arg[1,0,0]=(-0.0755865552996)*x[0]+(-0.168214695387)*x[1]+(-0.437427629408)*x[2]
        arg[1,0,1]=(-1.52674685128)*x[0]+(-0.408158359188)*x[1]+(0.750091649824)*x[2]
        arg[1,1,0]=(-0.572400948498)*x[0]+(-0.802826119419)*x[1]+(-1.0233358643)*x[2]
        arg[1,1,1]=(0.623156259061)*x[0]+(0.378774331134)*x[1]+(0.0419766309042)*x[2]
        arg[2,0,0]=(0.443271002813)*x[0]+(-0.930092172267)*x[1]+(-0.20199150178)*x[2]
        arg[2,0,1]=(0.408614848881)*x[0]+(-1.3007040171)*x[1]+(-0.872615408174)*x[2]
        arg[2,1,0]=(-0.174910742406)*x[0]+(1.64872582781)*x[1]+(0.701172036891)*x[2]
        arg[2,1,1]=(0.417145974895)*x[0]+(0.428983721984)*x[1]+(-0.000787616769604)*x[2]
        arg[3,0,0]=(0.655644872855)*x[0]+(-0.268612479186)*x[1]+(0.11779790898)*x[2]
        arg[3,0,1]=(-0.244670332245)*x[0]+(-0.857502890419)*x[1]+(0.111792341131)*x[2]
        arg[3,1,0]=(0.131303542183)*x[0]+(0.231230724482)*x[1]+(0.116997126513)*x[2]
        arg[3,1,1]=(0.725434968911)*x[0]+(1.00206695553)*x[1]+(-0.319715936784)*x[2]
        arg[4,0,0]=(1.30949067662)*x[0]+(-1.14809917605)*x[1]+(0.00529778192088)*x[2]
        arg[4,0,1]=(0.969626585498)*x[0]+(-0.517908035476)*x[1]+(1.0467168328)*x[2]
        arg[4,1,0]=(0.362824899886)*x[0]+(0.890586602899)*x[1]+(-0.135163953653)*x[2]
        arg[4,1,1]=(-0.10353577028)*x[0]+(-0.0997924233294)*x[1]+(0.308973949876)*x[2]
        arg[5,0,0]=(-1.37242244095)*x[0]+(-0.746928231432)*x[1]+(-1.37385481504)*x[2]
        arg[5,0,1]=(0.231730881472)*x[0]+(-0.250265629505)*x[1]+(-0.903599685792)*x[2]
        arg[5,1,0]=(-0.813783753893)*x[0]+(0.41081474894)*x[1]+(-0.541868665288)*x[2]
        arg[5,1,1]=(0.19296641571)*x[0]+(1.8056250646)*x[1]+(0.283675443031)*x[2]
        ref[0,0,0]=(0.859538687531)/(o+1.)+(-0.425889257151)
        ref[0,0,1]=(-0.0674840316504)/(o+1.)+(1.28025378629)
        ref[0,1,0]=(-0.76922088579)/(o+1.)+(0.410623986833)
        ref[0,1,1]=(-0.582981712778)/(o+1.)+(-0.328705561068)
        ref[1,0,0]=(1.25605113432)/(o+1.)+(-0.968640007206)
        ref[1,0,1]=(-1.59448994908)/(o+1.)+(0.204838194218)
        ref[1,1,0]=(-2.07497671334)/(o+1.)+(-0.161793109438)
        ref[1,1,1]=(0.199659680372)/(o+1.)+(0.422123770364)
        ref[2,0,0]=(-1.86970457224)/(o+1.)+(0.590445950504)
        ref[2,0,1]=(-1.09505237157)/(o+1.)+(-0.334826102411)
        ref[2,1,0]=(0.395146564722)/(o+1.)+(0.889920278785)
        ref[2,1,1]=(1.13315474193)/(o+1.)+(-0.143906330909)
        ref[3,0,0]=(-0.804398097072)/(o+1.)+(0.65461419986)
        ref[3,0,1]=(-0.829074327243)/(o+1.)+(-0.0806532771448)
        ref[3,1,0]=(0.126278821088)/(o+1.)+(0.176626286045)
        ref[3,1,1]=(-0.498753315826)/(o+1.)+(0.953269651743)
        ref[4,0,0]=(0.33849802718)/(o+1.)+(-0.0859043723417)
        ref[4,0,1]=(0.153172891455)/(o+1.)+(0.672631245684)
        ref[4,1,0]=(1.42803542207)/(o+1.)+(-0.154893936468)
        ref[4,1,1]=(0.605555698814)/(o+1.)+(-0.249954971274)
        ref[5,0,0]=(-1.21823919194)/(o+1.)+(-1.13748314774)
        ref[5,0,1]=(-1.13684484437)/(o+1.)+(0.107355205274)
        ref[5,1,0]=(-1.21991007491)/(o+1.)+(0.137536202333)
        ref[5,1,1]=(2.05825898341)/(o+1.)+(0.112003969962)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.2631296794)*x[0]+(-0.130117190301)*x[1]
        arg[0,0,0,1]=(0.635732952218)*x[0]+(-0.647555274619)*x[1]
        arg[0,0,1,0]=(1.06301179339)*x[0]+(-0.227813591181)*x[1]
        arg[0,0,1,1]=(-0.519979711376)*x[0]+(1.04747480856)*x[1]
        arg[0,0,2,0]=(0.0232818794686)*x[0]+(-1.14799687633)*x[1]
        arg[0,0,2,1]=(0.359605391616)*x[0]+(-1.32942998109)*x[1]
        arg[0,1,0,0]=(-0.555284020205)*x[0]+(0.11676202509)*x[1]
        arg[0,1,0,1]=(-1.83479976366)*x[0]+(0.413168061643)*x[1]
        arg[0,1,1,0]=(0.239736306037)*x[0]+(0.680002261596)*x[1]
        arg[0,1,1,1]=(0.0555978436642)*x[0]+(1.28910533087)*x[1]
        arg[0,1,2,0]=(0.732696470486)*x[0]+(0.538837927425)*x[1]
        arg[0,1,2,1]=(0.528018376979)*x[0]+(1.20428218411)*x[1]
        arg[0,2,0,0]=(0.863803666388)*x[0]+(0.187082373754)*x[1]
        arg[0,2,0,1]=(-1.41490739709)*x[0]+(-0.741935114995)*x[1]
        arg[0,2,1,0]=(0.0501211708116)*x[0]+(-0.370371645307)*x[1]
        arg[0,2,1,1]=(-0.0353423795999)*x[0]+(1.00911245551)*x[1]
        arg[0,2,2,0]=(1.79997397117)*x[0]+(0.240103369892)*x[1]
        arg[0,2,2,1]=(0.926052414873)*x[0]+(0.00914357056458)*x[1]
        arg[0,3,0,0]=(-1.38911305622)*x[0]+(-1.29285413766)*x[1]
        arg[0,3,0,1]=(0.464908270265)*x[0]+(-0.354824878801)*x[1]
        arg[0,3,1,0]=(0.17477491298)*x[0]+(0.882807721541)*x[1]
        arg[0,3,1,1]=(0.633177386897)*x[0]+(-0.312628707154)*x[1]
        arg[0,3,2,0]=(0.0841289229919)*x[0]+(-0.244085514309)*x[1]
        arg[0,3,2,1]=(0.198631529554)*x[0]+(-0.324387433152)*x[1]
        arg[0,4,0,0]=(-1.41503119851)*x[0]+(-0.760818812719)*x[1]
        arg[0,4,0,1]=(-0.0326236565753)*x[0]+(0.835716629913)*x[1]
        arg[0,4,1,0]=(1.84482629546)*x[0]+(-0.341557269651)*x[1]
        arg[0,4,1,1]=(-0.380600663728)*x[0]+(-0.295663906776)*x[1]
        arg[0,4,2,0]=(0.411308057157)*x[0]+(1.0109767907)*x[1]
        arg[0,4,2,1]=(-1.10494637617)*x[0]+(0.401374247774)*x[1]
        arg[1,0,0,0]=(0.437019391027)*x[0]+(0.0507256248679)*x[1]
        arg[1,0,0,1]=(-0.399457976892)*x[0]+(1.60118981524)*x[1]
        arg[1,0,1,0]=(-1.51289007675)*x[0]+(0.821406477166)*x[1]
        arg[1,0,1,1]=(0.405770274494)*x[0]+(0.637591733337)*x[1]
        arg[1,0,2,0]=(-1.4945593715)*x[0]+(1.0919176668)*x[1]
        arg[1,0,2,1]=(-0.482868528044)*x[0]+(0.578004764959)*x[1]
        arg[1,1,0,0]=(-1.44298476434)*x[0]+(0.197151370973)*x[1]
        arg[1,1,0,1]=(1.38517677391)*x[0]+(0.915352009234)*x[1]
        arg[1,1,1,0]=(1.69025511761)*x[0]+(0.0203268727501)*x[1]
        arg[1,1,1,1]=(0.615392847773)*x[0]+(-0.301873832451)*x[1]
        arg[1,1,2,0]=(0.3081860115)*x[0]+(-0.495230532585)*x[1]
        arg[1,1,2,1]=(-0.0258752746808)*x[0]+(0.441629273958)*x[1]
        arg[1,2,0,0]=(-0.947577742489)*x[0]+(0.218632343222)*x[1]
        arg[1,2,0,1]=(0.520029690788)*x[0]+(0.403806873912)*x[1]
        arg[1,2,1,0]=(1.32820278922)*x[0]+(-1.68314905373)*x[1]
        arg[1,2,1,1]=(1.30409876916)*x[0]+(-0.721819171819)*x[1]
        arg[1,2,2,0]=(1.37872038109)*x[0]+(0.0725139769178)*x[1]
        arg[1,2,2,1]=(0.35593830057)*x[0]+(0.28751298465)*x[1]
        arg[1,3,0,0]=(-1.17950311406)*x[0]+(-0.232819397686)*x[1]
        arg[1,3,0,1]=(0.17340184781)*x[0]+(-0.43329852484)*x[1]
        arg[1,3,1,0]=(-1.71125828064)*x[0]+(0.957284609667)*x[1]
        arg[1,3,1,1]=(-0.429043922461)*x[0]+(0.15749154348)*x[1]
        arg[1,3,2,0]=(-1.42626208855)*x[0]+(-1.12812746347)*x[1]
        arg[1,3,2,1]=(0.490516645689)*x[0]+(0.559039786338)*x[1]
        arg[1,4,0,0]=(0.436395831147)*x[0]+(0.382691724897)*x[1]
        arg[1,4,0,1]=(1.27903773839)*x[0]+(-0.0642376846324)*x[1]
        arg[1,4,1,0]=(0.503159792753)*x[0]+(0.392973700403)*x[1]
        arg[1,4,1,1]=(0.0881500114326)*x[0]+(0.834121935361)*x[1]
        arg[1,4,2,0]=(-0.620745962116)*x[0]+(-0.0770814791601)*x[1]
        arg[1,4,2,1]=(0.0231684675117)*x[0]+(-1.33994827808)*x[1]
        arg[2,0,0,0]=(-0.972311570714)*x[0]+(-0.235293375636)*x[1]
        arg[2,0,0,1]=(0.21633355466)*x[0]+(0.11325401613)*x[1]
        arg[2,0,1,0]=(0.922986727965)*x[0]+(-1.00516246282)*x[1]
        arg[2,0,1,1]=(-0.740778981838)*x[0]+(0.616728971608)*x[1]
        arg[2,0,2,0]=(1.73201175195)*x[0]+(-1.1634325209)*x[1]
        arg[2,0,2,1]=(1.15829744421)*x[0]+(-1.87219685708)*x[1]
        arg[2,1,0,0]=(-0.458901790255)*x[0]+(1.13812715713)*x[1]
        arg[2,1,0,1]=(1.03315725208)*x[0]+(-0.112487270341)*x[1]
        arg[2,1,1,0]=(-1.7070220527)*x[0]+(0.126058081856)*x[1]
        arg[2,1,1,1]=(0.863301459388)*x[0]+(0.226670498194)*x[1]
        arg[2,1,2,0]=(-1.0012992544)*x[0]+(-0.195604893926)*x[1]
        arg[2,1,2,1]=(-0.128048233768)*x[0]+(0.827383267773)*x[1]
        arg[2,2,0,0]=(-0.0876478859699)*x[0]+(1.69600082596)*x[1]
        arg[2,2,0,1]=(-0.616278041482)*x[0]+(-0.995548774612)*x[1]
        arg[2,2,1,0]=(0.780699602657)*x[0]+(-0.721498796198)*x[1]
        arg[2,2,1,1]=(-1.17591990575)*x[0]+(-0.66080847955)*x[1]
        arg[2,2,2,0]=(1.71259481962)*x[0]+(-1.12456334234)*x[1]
        arg[2,2,2,1]=(-0.721345747555)*x[0]+(-1.28222132706)*x[1]
        arg[2,3,0,0]=(-1.25971324146)*x[0]+(-0.00559590465243)*x[1]
        arg[2,3,0,1]=(-0.49234245798)*x[0]+(0.30900436328)*x[1]
        arg[2,3,1,0]=(1.3068919966)*x[0]+(-0.891484126193)*x[1]
        arg[2,3,1,1]=(0.319277203381)*x[0]+(-0.535113401495)*x[1]
        arg[2,3,2,0]=(0.529480518887)*x[0]+(0.00452686996008)*x[1]
        arg[2,3,2,1]=(-1.0978905592)*x[0]+(-0.421513714335)*x[1]
        arg[2,4,0,0]=(-1.27711509307)*x[0]+(-1.42208296178)*x[1]
        arg[2,4,0,1]=(-0.621292314868)*x[0]+(-1.10962518414)*x[1]
        arg[2,4,1,0]=(-0.183478331213)*x[0]+(1.0775900659)*x[1]
        arg[2,4,1,1]=(1.07354953663)*x[0]+(0.869765287054)*x[1]
        arg[2,4,2,0]=(-0.696050139647)*x[0]+(-0.120769338549)*x[1]
        arg[2,4,2,1]=(-0.895597167617)*x[0]+(1.41025466606)*x[1]
        arg[3,0,0,0]=(1.15262876611)*x[0]+(-0.505428168285)*x[1]
        arg[3,0,0,1]=(-0.277585299138)*x[0]+(0.352683243558)*x[1]
        arg[3,0,1,0]=(0.218694567952)*x[0]+(-0.170325565499)*x[1]
        arg[3,0,1,1]=(0.297325594036)*x[0]+(0.459308129811)*x[1]
        arg[3,0,2,0]=(-0.572509624935)*x[0]+(0.756188981433)*x[1]
        arg[3,0,2,1]=(0.226462444009)*x[0]+(-1.42100784266)*x[1]
        arg[3,1,0,0]=(-0.28388824767)*x[0]+(-0.306064847514)*x[1]
        arg[3,1,0,1]=(-0.805831316478)*x[0]+(0.756933495912)*x[1]
        arg[3,1,1,0]=(1.37344361233)*x[0]+(-0.377600924857)*x[1]
        arg[3,1,1,1]=(-0.0725302533884)*x[0]+(-0.425074450201)*x[1]
        arg[3,1,2,0]=(-0.066659431931)*x[0]+(1.39252394891)*x[1]
        arg[3,1,2,1]=(0.593440019224)*x[0]+(-0.945629564385)*x[1]
        arg[3,2,0,0]=(0.101850471598)*x[0]+(0.0552356415787)*x[1]
        arg[3,2,0,1]=(-0.407603005372)*x[0]+(-0.849371670514)*x[1]
        arg[3,2,1,0]=(0.435403192155)*x[0]+(0.213673097377)*x[1]
        arg[3,2,1,1]=(0.424081872219)*x[0]+(-0.0800529063085)*x[1]
        arg[3,2,2,0]=(0.189428134309)*x[0]+(-0.205813522374)*x[1]
        arg[3,2,2,1]=(-0.51449771505)*x[0]+(0.0570738169919)*x[1]
        arg[3,3,0,0]=(1.05431625119)*x[0]+(-0.0583139615539)*x[1]
        arg[3,3,0,1]=(0.0292261008496)*x[0]+(-0.569482715214)*x[1]
        arg[3,3,1,0]=(-0.155861158232)*x[0]+(0.628422800294)*x[1]
        arg[3,3,1,1]=(-1.24050157391)*x[0]+(-1.83949885089)*x[1]
        arg[3,3,2,0]=(-0.140709404689)*x[0]+(0.975529832713)*x[1]
        arg[3,3,2,1]=(-0.290824210426)*x[0]+(-0.198373932879)*x[1]
        arg[3,4,0,0]=(0.627236720719)*x[0]+(-0.306676521516)*x[1]
        arg[3,4,0,1]=(-0.964303098626)*x[0]+(-0.701698363587)*x[1]
        arg[3,4,1,0]=(-0.0447860906704)*x[0]+(0.324659175162)*x[1]
        arg[3,4,1,1]=(1.28273443124)*x[0]+(-0.764329261143)*x[1]
        arg[3,4,2,0]=(-0.023232709502)*x[0]+(-0.124231212653)*x[1]
        arg[3,4,2,1]=(0.510754136991)*x[0]+(0.570492207442)*x[1]
        ref[0,0,0,0]=(0.648764087616)/(o+1.)+(-0.521005478658)
        ref[0,0,0,1]=(-0.0127476670646)/(o+1.)+(0.000462672331599)
        ref[0,0,1,0]=(0.258601710827)/(o+1.)+(0.288298245692)
        ref[0,0,1,1]=(0.0577415806545)/(o+1.)+(0.234876758266)
        ref[0,0,2,0]=(-0.91129780757)/(o+1.)+(-0.106708594644)
        ref[0,0,2,1]=(0.0841946322525)/(o+1.)+(-0.527009610865)
        ref[0,1,0,0]=(0.111101563297)/(o+1.)+(-0.274811779206)
        ref[0,1,0,1]=(-0.504062576651)/(o+1.)+(-0.458784562683)
        ref[0,1,1,0]=(0.65560969277)/(o+1.)+(0.132064437431)
        ref[0,1,1,1]=(0.0866382135955)/(o+1.)+(0.629032480469)
        ref[0,1,2,0]=(1.36074036394)/(o+1.)+(-0.0446029830125)
        ref[0,1,2,1]=(1.16071753175)/(o+1.)+(0.285791514672)
        ref[0,2,0,0]=(0.693065154772)/(o+1.)+(0.178910442685)
        ref[0,2,0,1]=(-1.41209835364)/(o+1.)+(-0.372372079222)
        ref[0,2,1,0]=(-0.542625642859)/(o+1.)+(0.111187584182)
        ref[0,2,1,1]=(0.628714449405)/(o+1.)+(0.172527813253)
        ref[0,2,2,0]=(1.62887921583)/(o+1.)+(0.205599062617)
        ref[0,2,2,1]=(1.0640301541)/(o+1.)+(-0.0644170843301)
        ref[0,3,0,0]=(-1.09870552313)/(o+1.)+(-0.791630835375)
        ref[0,3,0,1]=(0.260706656546)/(o+1.)+(-0.0753116325413)
        ref[0,3,1,0]=(-0.0543842358149)/(o+1.)+(0.555983435168)
        ref[0,3,1,1]=(0.0369075211917)/(o+1.)+(0.141820579276)
        ref[0,3,2,0]=(-0.784250881508)/(o+1.)+(0.312147145095)
        ref[0,3,2,1]=(-0.178450092422)/(o+1.)+(0.0263470944113)
        ref[0,4,0,0]=(-0.993852999635)/(o+1.)+(-0.590998505799)
        ref[0,4,0,1]=(-0.0449039600312)/(o+1.)+(0.423998466684)
        ref[0,4,1,0]=(0.583535069477)/(o+1.)+(0.459866978166)
        ref[0,4,1,1]=(-0.251020886878)/(o+1.)+(-0.212621841813)
        ref[0,4,2,0]=(0.408688561613)/(o+1.)+(0.506798143121)
        ref[0,4,2,1]=(0.537090447747)/(o+1.)+(-0.620331288072)
        ref[1,0,0,0]=(0.37428496839)/(o+1.)+(0.0567300237522)
        ref[1,0,0,1]=(0.777672833448)/(o+1.)+(0.212029502451)
        ref[1,0,1,0]=(-0.745422608709)/(o+1.)+(0.026969504563)
        ref[1,0,1,1]=(0.466434983875)/(o+1.)+(0.288463511978)
        ref[1,0,2,0]=(0.237457788829)/(o+1.)+(-0.320049746767)
        ref[1,0,2,1]=(0.346974181328)/(o+1.)+(-0.125918972207)
        ref[1,1,0,0]=(-0.823737519034)/(o+1.)+(-0.211047937165)
        ref[1,1,0,1]=(1.00324369541)/(o+1.)+(0.648642543871)
        ref[1,1,1,0]=(0.674013158596)/(o+1.)+(0.518284415882)
        ref[1,1,1,1]=(0.403142463029)/(o+1.)+(-0.0448117238535)
        ref[1,1,2,0]=(0.0399328921703)/(o+1.)+(-0.113488706628)
        ref[1,1,2,1]=(0.111446633645)/(o+1.)+(0.152153682816)
        ref[1,2,0,0]=(-0.481646721692)/(o+1.)+(-0.123649338787)
        ref[1,2,0,1]=(0.857170000026)/(o+1.)+(0.033333282337)
        ref[1,2,1,0]=(-0.445362398126)/(o+1.)+(0.0452080668082)
        ref[1,2,1,1]=(-0.256201827386)/(o+1.)+(0.419240712362)
        ref[1,2,2,0]=(1.02991996311)/(o+1.)+(0.210657197448)
        ref[1,2,2,1]=(0.355299316895)/(o+1.)+(0.144075984162)
        ref[1,3,0,0]=(-0.679726322154)/(o+1.)+(-0.366298094796)
        ref[1,3,0,1]=(-0.67885027329)/(o+1.)+(0.20947679813)
        ref[1,3,1,0]=(-0.163081485233)/(o+1.)+(-0.295446092868)
        ref[1,3,1,1]=(-0.035768623673)/(o+1.)+(-0.117891877654)
        ref[1,3,2,0]=(-0.639368943038)/(o+1.)+(-0.957510304493)
        ref[1,3,2,1]=(0.160615066001)/(o+1.)+(0.444470683013)
        ref[1,4,0,0]=(1.0649487216)/(o+1.)+(-0.122930582777)
        ref[1,4,0,1]=(0.22766574122)/(o+1.)+(0.493567156271)
        ref[1,4,1,0]=(-0.481296537412)/(o+1.)+(0.688715015285)
        ref[1,4,1,1]=(-0.195268237132)/(o+1.)+(0.558770091963)
        ref[1,4,2,0]=(0.180618258117)/(o+1.)+(-0.439222849696)
        ref[1,4,2,1]=(0.0261012984826)/(o+1.)+(-0.671440554524)
        ref[2,0,0,0]=(-0.301101739758)/(o+1.)+(-0.453251603296)
        ref[2,0,0,1]=(0.00878006761908)/(o+1.)+(0.160403751586)
        ref[2,0,1,0]=(-0.80011300584)/(o+1.)+(0.35896863549)
        ref[2,0,1,1]=(0.00248831604776)/(o+1.)+(-0.0632691631389)
        ref[2,0,2,0]=(-0.0569220251136)/(o+1.)+(0.312750628078)
        ref[2,0,2,1]=(-0.440109525096)/(o+1.)+(-0.136894943888)
        ref[2,1,0,0]=(-0.465652661854)/(o+1.)+(0.572439014362)
        ref[2,1,0,1]=(0.0522958647723)/(o+1.)+(0.434187058485)
        ref[2,1,1,0]=(0.00194260180185)/(o+1.)+(-0.791453286324)
        ref[2,1,1,1]=(0.981996325082)/(o+1.)+(0.0539878162501)
        ref[2,1,2,0]=(-0.243334369882)/(o+1.)+(-0.476784889223)
        ref[2,1,2,1]=(1.53208640175)/(o+1.)+(-0.416375683873)
        ref[2,2,0,0]=(1.27849139532)/(o+1.)+(0.164930772337)
        ref[2,2,0,1]=(-1.4813889023)/(o+1.)+(-0.0652189568992)
        ref[2,2,1,0]=(-0.728282325831)/(o+1.)+(0.393741566145)
        ref[2,2,1,1]=(-0.537765426582)/(o+1.)+(-0.649481479359)
        ref[2,2,2,0]=(-0.266224153785)/(o+1.)+(0.427127815533)
        ref[2,2,2,1]=(-0.862349098277)/(o+1.)+(-0.570608988167)
        ref[2,3,0,0]=(-1.09340368619)/(o+1.)+(-0.0859527299593)
        ref[2,3,0,1]=(1.02842400947)/(o+1.)+(-0.605881052086)
        ref[2,3,1,0]=(0.0131810342609)/(o+1.)+(0.20111341807)
        ref[2,3,1,1]=(-1.11244447248)/(o+1.)+(0.448304137186)
        ref[2,3,2,0]=(-0.978348257673)/(o+1.)+(0.75617782326)
        ref[2,3,2,1]=(-0.140801959181)/(o+1.)+(-0.689301157175)
        ref[2,4,0,0]=(-0.733659962936)/(o+1.)+(-0.982769045955)
        ref[2,4,0,1]=(-1.6278906672)/(o+1.)+(-0.0515134159034)
        ref[2,4,1,0]=(1.52117858199)/(o+1.)+(-0.313533423654)
        ref[2,4,1,1]=(0.621221455007)/(o+1.)+(0.661046684337)
        ref[2,4,2,0]=(-0.157580028393)/(o+1.)+(-0.329619724901)
        ref[2,4,2,1]=(0.52303412622)/(o+1.)+(-0.00418831388809)
        ref[3,0,0,0]=(0.337890126112)/(o+1.)+(0.154655235856)
        ref[3,0,0,1]=(-0.100490423466)/(o+1.)+(0.0877941839427)
        ref[3,0,1,0]=(0.37549944857)/(o+1.)+(-0.163565223059)
        ref[3,0,1,1]=(-0.3212149071)/(o+1.)+(0.538924315474)
        ref[3,0,2,0]=(-0.359815373231)/(o+1.)+(0.271747364864)
        ref[3,0,2,1]=(-0.890575856923)/(o+1.)+(-0.151984770865)
        ref[3,1,0,0]=(-1.10384271628)/(o+1.)+(0.256944810546)
        ref[3,1,0,1]=(0.647425296535)/(o+1.)+(-0.348161558551)
        ref[3,1,1,0]=(1.41806770884)/(o+1.)+(-0.211112510685)
        ref[3,1,1,1]=(0.106528838317)/(o+1.)+(-0.302066770953)
        ref[3,1,2,0]=(0.917213295746)/(o+1.)+(0.204325610614)
        ref[3,1,2,1]=(-0.24738513406)/(o+1.)+(-0.0524022055505)
        ref[3,2,0,0]=(-0.0537683888373)/(o+1.)+(0.105427251007)
        ref[3,2,0,1]=(-1.24647336894)/(o+1.)+(-0.00525065347416)
        ref[3,2,1,0]=(0.187132797735)/(o+1.)+(0.230971745898)
        ref[3,2,1,1]=(0.492750417331)/(o+1.)+(-0.0743607257106)
        ref[3,2,2,0]=(0.062835017839)/(o+1.)+(-0.0396102029518)
        ref[3,2,2,1]=(-0.967272854749)/(o+1.)+(0.254924478345)
        ref[3,3,0,0]=(1.41291903854)/(o+1.)+(-0.208458374448)
        ref[3,3,0,1]=(-0.740922121718)/(o+1.)+(0.100332753677)
        ref[3,3,1,0]=(1.2839228132)/(o+1.)+(-0.405680585568)
        ref[3,3,1,1]=(-1.69516258968)/(o+1.)+(-0.69241891756)
        ref[3,3,2,0]=(0.216594952745)/(o+1.)+(0.309112737639)
        ref[3,3,2,1]=(-0.634806027047)/(o+1.)+(0.0728039418712)
        ref[3,4,0,0]=(-0.310491357088)/(o+1.)+(0.315525778146)
        ref[3,4,0,1]=(-0.751915044154)/(o+1.)+(-0.457043209029)
        ref[3,4,1,0]=(-0.339963591836)/(o+1.)+(0.309918338163)
        ref[3,4,1,1]=(0.0720250143477)/(o+1.)+(0.223190077872)
        ref[3,4,2,0]=(-0.0508554115866)/(o+1.)+(-0.0483042552841)
        ref[3,4,2,1]=(0.754037720807)/(o+1.)+(0.163604311813)
      else:
        arg[0,0,0,0]=(-1.24350959032)*x[0]+(-0.580181370761)*x[1]+(-0.174543112173)*x[2]
        arg[0,0,0,1]=(1.43450421585)*x[0]+(0.717062915298)*x[1]+(-0.91866562143)*x[2]
        arg[0,0,1,0]=(0.0188823859409)*x[0]+(1.24568141807)*x[1]+(0.0842604494481)*x[2]
        arg[0,0,1,1]=(0.871591276766)*x[0]+(0.653031319605)*x[1]+(0.037714556611)*x[2]
        arg[0,0,2,0]=(1.60473786555)*x[0]+(1.47509195705)*x[1]+(-0.103485610136)*x[2]
        arg[0,0,2,1]=(1.68030531336)*x[0]+(0.551201281257)*x[1]+(1.26951824468)*x[2]
        arg[0,1,0,0]=(0.491638014782)*x[0]+(1.26264219762)*x[1]+(-0.921297094204)*x[2]
        arg[0,1,0,1]=(0.20108233628)*x[0]+(-1.36096031252)*x[1]+(-0.878077046379)*x[2]
        arg[0,1,1,0]=(0.900775475455)*x[0]+(0.193423726606)*x[1]+(-0.139955126775)*x[2]
        arg[0,1,1,1]=(-0.0354326925578)*x[0]+(-0.464646718718)*x[1]+(1.49240476583)*x[2]
        arg[0,1,2,0]=(-1.40991971664)*x[0]+(-1.7747715584)*x[1]+(-0.96387650203)*x[2]
        arg[0,1,2,1]=(-0.476443682267)*x[0]+(0.55076135194)*x[1]+(0.190289559512)*x[2]
        arg[0,2,0,0]=(0.535490315669)*x[0]+(0.566915366497)*x[1]+(-0.41513643529)*x[2]
        arg[0,2,0,1]=(-0.18986562478)*x[0]+(-0.62347050233)*x[1]+(1.18004907973)*x[2]
        arg[0,2,1,0]=(-0.288440432828)*x[0]+(0.0375642125411)*x[1]+(0.574653643212)*x[2]
        arg[0,2,1,1]=(1.03327739612)*x[0]+(-0.0443874572943)*x[1]+(0.972142765323)*x[2]
        arg[0,2,2,0]=(-1.27131901306)*x[0]+(0.619179457229)*x[1]+(-0.436029340417)*x[2]
        arg[0,2,2,1]=(0.0573099137019)*x[0]+(0.211373076629)*x[1]+(0.859991510967)*x[2]
        arg[0,3,0,0]=(0.650974277613)*x[0]+(-0.926352792387)*x[1]+(-1.84479828618)*x[2]
        arg[0,3,0,1]=(-0.293748564815)*x[0]+(0.53683587198)*x[1]+(1.51147453744)*x[2]
        arg[0,3,1,0]=(0.837889627485)*x[0]+(0.62568225238)*x[1]+(0.365321068424)*x[2]
        arg[0,3,1,1]=(-0.671841278343)*x[0]+(-0.00822894090357)*x[1]+(-1.35180265459)*x[2]
        arg[0,3,2,0]=(0.823443588183)*x[0]+(-0.366903894987)*x[1]+(-0.878402795844)*x[2]
        arg[0,3,2,1]=(-0.856292830088)*x[0]+(-0.134584368493)*x[1]+(-0.299126849425)*x[2]
        arg[0,4,0,0]=(0.62792423481)*x[0]+(0.781414088068)*x[1]+(-1.12299220031)*x[2]
        arg[0,4,0,1]=(-0.00743646774917)*x[0]+(0.52784004028)*x[1]+(-1.44284109205)*x[2]
        arg[0,4,1,0]=(-0.855519018884)*x[0]+(-0.222306698876)*x[1]+(0.0502517275952)*x[2]
        arg[0,4,1,1]=(-0.311060622512)*x[0]+(0.321283094479)*x[1]+(-0.484147152851)*x[2]
        arg[0,4,2,0]=(-1.43220161062)*x[0]+(-0.27822988291)*x[1]+(-0.692367106541)*x[2]
        arg[0,4,2,1]=(1.3956686934)*x[0]+(-1.26426333906)*x[1]+(-1.09343602989)*x[2]
        arg[1,0,0,0]=(0.122525927098)*x[0]+(-0.484009414389)*x[1]+(-0.822036495419)*x[2]
        arg[1,0,0,1]=(-0.276748173334)*x[0]+(0.35307031133)*x[1]+(-1.23466402387)*x[2]
        arg[1,0,1,0]=(-0.479355493223)*x[0]+(-0.56368304348)*x[1]+(0.54679107219)*x[2]
        arg[1,0,1,1]=(-0.483618214285)*x[0]+(1.60438722757)*x[1]+(0.542389963596)*x[2]
        arg[1,0,2,0]=(0.130988624202)*x[0]+(-0.449468495509)*x[1]+(0.254640520023)*x[2]
        arg[1,0,2,1]=(1.13790232796)*x[0]+(-0.716218913004)*x[1]+(-0.193031264955)*x[2]
        arg[1,1,0,0]=(-0.0653152151059)*x[0]+(1.07890922508)*x[1]+(0.324995864884)*x[2]
        arg[1,1,0,1]=(0.769151345051)*x[0]+(-1.35911748672)*x[1]+(0.299326803785)*x[2]
        arg[1,1,1,0]=(-0.431128032697)*x[0]+(1.09261915758)*x[1]+(-0.029871998484)*x[2]
        arg[1,1,1,1]=(-0.922618915502)*x[0]+(1.30318141394)*x[1]+(-0.324039981399)*x[2]
        arg[1,1,2,0]=(-0.668178375077)*x[0]+(0.132203602988)*x[1]+(0.236035070297)*x[2]
        arg[1,1,2,1]=(-0.518594419598)*x[0]+(-0.0429695477263)*x[1]+(1.11877941395)*x[2]
        arg[1,2,0,0]=(0.610776644247)*x[0]+(-0.023900598958)*x[1]+(0.0480141870788)*x[2]
        arg[1,2,0,1]=(0.562736426016)*x[0]+(-0.294969624732)*x[1]+(-0.23898469143)*x[2]
        arg[1,2,1,0]=(0.645173726197)*x[0]+(-1.18365074993)*x[1]+(0.102581636468)*x[2]
        arg[1,2,1,1]=(-0.518976597355)*x[0]+(0.372817596528)*x[1]+(0.49035249397)*x[2]
        arg[1,2,2,0]=(0.0192623731103)*x[0]+(-0.241279406644)*x[1]+(-0.420015571981)*x[2]
        arg[1,2,2,1]=(0.318641827599)*x[0]+(-1.5357263392)*x[1]+(0.350150621892)*x[2]
        arg[1,3,0,0]=(-0.719401628191)*x[0]+(-1.77806447133)*x[1]+(1.19750443209)*x[2]
        arg[1,3,0,1]=(-1.00122204304)*x[0]+(0.675162216383)*x[1]+(1.1180105058)*x[2]
        arg[1,3,1,0]=(0.331149947519)*x[0]+(0.310832741708)*x[1]+(0.087866556795)*x[2]
        arg[1,3,1,1]=(-0.156343054316)*x[0]+(1.00796776488)*x[1]+(-1.53460740228)*x[2]
        arg[1,3,2,0]=(0.714240747972)*x[0]+(0.968170992322)*x[1]+(-0.962819191598)*x[2]
        arg[1,3,2,1]=(-0.200412114379)*x[0]+(-0.173781234544)*x[1]+(0.899584749309)*x[2]
        arg[1,4,0,0]=(-1.38011177642)*x[0]+(-0.316506470647)*x[1]+(0.266952180469)*x[2]
        arg[1,4,0,1]=(0.343359684584)*x[0]+(-1.13244466712)*x[1]+(-0.81840155125)*x[2]
        arg[1,4,1,0]=(0.295299129957)*x[0]+(0.199810907018)*x[1]+(0.631717407771)*x[2]
        arg[1,4,1,1]=(-0.46840784478)*x[0]+(-0.402683932206)*x[1]+(-0.782209293177)*x[2]
        arg[1,4,2,0]=(-1.8006389736)*x[0]+(0.119727360087)*x[1]+(0.482076626168)*x[2]
        arg[1,4,2,1]=(0.96553885281)*x[0]+(0.425097333238)*x[1]+(0.54533551085)*x[2]
        arg[2,0,0,0]=(0.932725602425)*x[0]+(-0.513780652569)*x[1]+(0.275742915648)*x[2]
        arg[2,0,0,1]=(1.10053578072)*x[0]+(0.787895323287)*x[1]+(-1.46544221328)*x[2]
        arg[2,0,1,0]=(0.83657269666)*x[0]+(-1.15717482853)*x[1]+(1.1090271297)*x[2]
        arg[2,0,1,1]=(1.59370135994)*x[0]+(0.452015708845)*x[1]+(0.0862230059082)*x[2]
        arg[2,0,2,0]=(-0.954832509866)*x[0]+(0.51192257473)*x[1]+(-1.48499771643)*x[2]
        arg[2,0,2,1]=(-0.556993361475)*x[0]+(0.438110051421)*x[1]+(0.237254018143)*x[2]
        arg[2,1,0,0]=(-0.318980966383)*x[0]+(-0.263071719097)*x[1]+(-0.348122442404)*x[2]
        arg[2,1,0,1]=(0.100191287326)*x[0]+(-0.422996999974)*x[1]+(-0.850702087112)*x[2]
        arg[2,1,1,0]=(-0.198942237141)*x[0]+(0.277459568173)*x[1]+(-1.66195774421)*x[2]
        arg[2,1,1,1]=(-1.62211381863)*x[0]+(-0.13417844308)*x[1]+(1.07441481356)*x[2]
        arg[2,1,2,0]=(-0.183120762554)*x[0]+(-0.158546687568)*x[1]+(1.05938565108)*x[2]
        arg[2,1,2,1]=(-0.530596736933)*x[0]+(-0.507872303289)*x[1]+(0.0437745116021)*x[2]
        arg[2,2,0,0]=(-0.430338834548)*x[0]+(-1.01989755268)*x[1]+(0.0364152729771)*x[2]
        arg[2,2,0,1]=(-0.55129175645)*x[0]+(0.283907226465)*x[1]+(0.281403899376)*x[2]
        arg[2,2,1,0]=(0.119036949181)*x[0]+(0.187265158741)*x[1]+(-0.0845814658663)*x[2]
        arg[2,2,1,1]=(1.39900884968)*x[0]+(1.42806588781)*x[1]+(0.211444691268)*x[2]
        arg[2,2,2,0]=(-0.609664666581)*x[0]+(-0.29988332429)*x[1]+(-0.28125800646)*x[2]
        arg[2,2,2,1]=(-1.77545247157)*x[0]+(0.337828315779)*x[1]+(-0.239141292616)*x[2]
        arg[2,3,0,0]=(-1.23141604656)*x[0]+(0.322998749903)*x[1]+(-1.70685281816)*x[2]
        arg[2,3,0,1]=(-1.4416737434)*x[0]+(1.49740114642)*x[1]+(0.732057753882)*x[2]
        arg[2,3,1,0]=(-1.59112622077)*x[0]+(0.665317566947)*x[1]+(0.826417253499)*x[2]
        arg[2,3,1,1]=(-1.22000830454)*x[0]+(0.618713896065)*x[1]+(1.27354984534)*x[2]
        arg[2,3,2,0]=(0.125639723221)*x[0]+(0.663241510656)*x[1]+(-0.426459288281)*x[2]
        arg[2,3,2,1]=(1.39120212155)*x[0]+(0.9115748844)*x[1]+(1.77889030223)*x[2]
        arg[2,4,0,0]=(-0.217927656387)*x[0]+(1.20391185439)*x[1]+(-0.188197734908)*x[2]
        arg[2,4,0,1]=(-0.442009082947)*x[0]+(0.399477101959)*x[1]+(-1.33974368956)*x[2]
        arg[2,4,1,0]=(0.636534809382)*x[0]+(0.872923470503)*x[1]+(-0.922286702006)*x[2]
        arg[2,4,1,1]=(-0.831840624431)*x[0]+(0.946223248622)*x[1]+(0.380300039133)*x[2]
        arg[2,4,2,0]=(0.0803088903901)*x[0]+(-0.857685204574)*x[1]+(-0.479475079431)*x[2]
        arg[2,4,2,1]=(-1.7233942516)*x[0]+(-1.38771345941)*x[1]+(0.761958201633)*x[2]
        arg[3,0,0,0]=(-0.738032075796)*x[0]+(1.33264583681)*x[1]+(-1.21101988385)*x[2]
        arg[3,0,0,1]=(1.40336327022)*x[0]+(-0.77078885213)*x[1]+(1.70960627204)*x[2]
        arg[3,0,1,0]=(0.452477629041)*x[0]+(0.235432009434)*x[1]+(1.69314009822)*x[2]
        arg[3,0,1,1]=(-0.816213143646)*x[0]+(-1.42050350309)*x[1]+(-0.0806105456758)*x[2]
        arg[3,0,2,0]=(0.0400708086023)*x[0]+(-0.336948609628)*x[1]+(-0.113687293995)*x[2]
        arg[3,0,2,1]=(0.414077492095)*x[0]+(-1.06937716207)*x[1]+(1.25972041173)*x[2]
        arg[3,1,0,0]=(-1.02975555201)*x[0]+(-0.123306171085)*x[1]+(-1.74750909033)*x[2]
        arg[3,1,0,1]=(-1.01988698009)*x[0]+(-0.142188487205)*x[1]+(0.274514515492)*x[2]
        arg[3,1,1,0]=(0.440626586141)*x[0]+(-0.0569580581917)*x[1]+(-0.77065631367)*x[2]
        arg[3,1,1,1]=(0.987903067972)*x[0]+(-1.47543187274)*x[1]+(-0.0888962732893)*x[2]
        arg[3,1,2,0]=(0.150506204416)*x[0]+(0.035476396146)*x[1]+(-0.852061690418)*x[2]
        arg[3,1,2,1]=(-1.15179800132)*x[0]+(-0.425570974979)*x[1]+(1.10092214699)*x[2]
        arg[3,2,0,0]=(1.01255188057)*x[0]+(1.24279465527)*x[1]+(1.25190246102)*x[2]
        arg[3,2,0,1]=(-1.16275538385)*x[0]+(1.13672085108)*x[1]+(0.131953731231)*x[2]
        arg[3,2,1,0]=(0.774290747173)*x[0]+(0.275410883089)*x[1]+(-0.825692266439)*x[2]
        arg[3,2,1,1]=(-1.07241838074)*x[0]+(-0.0974675737726)*x[1]+(1.1856849697)*x[2]
        arg[3,2,2,0]=(0.234209248938)*x[0]+(0.756893234577)*x[1]+(-0.365141055079)*x[2]
        arg[3,2,2,1]=(-1.6668858309)*x[0]+(-0.916769120288)*x[1]+(-0.716365681217)*x[2]
        arg[3,3,0,0]=(-0.36890215249)*x[0]+(-0.581062815398)*x[1]+(1.6280164507)*x[2]
        arg[3,3,0,1]=(-0.933634743559)*x[0]+(-0.0657657779145)*x[1]+(1.35011362804)*x[2]
        arg[3,3,1,0]=(1.13739289322)*x[0]+(0.0103208127738)*x[1]+(1.01628193014)*x[2]
        arg[3,3,1,1]=(0.037979696459)*x[0]+(-1.76926650495)*x[1]+(-1.28602572757)*x[2]
        arg[3,3,2,0]=(0.797830431467)*x[0]+(0.732108360923)*x[1]+(-0.436390867333)*x[2]
        arg[3,3,2,1]=(-0.571865447888)*x[0]+(0.895109047357)*x[1]+(-0.673234648776)*x[2]
        arg[3,4,0,0]=(-1.59667195158)*x[0]+(-1.06146105331)*x[1]+(-1.81255923783)*x[2]
        arg[3,4,0,1]=(-0.0721327214647)*x[0]+(1.23982376787)*x[1]+(1.43101011)*x[2]
        arg[3,4,1,0]=(0.117288395573)*x[0]+(-0.37678966212)*x[1]+(-1.14107285089)*x[2]
        arg[3,4,1,1]=(-0.303270532321)*x[0]+(1.33784402324)*x[1]+(-0.651624796413)*x[2]
        arg[3,4,2,0]=(0.215849013256)*x[0]+(0.247315697644)*x[1]+(0.404644392153)*x[2]
        arg[3,4,2,1]=(0.975781190478)*x[0]+(-0.252285063767)*x[1]+(-0.145694910854)*x[2]
        ref[0,0,0,0]=(-0.718934738033)/(o+1.)+(-0.639649667608)
        ref[0,0,0,1]=(1.01007662915)/(o+1.)+(0.111412440284)
        ref[0,0,1,0]=(0.827868953278)/(o+1.)+(0.26047765009)
        ref[0,0,1,1]=(1.48122352358)/(o+1.)+(0.0405568147034)
        ref[0,0,2,0]=(1.33282099436)/(o+1.)+(0.821761609054)
        ref[0,0,2,1]=(1.65298089862)/(o+1.)+(0.924021970342)
        ref[0,1,0,0]=(0.930162571453)/(o+1.)+(-0.0485897266263)
        ref[0,1,0,1]=(-0.347599158269)/(o+1.)+(-0.845177932176)
        ref[0,1,1,0]=(0.623152121663)/(o+1.)+(0.165545976811)
        ref[0,1,1,1]=(0.0506217690841)/(o+1.)+(0.470851792737)
        ref[0,1,2,0]=(-1.99181491207)/(o+1.)+(-1.0783764325)
        ref[0,1,2,1]=(-0.731065007801)/(o+1.)+(0.497836118493)
        ref[0,2,0,0]=(-0.0812249009151)/(o+1.)+(0.384247073896)
        ref[0,2,0,1]=(-0.115768505253)/(o+1.)+(0.241240728938)
        ref[0,2,1,0]=(0.152728009607)/(o+1.)+(0.0855247066589)
        ref[0,2,1,1]=(1.43086526503)/(o+1.)+(0.265083719563)
        ref[0,2,2,0]=(-0.967906369418)/(o+1.)+(-0.060131263415)
        ref[0,2,2,1]=(-0.269269238419)/(o+1.)+(0.698971869859)
        ref[0,3,0,0]=(-1.71659801402)/(o+1.)+(-0.201789393467)
        ref[0,3,0,1]=(0.265343635273)/(o+1.)+(0.744609104665)
        ref[0,3,1,0]=(1.83021875237)/(o+1.)+(-0.000662902039879)
        ref[0,3,1,1]=(-0.317529833375)/(o+1.)+(-0.857171520229)
        ref[0,3,2,0]=(-0.705757693524)/(o+1.)+(0.141947295438)
        ref[0,3,2,1]=(-1.27000495392)/(o+1.)+(-0.00999954704202)
        ref[0,4,0,0]=(0.061892522425)/(o+1.)+(0.112226800069)
        ref[0,4,0,1]=(-0.747062267148)/(o+1.)+(-0.0876876261864)
        ref[0,4,1,0]=(-1.19488448842)/(o+1.)+(0.0836552491261)
        ref[0,4,1,1]=(1.36573976292)/(o+1.)+(-0.9198322219)
        ref[0,4,2,0]=(-1.67982141697)/(o+1.)+(-0.361488591554)
        ref[0,4,2,1]=(-0.598050084547)/(o+1.)+(-0.181990295501)
        ref[1,0,0,0]=(-2.45927674426)/(o+1.)+(0.637878380777)
        ref[1,0,0,1]=(-0.575223026885)/(o+1.)+(-0.291559429493)
        ref[1,0,1,0]=(0.0871765959469)/(o+1.)+(-0.29171203023)
        ref[1,0,1,1]=(0.94050575309)/(o+1.)+(0.361326611893)
        ref[1,0,2,0]=(-0.306500880914)/(o+1.)+(0.121330764815)
        ref[1,0,2,1]=(1.60748296414)/(o+1.)+(-0.689415407072)
        ref[1,1,0,0]=(0.640401899755)/(o+1.)+(0.34909398755)
        ref[1,1,0,1]=(0.134022909144)/(o+1.)+(-0.212331123516)
        ref[1,1,1,0]=(0.248008519593)/(o+1.)+(0.191805303402)
        ref[1,1,1,1]=(0.638911732328)/(o+1.)+(-0.291194607647)
        ref[1,1,2,0]=(0.109264462855)/(o+1.)+(-0.204602082323)
        ref[1,1,2,1]=(-0.185963112656)/(o+1.)+(0.371589279643)
        ref[1,2,0,0]=(-0.590669733193)/(o+1.)+(0.61277998278)
        ref[1,2,0,1]=(-1.15856908266)/(o+1.)+(0.593675596257)
        ref[1,2,1,0]=(-0.451642187813)/(o+1.)+(0.00787340027166)
        ref[1,2,1,1]=(-0.428757501259)/(o+1.)+(0.386475497201)
        ref[1,2,2,0]=(-0.414532914271)/(o+1.)+(-0.113749845622)
        ref[1,2,2,1]=(-0.513613710163)/(o+1.)+(-0.176660089771)
        ref[1,3,0,0]=(-0.890487934256)/(o+1.)+(-0.20473686659)
        ref[1,3,0,1]=(1.64512779208)/(o+1.)+(-0.426588556466)
        ref[1,3,1,0]=(0.831527595966)/(o+1.)+(-0.0508391749725)
        ref[1,3,1,1]=(-0.718921003194)/(o+1.)+(0.0179691557385)
        ref[1,3,2,0]=(0.405959213301)/(o+1.)+(0.156816667697)
        ref[1,3,2,1]=(0.426319486322)/(o+1.)+(0.0495359570318)
        ref[1,4,0,0]=(-1.11364330874)/(o+1.)+(-0.158011378929)
        ref[1,4,0,1]=(-0.0993967101457)/(o+1.)+(-0.754044911817)
        ref[1,4,1,0]=(0.979493241598)/(o+1.)+(0.0736671015741)
        ref[1,4,1,1]=(-1.78692478393)/(o+1.)+(0.0668118568857)
        ref[1,4,2,0]=(-0.691473647622)/(o+1.)+(-0.253680669863)
        ref[1,4,2,1]=(1.16914997228)/(o+1.)+(0.383410862311)
        ref[2,0,0,0]=(0.790187638399)/(o+1.)+(-0.047749886448)
        ref[2,0,0,1]=(0.429625240932)/(o+1.)+(-0.00331817510394)
        ref[2,0,1,0]=(-0.101344997877)/(o+1.)+(0.444884997853)
        ref[2,0,1,1]=(2.15519953039)/(o+1.)+(-0.0116297278494)
        ref[2,0,2,0]=(-1.40159594866)/(o+1.)+(-0.263155851453)
        ref[2,0,2,1]=(-0.658391287862)/(o+1.)+(0.388380997976)
        ref[2,1,0,0]=(-0.773933630328)/(o+1.)+(-0.0781207487777)
        ref[2,1,0,1]=(0.0015551432788)/(o+1.)+(-0.587531471519)
        ref[2,1,1,0]=(0.122693324758)/(o+1.)+(-0.853066868967)
        ref[2,1,1,1]=(-0.219255630453)/(o+1.)+(-0.231310908847)
        ref[2,1,2,0]=(1.33176471286)/(o+1.)+(-0.307023255951)
        ref[2,1,2,1]=(-1.67471265259)/(o+1.)+(0.340009061986)
        ref[2,2,0,0]=(-0.727222063897)/(o+1.)+(-0.343299525178)
        ref[2,2,0,1]=(-1.87667590405)/(o+1.)+(0.945347636719)
        ref[2,2,1,0]=(0.776003927859)/(o+1.)+(-0.277141642902)
        ref[2,2,1,1]=(1.62850322537)/(o+1.)+(0.705008101698)
        ref[2,2,2,0]=(1.31869548331)/(o+1.)+(-1.25475074032)
        ref[2,2,2,1]=(-1.71691241115)/(o+1.)+(0.0200734813728)
        ref[2,3,0,0]=(-0.37741220744)/(o+1.)+(-1.11892895368)
        ref[2,3,0,1]=(0.684763737686)/(o+1.)+(0.0515107096073)
        ref[2,3,1,0]=(-0.0572023243047)/(o+1.)+(-0.0210945380092)
        ref[2,3,1,1]=(0.031457290932)/(o+1.)+(0.320399072966)
        ref[2,3,2,0]=(-0.71613334286)/(o+1.)+(0.539277644228)
        ref[2,3,2,1]=(2.10068005021)/(o+1.)+(0.990493628981)
        ref[2,4,0,0]=(0.830379294407)/(o+1.)+(-0.016296415655)
        ref[2,4,0,1]=(-1.05197706105)/(o+1.)+(-0.165149304749)
        ref[2,4,1,0]=(-0.0854959336547)/(o+1.)+(0.336333755767)
        ref[2,4,1,1]=(1.15845594915)/(o+1.)+(-0.331886642912)
        ref[2,4,2,0]=(-1.25248721318)/(o+1.)+(-0.00218209021539)
        ref[2,4,2,1]=(-0.991752052473)/(o+1.)+(-0.678698728452)
        ref[3,0,0,0]=(-0.262071815816)/(o+1.)+(-0.177167153508)
        ref[3,0,0,1]=(1.20598261029)/(o+1.)+(0.568099039922)
        ref[3,0,1,0]=(1.21237099375)/(o+1.)+(0.584339371474)
        ref[3,0,1,1]=(-1.04628498282)/(o+1.)+(-0.635521104799)
        ref[3,0,2,0]=(0.630843868383)/(o+1.)+(-0.520704481702)
        ref[3,0,2,1]=(1.56136208039)/(o+1.)+(-0.478470669318)
        ref[3,1,0,0]=(-0.372752943047)/(o+1.)+(-1.26390893519)
        ref[3,1,0,1]=(0.192139112377)/(o+1.)+(-0.53985003209)
        ref[3,1,1,0]=(-1.18480584023)/(o+1.)+(0.398909027255)
        ref[3,1,1,1]=(0.402069277892)/(o+1.)+(-0.489247177975)
        ref[3,1,2,0]=(0.27608763117)/(o+1.)+(-0.471083360513)
        ref[3,1,2,1]=(-0.273636427696)/(o+1.)+(-0.101405200809)
        ref[3,2,0,0]=(1.92572771773)/(o+1.)+(0.790760639563)
        ref[3,2,0,1]=(0.16264122626)/(o+1.)+(-0.0283610138982)
        ref[3,2,1,0]=(0.377561018039)/(o+1.)+(-0.076775827108)
        ref[3,2,1,1]=(-0.652466873272)/(o+1.)+(0.334132944227)
        ref[3,2,2,0]=(-0.0304721826842)/(o+1.)+(0.32821680556)
        ref[3,2,2,1]=(-1.52932569088)/(o+1.)+(-0.885347470761)
        ref[3,3,0,0]=(-0.451938162279)/(o+1.)+(0.564994822546)
        ref[3,3,0,1]=(-0.477583137662)/(o+1.)+(0.414148122113)
        ref[3,3,1,0]=(1.38037325689)/(o+1.)+(0.391811189625)
        ref[3,3,1,1]=(-1.01333159097)/(o+1.)+(-1.00199047255)
        ref[3,3,2,0]=(1.3222644334)/(o+1.)+(-0.114358254173)
        ref[3,3,2,1]=(-0.248989333346)/(o+1.)+(-0.0505008579799)
        ref[3,4,0,0]=(-1.92196761736)/(o+1.)+(-1.27436231268)
        ref[3,4,0,1]=(0.894404962457)/(o+1.)+(0.852148096971)
        ref[3,4,1,0]=(0.868763436571)/(o+1.)+(-1.134668777)
        ref[3,4,1,1]=(0.438747123022)/(o+1.)+(-0.0278992142568)
        ref[3,4,2,0]=(0.532575431402)/(o+1.)+(0.167616835826)
        ref[3,4,2,1]=(0.796744496799)/(o+1.)+(-0.109471640471)
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Function_rank0(self):
      """
      tests integral of rank 0 Data on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.217470460227)*x[0]**o+(0.664132905811)*x[0]+(0.493878617743)*x[1]**o+(0.111327715714)*x[1]
        ref=(0.276408157516)/(o+1.)+(0.387730310763)
      else:
        arg=(0.371937838886)*x[0]**o+(0.653846807778)*x[0]+(0.172358058188)*x[1]**o+(-0.928017916614)*x[1]+(0.116156616174)*x[2]**o+(0.371332501889)*x[2]
        ref=(0.660452513249)/(o+1.)+(0.0485806965265)
      res=integrate(arg)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Function_rank1(self):
      """
      tests integral of rank 1 Data on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(-0.329952046701)*x[0]**o+(0.12757022314)*x[0]+(0.198280362833)*x[1]**o+(0.129179854334)*x[1]
        arg[1]=(0.185895161332)*x[0]**o+(0.270740935936)*x[0]+(0.630122833594)*x[1]**o+(-0.0696403698787)*x[1]
        ref[0]=(-0.131671683869)/(o+1.)+(0.128375038737)
        ref[1]=(0.816017994925)/(o+1.)+(0.100550283029)
      else:
        arg[0]=(0.526257699936)*x[0]**o+(0.0731442796396)*x[0]+(-0.266121642119)*x[1]**o+(-0.929478242136)*x[1]+(0.743092861949)*x[2]**o+(0.22690419858)*x[2]
        arg[1]=(-0.121387039147)*x[0]**o+(-0.0580608263784)*x[0]+(0.761164059949)*x[1]**o+(0.821938972431)*x[1]+(-0.756423175962)*x[2]**o+(0.213207132353)*x[2]
        ref[0]=(1.00322891977)/(o+1.)+(-0.314714881958)
        ref[1]=(-0.11664615516)/(o+1.)+(0.488542639203)
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Function_rank2(self):
      """
      tests integral of rank 2 Data on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.963318847499)*x[0]**o+(-0.184977238308)*x[0]+(0.153633231879)*x[1]**o+(-0.640028315216)*x[1]
        arg[0,1]=(0.0879103656102)*x[0]**o+(-0.928854425726)*x[0]+(-0.138566176095)*x[1]**o+(-0.670118398936)*x[1]
        arg[0,2]=(0.920856326204)*x[0]**o+(0.461047594595)*x[0]+(-0.914778320363)*x[1]**o+(-0.561644217568)*x[1]
        arg[0,3]=(0.506148289443)*x[0]**o+(-0.474044343536)*x[0]+(0.742127575836)*x[1]**o+(-0.52349314159)*x[1]
        arg[0,4]=(0.0810224543145)*x[0]**o+(-0.307992483498)*x[0]+(0.749673245291)*x[1]**o+(-0.554099873044)*x[1]
        arg[1,0]=(-0.270897099553)*x[0]**o+(-0.222178461886)*x[0]+(0.755729049844)*x[1]**o+(0.740743777894)*x[1]
        arg[1,1]=(0.0220934176819)*x[0]**o+(-0.309641658323)*x[0]+(-0.951833592348)*x[1]**o+(0.430554526918)*x[1]
        arg[1,2]=(0.176033311218)*x[0]**o+(0.728188001962)*x[0]+(-0.428357954006)*x[1]**o+(0.955059500699)*x[1]
        arg[1,3]=(0.946680422474)*x[0]**o+(-0.251968148743)*x[0]+(-0.3704600461)*x[1]**o+(0.692080922297)*x[1]
        arg[1,4]=(0.122655375591)*x[0]**o+(0.617285886533)*x[0]+(0.729184247986)*x[1]**o+(0.30369620264)*x[1]
        arg[2,0]=(-0.957780501271)*x[0]**o+(0.438290429468)*x[0]+(-0.504841431279)*x[1]**o+(0.935350834608)*x[1]
        arg[2,1]=(-0.49410765407)*x[0]**o+(-0.635142349002)*x[0]+(0.700131616572)*x[1]**o+(0.99523209861)*x[1]
        arg[2,2]=(0.0967686936303)*x[0]**o+(0.987754073381)*x[0]+(-0.161220173386)*x[1]**o+(-0.343926097784)*x[1]
        arg[2,3]=(0.560040886628)*x[0]**o+(-0.843778720323)*x[0]+(0.345354034369)*x[1]**o+(0.440584543858)*x[1]
        arg[2,4]=(0.988977815245)*x[0]**o+(0.661922598357)*x[0]+(-0.425421002549)*x[1]**o+(0.624279872655)*x[1]
        arg[3,0]=(-0.997217068098)*x[0]**o+(-0.973497091595)*x[0]+(-0.0980683851598)*x[1]**o+(0.408081557041)*x[1]
        arg[3,1]=(0.0827616522414)*x[0]**o+(0.931022772362)*x[0]+(-0.588688206358)*x[1]**o+(0.900467348992)*x[1]
        arg[3,2]=(0.0933642874383)*x[0]**o+(0.398732664158)*x[0]+(-0.437102212783)*x[1]**o+(-0.126538302466)*x[1]
        arg[3,3]=(0.251989644486)*x[0]**o+(0.765809815972)*x[0]+(-0.325455283605)*x[1]**o+(0.171819372538)*x[1]
        arg[3,4]=(0.649407682145)*x[0]**o+(0.963776897105)*x[0]+(0.671915752131)*x[1]**o+(-0.468729629153)*x[1]
        ref[0,0]=(-0.80968561562)/(o+1.)+(-0.412502776762)
        ref[0,1]=(-0.0506558104848)/(o+1.)+(-0.799486412331)
        ref[0,2]=(0.00607800584081)/(o+1.)+(-0.0502983114867)
        ref[0,3]=(1.24827586528)/(o+1.)+(-0.498768742563)
        ref[0,4]=(0.830695699605)/(o+1.)+(-0.431046178271)
        ref[1,0]=(0.484831950292)/(o+1.)+(0.259282658004)
        ref[1,1]=(-0.929740174666)/(o+1.)+(0.0604564342974)
        ref[1,2]=(-0.252324642788)/(o+1.)+(0.84162375133)
        ref[1,3]=(0.576220376373)/(o+1.)+(0.220056386777)
        ref[1,4]=(0.851839623577)/(o+1.)+(0.460491044586)
        ref[2,0]=(-1.46262193255)/(o+1.)+(0.686820632038)
        ref[2,1]=(0.206023962501)/(o+1.)+(0.180044874804)
        ref[2,2]=(-0.0644514797559)/(o+1.)+(0.321913987798)
        ref[2,3]=(0.905394920997)/(o+1.)+(-0.201597088233)
        ref[2,4]=(0.563556812695)/(o+1.)+(0.643101235506)
        ref[3,0]=(-1.09528545326)/(o+1.)+(-0.282707767277)
        ref[3,1]=(-0.505926554117)/(o+1.)+(0.915745060677)
        ref[3,2]=(-0.343737925345)/(o+1.)+(0.136097180846)
        ref[3,3]=(-0.0734656391194)/(o+1.)+(0.468814594255)
        ref[3,4]=(1.32132343428)/(o+1.)+(0.247523633976)
      else:
        arg[0,0]=(-0.512698606017)*x[0]**o+(-0.156853163498)*x[0]+(0.247997355633)*x[1]**o+(-0.363003068904)*x[1]+(-0.940097989108)*x[2]**o+(-0.661063850288)*x[2]
        arg[0,1]=(-0.886390181577)*x[0]**o+(0.724049511142)*x[0]+(0.260684592163)*x[1]**o+(0.265648885034)*x[1]+(0.123084281693)*x[2]**o+(0.181492979151)*x[2]
        arg[0,2]=(-0.570543998851)*x[0]**o+(0.0541041165388)*x[0]+(0.630994990544)*x[1]**o+(-0.89311079559)*x[1]+(0.750714073617)*x[2]**o+(-0.0684796380527)*x[2]
        arg[0,3]=(0.605486031268)*x[0]**o+(0.0387617487672)*x[0]+(-0.365027101406)*x[1]**o+(0.323275180514)*x[1]+(-0.763142660003)*x[2]**o+(-0.331069480921)*x[2]
        arg[0,4]=(-0.0779035848472)*x[0]**o+(-0.0234904624931)*x[0]+(0.591635786678)*x[1]**o+(-0.793680126332)*x[1]+(-0.874742296757)*x[2]**o+(-0.184528885157)*x[2]
        arg[1,0]=(-0.62480972544)*x[0]**o+(-0.99242215547)*x[0]+(0.634250679117)*x[1]**o+(-0.785448642692)*x[1]+(-0.013335654402)*x[2]**o+(0.52112750417)*x[2]
        arg[1,1]=(0.611541580179)*x[0]**o+(-0.203144044802)*x[0]+(-0.411277184995)*x[1]**o+(0.373487145939)*x[1]+(-0.679339345026)*x[2]**o+(-0.632413536218)*x[2]
        arg[1,2]=(-0.258927016205)*x[0]**o+(0.0242628959926)*x[0]+(-0.596909760383)*x[1]**o+(-0.295787354787)*x[1]+(-0.337930022823)*x[2]**o+(-0.825085100446)*x[2]
        arg[1,3]=(-0.0976663781507)*x[0]**o+(0.716600132838)*x[0]+(-0.682155341898)*x[1]**o+(-0.154484864167)*x[1]+(0.754686874908)*x[2]**o+(-0.102453470268)*x[2]
        arg[1,4]=(0.268714339964)*x[0]**o+(0.974234398844)*x[0]+(-0.370113158384)*x[1]**o+(0.0745228956861)*x[1]+(-0.0674370676047)*x[2]**o+(0.132605448278)*x[2]
        arg[2,0]=(-0.00750893262562)*x[0]**o+(0.507641887134)*x[0]+(0.638483932117)*x[1]**o+(-0.940295540912)*x[1]+(-0.201492519698)*x[2]**o+(0.504878595818)*x[2]
        arg[2,1]=(-0.0283522980593)*x[0]**o+(-0.76577346605)*x[0]+(0.0863472830598)*x[1]**o+(-0.904447859187)*x[1]+(-0.203390005492)*x[2]**o+(-0.741629136645)*x[2]
        arg[2,2]=(-0.0196123831667)*x[0]**o+(-0.320721372799)*x[0]+(0.0670421287749)*x[1]**o+(-0.415029682416)*x[1]+(0.450269143475)*x[2]**o+(-0.735201210502)*x[2]
        arg[2,3]=(-0.621537330758)*x[0]**o+(0.21573881897)*x[0]+(0.0364275955835)*x[1]**o+(0.873908952751)*x[1]+(-0.197046790303)*x[2]**o+(0.655654722165)*x[2]
        arg[2,4]=(0.432531007791)*x[0]**o+(-0.65605251166)*x[0]+(0.728245204833)*x[1]**o+(-0.769998936989)*x[1]+(-0.797879623133)*x[2]**o+(0.36575554332)*x[2]
        arg[3,0]=(0.512219734043)*x[0]**o+(-0.177942735603)*x[0]+(-0.307293350237)*x[1]**o+(-0.780181541911)*x[1]+(-0.510201727643)*x[2]**o+(-0.567980715525)*x[2]
        arg[3,1]=(-0.405123989366)*x[0]**o+(-0.133316566583)*x[0]+(0.552868689995)*x[1]**o+(-0.921149434884)*x[1]+(0.510851078054)*x[2]**o+(0.7207533866)*x[2]
        arg[3,2]=(0.150011788901)*x[0]**o+(-0.55947555552)*x[0]+(-0.353366762442)*x[1]**o+(0.204954197301)*x[1]+(-0.48254632377)*x[2]**o+(-0.272738900127)*x[2]
        arg[3,3]=(-0.690981207461)*x[0]**o+(0.38683432128)*x[0]+(0.655731808738)*x[1]**o+(0.162269870301)*x[1]+(-0.373468659959)*x[2]**o+(-0.841431521009)*x[2]
        arg[3,4]=(0.156455675319)*x[0]**o+(0.501690084272)*x[0]+(-0.339255791314)*x[1]**o+(0.0832260784264)*x[1]+(0.394137401365)*x[2]**o+(-0.92403906326)*x[2]
        ref[0,0]=(-1.20479923949)/(o+1.)+(-0.590460041345)
        ref[0,1]=(-0.502621307721)/(o+1.)+(0.585595687663)
        ref[0,2]=(0.811165065311)/(o+1.)+(-0.453743158552)
        ref[0,3]=(-0.522683730141)/(o+1.)+(0.0154837241797)
        ref[0,4]=(-0.361010094926)/(o+1.)+(-0.500849736991)
        ref[1,0]=(-0.00389470072479)/(o+1.)+(-0.628371646996)
        ref[1,1]=(-0.479074949842)/(o+1.)+(-0.23103521754)
        ref[1,2]=(-1.19376679941)/(o+1.)+(-0.54830477962)
        ref[1,3]=(-0.0251348451402)/(o+1.)+(0.229830899202)
        ref[1,4]=(-0.168835886025)/(o+1.)+(0.590681371404)
        ref[2,0]=(0.429482479793)/(o+1.)+(0.0361124710203)
        ref[2,1]=(-0.145395020492)/(o+1.)+(-1.20592523094)
        ref[2,2]=(0.497698889084)/(o+1.)+(-0.735476132859)
        ref[2,3]=(-0.782156525477)/(o+1.)+(0.872651246943)
        ref[2,4]=(0.362896589491)/(o+1.)+(-0.530147952664)
        ref[3,0]=(-0.305275343837)/(o+1.)+(-0.763052496519)
        ref[3,1]=(0.658595778683)/(o+1.)+(-0.166856307434)
        ref[3,2]=(-0.685901297311)/(o+1.)+(-0.313630129173)
        ref[3,3]=(-0.408718058683)/(o+1.)+(-0.146163664714)
        ref[3,4]=(0.21133728537)/(o+1.)+(-0.169561450281)
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Function_rank3(self):
      """
      tests integral of rank 3 Data on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.165423911829)*x[0]**o+(0.912542062064)*x[0]+(0.515840721225)*x[1]**o+(-0.855922021017)*x[1]
        arg[0,0,1]=(0.591873802546)*x[0]**o+(-0.039385167187)*x[0]+(0.0261484884274)*x[1]**o+(0.227950240434)*x[1]
        arg[0,1,0]=(-0.825833712046)*x[0]**o+(0.989606797765)*x[0]+(0.975260558791)*x[1]**o+(0.297963603984)*x[1]
        arg[0,1,1]=(-0.658054502482)*x[0]**o+(-0.865505090963)*x[0]+(0.817184084453)*x[1]**o+(-0.409588098899)*x[1]
        arg[1,0,0]=(0.538456987198)*x[0]**o+(-0.0768787509391)*x[0]+(0.424620431835)*x[1]**o+(0.799917948831)*x[1]
        arg[1,0,1]=(0.125945558199)*x[0]**o+(-0.48320049996)*x[0]+(0.105474962327)*x[1]**o+(-0.090713555582)*x[1]
        arg[1,1,0]=(0.835213375418)*x[0]**o+(-0.513407038769)*x[0]+(-0.342890811735)*x[1]**o+(-0.285057736244)*x[1]
        arg[1,1,1]=(0.762782085749)*x[0]**o+(-0.308457087352)*x[0]+(0.23756726753)*x[1]**o+(-0.909365956504)*x[1]
        arg[2,0,0]=(-0.76467980678)*x[0]**o+(-0.265552922006)*x[0]+(-0.261862355539)*x[1]**o+(-0.399407404618)*x[1]
        arg[2,0,1]=(0.79401193617)*x[0]**o+(-0.0300461495216)*x[0]+(-0.978834133508)*x[1]**o+(-0.984845382599)*x[1]
        arg[2,1,0]=(0.898033018534)*x[0]**o+(-0.184513430159)*x[0]+(0.0430634098526)*x[1]**o+(0.62213313954)*x[1]
        arg[2,1,1]=(0.126926439246)*x[0]**o+(0.671259428917)*x[0]+(-0.396062855417)*x[1]**o+(0.0461825691916)*x[1]
        arg[3,0,0]=(0.185756594279)*x[0]**o+(0.570946291973)*x[0]+(0.0673731944956)*x[1]**o+(0.367766610292)*x[1]
        arg[3,0,1]=(0.021269224946)*x[0]**o+(-0.463663279063)*x[0]+(-0.687930988068)*x[1]**o+(0.184714204849)*x[1]
        arg[3,1,0]=(0.754288639303)*x[0]**o+(-0.94612827517)*x[0]+(0.802463196709)*x[1]**o+(0.202355582077)*x[1]
        arg[3,1,1]=(0.840002857786)*x[0]**o+(-0.692207739447)*x[0]+(0.486569391181)*x[1]**o+(-0.713960793192)*x[1]
        arg[4,0,0]=(-0.205794539655)*x[0]**o+(-0.930458992533)*x[0]+(-0.62580205172)*x[1]**o+(-0.884738110673)*x[1]
        arg[4,0,1]=(-0.91433612349)*x[0]**o+(0.694961527804)*x[0]+(-0.510941334746)*x[1]**o+(-0.510725271706)*x[1]
        arg[4,1,0]=(0.852785499366)*x[0]**o+(0.870826628851)*x[0]+(-0.577529754198)*x[1]**o+(-0.583793684857)*x[1]
        arg[4,1,1]=(-0.604869226881)*x[0]**o+(0.482463572402)*x[0]+(0.829654316885)*x[1]**o+(0.597543822455)*x[1]
        arg[5,0,0]=(0.413459469749)*x[0]**o+(0.865143264083)*x[0]+(0.986197644249)*x[1]**o+(-0.2511021346)*x[1]
        arg[5,0,1]=(0.811572168213)*x[0]**o+(-0.110121334437)*x[0]+(-0.985492232242)*x[1]**o+(-0.913436084156)*x[1]
        arg[5,1,0]=(-0.660869051422)*x[0]**o+(-0.743235620427)*x[0]+(0.205393778238)*x[1]**o+(0.296069404687)*x[1]
        arg[5,1,1]=(-0.13285011267)*x[0]**o+(0.659400366834)*x[0]+(-0.889984368942)*x[1]**o+(0.584893563559)*x[1]
        ref[0,0,0]=(0.350416809396)/(o+1.)+(0.0283100205234)
        ref[0,0,1]=(0.618022290973)/(o+1.)+(0.0942825366236)
        ref[0,1,0]=(0.149426846745)/(o+1.)+(0.643785200874)
        ref[0,1,1]=(0.159129581971)/(o+1.)+(-0.637546594931)
        ref[1,0,0]=(0.963077419032)/(o+1.)+(0.361519598946)
        ref[1,0,1]=(0.231420520526)/(o+1.)+(-0.286957027771)
        ref[1,1,0]=(0.492322563683)/(o+1.)+(-0.399232387506)
        ref[1,1,1]=(1.00034935328)/(o+1.)+(-0.608911521928)
        ref[2,0,0]=(-1.02654216232)/(o+1.)+(-0.332480163312)
        ref[2,0,1]=(-0.184822197338)/(o+1.)+(-0.507445766061)
        ref[2,1,0]=(0.941096428387)/(o+1.)+(0.21880985469)
        ref[2,1,1]=(-0.269136416172)/(o+1.)+(0.358720999054)
        ref[3,0,0]=(0.253129788774)/(o+1.)+(0.469356451133)
        ref[3,0,1]=(-0.666661763122)/(o+1.)+(-0.139474537107)
        ref[3,1,0]=(1.55675183601)/(o+1.)+(-0.371886346546)
        ref[3,1,1]=(1.32657224897)/(o+1.)+(-0.703084266319)
        ref[4,0,0]=(-0.831596591375)/(o+1.)+(-0.907598551603)
        ref[4,0,1]=(-1.42527745824)/(o+1.)+(0.0921181280487)
        ref[4,1,0]=(0.275255745168)/(o+1.)+(0.143516471997)
        ref[4,1,1]=(0.224785090004)/(o+1.)+(0.540003697429)
        ref[5,0,0]=(1.399657114)/(o+1.)+(0.307020564742)
        ref[5,0,1]=(-0.173920064028)/(o+1.)+(-0.511778709296)
        ref[5,1,0]=(-0.455475273184)/(o+1.)+(-0.22358310787)
        ref[5,1,1]=(-1.02283448161)/(o+1.)+(0.622146965196)
      else:
        arg[0,0,0]=(-0.564478749422)*x[0]**o+(-0.0357223504179)*x[0]+(0.396603298865)*x[1]**o+(-0.461941327703)*x[1]+(-0.667580657928)*x[2]**o+(-0.589957067263)*x[2]
        arg[0,0,1]=(0.930616008951)*x[0]**o+(-0.764067565635)*x[0]+(-0.71350617205)*x[1]**o+(-0.530942701898)*x[1]+(-0.103797356434)*x[2]**o+(0.410704036673)*x[2]
        arg[0,1,0]=(-0.59127392299)*x[0]**o+(0.452490122131)*x[0]+(0.714793625631)*x[1]**o+(-0.933114051133)*x[1]+(-0.693437840325)*x[2]**o+(0.979267231764)*x[2]
        arg[0,1,1]=(0.179682332267)*x[0]**o+(-0.419960476425)*x[0]+(-0.10986598341)*x[1]**o+(0.912986428497)*x[1]+(0.0886946782573)*x[2]**o+(0.516065958873)*x[2]
        arg[1,0,0]=(0.524446863481)*x[0]**o+(-0.439668193423)*x[0]+(0.681259811488)*x[1]**o+(0.439275262258)*x[1]+(0.84573881706)*x[2]**o+(0.377640553175)*x[2]
        arg[1,0,1]=(-0.007464905203)*x[0]**o+(0.234727832471)*x[0]+(0.0428956356618)*x[1]**o+(0.195772930172)*x[1]+(0.457790934614)*x[2]**o+(0.445309166495)*x[2]
        arg[1,1,0]=(0.821283375827)*x[0]**o+(0.212480005798)*x[0]+(0.148817990961)*x[1]**o+(0.119716150877)*x[1]+(0.658959126865)*x[2]**o+(-0.346216916131)*x[2]
        arg[1,1,1]=(-0.0587222422894)*x[0]**o+(-0.325321661973)*x[0]+(0.149293818689)*x[1]**o+(-0.632073115037)*x[1]+(0.018604271874)*x[2]**o+(-0.412288240166)*x[2]
        arg[2,0,0]=(-0.22588082169)*x[0]**o+(0.197780461217)*x[0]+(0.387336989213)*x[1]**o+(-0.680021661016)*x[1]+(-0.903782254346)*x[2]**o+(-0.273268109853)*x[2]
        arg[2,0,1]=(0.415876394297)*x[0]**o+(0.199596795904)*x[0]+(-0.445817134682)*x[1]**o+(0.672539590684)*x[1]+(0.907825473964)*x[2]**o+(0.459560469691)*x[2]
        arg[2,1,0]=(-0.052146887134)*x[0]**o+(-0.229450574738)*x[0]+(0.0929720151604)*x[1]**o+(-0.893861034491)*x[1]+(-0.294030328982)*x[2]**o+(-0.193256779109)*x[2]
        arg[2,1,1]=(0.361171422066)*x[0]**o+(-0.212022056495)*x[0]+(0.0672221746963)*x[1]**o+(0.57506871515)*x[1]+(0.654894469509)*x[2]**o+(0.0749777260533)*x[2]
        arg[3,0,0]=(0.505355253404)*x[0]**o+(-0.0753563586359)*x[0]+(0.544299279727)*x[1]**o+(-0.781954131328)*x[1]+(0.534390713891)*x[2]**o+(-0.719289344378)*x[2]
        arg[3,0,1]=(-0.589309652827)*x[0]**o+(-0.0557421151178)*x[0]+(-0.275311076837)*x[1]**o+(0.998180518149)*x[1]+(-0.844823856433)*x[2]**o+(-0.988843805162)*x[2]
        arg[3,1,0]=(-0.411075104301)*x[0]**o+(-0.405896828894)*x[0]+(0.242301856034)*x[1]**o+(-0.760648969984)*x[1]+(0.0940367373673)*x[2]**o+(-0.121420230853)*x[2]
        arg[3,1,1]=(-0.201426146967)*x[0]**o+(0.722847134095)*x[0]+(-0.00743580369433)*x[1]**o+(-0.593158423904)*x[1]+(0.630575332064)*x[2]**o+(-0.309839791343)*x[2]
        arg[4,0,0]=(0.370057366738)*x[0]**o+(0.35683022394)*x[0]+(0.886304520049)*x[1]**o+(0.834488899465)*x[1]+(0.27408661832)*x[2]**o+(0.325007409933)*x[2]
        arg[4,0,1]=(0.386153377977)*x[0]**o+(-0.889700309398)*x[0]+(-0.60695970137)*x[1]**o+(0.701208035732)*x[1]+(0.435164510485)*x[2]**o+(0.40223148148)*x[2]
        arg[4,1,0]=(-0.227256041906)*x[0]**o+(-0.0406115125763)*x[0]+(-0.0298974314183)*x[1]**o+(0.887167464033)*x[1]+(0.1004751563)*x[2]**o+(0.826924545719)*x[2]
        arg[4,1,1]=(0.733575640137)*x[0]**o+(-0.376269474248)*x[0]+(-0.841290711112)*x[1]**o+(-0.0633013917179)*x[1]+(0.335730636406)*x[2]**o+(0.913607658221)*x[2]
        arg[5,0,0]=(-0.896019254334)*x[0]**o+(0.465470987762)*x[0]+(0.338543664838)*x[1]**o+(0.182102591196)*x[1]+(0.476317455739)*x[2]**o+(0.191367623163)*x[2]
        arg[5,0,1]=(0.828458939676)*x[0]**o+(-0.37853033744)*x[0]+(-0.540809170906)*x[1]**o+(0.367869598038)*x[1]+(0.321196361443)*x[2]**o+(0.548981819769)*x[2]
        arg[5,1,0]=(-0.0805871335579)*x[0]**o+(-0.554679375424)*x[0]+(-0.259438414137)*x[1]**o+(0.72362534417)*x[1]+(-0.838855028889)*x[2]**o+(0.929802758377)*x[2]
        arg[5,1,1]=(-0.947910259125)*x[0]**o+(0.654012824998)*x[0]+(0.425232602078)*x[1]**o+(-0.649345176159)*x[1]+(-0.946280438348)*x[2]**o+(-0.429547284912)*x[2]
        ref[0,0,0]=(-0.835456108484)/(o+1.)+(-0.543810372692)
        ref[0,0,1]=(0.113312480467)/(o+1.)+(-0.44215311543)
        ref[0,1,0]=(-0.569918137684)/(o+1.)+(0.249321651381)
        ref[0,1,1]=(0.158511027114)/(o+1.)+(0.504545955472)
        ref[1,0,0]=(2.05144549203)/(o+1.)+(0.188623811006)
        ref[1,0,1]=(0.493221665073)/(o+1.)+(0.437904964569)
        ref[1,1,0]=(1.62906049365)/(o+1.)+(-0.00701037972825)
        ref[1,1,1]=(0.109175848273)/(o+1.)+(-0.684841508588)
        ref[2,0,0]=(-0.742326086822)/(o+1.)+(-0.377754654826)
        ref[2,0,1]=(0.877884733578)/(o+1.)+(0.665848428139)
        ref[2,1,0]=(-0.253205200956)/(o+1.)+(-0.658284194169)
        ref[2,1,1]=(1.08328806627)/(o+1.)+(0.219012192354)
        ref[3,0,0]=(1.58404524702)/(o+1.)+(-0.788299917171)
        ref[3,0,1]=(-1.7094445861)/(o+1.)+(-0.0232027010654)
        ref[3,1,0]=(-0.0747365109002)/(o+1.)+(-0.643983014866)
        ref[3,1,1]=(0.421713381403)/(o+1.)+(-0.0900755405762)
        ref[4,0,0]=(1.53044850511)/(o+1.)+(0.758163266669)
        ref[4,0,1]=(0.214358187092)/(o+1.)+(0.106869603907)
        ref[4,1,0]=(-0.156678317024)/(o+1.)+(0.836740248588)
        ref[4,1,1]=(0.228015565432)/(o+1.)+(0.237018396127)
        ref[5,0,0]=(-0.0811581337568)/(o+1.)+(0.419470601061)
        ref[5,0,1]=(0.608846130213)/(o+1.)+(0.269160540183)
        ref[5,1,0]=(-1.17888057658)/(o+1.)+(0.549374363561)
        ref[5,1,1]=(-1.4689580954)/(o+1.)+(-0.212439818036)
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromData_Function_rank4(self):
      """
      tests integral of rank 4 Data on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.216014106349)*x[0]**o+(0.98826230471)*x[0]+(0.522566177319)*x[1]**o+(-0.672520997452)*x[1]
        arg[0,0,0,1]=(0.368024408084)*x[0]**o+(0.047972971332)*x[0]+(-0.307374327321)*x[1]**o+(0.0745169735457)*x[1]
        arg[0,0,1,0]=(0.438735045452)*x[0]**o+(0.76355958752)*x[0]+(0.200829025437)*x[1]**o+(0.56912407759)*x[1]
        arg[0,0,1,1]=(-0.0328769393712)*x[0]**o+(-0.39701363611)*x[0]+(0.704125532519)*x[1]**o+(-0.6602435084)*x[1]
        arg[0,0,2,0]=(-0.547717992717)*x[0]**o+(-0.844256763776)*x[0]+(0.621300470147)*x[1]**o+(-0.105216181226)*x[1]
        arg[0,0,2,1]=(-0.723474063234)*x[0]**o+(-0.980738972901)*x[0]+(-0.183578659566)*x[1]**o+(0.586038450047)*x[1]
        arg[0,1,0,0]=(0.505379907001)*x[0]**o+(-0.470514711277)*x[0]+(0.799116811747)*x[1]**o+(0.682760846386)*x[1]
        arg[0,1,0,1]=(0.353992609198)*x[0]**o+(-0.848107655585)*x[0]+(-0.774065459855)*x[1]**o+(0.0323137462292)*x[1]
        arg[0,1,1,0]=(0.799068805694)*x[0]**o+(-0.979761821209)*x[0]+(0.642674987867)*x[1]**o+(-0.639029952044)*x[1]
        arg[0,1,1,1]=(0.542556683327)*x[0]**o+(0.876753086356)*x[0]+(-0.387121297643)*x[1]**o+(0.377543179628)*x[1]
        arg[0,1,2,0]=(0.424672899596)*x[0]**o+(-0.134184751569)*x[0]+(-0.561877304114)*x[1]**o+(0.549933699347)*x[1]
        arg[0,1,2,1]=(-0.126173294501)*x[0]**o+(-0.338964866844)*x[0]+(-0.163536115759)*x[1]**o+(0.747551558186)*x[1]
        arg[0,2,0,0]=(0.304334183452)*x[0]**o+(0.927809971187)*x[0]+(0.961504942988)*x[1]**o+(0.0698014252396)*x[1]
        arg[0,2,0,1]=(0.488820088455)*x[0]**o+(0.890735247208)*x[0]+(0.686782901398)*x[1]**o+(0.972954994564)*x[1]
        arg[0,2,1,0]=(-0.737577792766)*x[0]**o+(-0.351698913646)*x[0]+(0.392591489865)*x[1]**o+(0.79238240143)*x[1]
        arg[0,2,1,1]=(-0.997254027544)*x[0]**o+(0.579800166465)*x[0]+(-0.95000690643)*x[1]**o+(-0.166463083476)*x[1]
        arg[0,2,2,0]=(-0.999703749644)*x[0]**o+(0.0415211466468)*x[0]+(0.0816160245139)*x[1]**o+(-0.0921114587195)*x[1]
        arg[0,2,2,1]=(-0.172818721386)*x[0]**o+(0.10475692446)*x[0]+(-0.855815339933)*x[1]**o+(-0.50842580034)*x[1]
        arg[0,3,0,0]=(-0.154563121513)*x[0]**o+(-0.0956305513369)*x[0]+(-0.893783521038)*x[1]**o+(0.10772474638)*x[1]
        arg[0,3,0,1]=(0.365331678349)*x[0]**o+(0.403124820832)*x[0]+(-0.0750500521493)*x[1]**o+(0.62559762808)*x[1]
        arg[0,3,1,0]=(-0.42235875521)*x[0]**o+(0.831133238533)*x[0]+(-0.893322944982)*x[1]**o+(0.936074096319)*x[1]
        arg[0,3,1,1]=(0.587382334689)*x[0]**o+(0.996190710631)*x[0]+(-0.796032791654)*x[1]**o+(0.783491453801)*x[1]
        arg[0,3,2,0]=(-0.369527027508)*x[0]**o+(-0.501417552089)*x[0]+(-0.372105439045)*x[1]**o+(0.653283000152)*x[1]
        arg[0,3,2,1]=(0.914893750314)*x[0]**o+(-0.769183323793)*x[0]+(0.571638486717)*x[1]**o+(-0.939784652259)*x[1]
        arg[0,4,0,0]=(0.134859060251)*x[0]**o+(-0.297363165275)*x[0]+(0.198957028974)*x[1]**o+(-0.828531725127)*x[1]
        arg[0,4,0,1]=(-0.371375370217)*x[0]**o+(-0.0422058718402)*x[0]+(0.502010302278)*x[1]**o+(0.442051802597)*x[1]
        arg[0,4,1,0]=(0.513346571173)*x[0]**o+(0.182640867356)*x[0]+(0.76200283664)*x[1]**o+(0.134640432361)*x[1]
        arg[0,4,1,1]=(-0.815543712756)*x[0]**o+(0.0306226823724)*x[0]+(-0.0211231926242)*x[1]**o+(-0.718800228294)*x[1]
        arg[0,4,2,0]=(-0.980596107555)*x[0]**o+(-0.714237107759)*x[0]+(0.547986215851)*x[1]**o+(0.180131474534)*x[1]
        arg[0,4,2,1]=(-0.460780402239)*x[0]**o+(-0.483771113997)*x[0]+(-0.017140263255)*x[1]**o+(-0.127947184627)*x[1]
        arg[1,0,0,0]=(-0.0187443155707)*x[0]**o+(-0.490914415873)*x[0]+(-0.720022496093)*x[1]**o+(0.0265633770733)*x[1]
        arg[1,0,0,1]=(-0.634855765904)*x[0]**o+(0.345031954366)*x[0]+(-0.0532392363316)*x[1]**o+(0.983295524564)*x[1]
        arg[1,0,1,0]=(0.262182040476)*x[0]**o+(-0.883857758733)*x[0]+(0.880670543535)*x[1]**o+(0.193477695378)*x[1]
        arg[1,0,1,1]=(-0.0825976168371)*x[0]**o+(0.161838720337)*x[0]+(-0.0110587499089)*x[1]**o+(-0.634455402489)*x[1]
        arg[1,0,2,0]=(0.284221958342)*x[0]**o+(-0.948548729029)*x[0]+(0.430914344458)*x[1]**o+(-0.18563638241)*x[1]
        arg[1,0,2,1]=(-0.459558022898)*x[0]**o+(0.431907572866)*x[0]+(-0.0597669070218)*x[1]**o+(0.0694271372225)*x[1]
        arg[1,1,0,0]=(0.54071078447)*x[0]**o+(-0.244570994356)*x[0]+(0.00506219762373)*x[1]**o+(-0.0816378019186)*x[1]
        arg[1,1,0,1]=(-0.100752221379)*x[0]**o+(0.535738345566)*x[0]+(0.730325284553)*x[1]**o+(-0.885044748717)*x[1]
        arg[1,1,1,0]=(-0.0422460353138)*x[0]**o+(-0.986416505995)*x[0]+(-0.111766776997)*x[1]**o+(-0.842179226197)*x[1]
        arg[1,1,1,1]=(0.0690281593169)*x[0]**o+(-0.885054188663)*x[0]+(-0.680349314907)*x[1]**o+(0.00277190934345)*x[1]
        arg[1,1,2,0]=(0.502632146841)*x[0]**o+(-0.197332151163)*x[0]+(-0.0942257361149)*x[1]**o+(0.045171692749)*x[1]
        arg[1,1,2,1]=(0.427910466818)*x[0]**o+(-0.61355947216)*x[0]+(0.465128040517)*x[1]**o+(0.0874536555354)*x[1]
        arg[1,2,0,0]=(0.943819415417)*x[0]**o+(0.884020001869)*x[0]+(-0.769166027477)*x[1]**o+(-0.10032307068)*x[1]
        arg[1,2,0,1]=(0.0670224828564)*x[0]**o+(-0.645424481071)*x[0]+(-0.756361652678)*x[1]**o+(-0.274687916196)*x[1]
        arg[1,2,1,0]=(0.397836742229)*x[0]**o+(-0.708791058745)*x[0]+(0.920869587663)*x[1]**o+(-0.250037069918)*x[1]
        arg[1,2,1,1]=(0.722570486719)*x[0]**o+(-0.358082774936)*x[0]+(0.786344673969)*x[1]**o+(0.310591893637)*x[1]
        arg[1,2,2,0]=(-0.379404573553)*x[0]**o+(-0.969753501645)*x[0]+(-0.0745714915337)*x[1]**o+(-0.262943796911)*x[1]
        arg[1,2,2,1]=(0.817999459632)*x[0]**o+(0.731516351792)*x[0]+(-0.531411613325)*x[1]**o+(-0.824858061154)*x[1]
        arg[1,3,0,0]=(-0.206295444021)*x[0]**o+(-0.781973944918)*x[0]+(-0.173845545382)*x[1]**o+(-0.360122364573)*x[1]
        arg[1,3,0,1]=(-0.0604068005719)*x[0]**o+(0.238691416507)*x[0]+(-0.82262982031)*x[1]**o+(-0.893751755968)*x[1]
        arg[1,3,1,0]=(-0.686409669386)*x[0]**o+(0.711830599399)*x[0]+(0.0839688142166)*x[1]**o+(-0.99463449684)*x[1]
        arg[1,3,1,1]=(-0.0864745975077)*x[0]**o+(0.00068907895313)*x[0]+(-0.766810513534)*x[1]**o+(0.685236202954)*x[1]
        arg[1,3,2,0]=(0.0909338812695)*x[0]**o+(-0.709595654169)*x[0]+(-0.483428504499)*x[1]**o+(-0.0707341191006)*x[1]
        arg[1,3,2,1]=(-0.38342983855)*x[0]**o+(-0.0407824575865)*x[0]+(-0.201329040891)*x[1]**o+(0.0240007937141)*x[1]
        arg[1,4,0,0]=(0.512465803173)*x[0]**o+(-0.371898603608)*x[0]+(-0.79453595861)*x[1]**o+(0.340546986375)*x[1]
        arg[1,4,0,1]=(0.742383198442)*x[0]**o+(-0.603548189912)*x[0]+(-0.270277825546)*x[1]**o+(-0.525100913894)*x[1]
        arg[1,4,1,0]=(-0.693074384029)*x[0]**o+(-0.825037404844)*x[0]+(-0.626116177978)*x[1]**o+(0.628159342479)*x[1]
        arg[1,4,1,1]=(-0.595844943255)*x[0]**o+(0.250758194807)*x[0]+(0.504390052142)*x[1]**o+(-0.124588859702)*x[1]
        arg[1,4,2,0]=(-0.651727490997)*x[0]**o+(0.411138504151)*x[0]+(0.323769160331)*x[1]**o+(0.904379126671)*x[1]
        arg[1,4,2,1]=(-0.71307850178)*x[0]**o+(0.734964608119)*x[0]+(0.348693698506)*x[1]**o+(0.272270639772)*x[1]
        arg[2,0,0,0]=(0.558236567771)*x[0]**o+(0.516985445776)*x[0]+(0.0278915137861)*x[1]**o+(-0.268619977833)*x[1]
        arg[2,0,0,1]=(-0.871181709658)*x[0]**o+(-0.132251987744)*x[0]+(-0.215497073461)*x[1]**o+(0.508008002082)*x[1]
        arg[2,0,1,0]=(0.880795999572)*x[0]**o+(-0.231151166496)*x[0]+(-0.698846681617)*x[1]**o+(0.914483413825)*x[1]
        arg[2,0,1,1]=(0.684792911211)*x[0]**o+(-0.801408782989)*x[0]+(0.689713232168)*x[1]**o+(0.142847173797)*x[1]
        arg[2,0,2,0]=(-0.912566319945)*x[0]**o+(0.811138574657)*x[0]+(-0.884250879071)*x[1]**o+(-0.177206225477)*x[1]
        arg[2,0,2,1]=(-0.898648046678)*x[0]**o+(0.581554373688)*x[0]+(0.567642878443)*x[1]**o+(0.636312832751)*x[1]
        arg[2,1,0,0]=(-0.788853365648)*x[0]**o+(-0.135329327941)*x[0]+(0.180850147594)*x[1]**o+(0.742619029335)*x[1]
        arg[2,1,0,1]=(-0.824539980645)*x[0]**o+(0.857173393615)*x[0]+(0.850455264916)*x[1]**o+(0.975422322464)*x[1]
        arg[2,1,1,0]=(0.462293517317)*x[0]**o+(-0.173835273794)*x[0]+(-0.800072514276)*x[1]**o+(0.140214114627)*x[1]
        arg[2,1,1,1]=(-0.187890814293)*x[0]**o+(0.534472364495)*x[0]+(-0.799640665571)*x[1]**o+(0.301287955302)*x[1]
        arg[2,1,2,0]=(0.278901492946)*x[0]**o+(0.620544326886)*x[0]+(-0.705702443752)*x[1]**o+(-0.489690636328)*x[1]
        arg[2,1,2,1]=(-0.926772900235)*x[0]**o+(0.134654742845)*x[0]+(0.356561975337)*x[1]**o+(-0.919999359857)*x[1]
        arg[2,2,0,0]=(-0.675956301416)*x[0]**o+(0.149582589205)*x[0]+(0.186440827385)*x[1]**o+(0.88381610446)*x[1]
        arg[2,2,0,1]=(-0.697267962915)*x[0]**o+(0.991366596424)*x[0]+(0.310290094618)*x[1]**o+(-0.881771505066)*x[1]
        arg[2,2,1,0]=(0.506027358474)*x[0]**o+(0.294136137354)*x[0]+(0.732003937836)*x[1]**o+(0.633469131504)*x[1]
        arg[2,2,1,1]=(-0.427146039728)*x[0]**o+(-0.975737063903)*x[0]+(-0.934913653772)*x[1]**o+(-0.662568325005)*x[1]
        arg[2,2,2,0]=(0.477849916621)*x[0]**o+(-0.798883883367)*x[0]+(-0.154217684441)*x[1]**o+(-0.175817547912)*x[1]
        arg[2,2,2,1]=(0.935192620387)*x[0]**o+(-0.193802588249)*x[0]+(0.406181949213)*x[1]**o+(0.20422475396)*x[1]
        arg[2,3,0,0]=(0.965944278856)*x[0]**o+(-0.736175411725)*x[0]+(0.92404347386)*x[1]**o+(0.273152788392)*x[1]
        arg[2,3,0,1]=(-0.606944412413)*x[0]**o+(0.692555413476)*x[0]+(0.812085676275)*x[1]**o+(-0.0809920218886)*x[1]
        arg[2,3,1,0]=(-0.314634777406)*x[0]**o+(0.750181618592)*x[0]+(0.0554739779642)*x[1]**o+(-0.333788326726)*x[1]
        arg[2,3,1,1]=(0.85610815703)*x[0]**o+(0.910096005524)*x[0]+(-0.227092814843)*x[1]**o+(-0.0849532598914)*x[1]
        arg[2,3,2,0]=(0.735064128504)*x[0]**o+(-0.253919528943)*x[0]+(0.8457463307)*x[1]**o+(0.865727345925)*x[1]
        arg[2,3,2,1]=(0.520607989389)*x[0]**o+(0.569210317105)*x[0]+(0.500780081677)*x[1]**o+(-0.787630914351)*x[1]
        arg[2,4,0,0]=(0.179774694296)*x[0]**o+(-0.890872128607)*x[0]+(-0.185758177247)*x[1]**o+(0.888231734606)*x[1]
        arg[2,4,0,1]=(0.059863462227)*x[0]**o+(-0.0796463123948)*x[0]+(-0.104564520504)*x[1]**o+(-0.336182528617)*x[1]
        arg[2,4,1,0]=(-0.636828275967)*x[0]**o+(0.156894572218)*x[0]+(-0.884260096115)*x[1]**o+(-0.967431438795)*x[1]
        arg[2,4,1,1]=(-0.958168110389)*x[0]**o+(-0.0424772631477)*x[0]+(0.512363473316)*x[1]**o+(-0.716729419668)*x[1]
        arg[2,4,2,0]=(0.19736654467)*x[0]**o+(-0.288723518002)*x[0]+(0.243674007033)*x[1]**o+(0.911210601142)*x[1]
        arg[2,4,2,1]=(-0.847493343055)*x[0]**o+(0.115003265593)*x[0]+(0.360071936714)*x[1]**o+(-0.0265385061141)*x[1]
        arg[3,0,0,0]=(-0.510550590836)*x[0]**o+(-0.266174606631)*x[0]+(0.771580708159)*x[1]**o+(-0.770554374259)*x[1]
        arg[3,0,0,1]=(-0.65795024738)*x[0]**o+(-0.83394628525)*x[0]+(0.812461325452)*x[1]**o+(0.191593733482)*x[1]
        arg[3,0,1,0]=(0.136878718548)*x[0]**o+(-0.000345061692795)*x[0]+(-0.0780280205008)*x[1]**o+(0.173925537373)*x[1]
        arg[3,0,1,1]=(0.584079470149)*x[0]**o+(0.138674493948)*x[0]+(-0.563553909861)*x[1]**o+(-0.254304838008)*x[1]
        arg[3,0,2,0]=(0.326192887554)*x[0]**o+(0.993615980303)*x[0]+(-0.26995279693)*x[1]**o+(0.216112615287)*x[1]
        arg[3,0,2,1]=(0.684786021819)*x[0]**o+(0.158934017292)*x[0]+(-0.457448199191)*x[1]**o+(0.644722228163)*x[1]
        arg[3,1,0,0]=(-0.198252162262)*x[0]**o+(-0.821832378445)*x[0]+(0.831807441916)*x[1]**o+(-0.70643670471)*x[1]
        arg[3,1,0,1]=(0.361698759016)*x[0]**o+(0.556511107101)*x[0]+(0.892219700601)*x[1]**o+(-0.861598520361)*x[1]
        arg[3,1,1,0]=(-0.107946706634)*x[0]**o+(-0.910191934756)*x[0]+(0.502507607871)*x[1]**o+(0.649089810516)*x[1]
        arg[3,1,1,1]=(-0.92959760672)*x[0]**o+(0.950682520961)*x[0]+(0.103321004187)*x[1]**o+(-0.631562667815)*x[1]
        arg[3,1,2,0]=(0.858565242025)*x[0]**o+(-0.106810606075)*x[0]+(0.236377425048)*x[1]**o+(-0.296320858145)*x[1]
        arg[3,1,2,1]=(0.148558873625)*x[0]**o+(0.458488334082)*x[0]+(-0.0172824905523)*x[1]**o+(-0.321212766581)*x[1]
        arg[3,2,0,0]=(-0.239733890336)*x[0]**o+(0.558819103697)*x[0]+(-0.151683129885)*x[1]**o+(0.153995780645)*x[1]
        arg[3,2,0,1]=(-0.949100270937)*x[0]**o+(0.0687171499139)*x[0]+(0.968028021831)*x[1]**o+(-0.935600499345)*x[1]
        arg[3,2,1,0]=(-0.739823767237)*x[0]**o+(0.417825150389)*x[0]+(0.318612170707)*x[1]**o+(0.627557337421)*x[1]
        arg[3,2,1,1]=(-0.965142167324)*x[0]**o+(0.981446854383)*x[0]+(0.266191185951)*x[1]**o+(-0.581303142841)*x[1]
        arg[3,2,2,0]=(-0.00312606993817)*x[0]**o+(-0.191885030828)*x[0]+(-0.342525068561)*x[1]**o+(-0.953710538626)*x[1]
        arg[3,2,2,1]=(-0.689127187476)*x[0]**o+(-0.107190366063)*x[0]+(-0.0556716250594)*x[1]**o+(-0.609462166754)*x[1]
        arg[3,3,0,0]=(-0.765237197853)*x[0]**o+(-0.0707283944117)*x[0]+(0.891789872287)*x[1]**o+(-0.255939791858)*x[1]
        arg[3,3,0,1]=(-0.367658362103)*x[0]**o+(0.27406309422)*x[0]+(0.866288683947)*x[1]**o+(0.403194030287)*x[1]
        arg[3,3,1,0]=(-0.362795000993)*x[0]**o+(-0.498774415158)*x[0]+(0.0726808331583)*x[1]**o+(-0.871066791136)*x[1]
        arg[3,3,1,1]=(-0.177149059814)*x[0]**o+(0.287463753612)*x[0]+(0.101726559941)*x[1]**o+(0.561797204517)*x[1]
        arg[3,3,2,0]=(0.770615121039)*x[0]**o+(-0.503402148251)*x[0]+(0.319753007634)*x[1]**o+(0.586868894261)*x[1]
        arg[3,3,2,1]=(0.924125904724)*x[0]**o+(-0.508988920423)*x[0]+(-0.866752504824)*x[1]**o+(0.518544700652)*x[1]
        arg[3,4,0,0]=(-0.973660291124)*x[0]**o+(0.746869369283)*x[0]+(-0.634097171844)*x[1]**o+(0.723638944736)*x[1]
        arg[3,4,0,1]=(-0.599366869066)*x[0]**o+(-0.59893829688)*x[0]+(0.124483401866)*x[1]**o+(-0.924820315792)*x[1]
        arg[3,4,1,0]=(-0.707374787729)*x[0]**o+(-0.494748755022)*x[0]+(0.391752209698)*x[1]**o+(0.149710640116)*x[1]
        arg[3,4,1,1]=(0.329587748119)*x[0]**o+(-0.788289803764)*x[0]+(-0.145100163626)*x[1]**o+(0.141493810237)*x[1]
        arg[3,4,2,0]=(0.17496644337)*x[0]**o+(-0.270242104589)*x[0]+(0.996684379179)*x[1]**o+(-0.751697440046)*x[1]
        arg[3,4,2,1]=(0.79046837395)*x[0]**o+(0.568394473062)*x[0]+(0.359419854016)*x[1]**o+(0.630686948244)*x[1]
        ref[0,0,0,0]=(0.306552070969)/(o+1.)+(0.157870653629)
        ref[0,0,0,1]=(0.0606500807631)/(o+1.)+(0.0612449724389)
        ref[0,0,1,0]=(0.639564070889)/(o+1.)+(0.666341832555)
        ref[0,0,1,1]=(0.671248593147)/(o+1.)+(-0.528628572255)
        ref[0,0,2,0]=(0.0735824774293)/(o+1.)+(-0.474736472501)
        ref[0,0,2,1]=(-0.9070527228)/(o+1.)+(-0.197350261427)
        ref[0,1,0,0]=(1.30449671875)/(o+1.)+(0.106123067554)
        ref[0,1,0,1]=(-0.420072850657)/(o+1.)+(-0.407896954678)
        ref[0,1,1,0]=(1.44174379356)/(o+1.)+(-0.809395886627)
        ref[0,1,1,1]=(0.155435385684)/(o+1.)+(0.627148132992)
        ref[0,1,2,0]=(-0.137204404518)/(o+1.)+(0.207874473889)
        ref[0,1,2,1]=(-0.289709410261)/(o+1.)+(0.204293345671)
        ref[0,2,0,0]=(1.26583912644)/(o+1.)+(0.498805698213)
        ref[0,2,0,1]=(1.17560298985)/(o+1.)+(0.931845120886)
        ref[0,2,1,0]=(-0.344986302901)/(o+1.)+(0.220341743892)
        ref[0,2,1,1]=(-1.94726093397)/(o+1.)+(0.206668541494)
        ref[0,2,2,0]=(-0.91808772513)/(o+1.)+(-0.0252951560363)
        ref[0,2,2,1]=(-1.02863406132)/(o+1.)+(-0.20183443794)
        ref[0,3,0,0]=(-1.04834664255)/(o+1.)+(0.00604709752155)
        ref[0,3,0,1]=(0.2902816262)/(o+1.)+(0.514361224456)
        ref[0,3,1,0]=(-1.31568170019)/(o+1.)+(0.883603667426)
        ref[0,3,1,1]=(-0.208650456965)/(o+1.)+(0.889841082216)
        ref[0,3,2,0]=(-0.741632466554)/(o+1.)+(0.0759327240318)
        ref[0,3,2,1]=(1.48653223703)/(o+1.)+(-0.854483988026)
        ref[0,4,0,0]=(0.333816089225)/(o+1.)+(-0.562947445201)
        ref[0,4,0,1]=(0.130634932061)/(o+1.)+(0.199922965378)
        ref[0,4,1,0]=(1.27534940781)/(o+1.)+(0.158640649858)
        ref[0,4,1,1]=(-0.83666690538)/(o+1.)+(-0.344088772961)
        ref[0,4,2,0]=(-0.432609891704)/(o+1.)+(-0.267052816612)
        ref[0,4,2,1]=(-0.477920665494)/(o+1.)+(-0.305859149312)
        ref[1,0,0,0]=(-0.738766811663)/(o+1.)+(-0.2321755194)
        ref[1,0,0,1]=(-0.688095002235)/(o+1.)+(0.664163739465)
        ref[1,0,1,0]=(1.14285258401)/(o+1.)+(-0.345190031677)
        ref[1,0,1,1]=(-0.093656366746)/(o+1.)+(-0.236308341076)
        ref[1,0,2,0]=(0.7151363028)/(o+1.)+(-0.56709255572)
        ref[1,0,2,1]=(-0.51932492992)/(o+1.)+(0.250667355044)
        ref[1,1,0,0]=(0.545772982093)/(o+1.)+(-0.163104398138)
        ref[1,1,0,1]=(0.629573063174)/(o+1.)+(-0.174653201576)
        ref[1,1,1,0]=(-0.154012812311)/(o+1.)+(-0.914297866096)
        ref[1,1,1,1]=(-0.61132115559)/(o+1.)+(-0.44114113966)
        ref[1,1,2,0]=(0.408406410726)/(o+1.)+(-0.076080229207)
        ref[1,1,2,1]=(0.893038507335)/(o+1.)+(-0.263052908312)
        ref[1,2,0,0]=(0.17465338794)/(o+1.)+(0.391848465594)
        ref[1,2,0,1]=(-0.689339169821)/(o+1.)+(-0.460056198634)
        ref[1,2,1,0]=(1.31870632989)/(o+1.)+(-0.479414064332)
        ref[1,2,1,1]=(1.50891516069)/(o+1.)+(-0.0237454406495)
        ref[1,2,2,0]=(-0.453976065087)/(o+1.)+(-0.616348649278)
        ref[1,2,2,1]=(0.286587846307)/(o+1.)+(-0.0466708546809)
        ref[1,3,0,0]=(-0.380140989403)/(o+1.)+(-0.571048154745)
        ref[1,3,0,1]=(-0.883036620882)/(o+1.)+(-0.32753016973)
        ref[1,3,1,0]=(-0.60244085517)/(o+1.)+(-0.141401948721)
        ref[1,3,1,1]=(-0.853285111042)/(o+1.)+(0.342962640954)
        ref[1,3,2,0]=(-0.39249462323)/(o+1.)+(-0.390164886635)
        ref[1,3,2,1]=(-0.584758879441)/(o+1.)+(-0.00839083193621)
        ref[1,4,0,0]=(-0.282070155438)/(o+1.)+(-0.0156758086169)
        ref[1,4,0,1]=(0.472105372896)/(o+1.)+(-0.564324551903)
        ref[1,4,1,0]=(-1.31919056201)/(o+1.)+(-0.0984390311826)
        ref[1,4,1,1]=(-0.0914548911124)/(o+1.)+(0.0630846675525)
        ref[1,4,2,0]=(-0.327958330666)/(o+1.)+(0.657758815411)
        ref[1,4,2,1]=(-0.364384803274)/(o+1.)+(0.503617623946)
        ref[2,0,0,0]=(0.586128081557)/(o+1.)+(0.124182733972)
        ref[2,0,0,1]=(-1.08667878312)/(o+1.)+(0.187878007169)
        ref[2,0,1,0]=(0.181949317955)/(o+1.)+(0.341666123665)
        ref[2,0,1,1]=(1.37450614338)/(o+1.)+(-0.329280804596)
        ref[2,0,2,0]=(-1.79681719902)/(o+1.)+(0.31696617459)
        ref[2,0,2,1]=(-0.331005168235)/(o+1.)+(0.608933603219)
        ref[2,1,0,0]=(-0.608003218053)/(o+1.)+(0.303644850697)
        ref[2,1,0,1]=(0.0259152842714)/(o+1.)+(0.916297858039)
        ref[2,1,1,0]=(-0.33777899696)/(o+1.)+(-0.0168105795836)
        ref[2,1,1,1]=(-0.987531479864)/(o+1.)+(0.417880159899)
        ref[2,1,2,0]=(-0.426800950806)/(o+1.)+(0.0654268452787)
        ref[2,1,2,1]=(-0.570210924898)/(o+1.)+(-0.392672308506)
        ref[2,2,0,0]=(-0.489515474032)/(o+1.)+(0.516699346832)
        ref[2,2,0,1]=(-0.386977868298)/(o+1.)+(0.054797545679)
        ref[2,2,1,0]=(1.23803129631)/(o+1.)+(0.463802634429)
        ref[2,2,1,1]=(-1.3620596935)/(o+1.)+(-0.819152694454)
        ref[2,2,2,0]=(0.32363223218)/(o+1.)+(-0.48735071564)
        ref[2,2,2,1]=(1.3413745696)/(o+1.)+(0.00521108285542)
        ref[2,3,0,0]=(1.88998775272)/(o+1.)+(-0.231511311666)
        ref[2,3,0,1]=(0.205141263861)/(o+1.)+(0.305781695794)
        ref[2,3,1,0]=(-0.259160799442)/(o+1.)+(0.208196645933)
        ref[2,3,1,1]=(0.629015342187)/(o+1.)+(0.412571372816)
        ref[2,3,2,0]=(1.5808104592)/(o+1.)+(0.305903908491)
        ref[2,3,2,1]=(1.02138807107)/(o+1.)+(-0.109210298623)
        ref[2,4,0,0]=(-0.00598348295078)/(o+1.)+(-0.00132019700044)
        ref[2,4,0,1]=(-0.0447010582767)/(o+1.)+(-0.207914420506)
        ref[2,4,1,0]=(-1.52108837208)/(o+1.)+(-0.405268433289)
        ref[2,4,1,1]=(-0.445804637073)/(o+1.)+(-0.379603341408)
        ref[2,4,2,0]=(0.441040551703)/(o+1.)+(0.31124354157)
        ref[2,4,2,1]=(-0.487421406342)/(o+1.)+(0.0442323797396)
        ref[3,0,0,0]=(0.261030117323)/(o+1.)+(-0.518364490445)
        ref[3,0,0,1]=(0.154511078072)/(o+1.)+(-0.321176275884)
        ref[3,0,1,0]=(0.0588506980476)/(o+1.)+(0.0867902378403)
        ref[3,0,1,1]=(0.0205255602871)/(o+1.)+(-0.0578151720304)
        ref[3,0,2,0]=(0.0562400906237)/(o+1.)+(0.604864297795)
        ref[3,0,2,1]=(0.227337822629)/(o+1.)+(0.401828122727)
        ref[3,1,0,0]=(0.633555279654)/(o+1.)+(-0.764134541578)
        ref[3,1,0,1]=(1.25391845962)/(o+1.)+(-0.15254370663)
        ref[3,1,1,0]=(0.394560901238)/(o+1.)+(-0.13055106212)
        ref[3,1,1,1]=(-0.826276602534)/(o+1.)+(0.159559926573)
        ref[3,1,2,0]=(1.09494266707)/(o+1.)+(-0.20156573211)
        ref[3,1,2,1]=(0.131276383073)/(o+1.)+(0.0686377837506)
        ref[3,2,0,0]=(-0.391417020221)/(o+1.)+(0.356407442171)
        ref[3,2,0,1]=(0.0189277508933)/(o+1.)+(-0.433441674716)
        ref[3,2,1,0]=(-0.42121159653)/(o+1.)+(0.522691243905)
        ref[3,2,1,1]=(-0.698950981373)/(o+1.)+(0.200071855771)
        ref[3,2,2,0]=(-0.345651138499)/(o+1.)+(-0.572797784727)
        ref[3,2,2,1]=(-0.744798812536)/(o+1.)+(-0.358326266408)
        ref[3,3,0,0]=(0.126552674434)/(o+1.)+(-0.163334093135)
        ref[3,3,0,1]=(0.498630321844)/(o+1.)+(0.338628562253)
        ref[3,3,1,0]=(-0.290114167835)/(o+1.)+(-0.684920603147)
        ref[3,3,1,1]=(-0.0754224998727)/(o+1.)+(0.424630479064)
        ref[3,3,2,0]=(1.09036812867)/(o+1.)+(0.0417333730049)
        ref[3,3,2,1]=(0.0573733998999)/(o+1.)+(0.00477789011464)
        ref[3,4,0,0]=(-1.60775746297)/(o+1.)+(0.73525415701)
        ref[3,4,0,1]=(-0.4748834672)/(o+1.)+(-0.761879306336)
        ref[3,4,1,0]=(-0.31562257803)/(o+1.)+(-0.172519057453)
        ref[3,4,1,1]=(0.184487584493)/(o+1.)+(-0.323397996764)
        ref[3,4,2,0]=(1.17165082255)/(o+1.)+(-0.510969772317)
        ref[3,4,2,1]=(1.14988822797)/(o+1.)+(0.599540710653)
      else:
        arg[0,0,0,0]=(-0.517412938774)*x[0]**o+(0.824804313111)*x[0]+(-0.681706563374)*x[1]**o+(-0.259540440272)*x[1]+(0.876735283937)*x[2]**o+(0.307072859807)*x[2]
        arg[0,0,0,1]=(-0.545981202251)*x[0]**o+(-0.530080933212)*x[0]+(-0.339289111599)*x[1]**o+(-0.726311605088)*x[1]+(0.334837705444)*x[2]**o+(-0.422667311064)*x[2]
        arg[0,0,1,0]=(-0.94261387328)*x[0]**o+(-0.315825326734)*x[0]+(0.542502801277)*x[1]**o+(-0.927525943646)*x[1]+(-0.802118238213)*x[2]**o+(-0.106512314706)*x[2]
        arg[0,0,1,1]=(-0.877940099286)*x[0]**o+(-0.801256557869)*x[0]+(-0.155983792242)*x[1]**o+(0.200547191496)*x[1]+(-0.960553133432)*x[2]**o+(0.968862792367)*x[2]
        arg[0,0,2,0]=(-0.870342547946)*x[0]**o+(-0.956447402661)*x[0]+(-0.506797803004)*x[1]**o+(0.342841675107)*x[1]+(0.528354159344)*x[2]**o+(-0.824546729564)*x[2]
        arg[0,0,2,1]=(-0.411899137296)*x[0]**o+(0.133736458559)*x[0]+(0.852726131619)*x[1]**o+(0.692795229813)*x[1]+(0.047372576403)*x[2]**o+(0.810485765945)*x[2]
        arg[0,1,0,0]=(0.961758233254)*x[0]**o+(-0.606307924964)*x[0]+(0.0612696412665)*x[1]**o+(-0.947823541802)*x[1]+(-0.113021104365)*x[2]**o+(-0.00802440322155)*x[2]
        arg[0,1,0,1]=(-0.684097052467)*x[0]**o+(0.467140835537)*x[0]+(-0.0742537091205)*x[1]**o+(0.541641916143)*x[1]+(0.987491548505)*x[2]**o+(-0.558380262255)*x[2]
        arg[0,1,1,0]=(-0.901821988855)*x[0]**o+(0.34443714654)*x[0]+(-0.682552654793)*x[1]**o+(0.398276086461)*x[1]+(0.334644264965)*x[2]**o+(0.21454845251)*x[2]
        arg[0,1,1,1]=(0.929614060295)*x[0]**o+(-0.322609307947)*x[0]+(-0.426962200724)*x[1]**o+(0.464659992564)*x[1]+(-0.13983863674)*x[2]**o+(-0.681648817325)*x[2]
        arg[0,1,2,0]=(0.504166508914)*x[0]**o+(-0.978562859041)*x[0]+(-0.769650404806)*x[1]**o+(0.443500137153)*x[1]+(0.969669965936)*x[2]**o+(0.401742207403)*x[2]
        arg[0,1,2,1]=(-0.478561324822)*x[0]**o+(-0.772019838834)*x[0]+(-0.779194844829)*x[1]**o+(-0.747980400065)*x[1]+(0.827885608192)*x[2]**o+(0.135571151528)*x[2]
        arg[0,2,0,0]=(-0.210426221052)*x[0]**o+(-0.464938141903)*x[0]+(-0.776844066203)*x[1]**o+(0.267244555705)*x[1]+(-0.773135929429)*x[2]**o+(-0.00846060888954)*x[2]
        arg[0,2,0,1]=(0.0945858334531)*x[0]**o+(-0.492400895713)*x[0]+(-0.128564669727)*x[1]**o+(-0.0951458189983)*x[1]+(-0.54426715378)*x[2]**o+(0.106545346072)*x[2]
        arg[0,2,1,0]=(-0.482424571392)*x[0]**o+(0.0431208155652)*x[0]+(0.557138601636)*x[1]**o+(-0.725564282551)*x[1]+(0.9081107419)*x[2]**o+(0.0179201585352)*x[2]
        arg[0,2,1,1]=(-0.555731853052)*x[0]**o+(0.447137254671)*x[0]+(0.820958717703)*x[1]**o+(-0.580251434504)*x[1]+(0.227884622965)*x[2]**o+(0.34460189453)*x[2]
        arg[0,2,2,0]=(-0.25868983898)*x[0]**o+(0.759165881486)*x[0]+(-0.499903058341)*x[1]**o+(0.896471093639)*x[1]+(0.351955520633)*x[2]**o+(0.16566756566)*x[2]
        arg[0,2,2,1]=(-0.37859354794)*x[0]**o+(0.925387188779)*x[0]+(0.0111055293719)*x[1]**o+(-0.311998642154)*x[1]+(0.441009182046)*x[2]**o+(0.0968247918271)*x[2]
        arg[0,3,0,0]=(-0.461665900641)*x[0]**o+(0.812002051396)*x[0]+(-0.767456852027)*x[1]**o+(0.809069781575)*x[1]+(0.690416953885)*x[2]**o+(0.171662369216)*x[2]
        arg[0,3,0,1]=(-0.804811324639)*x[0]**o+(-0.0962711523954)*x[0]+(0.980130059825)*x[1]**o+(0.98279180603)*x[1]+(-0.0614353559054)*x[2]**o+(0.645637153538)*x[2]
        arg[0,3,1,0]=(0.97878415369)*x[0]**o+(-0.676321251698)*x[0]+(0.916075195717)*x[1]**o+(0.244509683371)*x[1]+(-0.939563193145)*x[2]**o+(-0.866506108913)*x[2]
        arg[0,3,1,1]=(-0.676965895162)*x[0]**o+(-0.124355338519)*x[0]+(0.680151101195)*x[1]**o+(-0.839412433156)*x[1]+(0.434088587223)*x[2]**o+(-0.275286048166)*x[2]
        arg[0,3,2,0]=(0.414822536626)*x[0]**o+(0.493836498194)*x[0]+(0.967077097745)*x[1]**o+(-0.0115301157869)*x[1]+(-0.307994657929)*x[2]**o+(-0.967766608312)*x[2]
        arg[0,3,2,1]=(-0.34064670348)*x[0]**o+(-0.975121872905)*x[0]+(0.0839457874766)*x[1]**o+(0.0995106978636)*x[1]+(-0.533837237516)*x[2]**o+(0.771268044302)*x[2]
        arg[0,4,0,0]=(0.223197544637)*x[0]**o+(0.712738871576)*x[0]+(-0.386972075747)*x[1]**o+(0.289829507744)*x[1]+(0.153418793839)*x[2]**o+(0.876087048492)*x[2]
        arg[0,4,0,1]=(0.696750948653)*x[0]**o+(0.466905335953)*x[0]+(-0.611476041907)*x[1]**o+(-0.939902457901)*x[1]+(-0.752675432265)*x[2]**o+(-0.869502717044)*x[2]
        arg[0,4,1,0]=(-0.465562201723)*x[0]**o+(-0.388716352051)*x[0]+(0.260044093503)*x[1]**o+(0.919379163294)*x[1]+(-0.902453394797)*x[2]**o+(0.378318744505)*x[2]
        arg[0,4,1,1]=(0.121990842946)*x[0]**o+(-0.691267894153)*x[0]+(-0.703960568755)*x[1]**o+(-0.582404896428)*x[1]+(0.57560180036)*x[2]**o+(0.537099448589)*x[2]
        arg[0,4,2,0]=(-0.495452196513)*x[0]**o+(-0.939389935669)*x[0]+(-0.237205717598)*x[1]**o+(0.61376516207)*x[1]+(-0.506082738728)*x[2]**o+(0.407704148542)*x[2]
        arg[0,4,2,1]=(0.450976180771)*x[0]**o+(-0.00739258898437)*x[0]+(0.210130848093)*x[1]**o+(0.624639007009)*x[1]+(0.173795671727)*x[2]**o+(0.508269170853)*x[2]
        arg[1,0,0,0]=(0.609685942177)*x[0]**o+(0.609299494609)*x[0]+(0.321046388121)*x[1]**o+(0.598197189498)*x[1]+(0.536092177618)*x[2]**o+(0.576427431157)*x[2]
        arg[1,0,0,1]=(0.412500706234)*x[0]**o+(0.905942239017)*x[0]+(-0.974980343169)*x[1]**o+(-0.131245997607)*x[1]+(0.745809068018)*x[2]**o+(0.543470258153)*x[2]
        arg[1,0,1,0]=(-0.903032545947)*x[0]**o+(-0.778693321051)*x[0]+(0.399342164105)*x[1]**o+(0.478212896767)*x[1]+(0.254596269802)*x[2]**o+(0.70308382001)*x[2]
        arg[1,0,1,1]=(-0.281529506793)*x[0]**o+(0.74166036027)*x[0]+(0.629713747725)*x[1]**o+(-0.275164746597)*x[1]+(0.37523909979)*x[2]**o+(-0.878026427978)*x[2]
        arg[1,0,2,0]=(0.236027764061)*x[0]**o+(-0.816910805083)*x[0]+(0.0782011624185)*x[1]**o+(-0.644004245666)*x[1]+(0.293586462602)*x[2]**o+(0.557045894695)*x[2]
        arg[1,0,2,1]=(0.868061727269)*x[0]**o+(0.53329318943)*x[0]+(0.367603915235)*x[1]**o+(0.89280277925)*x[1]+(-0.316595424948)*x[2]**o+(0.593830565147)*x[2]
        arg[1,1,0,0]=(0.886950595996)*x[0]**o+(-0.290323112286)*x[0]+(-0.863347030089)*x[1]**o+(0.545096994541)*x[1]+(0.338200944281)*x[2]**o+(-0.79898415048)*x[2]
        arg[1,1,0,1]=(0.103761462006)*x[0]**o+(-0.046916161864)*x[0]+(0.0312549239467)*x[1]**o+(0.214045118984)*x[1]+(-0.523161766402)*x[2]**o+(0.714207028317)*x[2]
        arg[1,1,1,0]=(0.494943183987)*x[0]**o+(-0.0543096386006)*x[0]+(-0.263875120588)*x[1]**o+(0.776031489925)*x[1]+(0.881224752145)*x[2]**o+(-0.650038283228)*x[2]
        arg[1,1,1,1]=(0.0871887540513)*x[0]**o+(-0.953848841349)*x[0]+(-0.223751459589)*x[1]**o+(0.227400823993)*x[1]+(-0.224200553009)*x[2]**o+(0.594012970899)*x[2]
        arg[1,1,2,0]=(-0.443116951346)*x[0]**o+(0.891806149626)*x[0]+(0.94731530917)*x[1]**o+(0.739499894809)*x[1]+(-0.92613053703)*x[2]**o+(0.464883087528)*x[2]
        arg[1,1,2,1]=(-0.149831145559)*x[0]**o+(0.913999704597)*x[0]+(0.76082978152)*x[1]**o+(-0.441535347622)*x[1]+(0.902841586936)*x[2]**o+(-0.509022004948)*x[2]
        arg[1,2,0,0]=(0.508230188489)*x[0]**o+(0.241669921231)*x[0]+(-0.802811365056)*x[1]**o+(0.298424305948)*x[1]+(-0.949407454532)*x[2]**o+(-0.131426880214)*x[2]
        arg[1,2,0,1]=(0.65372313274)*x[0]**o+(0.195891642771)*x[0]+(-0.160845429219)*x[1]**o+(0.500815823724)*x[1]+(0.875785249339)*x[2]**o+(0.325024339211)*x[2]
        arg[1,2,1,0]=(0.908405682536)*x[0]**o+(-0.146675166477)*x[0]+(0.24033815873)*x[1]**o+(-0.62814219771)*x[1]+(-0.512365788351)*x[2]**o+(-0.103817191415)*x[2]
        arg[1,2,1,1]=(0.824305237501)*x[0]**o+(0.175753992729)*x[0]+(0.992502114126)*x[1]**o+(0.973110627555)*x[1]+(0.355352002177)*x[2]**o+(0.112252263955)*x[2]
        arg[1,2,2,0]=(-0.485996285003)*x[0]**o+(-0.532551123887)*x[0]+(0.708205121405)*x[1]**o+(-0.803269038441)*x[1]+(-0.232049124534)*x[2]**o+(0.55437652866)*x[2]
        arg[1,2,2,1]=(0.551934776224)*x[0]**o+(0.727629664538)*x[0]+(0.197393511049)*x[1]**o+(-0.146619812174)*x[1]+(0.316592306936)*x[2]**o+(0.0263881493809)*x[2]
        arg[1,3,0,0]=(-0.918554166254)*x[0]**o+(-0.839150758884)*x[0]+(0.436713305329)*x[1]**o+(-0.410131731387)*x[1]+(0.321246028791)*x[2]**o+(0.706389384376)*x[2]
        arg[1,3,0,1]=(-0.870168753295)*x[0]**o+(-0.00473364206025)*x[0]+(0.594648540734)*x[1]**o+(-0.924887214906)*x[1]+(0.58858894515)*x[2]**o+(0.0152152159566)*x[2]
        arg[1,3,1,0]=(0.64005604234)*x[0]**o+(0.308265334836)*x[0]+(0.321645661286)*x[1]**o+(0.670017614875)*x[1]+(0.712764136703)*x[2]**o+(0.458986964342)*x[2]
        arg[1,3,1,1]=(-0.201376578944)*x[0]**o+(-0.271793865118)*x[0]+(-0.798181331582)*x[1]**o+(0.690100877945)*x[1]+(0.600350295622)*x[2]**o+(0.341066858436)*x[2]
        arg[1,3,2,0]=(0.459832113137)*x[0]**o+(0.0566780273877)*x[0]+(0.221723079112)*x[1]**o+(-0.681001728734)*x[1]+(0.265505135729)*x[2]**o+(-0.389365671367)*x[2]
        arg[1,3,2,1]=(0.715444384493)*x[0]**o+(-0.705697520786)*x[0]+(0.945208081248)*x[1]**o+(0.0233171867808)*x[1]+(0.740156166802)*x[2]**o+(-0.144314337012)*x[2]
        arg[1,4,0,0]=(-0.490162545806)*x[0]**o+(0.542981268396)*x[0]+(-0.841471465564)*x[1]**o+(0.79091798393)*x[1]+(0.245598142884)*x[2]**o+(0.4740296042)*x[2]
        arg[1,4,0,1]=(-0.504504615322)*x[0]**o+(0.45494067251)*x[0]+(-0.612427248728)*x[1]**o+(0.0880340051743)*x[1]+(0.645906227711)*x[2]**o+(0.772038416622)*x[2]
        arg[1,4,1,0]=(0.945538632492)*x[0]**o+(0.98519603491)*x[0]+(-0.245495451859)*x[1]**o+(-0.70732864026)*x[1]+(0.378733662069)*x[2]**o+(0.579554415018)*x[2]
        arg[1,4,1,1]=(0.886659064398)*x[0]**o+(-0.491870874438)*x[0]+(0.751814742427)*x[1]**o+(0.430589443767)*x[1]+(-0.729193959143)*x[2]**o+(-0.699344758538)*x[2]
        arg[1,4,2,0]=(-0.4190140481)*x[0]**o+(0.84509612452)*x[0]+(-0.263608911857)*x[1]**o+(0.693648282371)*x[1]+(-0.144463932166)*x[2]**o+(0.384293689266)*x[2]
        arg[1,4,2,1]=(-0.266973780787)*x[0]**o+(0.613988367707)*x[0]+(0.686955199789)*x[1]**o+(-0.301585818785)*x[1]+(-0.574601202558)*x[2]**o+(-0.430718616071)*x[2]
        arg[2,0,0,0]=(-0.117390727803)*x[0]**o+(-0.25850139145)*x[0]+(0.324909086031)*x[1]**o+(-0.593112241553)*x[1]+(-0.51016768177)*x[2]**o+(0.392299415334)*x[2]
        arg[2,0,0,1]=(0.290478531696)*x[0]**o+(0.758153023626)*x[0]+(0.531003993361)*x[1]**o+(-0.112481510374)*x[1]+(0.950222158203)*x[2]**o+(-0.742480526204)*x[2]
        arg[2,0,1,0]=(-0.754820921225)*x[0]**o+(-0.408482044077)*x[0]+(-0.229697426486)*x[1]**o+(-0.983010424713)*x[1]+(-0.286618604257)*x[2]**o+(-0.489034108451)*x[2]
        arg[2,0,1,1]=(0.96775757822)*x[0]**o+(0.797765725721)*x[0]+(-0.90936176648)*x[1]**o+(-0.372755885193)*x[1]+(-0.144727874143)*x[2]**o+(0.341624944551)*x[2]
        arg[2,0,2,0]=(0.672779422278)*x[0]**o+(-0.936102224964)*x[0]+(-0.763620352857)*x[1]**o+(0.265802509744)*x[1]+(0.275798875047)*x[2]**o+(0.235397520942)*x[2]
        arg[2,0,2,1]=(0.192866248041)*x[0]**o+(0.656863606616)*x[0]+(-0.902796948663)*x[1]**o+(0.692123089256)*x[1]+(0.311287987388)*x[2]**o+(0.555427507546)*x[2]
        arg[2,1,0,0]=(0.464585537593)*x[0]**o+(0.161744615208)*x[0]+(-0.325569920662)*x[1]**o+(-0.47142644441)*x[1]+(0.885151021784)*x[2]**o+(-0.840595219086)*x[2]
        arg[2,1,0,1]=(-0.659253397488)*x[0]**o+(0.54391314862)*x[0]+(-0.595612529952)*x[1]**o+(-0.0472758114379)*x[1]+(0.876391930188)*x[2]**o+(-0.440313199946)*x[2]
        arg[2,1,1,0]=(-0.445591423364)*x[0]**o+(0.179144841652)*x[0]+(-0.294166502086)*x[1]**o+(-0.373820778739)*x[1]+(0.464609314863)*x[2]**o+(0.407893781978)*x[2]
        arg[2,1,1,1]=(-0.767512700255)*x[0]**o+(0.63198312168)*x[0]+(0.652318598902)*x[1]**o+(0.817874971823)*x[1]+(0.397211574885)*x[2]**o+(0.33174354886)*x[2]
        arg[2,1,2,0]=(0.473801282131)*x[0]**o+(-0.778895701394)*x[0]+(-0.801488721847)*x[1]**o+(-0.585840161723)*x[1]+(-0.805496721223)*x[2]**o+(0.585971840421)*x[2]
        arg[2,1,2,1]=(0.472329620891)*x[0]**o+(-0.0473805663117)*x[0]+(0.0894117727522)*x[1]**o+(-0.308473625733)*x[1]+(-0.658376953956)*x[2]**o+(0.32027592346)*x[2]
        arg[2,2,0,0]=(0.843241796369)*x[0]**o+(0.346857959798)*x[0]+(0.0111223078269)*x[1]**o+(-0.949623227267)*x[1]+(-0.152362393376)*x[2]**o+(-0.886340001141)*x[2]
        arg[2,2,0,1]=(-0.555393018762)*x[0]**o+(0.666364344488)*x[0]+(0.181237902671)*x[1]**o+(0.670959040345)*x[1]+(0.57383285317)*x[2]**o+(-0.451027832775)*x[2]
        arg[2,2,1,0]=(0.249709446431)*x[0]**o+(0.568753063379)*x[0]+(-0.812386750097)*x[1]**o+(0.506805124672)*x[1]+(-0.454844217662)*x[2]**o+(0.843435269288)*x[2]
        arg[2,2,1,1]=(0.753144930025)*x[0]**o+(0.0181642998269)*x[0]+(0.622635241593)*x[1]**o+(-0.372883842874)*x[1]+(0.366920965577)*x[2]**o+(-0.092391524816)*x[2]
        arg[2,2,2,0]=(0.309601906611)*x[0]**o+(-0.502573192965)*x[0]+(-0.420795137333)*x[1]**o+(-0.807109356307)*x[1]+(-0.802887583918)*x[2]**o+(0.552609684817)*x[2]
        arg[2,2,2,1]=(0.320933223342)*x[0]**o+(0.541931544704)*x[0]+(0.988715316931)*x[1]**o+(-0.4197325237)*x[1]+(-0.438705512435)*x[2]**o+(-0.540175093599)*x[2]
        arg[2,3,0,0]=(0.018870015518)*x[0]**o+(-0.615120691773)*x[0]+(0.596295280542)*x[1]**o+(0.210874310884)*x[1]+(-0.652194502321)*x[2]**o+(0.74019575754)*x[2]
        arg[2,3,0,1]=(0.820285141622)*x[0]**o+(0.130985741886)*x[0]+(-0.397387767472)*x[1]**o+(0.975103051154)*x[1]+(0.0887369214611)*x[2]**o+(0.88498731668)*x[2]
        arg[2,3,1,0]=(0.160503336808)*x[0]**o+(0.641180113144)*x[0]+(-0.408109675737)*x[1]**o+(-0.355443951133)*x[1]+(-0.429622016495)*x[2]**o+(0.998729833779)*x[2]
        arg[2,3,1,1]=(-0.646524352112)*x[0]**o+(-0.289894880059)*x[0]+(0.909761879864)*x[1]**o+(0.30453651619)*x[1]+(0.884596709091)*x[2]**o+(0.329408737003)*x[2]
        arg[2,3,2,0]=(0.459385919432)*x[0]**o+(0.416447271916)*x[0]+(-0.400798659819)*x[1]**o+(-0.769043818187)*x[1]+(-0.631682400803)*x[2]**o+(-0.80150361084)*x[2]
        arg[2,3,2,1]=(-0.544824298969)*x[0]**o+(0.191301965562)*x[0]+(0.41061102918)*x[1]**o+(-0.999195759064)*x[1]+(-0.0226105975802)*x[2]**o+(-0.137078691725)*x[2]
        arg[2,4,0,0]=(-0.624033952375)*x[0]**o+(0.0792222332007)*x[0]+(0.766756718455)*x[1]**o+(0.581487379511)*x[1]+(-0.437940391245)*x[2]**o+(0.115617341492)*x[2]
        arg[2,4,0,1]=(-0.300526068838)*x[0]**o+(-0.822844066866)*x[0]+(0.660949310367)*x[1]**o+(-0.0993949179102)*x[1]+(0.599884615655)*x[2]**o+(-0.903177033523)*x[2]
        arg[2,4,1,0]=(-0.654642517091)*x[0]**o+(0.428391621765)*x[0]+(0.932377441464)*x[1]**o+(-0.459525189684)*x[1]+(0.667425199675)*x[2]**o+(-0.937213410686)*x[2]
        arg[2,4,1,1]=(0.258067525957)*x[0]**o+(0.619943768383)*x[0]+(0.458217567511)*x[1]**o+(0.0812191081554)*x[1]+(0.743260637332)*x[2]**o+(-0.796150472293)*x[2]
        arg[2,4,2,0]=(0.782473636556)*x[0]**o+(-0.441405613305)*x[0]+(0.3951595327)*x[1]**o+(-0.449855781187)*x[1]+(-0.964130179212)*x[2]**o+(-0.299199410525)*x[2]
        arg[2,4,2,1]=(-0.878340584397)*x[0]**o+(-0.674575785429)*x[0]+(0.838137461257)*x[1]**o+(-0.498710475715)*x[1]+(-0.117205127994)*x[2]**o+(0.0934669704542)*x[2]
        arg[3,0,0,0]=(0.139631366137)*x[0]**o+(-0.893001605238)*x[0]+(-0.420780773096)*x[1]**o+(0.439055863393)*x[1]+(0.173113363237)*x[2]**o+(0.893867443017)*x[2]
        arg[3,0,0,1]=(-0.804823042124)*x[0]**o+(0.250231181298)*x[0]+(0.358464048439)*x[1]**o+(-0.847391231172)*x[1]+(-0.515391975323)*x[2]**o+(-0.999640302937)*x[2]
        arg[3,0,1,0]=(0.328676968943)*x[0]**o+(-0.0521242139559)*x[0]+(0.861548411537)*x[1]**o+(-0.288979961428)*x[1]+(-0.927901849987)*x[2]**o+(0.857869958971)*x[2]
        arg[3,0,1,1]=(-0.654866876537)*x[0]**o+(-0.0515462321916)*x[0]+(-0.224164685097)*x[1]**o+(-0.84207399757)*x[1]+(-0.442392040219)*x[2]**o+(-0.915734076984)*x[2]
        arg[3,0,2,0]=(-0.322517406382)*x[0]**o+(-0.757146499161)*x[0]+(-0.541690197465)*x[1]**o+(0.931090695413)*x[1]+(-0.355505263744)*x[2]**o+(-0.773185404514)*x[2]
        arg[3,0,2,1]=(0.421030649833)*x[0]**o+(-0.83768939688)*x[0]+(-0.863791071447)*x[1]**o+(0.78393205545)*x[1]+(-0.489893911681)*x[2]**o+(-0.291989245709)*x[2]
        arg[3,1,0,0]=(0.550839051007)*x[0]**o+(-0.883853789938)*x[0]+(-0.339529971923)*x[1]**o+(-0.756936847344)*x[1]+(0.724888858656)*x[2]**o+(-0.981057762224)*x[2]
        arg[3,1,0,1]=(0.711792743156)*x[0]**o+(0.233248429378)*x[0]+(0.526076154408)*x[1]**o+(0.349364804166)*x[1]+(0.271475992486)*x[2]**o+(0.782429402713)*x[2]
        arg[3,1,1,0]=(-0.499072848146)*x[0]**o+(-0.0604888692308)*x[0]+(0.545442893272)*x[1]**o+(-0.688797522515)*x[1]+(0.305341295222)*x[2]**o+(0.130010601331)*x[2]
        arg[3,1,1,1]=(0.940695359452)*x[0]**o+(0.113015472294)*x[0]+(-0.506254395321)*x[1]**o+(-0.252044277039)*x[1]+(0.0172784972094)*x[2]**o+(-0.184256978193)*x[2]
        arg[3,1,2,0]=(0.550472143981)*x[0]**o+(-0.729809590776)*x[0]+(-0.293765999495)*x[1]**o+(-0.378042976721)*x[1]+(0.973242167993)*x[2]**o+(-0.75350391134)*x[2]
        arg[3,1,2,1]=(0.369266178598)*x[0]**o+(-0.764034492366)*x[0]+(-0.713325992328)*x[1]**o+(0.948932375717)*x[1]+(-0.335074977323)*x[2]**o+(0.117829591745)*x[2]
        arg[3,2,0,0]=(0.426458076699)*x[0]**o+(-0.520551329627)*x[0]+(-0.773464312884)*x[1]**o+(0.26332468989)*x[1]+(0.143497828773)*x[2]**o+(0.0676278275986)*x[2]
        arg[3,2,0,1]=(0.85806016531)*x[0]**o+(0.755361032731)*x[0]+(0.403942188112)*x[1]**o+(0.0113665816202)*x[1]+(-0.439835633198)*x[2]**o+(0.620930145183)*x[2]
        arg[3,2,1,0]=(-0.852838624821)*x[0]**o+(-0.918594624263)*x[0]+(-0.572898555139)*x[1]**o+(-0.14353390918)*x[1]+(-0.716010071307)*x[2]**o+(0.134687635305)*x[2]
        arg[3,2,1,1]=(-0.14282590746)*x[0]**o+(-0.169314199229)*x[0]+(0.880745511071)*x[1]**o+(0.540733710441)*x[1]+(-0.131424658303)*x[2]**o+(-0.93209431119)*x[2]
        arg[3,2,2,0]=(-0.864016075688)*x[0]**o+(-0.265794760131)*x[0]+(0.444625188371)*x[1]**o+(0.133693703972)*x[1]+(-0.749799597936)*x[2]**o+(0.886355820615)*x[2]
        arg[3,2,2,1]=(0.676281241167)*x[0]**o+(-0.351800298325)*x[0]+(-0.751498380099)*x[1]**o+(-0.561737786104)*x[1]+(-0.984872672853)*x[2]**o+(0.476840947707)*x[2]
        arg[3,3,0,0]=(0.457874366022)*x[0]**o+(-0.126929649966)*x[0]+(0.666077559139)*x[1]**o+(-0.966437669224)*x[1]+(-0.849000502816)*x[2]**o+(0.990790747926)*x[2]
        arg[3,3,0,1]=(0.45136859326)*x[0]**o+(0.771355456911)*x[0]+(-0.678558472676)*x[1]**o+(0.0366869703264)*x[1]+(-0.257247358952)*x[2]**o+(-0.290852285538)*x[2]
        arg[3,3,1,0]=(-0.623007069616)*x[0]**o+(-0.365255080044)*x[0]+(0.441927420573)*x[1]**o+(0.331640625664)*x[1]+(-0.21153951456)*x[2]**o+(0.297967669123)*x[2]
        arg[3,3,1,1]=(-0.836057742118)*x[0]**o+(0.959873293328)*x[0]+(-0.52034405502)*x[1]**o+(-0.178838686591)*x[1]+(0.317610563306)*x[2]**o+(-0.555134650833)*x[2]
        arg[3,3,2,0]=(0.0819108022024)*x[0]**o+(0.69432296821)*x[0]+(-0.23685434367)*x[1]**o+(-0.0442137744391)*x[1]+(-0.879175086057)*x[2]**o+(-0.28031950012)*x[2]
        arg[3,3,2,1]=(0.340083286763)*x[0]**o+(-0.381942838645)*x[0]+(0.570579443852)*x[1]**o+(0.772192708863)*x[1]+(0.42813556157)*x[2]**o+(0.735683065499)*x[2]
        arg[3,4,0,0]=(-0.866813692418)*x[0]**o+(-0.53715159706)*x[0]+(0.0725900211922)*x[1]**o+(0.0891167848614)*x[1]+(-0.381482922347)*x[2]**o+(-0.521504123034)*x[2]
        arg[3,4,0,1]=(0.487750922723)*x[0]**o+(0.967820473849)*x[0]+(0.305600886352)*x[1]**o+(0.350777657643)*x[1]+(-0.383731485788)*x[2]**o+(0.814016126476)*x[2]
        arg[3,4,1,0]=(-0.186663244344)*x[0]**o+(0.144872424379)*x[0]+(0.844454339304)*x[1]**o+(0.252133708483)*x[1]+(-0.748235508222)*x[2]**o+(0.702952185343)*x[2]
        arg[3,4,1,1]=(-0.962296047927)*x[0]**o+(0.874277032826)*x[0]+(-0.404689253219)*x[1]**o+(-0.174075799004)*x[1]+(0.65086350106)*x[2]**o+(-0.109850650677)*x[2]
        arg[3,4,2,0]=(-0.59515836027)*x[0]**o+(-0.0917296352911)*x[0]+(0.834779238353)*x[1]**o+(0.951252871777)*x[1]+(0.983008684497)*x[2]**o+(-0.784806954891)*x[2]
        arg[3,4,2,1]=(0.603110971708)*x[0]**o+(0.291507042984)*x[0]+(-0.401523286981)*x[1]**o+(-0.994760476862)*x[1]+(0.410516007475)*x[2]**o+(0.368982230001)*x[2]
        ref[0,0,0,0]=(-0.322384218211)/(o+1.)+(0.436168366323)
        ref[0,0,0,1]=(-0.550432608405)/(o+1.)+(-0.839529924682)
        ref[0,0,1,0]=(-1.20222931022)/(o+1.)+(-0.674931792543)
        ref[0,0,1,1]=(-1.99447702496)/(o+1.)+(0.184076712997)
        ref[0,0,2,0]=(-0.848786191606)/(o+1.)+(-0.719076228559)
        ref[0,0,2,1]=(0.488199570726)/(o+1.)+(0.818508727159)
        ref[0,1,0,0]=(0.910006770156)/(o+1.)+(-0.781077934994)
        ref[0,1,0,1]=(0.229140786917)/(o+1.)+(0.225201244712)
        ref[0,1,1,0]=(-1.24973037868)/(o+1.)+(0.478630842756)
        ref[0,1,1,1]=(0.362813222831)/(o+1.)+(-0.269799066354)
        ref[0,1,2,0]=(0.704186070044)/(o+1.)+(-0.0666602572428)
        ref[0,1,2,1]=(-0.429870561459)/(o+1.)+(-0.692214543685)
        ref[0,2,0,0]=(-1.76040621668)/(o+1.)+(-0.103077097544)
        ref[0,2,0,1]=(-0.578245990054)/(o+1.)+(-0.24050068432)
        ref[0,2,1,0]=(0.982824772144)/(o+1.)+(-0.332261654225)
        ref[0,2,1,1]=(0.493111487615)/(o+1.)+(0.105743857349)
        ref[0,2,2,0]=(-0.406637376689)/(o+1.)+(0.910652270393)
        ref[0,2,2,1]=(0.0735211634779)/(o+1.)+(0.355106669226)
        ref[0,3,0,0]=(-0.538705798782)/(o+1.)+(0.896367101094)
        ref[0,3,0,1]=(0.11388337928)/(o+1.)+(0.766078903586)
        ref[0,3,1,0]=(0.955296156262)/(o+1.)+(-0.64915883862)
        ref[0,3,1,1]=(0.437273793256)/(o+1.)+(-0.61952690992)
        ref[0,3,2,0]=(1.07390497644)/(o+1.)+(-0.242730112953)
        ref[0,3,2,1]=(-0.79053815352)/(o+1.)+(-0.0521715653697)
        ref[0,4,0,0]=(-0.0103557372704)/(o+1.)+(0.939327713906)
        ref[0,4,0,1]=(-0.66740052552)/(o+1.)+(-0.671249919496)
        ref[0,4,1,0]=(-1.10797150302)/(o+1.)+(0.454490777873)
        ref[0,4,1,1]=(-0.00636792544909)/(o+1.)+(-0.368286670996)
        ref[0,4,2,0]=(-1.23874065284)/(o+1.)+(0.0410396874718)
        ref[0,4,2,1]=(0.834902700591)/(o+1.)+(0.562757794439)
        ref[1,0,0,0]=(1.46682450791)/(o+1.)+(0.891962057632)
        ref[1,0,0,1]=(0.183329431084)/(o+1.)+(0.659083249781)
        ref[1,0,1,0]=(-0.24909411204)/(o+1.)+(0.201301697863)
        ref[1,0,1,1]=(0.723423340723)/(o+1.)+(-0.205765407152)
        ref[1,0,2,0]=(0.607815389082)/(o+1.)+(-0.451934578027)
        ref[1,0,2,1]=(0.919070217555)/(o+1.)+(1.00996326691)
        ref[1,1,0,0]=(0.361804510188)/(o+1.)+(-0.272105134113)
        ref[1,1,0,1]=(-0.388145380449)/(o+1.)+(0.440667992719)
        ref[1,1,1,0]=(1.11229281554)/(o+1.)+(0.0358417840478)
        ref[1,1,1,1]=(-0.360763258547)/(o+1.)+(-0.0662175232282)
        ref[1,1,2,0]=(-0.421932179206)/(o+1.)+(1.04809456598)
        ref[1,1,2,1]=(1.5138402229)/(o+1.)+(-0.0182788239862)
        ref[1,2,0,0]=(-1.2439886311)/(o+1.)+(0.204333673483)
        ref[1,2,0,1]=(1.36866295286)/(o+1.)+(0.510865902853)
        ref[1,2,1,0]=(0.636378052915)/(o+1.)+(-0.439317277801)
        ref[1,2,1,1]=(2.1721593538)/(o+1.)+(0.63055844212)
        ref[1,2,2,0]=(-0.00984028813171)/(o+1.)+(-0.390721816834)
        ref[1,2,2,1]=(1.06592059421)/(o+1.)+(0.303699000873)
        ref[1,3,0,0]=(-0.160594832134)/(o+1.)+(-0.271446552947)
        ref[1,3,0,1]=(0.313068732589)/(o+1.)+(-0.457202820505)
        ref[1,3,1,0]=(1.67446584033)/(o+1.)+(0.718634957026)
        ref[1,3,1,1]=(-0.399207614903)/(o+1.)+(0.379686935632)
        ref[1,3,2,0]=(0.947060327978)/(o+1.)+(-0.506844686357)
        ref[1,3,2,1]=(2.40080863254)/(o+1.)+(-0.413347335508)
        ref[1,4,0,0]=(-1.08603586849)/(o+1.)+(0.903964428263)
        ref[1,4,0,1]=(-0.471025636339)/(o+1.)+(0.657506547153)
        ref[1,4,1,0]=(1.0787768427)/(o+1.)+(0.428710904834)
        ref[1,4,1,1]=(0.909279847682)/(o+1.)+(-0.380313094604)
        ref[1,4,2,0]=(-0.827086892123)/(o+1.)+(0.961519048079)
        ref[1,4,2,1]=(-0.154619783556)/(o+1.)+(-0.0591580335741)
        ref[2,0,0,0]=(-0.302649323542)/(o+1.)+(-0.229657108834)
        ref[2,0,0,1]=(1.77170468326)/(o+1.)+(-0.0484045064764)
        ref[2,0,1,0]=(-1.27113695197)/(o+1.)+(-0.94026328862)
        ref[2,0,1,1]=(-0.0863320624027)/(o+1.)+(0.383317392539)
        ref[2,0,2,0]=(0.184957944467)/(o+1.)+(-0.217451097139)
        ref[2,0,2,1]=(-0.398642713235)/(o+1.)+(0.952207101709)
        ref[2,1,0,0]=(1.02416663872)/(o+1.)+(-0.575138524144)
        ref[2,1,0,1]=(-0.378473997252)/(o+1.)+(0.0281620686178)
        ref[2,1,1,0]=(-0.275148610588)/(o+1.)+(0.106608922446)
        ref[2,1,1,1]=(0.282017473532)/(o+1.)+(0.890800821181)
        ref[2,1,2,0]=(-1.13318416094)/(o+1.)+(-0.389382011348)
        ref[2,1,2,1]=(-0.0966355603128)/(o+1.)+(-0.0177891342927)
        ref[2,2,0,0]=(0.70200171082)/(o+1.)+(-0.744552634305)
        ref[2,2,0,1]=(0.199677737079)/(o+1.)+(0.443147776029)
        ref[2,2,1,0]=(-1.01752152133)/(o+1.)+(0.959496728669)
        ref[2,2,1,1]=(1.74270113719)/(o+1.)+(-0.223555533932)
        ref[2,2,2,0]=(-0.91408081464)/(o+1.)+(-0.378536432227)
        ref[2,2,2,1]=(0.870943027839)/(o+1.)+(-0.208988036298)
        ref[2,3,0,0]=(-0.0370292062615)/(o+1.)+(0.167974688326)
        ref[2,3,0,1]=(0.51163429561)/(o+1.)+(0.99553805486)
        ref[2,3,1,0]=(-0.677228355424)/(o+1.)+(0.642232997895)
        ref[2,3,1,1]=(1.14783423684)/(o+1.)+(0.172025186567)
        ref[2,3,2,0]=(-0.57309514119)/(o+1.)+(-0.577050078555)
        ref[2,3,2,1]=(-0.156823867369)/(o+1.)+(-0.472486242613)
        ref[2,4,0,0]=(-0.295217625165)/(o+1.)+(0.388163477102)
        ref[2,4,0,1]=(0.960307857184)/(o+1.)+(-0.91270800915)
        ref[2,4,1,0]=(0.945160124047)/(o+1.)+(-0.484173489303)
        ref[2,4,1,1]=(1.4595457308)/(o+1.)+(-0.0474937978771)
        ref[2,4,2,0]=(0.213502990044)/(o+1.)+(-0.595230402509)
        ref[2,4,2,1]=(-0.157408251134)/(o+1.)+(-0.539909645345)
        ref[3,0,0,0]=(-0.108036043722)/(o+1.)+(0.219960850586)
        ref[3,0,0,1]=(-0.961750969008)/(o+1.)+(-0.798400176406)
        ref[3,0,1,0]=(0.262323530493)/(o+1.)+(0.258382891794)
        ref[3,0,1,1]=(-1.32142360185)/(o+1.)+(-0.904677153373)
        ref[3,0,2,0]=(-1.21971286759)/(o+1.)+(-0.299620604131)
        ref[3,0,2,1]=(-0.932654333294)/(o+1.)+(-0.17287329357)
        ref[3,1,0,0]=(0.93619793774)/(o+1.)+(-1.31092419975)
        ref[3,1,0,1]=(1.50934489005)/(o+1.)+(0.682521318129)
        ref[3,1,1,0]=(0.351711340348)/(o+1.)+(-0.309637895207)
        ref[3,1,1,1]=(0.451719461341)/(o+1.)+(-0.161642891469)
        ref[3,1,2,0]=(1.22994831248)/(o+1.)+(-0.930678239419)
        ref[3,1,2,1]=(-0.679134791053)/(o+1.)+(0.151363737548)
        ref[3,2,0,0]=(-0.203508407413)/(o+1.)+(-0.0947994060691)
        ref[3,2,0,1]=(0.822166720224)/(o+1.)+(0.693828879767)
        ref[3,2,1,0]=(-2.14174725127)/(o+1.)+(-0.463720449069)
        ref[3,2,1,1]=(0.606494945308)/(o+1.)+(-0.280337399989)
        ref[3,2,2,0]=(-1.16919048525)/(o+1.)+(0.377127382228)
        ref[3,2,2,1]=(-1.06008981178)/(o+1.)+(-0.218348568361)
        ref[3,3,0,0]=(0.274951422345)/(o+1.)+(-0.0512882856318)
        ref[3,3,0,1]=(-0.484437238367)/(o+1.)+(0.25859507085)
        ref[3,3,1,0]=(-0.392619163603)/(o+1.)+(0.132176607371)
        ref[3,3,1,1]=(-1.03879123383)/(o+1.)+(0.112949977952)
        ref[3,3,2,0]=(-1.03411862752)/(o+1.)+(0.184894846825)
        ref[3,3,2,1]=(1.33879829218)/(o+1.)+(0.562966467859)
        ref[3,4,0,0]=(-1.17570659357)/(o+1.)+(-0.484769467616)
        ref[3,4,0,1]=(0.409620323287)/(o+1.)+(1.06630712898)
        ref[3,4,1,0]=(-0.0904444132627)/(o+1.)+(0.549979159103)
        ref[3,4,1,1]=(-0.716121800087)/(o+1.)+(0.295175291572)
        ref[3,4,2,0]=(1.22262956258)/(o+1.)+(0.0373581407971)
        ref[3,4,2,1]=(0.612103692201)/(o+1.)+(-0.167135601938)
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-0.640162884104)*x[0]**o+(-0.686170347303)*x[0]+(0.0531418393824)*x[1]**o+(-0.0288840863965)*x[1]
        ref=(-0.587021044721)/(o+1.)+(-0.35752721685)
      else:
        s=(0.835059122976)*x[0]**o+(-0.876192510448)*x[0]+(0.229125107737)*x[1]**o+(-0.378923833918)*x[1]+(0.734383439043)*x[2]**o+(0.987756783011)*x[2]
        ref=(1.79856766975)/(o+1.)+(-0.133679780678)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.292137623974)*x[0]**o+(0.75950865395)*x[0]+(-0.205837757637)*x[1]**o+(0.90443054103)*x[1]
        s[1]=(0.407997882771)*x[0]**o+(0.335693471916)*x[0]+(0.755336837856)*x[1]**o+(0.218679559306)*x[1]
        ref[0]=(-0.497975381612)/(o+1.)+(0.83196959749)
        ref[1]=(1.16333472063)/(o+1.)+(0.277186515611)
      else:
        s[0]=(-0.393835090841)*x[0]**o+(-0.474828597107)*x[0]+(0.465782088981)*x[1]**o+(-0.882630637032)*x[1]+(0.849599914303)*x[2]**o+(0.737421732808)*x[2]
        s[1]=(-0.589146617652)*x[0]**o+(-0.412139119114)*x[0]+(0.970406630484)*x[1]**o+(0.363942463909)*x[1]+(-0.372574721521)*x[2]**o+(-0.798081163974)*x[2]
        ref[0]=(0.921546912444)/(o+1.)+(-0.310018750665)
        ref[1]=(0.00868529131054)/(o+1.)+(-0.42313890959)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.542564643665)*x[0]**o+(0.869139399504)*x[0]+(-0.918464318956)*x[1]**o+(0.258557879364)*x[1]
        s[0,1]=(0.797108788422)*x[0]**o+(-0.200368785173)*x[0]+(-0.518597299854)*x[1]**o+(-0.647852667874)*x[1]
        s[0,2]=(0.692223658744)*x[0]**o+(-0.103586429107)*x[0]+(0.282165531986)*x[1]**o+(-0.191815912482)*x[1]
        s[0,3]=(-0.370167730862)*x[0]**o+(-0.822713005318)*x[0]+(-0.00317012401339)*x[1]**o+(-0.848121245241)*x[1]
        s[0,4]=(-0.52733376174)*x[0]**o+(-0.314966701977)*x[0]+(0.755974759737)*x[1]**o+(-0.483207203205)*x[1]
        s[1,0]=(-0.709714610043)*x[0]**o+(0.647231907198)*x[0]+(-0.577474021122)*x[1]**o+(-0.124504757353)*x[1]
        s[1,1]=(-0.723690611716)*x[0]**o+(-0.617424586153)*x[0]+(-0.536447933353)*x[1]**o+(0.255892253884)*x[1]
        s[1,2]=(-0.201052994401)*x[0]**o+(-0.519971533366)*x[0]+(0.515314592901)*x[1]**o+(0.831783913039)*x[1]
        s[1,3]=(0.505769313912)*x[0]**o+(-0.460235423669)*x[0]+(0.982458353968)*x[1]**o+(0.479022475503)*x[1]
        s[1,4]=(0.624910824579)*x[0]**o+(0.563956018517)*x[0]+(0.0129379080194)*x[1]**o+(-0.634601977633)*x[1]
        s[2,0]=(-0.765921383834)*x[0]**o+(0.0199045688425)*x[0]+(-0.0666443330576)*x[1]**o+(-0.929035862007)*x[1]
        s[2,1]=(0.698423948822)*x[0]**o+(-0.529311289681)*x[0]+(-0.563339072497)*x[1]**o+(-0.494985449663)*x[1]
        s[2,2]=(0.101812328764)*x[0]**o+(-0.922547259485)*x[0]+(-0.45388897835)*x[1]**o+(0.357458826452)*x[1]
        s[2,3]=(0.643691149734)*x[0]**o+(-0.791395473264)*x[0]+(-0.919285047298)*x[1]**o+(-0.732314921151)*x[1]
        s[2,4]=(0.770509137995)*x[0]**o+(-0.399023743738)*x[0]+(-0.0887239237676)*x[1]**o+(0.846766840231)*x[1]
        s[3,0]=(-0.258188916476)*x[0]**o+(-0.192762172857)*x[0]+(-0.291360534186)*x[1]**o+(-0.828483492861)*x[1]
        s[3,1]=(-0.180563503871)*x[0]**o+(0.411356882323)*x[0]+(0.144166964346)*x[1]**o+(-0.817750491386)*x[1]
        s[3,2]=(-0.56008111033)*x[0]**o+(-0.903908126304)*x[0]+(-0.795710525329)*x[1]**o+(0.42957467817)*x[1]
        s[3,3]=(-0.435823321725)*x[0]**o+(-0.687506280092)*x[0]+(0.512172892719)*x[1]**o+(0.624268656549)*x[1]
        s[3,4]=(0.0995998270974)*x[0]**o+(0.54337587883)*x[0]+(-0.589282344971)*x[1]**o+(0.551709444954)*x[1]
        ref[0,0]=(-0.375899675291)/(o+1.)+(0.563848639434)
        ref[0,1]=(0.278511488568)/(o+1.)+(-0.424110726524)
        ref[0,2]=(0.97438919073)/(o+1.)+(-0.147701170794)
        ref[0,3]=(-0.373337854876)/(o+1.)+(-0.835417125279)
        ref[0,4]=(0.228640997997)/(o+1.)+(-0.399086952591)
        ref[1,0]=(-1.28718863116)/(o+1.)+(0.261363574923)
        ref[1,1]=(-1.26013854507)/(o+1.)+(-0.180766166134)
        ref[1,2]=(0.3142615985)/(o+1.)+(0.155906189837)
        ref[1,3]=(1.48822766788)/(o+1.)+(0.00939352591692)
        ref[1,4]=(0.637848732599)/(o+1.)+(-0.0353229795581)
        ref[2,0]=(-0.832565716891)/(o+1.)+(-0.454565646582)
        ref[2,1]=(0.135084876326)/(o+1.)+(-0.512148369672)
        ref[2,2]=(-0.352076649587)/(o+1.)+(-0.282544216517)
        ref[2,3]=(-0.275593897564)/(o+1.)+(-0.761855197208)
        ref[2,4]=(0.681785214228)/(o+1.)+(0.223871548247)
        ref[3,0]=(-0.549549450662)/(o+1.)+(-0.510622832859)
        ref[3,1]=(-0.0363965395244)/(o+1.)+(-0.203196804532)
        ref[3,2]=(-1.35579163566)/(o+1.)+(-0.237166724067)
        ref[3,3]=(0.0763495709944)/(o+1.)+(-0.0316188117717)
        ref[3,4]=(-0.489682517873)/(o+1.)+(0.547542661892)
      else:
        s[0,0]=(-0.547777970569)*x[0]**o+(-0.644569779184)*x[0]+(-0.247447574507)*x[1]**o+(-0.165674972238)*x[1]+(0.492011982518)*x[2]**o+(0.824373100652)*x[2]
        s[0,1]=(0.714120627471)*x[0]**o+(-0.343344240726)*x[0]+(0.846874965081)*x[1]**o+(0.955417725709)*x[1]+(-0.462347625853)*x[2]**o+(0.236518016678)*x[2]
        s[0,2]=(0.649286582806)*x[0]**o+(-0.712764590386)*x[0]+(-0.364435855331)*x[1]**o+(0.529624579838)*x[1]+(-0.478005452391)*x[2]**o+(0.79676822654)*x[2]
        s[0,3]=(0.186538430487)*x[0]**o+(0.873009863028)*x[0]+(-0.617246224023)*x[1]**o+(0.212670710234)*x[1]+(-0.568924203263)*x[2]**o+(-0.591868989872)*x[2]
        s[0,4]=(0.0764403834746)*x[0]**o+(0.580116472215)*x[0]+(-0.964832163438)*x[1]**o+(0.146621202039)*x[1]+(0.303667547632)*x[2]**o+(-0.572109268772)*x[2]
        s[1,0]=(0.0466497527173)*x[0]**o+(-0.660397185235)*x[0]+(0.314235627776)*x[1]**o+(-0.0219053335847)*x[1]+(0.0341017375209)*x[2]**o+(-0.138388505919)*x[2]
        s[1,1]=(-0.306253609605)*x[0]**o+(-0.274894845016)*x[0]+(0.590915613652)*x[1]**o+(0.466423547973)*x[1]+(-0.65224024787)*x[2]**o+(0.011478276889)*x[2]
        s[1,2]=(-0.850811667442)*x[0]**o+(-0.362611692783)*x[0]+(-0.132198189858)*x[1]**o+(0.613225855964)*x[1]+(-0.995844863385)*x[2]**o+(-0.00228774595319)*x[2]
        s[1,3]=(-0.331021120468)*x[0]**o+(0.262316324101)*x[0]+(0.693647465307)*x[1]**o+(-0.758663328061)*x[1]+(0.563291863323)*x[2]**o+(-0.464786381036)*x[2]
        s[1,4]=(-0.297063926313)*x[0]**o+(0.258694451069)*x[0]+(0.453986223203)*x[1]**o+(0.516652862875)*x[1]+(-0.119453447306)*x[2]**o+(0.13369866553)*x[2]
        s[2,0]=(0.895304992051)*x[0]**o+(-0.581521556328)*x[0]+(-0.102534354406)*x[1]**o+(-0.312191328622)*x[1]+(0.00625028874943)*x[2]**o+(0.455967398752)*x[2]
        s[2,1]=(0.0129094351309)*x[0]**o+(-0.284360799298)*x[0]+(0.254610787505)*x[1]**o+(0.232923077121)*x[1]+(0.884382417671)*x[2]**o+(0.879710026011)*x[2]
        s[2,2]=(0.978354808904)*x[0]**o+(0.45417061753)*x[0]+(-0.617831296441)*x[1]**o+(-0.540161947193)*x[1]+(0.749817874967)*x[2]**o+(0.85276098284)*x[2]
        s[2,3]=(0.790036783517)*x[0]**o+(-0.461944315129)*x[0]+(0.0177930616139)*x[1]**o+(0.827267186021)*x[1]+(-0.5681970366)*x[2]**o+(0.0800529373343)*x[2]
        s[2,4]=(0.320372577784)*x[0]**o+(-0.988843069534)*x[0]+(0.366830399498)*x[1]**o+(0.0749365557309)*x[1]+(-0.964416326732)*x[2]**o+(0.0589434543979)*x[2]
        s[3,0]=(-0.143156890467)*x[0]**o+(0.665143613007)*x[0]+(0.324524292861)*x[1]**o+(0.573292071297)*x[1]+(0.55975986068)*x[2]**o+(-0.703161304253)*x[2]
        s[3,1]=(0.827768123756)*x[0]**o+(-0.565184841493)*x[0]+(0.724124619351)*x[1]**o+(-0.375933144184)*x[1]+(-0.186573364344)*x[2]**o+(0.174303241336)*x[2]
        s[3,2]=(0.19505934899)*x[0]**o+(-0.378308488179)*x[0]+(-0.542115440091)*x[1]**o+(-0.864956237152)*x[1]+(0.0489116293809)*x[2]**o+(0.149786871599)*x[2]
        s[3,3]=(-0.151225736973)*x[0]**o+(-0.491229793833)*x[0]+(-0.704529608083)*x[1]**o+(-0.790051884866)*x[1]+(-0.202633581578)*x[2]**o+(0.0769118984781)*x[2]
        s[3,4]=(0.523527337562)*x[0]**o+(0.266094832079)*x[0]+(-0.147028009699)*x[1]**o+(-0.683770701764)*x[1]+(0.794443408406)*x[2]**o+(-0.0536824425549)*x[2]
        ref[0,0]=(-0.303213562559)/(o+1.)+(0.00706417461518)
        ref[0,1]=(1.0986479667)/(o+1.)+(0.42429575083)
        ref[0,2]=(-0.193154724916)/(o+1.)+(0.306814107996)
        ref[0,3]=(-0.999631996799)/(o+1.)+(0.246905791695)
        ref[0,4]=(-0.584724232331)/(o+1.)+(0.0773142027411)
        ref[1,0]=(0.394987118014)/(o+1.)+(-0.410345512369)
        ref[1,1]=(-0.367578243823)/(o+1.)+(0.101503489923)
        ref[1,2]=(-1.97885472069)/(o+1.)+(0.124163208614)
        ref[1,3]=(0.925918208162)/(o+1.)+(-0.480566692498)
        ref[1,4]=(0.0374688495844)/(o+1.)+(0.454522989737)
        ref[2,0]=(0.799020926395)/(o+1.)+(-0.218872743099)
        ref[2,1]=(1.15190264031)/(o+1.)+(0.414136151917)
        ref[2,2]=(1.11034138743)/(o+1.)+(0.383384826588)
        ref[2,3]=(0.239632808531)/(o+1.)+(0.222687904113)
        ref[2,4]=(-0.27721334945)/(o+1.)+(-0.427481529703)
        ref[3,0]=(0.741127263073)/(o+1.)+(0.267637190026)
        ref[3,1]=(1.36531937876)/(o+1.)+(-0.383407372171)
        ref[3,2]=(-0.29814446172)/(o+1.)+(-0.546738926866)
        ref[3,3]=(-1.05838892663)/(o+1.)+(-0.602184890111)
        ref[3,4]=(1.17094273627)/(o+1.)+(-0.23567915612)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.630010583318)*x[0]**o+(0.0494796640212)*x[0]+(0.471665362166)*x[1]**o+(0.392459033784)*x[1]
        s[0,0,1]=(-0.423295675063)*x[0]**o+(0.24240367131)*x[0]+(-0.724581249901)*x[1]**o+(-0.131295119605)*x[1]
        s[0,1,0]=(-0.410928342692)*x[0]**o+(-0.541418037237)*x[0]+(-0.232546576693)*x[1]**o+(-0.0784119675747)*x[1]
        s[0,1,1]=(0.789988066595)*x[0]**o+(-0.243498836345)*x[0]+(0.368561675765)*x[1]**o+(-0.747610528524)*x[1]
        s[1,0,0]=(-0.326293541804)*x[0]**o+(0.101066389163)*x[0]+(-0.184367851)*x[1]**o+(0.568769737008)*x[1]
        s[1,0,1]=(-0.015503180143)*x[0]**o+(0.819464848547)*x[0]+(0.979976262017)*x[1]**o+(-0.0389216169058)*x[1]
        s[1,1,0]=(-0.542766421816)*x[0]**o+(-0.373053336375)*x[0]+(-0.938010294052)*x[1]**o+(-0.399667401896)*x[1]
        s[1,1,1]=(0.0200936228416)*x[0]**o+(0.770519603961)*x[0]+(0.620955090369)*x[1]**o+(-0.330894822252)*x[1]
        s[2,0,0]=(-0.171145765903)*x[0]**o+(0.612313985433)*x[0]+(0.0479528062441)*x[1]**o+(-0.281058939492)*x[1]
        s[2,0,1]=(-0.332826833153)*x[0]**o+(0.944629304493)*x[0]+(-0.487576018254)*x[1]**o+(-0.904875326977)*x[1]
        s[2,1,0]=(-0.00808555466364)*x[0]**o+(0.245367446684)*x[0]+(-0.164397692869)*x[1]**o+(-0.198574049753)*x[1]
        s[2,1,1]=(-0.0469077421177)*x[0]**o+(0.89449436367)*x[0]+(-0.802161009378)*x[1]**o+(-0.0767107312174)*x[1]
        s[3,0,0]=(0.530561159497)*x[0]**o+(-0.0909174483134)*x[0]+(0.159443779335)*x[1]**o+(-0.178020813545)*x[1]
        s[3,0,1]=(-0.216531776351)*x[0]**o+(-0.531806095078)*x[0]+(0.653531437331)*x[1]**o+(0.21339193674)*x[1]
        s[3,1,0]=(0.254391857637)*x[0]**o+(0.619393713071)*x[0]+(-0.260306661561)*x[1]**o+(-0.473743696717)*x[1]
        s[3,1,1]=(-0.921367458187)*x[0]**o+(-0.69212037605)*x[0]+(0.6216551239)*x[1]**o+(0.7963578436)*x[1]
        s[4,0,0]=(-0.506208138693)*x[0]**o+(-0.103718686465)*x[0]+(0.771724985573)*x[1]**o+(0.815749872065)*x[1]
        s[4,0,1]=(-0.21355375924)*x[0]**o+(0.635638481649)*x[0]+(0.274581141313)*x[1]**o+(-0.947357183419)*x[1]
        s[4,1,0]=(0.35658463006)*x[0]**o+(-0.351876832623)*x[0]+(-0.0999414279107)*x[1]**o+(0.212979499129)*x[1]
        s[4,1,1]=(0.494190940488)*x[0]**o+(0.0851596543145)*x[0]+(-0.433440340709)*x[1]**o+(-0.0173667523032)*x[1]
        s[5,0,0]=(0.53169691054)*x[0]**o+(0.952395156793)*x[0]+(-0.127903378991)*x[1]**o+(-0.605192547481)*x[1]
        s[5,0,1]=(0.795535841954)*x[0]**o+(-0.615332450079)*x[0]+(0.764586784938)*x[1]**o+(0.420251114523)*x[1]
        s[5,1,0]=(-0.699722370082)*x[0]**o+(0.608404015259)*x[0]+(-0.166384830092)*x[1]**o+(-0.0611871373695)*x[1]
        s[5,1,1]=(0.545721411662)*x[0]**o+(-0.426115151805)*x[0]+(-0.438291880099)*x[1]**o+(0.0686028790393)*x[1]
        ref[0,0,0]=(1.10167594548)/(o+1.)+(0.220969348903)
        ref[0,0,1]=(-1.14787692496)/(o+1.)+(0.055554275852)
        ref[0,1,0]=(-0.643474919385)/(o+1.)+(-0.309915002406)
        ref[0,1,1]=(1.15854974236)/(o+1.)+(-0.495554682434)
        ref[1,0,0]=(-0.510661392804)/(o+1.)+(0.334918063085)
        ref[1,0,1]=(0.964473081874)/(o+1.)+(0.390271615821)
        ref[1,1,0]=(-1.48077671587)/(o+1.)+(-0.386360369136)
        ref[1,1,1]=(0.64104871321)/(o+1.)+(0.219812390854)
        ref[2,0,0]=(-0.123192959659)/(o+1.)+(0.16562752297)
        ref[2,0,1]=(-0.820402851406)/(o+1.)+(0.0198769887578)
        ref[2,1,0]=(-0.172483247533)/(o+1.)+(0.0233966984659)
        ref[2,1,1]=(-0.849068751496)/(o+1.)+(0.408891816226)
        ref[3,0,0]=(0.690004938832)/(o+1.)+(-0.134469130929)
        ref[3,0,1]=(0.43699966098)/(o+1.)+(-0.159207079169)
        ref[3,1,0]=(-0.00591480392415)/(o+1.)+(0.0728250081768)
        ref[3,1,1]=(-0.299712334287)/(o+1.)+(0.0521187337749)
        ref[4,0,0]=(0.265516846879)/(o+1.)+(0.3560155928)
        ref[4,0,1]=(0.0610273820724)/(o+1.)+(-0.155859350885)
        ref[4,1,0]=(0.256643202149)/(o+1.)+(-0.0694486667468)
        ref[4,1,1]=(0.0607505997785)/(o+1.)+(0.0338964510057)
        ref[5,0,0]=(0.403793531549)/(o+1.)+(0.173601304656)
        ref[5,0,1]=(1.56012262689)/(o+1.)+(-0.0975406677777)
        ref[5,1,0]=(-0.866107200175)/(o+1.)+(0.273608438945)
        ref[5,1,1]=(0.107429531563)/(o+1.)+(-0.178756136383)
      else:
        s[0,0,0]=(0.584550224653)*x[0]**o+(-0.106569322848)*x[0]+(0.728893354651)*x[1]**o+(0.237029650377)*x[1]+(-0.546491966553)*x[2]**o+(0.0390698430932)*x[2]
        s[0,0,1]=(0.0636227774465)*x[0]**o+(0.934881844205)*x[0]+(-0.545166942655)*x[1]**o+(0.08148757249)*x[1]+(-0.179461185461)*x[2]**o+(0.641018091939)*x[2]
        s[0,1,0]=(0.325463516488)*x[0]**o+(-0.620730155784)*x[0]+(0.154991661017)*x[1]**o+(0.245046216313)*x[1]+(0.645726837044)*x[2]**o+(-0.230093713841)*x[2]
        s[0,1,1]=(-0.321016164146)*x[0]**o+(-0.0509943423674)*x[0]+(-0.479999557029)*x[1]**o+(0.569709724552)*x[1]+(0.190221146753)*x[2]**o+(-0.919477787005)*x[2]
        s[1,0,0]=(0.929113150774)*x[0]**o+(-0.733802947668)*x[0]+(0.8108269457)*x[1]**o+(-0.488163027335)*x[1]+(-0.745575620351)*x[2]**o+(-0.486955144862)*x[2]
        s[1,0,1]=(-0.017329684129)*x[0]**o+(0.147982077718)*x[0]+(-0.144958156543)*x[1]**o+(-0.300572864309)*x[1]+(0.00787918928353)*x[2]**o+(-0.532824168573)*x[2]
        s[1,1,0]=(0.685828903913)*x[0]**o+(-0.567114040704)*x[0]+(-0.0471407827804)*x[1]**o+(0.511415127351)*x[1]+(-0.554086444893)*x[2]**o+(-0.226435378121)*x[2]
        s[1,1,1]=(-0.415793464117)*x[0]**o+(-0.777707665965)*x[0]+(-0.846630968003)*x[1]**o+(0.389596880295)*x[1]+(-0.213682650766)*x[2]**o+(-0.0851017843465)*x[2]
        s[2,0,0]=(0.932561239744)*x[0]**o+(0.0615709255597)*x[0]+(0.634288279118)*x[1]**o+(0.293277319848)*x[1]+(-0.429481015254)*x[2]**o+(0.778577347672)*x[2]
        s[2,0,1]=(0.857123773566)*x[0]**o+(-0.47446916241)*x[0]+(0.951211790713)*x[1]**o+(0.443028899356)*x[1]+(0.0861361311835)*x[2]**o+(0.597277083437)*x[2]
        s[2,1,0]=(0.874693704519)*x[0]**o+(-0.920294692148)*x[0]+(-0.03228863342)*x[1]**o+(0.248843294667)*x[1]+(-0.926343823806)*x[2]**o+(0.15109837142)*x[2]
        s[2,1,1]=(0.840368685645)*x[0]**o+(-0.200563324888)*x[0]+(0.88039674632)*x[1]**o+(-0.349512401298)*x[1]+(0.25915053789)*x[2]**o+(-0.48356523029)*x[2]
        s[3,0,0]=(0.758393510867)*x[0]**o+(0.666093057943)*x[0]+(-0.453617931299)*x[1]**o+(-0.134152843992)*x[1]+(-0.0117598390465)*x[2]**o+(-0.730981155782)*x[2]
        s[3,0,1]=(0.205572845432)*x[0]**o+(0.46935055342)*x[0]+(-0.415086164167)*x[1]**o+(0.276709685737)*x[1]+(0.341889576347)*x[2]**o+(0.170610214566)*x[2]
        s[3,1,0]=(0.926107056617)*x[0]**o+(-0.928101461122)*x[0]+(-0.639162904468)*x[1]**o+(-0.787501002441)*x[1]+(0.615156638997)*x[2]**o+(0.444030323472)*x[2]
        s[3,1,1]=(0.458304153272)*x[0]**o+(0.119383772473)*x[0]+(-0.816833779036)*x[1]**o+(0.428980054603)*x[1]+(0.176196071727)*x[2]**o+(0.294498083663)*x[2]
        s[4,0,0]=(-0.184477855098)*x[0]**o+(-0.281312358692)*x[0]+(-0.259869292769)*x[1]**o+(0.670877642172)*x[1]+(0.710140723846)*x[2]**o+(-0.738455024569)*x[2]
        s[4,0,1]=(0.790994543706)*x[0]**o+(0.594490423343)*x[0]+(0.737641957747)*x[1]**o+(-0.974154697219)*x[1]+(-0.228328212417)*x[2]**o+(-0.870422565759)*x[2]
        s[4,1,0]=(0.538277719545)*x[0]**o+(0.0405414212643)*x[0]+(-0.340695322783)*x[1]**o+(-0.925052511534)*x[1]+(0.77026668428)*x[2]**o+(0.872129470246)*x[2]
        s[4,1,1]=(0.35315629997)*x[0]**o+(-0.581808852999)*x[0]+(-0.506082324541)*x[1]**o+(-0.979298372486)*x[1]+(0.269130557602)*x[2]**o+(0.0297188290624)*x[2]
        s[5,0,0]=(0.13627346547)*x[0]**o+(-0.634005099347)*x[0]+(0.413163361533)*x[1]**o+(-0.445924057754)*x[1]+(0.317763103856)*x[2]**o+(-0.0934833794122)*x[2]
        s[5,0,1]=(0.775864446863)*x[0]**o+(0.647005517482)*x[0]+(-0.922488575786)*x[1]**o+(0.592973645448)*x[1]+(0.752015212966)*x[2]**o+(-0.700335290015)*x[2]
        s[5,1,0]=(0.376707292205)*x[0]**o+(-0.185352369466)*x[0]+(0.701616000772)*x[1]**o+(-0.496738161848)*x[1]+(-0.722103675479)*x[2]**o+(-0.124090359996)*x[2]
        s[5,1,1]=(-0.070302198698)*x[0]**o+(-0.701418359643)*x[0]+(0.131136807633)*x[1]**o+(-0.0581346703562)*x[1]+(0.378664686889)*x[2]**o+(0.785268912587)*x[2]
        ref[0,0,0]=(0.766951612751)/(o+1.)+(0.0847650853109)
        ref[0,0,1]=(-0.66100535067)/(o+1.)+(0.828693754317)
        ref[0,1,0]=(1.12618201455)/(o+1.)+(-0.302888826656)
        ref[0,1,1]=(-0.610794574422)/(o+1.)+(-0.20038120241)
        ref[1,0,0]=(0.994364476124)/(o+1.)+(-0.854460559932)
        ref[1,0,1]=(-0.154408651388)/(o+1.)+(-0.342707477582)
        ref[1,1,0]=(0.0846016762395)/(o+1.)+(-0.141067145737)
        ref[1,1,1]=(-1.47610708289)/(o+1.)+(-0.236606285008)
        ref[2,0,0]=(1.13736850361)/(o+1.)+(0.56671279654)
        ref[2,0,1]=(1.89447169546)/(o+1.)+(0.282918410191)
        ref[2,1,0]=(-0.0839387527076)/(o+1.)+(-0.260176513031)
        ref[2,1,1]=(1.97991596985)/(o+1.)+(-0.516820478238)
        ref[3,0,0]=(0.293015740521)/(o+1.)+(-0.0995204709152)
        ref[3,0,1]=(0.132376257612)/(o+1.)+(0.458335226861)
        ref[3,1,0]=(0.902100791146)/(o+1.)+(-0.635786070046)
        ref[3,1,1]=(-0.182333554037)/(o+1.)+(0.421430955369)
        ref[4,0,0]=(0.265793575979)/(o+1.)+(-0.174444870545)
        ref[4,0,1]=(1.30030828904)/(o+1.)+(-0.625043419818)
        ref[4,1,0]=(0.967849081042)/(o+1.)+(-0.00619081001188)
        ref[4,1,1]=(0.116204533031)/(o+1.)+(-0.765694198211)
        ref[5,0,0]=(0.867199930859)/(o+1.)+(-0.586706268257)
        ref[5,0,1]=(0.605391084042)/(o+1.)+(0.269821936457)
        ref[5,1,0]=(0.356219617498)/(o+1.)+(-0.403090445655)
        ref[5,1,1]=(0.439499295823)/(o+1.)+(0.0128579412935)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.904602515522)*x[0]**o+(-0.371521279208)*x[0]+(-0.452933934201)*x[1]**o+(-0.202117873586)*x[1]
        s[0,0,0,1]=(0.046504512522)*x[0]**o+(-0.23169139456)*x[0]+(0.260745907068)*x[1]**o+(-0.280939854842)*x[1]
        s[0,0,1,0]=(0.150287081226)*x[0]**o+(-0.62438094501)*x[0]+(-0.617182852213)*x[1]**o+(0.0366613552193)*x[1]
        s[0,0,1,1]=(0.0710288489579)*x[0]**o+(-0.111273065295)*x[0]+(0.41817519756)*x[1]**o+(0.792759228517)*x[1]
        s[0,0,2,0]=(-0.00835504723814)*x[0]**o+(-0.928910786463)*x[0]+(-0.830115466368)*x[1]**o+(0.117896100163)*x[1]
        s[0,0,2,1]=(0.178088696257)*x[0]**o+(0.378404605517)*x[0]+(-0.0609283403081)*x[1]**o+(-0.0543695218661)*x[1]
        s[0,1,0,0]=(-0.0689997578822)*x[0]**o+(-0.632975314677)*x[0]+(0.817036198517)*x[1]**o+(0.83235818794)*x[1]
        s[0,1,0,1]=(0.307747809333)*x[0]**o+(-0.119316653583)*x[0]+(-0.962502450634)*x[1]**o+(0.730005736334)*x[1]
        s[0,1,1,0]=(0.474932601365)*x[0]**o+(-0.672778327766)*x[0]+(0.0931366097943)*x[1]**o+(0.441430893263)*x[1]
        s[0,1,1,1]=(-0.688077109622)*x[0]**o+(-0.0904781446959)*x[0]+(0.75334586689)*x[1]**o+(0.64166855195)*x[1]
        s[0,1,2,0]=(-0.445313569413)*x[0]**o+(0.0860176511221)*x[0]+(0.816569466868)*x[1]**o+(-0.716517326506)*x[1]
        s[0,1,2,1]=(-0.282441352341)*x[0]**o+(-0.63704220861)*x[0]+(-0.0493662512733)*x[1]**o+(0.568004633808)*x[1]
        s[0,2,0,0]=(-0.39629286578)*x[0]**o+(-0.930416708861)*x[0]+(0.426475002251)*x[1]**o+(-0.156685168112)*x[1]
        s[0,2,0,1]=(-0.932671691096)*x[0]**o+(-0.918584855074)*x[0]+(0.820320229167)*x[1]**o+(0.39108460143)*x[1]
        s[0,2,1,0]=(0.904161654788)*x[0]**o+(0.580424354995)*x[0]+(0.901999297026)*x[1]**o+(0.16227344306)*x[1]
        s[0,2,1,1]=(0.80438774629)*x[0]**o+(0.132549332211)*x[0]+(0.799348114478)*x[1]**o+(-0.22361807585)*x[1]
        s[0,2,2,0]=(-0.561135188306)*x[0]**o+(0.584405140552)*x[0]+(0.655074058246)*x[1]**o+(0.145893780708)*x[1]
        s[0,2,2,1]=(-0.252147320901)*x[0]**o+(0.798853343056)*x[0]+(0.615093018404)*x[1]**o+(0.394704774949)*x[1]
        s[0,3,0,0]=(0.36142643768)*x[0]**o+(0.307386971305)*x[0]+(-0.294243769289)*x[1]**o+(-0.516116390793)*x[1]
        s[0,3,0,1]=(-0.258524392445)*x[0]**o+(-0.955667526515)*x[0]+(-0.268164834645)*x[1]**o+(-0.0982143901681)*x[1]
        s[0,3,1,0]=(-0.363719831483)*x[0]**o+(0.542839794876)*x[0]+(-0.591176577173)*x[1]**o+(-0.885630814734)*x[1]
        s[0,3,1,1]=(-0.857066901153)*x[0]**o+(0.146459811163)*x[0]+(0.167525505888)*x[1]**o+(-0.823988951028)*x[1]
        s[0,3,2,0]=(-0.67987029357)*x[0]**o+(0.484426195638)*x[0]+(0.357896203022)*x[1]**o+(-0.225752357797)*x[1]
        s[0,3,2,1]=(-0.580488963435)*x[0]**o+(-0.561249356735)*x[0]+(0.383669718576)*x[1]**o+(0.657077607148)*x[1]
        s[0,4,0,0]=(0.69915173204)*x[0]**o+(-0.98282597178)*x[0]+(-0.107525636764)*x[1]**o+(0.860091695416)*x[1]
        s[0,4,0,1]=(-0.52652663231)*x[0]**o+(0.0466888351687)*x[0]+(0.490026321752)*x[1]**o+(0.694751470792)*x[1]
        s[0,4,1,0]=(0.824302118883)*x[0]**o+(0.00719006856334)*x[0]+(-0.539797289173)*x[1]**o+(0.690123831564)*x[1]
        s[0,4,1,1]=(-0.472128229772)*x[0]**o+(-0.648689330166)*x[0]+(0.391117917633)*x[1]**o+(-0.162627834297)*x[1]
        s[0,4,2,0]=(0.225959403713)*x[0]**o+(-0.955982321286)*x[0]+(0.98648257289)*x[1]**o+(0.685606762198)*x[1]
        s[0,4,2,1]=(0.344295953653)*x[0]**o+(0.0937724197016)*x[0]+(0.334346155325)*x[1]**o+(0.240553977121)*x[1]
        s[1,0,0,0]=(0.195329436142)*x[0]**o+(-0.391787107203)*x[0]+(0.282744654065)*x[1]**o+(0.525383075525)*x[1]
        s[1,0,0,1]=(0.0500438294543)*x[0]**o+(0.91622484244)*x[0]+(-0.678531170299)*x[1]**o+(-0.992341400238)*x[1]
        s[1,0,1,0]=(0.297013531565)*x[0]**o+(-0.11033494708)*x[0]+(-0.0204768747597)*x[1]**o+(0.911044821444)*x[1]
        s[1,0,1,1]=(-0.318409579239)*x[0]**o+(-0.0397282629607)*x[0]+(0.126590560999)*x[1]**o+(-0.583058191524)*x[1]
        s[1,0,2,0]=(-0.928353567554)*x[0]**o+(-0.290772724182)*x[0]+(0.114112299004)*x[1]**o+(0.320854358475)*x[1]
        s[1,0,2,1]=(-0.570768568717)*x[0]**o+(-0.824979336359)*x[0]+(-0.521612560762)*x[1]**o+(0.892935684254)*x[1]
        s[1,1,0,0]=(0.409271921712)*x[0]**o+(0.656688417546)*x[0]+(-0.552252115532)*x[1]**o+(-0.252684939643)*x[1]
        s[1,1,0,1]=(0.650926797031)*x[0]**o+(0.937738666477)*x[0]+(-0.280790296797)*x[1]**o+(0.214208558313)*x[1]
        s[1,1,1,0]=(0.1256718371)*x[0]**o+(0.261580183407)*x[0]+(-0.57943553377)*x[1]**o+(-0.746871082838)*x[1]
        s[1,1,1,1]=(0.935864480093)*x[0]**o+(-0.438674963211)*x[0]+(0.18368021533)*x[1]**o+(-0.694240108689)*x[1]
        s[1,1,2,0]=(-0.0397072007891)*x[0]**o+(-0.745343758112)*x[0]+(0.641693619013)*x[1]**o+(-0.658786784991)*x[1]
        s[1,1,2,1]=(-0.695558285084)*x[0]**o+(-0.650222199462)*x[0]+(-0.386725498078)*x[1]**o+(-0.674446830484)*x[1]
        s[1,2,0,0]=(0.905187721767)*x[0]**o+(-0.415012814051)*x[0]+(0.797167315255)*x[1]**o+(-0.80569654981)*x[1]
        s[1,2,0,1]=(-0.425831083968)*x[0]**o+(-0.306155499216)*x[0]+(0.878423386932)*x[1]**o+(-0.204033374375)*x[1]
        s[1,2,1,0]=(0.0315352399527)*x[0]**o+(-0.0864621608168)*x[0]+(0.953279645196)*x[1]**o+(-0.350121337825)*x[1]
        s[1,2,1,1]=(0.30461258451)*x[0]**o+(-0.825063058949)*x[0]+(0.512058260572)*x[1]**o+(0.748809814194)*x[1]
        s[1,2,2,0]=(-0.739360626393)*x[0]**o+(-0.163606333648)*x[0]+(0.0928076120668)*x[1]**o+(0.720798765678)*x[1]
        s[1,2,2,1]=(0.199986177011)*x[0]**o+(-0.355098022147)*x[0]+(-0.429976374764)*x[1]**o+(-0.333973984813)*x[1]
        s[1,3,0,0]=(0.245099889527)*x[0]**o+(-0.272006414876)*x[0]+(0.19038825631)*x[1]**o+(0.141537376325)*x[1]
        s[1,3,0,1]=(0.964892470064)*x[0]**o+(0.266000699533)*x[0]+(0.281992883406)*x[1]**o+(0.0470036363258)*x[1]
        s[1,3,1,0]=(-0.406024010771)*x[0]**o+(0.211515087571)*x[0]+(-0.139150083168)*x[1]**o+(0.694931678647)*x[1]
        s[1,3,1,1]=(0.719958915132)*x[0]**o+(0.425474993616)*x[0]+(0.381998339685)*x[1]**o+(-0.587210328527)*x[1]
        s[1,3,2,0]=(-0.446628131313)*x[0]**o+(0.147944239049)*x[0]+(0.858318344908)*x[1]**o+(0.141912002794)*x[1]
        s[1,3,2,1]=(0.123237888525)*x[0]**o+(0.609628760233)*x[0]+(-0.0997977880881)*x[1]**o+(0.776602457692)*x[1]
        s[1,4,0,0]=(-0.205992404955)*x[0]**o+(0.95994896532)*x[0]+(-0.668831643097)*x[1]**o+(0.400688887056)*x[1]
        s[1,4,0,1]=(-0.551761785809)*x[0]**o+(-0.188933577465)*x[0]+(-0.445368366446)*x[1]**o+(-0.487934192641)*x[1]
        s[1,4,1,0]=(0.806637485565)*x[0]**o+(-0.912751633205)*x[0]+(-0.0317735780285)*x[1]**o+(0.397954044901)*x[1]
        s[1,4,1,1]=(0.321015788412)*x[0]**o+(0.0387288594742)*x[0]+(0.924286425546)*x[1]**o+(0.636709951581)*x[1]
        s[1,4,2,0]=(0.822453145379)*x[0]**o+(-0.763204841293)*x[0]+(-0.821998150153)*x[1]**o+(-0.0455190284992)*x[1]
        s[1,4,2,1]=(-0.769855780302)*x[0]**o+(0.175243832232)*x[0]+(0.643564391513)*x[1]**o+(0.167745614405)*x[1]
        s[2,0,0,0]=(-0.703387009485)*x[0]**o+(-0.165672894741)*x[0]+(-0.593523456406)*x[1]**o+(-0.953916267625)*x[1]
        s[2,0,0,1]=(0.189269691722)*x[0]**o+(0.0650904594513)*x[0]+(-0.972603715891)*x[1]**o+(0.632748799808)*x[1]
        s[2,0,1,0]=(-0.355043086131)*x[0]**o+(0.223886836405)*x[0]+(0.0812465154386)*x[1]**o+(-0.123342881585)*x[1]
        s[2,0,1,1]=(0.111949886338)*x[0]**o+(0.333936233092)*x[0]+(-0.726855801653)*x[1]**o+(-0.410644679001)*x[1]
        s[2,0,2,0]=(-0.514134171061)*x[0]**o+(-0.920122884271)*x[0]+(-0.257750657117)*x[1]**o+(-0.920243692547)*x[1]
        s[2,0,2,1]=(-0.845077655219)*x[0]**o+(-0.208901924124)*x[0]+(0.337378697599)*x[1]**o+(0.801979415473)*x[1]
        s[2,1,0,0]=(0.193043677084)*x[0]**o+(-0.0599530199511)*x[0]+(0.43567411879)*x[1]**o+(0.500546331575)*x[1]
        s[2,1,0,1]=(0.599088933494)*x[0]**o+(-0.468604163828)*x[0]+(0.429967954899)*x[1]**o+(-0.492384378174)*x[1]
        s[2,1,1,0]=(-0.720574232874)*x[0]**o+(0.821661207615)*x[0]+(0.724662820892)*x[1]**o+(0.753198897961)*x[1]
        s[2,1,1,1]=(-0.448359465447)*x[0]**o+(0.693373974155)*x[0]+(-0.484872729016)*x[1]**o+(-0.192659481547)*x[1]
        s[2,1,2,0]=(0.703509253973)*x[0]**o+(-0.0365462091464)*x[0]+(0.240885950313)*x[1]**o+(-0.321055059013)*x[1]
        s[2,1,2,1]=(0.247817476916)*x[0]**o+(-0.138605619124)*x[0]+(0.697567286153)*x[1]**o+(0.727793395093)*x[1]
        s[2,2,0,0]=(0.0419479009665)*x[0]**o+(0.66706255286)*x[0]+(-0.330849950899)*x[1]**o+(-0.600398002711)*x[1]
        s[2,2,0,1]=(0.0302303643583)*x[0]**o+(0.851488267489)*x[0]+(-0.568849620793)*x[1]**o+(-0.363234175722)*x[1]
        s[2,2,1,0]=(-0.0230217508795)*x[0]**o+(0.118232576333)*x[0]+(0.0810817815326)*x[1]**o+(-0.58292650684)*x[1]
        s[2,2,1,1]=(-0.372568177431)*x[0]**o+(-0.613455954736)*x[0]+(0.223650823501)*x[1]**o+(-0.310111084313)*x[1]
        s[2,2,2,0]=(-0.297770107968)*x[0]**o+(0.334407378326)*x[0]+(0.0820495048815)*x[1]**o+(0.670675755602)*x[1]
        s[2,2,2,1]=(-0.884675664948)*x[0]**o+(-0.141329306491)*x[0]+(0.125135636826)*x[1]**o+(-0.911348264716)*x[1]
        s[2,3,0,0]=(0.538935527955)*x[0]**o+(0.513300520882)*x[0]+(0.850744598079)*x[1]**o+(0.751590880335)*x[1]
        s[2,3,0,1]=(-0.821182874204)*x[0]**o+(-0.186188144846)*x[0]+(-0.107871578183)*x[1]**o+(0.462281422576)*x[1]
        s[2,3,1,0]=(0.699998387809)*x[0]**o+(0.497080130045)*x[0]+(-0.876146393883)*x[1]**o+(-0.966792776701)*x[1]
        s[2,3,1,1]=(-0.755486256523)*x[0]**o+(0.482429742628)*x[0]+(0.64207235708)*x[1]**o+(0.792668637521)*x[1]
        s[2,3,2,0]=(0.480810051431)*x[0]**o+(0.526844732935)*x[0]+(0.358083926997)*x[1]**o+(0.975251790749)*x[1]
        s[2,3,2,1]=(-0.71380930491)*x[0]**o+(0.321062714102)*x[0]+(-0.393765851515)*x[1]**o+(0.758037335781)*x[1]
        s[2,4,0,0]=(0.799658695022)*x[0]**o+(-0.970884788767)*x[0]+(-0.909912887472)*x[1]**o+(-0.118569854978)*x[1]
        s[2,4,0,1]=(0.22665071178)*x[0]**o+(-0.866764191923)*x[0]+(0.760310143236)*x[1]**o+(0.979622869213)*x[1]
        s[2,4,1,0]=(-0.639860894248)*x[0]**o+(-0.254761334846)*x[0]+(0.844133251872)*x[1]**o+(-0.0823600617007)*x[1]
        s[2,4,1,1]=(0.699864723463)*x[0]**o+(-0.941417107514)*x[0]+(-0.939935969783)*x[1]**o+(0.307212220608)*x[1]
        s[2,4,2,0]=(-0.597501168242)*x[0]**o+(-0.855810189779)*x[0]+(-0.616246893869)*x[1]**o+(0.862508316402)*x[1]
        s[2,4,2,1]=(0.279133829297)*x[0]**o+(-0.963434838906)*x[0]+(-0.927999672088)*x[1]**o+(-0.633147829562)*x[1]
        s[3,0,0,0]=(-0.228495811891)*x[0]**o+(-0.253261426268)*x[0]+(-0.487641848136)*x[1]**o+(0.321239316844)*x[1]
        s[3,0,0,1]=(-0.226385127812)*x[0]**o+(-0.903861474811)*x[0]+(0.0285492108309)*x[1]**o+(0.199168585275)*x[1]
        s[3,0,1,0]=(-0.0670214317839)*x[0]**o+(-0.169290931005)*x[0]+(0.859675236893)*x[1]**o+(0.673436325782)*x[1]
        s[3,0,1,1]=(0.589201260546)*x[0]**o+(-0.931566266675)*x[0]+(0.127884139041)*x[1]**o+(-0.0831271642138)*x[1]
        s[3,0,2,0]=(-0.228265145653)*x[0]**o+(-0.449360641451)*x[0]+(0.0895266621221)*x[1]**o+(0.516248722513)*x[1]
        s[3,0,2,1]=(0.726271772612)*x[0]**o+(-0.834727339534)*x[0]+(0.779809207203)*x[1]**o+(-0.2745165742)*x[1]
        s[3,1,0,0]=(-0.528300011184)*x[0]**o+(0.0728636912947)*x[0]+(-0.953454233615)*x[1]**o+(0.582219621875)*x[1]
        s[3,1,0,1]=(0.196609308635)*x[0]**o+(0.162717112564)*x[0]+(0.449469968326)*x[1]**o+(-0.174119135554)*x[1]
        s[3,1,1,0]=(-0.261855816805)*x[0]**o+(0.607391359963)*x[0]+(-0.793775568608)*x[1]**o+(-0.950278043961)*x[1]
        s[3,1,1,1]=(0.240905287034)*x[0]**o+(-0.204299485241)*x[0]+(-0.825848364133)*x[1]**o+(-0.00971732871232)*x[1]
        s[3,1,2,0]=(0.798049323787)*x[0]**o+(0.0710454406309)*x[0]+(0.990006532214)*x[1]**o+(0.711055965038)*x[1]
        s[3,1,2,1]=(-0.406803353709)*x[0]**o+(0.120946506707)*x[0]+(-0.410263830047)*x[1]**o+(0.988997635486)*x[1]
        s[3,2,0,0]=(0.181718966759)*x[0]**o+(-0.0262352524424)*x[0]+(-0.1917125307)*x[1]**o+(-0.169130797999)*x[1]
        s[3,2,0,1]=(-0.00378400436872)*x[0]**o+(-0.970892218185)*x[0]+(-0.563995443607)*x[1]**o+(0.906996441633)*x[1]
        s[3,2,1,0]=(-0.858412521643)*x[0]**o+(-0.133539980742)*x[0]+(-0.692474245554)*x[1]**o+(0.0128241106616)*x[1]
        s[3,2,1,1]=(-0.272651295849)*x[0]**o+(-0.185053306751)*x[0]+(-0.034278709119)*x[1]**o+(-0.201998293805)*x[1]
        s[3,2,2,0]=(-0.0376999069998)*x[0]**o+(-0.895215920335)*x[0]+(0.944947071273)*x[1]**o+(-0.732964572204)*x[1]
        s[3,2,2,1]=(0.0771318167573)*x[0]**o+(0.051862360377)*x[0]+(-0.837260137737)*x[1]**o+(-0.770673420806)*x[1]
        s[3,3,0,0]=(-0.258989060244)*x[0]**o+(-0.699818576225)*x[0]+(-0.311518509076)*x[1]**o+(0.517397173211)*x[1]
        s[3,3,0,1]=(-0.443559295683)*x[0]**o+(-0.0544611458142)*x[0]+(0.983503123196)*x[1]**o+(0.248879114721)*x[1]
        s[3,3,1,0]=(0.626729673965)*x[0]**o+(0.347363767931)*x[0]+(0.956080389131)*x[1]**o+(0.429076008118)*x[1]
        s[3,3,1,1]=(-0.508758891471)*x[0]**o+(0.616615567996)*x[0]+(0.221644986884)*x[1]**o+(-0.904935728116)*x[1]
        s[3,3,2,0]=(0.254341631925)*x[0]**o+(-0.908688314004)*x[0]+(-0.0449719498093)*x[1]**o+(0.871189405684)*x[1]
        s[3,3,2,1]=(0.506459636421)*x[0]**o+(0.978066502797)*x[0]+(-0.212934438396)*x[1]**o+(-0.355665670198)*x[1]
        s[3,4,0,0]=(0.0152292845756)*x[0]**o+(-0.400615592376)*x[0]+(0.264352702586)*x[1]**o+(-0.0677780689342)*x[1]
        s[3,4,0,1]=(0.734077033298)*x[0]**o+(-0.171218476666)*x[0]+(-0.399285387071)*x[1]**o+(-0.589596788961)*x[1]
        s[3,4,1,0]=(-0.903602643334)*x[0]**o+(0.0527455440694)*x[0]+(-0.973273256059)*x[1]**o+(0.76054623312)*x[1]
        s[3,4,1,1]=(0.368219867735)*x[0]**o+(0.857361275285)*x[0]+(0.297273583978)*x[1]**o+(0.243120582563)*x[1]
        s[3,4,2,0]=(0.518637118464)*x[0]**o+(-0.961371552746)*x[0]+(0.283809772558)*x[1]**o+(-0.947184379737)*x[1]
        s[3,4,2,1]=(-0.514398206056)*x[0]**o+(-0.499373736713)*x[0]+(-0.756154352548)*x[1]**o+(0.814078333554)*x[1]
        ref[0,0,0,0]=(0.451668581322)/(o+1.)+(-0.286819576397)
        ref[0,0,0,1]=(0.30725041959)/(o+1.)+(-0.256315624701)
        ref[0,0,1,0]=(-0.466895770987)/(o+1.)+(-0.293859794895)
        ref[0,0,1,1]=(0.489204046518)/(o+1.)+(0.340743081611)
        ref[0,0,2,0]=(-0.838470513606)/(o+1.)+(-0.40550734315)
        ref[0,0,2,1]=(0.117160355949)/(o+1.)+(0.162017541826)
        ref[0,1,0,0]=(0.748036440634)/(o+1.)+(0.0996914366319)
        ref[0,1,0,1]=(-0.654754641301)/(o+1.)+(0.305344541376)
        ref[0,1,1,0]=(0.568069211159)/(o+1.)+(-0.115673717252)
        ref[0,1,1,1]=(0.0652687572678)/(o+1.)+(0.275595203627)
        ref[0,1,2,0]=(0.371255897455)/(o+1.)+(-0.315249837692)
        ref[0,1,2,1]=(-0.331807603614)/(o+1.)+(-0.0345187874006)
        ref[0,2,0,0]=(0.0301821364712)/(o+1.)+(-0.543550938487)
        ref[0,2,0,1]=(-0.112351461929)/(o+1.)+(-0.263750126822)
        ref[0,2,1,0]=(1.80616095181)/(o+1.)+(0.371348899028)
        ref[0,2,1,1]=(1.60373586077)/(o+1.)+(-0.0455343718196)
        ref[0,2,2,0]=(0.0939388699401)/(o+1.)+(0.36514946063)
        ref[0,2,2,1]=(0.362945697503)/(o+1.)+(0.596779059003)
        ref[0,3,0,0]=(0.0671826683913)/(o+1.)+(-0.104364709744)
        ref[0,3,0,1]=(-0.52668922709)/(o+1.)+(-0.526940958341)
        ref[0,3,1,0]=(-0.954896408656)/(o+1.)+(-0.171395509929)
        ref[0,3,1,1]=(-0.689541395265)/(o+1.)+(-0.338764569932)
        ref[0,3,2,0]=(-0.321974090548)/(o+1.)+(0.12933691892)
        ref[0,3,2,1]=(-0.196819244859)/(o+1.)+(0.0479141252065)
        ref[0,4,0,0]=(0.591626095276)/(o+1.)+(-0.061367138182)
        ref[0,4,0,1]=(-0.0365003105586)/(o+1.)+(0.37072015298)
        ref[0,4,1,0]=(0.28450482971)/(o+1.)+(0.348656950064)
        ref[0,4,1,1]=(-0.0810103121392)/(o+1.)+(-0.405658582232)
        ref[0,4,2,0]=(1.2124419766)/(o+1.)+(-0.135187779544)
        ref[0,4,2,1]=(0.678642108977)/(o+1.)+(0.167163198411)
        ref[1,0,0,0]=(0.478074090207)/(o+1.)+(0.066797984161)
        ref[1,0,0,1]=(-0.628487340845)/(o+1.)+(-0.0380582788988)
        ref[1,0,1,0]=(0.276536656806)/(o+1.)+(0.400354937182)
        ref[1,0,1,1]=(-0.191819018239)/(o+1.)+(-0.311393227243)
        ref[1,0,2,0]=(-0.81424126855)/(o+1.)+(0.0150408171462)
        ref[1,0,2,1]=(-1.09238112948)/(o+1.)+(0.0339781739475)
        ref[1,1,0,0]=(-0.142980193819)/(o+1.)+(0.202001738951)
        ref[1,1,0,1]=(0.370136500233)/(o+1.)+(0.575973612395)
        ref[1,1,1,0]=(-0.45376369667)/(o+1.)+(-0.242645449715)
        ref[1,1,1,1]=(1.11954469542)/(o+1.)+(-0.56645753595)
        ref[1,1,2,0]=(0.601986418224)/(o+1.)+(-0.702065271552)
        ref[1,1,2,1]=(-1.08228378316)/(o+1.)+(-0.662334514973)
        ref[1,2,0,0]=(1.70235503702)/(o+1.)+(-0.61035468193)
        ref[1,2,0,1]=(0.452592302963)/(o+1.)+(-0.255094436796)
        ref[1,2,1,0]=(0.984814885149)/(o+1.)+(-0.218291749321)
        ref[1,2,1,1]=(0.816670845082)/(o+1.)+(-0.0381266223775)
        ref[1,2,2,0]=(-0.646553014327)/(o+1.)+(0.278596216015)
        ref[1,2,2,1]=(-0.229990197753)/(o+1.)+(-0.34453600348)
        ref[1,3,0,0]=(0.435488145837)/(o+1.)+(-0.0652345192758)
        ref[1,3,0,1]=(1.24688535347)/(o+1.)+(0.15650216793)
        ref[1,3,1,0]=(-0.545174093939)/(o+1.)+(0.453223383109)
        ref[1,3,1,1]=(1.10195725482)/(o+1.)+(-0.0808676674551)
        ref[1,3,2,0]=(0.411690213595)/(o+1.)+(0.144928120921)
        ref[1,3,2,1]=(0.0234401004369)/(o+1.)+(0.693115608963)
        ref[1,4,0,0]=(-0.874824048052)/(o+1.)+(0.680318926188)
        ref[1,4,0,1]=(-0.997130152255)/(o+1.)+(-0.338433885053)
        ref[1,4,1,0]=(0.774863907537)/(o+1.)+(-0.257398794152)
        ref[1,4,1,1]=(1.24530221396)/(o+1.)+(0.337719405527)
        ref[1,4,2,0]=(0.000454995225935)/(o+1.)+(-0.404361934896)
        ref[1,4,2,1]=(-0.126291388789)/(o+1.)+(0.171494723319)
        ref[2,0,0,0]=(-1.29691046589)/(o+1.)+(-0.559794581183)
        ref[2,0,0,1]=(-0.783334024169)/(o+1.)+(0.348919629629)
        ref[2,0,1,0]=(-0.273796570692)/(o+1.)+(0.0502719774097)
        ref[2,0,1,1]=(-0.614905915315)/(o+1.)+(-0.0383542229546)
        ref[2,0,2,0]=(-0.771884828178)/(o+1.)+(-0.920183288409)
        ref[2,0,2,1]=(-0.50769895762)/(o+1.)+(0.296538745675)
        ref[2,1,0,0]=(0.628717795874)/(o+1.)+(0.220296655812)
        ref[2,1,0,1]=(1.02905688839)/(o+1.)+(-0.480494271001)
        ref[2,1,1,0]=(0.00408858801768)/(o+1.)+(0.787430052788)
        ref[2,1,1,1]=(-0.933232194463)/(o+1.)+(0.250357246304)
        ref[2,1,2,0]=(0.944395204286)/(o+1.)+(-0.17880063408)
        ref[2,1,2,1]=(0.945384763069)/(o+1.)+(0.294593887985)
        ref[2,2,0,0]=(-0.288902049932)/(o+1.)+(0.0333322750744)
        ref[2,2,0,1]=(-0.538619256435)/(o+1.)+(0.244127045883)
        ref[2,2,1,0]=(0.0580600306531)/(o+1.)+(-0.232346965253)
        ref[2,2,1,1]=(-0.148917353929)/(o+1.)+(-0.461783519524)
        ref[2,2,2,0]=(-0.215720603086)/(o+1.)+(0.502541566964)
        ref[2,2,2,1]=(-0.759540028122)/(o+1.)+(-0.526338785603)
        ref[2,3,0,0]=(1.38968012603)/(o+1.)+(0.632445700608)
        ref[2,3,0,1]=(-0.929054452386)/(o+1.)+(0.138046638865)
        ref[2,3,1,0]=(-0.176148006073)/(o+1.)+(-0.234856323328)
        ref[2,3,1,1]=(-0.113413899443)/(o+1.)+(0.637549190074)
        ref[2,3,2,0]=(0.838893978428)/(o+1.)+(0.751048261842)
        ref[2,3,2,1]=(-1.10757515642)/(o+1.)+(0.539550024941)
        ref[2,4,0,0]=(-0.11025419245)/(o+1.)+(-0.544727321873)
        ref[2,4,0,1]=(0.986960855016)/(o+1.)+(0.056429338645)
        ref[2,4,1,0]=(0.204272357624)/(o+1.)+(-0.168560698273)
        ref[2,4,1,1]=(-0.24007124632)/(o+1.)+(-0.317102443453)
        ref[2,4,2,0]=(-1.21374806211)/(o+1.)+(0.00334906331113)
        ref[2,4,2,1]=(-0.648865842791)/(o+1.)+(-0.798291334234)
        ref[3,0,0,0]=(-0.716137660027)/(o+1.)+(0.033988945288)
        ref[3,0,0,1]=(-0.197835916981)/(o+1.)+(-0.352346444768)
        ref[3,0,1,0]=(0.792653805109)/(o+1.)+(0.252072697388)
        ref[3,0,1,1]=(0.717085399588)/(o+1.)+(-0.507346715445)
        ref[3,0,2,0]=(-0.138738483531)/(o+1.)+(0.0334440405313)
        ref[3,0,2,1]=(1.50608097982)/(o+1.)+(-0.554621956867)
        ref[3,1,0,0]=(-1.4817542448)/(o+1.)+(0.327541656585)
        ref[3,1,0,1]=(0.64607927696)/(o+1.)+(-0.00570101149523)
        ref[3,1,1,0]=(-1.05563138541)/(o+1.)+(-0.171443341999)
        ref[3,1,1,1]=(-0.5849430771)/(o+1.)+(-0.107008406977)
        ref[3,1,2,0]=(1.788055856)/(o+1.)+(0.391050702835)
        ref[3,1,2,1]=(-0.817067183756)/(o+1.)+(0.554972071097)
        ref[3,2,0,0]=(-0.00999356394068)/(o+1.)+(-0.0976830252209)
        ref[3,2,0,1]=(-0.567779447976)/(o+1.)+(-0.031947888276)
        ref[3,2,1,0]=(-1.5508867672)/(o+1.)+(-0.0603579350402)
        ref[3,2,1,1]=(-0.306930004968)/(o+1.)+(-0.193525800278)
        ref[3,2,2,0]=(0.907247164273)/(o+1.)+(-0.81409024627)
        ref[3,2,2,1]=(-0.76012832098)/(o+1.)+(-0.359405530215)
        ref[3,3,0,0]=(-0.57050756932)/(o+1.)+(-0.0912107015068)
        ref[3,3,0,1]=(0.539943827514)/(o+1.)+(0.0972089844535)
        ref[3,3,1,0]=(1.5828100631)/(o+1.)+(0.388219888025)
        ref[3,3,1,1]=(-0.287113904587)/(o+1.)+(-0.14416008006)
        ref[3,3,2,0]=(0.209369682116)/(o+1.)+(-0.01874945416)
        ref[3,3,2,1]=(0.293525198025)/(o+1.)+(0.311200416299)
        ref[3,4,0,0]=(0.279581987162)/(o+1.)+(-0.234196830655)
        ref[3,4,0,1]=(0.334791646227)/(o+1.)+(-0.380407632814)
        ref[3,4,1,0]=(-1.87687589939)/(o+1.)+(0.406645888595)
        ref[3,4,1,1]=(0.665493451713)/(o+1.)+(0.550240928924)
        ref[3,4,2,0]=(0.802446891023)/(o+1.)+(-0.954277966241)
        ref[3,4,2,1]=(-1.2705525586)/(o+1.)+(0.15735229842)
      else:
        s[0,0,0,0]=(0.641376947921)*x[0]**o+(-0.761647983943)*x[0]+(0.1869803104)*x[1]**o+(-0.325986059158)*x[1]+(-0.0520537723186)*x[2]**o+(-0.242075762859)*x[2]
        s[0,0,0,1]=(0.774456605418)*x[0]**o+(0.321485563379)*x[0]+(0.0248450395096)*x[1]**o+(-0.425638835963)*x[1]+(-0.0622024423983)*x[2]**o+(0.0431057597271)*x[2]
        s[0,0,1,0]=(0.661432460103)*x[0]**o+(-0.653382716149)*x[0]+(0.596912471264)*x[1]**o+(-0.375947479542)*x[1]+(0.370999295823)*x[2]**o+(0.791872078833)*x[2]
        s[0,0,1,1]=(0.258860589295)*x[0]**o+(-0.802340135742)*x[0]+(0.569149399765)*x[1]**o+(-0.505649920225)*x[1]+(0.384267048627)*x[2]**o+(-0.791015249057)*x[2]
        s[0,0,2,0]=(0.219942214071)*x[0]**o+(0.360851774828)*x[0]+(-0.456714182675)*x[1]**o+(0.0965079164275)*x[1]+(-0.752467360132)*x[2]**o+(-0.285016148963)*x[2]
        s[0,0,2,1]=(0.227249920303)*x[0]**o+(-0.63371992192)*x[0]+(-0.751996139921)*x[1]**o+(-0.804517033328)*x[1]+(-0.0202988256583)*x[2]**o+(0.531173510334)*x[2]
        s[0,1,0,0]=(0.530838912723)*x[0]**o+(0.230970767172)*x[0]+(-0.424131392941)*x[1]**o+(-0.606417012546)*x[1]+(-0.318937522783)*x[2]**o+(0.179390519765)*x[2]
        s[0,1,0,1]=(-0.776569569832)*x[0]**o+(0.918265838431)*x[0]+(-0.091878191762)*x[1]**o+(0.698951377419)*x[1]+(0.244940000061)*x[2]**o+(0.0452610075428)*x[2]
        s[0,1,1,0]=(0.435082117831)*x[0]**o+(0.889881605799)*x[0]+(-0.219619308431)*x[1]**o+(-0.672303092957)*x[1]+(0.987619326906)*x[2]**o+(0.220516905778)*x[2]
        s[0,1,1,1]=(-0.118683589446)*x[0]**o+(0.965421464735)*x[0]+(-0.863562140452)*x[1]**o+(-0.231242073932)*x[1]+(0.568240493507)*x[2]**o+(0.734578820791)*x[2]
        s[0,1,2,0]=(0.511447709837)*x[0]**o+(-0.274507694143)*x[0]+(0.576288098696)*x[1]**o+(0.655476727813)*x[1]+(0.602315737594)*x[2]**o+(0.817938429306)*x[2]
        s[0,1,2,1]=(-0.319953701981)*x[0]**o+(-0.0816890923671)*x[0]+(0.84471771093)*x[1]**o+(0.216072534675)*x[1]+(0.782233227772)*x[2]**o+(0.761080396806)*x[2]
        s[0,2,0,0]=(0.371971964019)*x[0]**o+(-0.914300658178)*x[0]+(-0.421914056897)*x[1]**o+(-0.366900498221)*x[1]+(-0.224742744541)*x[2]**o+(0.718117565395)*x[2]
        s[0,2,0,1]=(0.390948765614)*x[0]**o+(0.523332138936)*x[0]+(0.207458000485)*x[1]**o+(0.704266764721)*x[1]+(0.194539635633)*x[2]**o+(-0.0310558120915)*x[2]
        s[0,2,1,0]=(-0.00308409831643)*x[0]**o+(0.0874338943679)*x[0]+(0.792479180633)*x[1]**o+(-0.840935676827)*x[1]+(0.183535198853)*x[2]**o+(-0.632484318094)*x[2]
        s[0,2,1,1]=(0.93055010195)*x[0]**o+(-0.592883255994)*x[0]+(-0.293724124968)*x[1]**o+(-0.532867438247)*x[1]+(-0.731629824662)*x[2]**o+(-0.926457959344)*x[2]
        s[0,2,2,0]=(-0.410766259996)*x[0]**o+(0.153463001676)*x[0]+(-0.22434101683)*x[1]**o+(0.792184946048)*x[1]+(0.217569318007)*x[2]**o+(-0.746503700782)*x[2]
        s[0,2,2,1]=(-0.48097027987)*x[0]**o+(-0.855259653713)*x[0]+(0.297296031945)*x[1]**o+(0.486702064445)*x[1]+(-0.15982283079)*x[2]**o+(0.943473459324)*x[2]
        s[0,3,0,0]=(0.440444162838)*x[0]**o+(-0.411163880392)*x[0]+(0.434891712314)*x[1]**o+(0.421032339491)*x[1]+(0.185417751167)*x[2]**o+(0.774341796864)*x[2]
        s[0,3,0,1]=(0.418605026678)*x[0]**o+(0.697823127475)*x[0]+(-0.490471272795)*x[1]**o+(0.889959972523)*x[1]+(-0.935571921221)*x[2]**o+(-0.477163919777)*x[2]
        s[0,3,1,0]=(0.240863375001)*x[0]**o+(0.171535577067)*x[0]+(-0.798318413682)*x[1]**o+(0.165523160187)*x[1]+(-0.793244034855)*x[2]**o+(-0.639277575041)*x[2]
        s[0,3,1,1]=(0.202212256877)*x[0]**o+(0.387471670954)*x[0]+(-0.198376856629)*x[1]**o+(-0.679099770813)*x[1]+(-0.213566318573)*x[2]**o+(-0.591165980661)*x[2]
        s[0,3,2,0]=(0.764050063724)*x[0]**o+(-0.921472809292)*x[0]+(-0.483029501792)*x[1]**o+(0.198096560699)*x[1]+(-0.161449532882)*x[2]**o+(-0.854460510477)*x[2]
        s[0,3,2,1]=(0.491500019407)*x[0]**o+(0.830069678076)*x[0]+(-0.597452015974)*x[1]**o+(-0.893928655959)*x[1]+(0.940149982314)*x[2]**o+(0.17300719331)*x[2]
        s[0,4,0,0]=(0.0798620352831)*x[0]**o+(0.0237937127416)*x[0]+(-0.086351109139)*x[1]**o+(0.729882388424)*x[1]+(-0.7065299588)*x[2]**o+(-0.632673206138)*x[2]
        s[0,4,0,1]=(-0.809989577091)*x[0]**o+(0.0981392253023)*x[0]+(0.831656529801)*x[1]**o+(0.0337424060561)*x[1]+(-0.210067786784)*x[2]**o+(-0.0549477247313)*x[2]
        s[0,4,1,0]=(-0.0632498403207)*x[0]**o+(-0.992515766051)*x[0]+(0.579065868983)*x[1]**o+(0.201496477221)*x[1]+(0.147678629343)*x[2]**o+(0.396978535826)*x[2]
        s[0,4,1,1]=(0.538470621207)*x[0]**o+(0.125447714672)*x[0]+(0.345561739505)*x[1]**o+(-0.898311293341)*x[1]+(0.695965393051)*x[2]**o+(0.456779053964)*x[2]
        s[0,4,2,0]=(-0.461938934992)*x[0]**o+(0.815268894146)*x[0]+(0.529702893063)*x[1]**o+(0.106752164506)*x[1]+(-0.892819156049)*x[2]**o+(-0.540251931665)*x[2]
        s[0,4,2,1]=(-0.890961526208)*x[0]**o+(-0.0522965595586)*x[0]+(-0.166811931177)*x[1]**o+(-0.32795191314)*x[1]+(0.827693520674)*x[2]**o+(-0.858862162004)*x[2]
        s[1,0,0,0]=(0.0341612512071)*x[0]**o+(0.704407020254)*x[0]+(-0.0212728069872)*x[1]**o+(-0.360120370601)*x[1]+(0.0355417904312)*x[2]**o+(-0.899016835477)*x[2]
        s[1,0,0,1]=(-0.254336879728)*x[0]**o+(-0.749583807992)*x[0]+(-0.822540014653)*x[1]**o+(0.321686636614)*x[1]+(-0.110121756691)*x[2]**o+(0.995172970249)*x[2]
        s[1,0,1,0]=(0.538783330989)*x[0]**o+(0.425931208203)*x[0]+(0.808850719257)*x[1]**o+(-0.616824777466)*x[1]+(-0.999643426203)*x[2]**o+(0.206956920828)*x[2]
        s[1,0,1,1]=(0.92122724205)*x[0]**o+(-0.0077578775328)*x[0]+(-0.455369944999)*x[1]**o+(0.069992464289)*x[1]+(-0.625922232223)*x[2]**o+(0.308582889054)*x[2]
        s[1,0,2,0]=(0.812275176702)*x[0]**o+(-0.0737918971904)*x[0]+(-0.352834721968)*x[1]**o+(-0.485715856695)*x[1]+(0.893012104541)*x[2]**o+(-0.50277227482)*x[2]
        s[1,0,2,1]=(0.327001325412)*x[0]**o+(0.248420422978)*x[0]+(0.934489184596)*x[1]**o+(0.645665157141)*x[1]+(-0.125952174434)*x[2]**o+(-0.589610796444)*x[2]
        s[1,1,0,0]=(-0.19439618112)*x[0]**o+(-0.473153238554)*x[0]+(0.441593313035)*x[1]**o+(0.560223203285)*x[1]+(0.744701337265)*x[2]**o+(0.588942879247)*x[2]
        s[1,1,0,1]=(0.956622537359)*x[0]**o+(0.388369191252)*x[0]+(-0.912880779816)*x[1]**o+(-0.930624449932)*x[1]+(-0.0693131490103)*x[2]**o+(0.79864169138)*x[2]
        s[1,1,1,0]=(0.0802315160845)*x[0]**o+(0.360021747567)*x[0]+(-0.838148172909)*x[1]**o+(0.974574791036)*x[1]+(0.134930445828)*x[2]**o+(-0.224819866647)*x[2]
        s[1,1,1,1]=(0.0408467896812)*x[0]**o+(-0.527931565684)*x[0]+(-0.294779051686)*x[1]**o+(0.655648246879)*x[1]+(0.206641334088)*x[2]**o+(0.244207224731)*x[2]
        s[1,1,2,0]=(-0.695324333815)*x[0]**o+(-0.76302643793)*x[0]+(-0.445448086412)*x[1]**o+(0.387620295728)*x[1]+(0.410986742302)*x[2]**o+(-0.903330791078)*x[2]
        s[1,1,2,1]=(0.725983511781)*x[0]**o+(-0.55616923731)*x[0]+(0.694922396401)*x[1]**o+(0.969679789365)*x[1]+(0.390140728655)*x[2]**o+(0.616506146743)*x[2]
        s[1,2,0,0]=(-0.847983007272)*x[0]**o+(-0.21379616326)*x[0]+(-0.221990648875)*x[1]**o+(0.542144543115)*x[1]+(-0.476016238668)*x[2]**o+(0.239835257111)*x[2]
        s[1,2,0,1]=(0.382592141805)*x[0]**o+(-0.547322693057)*x[0]+(0.207135932694)*x[1]**o+(0.479160574257)*x[1]+(-0.406772807762)*x[2]**o+(0.0827537744696)*x[2]
        s[1,2,1,0]=(0.385177578855)*x[0]**o+(-0.96749949076)*x[0]+(-0.980528334919)*x[1]**o+(0.846145425556)*x[1]+(0.663229596459)*x[2]**o+(0.234589730098)*x[2]
        s[1,2,1,1]=(0.326538279652)*x[0]**o+(0.864444241537)*x[0]+(0.925715710223)*x[1]**o+(0.901973119241)*x[1]+(0.489827899451)*x[2]**o+(-0.446654474045)*x[2]
        s[1,2,2,0]=(0.623521048768)*x[0]**o+(0.00694630100059)*x[0]+(-0.316266037281)*x[1]**o+(-0.296669528851)*x[1]+(-0.345499066232)*x[2]**o+(-0.781251040298)*x[2]
        s[1,2,2,1]=(-0.564332000062)*x[0]**o+(-0.838410587038)*x[0]+(0.105923226211)*x[1]**o+(0.027080971794)*x[1]+(0.656502442527)*x[2]**o+(-0.968700980875)*x[2]
        s[1,3,0,0]=(0.28297404936)*x[0]**o+(0.906254282744)*x[0]+(0.426459225459)*x[1]**o+(0.474780047643)*x[1]+(0.915469451254)*x[2]**o+(0.150014279679)*x[2]
        s[1,3,0,1]=(0.417919974897)*x[0]**o+(0.118528892402)*x[0]+(0.456086489559)*x[1]**o+(0.407436737785)*x[1]+(-0.594040737087)*x[2]**o+(-0.0968244395915)*x[2]
        s[1,3,1,0]=(-0.00608149061984)*x[0]**o+(0.279861847458)*x[0]+(0.622153448276)*x[1]**o+(0.307580940395)*x[1]+(-0.311958042371)*x[2]**o+(0.951637572927)*x[2]
        s[1,3,1,1]=(0.0620010964861)*x[0]**o+(0.694489586135)*x[0]+(-0.397214573709)*x[1]**o+(0.816641484229)*x[1]+(-0.55010098877)*x[2]**o+(-0.252677099684)*x[2]
        s[1,3,2,0]=(0.347469613465)*x[0]**o+(-0.793025539854)*x[0]+(0.340939082154)*x[1]**o+(0.00135134646417)*x[1]+(-0.253753620216)*x[2]**o+(-0.795217820163)*x[2]
        s[1,3,2,1]=(-0.77663362989)*x[0]**o+(-0.0454794482729)*x[0]+(0.0346722039087)*x[1]**o+(-0.137241685281)*x[1]+(0.984186419894)*x[2]**o+(0.884865835233)*x[2]
        s[1,4,0,0]=(-0.344544201299)*x[0]**o+(0.118604431816)*x[0]+(0.735491059587)*x[1]**o+(-0.474594418844)*x[1]+(-0.160183641095)*x[2]**o+(0.0442675403903)*x[2]
        s[1,4,0,1]=(0.159437065336)*x[0]**o+(0.357454800453)*x[0]+(0.0623836301056)*x[1]**o+(0.255296236156)*x[1]+(0.586460110084)*x[2]**o+(-0.557870816384)*x[2]
        s[1,4,1,0]=(0.272212988717)*x[0]**o+(-0.00218257591936)*x[0]+(0.637653920938)*x[1]**o+(0.474154612654)*x[1]+(0.0927963495169)*x[2]**o+(0.688169553045)*x[2]
        s[1,4,1,1]=(-0.296752052135)*x[0]**o+(0.222825403373)*x[0]+(-0.61297870931)*x[1]**o+(-0.772169949259)*x[1]+(0.267924738357)*x[2]**o+(-0.98640521973)*x[2]
        s[1,4,2,0]=(-0.528327447355)*x[0]**o+(-0.13640459815)*x[0]+(-0.839608161898)*x[1]**o+(0.79996626812)*x[1]+(0.0889785028146)*x[2]**o+(0.483698551365)*x[2]
        s[1,4,2,1]=(-0.888180576683)*x[0]**o+(-0.243274686308)*x[0]+(-0.459488747018)*x[1]**o+(0.770881162569)*x[1]+(-0.502642334958)*x[2]**o+(-0.0596414308521)*x[2]
        s[2,0,0,0]=(-0.765317614505)*x[0]**o+(-0.220818348989)*x[0]+(-0.185228616416)*x[1]**o+(-0.0787003843488)*x[1]+(-0.412520273332)*x[2]**o+(0.192760450932)*x[2]
        s[2,0,0,1]=(0.913449879489)*x[0]**o+(-0.219345049089)*x[0]+(0.54504962001)*x[1]**o+(0.623236284643)*x[1]+(-0.350717162156)*x[2]**o+(-0.623681076852)*x[2]
        s[2,0,1,0]=(-0.940664057127)*x[0]**o+(0.251319839352)*x[0]+(0.877556299495)*x[1]**o+(0.016160084659)*x[1]+(-0.544235646954)*x[2]**o+(-0.343760171279)*x[2]
        s[2,0,1,1]=(0.324227271021)*x[0]**o+(-0.380692454159)*x[0]+(-0.727849414028)*x[1]**o+(0.955281983149)*x[1]+(-0.898073831095)*x[2]**o+(0.858127409364)*x[2]
        s[2,0,2,0]=(-0.111449036516)*x[0]**o+(0.928827923826)*x[0]+(-0.992899512514)*x[1]**o+(0.0150334039442)*x[1]+(-0.552135666421)*x[2]**o+(0.406949591012)*x[2]
        s[2,0,2,1]=(0.241832900797)*x[0]**o+(0.684688614786)*x[0]+(0.842064214069)*x[1]**o+(-0.718696633586)*x[1]+(0.352196331118)*x[2]**o+(-0.260343576356)*x[2]
        s[2,1,0,0]=(0.426302002061)*x[0]**o+(0.573786857786)*x[0]+(0.909827742357)*x[1]**o+(0.34656984965)*x[1]+(0.379863389758)*x[2]**o+(0.0322921482901)*x[2]
        s[2,1,0,1]=(0.34423098891)*x[0]**o+(0.959825965873)*x[0]+(-0.458147326954)*x[1]**o+(-0.190830182513)*x[1]+(-0.0836184656488)*x[2]**o+(0.711921183181)*x[2]
        s[2,1,1,0]=(0.813184534496)*x[0]**o+(-0.551568400877)*x[0]+(0.0282287303962)*x[1]**o+(0.421838849382)*x[1]+(0.312118130223)*x[2]**o+(-0.276104599646)*x[2]
        s[2,1,1,1]=(0.39842349776)*x[0]**o+(0.0505250495963)*x[0]+(-0.398145839899)*x[1]**o+(0.712110112191)*x[1]+(-0.646997386195)*x[2]**o+(-0.584123612783)*x[2]
        s[2,1,2,0]=(-0.722790769831)*x[0]**o+(0.850227076858)*x[0]+(0.204013681627)*x[1]**o+(0.924250450519)*x[1]+(-0.0736995922058)*x[2]**o+(-0.597799712798)*x[2]
        s[2,1,2,1]=(0.314644875138)*x[0]**o+(-0.636988948936)*x[0]+(-0.641641656145)*x[1]**o+(0.788809853074)*x[1]+(0.993531553111)*x[2]**o+(-0.495755039677)*x[2]
        s[2,2,0,0]=(0.633851639171)*x[0]**o+(0.523452525521)*x[0]+(-0.382111999068)*x[1]**o+(-0.63124196783)*x[1]+(-0.147565214833)*x[2]**o+(0.0331370104049)*x[2]
        s[2,2,0,1]=(0.526384634874)*x[0]**o+(0.133282991706)*x[0]+(0.805017307077)*x[1]**o+(-0.266487317047)*x[1]+(0.33606063535)*x[2]**o+(0.805493533241)*x[2]
        s[2,2,1,0]=(0.346357232135)*x[0]**o+(-0.787017955245)*x[0]+(0.30877740144)*x[1]**o+(0.451911959523)*x[1]+(0.747842891938)*x[2]**o+(-0.44945658191)*x[2]
        s[2,2,1,1]=(-0.546211248475)*x[0]**o+(0.247263733668)*x[0]+(-0.594514097121)*x[1]**o+(-0.264637607913)*x[1]+(0.418219952147)*x[2]**o+(-0.816923592759)*x[2]
        s[2,2,2,0]=(0.0563761896319)*x[0]**o+(-0.736507329679)*x[0]+(0.470349998404)*x[1]**o+(-0.932042349224)*x[1]+(0.462401759004)*x[2]**o+(-0.714392002134)*x[2]
        s[2,2,2,1]=(0.240181845755)*x[0]**o+(-0.55763353473)*x[0]+(0.285496776429)*x[1]**o+(0.842557595355)*x[1]+(-0.672368632752)*x[2]**o+(0.298762100435)*x[2]
        s[2,3,0,0]=(0.316677723523)*x[0]**o+(-0.637036430356)*x[0]+(0.00972363132121)*x[1]**o+(-0.30937691623)*x[1]+(-0.757958054703)*x[2]**o+(0.261972786754)*x[2]
        s[2,3,0,1]=(-0.0111918506129)*x[0]**o+(-0.79939173162)*x[0]+(0.237847735286)*x[1]**o+(-0.78668226084)*x[1]+(0.707378088836)*x[2]**o+(-0.934201311773)*x[2]
        s[2,3,1,0]=(-0.0276842306357)*x[0]**o+(0.353182001738)*x[0]+(0.458929280756)*x[1]**o+(0.845593054688)*x[1]+(-0.0437171694787)*x[2]**o+(-0.75271342809)*x[2]
        s[2,3,1,1]=(0.752394290258)*x[0]**o+(-0.179837111909)*x[0]+(0.939093046468)*x[1]**o+(0.460733186456)*x[1]+(0.747517309414)*x[2]**o+(-0.58266983679)*x[2]
        s[2,3,2,0]=(-0.951300235705)*x[0]**o+(-0.350444110401)*x[0]+(-0.904564312825)*x[1]**o+(0.356471509479)*x[1]+(0.0971202512406)*x[2]**o+(0.227621817712)*x[2]
        s[2,3,2,1]=(0.404143843413)*x[0]**o+(-0.911041017819)*x[0]+(-0.567863808091)*x[1]**o+(0.228161895607)*x[1]+(-0.160584718896)*x[2]**o+(-0.951937728172)*x[2]
        s[2,4,0,0]=(-0.284708280204)*x[0]**o+(-0.225655800044)*x[0]+(0.0189816391307)*x[1]**o+(-0.847695463473)*x[1]+(-0.603035310159)*x[2]**o+(0.878440760667)*x[2]
        s[2,4,0,1]=(0.249580969821)*x[0]**o+(0.00196364400716)*x[0]+(-0.580222966198)*x[1]**o+(0.266039411545)*x[1]+(-0.0857426202045)*x[2]**o+(0.297517844516)*x[2]
        s[2,4,1,0]=(-0.847202130689)*x[0]**o+(-0.409645962819)*x[0]+(-0.914867914136)*x[1]**o+(0.464829575727)*x[1]+(0.2358554853)*x[2]**o+(-0.951825555951)*x[2]
        s[2,4,1,1]=(-0.925109552513)*x[0]**o+(0.57253113036)*x[0]+(0.531590407505)*x[1]**o+(-0.812964837422)*x[1]+(-0.354555503225)*x[2]**o+(-0.453054364223)*x[2]
        s[2,4,2,0]=(0.669533379208)*x[0]**o+(0.147512160447)*x[0]+(0.730871788446)*x[1]**o+(-0.2646655671)*x[1]+(-0.890950482274)*x[2]**o+(0.28244962845)*x[2]
        s[2,4,2,1]=(-0.11059763341)*x[0]**o+(0.276920644999)*x[0]+(-0.869145286116)*x[1]**o+(-0.403772968269)*x[1]+(0.319872723054)*x[2]**o+(-0.172168932529)*x[2]
        s[3,0,0,0]=(-0.309323319641)*x[0]**o+(-0.520023896018)*x[0]+(-0.91435931387)*x[1]**o+(-0.994973476595)*x[1]+(-0.372209395986)*x[2]**o+(0.980356617984)*x[2]
        s[3,0,0,1]=(0.741365113034)*x[0]**o+(-0.42466697031)*x[0]+(-0.800148478866)*x[1]**o+(0.891726804851)*x[1]+(0.173578031033)*x[2]**o+(-0.830047254257)*x[2]
        s[3,0,1,0]=(0.292501009071)*x[0]**o+(-0.643570264019)*x[0]+(0.549854764281)*x[1]**o+(-0.359686767247)*x[1]+(-0.242285567291)*x[2]**o+(-0.905609679312)*x[2]
        s[3,0,1,1]=(-0.340043108142)*x[0]**o+(0.654957588422)*x[0]+(-0.709296972181)*x[1]**o+(0.997889126174)*x[1]+(-0.0231005104624)*x[2]**o+(0.736312548493)*x[2]
        s[3,0,2,0]=(-0.724460864229)*x[0]**o+(-0.367115506582)*x[0]+(0.932338820643)*x[1]**o+(0.386420866744)*x[1]+(0.0937739144019)*x[2]**o+(0.980197176095)*x[2]
        s[3,0,2,1]=(-0.123268193799)*x[0]**o+(0.775389790643)*x[0]+(0.374761099968)*x[1]**o+(-0.410566663234)*x[1]+(0.61390455683)*x[2]**o+(-0.424980785321)*x[2]
        s[3,1,0,0]=(-0.931705529761)*x[0]**o+(-0.883420554924)*x[0]+(0.364171802711)*x[1]**o+(-0.120720945763)*x[1]+(-0.264662446682)*x[2]**o+(0.694245672188)*x[2]
        s[3,1,0,1]=(0.507167558745)*x[0]**o+(0.41310141465)*x[0]+(0.951808421277)*x[1]**o+(0.194810425697)*x[1]+(0.656365011417)*x[2]**o+(-0.869365458629)*x[2]
        s[3,1,1,0]=(-0.00813347718406)*x[0]**o+(0.410334738969)*x[0]+(0.749864796873)*x[1]**o+(-0.592730297251)*x[1]+(-0.739489287628)*x[2]**o+(0.620937075039)*x[2]
        s[3,1,1,1]=(-0.598495133204)*x[0]**o+(0.933561890579)*x[0]+(0.711594544245)*x[1]**o+(-0.307136681784)*x[1]+(-0.391014626741)*x[2]**o+(0.237572771088)*x[2]
        s[3,1,2,0]=(0.0815836502329)*x[0]**o+(0.265301269129)*x[0]+(0.151163193573)*x[1]**o+(0.734126505497)*x[1]+(-0.607886397818)*x[2]**o+(-0.96735041904)*x[2]
        s[3,1,2,1]=(0.264092716207)*x[0]**o+(-0.0674826292731)*x[0]+(0.163729761978)*x[1]**o+(-0.76481590065)*x[1]+(0.23022017141)*x[2]**o+(0.0749358120678)*x[2]
        s[3,2,0,0]=(-0.0551562544206)*x[0]**o+(0.529626011841)*x[0]+(0.394111309195)*x[1]**o+(-0.315588836981)*x[1]+(-0.821692537082)*x[2]**o+(0.687214393749)*x[2]
        s[3,2,0,1]=(-0.400905852693)*x[0]**o+(-0.588175641647)*x[0]+(-0.759129469971)*x[1]**o+(-0.234537321811)*x[1]+(-0.506929882395)*x[2]**o+(-0.354376736058)*x[2]
        s[3,2,1,0]=(0.517928718456)*x[0]**o+(0.340801973663)*x[0]+(0.648735816398)*x[1]**o+(0.566053973455)*x[1]+(0.42463576352)*x[2]**o+(0.0873509981339)*x[2]
        s[3,2,1,1]=(0.452898115077)*x[0]**o+(0.122517234268)*x[0]+(-0.98577530096)*x[1]**o+(-0.353319422026)*x[1]+(0.926541753948)*x[2]**o+(-0.393031058333)*x[2]
        s[3,2,2,0]=(0.667750444088)*x[0]**o+(0.00375536977016)*x[0]+(0.268195379568)*x[1]**o+(0.50950653377)*x[1]+(-0.262580606419)*x[2]**o+(-0.417690499605)*x[2]
        s[3,2,2,1]=(-0.16803158003)*x[0]**o+(0.186259658616)*x[0]+(-0.200850683296)*x[1]**o+(-0.443680999529)*x[1]+(0.0208407252003)*x[2]**o+(-0.724292481324)*x[2]
        s[3,3,0,0]=(-0.35345741052)*x[0]**o+(0.217412970886)*x[0]+(0.27307889565)*x[1]**o+(0.267600255726)*x[1]+(-0.973212265009)*x[2]**o+(-0.129667297553)*x[2]
        s[3,3,0,1]=(-0.891104426101)*x[0]**o+(-0.613334258669)*x[0]+(-0.373828493642)*x[1]**o+(-0.0702748602911)*x[1]+(0.236710052698)*x[2]**o+(-0.358872144334)*x[2]
        s[3,3,1,0]=(-0.0928125660128)*x[0]**o+(0.413580667461)*x[0]+(0.8369960454)*x[1]**o+(0.77176338641)*x[1]+(-0.0577873035722)*x[2]**o+(-0.702932886813)*x[2]
        s[3,3,1,1]=(-0.241426495256)*x[0]**o+(0.525912190909)*x[0]+(-0.428192935989)*x[1]**o+(0.892165668837)*x[1]+(0.0334032549752)*x[2]**o+(0.882084846304)*x[2]
        s[3,3,2,0]=(-0.891362453397)*x[0]**o+(-0.339599362928)*x[0]+(0.473329812864)*x[1]**o+(-0.371616732026)*x[1]+(0.660699523287)*x[2]**o+(-0.119309478457)*x[2]
        s[3,3,2,1]=(0.243522118981)*x[0]**o+(0.155411321418)*x[0]+(-0.230275201921)*x[1]**o+(0.63515968566)*x[1]+(0.794898971569)*x[2]**o+(0.409779242619)*x[2]
        s[3,4,0,0]=(-0.854632433212)*x[0]**o+(-0.195836100347)*x[0]+(-0.437665256019)*x[1]**o+(0.576362236865)*x[1]+(-0.0965898541616)*x[2]**o+(0.477972926354)*x[2]
        s[3,4,0,1]=(0.570617061345)*x[0]**o+(-0.0667297487904)*x[0]+(0.81823573301)*x[1]**o+(-0.721189008734)*x[1]+(0.314807619532)*x[2]**o+(-0.376322628683)*x[2]
        s[3,4,1,0]=(-0.580668389702)*x[0]**o+(-0.60760839523)*x[0]+(0.686535934072)*x[1]**o+(0.0779142152446)*x[1]+(0.373571653006)*x[2]**o+(-0.88636603136)*x[2]
        s[3,4,1,1]=(0.987949055842)*x[0]**o+(-0.370309316213)*x[0]+(0.491077591851)*x[1]**o+(0.544978214302)*x[1]+(0.0979248628028)*x[2]**o+(0.0838359159228)*x[2]
        s[3,4,2,0]=(-0.0541483763088)*x[0]**o+(0.491394550602)*x[0]+(0.492110322334)*x[1]**o+(-0.113182373476)*x[1]+(0.807657591761)*x[2]**o+(0.387085950646)*x[2]
        s[3,4,2,1]=(-0.420727803772)*x[0]**o+(-0.105139523222)*x[0]+(-0.51755674286)*x[1]**o+(-0.219056797552)*x[1]+(-0.0414122967561)*x[2]**o+(-0.161491064048)*x[2]
        ref[0,0,0,0]=(0.776303486002)/(o+1.)+(-0.66485490298)
        ref[0,0,0,1]=(0.73709920253)/(o+1.)+(-0.0305237564282)
        ref[0,0,1,0]=(1.62934422719)/(o+1.)+(-0.118729058429)
        ref[0,0,1,1]=(1.21227703769)/(o+1.)+(-1.04950265251)
        ref[0,0,2,0]=(-0.989239328736)/(o+1.)+(0.0861717711464)
        ref[0,0,2,1]=(-0.545045045276)/(o+1.)+(-0.453531722457)
        ref[0,1,0,0]=(-0.212230003001)/(o+1.)+(-0.0980278628049)
        ref[0,1,0,1]=(-0.623507761533)/(o+1.)+(0.831239111696)
        ref[0,1,1,0]=(1.20308213631)/(o+1.)+(0.21904770931)
        ref[0,1,1,1]=(-0.414005236391)/(o+1.)+(0.734379105797)
        ref[0,1,2,0]=(1.69005154613)/(o+1.)+(0.599453731488)
        ref[0,1,2,1]=(1.30699723672)/(o+1.)+(0.447731919557)
        ref[0,2,0,0]=(-0.274684837419)/(o+1.)+(-0.281541795502)
        ref[0,2,0,1]=(0.792946401732)/(o+1.)+(0.598271545783)
        ref[0,2,1,0]=(0.972930281169)/(o+1.)+(-0.692993050277)
        ref[0,2,1,1]=(-0.0948038476807)/(o+1.)+(-1.02610432679)
        ref[0,2,2,0]=(-0.417537958819)/(o+1.)+(0.0995721234709)
        ref[0,2,2,1]=(-0.343497078715)/(o+1.)+(0.287457935028)
        ref[0,3,0,0]=(1.06075362632)/(o+1.)+(0.392105127981)
        ref[0,3,0,1]=(-1.00743816734)/(o+1.)+(0.55530959011)
        ref[0,3,1,0]=(-1.35069907354)/(o+1.)+(-0.151109418893)
        ref[0,3,1,1]=(-0.209730918326)/(o+1.)+(-0.44139704026)
        ref[0,3,2,0]=(0.119571029049)/(o+1.)+(-0.788918379535)
        ref[0,3,2,1]=(0.834197985747)/(o+1.)+(0.0545741077131)
        ref[0,4,0,0]=(-0.713019032656)/(o+1.)+(0.0605014475136)
        ref[0,4,0,1]=(-0.188400834074)/(o+1.)+(0.0384669533136)
        ref[0,4,1,0]=(0.663494658006)/(o+1.)+(-0.197020376502)
        ref[0,4,1,1]=(1.57999775376)/(o+1.)+(-0.158042262352)
        ref[0,4,2,0]=(-0.825055197978)/(o+1.)+(0.190884563494)
        ref[0,4,2,1]=(-0.230079936711)/(o+1.)+(-0.619555317351)
        ref[1,0,0,0]=(0.0484302346511)/(o+1.)+(-0.277365092912)
        ref[1,0,0,1]=(-1.18699865107)/(o+1.)+(0.283637899436)
        ref[1,0,1,0]=(0.347990624042)/(o+1.)+(0.00803167578244)
        ref[1,0,1,1]=(-0.160064935171)/(o+1.)+(0.185408737905)
        ref[1,0,2,0]=(1.35245255927)/(o+1.)+(-0.531140014353)
        ref[1,0,2,1]=(1.13553833557)/(o+1.)+(0.152237391837)
        ref[1,1,0,0]=(0.99189846918)/(o+1.)+(0.338006421989)
        ref[1,1,0,1]=(-0.0255713914667)/(o+1.)+(0.12819321635)
        ref[1,1,1,0]=(-0.622986210996)/(o+1.)+(0.554888335978)
        ref[1,1,1,1]=(-0.0472909279168)/(o+1.)+(0.185961952963)
        ref[1,1,2,0]=(-0.729785677925)/(o+1.)+(-0.63936846664)
        ref[1,1,2,1]=(1.81104663684)/(o+1.)+(0.515008349399)
        ref[1,2,0,0]=(-1.54598989482)/(o+1.)+(0.284091818483)
        ref[1,2,0,1]=(0.182955266737)/(o+1.)+(0.00729582783438)
        ref[1,2,1,0]=(0.0678788403948)/(o+1.)+(0.0566178324469)
        ref[1,2,1,1]=(1.74208188933)/(o+1.)+(0.659881443367)
        ref[1,2,2,0]=(-0.0382440547455)/(o+1.)+(-0.535487134074)
        ref[1,2,2,1]=(0.198093668675)/(o+1.)+(-0.89001529806)
        ref[1,3,0,0]=(1.62490272607)/(o+1.)+(0.765524305033)
        ref[1,3,0,1]=(0.279965727369)/(o+1.)+(0.214570595298)
        ref[1,3,1,0]=(0.304113915286)/(o+1.)+(0.76954018039)
        ref[1,3,1,1]=(-0.885314465993)/(o+1.)+(0.62922698534)
        ref[1,3,2,0]=(0.434655075403)/(o+1.)+(-0.793446006776)
        ref[1,3,2,1]=(0.242224993913)/(o+1.)+(0.35107235084)
        ref[1,4,0,0]=(0.230763217193)/(o+1.)+(-0.155861223318)
        ref[1,4,0,1]=(0.808280805525)/(o+1.)+(0.0274401101125)
        ref[1,4,1,0]=(1.00266325917)/(o+1.)+(0.58007079489)
        ref[1,4,1,1]=(-0.641806023088)/(o+1.)+(-0.767874882808)
        ref[1,4,2,0]=(-1.27895710644)/(o+1.)+(0.573630110668)
        ref[1,4,2,1]=(-1.85031165866)/(o+1.)+(0.233982522704)
        ref[2,0,0,0]=(-1.36306650425)/(o+1.)+(-0.0533791412027)
        ref[2,0,0,1]=(1.10778233734)/(o+1.)+(-0.109894920649)
        ref[2,0,1,0]=(-0.607343404586)/(o+1.)+(-0.0381401236341)
        ref[2,0,1,1]=(-1.3016959741)/(o+1.)+(0.716358469177)
        ref[2,0,2,0]=(-1.65648421545)/(o+1.)+(0.675405459391)
        ref[2,0,2,1]=(1.43609344598)/(o+1.)+(-0.147175797578)
        ref[2,1,0,0]=(1.71599313418)/(o+1.)+(0.476324427863)
        ref[2,1,0,1]=(-0.197534803692)/(o+1.)+(0.74045848327)
        ref[2,1,1,0]=(1.15353139511)/(o+1.)+(-0.202917075571)
        ref[2,1,1,1]=(-0.646719728334)/(o+1.)+(0.089255774502)
        ref[2,1,2,0]=(-0.59247668041)/(o+1.)+(0.588338907289)
        ref[2,1,2,1]=(0.666534772105)/(o+1.)+(-0.171967067769)
        ref[2,2,0,0]=(0.10417442527)/(o+1.)+(-0.0373262159521)
        ref[2,2,0,1]=(1.6674625773)/(o+1.)+(0.33614460395)
        ref[2,2,1,0]=(1.40297752551)/(o+1.)+(-0.392281288816)
        ref[2,2,1,1]=(-0.72250539345)/(o+1.)+(-0.417148733502)
        ref[2,2,2,0]=(0.98912794704)/(o+1.)+(-1.19147084052)
        ref[2,2,2,1]=(-0.146690010568)/(o+1.)+(0.29184308053)
        ref[2,3,0,0]=(-0.431556699859)/(o+1.)+(-0.342220279916)
        ref[2,3,0,1]=(0.934033973509)/(o+1.)+(-1.26013765212)
        ref[2,3,1,0]=(0.387527880641)/(o+1.)+(0.223030814168)
        ref[2,3,1,1]=(2.43900464614)/(o+1.)+(-0.150886881122)
        ref[2,3,2,0]=(-1.75874429729)/(o+1.)+(0.116824608395)
        ref[2,3,2,1]=(-0.324304683574)/(o+1.)+(-0.817408425192)
        ref[2,4,0,0]=(-0.868761951233)/(o+1.)+(-0.0974552514252)
        ref[2,4,0,1]=(-0.416384616581)/(o+1.)+(0.282760450034)
        ref[2,4,1,0]=(-1.52621455953)/(o+1.)+(-0.448320971521)
        ref[2,4,1,1]=(-0.748074648234)/(o+1.)+(-0.346744035642)
        ref[2,4,2,0]=(0.50945468538)/(o+1.)+(0.0826481108988)
        ref[2,4,2,1]=(-0.659870196472)/(o+1.)+(-0.1495106279)
        ref[3,0,0,0]=(-1.5958920295)/(o+1.)+(-0.267320377314)
        ref[3,0,0,1]=(0.114794665201)/(o+1.)+(-0.181493709858)
        ref[3,0,1,0]=(0.600070206061)/(o+1.)+(-0.954433355289)
        ref[3,0,1,1]=(-1.07244059079)/(o+1.)+(1.19457963154)
        ref[3,0,2,0]=(0.301651870816)/(o+1.)+(0.499751268128)
        ref[3,0,2,1]=(0.865397463)/(o+1.)+(-0.0300788289559)
        ref[3,1,0,0]=(-0.832196173732)/(o+1.)+(-0.15494791425)
        ref[3,1,0,1]=(2.11534099144)/(o+1.)+(-0.130726809141)
        ref[3,1,1,0]=(0.00224203206025)/(o+1.)+(0.219270758379)
        ref[3,1,1,1]=(-0.277915215701)/(o+1.)+(0.431998989942)
        ref[3,1,2,0]=(-0.375139554013)/(o+1.)+(0.0160386777929)
        ref[3,1,2,1]=(0.658042649595)/(o+1.)+(-0.378681358928)
        ref[3,2,0,0]=(-0.482737482307)/(o+1.)+(0.450625784304)
        ref[3,2,0,1]=(-1.66696520506)/(o+1.)+(-0.588544849758)
        ref[3,2,1,0]=(1.59130029837)/(o+1.)+(0.497103472626)
        ref[3,2,1,1]=(0.393664568064)/(o+1.)+(-0.311916623046)
        ref[3,2,2,0]=(0.673365217238)/(o+1.)+(0.0477857019673)
        ref[3,2,2,1]=(-0.348041538126)/(o+1.)+(-0.490856911118)
        ref[3,3,0,0]=(-1.05359077988)/(o+1.)+(0.17767296453)
        ref[3,3,0,1]=(-1.02822286704)/(o+1.)+(-0.521240631647)
        ref[3,3,1,0]=(0.686396175815)/(o+1.)+(0.241205583529)
        ref[3,3,1,1]=(-0.63621617627)/(o+1.)+(1.15008135302)
        ref[3,3,2,0]=(0.242666882753)/(o+1.)+(-0.415262786705)
        ref[3,3,2,1]=(0.808145888629)/(o+1.)+(0.600175124848)
        ref[3,4,0,0]=(-1.38888754339)/(o+1.)+(0.429249531436)
        ref[3,4,0,1]=(1.70366041389)/(o+1.)+(-0.582120693104)
        ref[3,4,1,0]=(0.479439197375)/(o+1.)+(-0.708030105673)
        ref[3,4,1,1]=(1.5769515105)/(o+1.)+(0.129252407006)
        ref[3,4,2,0]=(1.24561953779)/(o+1.)+(0.382649063886)
        ref[3,4,2,1]=(-0.979696843387)/(o+1.)+(-0.242843692411)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Solution_rank0(self):
      """
      tests integral of rank 0 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-0.496833468021)*x[0]**o+(-0.119656931817)*x[0]+(-0.456435785007)*x[1]**o+(0.0378732106767)*x[1]
        ref=(-0.953269253027)/(o+1.)+(-0.04089186057)
      else:
        s=(0.960756800558)*x[0]**o+(-0.297563111204)*x[0]+(0.657965711967)*x[1]**o+(-0.942706539964)*x[1]+(-0.460398488427)*x[2]**o+(0.539495746387)*x[2]
        ref=(1.1583240241)/(o+1.)+(-0.350386952391)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Solution_rank1(self):
      """
      tests integral of rank 1 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.521294857582)*x[0]**o+(0.813966078452)*x[0]+(-0.460972018313)*x[1]**o+(-0.274643646978)*x[1]
        s[1]=(0.64160433254)*x[0]**o+(0.100182020329)*x[0]+(-0.877560875536)*x[1]**o+(0.0967945574365)*x[1]
        ref[0]=(-0.982266875895)/(o+1.)+(0.269661215737)
        ref[1]=(-0.235956542996)/(o+1.)+(0.0984882888828)
      else:
        s[0]=(-0.935408759921)*x[0]**o+(-0.636823488942)*x[0]+(-0.937973746046)*x[1]**o+(-0.548377694248)*x[1]+(-0.325664041787)*x[2]**o+(-0.859644239487)*x[2]
        s[1]=(-0.618325226925)*x[0]**o+(-0.464240689062)*x[0]+(-0.333395219266)*x[1]**o+(0.75384521826)*x[1]+(0.812529741058)*x[2]**o+(0.293845075804)*x[2]
        ref[0]=(-2.19904654775)/(o+1.)+(-1.02242271134)
        ref[1]=(-0.139190705133)/(o+1.)+(0.291724802501)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Solution_rank2(self):
      """
      tests integral of rank 2 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.745131837074)*x[0]**o+(0.954368069641)*x[0]+(0.582989014357)*x[1]**o+(0.649474790852)*x[1]
        s[0,1]=(0.0682420943207)*x[0]**o+(0.890255947523)*x[0]+(-0.501961353506)*x[1]**o+(-0.468049947986)*x[1]
        s[0,2]=(-0.376326981417)*x[0]**o+(0.318377164087)*x[0]+(0.518313700818)*x[1]**o+(-0.624749027625)*x[1]
        s[0,3]=(-0.0127578587596)*x[0]**o+(0.510088777647)*x[0]+(-0.00731027766723)*x[1]**o+(0.404116290004)*x[1]
        s[0,4]=(-0.566065672786)*x[0]**o+(-0.797903214842)*x[0]+(0.305896347185)*x[1]**o+(-0.44763489831)*x[1]
        s[1,0]=(0.136108309012)*x[0]**o+(0.8858491692)*x[0]+(0.63174549565)*x[1]**o+(0.12884968267)*x[1]
        s[1,1]=(-0.420219415055)*x[0]**o+(-0.474087579489)*x[0]+(-0.639616730493)*x[1]**o+(-0.339713160471)*x[1]
        s[1,2]=(0.730001695284)*x[0]**o+(-0.281914379046)*x[0]+(-0.0897917239674)*x[1]**o+(-0.521366256858)*x[1]
        s[1,3]=(0.507225459863)*x[0]**o+(-0.279054149386)*x[0]+(-0.310997653203)*x[1]**o+(0.798594910647)*x[1]
        s[1,4]=(-0.473780124237)*x[0]**o+(-0.521982314393)*x[0]+(-0.66517104956)*x[1]**o+(0.906212634536)*x[1]
        s[2,0]=(0.981595846105)*x[0]**o+(0.306232557856)*x[0]+(0.144004451791)*x[1]**o+(0.590440862044)*x[1]
        s[2,1]=(-0.465282108724)*x[0]**o+(-0.911349734596)*x[0]+(0.724954062739)*x[1]**o+(0.0617692321941)*x[1]
        s[2,2]=(-0.698461944366)*x[0]**o+(0.69038728172)*x[0]+(-0.0999661256163)*x[1]**o+(0.81993889447)*x[1]
        s[2,3]=(-0.850065489825)*x[0]**o+(-0.137124990846)*x[0]+(0.390609467506)*x[1]**o+(0.0928979112394)*x[1]
        s[2,4]=(-0.831110879728)*x[0]**o+(0.85125177454)*x[0]+(0.322669554869)*x[1]**o+(0.199419883126)*x[1]
        s[3,0]=(0.560516174698)*x[0]**o+(-0.952963851912)*x[0]+(0.0840374448937)*x[1]**o+(0.852644015588)*x[1]
        s[3,1]=(-0.738776742753)*x[0]**o+(-0.718650015551)*x[0]+(-0.48025826111)*x[1]**o+(0.163919964403)*x[1]
        s[3,2]=(-0.498985570012)*x[0]**o+(0.796130560575)*x[0]+(0.78812252561)*x[1]**o+(0.427402467946)*x[1]
        s[3,3]=(0.900695900592)*x[0]**o+(-0.68276543281)*x[0]+(-0.448699598266)*x[1]**o+(0.338876907438)*x[1]
        s[3,4]=(-0.101161698815)*x[0]**o+(0.24782725682)*x[0]+(0.194568299968)*x[1]**o+(-0.232062305313)*x[1]
        ref[0,0]=(1.32812085143)/(o+1.)+(0.801921430247)
        ref[0,1]=(-0.433719259185)/(o+1.)+(0.211102999768)
        ref[0,2]=(0.141986719401)/(o+1.)+(-0.153185931769)
        ref[0,3]=(-0.0200681364268)/(o+1.)+(0.457102533825)
        ref[0,4]=(-0.260169325601)/(o+1.)+(-0.622769056576)
        ref[1,0]=(0.767853804662)/(o+1.)+(0.507349425935)
        ref[1,1]=(-1.05983614555)/(o+1.)+(-0.40690036998)
        ref[1,2]=(0.640209971317)/(o+1.)+(-0.401640317952)
        ref[1,3]=(0.19622780666)/(o+1.)+(0.259770380631)
        ref[1,4]=(-1.1389511738)/(o+1.)+(0.192115160071)
        ref[2,0]=(1.1256002979)/(o+1.)+(0.44833670995)
        ref[2,1]=(0.259671954016)/(o+1.)+(-0.424790251201)
        ref[2,2]=(-0.798428069982)/(o+1.)+(0.755163088095)
        ref[2,3]=(-0.459456022319)/(o+1.)+(-0.0221135398034)
        ref[2,4]=(-0.508441324858)/(o+1.)+(0.525335828833)
        ref[3,0]=(0.644553619592)/(o+1.)+(-0.0501599181621)
        ref[3,1]=(-1.21903500386)/(o+1.)+(-0.277365025574)
        ref[3,2]=(0.289136955597)/(o+1.)+(0.611766514261)
        ref[3,3]=(0.451996302326)/(o+1.)+(-0.171944262686)
        ref[3,4]=(0.0934066011531)/(o+1.)+(0.00788247575383)
      else:
        s[0,0]=(0.581126436866)*x[0]**o+(0.307736169306)*x[0]+(0.46264603817)*x[1]**o+(-0.658226966972)*x[1]+(0.560314472945)*x[2]**o+(-0.71392138112)*x[2]
        s[0,1]=(0.41763244695)*x[0]**o+(-0.249710720358)*x[0]+(0.318827586572)*x[1]**o+(-0.766338584888)*x[1]+(-0.235847336194)*x[2]**o+(0.720822035745)*x[2]
        s[0,2]=(0.753177939244)*x[0]**o+(0.575601283201)*x[0]+(0.833261599709)*x[1]**o+(0.285673583448)*x[1]+(-0.850617074406)*x[2]**o+(0.976207021957)*x[2]
        s[0,3]=(-0.246323991583)*x[0]**o+(-0.425601468065)*x[0]+(-0.631382577618)*x[1]**o+(0.303177559003)*x[1]+(-0.772499313037)*x[2]**o+(0.0976456268892)*x[2]
        s[0,4]=(0.459782891083)*x[0]**o+(0.695607546341)*x[0]+(-0.758437555397)*x[1]**o+(-0.0467038938803)*x[1]+(0.077637691262)*x[2]**o+(0.632686471042)*x[2]
        s[1,0]=(0.62677312896)*x[0]**o+(-0.538520494446)*x[0]+(0.322526032671)*x[1]**o+(0.155570348616)*x[1]+(-0.645711565238)*x[2]**o+(-0.505639404827)*x[2]
        s[1,1]=(0.760035088253)*x[0]**o+(-0.653433840013)*x[0]+(0.541102747261)*x[1]**o+(0.102121826295)*x[1]+(0.203147157734)*x[2]**o+(0.825692237055)*x[2]
        s[1,2]=(0.83286976398)*x[0]**o+(-0.483950138218)*x[0]+(-0.988388711773)*x[1]**o+(0.276946264031)*x[1]+(-0.769100710972)*x[2]**o+(-0.857758652165)*x[2]
        s[1,3]=(0.965261287995)*x[0]**o+(-0.582299103263)*x[0]+(0.650118954781)*x[1]**o+(-0.714080635544)*x[1]+(-0.984672595257)*x[2]**o+(-0.890248882426)*x[2]
        s[1,4]=(0.780505914972)*x[0]**o+(-0.469283145875)*x[0]+(0.65642477278)*x[1]**o+(-0.0385309033271)*x[1]+(-0.838684124311)*x[2]**o+(0.715186480156)*x[2]
        s[2,0]=(-0.957976655406)*x[0]**o+(-0.326902969464)*x[0]+(0.519819227981)*x[1]**o+(0.526859170123)*x[1]+(-0.83643924332)*x[2]**o+(-0.833906618158)*x[2]
        s[2,1]=(0.511380988321)*x[0]**o+(0.205939303999)*x[0]+(-0.560011037377)*x[1]**o+(-0.74412420954)*x[1]+(-0.413858375939)*x[2]**o+(-0.818302325723)*x[2]
        s[2,2]=(0.669120009156)*x[0]**o+(-0.680617749061)*x[0]+(-0.855851359703)*x[1]**o+(0.681103383833)*x[1]+(0.358345655307)*x[2]**o+(-0.834176731331)*x[2]
        s[2,3]=(0.113991673968)*x[0]**o+(-0.167621358311)*x[0]+(-0.824506843066)*x[1]**o+(0.576032397062)*x[1]+(0.98813748839)*x[2]**o+(-0.954277123787)*x[2]
        s[2,4]=(0.758065768891)*x[0]**o+(0.550472010004)*x[0]+(0.541968389568)*x[1]**o+(-0.893196211859)*x[1]+(0.55846204484)*x[2]**o+(-0.154935285741)*x[2]
        s[3,0]=(0.319452905704)*x[0]**o+(0.416924332754)*x[0]+(0.695996329307)*x[1]**o+(-0.512723809281)*x[1]+(-0.0438582487583)*x[2]**o+(-0.202757150975)*x[2]
        s[3,1]=(0.300936121076)*x[0]**o+(0.0199168771219)*x[0]+(-0.79311689061)*x[1]**o+(0.120821678434)*x[1]+(0.832598541766)*x[2]**o+(-0.13378517127)*x[2]
        s[3,2]=(0.816251625164)*x[0]**o+(0.180324577125)*x[0]+(0.869902904875)*x[1]**o+(-0.300483761133)*x[1]+(0.405728532808)*x[2]**o+(-0.772682148538)*x[2]
        s[3,3]=(-0.0882536430174)*x[0]**o+(0.67244001887)*x[0]+(-0.295701327277)*x[1]**o+(-0.235065967505)*x[1]+(0.905094390215)*x[2]**o+(-0.132120939051)*x[2]
        s[3,4]=(0.976955651594)*x[0]**o+(0.36283338584)*x[0]+(0.21945555266)*x[1]**o+(-0.305668951381)*x[1]+(0.581731431193)*x[2]**o+(-0.308954336316)*x[2]
        ref[0,0]=(1.60408694798)/(o+1.)+(-0.532206089393)
        ref[0,1]=(0.500612697329)/(o+1.)+(-0.147613634751)
        ref[0,2]=(0.735822464547)/(o+1.)+(0.918740944303)
        ref[0,3]=(-1.65020588224)/(o+1.)+(-0.0123891410865)
        ref[0,4]=(-0.221016973052)/(o+1.)+(0.640795061752)
        ref[1,0]=(0.303587596392)/(o+1.)+(-0.444294775329)
        ref[1,1]=(1.50428499325)/(o+1.)+(0.137190111668)
        ref[1,2]=(-0.924619658766)/(o+1.)+(-0.532381263176)
        ref[1,3]=(0.630707647519)/(o+1.)+(-1.09331431062)
        ref[1,4]=(0.598246563441)/(o+1.)+(0.103686215477)
        ref[2,0]=(-1.27459667074)/(o+1.)+(-0.31697520875)
        ref[2,1]=(-0.462488424995)/(o+1.)+(-0.678243615632)
        ref[2,2]=(0.17161430476)/(o+1.)+(-0.416845548279)
        ref[2,3]=(0.277622319292)/(o+1.)+(-0.272933042518)
        ref[2,4]=(1.8584962033)/(o+1.)+(-0.248829743798)
        ref[3,0]=(0.971590986252)/(o+1.)+(-0.149278313751)
        ref[3,1]=(0.340417772233)/(o+1.)+(0.00347669214316)
        ref[3,2]=(2.09188306285)/(o+1.)+(-0.446420666273)
        ref[3,3]=(0.521139419921)/(o+1.)+(0.152626556157)
        ref[3,4]=(1.77814263545)/(o+1.)+(-0.125894950929)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Solution_rank3(self):
      """
      tests integral of rank 3 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.327469743415)*x[0]**o+(0.986515360087)*x[0]+(-0.264743586601)*x[1]**o+(-0.417911841646)*x[1]
        s[0,0,1]=(-0.367335531482)*x[0]**o+(-0.294564095391)*x[0]+(0.948849162205)*x[1]**o+(-0.672727814952)*x[1]
        s[0,1,0]=(0.201971500659)*x[0]**o+(0.715648302042)*x[0]+(0.200753457036)*x[1]**o+(-0.447431022755)*x[1]
        s[0,1,1]=(0.391503527712)*x[0]**o+(0.561563485529)*x[0]+(0.0756343714486)*x[1]**o+(-0.232567658257)*x[1]
        s[1,0,0]=(0.0416189159889)*x[0]**o+(0.933172580543)*x[0]+(0.906370262092)*x[1]**o+(0.843408035954)*x[1]
        s[1,0,1]=(-0.0489328569668)*x[0]**o+(0.305933018225)*x[0]+(0.459563500395)*x[1]**o+(-0.305696910459)*x[1]
        s[1,1,0]=(-0.166432892993)*x[0]**o+(0.323257103336)*x[0]+(-0.876673724336)*x[1]**o+(-0.246533332987)*x[1]
        s[1,1,1]=(0.331551737096)*x[0]**o+(-0.473411829001)*x[0]+(0.658917172856)*x[1]**o+(-0.645603256937)*x[1]
        s[2,0,0]=(-0.779837619461)*x[0]**o+(0.726847293406)*x[0]+(0.756283586425)*x[1]**o+(0.820695230411)*x[1]
        s[2,0,1]=(-0.0446700642358)*x[0]**o+(-0.00612226458731)*x[0]+(-0.255350731215)*x[1]**o+(0.279072151991)*x[1]
        s[2,1,0]=(0.952754783643)*x[0]**o+(0.575497372286)*x[0]+(-0.996409669059)*x[1]**o+(-0.993504128277)*x[1]
        s[2,1,1]=(-0.964146199975)*x[0]**o+(-0.89830816406)*x[0]+(0.27874102283)*x[1]**o+(-0.193698734442)*x[1]
        s[3,0,0]=(-0.22434829265)*x[0]**o+(-0.451123824419)*x[0]+(0.0996011155458)*x[1]**o+(-0.0196796989303)*x[1]
        s[3,0,1]=(0.479762785194)*x[0]**o+(-0.0875868570981)*x[0]+(-0.604020314973)*x[1]**o+(-0.948950136203)*x[1]
        s[3,1,0]=(0.380546378709)*x[0]**o+(0.968895520825)*x[0]+(0.0717757394195)*x[1]**o+(0.00273829931123)*x[1]
        s[3,1,1]=(0.999877803305)*x[0]**o+(0.726497905193)*x[0]+(-0.156097974361)*x[1]**o+(0.875069921439)*x[1]
        s[4,0,0]=(0.298060895282)*x[0]**o+(-0.25017046132)*x[0]+(-0.6409928584)*x[1]**o+(0.237325951363)*x[1]
        s[4,0,1]=(0.176241833972)*x[0]**o+(0.362302520221)*x[0]+(-0.632667110076)*x[1]**o+(0.206684577439)*x[1]
        s[4,1,0]=(-0.0658280231422)*x[0]**o+(-0.830173560366)*x[0]+(-0.408668580492)*x[1]**o+(0.131219154432)*x[1]
        s[4,1,1]=(-0.739357616315)*x[0]**o+(0.331825079796)*x[0]+(-0.950532071867)*x[1]**o+(0.430637319576)*x[1]
        s[5,0,0]=(-0.374056178585)*x[0]**o+(-0.503558441322)*x[0]+(0.253751100374)*x[1]**o+(-0.169874527745)*x[1]
        s[5,0,1]=(-0.540168118335)*x[0]**o+(-0.599437156114)*x[0]+(-0.545843659509)*x[1]**o+(-0.144502584314)*x[1]
        s[5,1,0]=(0.734871232877)*x[0]**o+(0.294937992469)*x[0]+(0.318246966782)*x[1]**o+(0.301215884904)*x[1]
        s[5,1,1]=(-0.48224128272)*x[0]**o+(-0.971913873914)*x[0]+(-0.853997429288)*x[1]**o+(0.911950472127)*x[1]
        ref[0,0,0]=(0.062726156814)/(o+1.)+(0.284301759221)
        ref[0,0,1]=(0.581513630723)/(o+1.)+(-0.483645955172)
        ref[0,1,0]=(0.402724957695)/(o+1.)+(0.134108639643)
        ref[0,1,1]=(0.467137899161)/(o+1.)+(0.164497913636)
        ref[1,0,0]=(0.947989178081)/(o+1.)+(0.888290308248)
        ref[1,0,1]=(0.410630643428)/(o+1.)+(0.000118053882864)
        ref[1,1,0]=(-1.04310661733)/(o+1.)+(0.0383618851745)
        ref[1,1,1]=(0.990468909952)/(o+1.)+(-0.559507542969)
        ref[2,0,0]=(-0.0235540330353)/(o+1.)+(0.773771261908)
        ref[2,0,1]=(-0.300020795451)/(o+1.)+(0.136474943702)
        ref[2,1,0]=(-0.043654885416)/(o+1.)+(-0.209003377996)
        ref[2,1,1]=(-0.685405177144)/(o+1.)+(-0.546003449251)
        ref[3,0,0]=(-0.124747177104)/(o+1.)+(-0.235401761675)
        ref[3,0,1]=(-0.124257529779)/(o+1.)+(-0.51826849665)
        ref[3,1,0]=(0.452322118128)/(o+1.)+(0.485816910068)
        ref[3,1,1]=(0.843779828944)/(o+1.)+(0.800783913316)
        ref[4,0,0]=(-0.342931963118)/(o+1.)+(-0.00642225497804)
        ref[4,0,1]=(-0.456425276104)/(o+1.)+(0.28449354883)
        ref[4,1,0]=(-0.474496603634)/(o+1.)+(-0.349477202967)
        ref[4,1,1]=(-1.68988968818)/(o+1.)+(0.381231199686)
        ref[5,0,0]=(-0.120305078211)/(o+1.)+(-0.336716484533)
        ref[5,0,1]=(-1.08601177784)/(o+1.)+(-0.371969870214)
        ref[5,1,0]=(1.05311819966)/(o+1.)+(0.298076938687)
        ref[5,1,1]=(-1.33623871201)/(o+1.)+(-0.0299817008935)
      else:
        s[0,0,0]=(0.907642728831)*x[0]**o+(0.24755436099)*x[0]+(0.329429496561)*x[1]**o+(0.195804615806)*x[1]+(0.635928214783)*x[2]**o+(0.286575554416)*x[2]
        s[0,0,1]=(-0.596463751156)*x[0]**o+(-0.573557158304)*x[0]+(-0.799372215818)*x[1]**o+(0.917917612224)*x[1]+(0.743915017372)*x[2]**o+(0.697340711065)*x[2]
        s[0,1,0]=(-0.226377288829)*x[0]**o+(0.11441928128)*x[0]+(0.915343934109)*x[1]**o+(0.0235994828916)*x[1]+(0.837206417747)*x[2]**o+(-0.809536949964)*x[2]
        s[0,1,1]=(-0.807835571238)*x[0]**o+(-0.313842967415)*x[0]+(0.143974822075)*x[1]**o+(0.772050096219)*x[1]+(0.0698457301843)*x[2]**o+(-0.878711129876)*x[2]
        s[1,0,0]=(0.806964016183)*x[0]**o+(0.906862034833)*x[0]+(0.656990650598)*x[1]**o+(0.858146180457)*x[1]+(-0.455748564953)*x[2]**o+(0.0415537957765)*x[2]
        s[1,0,1]=(0.930192572382)*x[0]**o+(0.406175274412)*x[0]+(0.522683472096)*x[1]**o+(-0.40154832923)*x[1]+(0.62436447915)*x[2]**o+(0.942684294891)*x[2]
        s[1,1,0]=(-0.190480904061)*x[0]**o+(-0.884913647118)*x[0]+(0.894504380487)*x[1]**o+(0.472867062235)*x[1]+(-0.226561577541)*x[2]**o+(0.0817340770676)*x[2]
        s[1,1,1]=(-0.785577817856)*x[0]**o+(0.286061214076)*x[0]+(-0.29241495776)*x[1]**o+(-0.885469334696)*x[1]+(-0.728917274605)*x[2]**o+(-0.400170372532)*x[2]
        s[2,0,0]=(-0.0443801095191)*x[0]**o+(-0.580757683753)*x[0]+(-0.680012816252)*x[1]**o+(-0.24174589493)*x[1]+(-0.32345463822)*x[2]**o+(0.488362285647)*x[2]
        s[2,0,1]=(0.427683981593)*x[0]**o+(0.709521979359)*x[0]+(-0.485171186139)*x[1]**o+(-0.466170281294)*x[1]+(0.668169758775)*x[2]**o+(-0.32376435425)*x[2]
        s[2,1,0]=(-0.322582923837)*x[0]**o+(-0.243805747954)*x[0]+(-0.282254505116)*x[1]**o+(0.276894252913)*x[1]+(0.425316275665)*x[2]**o+(-0.843958018195)*x[2]
        s[2,1,1]=(-0.172148420657)*x[0]**o+(0.288740472914)*x[0]+(0.3130139801)*x[1]**o+(0.0909556111434)*x[1]+(-0.134361659944)*x[2]**o+(-0.958259889515)*x[2]
        s[3,0,0]=(0.509175759598)*x[0]**o+(0.901681022023)*x[0]+(-0.04878880083)*x[1]**o+(-0.292935057546)*x[1]+(-0.73460973687)*x[2]**o+(0.143266558286)*x[2]
        s[3,0,1]=(-0.525256676545)*x[0]**o+(0.330501687555)*x[0]+(-0.533311903214)*x[1]**o+(-0.558985165298)*x[1]+(-0.726910027746)*x[2]**o+(-0.430022743518)*x[2]
        s[3,1,0]=(-0.801052113128)*x[0]**o+(0.383850418649)*x[0]+(-0.74692163952)*x[1]**o+(0.119907629434)*x[1]+(-0.688440032866)*x[2]**o+(0.258856702215)*x[2]
        s[3,1,1]=(0.662483893926)*x[0]**o+(0.321392974926)*x[0]+(0.797623010994)*x[1]**o+(-0.555546458227)*x[1]+(0.140050792242)*x[2]**o+(0.819042937008)*x[2]
        s[4,0,0]=(0.208697187872)*x[0]**o+(0.347715032509)*x[0]+(0.900642395285)*x[1]**o+(-0.121096976816)*x[1]+(0.473919668027)*x[2]**o+(0.693182424772)*x[2]
        s[4,0,1]=(0.185689163302)*x[0]**o+(0.923973904464)*x[0]+(-0.091048447659)*x[1]**o+(-0.331567067076)*x[1]+(0.0639420800968)*x[2]**o+(0.0645745629094)*x[2]
        s[4,1,0]=(-0.097237311089)*x[0]**o+(0.0234720818008)*x[0]+(-0.476652797084)*x[1]**o+(-0.258741500235)*x[1]+(-0.644183703276)*x[2]**o+(-0.953514564143)*x[2]
        s[4,1,1]=(-0.647701499983)*x[0]**o+(0.514337030449)*x[0]+(-0.779360494982)*x[1]**o+(-0.467345311588)*x[1]+(0.166149183082)*x[2]**o+(0.12480608055)*x[2]
        s[5,0,0]=(-0.349937644226)*x[0]**o+(0.673132604681)*x[0]+(0.793703484606)*x[1]**o+(0.958967045691)*x[1]+(-0.361047380062)*x[2]**o+(0.758206969142)*x[2]
        s[5,0,1]=(0.415890706186)*x[0]**o+(0.748811321123)*x[0]+(-0.629959299026)*x[1]**o+(0.706391001435)*x[1]+(-0.831407461643)*x[2]**o+(0.698632094335)*x[2]
        s[5,1,0]=(-0.914414551259)*x[0]**o+(0.85324200236)*x[0]+(0.273543170188)*x[1]**o+(0.311955664492)*x[1]+(0.726975838083)*x[2]**o+(0.671917428159)*x[2]
        s[5,1,1]=(0.450170734221)*x[0]**o+(-0.928357299044)*x[0]+(-0.645229625203)*x[1]**o+(0.756723626659)*x[1]+(-0.85050032636)*x[2]**o+(0.70593481655)*x[2]
        ref[0,0,0]=(1.87300044017)/(o+1.)+(0.364967265606)
        ref[0,0,1]=(-0.651920949601)/(o+1.)+(0.520850582493)
        ref[0,1,0]=(1.52617306303)/(o+1.)+(-0.335759092896)
        ref[0,1,1]=(-0.594015018979)/(o+1.)+(-0.210252000536)
        ref[1,0,0]=(1.00820610183)/(o+1.)+(0.903281005533)
        ref[1,0,1]=(2.07724052363)/(o+1.)+(0.473655620037)
        ref[1,1,0]=(0.477461898885)/(o+1.)+(-0.165156253908)
        ref[1,1,1]=(-1.80691005022)/(o+1.)+(-0.499789246576)
        ref[2,0,0]=(-1.04784756399)/(o+1.)+(-0.167070646517)
        ref[2,0,1]=(0.610682554229)/(o+1.)+(-0.0402063280924)
        ref[2,1,0]=(-0.179521153288)/(o+1.)+(-0.405434756618)
        ref[2,1,1]=(0.00650389949838)/(o+1.)+(-0.289281902729)
        ref[3,0,0]=(-0.274222778102)/(o+1.)+(0.376006261382)
        ref[3,0,1]=(-1.7854786075)/(o+1.)+(-0.329253110631)
        ref[3,1,0]=(-2.23641378551)/(o+1.)+(0.381307375149)
        ref[3,1,1]=(1.60015769716)/(o+1.)+(0.292444726853)
        ref[4,0,0]=(1.58325925118)/(o+1.)+(0.459900240233)
        ref[4,0,1]=(0.15858279574)/(o+1.)+(0.328490700148)
        ref[4,1,0]=(-1.21807381145)/(o+1.)+(-0.594391991289)
        ref[4,1,1]=(-1.26091281188)/(o+1.)+(0.085898899706)
        ref[5,0,0]=(0.0827184603185)/(o+1.)+(1.19515330976)
        ref[5,0,1]=(-1.04547605448)/(o+1.)+(1.07691720845)
        ref[5,1,0]=(0.086104457012)/(o+1.)+(0.918557547505)
        ref[5,1,1]=(-1.04555921734)/(o+1.)+(0.267150572083)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Solution_rank4(self):
      """
      tests integral of rank 4 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.501583472757)*x[0]**o+(0.174276674809)*x[0]+(0.474559132041)*x[1]**o+(0.944197178797)*x[1]
        s[0,0,0,1]=(-0.850492891287)*x[0]**o+(-0.778714553562)*x[0]+(-0.864025500909)*x[1]**o+(0.905856111362)*x[1]
        s[0,0,1,0]=(0.837983487193)*x[0]**o+(0.789080933347)*x[0]+(0.0618430819498)*x[1]**o+(0.791928371037)*x[1]
        s[0,0,1,1]=(-0.678469228871)*x[0]**o+(0.702133334239)*x[0]+(-0.937443836374)*x[1]**o+(-0.130947584181)*x[1]
        s[0,0,2,0]=(0.84013488851)*x[0]**o+(0.683811818455)*x[0]+(0.981450595677)*x[1]**o+(-0.813078675111)*x[1]
        s[0,0,2,1]=(0.00148903051979)*x[0]**o+(-0.740776021571)*x[0]+(0.917048043634)*x[1]**o+(0.362159065586)*x[1]
        s[0,1,0,0]=(0.285313019304)*x[0]**o+(0.0108652086531)*x[0]+(0.323356296135)*x[1]**o+(0.541189488955)*x[1]
        s[0,1,0,1]=(0.545540725184)*x[0]**o+(-0.803623471109)*x[0]+(0.861711269888)*x[1]**o+(0.614843604935)*x[1]
        s[0,1,1,0]=(0.44131453032)*x[0]**o+(-0.560146628455)*x[0]+(-0.390081444316)*x[1]**o+(-0.814215730743)*x[1]
        s[0,1,1,1]=(-0.120309068092)*x[0]**o+(-0.992223638563)*x[0]+(-0.757944249628)*x[1]**o+(-0.906900780015)*x[1]
        s[0,1,2,0]=(0.278503974882)*x[0]**o+(0.471665153392)*x[0]+(0.745287973293)*x[1]**o+(-0.572972893657)*x[1]
        s[0,1,2,1]=(0.840866880159)*x[0]**o+(-0.969714982065)*x[0]+(-0.181097771175)*x[1]**o+(-0.645812375407)*x[1]
        s[0,2,0,0]=(-0.791010044792)*x[0]**o+(-0.895489878363)*x[0]+(-0.32385199033)*x[1]**o+(0.892979821152)*x[1]
        s[0,2,0,1]=(0.966330767971)*x[0]**o+(0.757433262697)*x[0]+(0.859264987879)*x[1]**o+(0.836273715628)*x[1]
        s[0,2,1,0]=(0.764347587379)*x[0]**o+(0.498460349969)*x[0]+(0.896024738679)*x[1]**o+(0.341308865054)*x[1]
        s[0,2,1,1]=(-0.276964987386)*x[0]**o+(-0.294300496732)*x[0]+(-0.755886597374)*x[1]**o+(0.0964446535133)*x[1]
        s[0,2,2,0]=(0.933876243978)*x[0]**o+(0.694067023434)*x[0]+(-0.626635561624)*x[1]**o+(0.107630740485)*x[1]
        s[0,2,2,1]=(0.905601520891)*x[0]**o+(0.246861090683)*x[0]+(0.364620749293)*x[1]**o+(-0.34329084894)*x[1]
        s[0,3,0,0]=(-0.484050880674)*x[0]**o+(-0.344211446029)*x[0]+(-0.304888212647)*x[1]**o+(-0.918515747538)*x[1]
        s[0,3,0,1]=(0.352307753352)*x[0]**o+(-0.497295643302)*x[0]+(-0.0859041918813)*x[1]**o+(-0.566829131134)*x[1]
        s[0,3,1,0]=(0.458949103752)*x[0]**o+(-0.940473606591)*x[0]+(0.500249302466)*x[1]**o+(-0.192176323799)*x[1]
        s[0,3,1,1]=(0.714312790267)*x[0]**o+(0.219740572431)*x[0]+(-0.621517496057)*x[1]**o+(-0.79963217554)*x[1]
        s[0,3,2,0]=(-0.041379012308)*x[0]**o+(-0.674987043823)*x[0]+(-0.0165846458396)*x[1]**o+(0.643074958959)*x[1]
        s[0,3,2,1]=(-0.258839387368)*x[0]**o+(0.63938656748)*x[0]+(0.0042420382287)*x[1]**o+(-0.711660235823)*x[1]
        s[0,4,0,0]=(-0.905262277861)*x[0]**o+(0.995066153797)*x[0]+(0.895316712432)*x[1]**o+(0.794484306559)*x[1]
        s[0,4,0,1]=(0.858709170162)*x[0]**o+(-0.896059882819)*x[0]+(-0.322447413352)*x[1]**o+(0.356724683447)*x[1]
        s[0,4,1,0]=(-0.496930600469)*x[0]**o+(-0.715930772072)*x[0]+(0.514137034309)*x[1]**o+(0.738095094325)*x[1]
        s[0,4,1,1]=(-0.475961686127)*x[0]**o+(0.406077221295)*x[0]+(-0.934472851356)*x[1]**o+(0.184564622216)*x[1]
        s[0,4,2,0]=(0.50929205392)*x[0]**o+(-0.361652258356)*x[0]+(-0.828564581552)*x[1]**o+(0.864597967503)*x[1]
        s[0,4,2,1]=(-0.670572914815)*x[0]**o+(-0.917836333665)*x[0]+(0.329473913157)*x[1]**o+(0.649536686851)*x[1]
        s[1,0,0,0]=(0.507327212873)*x[0]**o+(-0.784119587219)*x[0]+(0.861200611677)*x[1]**o+(-0.537142113189)*x[1]
        s[1,0,0,1]=(0.307279452436)*x[0]**o+(-0.331535898217)*x[0]+(0.864752548746)*x[1]**o+(-0.41254012361)*x[1]
        s[1,0,1,0]=(0.723666220176)*x[0]**o+(-0.528755526062)*x[0]+(0.182515067109)*x[1]**o+(-0.33319767285)*x[1]
        s[1,0,1,1]=(-0.652532069809)*x[0]**o+(-0.497647481159)*x[0]+(-0.726676961172)*x[1]**o+(0.901803102587)*x[1]
        s[1,0,2,0]=(0.966840239828)*x[0]**o+(-0.559625286504)*x[0]+(0.856786274248)*x[1]**o+(-0.231280485522)*x[1]
        s[1,0,2,1]=(0.898750450503)*x[0]**o+(-0.241387492118)*x[0]+(-0.242302411171)*x[1]**o+(-0.931590118111)*x[1]
        s[1,1,0,0]=(0.298117967411)*x[0]**o+(-0.887837423565)*x[0]+(-0.804393274952)*x[1]**o+(-0.339940646012)*x[1]
        s[1,1,0,1]=(-0.3303942703)*x[0]**o+(0.22588379719)*x[0]+(0.427447092807)*x[1]**o+(-0.940368147505)*x[1]
        s[1,1,1,0]=(-0.227054817206)*x[0]**o+(0.76367061207)*x[0]+(-0.382609156261)*x[1]**o+(-0.869111355614)*x[1]
        s[1,1,1,1]=(0.538281073824)*x[0]**o+(-0.454205347349)*x[0]+(-0.121007985262)*x[1]**o+(0.0290163849694)*x[1]
        s[1,1,2,0]=(-0.888958335111)*x[0]**o+(0.779682676236)*x[0]+(-0.875785352701)*x[1]**o+(-0.891960671849)*x[1]
        s[1,1,2,1]=(-0.173332519418)*x[0]**o+(-0.104421077299)*x[0]+(0.906729441747)*x[1]**o+(-0.616671337017)*x[1]
        s[1,2,0,0]=(-0.305885548664)*x[0]**o+(-0.86724411868)*x[0]+(-0.787155086634)*x[1]**o+(-0.898599442906)*x[1]
        s[1,2,0,1]=(0.848368426968)*x[0]**o+(0.0802812152769)*x[0]+(-0.378057863356)*x[1]**o+(-0.428488725116)*x[1]
        s[1,2,1,0]=(-0.290675868214)*x[0]**o+(0.342045945019)*x[0]+(-0.421298816185)*x[1]**o+(-0.553807359319)*x[1]
        s[1,2,1,1]=(0.0289012545961)*x[0]**o+(0.423276922447)*x[0]+(-0.911749389958)*x[1]**o+(-0.39409305776)*x[1]
        s[1,2,2,0]=(0.904480195539)*x[0]**o+(-0.729896491926)*x[0]+(-0.21305322735)*x[1]**o+(-0.347444381896)*x[1]
        s[1,2,2,1]=(0.34039428449)*x[0]**o+(-0.246758392869)*x[0]+(-0.159391459268)*x[1]**o+(-0.630134063159)*x[1]
        s[1,3,0,0]=(0.202017077356)*x[0]**o+(-0.195969669611)*x[0]+(0.267580338059)*x[1]**o+(-0.274282886887)*x[1]
        s[1,3,0,1]=(-0.183473257308)*x[0]**o+(-0.646999501714)*x[0]+(-0.746037354076)*x[1]**o+(-0.180977233442)*x[1]
        s[1,3,1,0]=(0.895075853694)*x[0]**o+(-0.820090467371)*x[0]+(-0.040561177436)*x[1]**o+(0.749395910572)*x[1]
        s[1,3,1,1]=(-0.232039710082)*x[0]**o+(-0.633561589743)*x[0]+(0.862514378491)*x[1]**o+(0.782438844898)*x[1]
        s[1,3,2,0]=(-0.0228789327036)*x[0]**o+(0.604368007016)*x[0]+(0.413803296189)*x[1]**o+(0.651011054925)*x[1]
        s[1,3,2,1]=(-0.682393812631)*x[0]**o+(-0.508380759547)*x[0]+(-0.958515947271)*x[1]**o+(-0.396382186265)*x[1]
        s[1,4,0,0]=(0.772945258804)*x[0]**o+(0.981773233361)*x[0]+(-0.415876208997)*x[1]**o+(0.391268836611)*x[1]
        s[1,4,0,1]=(-0.111414446087)*x[0]**o+(-0.381712931273)*x[0]+(0.389894843435)*x[1]**o+(-0.276144369314)*x[1]
        s[1,4,1,0]=(0.544309017751)*x[0]**o+(0.920841251767)*x[0]+(-0.524322161349)*x[1]**o+(-0.745967887424)*x[1]
        s[1,4,1,1]=(0.0993088568573)*x[0]**o+(0.172455640245)*x[0]+(-0.310227024922)*x[1]**o+(0.503773577532)*x[1]
        s[1,4,2,0]=(-0.282979849337)*x[0]**o+(0.573540669768)*x[0]+(0.974343187515)*x[1]**o+(0.643215559873)*x[1]
        s[1,4,2,1]=(0.616949303196)*x[0]**o+(-0.206142689323)*x[0]+(0.594875479161)*x[1]**o+(0.390460380914)*x[1]
        s[2,0,0,0]=(-0.164379488326)*x[0]**o+(-0.613380471473)*x[0]+(-0.309735177264)*x[1]**o+(0.722815882927)*x[1]
        s[2,0,0,1]=(-0.443733554915)*x[0]**o+(-0.226908044072)*x[0]+(0.22281947804)*x[1]**o+(0.321557448698)*x[1]
        s[2,0,1,0]=(0.979229428359)*x[0]**o+(-0.410075647119)*x[0]+(-0.0869658073133)*x[1]**o+(0.472354461211)*x[1]
        s[2,0,1,1]=(0.279554115394)*x[0]**o+(0.982131537982)*x[0]+(0.865627129266)*x[1]**o+(0.0595046994689)*x[1]
        s[2,0,2,0]=(-0.928629057762)*x[0]**o+(-0.0888000293033)*x[0]+(0.925425619622)*x[1]**o+(0.286877459131)*x[1]
        s[2,0,2,1]=(-0.128076644671)*x[0]**o+(0.769985562586)*x[0]+(-0.326281257692)*x[1]**o+(-0.904253231113)*x[1]
        s[2,1,0,0]=(-7.49817068653e-05)*x[0]**o+(0.944960174862)*x[0]+(0.394130491438)*x[1]**o+(0.904576980195)*x[1]
        s[2,1,0,1]=(0.51260445176)*x[0]**o+(0.871495843591)*x[0]+(-0.0117378185696)*x[1]**o+(-0.447028599408)*x[1]
        s[2,1,1,0]=(0.385302842134)*x[0]**o+(0.68530194308)*x[0]+(0.908717705423)*x[1]**o+(0.0657269588494)*x[1]
        s[2,1,1,1]=(-0.175101480962)*x[0]**o+(-0.0126863839895)*x[0]+(0.544228922923)*x[1]**o+(-0.856957800534)*x[1]
        s[2,1,2,0]=(-0.74757544736)*x[0]**o+(-0.705933683532)*x[0]+(0.496113134499)*x[1]**o+(0.134139074285)*x[1]
        s[2,1,2,1]=(0.661170765505)*x[0]**o+(-0.0954233403413)*x[0]+(0.796712312861)*x[1]**o+(0.941668952301)*x[1]
        s[2,2,0,0]=(0.396185569444)*x[0]**o+(0.352712187886)*x[0]+(0.132847269784)*x[1]**o+(0.00561831278948)*x[1]
        s[2,2,0,1]=(-0.284087190739)*x[0]**o+(-0.307024290069)*x[0]+(-0.958481172381)*x[1]**o+(0.0918318779969)*x[1]
        s[2,2,1,0]=(0.0633474988001)*x[0]**o+(-0.650310080822)*x[0]+(0.576579254607)*x[1]**o+(0.674521364804)*x[1]
        s[2,2,1,1]=(0.579536883642)*x[0]**o+(0.160337559302)*x[0]+(-0.806829552191)*x[1]**o+(-0.45313287787)*x[1]
        s[2,2,2,0]=(-0.922597521221)*x[0]**o+(-0.250217857798)*x[0]+(-0.0762271301664)*x[1]**o+(0.610046304117)*x[1]
        s[2,2,2,1]=(0.259914145502)*x[0]**o+(0.00944250446491)*x[0]+(-0.217644702814)*x[1]**o+(-0.396061779281)*x[1]
        s[2,3,0,0]=(-0.639026927928)*x[0]**o+(-0.0136042147736)*x[0]+(0.147051301049)*x[1]**o+(-0.116721318722)*x[1]
        s[2,3,0,1]=(-0.921716795774)*x[0]**o+(-0.573953102898)*x[0]+(-0.292599705087)*x[1]**o+(0.425695557831)*x[1]
        s[2,3,1,0]=(-0.137488915425)*x[0]**o+(-0.49947594329)*x[0]+(-0.0290388465996)*x[1]**o+(-0.246424924833)*x[1]
        s[2,3,1,1]=(0.231049448089)*x[0]**o+(-0.268957451079)*x[0]+(0.900504385567)*x[1]**o+(-0.331066572068)*x[1]
        s[2,3,2,0]=(-0.442867405047)*x[0]**o+(-0.862895940039)*x[0]+(0.130486555031)*x[1]**o+(-0.325005280104)*x[1]
        s[2,3,2,1]=(0.0505322685584)*x[0]**o+(0.588209043808)*x[0]+(-0.85729410482)*x[1]**o+(0.20026415404)*x[1]
        s[2,4,0,0]=(0.111265750114)*x[0]**o+(-0.368157597131)*x[0]+(0.264359624294)*x[1]**o+(0.880890103316)*x[1]
        s[2,4,0,1]=(0.7435570617)*x[0]**o+(-0.794211194611)*x[0]+(0.506134754195)*x[1]**o+(0.363318494554)*x[1]
        s[2,4,1,0]=(0.557218657611)*x[0]**o+(-0.584592285851)*x[0]+(-0.551098106406)*x[1]**o+(-0.253662162858)*x[1]
        s[2,4,1,1]=(0.508828804121)*x[0]**o+(0.4399952689)*x[0]+(-0.997629557499)*x[1]**o+(0.651550324191)*x[1]
        s[2,4,2,0]=(-0.292367705037)*x[0]**o+(0.325506979353)*x[0]+(0.345654565875)*x[1]**o+(-0.0615253936178)*x[1]
        s[2,4,2,1]=(-0.408469289071)*x[0]**o+(-0.242826710026)*x[0]+(0.968562541409)*x[1]**o+(-0.691883337576)*x[1]
        s[3,0,0,0]=(-0.166166381364)*x[0]**o+(0.67558604652)*x[0]+(0.681136750192)*x[1]**o+(-0.59276757042)*x[1]
        s[3,0,0,1]=(0.139326266787)*x[0]**o+(-0.855321186969)*x[0]+(0.87031372876)*x[1]**o+(0.167702944821)*x[1]
        s[3,0,1,0]=(0.0382861750276)*x[0]**o+(-0.15200218165)*x[0]+(0.877979117505)*x[1]**o+(-0.0121347649803)*x[1]
        s[3,0,1,1]=(0.498616833176)*x[0]**o+(-0.663932730791)*x[0]+(-0.351696535062)*x[1]**o+(0.635672218271)*x[1]
        s[3,0,2,0]=(0.570569612815)*x[0]**o+(0.302777992546)*x[0]+(0.234111661233)*x[1]**o+(0.23736500566)*x[1]
        s[3,0,2,1]=(0.103264640389)*x[0]**o+(-0.665245672415)*x[0]+(-0.507585301735)*x[1]**o+(-0.624579920066)*x[1]
        s[3,1,0,0]=(-0.424026522629)*x[0]**o+(-0.289542833446)*x[0]+(-0.208440343753)*x[1]**o+(0.670301272477)*x[1]
        s[3,1,0,1]=(0.884688677823)*x[0]**o+(-0.547024055336)*x[0]+(-0.760788413661)*x[1]**o+(0.892759772046)*x[1]
        s[3,1,1,0]=(-0.193616699826)*x[0]**o+(-0.817184462119)*x[0]+(-0.405430250489)*x[1]**o+(0.697242407135)*x[1]
        s[3,1,1,1]=(-0.224055211394)*x[0]**o+(0.1446788843)*x[0]+(0.242791365909)*x[1]**o+(-0.00969799364721)*x[1]
        s[3,1,2,0]=(-0.86134785548)*x[0]**o+(0.808223751392)*x[0]+(-0.59203015099)*x[1]**o+(-0.774006816622)*x[1]
        s[3,1,2,1]=(0.60450330353)*x[0]**o+(0.47388266469)*x[0]+(0.160423399019)*x[1]**o+(0.177522838509)*x[1]
        s[3,2,0,0]=(-0.0704547054622)*x[0]**o+(-0.28005227128)*x[0]+(0.842667852448)*x[1]**o+(-0.660858857912)*x[1]
        s[3,2,0,1]=(0.950935693626)*x[0]**o+(-0.707135492206)*x[0]+(0.383664604588)*x[1]**o+(0.301522608591)*x[1]
        s[3,2,1,0]=(-0.843657734623)*x[0]**o+(0.0313079420866)*x[0]+(0.842733149317)*x[1]**o+(0.8363224382)*x[1]
        s[3,2,1,1]=(0.590344608942)*x[0]**o+(-0.688010374961)*x[0]+(0.419847151895)*x[1]**o+(0.703183045156)*x[1]
        s[3,2,2,0]=(0.726161847781)*x[0]**o+(-0.644844589861)*x[0]+(0.615915050884)*x[1]**o+(0.928915762636)*x[1]
        s[3,2,2,1]=(-0.272507884368)*x[0]**o+(0.915695022479)*x[0]+(-0.461159868664)*x[1]**o+(-0.959034792496)*x[1]
        s[3,3,0,0]=(0.454712361388)*x[0]**o+(-0.212357162336)*x[0]+(0.153326792468)*x[1]**o+(-0.891670991055)*x[1]
        s[3,3,0,1]=(0.524401133703)*x[0]**o+(-0.649106057963)*x[0]+(0.879052771991)*x[1]**o+(-0.710445481523)*x[1]
        s[3,3,1,0]=(0.614330071709)*x[0]**o+(-0.632228392701)*x[0]+(0.272026382411)*x[1]**o+(-0.261384418355)*x[1]
        s[3,3,1,1]=(0.552126023508)*x[0]**o+(0.266617783195)*x[0]+(-0.183251756988)*x[1]**o+(0.905027547625)*x[1]
        s[3,3,2,0]=(-0.671825095536)*x[0]**o+(-0.0942290736973)*x[0]+(0.354473207574)*x[1]**o+(-0.61776928413)*x[1]
        s[3,3,2,1]=(0.8582228544)*x[0]**o+(-0.68683359365)*x[0]+(0.856354836335)*x[1]**o+(0.588764055551)*x[1]
        s[3,4,0,0]=(-0.535790362987)*x[0]**o+(0.835465266424)*x[0]+(-0.422274723942)*x[1]**o+(-0.979702488165)*x[1]
        s[3,4,0,1]=(-0.846846124079)*x[0]**o+(-0.52263128994)*x[0]+(0.0349528062482)*x[1]**o+(-0.498515393094)*x[1]
        s[3,4,1,0]=(-0.927241665975)*x[0]**o+(0.0353321330647)*x[0]+(-0.225562802107)*x[1]**o+(0.8207319568)*x[1]
        s[3,4,1,1]=(-0.174397417012)*x[0]**o+(-0.0398036522533)*x[0]+(0.0755396127937)*x[1]**o+(-0.102836810613)*x[1]
        s[3,4,2,0]=(-0.968779473612)*x[0]**o+(0.339954457114)*x[0]+(-0.613643260944)*x[1]**o+(0.301848346204)*x[1]
        s[3,4,2,1]=(0.994429790023)*x[0]**o+(0.159760881455)*x[0]+(0.252053920576)*x[1]**o+(-0.562820021013)*x[1]
        ref[0,0,0,0]=(0.976142604799)/(o+1.)+(0.559236926803)
        ref[0,0,0,1]=(-1.7145183922)/(o+1.)+(0.0635707789)
        ref[0,0,1,0]=(0.899826569143)/(o+1.)+(0.790504652192)
        ref[0,0,1,1]=(-1.61591306524)/(o+1.)+(0.285592875029)
        ref[0,0,2,0]=(1.82158548419)/(o+1.)+(-0.0646334283283)
        ref[0,0,2,1]=(0.918537074153)/(o+1.)+(-0.189308477993)
        ref[0,1,0,0]=(0.608669315438)/(o+1.)+(0.276027348804)
        ref[0,1,0,1]=(1.40725199507)/(o+1.)+(-0.0943899330873)
        ref[0,1,1,0]=(0.0512330860046)/(o+1.)+(-0.687181179599)
        ref[0,1,1,1]=(-0.878253317721)/(o+1.)+(-0.949562209289)
        ref[0,1,2,0]=(1.02379194818)/(o+1.)+(-0.0506538701325)
        ref[0,1,2,1]=(0.659769108985)/(o+1.)+(-0.807763678736)
        ref[0,2,0,0]=(-1.11486203512)/(o+1.)+(-0.00125502860562)
        ref[0,2,0,1]=(1.82559575585)/(o+1.)+(0.796853489163)
        ref[0,2,1,0]=(1.66037232606)/(o+1.)+(0.419884607511)
        ref[0,2,1,1]=(-1.03285158476)/(o+1.)+(-0.0989279216092)
        ref[0,2,2,0]=(0.307240682354)/(o+1.)+(0.400848881959)
        ref[0,2,2,1]=(1.27022227018)/(o+1.)+(-0.0482148791284)
        ref[0,3,0,0]=(-0.788939093322)/(o+1.)+(-0.631363596784)
        ref[0,3,0,1]=(0.26640356147)/(o+1.)+(-0.532062387218)
        ref[0,3,1,0]=(0.959198406218)/(o+1.)+(-0.566324965195)
        ref[0,3,1,1]=(0.0927952942109)/(o+1.)+(-0.289945801554)
        ref[0,3,2,0]=(-0.0579636581476)/(o+1.)+(-0.0159560424323)
        ref[0,3,2,1]=(-0.254597349139)/(o+1.)+(-0.0361368341719)
        ref[0,4,0,0]=(-0.00994556542921)/(o+1.)+(0.894775230178)
        ref[0,4,0,1]=(0.53626175681)/(o+1.)+(-0.269667599686)
        ref[0,4,1,0]=(0.0172064338404)/(o+1.)+(0.0110821611268)
        ref[0,4,1,1]=(-1.41043453748)/(o+1.)+(0.295320921755)
        ref[0,4,2,0]=(-0.319272527632)/(o+1.)+(0.251472854574)
        ref[0,4,2,1]=(-0.341099001658)/(o+1.)+(-0.134149823407)
        ref[1,0,0,0]=(1.36852782455)/(o+1.)+(-0.660630850204)
        ref[1,0,0,1]=(1.17203200118)/(o+1.)+(-0.372038010914)
        ref[1,0,1,0]=(0.906181287285)/(o+1.)+(-0.430976599456)
        ref[1,0,1,1]=(-1.37920903098)/(o+1.)+(0.202077810714)
        ref[1,0,2,0]=(1.82362651408)/(o+1.)+(-0.395452886013)
        ref[1,0,2,1]=(0.656448039332)/(o+1.)+(-0.586488805114)
        ref[1,1,0,0]=(-0.506275307541)/(o+1.)+(-0.613889034788)
        ref[1,1,0,1]=(0.0970528225071)/(o+1.)+(-0.357242175157)
        ref[1,1,1,0]=(-0.609663973467)/(o+1.)+(-0.0527203717721)
        ref[1,1,1,1]=(0.417273088561)/(o+1.)+(-0.21259448119)
        ref[1,1,2,0]=(-1.76474368781)/(o+1.)+(-0.0561389978065)
        ref[1,1,2,1]=(0.733396922329)/(o+1.)+(-0.360546207158)
        ref[1,2,0,0]=(-1.0930406353)/(o+1.)+(-0.882921780793)
        ref[1,2,0,1]=(0.470310563612)/(o+1.)+(-0.17410375492)
        ref[1,2,1,0]=(-0.711974684398)/(o+1.)+(-0.10588070715)
        ref[1,2,1,1]=(-0.882848135361)/(o+1.)+(0.0145919323434)
        ref[1,2,2,0]=(0.691426968189)/(o+1.)+(-0.538670436911)
        ref[1,2,2,1]=(0.181002825221)/(o+1.)+(-0.438446228014)
        ref[1,3,0,0]=(0.469597415414)/(o+1.)+(-0.235126278249)
        ref[1,3,0,1]=(-0.929510611384)/(o+1.)+(-0.413988367578)
        ref[1,3,1,0]=(0.854514676258)/(o+1.)+(-0.0353472783996)
        ref[1,3,1,1]=(0.630474668409)/(o+1.)+(0.0744386275773)
        ref[1,3,2,0]=(0.390924363485)/(o+1.)+(0.627689530971)
        ref[1,3,2,1]=(-1.6409097599)/(o+1.)+(-0.452381472906)
        ref[1,4,0,0]=(0.357069049807)/(o+1.)+(0.686521034986)
        ref[1,4,0,1]=(0.278480397348)/(o+1.)+(-0.328928650294)
        ref[1,4,1,0]=(0.0199868564018)/(o+1.)+(0.0874366821718)
        ref[1,4,1,1]=(-0.210918168065)/(o+1.)+(0.338114608888)
        ref[1,4,2,0]=(0.691363338179)/(o+1.)+(0.608378114821)
        ref[1,4,2,1]=(1.21182478236)/(o+1.)+(0.0921588457958)
        ref[2,0,0,0]=(-0.47411466559)/(o+1.)+(0.0547177057268)
        ref[2,0,0,1]=(-0.220914076875)/(o+1.)+(0.0473247023129)
        ref[2,0,1,0]=(0.892263621045)/(o+1.)+(0.0311394070465)
        ref[2,0,1,1]=(1.14518124466)/(o+1.)+(0.520818118726)
        ref[2,0,2,0]=(-0.00320343813922)/(o+1.)+(0.0990387149137)
        ref[2,0,2,1]=(-0.454357902363)/(o+1.)+(-0.0671338342638)
        ref[2,1,0,0]=(0.394055509731)/(o+1.)+(0.924768577529)
        ref[2,1,0,1]=(0.500866633191)/(o+1.)+(0.212233622092)
        ref[2,1,1,0]=(1.29402054756)/(o+1.)+(0.375514450965)
        ref[2,1,1,1]=(0.369127441961)/(o+1.)+(-0.434822092262)
        ref[2,1,2,0]=(-0.251462312861)/(o+1.)+(-0.285897304624)
        ref[2,1,2,1]=(1.45788307837)/(o+1.)+(0.42312280598)
        ref[2,2,0,0]=(0.529032839228)/(o+1.)+(0.179165250338)
        ref[2,2,0,1]=(-1.24256836312)/(o+1.)+(-0.107596206036)
        ref[2,2,1,0]=(0.639926753407)/(o+1.)+(0.0121056419913)
        ref[2,2,1,1]=(-0.227292668549)/(o+1.)+(-0.146397659284)
        ref[2,2,2,0]=(-0.998824651388)/(o+1.)+(0.179914223159)
        ref[2,2,2,1]=(0.0422694426877)/(o+1.)+(-0.193309637408)
        ref[2,3,0,0]=(-0.491975626879)/(o+1.)+(-0.0651627667478)
        ref[2,3,0,1]=(-1.21431650086)/(o+1.)+(-0.0741287725332)
        ref[2,3,1,0]=(-0.166527762025)/(o+1.)+(-0.372950434061)
        ref[2,3,1,1]=(1.13155383366)/(o+1.)+(-0.300012011573)
        ref[2,3,2,0]=(-0.312380850015)/(o+1.)+(-0.593950610072)
        ref[2,3,2,1]=(-0.806761836262)/(o+1.)+(0.394236598924)
        ref[2,4,0,0]=(0.375625374408)/(o+1.)+(0.256366253093)
        ref[2,4,0,1]=(1.2496918159)/(o+1.)+(-0.215446350028)
        ref[2,4,1,0]=(0.00612055120519)/(o+1.)+(-0.419127224354)
        ref[2,4,1,1]=(-0.488800753378)/(o+1.)+(0.545772796545)
        ref[2,4,2,0]=(0.0532868608376)/(o+1.)+(0.131990792868)
        ref[2,4,2,1]=(0.560093252338)/(o+1.)+(-0.467355023801)
        ref[3,0,0,0]=(0.514970368828)/(o+1.)+(0.0414092380501)
        ref[3,0,0,1]=(1.00963999555)/(o+1.)+(-0.343809121074)
        ref[3,0,1,0]=(0.916265292533)/(o+1.)+(-0.0820684733153)
        ref[3,0,1,1]=(0.146920298114)/(o+1.)+(-0.0141302562603)
        ref[3,0,2,0]=(0.804681274048)/(o+1.)+(0.270071499103)
        ref[3,0,2,1]=(-0.404320661346)/(o+1.)+(-0.644912796241)
        ref[3,1,0,0]=(-0.632466866383)/(o+1.)+(0.190379219516)
        ref[3,1,0,1]=(0.123900264162)/(o+1.)+(0.172867858355)
        ref[3,1,1,0]=(-0.599046950315)/(o+1.)+(-0.0599710274916)
        ref[3,1,1,1]=(0.0187361545152)/(o+1.)+(0.0674904453263)
        ref[3,1,2,0]=(-1.45337800647)/(o+1.)+(0.0171084673849)
        ref[3,1,2,1]=(0.764926702549)/(o+1.)+(0.325702751599)
        ref[3,2,0,0]=(0.772213146985)/(o+1.)+(-0.470455564596)
        ref[3,2,0,1]=(1.33460029821)/(o+1.)+(-0.202806441808)
        ref[3,2,1,0]=(-0.00092458530583)/(o+1.)+(0.433815190143)
        ref[3,2,1,1]=(1.01019176084)/(o+1.)+(0.00758633509776)
        ref[3,2,2,0]=(1.34207689867)/(o+1.)+(0.142035586387)
        ref[3,2,2,1]=(-0.733667753032)/(o+1.)+(-0.0216698850086)
        ref[3,3,0,0]=(0.608039153856)/(o+1.)+(-0.552014076696)
        ref[3,3,0,1]=(1.40345390569)/(o+1.)+(-0.679775769743)
        ref[3,3,1,0]=(0.88635645412)/(o+1.)+(-0.446806405528)
        ref[3,3,1,1]=(0.368874266519)/(o+1.)+(0.58582266541)
        ref[3,3,2,0]=(-0.317351887963)/(o+1.)+(-0.355999178914)
        ref[3,3,2,1]=(1.71457769073)/(o+1.)+(-0.0490347690493)
        ref[3,4,0,0]=(-0.958065086929)/(o+1.)+(-0.0721186108707)
        ref[3,4,0,1]=(-0.811893317831)/(o+1.)+(-0.510573341517)
        ref[3,4,1,0]=(-1.15280446808)/(o+1.)+(0.428032044932)
        ref[3,4,1,1]=(-0.0988578042187)/(o+1.)+(-0.0713202314331)
        ref[3,4,2,0]=(-1.58242273456)/(o+1.)+(0.320901401659)
        ref[3,4,2,1]=(1.2464837106)/(o+1.)+(-0.201529569779)
      else:
        s[0,0,0,0]=(0.541504168376)*x[0]**o+(0.0573239599909)*x[0]+(0.0647250584452)*x[1]**o+(-0.703570101211)*x[1]+(0.328542610633)*x[2]**o+(-0.223400684365)*x[2]
        s[0,0,0,1]=(0.815893107692)*x[0]**o+(0.865481882711)*x[0]+(-0.46283176119)*x[1]**o+(-0.180772911655)*x[1]+(0.93497108116)*x[2]**o+(-0.742753139638)*x[2]
        s[0,0,1,0]=(-0.974209081736)*x[0]**o+(-0.672767028246)*x[0]+(-0.741240928071)*x[1]**o+(0.33719490832)*x[1]+(-0.686997621399)*x[2]**o+(-0.276966804283)*x[2]
        s[0,0,1,1]=(-0.857143471623)*x[0]**o+(-0.808079211925)*x[0]+(-0.953814060073)*x[1]**o+(0.961661670434)*x[1]+(0.189072084458)*x[2]**o+(-0.103208629753)*x[2]
        s[0,0,2,0]=(-0.20991399963)*x[0]**o+(-0.442037964882)*x[0]+(0.322578941372)*x[1]**o+(-0.161870387325)*x[1]+(0.585691936782)*x[2]**o+(-0.267825636094)*x[2]
        s[0,0,2,1]=(0.567642417211)*x[0]**o+(0.824356280251)*x[0]+(0.414108305262)*x[1]**o+(0.79515753838)*x[1]+(-0.894154134914)*x[2]**o+(-0.307671452735)*x[2]
        s[0,1,0,0]=(0.536896074085)*x[0]**o+(0.361562637795)*x[0]+(-0.158827271642)*x[1]**o+(0.0705880551767)*x[1]+(-0.332232895988)*x[2]**o+(-0.0305180398365)*x[2]
        s[0,1,0,1]=(0.633176778138)*x[0]**o+(-0.572376784007)*x[0]+(-0.294505207444)*x[1]**o+(-0.378967371632)*x[1]+(-0.89662018673)*x[2]**o+(0.287814422967)*x[2]
        s[0,1,1,0]=(-0.61097365344)*x[0]**o+(-0.363660280252)*x[0]+(0.190746604006)*x[1]**o+(-0.510926077271)*x[1]+(-0.957696939615)*x[2]**o+(-0.789299643561)*x[2]
        s[0,1,1,1]=(-0.835396537806)*x[0]**o+(-0.836746663696)*x[0]+(0.702723030555)*x[1]**o+(0.548005714327)*x[1]+(-0.924774335596)*x[2]**o+(-0.439240327617)*x[2]
        s[0,1,2,0]=(0.461024657935)*x[0]**o+(-0.373409962194)*x[0]+(0.743442026381)*x[1]**o+(0.657544000829)*x[1]+(0.674057315581)*x[2]**o+(-0.0183044871772)*x[2]
        s[0,1,2,1]=(0.164119453764)*x[0]**o+(-0.31204382122)*x[0]+(-0.424802851747)*x[1]**o+(-0.341469957442)*x[1]+(-0.231054265963)*x[2]**o+(0.128985361513)*x[2]
        s[0,2,0,0]=(0.963584200519)*x[0]**o+(-0.465275784807)*x[0]+(0.421929871546)*x[1]**o+(-0.211860414792)*x[1]+(-0.403745447737)*x[2]**o+(-0.379173494789)*x[2]
        s[0,2,0,1]=(-0.849597493426)*x[0]**o+(-0.174912181728)*x[0]+(-0.0534228854624)*x[1]**o+(0.826630462481)*x[1]+(-0.0210209049463)*x[2]**o+(-0.675409496795)*x[2]
        s[0,2,1,0]=(-0.565229688917)*x[0]**o+(0.485718751072)*x[0]+(0.700861807655)*x[1]**o+(0.901169377907)*x[1]+(0.890394572646)*x[2]**o+(0.596255846932)*x[2]
        s[0,2,1,1]=(0.876434872654)*x[0]**o+(-0.83625911596)*x[0]+(-0.539508005116)*x[1]**o+(-0.790017898115)*x[1]+(-0.043576285617)*x[2]**o+(-0.90281792431)*x[2]
        s[0,2,2,0]=(0.688686103492)*x[0]**o+(-0.479018765365)*x[0]+(-0.0041922877839)*x[1]**o+(0.360321450098)*x[1]+(0.520980145515)*x[2]**o+(0.781262738907)*x[2]
        s[0,2,2,1]=(-0.416899995117)*x[0]**o+(-0.018267124332)*x[0]+(-0.052482515113)*x[1]**o+(0.6928630854)*x[1]+(-0.163882932309)*x[2]**o+(0.478296669995)*x[2]
        s[0,3,0,0]=(-0.80317047721)*x[0]**o+(-0.475554188062)*x[0]+(0.194711479429)*x[1]**o+(0.866725258981)*x[1]+(0.500781673148)*x[2]**o+(-0.360414664576)*x[2]
        s[0,3,0,1]=(0.243316356193)*x[0]**o+(-0.109598635489)*x[0]+(0.579141755165)*x[1]**o+(0.876481264859)*x[1]+(-0.880903923571)*x[2]**o+(0.142946599744)*x[2]
        s[0,3,1,0]=(-0.507217017458)*x[0]**o+(0.641911252335)*x[0]+(-0.764452998266)*x[1]**o+(-0.505598974991)*x[1]+(0.641213955525)*x[2]**o+(-0.44758893679)*x[2]
        s[0,3,1,1]=(0.473545973781)*x[0]**o+(-0.00833748934844)*x[0]+(-0.00699017656361)*x[1]**o+(-0.643164722085)*x[1]+(0.726844277071)*x[2]**o+(-0.559279257114)*x[2]
        s[0,3,2,0]=(0.558099790948)*x[0]**o+(0.808990368539)*x[0]+(0.0431682029749)*x[1]**o+(0.0173216046894)*x[1]+(-0.394219668262)*x[2]**o+(-0.0336030329937)*x[2]
        s[0,3,2,1]=(-0.0222232210481)*x[0]**o+(-0.510190960052)*x[0]+(0.569389223293)*x[1]**o+(0.117046338884)*x[1]+(-0.671864592568)*x[2]**o+(-0.674239142474)*x[2]
        s[0,4,0,0]=(-0.644798822323)*x[0]**o+(-0.342116629892)*x[0]+(-0.168244417587)*x[1]**o+(-0.108919120953)*x[1]+(0.804101464972)*x[2]**o+(-0.0927979618696)*x[2]
        s[0,4,0,1]=(0.195838618741)*x[0]**o+(-0.111914225664)*x[0]+(-0.754003728212)*x[1]**o+(-0.096873749243)*x[1]+(-0.770744141788)*x[2]**o+(0.0291059262795)*x[2]
        s[0,4,1,0]=(0.321738393515)*x[0]**o+(-0.262140344086)*x[0]+(-0.130813570922)*x[1]**o+(0.749305862624)*x[1]+(-0.0933499641013)*x[2]**o+(0.583868661476)*x[2]
        s[0,4,1,1]=(-0.948399949958)*x[0]**o+(-0.514552416108)*x[0]+(0.403700494592)*x[1]**o+(0.319753801921)*x[1]+(0.068451176553)*x[2]**o+(0.236776599218)*x[2]
        s[0,4,2,0]=(-0.206993609035)*x[0]**o+(-0.693436356612)*x[0]+(0.376741069465)*x[1]**o+(-0.377934787271)*x[1]+(0.600888347529)*x[2]**o+(-0.806497559367)*x[2]
        s[0,4,2,1]=(0.519911073798)*x[0]**o+(0.209533160142)*x[0]+(-0.828631380624)*x[1]**o+(-0.758712343322)*x[1]+(0.469217244822)*x[2]**o+(0.777639952133)*x[2]
        s[1,0,0,0]=(-0.00938493494863)*x[0]**o+(0.035357976182)*x[0]+(0.530712339191)*x[1]**o+(0.163841019664)*x[1]+(-0.481052524963)*x[2]**o+(0.165894455618)*x[2]
        s[1,0,0,1]=(0.405172592393)*x[0]**o+(0.748490170154)*x[0]+(-0.579541033967)*x[1]**o+(-0.612353189754)*x[1]+(-0.0878018425036)*x[2]**o+(0.909881661391)*x[2]
        s[1,0,1,0]=(-0.131136361267)*x[0]**o+(0.0576430483263)*x[0]+(0.21369263102)*x[1]**o+(0.00660590703342)*x[1]+(0.079311350103)*x[2]**o+(0.878257991876)*x[2]
        s[1,0,1,1]=(-0.585221206397)*x[0]**o+(-0.791686741073)*x[0]+(0.631923355264)*x[1]**o+(-0.0277720531745)*x[1]+(-0.0777198468194)*x[2]**o+(-0.407162573619)*x[2]
        s[1,0,2,0]=(0.544255664465)*x[0]**o+(-0.51929274141)*x[0]+(-0.614260874796)*x[1]**o+(-0.951824251618)*x[1]+(0.48400676445)*x[2]**o+(-0.210092738748)*x[2]
        s[1,0,2,1]=(-0.901122575086)*x[0]**o+(-0.855042125739)*x[0]+(-0.660979212714)*x[1]**o+(0.874395337943)*x[1]+(-0.286202842553)*x[2]**o+(0.981270297086)*x[2]
        s[1,1,0,0]=(-0.752469757419)*x[0]**o+(0.0583950789171)*x[0]+(-0.699699086971)*x[1]**o+(-0.461650511393)*x[1]+(-0.272665950769)*x[2]**o+(-0.873526828849)*x[2]
        s[1,1,0,1]=(0.219706522447)*x[0]**o+(-0.73250655794)*x[0]+(0.0679566752122)*x[1]**o+(0.731592986993)*x[1]+(0.557341326754)*x[2]**o+(0.256780037036)*x[2]
        s[1,1,1,0]=(-0.820468252627)*x[0]**o+(0.163409736336)*x[0]+(-0.593882214431)*x[1]**o+(0.778760445642)*x[1]+(-0.822051914962)*x[2]**o+(0.920172785813)*x[2]
        s[1,1,1,1]=(-0.355904745872)*x[0]**o+(-0.192775924552)*x[0]+(0.598345031205)*x[1]**o+(-0.108244476269)*x[1]+(-0.895456581435)*x[2]**o+(0.207881298634)*x[2]
        s[1,1,2,0]=(0.781059740818)*x[0]**o+(0.186409854519)*x[0]+(0.92458071805)*x[1]**o+(0.197380801637)*x[1]+(-0.402971455411)*x[2]**o+(0.42922557636)*x[2]
        s[1,1,2,1]=(0.0064822572955)*x[0]**o+(0.846443443074)*x[0]+(0.500688303847)*x[1]**o+(-0.884507156164)*x[1]+(0.433224067545)*x[2]**o+(-0.0383476145137)*x[2]
        s[1,2,0,0]=(-0.945907369747)*x[0]**o+(-0.149404885342)*x[0]+(-0.911317716302)*x[1]**o+(0.718244019047)*x[1]+(0.097223049045)*x[2]**o+(0.95630310286)*x[2]
        s[1,2,0,1]=(-0.942956848602)*x[0]**o+(0.24519384765)*x[0]+(0.450231851653)*x[1]**o+(0.875902538898)*x[1]+(0.552657508084)*x[2]**o+(0.644477914693)*x[2]
        s[1,2,1,0]=(0.600235706495)*x[0]**o+(-0.142524845444)*x[0]+(0.216130207621)*x[1]**o+(-0.396701569264)*x[1]+(0.316884903524)*x[2]**o+(-0.0586626235465)*x[2]
        s[1,2,1,1]=(0.329111957957)*x[0]**o+(-0.508751506135)*x[0]+(0.911087373052)*x[1]**o+(-0.0983342912554)*x[1]+(-0.842070723886)*x[2]**o+(0.0746739548918)*x[2]
        s[1,2,2,0]=(0.387988330934)*x[0]**o+(-0.8408548375)*x[0]+(0.838833668833)*x[1]**o+(0.965224043099)*x[1]+(-0.860139996894)*x[2]**o+(-0.925778998652)*x[2]
        s[1,2,2,1]=(0.238958121236)*x[0]**o+(0.10607561646)*x[0]+(0.302265720665)*x[1]**o+(0.145320472959)*x[1]+(-0.677724287444)*x[2]**o+(-0.666145512045)*x[2]
        s[1,3,0,0]=(0.360431863997)*x[0]**o+(0.509815440438)*x[0]+(-0.178896172032)*x[1]**o+(0.316774928052)*x[1]+(-0.44743491823)*x[2]**o+(-0.651310611493)*x[2]
        s[1,3,0,1]=(-0.65053757716)*x[0]**o+(-0.375438056145)*x[0]+(0.360834001552)*x[1]**o+(-0.250086720496)*x[1]+(-0.71501469699)*x[2]**o+(0.0150228087513)*x[2]
        s[1,3,1,0]=(0.0628062775266)*x[0]**o+(-0.61619322157)*x[0]+(0.45067341985)*x[1]**o+(0.355471837743)*x[1]+(-0.174333549061)*x[2]**o+(-0.942897180184)*x[2]
        s[1,3,1,1]=(0.629724537179)*x[0]**o+(-0.0558311952601)*x[0]+(-0.956862453932)*x[1]**o+(-0.552443418291)*x[1]+(0.146303452118)*x[2]**o+(-0.770969067419)*x[2]
        s[1,3,2,0]=(-0.178686519235)*x[0]**o+(-0.171143660316)*x[0]+(-0.162449341623)*x[1]**o+(-0.1105712214)*x[1]+(0.119821653614)*x[2]**o+(0.209872978827)*x[2]
        s[1,3,2,1]=(0.312724690007)*x[0]**o+(-0.692554198329)*x[0]+(0.502590520541)*x[1]**o+(-0.729216407269)*x[1]+(0.302595866989)*x[2]**o+(-0.815710825541)*x[2]
        s[1,4,0,0]=(0.112006695888)*x[0]**o+(0.829399837819)*x[0]+(-0.419232858393)*x[1]**o+(0.146007406445)*x[1]+(0.304188744047)*x[2]**o+(0.46242131026)*x[2]
        s[1,4,0,1]=(0.964310426412)*x[0]**o+(0.196629594947)*x[0]+(0.124667636162)*x[1]**o+(-0.304792580501)*x[1]+(0.180285405611)*x[2]**o+(-0.543512746454)*x[2]
        s[1,4,1,0]=(-0.708536876552)*x[0]**o+(-0.680163366548)*x[0]+(0.0584969206489)*x[1]**o+(0.847180583253)*x[1]+(0.157570405709)*x[2]**o+(-0.746490964212)*x[2]
        s[1,4,1,1]=(0.0845668429821)*x[0]**o+(-0.889880680014)*x[0]+(-0.0771948903819)*x[1]**o+(-0.533952084212)*x[1]+(0.346150298712)*x[2]**o+(-0.78816093534)*x[2]
        s[1,4,2,0]=(0.375822387867)*x[0]**o+(-0.357919731843)*x[0]+(-0.373519792105)*x[1]**o+(0.641319045383)*x[1]+(0.351324745466)*x[2]**o+(-0.186703738887)*x[2]
        s[1,4,2,1]=(-0.60888359369)*x[0]**o+(0.694522376656)*x[0]+(-0.169823125514)*x[1]**o+(-0.856247555905)*x[1]+(0.00519595740385)*x[2]**o+(-0.875798589653)*x[2]
        s[2,0,0,0]=(0.469380548227)*x[0]**o+(-0.868913385859)*x[0]+(0.441755799104)*x[1]**o+(-0.493212921066)*x[1]+(-0.11743848736)*x[2]**o+(0.21526923935)*x[2]
        s[2,0,0,1]=(-0.151212323369)*x[0]**o+(-0.999958063251)*x[0]+(0.449187517422)*x[1]**o+(-0.583657187784)*x[1]+(-0.905753638698)*x[2]**o+(-0.945179993617)*x[2]
        s[2,0,1,0]=(-0.40460984789)*x[0]**o+(0.510786603887)*x[0]+(-0.953825153871)*x[1]**o+(0.226098717119)*x[1]+(-0.799990467305)*x[2]**o+(-0.429211164318)*x[2]
        s[2,0,1,1]=(0.867644883712)*x[0]**o+(0.714940923764)*x[0]+(-0.122362538438)*x[1]**o+(-0.44142264498)*x[1]+(0.437303901854)*x[2]**o+(0.841319415724)*x[2]
        s[2,0,2,0]=(0.13789233553)*x[0]**o+(0.472191869459)*x[0]+(0.468664678229)*x[1]**o+(-0.584558488838)*x[1]+(0.183146176041)*x[2]**o+(-0.893499132079)*x[2]
        s[2,0,2,1]=(0.875084187567)*x[0]**o+(0.550980479395)*x[0]+(0.312182122865)*x[1]**o+(-0.764545704288)*x[1]+(0.421014399576)*x[2]**o+(-0.652582305594)*x[2]
        s[2,1,0,0]=(-0.397160997842)*x[0]**o+(-0.401717267945)*x[0]+(0.612062897035)*x[1]**o+(0.147514233621)*x[1]+(0.994896686982)*x[2]**o+(-0.650669842592)*x[2]
        s[2,1,0,1]=(0.0859312342607)*x[0]**o+(-0.425173641674)*x[0]+(0.748616439433)*x[1]**o+(0.764026759608)*x[1]+(-0.990504424444)*x[2]**o+(-0.399709104793)*x[2]
        s[2,1,1,0]=(0.732840180154)*x[0]**o+(0.970502200871)*x[0]+(-0.413467445613)*x[1]**o+(-0.246800235561)*x[1]+(-0.881207449946)*x[2]**o+(0.882360789659)*x[2]
        s[2,1,1,1]=(0.689150562511)*x[0]**o+(-0.0933156400969)*x[0]+(-0.0951449636495)*x[1]**o+(0.143121640121)*x[1]+(-0.554471425755)*x[2]**o+(0.683081191337)*x[2]
        s[2,1,2,0]=(0.829863223837)*x[0]**o+(0.216508858271)*x[0]+(0.99016446302)*x[1]**o+(0.319444245585)*x[1]+(0.668648650551)*x[2]**o+(-0.896787700447)*x[2]
        s[2,1,2,1]=(-0.152966345983)*x[0]**o+(-0.775534953656)*x[0]+(0.0774085937181)*x[1]**o+(-0.59686756092)*x[1]+(0.224888875286)*x[2]**o+(-0.770576865174)*x[2]
        s[2,2,0,0]=(-0.831308688707)*x[0]**o+(0.0286055654454)*x[0]+(0.555782586294)*x[1]**o+(-0.863596073174)*x[1]+(0.0660913483948)*x[2]**o+(-0.691221916393)*x[2]
        s[2,2,0,1]=(0.97986500415)*x[0]**o+(-0.687991179162)*x[0]+(0.835947454347)*x[1]**o+(-0.425024918711)*x[1]+(0.632327959013)*x[2]**o+(-0.929603792153)*x[2]
        s[2,2,1,0]=(-0.785177923154)*x[0]**o+(0.498524809242)*x[0]+(0.657015457864)*x[1]**o+(-0.14042512075)*x[1]+(-0.523655529492)*x[2]**o+(0.0676392379718)*x[2]
        s[2,2,1,1]=(-0.282279979706)*x[0]**o+(0.402558983226)*x[0]+(0.349297772011)*x[1]**o+(-0.274102896576)*x[1]+(-0.976904085905)*x[2]**o+(-0.862615408506)*x[2]
        s[2,2,2,0]=(-0.442415692301)*x[0]**o+(-0.490020432017)*x[0]+(0.423330456256)*x[1]**o+(0.0308403124141)*x[1]+(-0.59889279992)*x[2]**o+(-0.784624469809)*x[2]
        s[2,2,2,1]=(-0.0571094173044)*x[0]**o+(-0.685673967597)*x[0]+(0.884019972654)*x[1]**o+(0.076633908669)*x[1]+(-0.436603596414)*x[2]**o+(0.643765166823)*x[2]
        s[2,3,0,0]=(-0.834122691134)*x[0]**o+(-0.316705170482)*x[0]+(0.0232732484874)*x[1]**o+(0.254076347383)*x[1]+(0.510661944881)*x[2]**o+(0.638231760578)*x[2]
        s[2,3,0,1]=(0.130809328027)*x[0]**o+(0.0475045505152)*x[0]+(0.253435146439)*x[1]**o+(0.15750814431)*x[1]+(0.930835277675)*x[2]**o+(0.215956216657)*x[2]
        s[2,3,1,0]=(-0.931893183482)*x[0]**o+(-0.165642362248)*x[0]+(-0.7975167088)*x[1]**o+(0.943743900193)*x[1]+(-0.834729159735)*x[2]**o+(0.310938564524)*x[2]
        s[2,3,1,1]=(-0.952550061226)*x[0]**o+(0.824399352189)*x[0]+(0.931907966548)*x[1]**o+(-0.46156960063)*x[1]+(0.6225788167)*x[2]**o+(-0.989192673067)*x[2]
        s[2,3,2,0]=(0.756326608673)*x[0]**o+(0.771528948716)*x[0]+(0.239160366604)*x[1]**o+(-0.452631969831)*x[1]+(-0.237358134546)*x[2]**o+(-0.839427184027)*x[2]
        s[2,3,2,1]=(0.0238504992639)*x[0]**o+(-0.103939311831)*x[0]+(0.291372616066)*x[1]**o+(0.672484596501)*x[1]+(0.494387122319)*x[2]**o+(0.486078041674)*x[2]
        s[2,4,0,0]=(-0.856552973776)*x[0]**o+(0.220667747539)*x[0]+(-0.901887042412)*x[1]**o+(0.162974138385)*x[1]+(0.884973432866)*x[2]**o+(-0.843375672742)*x[2]
        s[2,4,0,1]=(-0.581001018196)*x[0]**o+(0.766670058764)*x[0]+(0.195299626813)*x[1]**o+(0.491689692116)*x[1]+(-0.0851700136621)*x[2]**o+(0.556688214561)*x[2]
        s[2,4,1,0]=(0.341242000274)*x[0]**o+(0.254872207602)*x[0]+(0.721651164807)*x[1]**o+(0.817267858784)*x[1]+(0.525309787334)*x[2]**o+(-0.189345432506)*x[2]
        s[2,4,1,1]=(-0.461247890207)*x[0]**o+(-0.295916833174)*x[0]+(-0.795114931826)*x[1]**o+(0.760634909709)*x[1]+(0.628604868176)*x[2]**o+(-0.91582350733)*x[2]
        s[2,4,2,0]=(0.388037825656)*x[0]**o+(0.667391082754)*x[0]+(-0.76856572381)*x[1]**o+(-0.684287348308)*x[1]+(0.0434449534518)*x[2]**o+(-0.627587380339)*x[2]
        s[2,4,2,1]=(0.493746914184)*x[0]**o+(-0.47088277759)*x[0]+(-0.64457015181)*x[1]**o+(0.710566646648)*x[1]+(-0.603534864394)*x[2]**o+(0.952591999625)*x[2]
        s[3,0,0,0]=(-0.964941424537)*x[0]**o+(-0.701861794912)*x[0]+(0.631389613785)*x[1]**o+(0.216075041942)*x[1]+(-0.325257371696)*x[2]**o+(-0.291703451654)*x[2]
        s[3,0,0,1]=(-0.96299134603)*x[0]**o+(0.625796224057)*x[0]+(-0.418463355374)*x[1]**o+(-0.256336497204)*x[1]+(0.712728188959)*x[2]**o+(-0.770370932567)*x[2]
        s[3,0,1,0]=(-0.292515423665)*x[0]**o+(0.686334822809)*x[0]+(0.0305376943649)*x[1]**o+(0.872668037223)*x[1]+(-0.0541424770809)*x[2]**o+(-0.572416266221)*x[2]
        s[3,0,1,1]=(-0.690323374741)*x[0]**o+(-0.671336462076)*x[0]+(-0.166196941189)*x[1]**o+(-0.384967652901)*x[1]+(-0.61068991009)*x[2]**o+(0.776653422289)*x[2]
        s[3,0,2,0]=(-0.944428014582)*x[0]**o+(-0.301748262202)*x[0]+(-0.686840009057)*x[1]**o+(0.712060295627)*x[1]+(-0.254326623988)*x[2]**o+(0.400337107846)*x[2]
        s[3,0,2,1]=(-0.290963532129)*x[0]**o+(0.0269234770835)*x[0]+(-0.950364000347)*x[1]**o+(-0.460706646264)*x[1]+(-0.198333139868)*x[2]**o+(0.629854716945)*x[2]
        s[3,1,0,0]=(-0.555184083664)*x[0]**o+(0.131468013243)*x[0]+(0.282129000779)*x[1]**o+(-0.198577931709)*x[1]+(-0.175106810125)*x[2]**o+(0.00542537950498)*x[2]
        s[3,1,0,1]=(-0.284255526343)*x[0]**o+(-0.841249154497)*x[0]+(0.0213305454566)*x[1]**o+(-0.357636696086)*x[1]+(0.20888768221)*x[2]**o+(-0.503785042238)*x[2]
        s[3,1,1,0]=(-0.330999455854)*x[0]**o+(-0.159160032544)*x[0]+(0.52907127808)*x[1]**o+(0.0550513576484)*x[1]+(0.511074173459)*x[2]**o+(0.0159456796202)*x[2]
        s[3,1,1,1]=(-0.79143588969)*x[0]**o+(0.971248239785)*x[0]+(-0.0345752805688)*x[1]**o+(-0.0153770141636)*x[1]+(-0.716027682667)*x[2]**o+(-0.524455141515)*x[2]
        s[3,1,2,0]=(-0.582525406979)*x[0]**o+(0.397353443964)*x[0]+(-0.519936987381)*x[1]**o+(-0.21693645368)*x[1]+(0.869686334938)*x[2]**o+(-0.151814599828)*x[2]
        s[3,1,2,1]=(0.868456250139)*x[0]**o+(-0.568324799548)*x[0]+(-0.00346073709208)*x[1]**o+(-0.943912775939)*x[1]+(0.561497263651)*x[2]**o+(-0.923788209036)*x[2]
        s[3,2,0,0]=(-0.797982975817)*x[0]**o+(0.947494036065)*x[0]+(-0.250051189868)*x[1]**o+(0.472713798841)*x[1]+(0.902863101354)*x[2]**o+(0.613145652065)*x[2]
        s[3,2,0,1]=(0.252252158112)*x[0]**o+(0.301818562132)*x[0]+(0.664012773607)*x[1]**o+(0.0296698446724)*x[1]+(-0.00729763735658)*x[2]**o+(0.557599604788)*x[2]
        s[3,2,1,0]=(0.0570129540722)*x[0]**o+(-0.453241439283)*x[0]+(-0.71043548568)*x[1]**o+(-0.138422568238)*x[1]+(-0.611853026036)*x[2]**o+(0.253347515085)*x[2]
        s[3,2,1,1]=(-0.66828746218)*x[0]**o+(-0.751232642462)*x[0]+(-0.390775113865)*x[1]**o+(0.995150799921)*x[1]+(-0.292932619723)*x[2]**o+(-0.600225027769)*x[2]
        s[3,2,2,0]=(0.065423903522)*x[0]**o+(0.384335040067)*x[0]+(0.19683258538)*x[1]**o+(0.267437363607)*x[1]+(0.0294176448501)*x[2]**o+(0.155211007088)*x[2]
        s[3,2,2,1]=(-0.851636568209)*x[0]**o+(-0.761490675173)*x[0]+(-0.729643742868)*x[1]**o+(0.478780948031)*x[1]+(-0.036088351558)*x[2]**o+(0.823507165674)*x[2]
        s[3,3,0,0]=(0.482377341472)*x[0]**o+(0.139556800754)*x[0]+(-0.0112720934043)*x[1]**o+(0.298852046645)*x[1]+(0.145554009271)*x[2]**o+(-0.859974982251)*x[2]
        s[3,3,0,1]=(-0.137104991135)*x[0]**o+(-0.857876623449)*x[0]+(0.258417639346)*x[1]**o+(-0.389256714236)*x[1]+(-0.936199013774)*x[2]**o+(-0.312698752628)*x[2]
        s[3,3,1,0]=(-0.488668823485)*x[0]**o+(-0.771705852614)*x[0]+(-0.450034458754)*x[1]**o+(0.632396692772)*x[1]+(-0.105848719123)*x[2]**o+(0.358481590951)*x[2]
        s[3,3,1,1]=(-0.559261115256)*x[0]**o+(0.770050098012)*x[0]+(-0.125673261546)*x[1]**o+(0.863587697472)*x[1]+(0.94178472327)*x[2]**o+(0.691350347846)*x[2]
        s[3,3,2,0]=(0.348276322002)*x[0]**o+(-0.367507421115)*x[0]+(0.171562046637)*x[1]**o+(-0.98530139967)*x[1]+(-0.374019522945)*x[2]**o+(-0.0772490996658)*x[2]
        s[3,3,2,1]=(-0.91862240772)*x[0]**o+(-0.771336713978)*x[0]+(-0.510735333043)*x[1]**o+(-0.793667481925)*x[1]+(0.793023981359)*x[2]**o+(-0.211127108731)*x[2]
        s[3,4,0,0]=(-0.439892942063)*x[0]**o+(-0.452356550969)*x[0]+(0.255344783422)*x[1]**o+(0.966971078667)*x[1]+(0.770960867316)*x[2]**o+(-0.877647551728)*x[2]
        s[3,4,0,1]=(0.926860716799)*x[0]**o+(-0.325430377076)*x[0]+(0.593914577372)*x[1]**o+(-0.237069180519)*x[1]+(0.0779887304243)*x[2]**o+(0.0757684397401)*x[2]
        s[3,4,1,0]=(-0.865144446511)*x[0]**o+(0.220573510075)*x[0]+(0.574182016443)*x[1]**o+(0.585433407304)*x[1]+(-0.304138910485)*x[2]**o+(-0.26316229504)*x[2]
        s[3,4,1,1]=(-0.0941252376404)*x[0]**o+(-0.441659917216)*x[0]+(0.833947587523)*x[1]**o+(0.226992443402)*x[1]+(0.902425846073)*x[2]**o+(-0.525442142595)*x[2]
        s[3,4,2,0]=(0.782184984647)*x[0]**o+(0.0260219673241)*x[0]+(0.664501465465)*x[1]**o+(-0.571404130587)*x[1]+(0.419283611654)*x[2]**o+(-0.419135271863)*x[2]
        s[3,4,2,1]=(-0.944783897524)*x[0]**o+(-0.173931506017)*x[0]+(-0.0465484376595)*x[1]**o+(0.718604875734)*x[1]+(-0.388606992705)*x[2]**o+(-0.450843297215)*x[2]
        ref[0,0,0,0]=(0.934771837454)/(o+1.)+(-0.434823412793)
        ref[0,0,0,1]=(1.28803242766)/(o+1.)+(-0.0290220842909)
        ref[0,0,1,0]=(-2.40244763121)/(o+1.)+(-0.306269462104)
        ref[0,0,1,1]=(-1.62188544724)/(o+1.)+(0.0251869143786)
        ref[0,0,2,0]=(0.698356878524)/(o+1.)+(-0.435866994151)
        ref[0,0,2,1]=(0.0875965875576)/(o+1.)+(0.655921182948)
        ref[0,1,0,0]=(0.0458359064556)/(o+1.)+(0.200816326568)
        ref[0,1,0,1]=(-0.557948616036)/(o+1.)+(-0.331764866336)
        ref[0,1,1,0]=(-1.37792398905)/(o+1.)+(-0.831943000542)
        ref[0,1,1,1]=(-1.05744784285)/(o+1.)+(-0.363990638493)
        ref[0,1,2,0]=(1.8785239999)/(o+1.)+(0.132914775729)
        ref[0,1,2,1]=(-0.491737663947)/(o+1.)+(-0.262264208574)
        ref[0,2,0,0]=(0.981768624328)/(o+1.)+(-0.528154847194)
        ref[0,2,0,1]=(-0.924041283835)/(o+1.)+(-0.0118456080214)
        ref[0,2,1,0]=(1.02602669138)/(o+1.)+(0.991571987955)
        ref[0,2,1,1]=(0.293350581922)/(o+1.)+(-1.26454746919)
        ref[0,2,2,0]=(1.20547396122)/(o+1.)+(0.33128271182)
        ref[0,2,2,1]=(-0.633265442539)/(o+1.)+(0.576446315531)
        ref[0,3,0,0]=(-0.107677324633)/(o+1.)+(0.0153782031713)
        ref[0,3,0,1]=(-0.058445812213)/(o+1.)+(0.454914614557)
        ref[0,3,1,0]=(-0.630456060199)/(o+1.)+(-0.155638329723)
        ref[0,3,1,1]=(1.19340007429)/(o+1.)+(-0.605390734274)
        ref[0,3,2,0]=(0.207048325661)/(o+1.)+(0.396354470118)
        ref[0,3,2,1]=(-0.124698590323)/(o+1.)+(-0.533691881821)
        ref[0,4,0,0]=(-0.00894177493875)/(o+1.)+(-0.271916856357)
        ref[0,4,0,1]=(-1.32890925126)/(o+1.)+(-0.0898410243139)
        ref[0,4,1,0]=(0.0975748584924)/(o+1.)+(0.535517090007)
        ref[0,4,1,1]=(-0.476248278814)/(o+1.)+(0.0209889925155)
        ref[0,4,2,0]=(0.770635807959)/(o+1.)+(-0.938934351625)
        ref[0,4,2,1]=(0.160496937995)/(o+1.)+(0.114230384477)
        ref[1,0,0,0]=(0.0402748792799)/(o+1.)+(0.182546725732)
        ref[1,0,0,1]=(-0.262170284078)/(o+1.)+(0.523009320895)
        ref[1,0,1,0]=(0.161867619856)/(o+1.)+(0.471253473618)
        ref[1,0,1,1]=(-0.0310176979524)/(o+1.)+(-0.613310683933)
        ref[1,0,2,0]=(0.414001554119)/(o+1.)+(-0.840604865888)
        ref[1,0,2,1]=(-1.84830463035)/(o+1.)+(0.500311754645)
        ref[1,1,0,0]=(-1.72483479516)/(o+1.)+(-0.638391130662)
        ref[1,1,0,1]=(0.845004524414)/(o+1.)+(0.127933233045)
        ref[1,1,1,0]=(-2.23640238202)/(o+1.)+(0.931171483895)
        ref[1,1,1,1]=(-0.653016296101)/(o+1.)+(-0.0465695510937)
        ref[1,1,2,0]=(1.30266900346)/(o+1.)+(0.406508116258)
        ref[1,1,2,1]=(0.940394628687)/(o+1.)+(-0.0382056638017)
        ref[1,2,0,0]=(-1.760002037)/(o+1.)+(0.762571118282)
        ref[1,2,0,1]=(0.0599325111348)/(o+1.)+(0.88278715062)
        ref[1,2,1,0]=(1.13325081764)/(o+1.)+(-0.298944519128)
        ref[1,2,1,1]=(0.398128607122)/(o+1.)+(-0.266205921249)
        ref[1,2,2,0]=(0.366682002873)/(o+1.)+(-0.400704896527)
        ref[1,2,2,1]=(-0.136500445542)/(o+1.)+(-0.207374711313)
        ref[1,3,0,0]=(-0.265899226265)/(o+1.)+(0.0876398784989)
        ref[1,3,0,1]=(-1.0047182726)/(o+1.)+(-0.305250983945)
        ref[1,3,1,0]=(0.339146148316)/(o+1.)+(-0.601809282005)
        ref[1,3,1,1]=(-0.180834464635)/(o+1.)+(-0.689621840485)
        ref[1,3,2,0]=(-0.221314207244)/(o+1.)+(-0.0359209514441)
        ref[1,3,2,1]=(1.11791107754)/(o+1.)+(-1.11874071557)
        ref[1,4,0,0]=(-0.00303741845779)/(o+1.)+(0.718914277262)
        ref[1,4,0,1]=(1.26926346819)/(o+1.)+(-0.325837866004)
        ref[1,4,1,0]=(-0.492469550194)/(o+1.)+(-0.289736873753)
        ref[1,4,1,1]=(0.353522251312)/(o+1.)+(-1.10599684978)
        ref[1,4,2,0]=(0.353627341229)/(o+1.)+(0.0483477873267)
        ref[1,4,2,1]=(-0.7735107618)/(o+1.)+(-0.518761884451)
        ref[2,0,0,0]=(0.793697859971)/(o+1.)+(-0.573428533787)
        ref[2,0,0,1]=(-0.607778444644)/(o+1.)+(-1.26439762233)
        ref[2,0,1,0]=(-2.15842546907)/(o+1.)+(0.153837078344)
        ref[2,0,1,1]=(1.18258624713)/(o+1.)+(0.557418847254)
        ref[2,0,2,0]=(0.7897031898)/(o+1.)+(-0.502932875729)
        ref[2,0,2,1]=(1.60828071001)/(o+1.)+(-0.433073765244)
        ref[2,1,0,0]=(1.20979858617)/(o+1.)+(-0.452436438458)
        ref[2,1,0,1]=(-0.15595675075)/(o+1.)+(-0.0304279934298)
        ref[2,1,1,0]=(-0.561834715406)/(o+1.)+(0.803031377485)
        ref[2,1,1,1]=(0.0395341731061)/(o+1.)+(0.366443595681)
        ref[2,1,2,0]=(2.48867633741)/(o+1.)+(-0.180417298296)
        ref[2,1,2,1]=(0.149331123022)/(o+1.)+(-1.07148968987)
        ref[2,2,0,0]=(-0.209434754019)/(o+1.)+(-0.763106212061)
        ref[2,2,0,1]=(2.44814041751)/(o+1.)+(-1.02130994501)
        ref[2,2,1,0]=(-0.651817994783)/(o+1.)+(0.212869463232)
        ref[2,2,1,1]=(-0.9098862936)/(o+1.)+(-0.367079660928)
        ref[2,2,2,0]=(-0.617978035965)/(o+1.)+(-0.621902294706)
        ref[2,2,2,1]=(0.390306958936)/(o+1.)+(0.0173625539477)
        ref[2,3,0,0]=(-0.300187497765)/(o+1.)+(0.28780146874)
        ref[2,3,0,1]=(1.31507975214)/(o+1.)+(0.210484455741)
        ref[2,3,1,0]=(-2.56413905202)/(o+1.)+(0.544520051234)
        ref[2,3,1,1]=(0.601936722022)/(o+1.)+(-0.313181460754)
        ref[2,3,2,0]=(0.758128840732)/(o+1.)+(-0.260265102571)
        ref[2,3,2,1]=(0.809610237649)/(o+1.)+(0.527311663172)
        ref[2,4,0,0]=(-0.873466583322)/(o+1.)+(-0.229866893409)
        ref[2,4,0,1]=(-0.470871405045)/(o+1.)+(0.907523982721)
        ref[2,4,1,0]=(1.58820295242)/(o+1.)+(0.44139731694)
        ref[2,4,1,1]=(-0.627757953856)/(o+1.)+(-0.225552715397)
        ref[2,4,2,0]=(-0.337082944702)/(o+1.)+(-0.322241822947)
        ref[2,4,2,1]=(-0.75435810202)/(o+1.)+(0.596137934342)
        ref[3,0,0,0]=(-0.658809182448)/(o+1.)+(-0.388745102312)
        ref[3,0,0,1]=(-0.668726512445)/(o+1.)+(-0.200455602857)
        ref[3,0,1,0]=(-0.316120206381)/(o+1.)+(0.493293296905)
        ref[3,0,1,1]=(-1.46721022602)/(o+1.)+(-0.139825346344)
        ref[3,0,2,0]=(-1.88559464763)/(o+1.)+(0.405324570636)
        ref[3,0,2,1]=(-1.43966067234)/(o+1.)+(0.0980357738822)
        ref[3,1,0,0]=(-0.448161893009)/(o+1.)+(-0.0308422694803)
        ref[3,1,0,1]=(-0.0540372986773)/(o+1.)+(-0.851335446411)
        ref[3,1,1,0]=(0.709145995686)/(o+1.)+(-0.0440814976379)
        ref[3,1,1,1]=(-1.54203885293)/(o+1.)+(0.215708042053)
        ref[3,1,2,0]=(-0.232776059422)/(o+1.)+(0.0143011952278)
        ref[3,1,2,1]=(1.4264927767)/(o+1.)+(-1.21801289226)
        ref[3,2,0,0]=(-0.145171064331)/(o+1.)+(1.01667674349)
        ref[3,2,0,1]=(0.908967294363)/(o+1.)+(0.444544005797)
        ref[3,2,1,0]=(-1.26527555764)/(o+1.)+(-0.169158246218)
        ref[3,2,1,1]=(-1.35199519577)/(o+1.)+(-0.178153435155)
        ref[3,2,2,0]=(0.291674133752)/(o+1.)+(0.403491705381)
        ref[3,2,2,1]=(-1.61736866264)/(o+1.)+(0.270398719266)
        ref[3,3,0,0]=(0.616659257339)/(o+1.)+(-0.210783067426)
        ref[3,3,0,1]=(-0.814886365562)/(o+1.)+(-0.779916045157)
        ref[3,3,1,0]=(-1.04455200136)/(o+1.)+(0.109586215554)
        ref[3,3,1,1]=(0.256850346468)/(o+1.)+(1.16249407166)
        ref[3,3,2,0]=(0.145818845694)/(o+1.)+(-0.715028960225)
        ref[3,3,2,1]=(-0.636333759404)/(o+1.)+(-0.888065652317)
        ref[3,4,0,0]=(0.586412708675)/(o+1.)+(-0.181516512015)
        ref[3,4,0,1]=(1.5987640246)/(o+1.)+(-0.243365558927)
        ref[3,4,1,0]=(-0.595101340552)/(o+1.)+(0.271422311169)
        ref[3,4,1,1]=(1.64224819596)/(o+1.)+(-0.370054808205)
        ref[3,4,2,0]=(1.86597006177)/(o+1.)+(-0.482258717563)
        ref[3,4,2,1]=(-1.37993932789)/(o+1.)+(0.0469150362512)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.518496555195)*x[0]+(-1.7081835316)*x[1]
        ref=(-0.587946015314)/(o+1.)+(-0.300870480545)
      else:
        s=(0.271043713323)*x[0]+(-1.57101724485)*x[1]+(-0.650553623396)*x[2]
        ref=(-1.53180577827)/(o+1.)+(-0.209360688325)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.228569380378)*x[0]+(0.808739010281)*x[1]
        s[1]=(0.658420467565)*x[0]+(0.755018594164)*x[1]
        ref[0]=(0.635537444802)/(o+1.)+(-0.0276839074492)
        ref[1]=(0.431019006365)/(o+1.)+(0.491210027682)
      else:
        s[0]=(0.376210963228)*x[0]+(-1.32850082986)*x[1]+(0.536274160408)*x[2]
        s[1]=(-0.771050457843)*x[0]+(-0.16954629666)*x[1]+(-0.579642261351)*x[2]
        ref[0]=(-0.923045104748)/(o+1.)+(0.253514699262)
        ref[1]=(0.10262370672)/(o+1.)+(-0.811431361287)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(-0.405824989536)*x[0]+(-1.36105849061)*x[1]
        s[0,1]=(0.759504921251)*x[0]+(0.455515132277)*x[1]
        s[0,2]=(-1.37469026888)*x[0]+(1.35869839203)*x[1]
        s[0,3]=(-0.0438580623198)*x[0]+(0.34881551198)*x[1]
        s[0,4]=(-0.0097850380672)*x[0]+(0.61199301527)*x[1]
        s[1,0]=(-1.24950855151)*x[0]+(0.560604227152)*x[1]
        s[1,1]=(0.897125563557)*x[0]+(-0.362799426566)*x[1]
        s[1,2]=(-0.475265733496)*x[0]+(-0.906032283495)*x[1]
        s[1,3]=(0.184749910708)*x[0]+(0.961807058286)*x[1]
        s[1,4]=(-1.8130820241)*x[0]+(-0.0716801569248)*x[1]
        s[2,0]=(0.401163196364)*x[0]+(-0.122822662117)*x[1]
        s[2,1]=(-0.183141841931)*x[0]+(0.159646202564)*x[1]
        s[2,2]=(0.494070531254)*x[0]+(0.0283267498222)*x[1]
        s[2,3]=(-0.46326385119)*x[0]+(0.416856391877)*x[1]
        s[2,4]=(0.669972632028)*x[0]+(1.01207764348)*x[1]
        s[3,0]=(0.579509485187)*x[0]+(0.578664253542)*x[1]
        s[3,1]=(1.1904242989)*x[0]+(-0.617672917808)*x[1]
        s[3,2]=(1.01069090914)*x[0]+(-0.132861271259)*x[1]
        s[3,3]=(-1.02014113453)*x[0]+(-1.10411835631)*x[1]
        s[3,4]=(-0.178208550651)*x[0]+(-0.590646644191)*x[1]
        ref[0,0]=(-1.81750521429)/(o+1.)+(0.0253108670731)
        ref[0,1]=(1.13215741955)/(o+1.)+(0.0414313169864)
        ref[0,2]=(-0.346109803394)/(o+1.)+(0.165058963273)
        ref[0,3]=(1.16722378378)/(o+1.)+(-0.431133167061)
        ref[0,4]=(1.39150379152)/(o+1.)+(-0.39464790716)
        ref[1,0]=(-0.249819369301)/(o+1.)+(-0.219542477529)
        ref[1,1]=(-0.253832127476)/(o+1.)+(0.394079132234)
        ref[1,2]=(-0.514583575657)/(o+1.)+(-0.433357220667)
        ref[1,3]=(1.16430206364)/(o+1.)+(-0.00887254732364)
        ref[1,4]=(-1.40353822359)/(o+1.)+(-0.240611978717)
        ref[2,0]=(0.0129701699159)/(o+1.)+(0.132685182166)
        ref[2,1]=(-0.000259682696025)/(o+1.)+(-0.0116179783357)
        ref[2,2]=(-0.736785877312)/(o+1.)+(0.629591579194)
        ref[2,3]=(-0.319819594662)/(o+1.)+(0.136706067675)
        ref[2,4]=(1.34735651213)/(o+1.)+(0.167346881689)
        ref[3,0]=(1.02891998838)/(o+1.)+(0.0646268751734)
        ref[3,1]=(0.0226437097602)/(o+1.)+(0.275053835665)
        ref[3,2]=(-0.367947454589)/(o+1.)+(0.622888546236)
        ref[3,3]=(-1.07416112237)/(o+1.)+(-0.525049184236)
        ref[3,4]=(-0.423224656448)/(o+1.)+(-0.172815269197)
      else:
        s[0,0]=(0.391957465543)*x[0]+(-0.836212796005)*x[1]+(0.541170293661)*x[2]
        s[0,1]=(-0.324966494738)*x[0]+(0.62718596172)*x[1]+(-0.00110999366491)*x[2]
        s[0,2]=(0.377719216476)*x[0]+(1.20630293683)*x[1]+(-0.936497207115)*x[2]
        s[0,3]=(-1.52853135673)*x[0]+(-0.634683048191)*x[1]+(-0.533312108123)*x[2]
        s[0,4]=(-0.659359670617)*x[0]+(-1.23995360412)*x[1]+(0.669989279254)*x[2]
        s[1,0]=(-0.45120395504)*x[0]+(1.25119902426)*x[1]+(0.11139465291)*x[2]
        s[1,1]=(0.431699115955)*x[0]+(1.165662618)*x[1]+(-1.12543997002)*x[2]
        s[1,2]=(0.16640215316)*x[0]+(-1.81838137531)*x[1]+(-0.111705546449)*x[2]
        s[1,3]=(-1.56135929502)*x[0]+(0.425946749357)*x[1]+(0.255013889109)*x[2]
        s[1,4]=(0.320981318781)*x[0]+(-0.536492696361)*x[1]+(1.21768285382)*x[2]
        s[2,0]=(-0.600249234632)*x[0]+(-0.497626140165)*x[1]+(-0.0606420495108)*x[2]
        s[2,1]=(-0.144412727094)*x[0]+(-1.09139116844)*x[1]+(-0.39344520166)*x[2]
        s[2,2]=(-0.433006957898)*x[0]+(-0.287282800253)*x[1]+(8.69987670264e-05)*x[2]
        s[2,3]=(0.805491532167)*x[0]+(-1.17746983966)*x[1]+(0.720861745039)*x[2]
        s[2,4]=(-0.735630820744)*x[0]+(-1.01122803474)*x[1]+(1.72681276559)*x[2]
        s[3,0]=(-0.739861204924)*x[0]+(0.739077496919)*x[1]+(-0.0950784436747)*x[2]
        s[3,1]=(0.428369405071)*x[0]+(-0.0613035842349)*x[1]+(1.22804321951)*x[2]
        s[3,2]=(0.617885252444)*x[0]+(-1.63428007618)*x[1]+(-0.543704110813)*x[2]
        s[3,3]=(-1.52397266949)*x[0]+(-1.33821038473)*x[1]+(0.578214428096)*x[2]
        s[3,4]=(-0.904835367377)*x[0]+(0.156039380736)*x[1]+(-0.833632978592)*x[2]
        ref[0,0]=(-0.865179337718)/(o+1.)+(0.481047150458)
        ref[0,1]=(-0.427981609749)/(o+1.)+(0.364545541533)
        ref[0,2]=(0.738756225478)/(o+1.)+(-0.0456156396413)
        ref[0,3]=(-2.19753999815)/(o+1.)+(-0.249493257444)
        ref[0,4]=(-1.44493155356)/(o+1.)+(0.107803779038)
        ref[1,0]=(1.72841073711)/(o+1.)+(-0.408510507493)
        ref[1,1]=(0.688403407203)/(o+1.)+(-0.108240821633)
        ref[1,2]=(-0.0562832360974)/(o+1.)+(-0.853700766251)
        ref[1,3]=(-0.866037983384)/(o+1.)+(-0.00718033658349)
        ref[1,4]=(1.27849436197)/(o+1.)+(-0.138161442865)
        ref[2,0]=(-0.450814686687)/(o+1.)+(-0.353851368811)
        ref[2,1]=(-0.608210959793)/(o+1.)+(-0.510519068702)
        ref[2,2]=(-1.55008808776)/(o+1.)+(0.414942664188)
        ref[2,3]=(0.242744047944)/(o+1.)+(0.0530696948023)
        ref[2,4]=(-0.793195276992)/(o+1.)+(0.386574593552)
        ref[3,0]=(-0.33646344984)/(o+1.)+(0.12030064908)
        ref[3,1]=(1.37599194013)/(o+1.)+(0.109558550106)
        ref[3,2]=(0.0175612882637)/(o+1.)+(-0.788830111409)
        ref[3,3]=(-0.747828767237)/(o+1.)+(-0.768069929445)
        ref[3,4]=(-0.876520699909)/(o+1.)+(-0.352954132662)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.64806859919)*x[0]+(0.669871100749)*x[1]
        s[0,0,1]=(0.351912095781)*x[0]+(-0.795221209702)*x[1]
        s[0,1,0]=(1.67848694486)*x[0]+(0.294895162463)*x[1]
        s[0,1,1]=(0.360904647807)*x[0]+(1.08975889449)*x[1]
        s[1,0,0]=(-0.0924096394032)*x[0]+(-1.45324202762)*x[1]
        s[1,0,1]=(-0.160994756309)*x[0]+(0.551455091958)*x[1]
        s[1,1,0]=(1.32478072001)*x[0]+(-1.43998718605)*x[1]
        s[1,1,1]=(0.481907947963)*x[0]+(-1.62005808161)*x[1]
        s[2,0,0]=(1.28445085089)*x[0]+(0.139212942532)*x[1]
        s[2,0,1]=(0.13496510335)*x[0]+(-0.3090345869)*x[1]
        s[2,1,0]=(1.34702478342)*x[0]+(0.77762332551)*x[1]
        s[2,1,1]=(0.2270682866)*x[0]+(0.585652373115)*x[1]
        s[3,0,0]=(0.974462828497)*x[0]+(-0.0761666893839)*x[1]
        s[3,0,1]=(0.787654033315)*x[0]+(-0.665952609368)*x[1]
        s[3,1,0]=(-0.535337193665)*x[0]+(-0.10003612917)*x[1]
        s[3,1,1]=(0.90669722873)*x[0]+(0.0637346383222)*x[1]
        s[4,0,0]=(0.224906594767)*x[0]+(0.255067891624)*x[1]
        s[4,0,1]=(1.45652552317)*x[0]+(-0.896697311539)*x[1]
        s[4,1,0]=(0.0111655859631)*x[0]+(1.35361034898)*x[1]
        s[4,1,1]=(-1.49696987574)*x[0]+(-0.0630120006374)*x[1]
        s[5,0,0]=(-1.37528487034)*x[0]+(-1.03082532988)*x[1]
        s[5,0,1]=(0.298794708742)*x[0]+(-0.338420113242)*x[1]
        s[5,1,0]=(0.101365713196)*x[0]+(0.46239070902)*x[1]
        s[5,1,1]=(-0.329260078889)*x[0]+(0.0114285623122)*x[1]
        ref[0,0,0]=(1.04954961047)/(o+1.)+(0.134195044736)
        ref[0,0,1]=(-0.941346926582)/(o+1.)+(0.24901890633)
        ref[0,1,0]=(0.33540890863)/(o+1.)+(0.818986599345)
        ref[0,1,1]=(-0.0452512610385)/(o+1.)+(0.747957401666)
        ref[1,0,0]=(-0.0571552186929)/(o+1.)+(-0.744248224165)
        ref[1,0,1]=(-0.256660001756)/(o+1.)+(0.323560168702)
        ref[1,1,0]=(0.173031418514)/(o+1.)+(-0.144118942277)
        ref[1,1,1]=(-1.27331535296)/(o+1.)+(0.0675826096564)
        ref[2,0,0]=(1.27442931542)/(o+1.)+(0.0746172389969)
        ref[2,0,1]=(1.23134060492)/(o+1.)+(-0.702705044233)
        ref[2,1,0]=(1.44361222924)/(o+1.)+(0.340517939842)
        ref[2,1,1]=(0.858404770157)/(o+1.)+(-0.0228420552212)
        ref[3,0,0]=(0.53268376719)/(o+1.)+(0.182806185962)
        ref[3,0,1]=(0.962024080252)/(o+1.)+(-0.420161328153)
        ref[3,1,0]=(-1.06376900656)/(o+1.)+(0.214197841863)
        ref[3,1,1]=(0.437728927482)/(o+1.)+(0.266351469785)
        ref[4,0,0]=(-0.247848566495)/(o+1.)+(0.363911526443)
        ref[4,0,1]=(0.275565249528)/(o+1.)+(0.142131481049)
        ref[4,1,0]=(0.8446292547)/(o+1.)+(0.260073340122)
        ref[4,1,1]=(-1.92408551747)/(o+1.)+(0.182051820549)
        ref[5,0,0]=(-1.70867649172)/(o+1.)+(-0.348716854247)
        ref[5,0,1]=(-0.216851661682)/(o+1.)+(0.088613128591)
        ref[5,1,0]=(1.89734425595)/(o+1.)+(-0.666793916865)
        ref[5,1,1]=(-0.281093101446)/(o+1.)+(-0.0183692075654)
      else:
        s[0,0,0]=(0.142896594259)*x[0]+(-0.458264763854)*x[1]+(0.521893125785)*x[2]
        s[0,0,1]=(-0.141846975275)*x[0]+(-0.976845409768)*x[1]+(-1.14147520898)*x[2]
        s[0,1,0]=(0.141747271548)*x[0]+(-1.21811158828)*x[1]+(0.0640715930615)*x[2]
        s[0,1,1]=(0.462551385436)*x[0]+(-0.87929813895)*x[1]+(0.944848279649)*x[2]
        s[1,0,0]=(0.246197516828)*x[0]+(-0.0275751890238)*x[1]+(0.278318853806)*x[2]
        s[1,0,1]=(0.525663042785)*x[0]+(0.191011208259)*x[1]+(-1.27931005652)*x[2]
        s[1,1,0]=(-1.12276137904)*x[0]+(0.474659469962)*x[1]+(0.15450537857)*x[2]
        s[1,1,1]=(0.321959890457)*x[0]+(-0.0325903104321)*x[1]+(-0.735505871467)*x[2]
        s[2,0,0]=(-0.190194685931)*x[0]+(-0.277506154989)*x[1]+(0.0984734800625)*x[2]
        s[2,0,1]=(0.286493694398)*x[0]+(0.841559451892)*x[1]+(0.20572294365)*x[2]
        s[2,1,0]=(-0.0132570386632)*x[0]+(-0.160857995452)*x[1]+(-0.813758770212)*x[2]
        s[2,1,1]=(0.00519333657271)*x[0]+(0.0324836424574)*x[1]+(0.493299621992)*x[2]
        s[3,0,0]=(0.300624746821)*x[0]+(0.211207146953)*x[1]+(1.0860831317)*x[2]
        s[3,0,1]=(-0.696336553938)*x[0]+(-1.28551896118)*x[1]+(0.738769481443)*x[2]
        s[3,1,0]=(0.15510282832)*x[0]+(-1.15795290548)*x[1]+(0.543235378485)*x[2]
        s[3,1,1]=(-0.714308237763)*x[0]+(0.239072001232)*x[1]+(-0.187168055861)*x[2]
        s[4,0,0]=(0.624611061079)*x[0]+(1.11568209096)*x[1]+(-1.46683771155)*x[2]
        s[4,0,1]=(1.45301860552)*x[0]+(0.74921646591)*x[1]+(-0.796630526412)*x[2]
        s[4,1,0]=(0.560555339207)*x[0]+(-0.421267308186)*x[1]+(-0.222312671328)*x[2]
        s[4,1,1]=(0.807845684562)*x[0]+(0.323266951017)*x[1]+(1.51940950039)*x[2]
        s[5,0,0]=(-0.558067921385)*x[0]+(-0.214928793546)*x[1]+(1.01402046886)*x[2]
        s[5,0,1]=(1.20688436616)*x[0]+(0.0247589671447)*x[1]+(-0.368536410815)*x[2]
        s[5,1,0]=(-0.324541665933)*x[0]+(-0.205515389215)*x[1]+(0.758278431203)*x[2]
        s[5,1,1]=(-0.620405057772)*x[0]+(-0.67647528448)*x[1]+(1.32328947052)*x[2]
        ref[0,0,0]=(0.260018146786)/(o+1.)+(-0.0267465952979)
        ref[0,0,1]=(-0.435502524101)/(o+1.)+(-0.912332534962)
        ref[0,1,0]=(-0.0330362836983)/(o+1.)+(-0.489628219987)
        ref[0,1,1]=(1.07484163998)/(o+1.)+(-0.273370056924)
        ref[1,0,0]=(-0.523779853488)/(o+1.)+(0.510360517549)
        ref[1,0,1]=(0.448972814496)/(o+1.)+(-0.505804309986)
        ref[1,1,0]=(-1.09840793106)/(o+1.)+(0.302405700276)
        ref[1,1,1]=(0.130511241273)/(o+1.)+(-0.288323766357)
        ref[2,0,0]=(-0.805299870557)/(o+1.)+(0.21803625485)
        ref[2,0,1]=(0.271181617798)/(o+1.)+(0.531297236071)
        ref[2,1,0]=(-1.29575884246)/(o+1.)+(0.153942519064)
        ref[2,1,1]=(-0.600379662508)/(o+1.)+(0.565678131765)
        ref[3,0,0]=(1.87814767227)/(o+1.)+(-0.140116323394)
        ref[3,0,1]=(-0.195825320078)/(o+1.)+(-0.523630356799)
        ref[3,1,0]=(-0.959261224384)/(o+1.)+(0.249823262853)
        ref[3,1,1]=(1.05531553015)/(o+1.)+(-0.858859911271)
        ref[4,0,0]=(0.65497734235)/(o+1.)+(-0.190760950929)
        ref[4,0,1]=(1.37092574409)/(o+1.)+(0.0173394004651)
        ref[4,1,0]=(1.27754767629)/(o+1.)+(-0.6802861583)
        ref[4,1,1]=(1.23997013471)/(o+1.)+(0.70527600063)
        ref[5,0,0]=(-0.383142890439)/(o+1.)+(0.312083322186)
        ref[5,0,1]=(1.64380369652)/(o+1.)+(-0.390348387013)
        ref[5,1,0]=(-0.812713549757)/(o+1.)+(0.520467462905)
        ref[5,1,1]=(0.600505313178)/(o+1.)+(-0.287048092454)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.235888975732)*x[0]+(-0.734372259615)*x[1]
        s[0,0,0,1]=(0.0665724430605)*x[0]+(-0.0890002398629)*x[1]
        s[0,0,1,0]=(-1.19774759676)*x[0]+(1.00321581155)*x[1]
        s[0,0,1,1]=(0.93370004223)*x[0]+(-0.953835581453)*x[1]
        s[0,0,2,0]=(-0.0557204731966)*x[0]+(0.94945217411)*x[1]
        s[0,0,2,1]=(-0.772628465097)*x[0]+(1.77100579145)*x[1]
        s[0,1,0,0]=(-0.405653863463)*x[0]+(0.494482129094)*x[1]
        s[0,1,0,1]=(0.636236763209)*x[0]+(-1.63254203234)*x[1]
        s[0,1,1,0]=(0.941764211044)*x[0]+(0.699520209508)*x[1]
        s[0,1,1,1]=(1.05045643599)*x[0]+(0.0596636815695)*x[1]
        s[0,1,2,0]=(0.578668042684)*x[0]+(0.285442340394)*x[1]
        s[0,1,2,1]=(0.469149909671)*x[0]+(1.26526906754)*x[1]
        s[0,2,0,0]=(1.05435496407)*x[0]+(-0.592645628655)*x[1]
        s[0,2,0,1]=(0.066181979241)*x[0]+(-1.42368311585)*x[1]
        s[0,2,1,0]=(-0.896588999422)*x[0]+(1.44881386304)*x[1]
        s[0,2,1,1]=(-0.862544854709)*x[0]+(-0.398360134784)*x[1]
        s[0,2,2,0]=(1.02969811319)*x[0]+(0.318993808627)*x[1]
        s[0,2,2,1]=(0.0143773859487)*x[0]+(-0.327118788648)*x[1]
        s[0,3,0,0]=(0.021196438108)*x[0]+(1.8515159226)*x[1]
        s[0,3,0,1]=(0.627726779803)*x[0]+(-0.302716383303)*x[1]
        s[0,3,1,0]=(0.165624370858)*x[0]+(0.274919760437)*x[1]
        s[0,3,1,1]=(0.283214725106)*x[0]+(-0.872378951063)*x[1]
        s[0,3,2,0]=(-0.83391985409)*x[0]+(0.731217556829)*x[1]
        s[0,3,2,1]=(0.918833558754)*x[0]+(0.714715370412)*x[1]
        s[0,4,0,0]=(-0.503211677055)*x[0]+(0.0289310095577)*x[1]
        s[0,4,0,1]=(0.597129238132)*x[0]+(0.540475624893)*x[1]
        s[0,4,1,0]=(0.687211570349)*x[0]+(0.594018658674)*x[1]
        s[0,4,1,1]=(1.5970484642)*x[0]+(-0.495319600999)*x[1]
        s[0,4,2,0]=(1.20627016067)*x[0]+(0.461261823726)*x[1]
        s[0,4,2,1]=(0.165927055028)*x[0]+(1.09007328428)*x[1]
        s[1,0,0,0]=(1.16105917598)*x[0]+(1.82590164801)*x[1]
        s[1,0,0,1]=(-1.13479961391)*x[0]+(0.0351464050353)*x[1]
        s[1,0,1,0]=(-0.318954647255)*x[0]+(0.210946813363)*x[1]
        s[1,0,1,1]=(1.31393538581)*x[0]+(0.198463680367)*x[1]
        s[1,0,2,0]=(1.17799558613)*x[0]+(0.514357347746)*x[1]
        s[1,0,2,1]=(0.571191341129)*x[0]+(0.694971250457)*x[1]
        s[1,1,0,0]=(0.132901410189)*x[0]+(-0.262070778236)*x[1]
        s[1,1,0,1]=(-0.871431837436)*x[0]+(-0.514707012778)*x[1]
        s[1,1,1,0]=(-0.319003186732)*x[0]+(-0.014973803902)*x[1]
        s[1,1,1,1]=(0.260213741998)*x[0]+(1.32908581921)*x[1]
        s[1,1,2,0]=(0.811339404893)*x[0]+(-0.304564391555)*x[1]
        s[1,1,2,1]=(-0.062193223101)*x[0]+(-0.911704705741)*x[1]
        s[1,2,0,0]=(0.0932623640149)*x[0]+(1.12570360092)*x[1]
        s[1,2,0,1]=(1.16504942277)*x[0]+(-0.385840092559)*x[1]
        s[1,2,1,0]=(1.3440680469)*x[0]+(0.532696669818)*x[1]
        s[1,2,1,1]=(1.31050128725)*x[0]+(0.00906728815983)*x[1]
        s[1,2,2,0]=(-1.36931832474)*x[0]+(-1.70562158659)*x[1]
        s[1,2,2,1]=(-1.8375028036)*x[0]+(1.52366054242)*x[1]
        s[1,3,0,0]=(0.474023303611)*x[0]+(0.437518737767)*x[1]
        s[1,3,0,1]=(-0.42921544272)*x[0]+(0.387647202618)*x[1]
        s[1,3,1,0]=(0.863045413096)*x[0]+(-0.36260979035)*x[1]
        s[1,3,1,1]=(-0.654365401799)*x[0]+(0.533926246461)*x[1]
        s[1,3,2,0]=(0.418152564814)*x[0]+(1.11544647745)*x[1]
        s[1,3,2,1]=(-1.60947873228)*x[0]+(0.591727770738)*x[1]
        s[1,4,0,0]=(-1.51807668572)*x[0]+(-1.01613349614)*x[1]
        s[1,4,0,1]=(-1.50163863727)*x[0]+(1.50376272164)*x[1]
        s[1,4,1,0]=(0.320776223369)*x[0]+(-0.700391339598)*x[1]
        s[1,4,1,1]=(0.745224476612)*x[0]+(-0.850870606209)*x[1]
        s[1,4,2,0]=(-0.179598404379)*x[0]+(1.75799776411)*x[1]
        s[1,4,2,1]=(0.00909330900106)*x[0]+(-0.077399205942)*x[1]
        s[2,0,0,0]=(0.505719447396)*x[0]+(-0.275603298829)*x[1]
        s[2,0,0,1]=(1.46787325811)*x[0]+(0.534793377012)*x[1]
        s[2,0,1,0]=(0.77645891983)*x[0]+(0.540540443218)*x[1]
        s[2,0,1,1]=(0.429661881583)*x[0]+(1.43421311479)*x[1]
        s[2,0,2,0]=(1.02806543045)*x[0]+(0.931834883879)*x[1]
        s[2,0,2,1]=(0.763031666632)*x[0]+(0.873653388204)*x[1]
        s[2,1,0,0]=(0.261772733655)*x[0]+(-1.18679909814)*x[1]
        s[2,1,0,1]=(-1.61662908583)*x[0]+(1.10646142209)*x[1]
        s[2,1,1,0]=(0.188527773811)*x[0]+(-0.772410233645)*x[1]
        s[2,1,1,1]=(-0.869931105194)*x[0]+(1.51014899284)*x[1]
        s[2,1,2,0]=(0.252478837689)*x[0]+(1.22480134325)*x[1]
        s[2,1,2,1]=(1.49578867187)*x[0]+(-0.877973056373)*x[1]
        s[2,2,0,0]=(-0.209568005598)*x[0]+(-0.0462992389671)*x[1]
        s[2,2,0,1]=(-0.298130269216)*x[0]+(-0.908352713549)*x[1]
        s[2,2,1,0]=(-0.586370615835)*x[0]+(-1.72704626602)*x[1]
        s[2,2,1,1]=(1.26217059553)*x[0]+(0.676548549908)*x[1]
        s[2,2,2,0]=(0.961200845015)*x[0]+(0.612151157303)*x[1]
        s[2,2,2,1]=(0.700873758828)*x[0]+(0.800662765762)*x[1]
        s[2,3,0,0]=(-0.319747641322)*x[0]+(0.689929330298)*x[1]
        s[2,3,0,1]=(-1.04393759081)*x[0]+(-1.80449230281)*x[1]
        s[2,3,1,0]=(-0.0410072962318)*x[0]+(-0.678000289402)*x[1]
        s[2,3,1,1]=(-0.329381648117)*x[0]+(-0.935487069857)*x[1]
        s[2,3,2,0]=(-0.907460976718)*x[0]+(0.0314212805943)*x[1]
        s[2,3,2,1]=(0.593604907619)*x[0]+(-0.479146057787)*x[1]
        s[2,4,0,0]=(-0.0337048332079)*x[0]+(0.239721443625)*x[1]
        s[2,4,0,1]=(0.721609580339)*x[0]+(-1.06464423044)*x[1]
        s[2,4,1,0]=(0.670568080353)*x[0]+(1.28774286264)*x[1]
        s[2,4,1,1]=(0.603608338555)*x[0]+(0.323996221169)*x[1]
        s[2,4,2,0]=(0.0371268677698)*x[0]+(0.401814556385)*x[1]
        s[2,4,2,1]=(0.436926475796)*x[0]+(-0.819433312575)*x[1]
        s[3,0,0,0]=(-0.0190186791033)*x[0]+(0.501672647061)*x[1]
        s[3,0,0,1]=(0.00060856018325)*x[0]+(-0.414668792931)*x[1]
        s[3,0,1,0]=(0.699428985955)*x[0]+(0.612631528371)*x[1]
        s[3,0,1,1]=(-0.659371576463)*x[0]+(-0.0982545515259)*x[1]
        s[3,0,2,0]=(0.444351889183)*x[0]+(0.53998411713)*x[1]
        s[3,0,2,1]=(-0.281563709018)*x[0]+(-0.486501437256)*x[1]
        s[3,1,0,0]=(0.407521411466)*x[0]+(-0.749870044816)*x[1]
        s[3,1,0,1]=(-0.638780264813)*x[0]+(0.230397511262)*x[1]
        s[3,1,1,0]=(1.16000440204)*x[0]+(0.13074916095)*x[1]
        s[3,1,1,1]=(-1.30550439046)*x[0]+(-1.33788704039)*x[1]
        s[3,1,2,0]=(-0.540767742404)*x[0]+(-0.148316212185)*x[1]
        s[3,1,2,1]=(1.70452499495)*x[0]+(0.935421717463)*x[1]
        s[3,2,0,0]=(0.320990904519)*x[0]+(0.467953609756)*x[1]
        s[3,2,0,1]=(-0.26002228203)*x[0]+(-0.925765706976)*x[1]
        s[3,2,1,0]=(0.925754935382)*x[0]+(0.240432086422)*x[1]
        s[3,2,1,1]=(0.0214680080146)*x[0]+(-1.11507977191)*x[1]
        s[3,2,2,0]=(-0.187946153679)*x[0]+(0.024781322847)*x[1]
        s[3,2,2,1]=(-1.41866510495)*x[0]+(0.596173034069)*x[1]
        s[3,3,0,0]=(0.77087649562)*x[0]+(0.848168811103)*x[1]
        s[3,3,0,1]=(0.218810390517)*x[0]+(0.116909485563)*x[1]
        s[3,3,1,0]=(-0.889981738645)*x[0]+(-0.506355969844)*x[1]
        s[3,3,1,1]=(1.15870903185)*x[0]+(-0.8158119166)*x[1]
        s[3,3,2,0]=(-0.345230989856)*x[0]+(-0.138496974465)*x[1]
        s[3,3,2,1]=(-0.819830787817)*x[0]+(-1.66747998417)*x[1]
        s[3,4,0,0]=(-1.74647564112)*x[0]+(0.22309219172)*x[1]
        s[3,4,0,1]=(0.146804717412)*x[0]+(0.493084518827)*x[1]
        s[3,4,1,0]=(-0.536943383893)*x[0]+(-0.686288132381)*x[1]
        s[3,4,1,1]=(-0.142983666789)*x[0]+(-0.183927597857)*x[1]
        s[3,4,2,0]=(-0.173071632973)*x[0]+(-0.696870700802)*x[1]
        s[3,4,2,1]=(-0.359163238166)*x[0]+(-0.172033035327)*x[1]
        ref[0,0,0,0]=(-0.603598770198)/(o+1.)+(0.0525577431575)
        ref[0,0,0,1]=(1.04505857398)/(o+1.)+(-0.533743185393)
        ref[0,0,1,0]=(0.00772071573504)/(o+1.)+(-0.101126250473)
        ref[0,0,1,1]=(-0.290587702404)/(o+1.)+(0.135226081591)
        ref[0,0,2,0]=(0.614426628234)/(o+1.)+(0.139652536339)
        ref[0,0,2,1]=(-0.0228094425795)/(o+1.)+(0.510593384465)
        ref[0,1,0,0]=(-0.436885078328)/(o+1.)+(0.262856671979)
        ref[0,1,0,1]=(0.0510259667548)/(o+1.)+(-0.523665617945)
        ref[0,1,1,0]=(0.744462079536)/(o+1.)+(0.448411170508)
        ref[0,1,1,1]=(1.52720962375)/(o+1.)+(-0.208544753096)
        ref[0,1,2,0]=(0.73405306307)/(o+1.)+(0.0650286600044)
        ref[0,1,2,1]=(0.550924984933)/(o+1.)+(0.591746996137)
        ref[0,2,0,0]=(-0.347797813257)/(o+1.)+(0.404753574338)
        ref[0,2,0,1]=(0.187043042708)/(o+1.)+(-0.772272089659)
        ref[0,2,1,0]=(-0.316098850787)/(o+1.)+(0.434161857202)
        ref[0,2,1,1]=(-0.536124734534)/(o+1.)+(-0.36239012748)
        ref[0,2,2,0]=(0.585045523113)/(o+1.)+(0.381823199352)
        ref[0,2,2,1]=(0.422243751365)/(o+1.)+(-0.367492577032)
        ref[0,3,0,0]=(0.91381158808)/(o+1.)+(0.479450386313)
        ref[0,3,0,1]=(0.209840671177)/(o+1.)+(0.0575848626616)
        ref[0,3,1,0]=(0.158639778589)/(o+1.)+(0.140952176353)
        ref[0,3,1,1]=(-0.364808895601)/(o+1.)+(-0.112177665178)
        ref[0,3,2,0]=(-0.198937574741)/(o+1.)+(0.0481176387404)
        ref[0,3,2,1]=(1.05420599501)/(o+1.)+(0.289671467078)
        ref[0,4,0,0]=(0.811701728881)/(o+1.)+(-0.642991198189)
        ref[0,4,0,1]=(0.693754647803)/(o+1.)+(0.221925107611)
        ref[0,4,1,0]=(1.05453609011)/(o+1.)+(0.113347069457)
        ref[0,4,1,1]=(0.117274271978)/(o+1.)+(0.49222729561)
        ref[0,4,2,0]=(0.496795563283)/(o+1.)+(0.585368210556)
        ref[0,4,2,1]=(0.83272690983)/(o+1.)+(0.211636714741)
        ref[1,0,0,0]=(1.46878592273)/(o+1.)+(0.75908745063)
        ref[1,0,0,1]=(-0.250785630529)/(o+1.)+(-0.424433789171)
        ref[1,0,1,0]=(0.161786720779)/(o+1.)+(-0.134897277336)
        ref[1,0,1,1]=(1.12719401256)/(o+1.)+(0.192602526813)
        ref[1,0,2,0]=(0.7197235394)/(o+1.)+(0.486314697239)
        ref[1,0,2,1]=(1.02804458464)/(o+1.)+(0.119059003471)
        ref[1,1,0,0]=(0.0361584520541)/(o+1.)+(-0.0826639100507)
        ref[1,1,0,1]=(-1.06091812324)/(o+1.)+(-0.162610363489)
        ref[1,1,1,0]=(1.13776585837)/(o+1.)+(-0.735871424501)
        ref[1,1,1,1]=(1.4740891177)/(o+1.)+(0.0576052217538)
        ref[1,1,2,0]=(0.280616623834)/(o+1.)+(0.113079194752)
        ref[1,1,2,1]=(-0.491890699653)/(o+1.)+(-0.241003614595)
        ref[1,2,0,0]=(-0.0342838844534)/(o+1.)+(0.626624924695)
        ref[1,2,0,1]=(0.770911868081)/(o+1.)+(0.00414873106652)
        ref[1,2,1,0]=(0.30749084682)/(o+1.)+(0.784636934951)
        ref[1,2,1,1]=(1.8638645006)/(o+1.)+(-0.272147962595)
        ref[1,2,2,0]=(-1.46841213372)/(o+1.)+(-0.803263888803)
        ref[1,2,2,1]=(-0.302454198157)/(o+1.)+(-0.00569403150815)
        ref[1,3,0,0]=(0.493917522063)/(o+1.)+(0.208812259657)
        ref[1,3,0,1]=(0.476274657976)/(o+1.)+(-0.258921449039)
        ref[1,3,1,0]=(-0.736248174893)/(o+1.)+(0.618341898819)
        ref[1,3,1,1]=(-0.697129670691)/(o+1.)+(0.288345257677)
        ref[1,3,2,0]=(0.303153912627)/(o+1.)+(0.615222564816)
        ref[1,3,2,1]=(-0.58122630211)/(o+1.)+(-0.218262329715)
        ref[1,4,0,0]=(-1.15442442968)/(o+1.)+(-0.689892876091)
        ref[1,4,0,1]=(0.0585826445649)/(o+1.)+(-0.0282292800982)
        ref[1,4,1,0]=(0.3252337262)/(o+1.)+(-0.352424421214)
        ref[1,4,1,1]=(0.512701244088)/(o+1.)+(-0.309173686843)
        ref[1,4,2,0]=(1.5506882457)/(o+1.)+(0.0138555570174)
        ref[1,4,2,1]=(-0.940773035102)/(o+1.)+(0.436233569081)
        ref[2,0,0,0]=(1.54247754874)/(o+1.)+(-0.656180700088)
        ref[2,0,0,1]=(0.988306961756)/(o+1.)+(0.507179836684)
        ref[2,0,1,0]=(-0.416628824296)/(o+1.)+(0.866814093672)
        ref[2,0,1,1]=(1.41006066195)/(o+1.)+(0.22690716721)
        ref[2,0,2,0]=(0.353011705537)/(o+1.)+(0.803444304396)
        ref[2,0,2,1]=(0.687642260874)/(o+1.)+(0.474521396981)
        ref[2,1,0,0]=(-0.218198987148)/(o+1.)+(-0.353413688668)
        ref[2,1,0,1]=(-0.635306433562)/(o+1.)+(0.0625693849126)
        ref[2,1,1,0]=(0.53416867099)/(o+1.)+(-0.559025565412)
        ref[2,1,1,1]=(0.00543686305333)/(o+1.)+(0.317390512297)
        ref[2,1,2,0]=(0.916573120847)/(o+1.)+(0.280353530048)
        ref[2,1,2,1]=(-0.0537588152546)/(o+1.)+(0.335787215373)
        ref[2,2,0,0]=(1.0055660817)/(o+1.)+(-0.630716663133)
        ref[2,2,0,1]=(0.420474306577)/(o+1.)+(-0.813478644671)
        ref[2,2,1,0]=(-0.723008657238)/(o+1.)+(-0.795204112308)
        ref[2,2,1,1]=(0.306188174034)/(o+1.)+(0.816265485704)
        ref[2,2,2,0]=(0.806158569368)/(o+1.)+(0.383596716475)
        ref[2,2,2,1]=(1.6353377865)/(o+1.)+(-0.066900630957)
        ref[2,3,0,0]=(-1.24813850815)/(o+1.)+(0.809160098565)
        ref[2,3,0,1]=(-1.56942041127)/(o+1.)+(-0.639504741178)
        ref[2,3,1,0]=(-1.49605878837)/(o+1.)+(0.388525601366)
        ref[2,3,1,1]=(-0.448403645878)/(o+1.)+(-0.408232536048)
        ref[2,3,2,0]=(-1.13568794342)/(o+1.)+(0.129824123646)
        ref[2,3,2,1]=(0.596733666259)/(o+1.)+(-0.241137408214)
        ref[2,4,0,0]=(0.0191094707617)/(o+1.)+(0.0934535698276)
        ref[2,4,0,1]=(0.185204097773)/(o+1.)+(-0.264119373935)
        ref[2,4,1,0]=(1.55855563639)/(o+1.)+(0.199877653305)
        ref[2,4,1,1]=(0.11469142184)/(o+1.)+(0.406456568942)
        ref[2,4,2,0]=(-0.954321542363)/(o+1.)+(0.696631483259)
        ref[2,4,2,1]=(-0.810227566168)/(o+1.)+(0.213860364695)
        ref[3,0,0,0]=(0.453436736881)/(o+1.)+(0.0146086155385)
        ref[3,0,0,1]=(-0.210824760654)/(o+1.)+(-0.101617736047)
        ref[3,0,1,0]=(0.414458928012)/(o+1.)+(0.448800793157)
        ref[3,0,1,1]=(0.346129385596)/(o+1.)+(-0.551877756793)
        ref[3,0,2,0]=(1.85496275992)/(o+1.)+(-0.435313376805)
        ref[3,0,2,1]=(-0.110500317363)/(o+1.)+(-0.328782414455)
        ref[3,1,0,0]=(0.0399449935267)/(o+1.)+(-0.191146813438)
        ref[3,1,0,1]=(0.133080949177)/(o+1.)+(-0.270731851364)
        ref[3,1,1,0]=(0.139648356416)/(o+1.)+(0.575552603289)
        ref[3,1,1,1]=(-1.45813597924)/(o+1.)+(-0.592627725804)
        ref[3,1,2,0]=(-0.773854684679)/(o+1.)+(0.0423853650452)
        ref[3,1,2,1]=(1.2726274277)/(o+1.)+(0.683659642354)
        ref[3,2,0,0]=(0.555324507349)/(o+1.)+(0.116810003463)
        ref[3,2,0,1]=(-0.310977730161)/(o+1.)+(-0.437405129422)
        ref[3,2,1,0]=(1.05800939782)/(o+1.)+(0.0540888119933)
        ref[3,2,1,1]=(0.386222714751)/(o+1.)+(-0.739917239322)
        ref[3,2,2,0]=(-0.95705464593)/(o+1.)+(0.396944907549)
        ref[3,2,2,1]=(-0.491612682819)/(o+1.)+(-0.165439694033)
        ref[3,3,0,0]=(0.666972772584)/(o+1.)+(0.47603626707)
        ref[3,3,0,1]=(0.268506355312)/(o+1.)+(0.0336067603842)
        ref[3,3,1,0]=(-0.57724956178)/(o+1.)+(-0.409544073355)
        ref[3,3,1,1]=(-0.518808765862)/(o+1.)+(0.430852940555)
        ref[3,3,2,0]=(-1.95248352029)/(o+1.)+(0.734377777986)
        ref[3,3,2,1]=(-1.14565232021)/(o+1.)+(-0.67082922589)
        ref[3,4,0,0]=(-1.13455573259)/(o+1.)+(-0.1944138584)
        ref[3,4,0,1]=(-0.508914286468)/(o+1.)+(0.574401761354)
        ref[3,4,1,0]=(-0.319104038837)/(o+1.)+(-0.452063738718)
        ref[3,4,1,1]=(-0.100356733327)/(o+1.)+(-0.11327726566)
        ref[3,4,2,0]=(-0.39970881352)/(o+1.)+(-0.235116760127)
        ref[3,4,2,1]=(-0.339631070901)/(o+1.)+(-0.0957826012957)
      else:
        s[0,0,0,0]=(0.0794776522341)*x[0]+(1.69294456255)*x[1]+(0.824115844979)*x[2]
        s[0,0,0,1]=(0.0720523378919)*x[0]+(-1.39724154561)*x[1]+(-0.010988810956)*x[2]
        s[0,0,1,0]=(0.985556321125)*x[0]+(1.12133844031)*x[1]+(-0.262491219522)*x[2]
        s[0,0,1,1]=(0.789643681767)*x[0]+(1.02860624013)*x[1]+(-0.450770685703)*x[2]
        s[0,0,2,0]=(-0.850427026537)*x[0]+(-0.393993518297)*x[1]+(0.12816296306)*x[2]
        s[0,0,2,1]=(-0.47508130541)*x[0]+(-0.393857510976)*x[1]+(0.66003641476)*x[2]
        s[0,1,0,0]=(-1.87725252884)*x[0]+(-0.668075530728)*x[1]+(0.938485679482)*x[2]
        s[0,1,0,1]=(0.820537136967)*x[0]+(-0.453620529157)*x[1]+(0.811944595883)*x[2]
        s[0,1,1,0]=(0.914995161971)*x[0]+(-0.196153821444)*x[1]+(0.938555859255)*x[2]
        s[0,1,1,1]=(-0.866633718493)*x[0]+(-0.534596859321)*x[1]+(0.77514383239)*x[2]
        s[0,1,2,0]=(0.183094085342)*x[0]+(0.727499336912)*x[1]+(0.170986687969)*x[2]
        s[0,1,2,1]=(-1.36220673904)*x[0]+(0.0822122492483)*x[1]+(0.124227107716)*x[2]
        s[0,2,0,0]=(1.55269479425)*x[0]+(-0.14574857122)*x[1]+(1.24120289667)*x[2]
        s[0,2,0,1]=(-0.464038186768)*x[0]+(0.00554383028356)*x[1]+(-1.14838250985)*x[2]
        s[0,2,1,0]=(0.904608031363)*x[0]+(-0.313004420619)*x[1]+(-0.10529298073)*x[2]
        s[0,2,1,1]=(0.156623578469)*x[0]+(0.55127494399)*x[1]+(-0.385447926692)*x[2]
        s[0,2,2,0]=(-0.766804018933)*x[0]+(0.18519619356)*x[1]+(1.00915540081)*x[2]
        s[0,2,2,1]=(0.00231157548456)*x[0]+(0.338768642838)*x[1]+(-0.684228602438)*x[2]
        s[0,3,0,0]=(-0.834810486599)*x[0]+(-0.096360306458)*x[1]+(1.28924889761)*x[2]
        s[0,3,0,1]=(-0.658443843543)*x[0]+(0.889474267886)*x[1]+(0.566763124725)*x[2]
        s[0,3,1,0]=(-0.109777093963)*x[0]+(0.228053887631)*x[1]+(1.22952539906)*x[2]
        s[0,3,1,1]=(-0.749479260801)*x[0]+(-1.01102432725)*x[1]+(-0.196861989291)*x[2]
        s[0,3,2,0]=(0.650389523509)*x[0]+(0.151701374527)*x[1]+(0.506246388483)*x[2]
        s[0,3,2,1]=(-0.648510958338)*x[0]+(-0.263590202304)*x[1]+(-1.35992044414)*x[2]
        s[0,4,0,0]=(0.196976454523)*x[0]+(-0.193947226599)*x[1]+(1.67641586045)*x[2]
        s[0,4,0,1]=(-0.455868626908)*x[0]+(0.506302321882)*x[1]+(1.1666778393)*x[2]
        s[0,4,1,0]=(-0.788545609857)*x[0]+(-0.487332926053)*x[1]+(-0.0645141715605)*x[2]
        s[0,4,1,1]=(-0.320424709093)*x[0]+(-0.683301403769)*x[1]+(-0.222245108268)*x[2]
        s[0,4,2,0]=(0.876149348517)*x[0]+(0.12449602802)*x[1]+(-0.220531205966)*x[2]
        s[0,4,2,1]=(-0.2764172159)*x[0]+(-0.894571003479)*x[1]+(-0.595830070177)*x[2]
        s[1,0,0,0]=(-0.79676665323)*x[0]+(-1.25965739347)*x[1]+(-0.319474113915)*x[2]
        s[1,0,0,1]=(1.601348448)*x[0]+(0.41027863439)*x[1]+(-0.346758807915)*x[2]
        s[1,0,1,0]=(0.181292913253)*x[0]+(1.10494312205)*x[1]+(0.196973772813)*x[2]
        s[1,0,1,1]=(0.562861818795)*x[0]+(-0.997990211102)*x[1]+(0.0332706615838)*x[2]
        s[1,0,2,0]=(-0.989984164479)*x[0]+(-0.886186583204)*x[1]+(-0.228620900973)*x[2]
        s[1,0,2,1]=(0.841365917044)*x[0]+(-0.0519066039156)*x[1]+(-0.81126199301)*x[2]
        s[1,1,0,0]=(-0.613125126303)*x[0]+(0.482770874125)*x[1]+(0.038374960382)*x[2]
        s[1,1,0,1]=(-0.203719663632)*x[0]+(-0.281873286682)*x[1]+(-0.0303453795347)*x[2]
        s[1,1,1,0]=(1.11287699536)*x[0]+(-1.04759296757)*x[1]+(1.64257695374)*x[2]
        s[1,1,1,1]=(-0.0861307607908)*x[0]+(0.261314888791)*x[1]+(-0.204955973137)*x[2]
        s[1,1,2,0]=(0.821662110998)*x[0]+(-1.05649310988)*x[1]+(0.609822823353)*x[2]
        s[1,1,2,1]=(-0.730526005063)*x[0]+(1.62018363097)*x[1]+(0.99111776492)*x[2]
        s[1,2,0,0]=(-1.25039777751)*x[0]+(0.811070034681)*x[1]+(1.32505446058)*x[2]
        s[1,2,0,1]=(0.753110041895)*x[0]+(0.186756235207)*x[1]+(-1.30430176967)*x[2]
        s[1,2,1,0]=(0.146182105242)*x[0]+(-0.863831927779)*x[1]+(-1.1030247274)*x[2]
        s[1,2,1,1]=(0.674634709918)*x[0]+(-0.560866548824)*x[1]+(0.576408322189)*x[2]
        s[1,2,2,0]=(-0.573489753302)*x[0]+(1.57147013427)*x[1]+(0.711691292064)*x[2]
        s[1,2,2,1]=(0.549483527739)*x[0]+(-1.14179814973)*x[1]+(1.60524619335)*x[2]
        s[1,3,0,0]=(0.197453494754)*x[0]+(-0.456559966113)*x[1]+(-1.21423667747)*x[2]
        s[1,3,0,1]=(-1.76312274691)*x[0]+(-1.04778192886)*x[1]+(-0.185488490674)*x[2]
        s[1,3,1,0]=(0.0162460011376)*x[0]+(1.16407944993)*x[1]+(1.16424268292)*x[2]
        s[1,3,1,1]=(-0.513913288204)*x[0]+(-1.46536589962)*x[1]+(-0.906205233261)*x[2]
        s[1,3,2,0]=(-0.0157400074256)*x[0]+(-0.293812243081)*x[1]+(0.815280978304)*x[2]
        s[1,3,2,1]=(1.57630585875)*x[0]+(0.290739280065)*x[1]+(-0.771398356417)*x[2]
        s[1,4,0,0]=(-0.323882779703)*x[0]+(-0.763929395312)*x[1]+(0.738403272406)*x[2]
        s[1,4,0,1]=(-0.476278532043)*x[0]+(-0.11039317349)*x[1]+(0.346684885005)*x[2]
        s[1,4,1,0]=(-1.36304063164)*x[0]+(-0.660619165296)*x[1]+(-0.903566907206)*x[2]
        s[1,4,1,1]=(0.0863780283437)*x[0]+(0.466792514558)*x[1]+(0.448776109878)*x[2]
        s[1,4,2,0]=(0.74478619068)*x[0]+(0.446314847678)*x[1]+(-0.0481741032015)*x[2]
        s[1,4,2,1]=(0.746506715398)*x[0]+(-0.432201202785)*x[1]+(0.203440105689)*x[2]
        s[2,0,0,0]=(-0.785805880678)*x[0]+(-0.862407720473)*x[1]+(-1.21640925829)*x[2]
        s[2,0,0,1]=(0.647190817984)*x[0]+(0.519851314653)*x[1]+(0.390946186931)*x[2]
        s[2,0,1,0]=(-1.24831725337)*x[0]+(1.59413938467)*x[1]+(-1.33358250136)*x[2]
        s[2,0,1,1]=(-0.152213072763)*x[0]+(-1.09357954369)*x[1]+(-1.25586196425)*x[2]
        s[2,0,2,0]=(-0.0314861108304)*x[0]+(0.293907529511)*x[1]+(-0.21039874768)*x[2]
        s[2,0,2,1]=(0.0467194832302)*x[0]+(0.527286460462)*x[1]+(-0.415618293894)*x[2]
        s[2,1,0,0]=(-0.189575051656)*x[0]+(-0.844885847783)*x[1]+(-0.334235875002)*x[2]
        s[2,1,0,1]=(-0.00822711174783)*x[0]+(-1.5897272285)*x[1]+(1.50002681163)*x[2]
        s[2,1,1,0]=(-0.841981498104)*x[0]+(-1.10376539971)*x[1]+(0.311385102139)*x[2]
        s[2,1,1,1]=(1.12897934543)*x[0]+(-0.966261308872)*x[1]+(-1.16359871767)*x[2]
        s[2,1,2,0]=(-0.957189463062)*x[0]+(0.0471569985184)*x[1]+(0.12392515517)*x[2]
        s[2,1,2,1]=(-0.752369087888)*x[0]+(1.18176351896)*x[1]+(0.334788137458)*x[2]
        s[2,2,0,0]=(1.22014205343)*x[0]+(0.784413576281)*x[1]+(0.0962245348039)*x[2]
        s[2,2,0,1]=(-0.407023035962)*x[0]+(1.11597107325)*x[1]+(0.458612291763)*x[2]
        s[2,2,1,0]=(-0.0496175828387)*x[0]+(-0.0536216340718)*x[1]+(0.771683970464)*x[2]
        s[2,2,1,1]=(-0.356958793645)*x[0]+(-1.38580705404)*x[1]+(-0.670167616875)*x[2]
        s[2,2,2,0]=(0.0804001816041)*x[0]+(-1.16114869406)*x[1]+(0.475472363874)*x[2]
        s[2,2,2,1]=(0.98238551642)*x[0]+(-1.12578358118)*x[1]+(-0.00970359156434)*x[2]
        s[2,3,0,0]=(1.0110556058)*x[0]+(-0.488112488916)*x[1]+(0.243005554591)*x[2]
        s[2,3,0,1]=(-0.16668051279)*x[0]+(0.178067528024)*x[1]+(0.969038052731)*x[2]
        s[2,3,1,0]=(-0.00345650882131)*x[0]+(-0.941671547756)*x[1]+(-0.49908897105)*x[2]
        s[2,3,1,1]=(0.716683430797)*x[0]+(-0.585708024289)*x[1]+(-1.19073441986)*x[2]
        s[2,3,2,0]=(0.400515369791)*x[0]+(-0.454556618814)*x[1]+(0.0782324352019)*x[2]
        s[2,3,2,1]=(-0.164628093414)*x[0]+(-1.26464027792)*x[1]+(0.179511210919)*x[2]
        s[2,4,0,0]=(1.33277550072)*x[0]+(1.18570575409)*x[1]+(0.381346013717)*x[2]
        s[2,4,0,1]=(0.588290284687)*x[0]+(-1.08302445047)*x[1]+(0.166898904485)*x[2]
        s[2,4,1,0]=(0.131178111015)*x[0]+(-0.749855470189)*x[1]+(-0.1247474719)*x[2]
        s[2,4,1,1]=(-0.97245336122)*x[0]+(0.873932906896)*x[1]+(0.120264062027)*x[2]
        s[2,4,2,0]=(-0.722531128456)*x[0]+(0.19636289816)*x[1]+(-0.907945347107)*x[2]
        s[2,4,2,1]=(-0.711111750197)*x[0]+(0.31947094036)*x[1]+(-1.79333697163)*x[2]
        s[3,0,0,0]=(-0.184519023765)*x[0]+(0.680221159423)*x[1]+(-0.0244123658903)*x[2]
        s[3,0,0,1]=(-1.14573637546)*x[0]+(0.0616977700293)*x[1]+(-0.654808111844)*x[2]
        s[3,0,1,0]=(-1.09297543018)*x[0]+(-1.04184353717)*x[1]+(0.384120100538)*x[2]
        s[3,0,1,1]=(0.105247846819)*x[0]+(-1.31600150124)*x[1]+(1.43496073616)*x[2]
        s[3,0,2,0]=(0.881148598911)*x[0]+(-0.478723216871)*x[1]+(-0.0746344543132)*x[2]
        s[3,0,2,1]=(-1.20828681587)*x[0]+(-1.65808839437)*x[1]+(-0.636678098535)*x[2]
        s[3,1,0,0]=(-0.213394309668)*x[0]+(-0.240354748844)*x[1]+(0.117282970374)*x[2]
        s[3,1,0,1]=(1.37462845901)*x[0]+(-0.41583894581)*x[1]+(-0.625626047701)*x[2]
        s[3,1,1,0]=(1.83991491983)*x[0]+(1.2778674571)*x[1]+(1.35465906139)*x[2]
        s[3,1,1,1]=(1.58168546715)*x[0]+(0.829809996131)*x[1]+(0.681232260732)*x[2]
        s[3,1,2,0]=(-0.0212907664121)*x[0]+(1.00109823691)*x[1]+(-1.30845432825)*x[2]
        s[3,1,2,1]=(0.169920360674)*x[0]+(-0.864995850094)*x[1]+(0.302979947072)*x[2]
        s[3,2,0,0]=(-0.154084636739)*x[0]+(0.319647474298)*x[1]+(-1.23506947259)*x[2]
        s[3,2,0,1]=(-0.199216213818)*x[0]+(1.28921202953)*x[1]+(1.65805122541)*x[2]
        s[3,2,1,0]=(-1.86774194364)*x[0]+(-0.101723263166)*x[1]+(-0.526029332636)*x[2]
        s[3,2,1,1]=(-0.177960964857)*x[0]+(-0.899073564225)*x[1]+(0.551378002191)*x[2]
        s[3,2,2,0]=(0.18491319197)*x[0]+(-0.286906366286)*x[1]+(0.583859098776)*x[2]
        s[3,2,2,1]=(0.38623837272)*x[0]+(-0.653272502002)*x[1]+(-1.46718517275)*x[2]
        s[3,3,0,0]=(0.0494572779834)*x[0]+(-0.0566099666381)*x[1]+(-0.113874384717)*x[2]
        s[3,3,0,1]=(0.0241152098269)*x[0]+(-0.317061594612)*x[1]+(1.23769551101)*x[2]
        s[3,3,1,0]=(-0.107294616786)*x[0]+(-0.651410283508)*x[1]+(0.833104181804)*x[2]
        s[3,3,1,1]=(0.16676828757)*x[0]+(-0.670496617303)*x[1]+(1.15686719798)*x[2]
        s[3,3,2,0]=(0.159950143242)*x[0]+(0.0436823700228)*x[1]+(-0.645027680285)*x[2]
        s[3,3,2,1]=(-1.2697347822)*x[0]+(1.22938250997)*x[1]+(0.208587928792)*x[2]
        s[3,4,0,0]=(0.575105413412)*x[0]+(-1.44998456404)*x[1]+(-0.516125694177)*x[2]
        s[3,4,0,1]=(0.0387618783003)*x[0]+(0.859152861676)*x[1]+(1.29847202073)*x[2]
        s[3,4,1,0]=(-0.842510438531)*x[0]+(0.191878858518)*x[1]+(-0.73453059399)*x[2]
        s[3,4,1,1]=(1.41435810392)*x[0]+(-0.855734345577)*x[1]+(-0.425917153945)*x[2]
        s[3,4,2,0]=(-0.58228358663)*x[0]+(0.00936548588525)*x[1]+(-1.38536320116)*x[2]
        s[3,4,2,1]=(0.0419678913201)*x[0]+(1.02999559903)*x[1]+(-0.464745184871)*x[2]
        ref[0,0,0,0]=(1.30172410662)/(o+1.)+(0.647406976573)
        ref[0,0,0,1]=(-1.09442521373)/(o+1.)+(-0.120876402476)
        ref[0,0,1,0]=(2.01757642043)/(o+1.)+(-0.0865864392547)
        ref[0,0,1,1]=(1.80034002198)/(o+1.)+(-0.216430392892)
        ref[0,0,2,0]=(1.13142112916)/(o+1.)+(-1.12383935547)
        ref[0,0,2,1]=(-0.905515986966)/(o+1.)+(0.34830679267)
        ref[0,1,0,0]=(-0.210441134504)/(o+1.)+(-0.698200622791)
        ref[0,1,0,1]=(0.360807961621)/(o+1.)+(0.409026621036)
        ref[0,1,1,0]=(1.5147969883)/(o+1.)+(0.0713001057429)
        ref[0,1,1,1]=(0.396123567843)/(o+1.)+(-0.511105156634)
        ref[0,1,2,0]=(0.184468760768)/(o+1.)+(0.448555674728)
        ref[0,1,2,1]=(-0.133892978353)/(o+1.)+(-0.510937201862)
        ref[0,2,0,0]=(1.66137009462)/(o+1.)+(0.493389512541)
        ref[0,2,0,1]=(0.358452769174)/(o+1.)+(-0.982664817753)
        ref[0,2,1,0]=(0.966434135345)/(o+1.)+(-0.240061752665)
        ref[0,2,1,1]=(-0.401753883503)/(o+1.)+(0.362102239635)
        ref[0,2,2,0]=(-0.0153619747046)/(o+1.)+(0.221454775071)
        ref[0,2,2,1]=(-0.104138117282)/(o+1.)+(-0.119505133417)
        ref[0,3,0,0]=(-0.966204569194)/(o+1.)+(0.662141336872)
        ref[0,3,0,1]=(0.587661220327)/(o+1.)+(0.10506616437)
        ref[0,3,1,0]=(2.02288199931)/(o+1.)+(-0.337539903289)
        ref[0,3,1,1]=(-1.78842825396)/(o+1.)+(-0.0844686616883)
        ref[0,3,2,0]=(0.927282266945)/(o+1.)+(0.190527509786)
        ref[0,3,2,1]=(-0.679518039292)/(o+1.)+(-0.796251782745)
        ref[0,4,0,0]=(0.555388124049)/(o+1.)+(0.562028482163)
        ref[0,4,0,1]=(0.0870397234082)/(o+1.)+(0.565035905435)
        ref[0,4,1,0]=(-1.1463502212)/(o+1.)+(-0.0970212431374)
        ref[0,4,1,1]=(0.233233715042)/(o+1.)+(-0.729602468086)
        ref[0,4,2,0]=(-0.782889963002)/(o+1.)+(0.781502066786)
        ref[0,4,2,1]=(0.763433249649)/(o+1.)+(-1.2651257696)
        ref[1,0,0,0]=(-1.00441831898)/(o+1.)+(-0.685739920821)
        ref[1,0,0,1]=(0.751247546824)/(o+1.)+(0.456810363824)
        ref[1,0,1,0]=(2.22764882334)/(o+1.)+(-0.372219507613)
        ref[1,0,1,1]=(-1.19623631804)/(o+1.)+(0.39718929366)
        ref[1,0,2,0]=(-1.60343741738)/(o+1.)+(-0.250677115636)
        ref[1,0,2,1]=(-1.25680789752)/(o+1.)+(0.61750260882)
        ref[1,1,0,0]=(-1.45519189991)/(o+1.)+(0.681606304054)
        ref[1,1,0,1]=(0.840628495308)/(o+1.)+(-0.678283412578)
        ref[1,1,1,0]=(1.41826768667)/(o+1.)+(0.144796647431)
        ref[1,1,1,1]=(-0.933723251106)/(o+1.)+(0.451975702985)
        ref[1,1,2,0]=(-0.408324994487)/(o+1.)+(0.39165840948)
        ref[1,1,2,1]=(1.23290517672)/(o+1.)+(0.323935107053)
        ref[1,2,0,0]=(0.825483086179)/(o+1.)+(0.0301218157877)
        ref[1,2,0,1]=(-0.0793934768662)/(o+1.)+(-0.142521007854)
        ref[1,2,1,0]=(-0.0709650957035)/(o+1.)+(-0.874854727116)
        ref[1,2,1,1]=(1.10714952407)/(o+1.)+(-0.208486520392)
        ref[1,2,2,0]=(0.99013461187)/(o+1.)+(0.359768530582)
        ref[1,2,2,1]=(0.0356627876162)/(o+1.)+(0.488634391872)
        ref[1,3,0,0]=(-0.474442326803)/(o+1.)+(-0.499450411015)
        ref[1,3,0,1]=(-0.673232992552)/(o+1.)+(-1.16158008694)
        ref[1,3,1,0]=(0.411652221393)/(o+1.)+(0.966457956295)
        ref[1,3,1,1]=(-1.76698398732)/(o+1.)+(-0.559250216883)
        ref[1,3,2,0]=(1.9874048718)/(o+1.)+(-0.740838072)
        ref[1,3,2,1]=(0.661784629796)/(o+1.)+(0.216931076303)
        ref[1,4,0,0]=(-0.513029515019)/(o+1.)+(0.0818103062045)
        ref[1,4,0,1]=(0.282755142694)/(o+1.)+(-0.261370981611)
        ref[1,4,1,0]=(-1.96973437805)/(o+1.)+(-0.478746163042)
        ref[1,4,1,1]=(0.908774952181)/(o+1.)+(0.0465858502998)
        ref[1,4,2,0]=(1.3422757017)/(o+1.)+(-0.0996743832723)
        ref[1,4,2,1]=(1.21609351443)/(o+1.)+(-0.349173948065)
        ref[2,0,0,0]=(-1.01744592956)/(o+1.)+(-0.923588464944)
        ref[2,0,0,1]=(1.10931736222)/(o+1.)+(0.224335478673)
        ref[2,0,1,0]=(-0.416479828321)/(o+1.)+(-0.285640270869)
        ref[2,0,1,1]=(-1.5671174369)/(o+1.)+(-0.467268571897)
        ref[2,0,2,0]=(-0.274214960025)/(o+1.)+(0.163118815513)
        ref[2,0,2,1]=(0.000680528469817)/(o+1.)+(0.0788535606642)
        ref[2,1,0,0]=(-0.844192475139)/(o+1.)+(-0.262252149651)
        ref[2,1,0,1]=(0.69399848864)/(o+1.)+(-0.395963008628)
        ref[2,1,1,0]=(-1.37742489692)/(o+1.)+(-0.128468449379)
        ref[2,1,1,1]=(0.282095133276)/(o+1.)+(-0.641487907195)
        ref[2,1,2,0]=(-1.4727375549)/(o+1.)+(0.343315122764)
        ref[2,1,2,1]=(0.67637649169)/(o+1.)+(0.0439030384195)
        ref[2,2,0,0]=(1.58598306034)/(o+1.)+(0.257398552088)
        ref[2,2,0,1]=(-0.187654980952)/(o+1.)+(0.677607655001)
        ref[2,2,1,0]=(0.225457027395)/(o+1.)+(0.221493863079)
        ref[2,2,1,1]=(-1.66885547416)/(o+1.)+(-0.372038995202)
        ref[2,2,2,0]=(-1.42708510165)/(o+1.)+(0.410904476533)
        ref[2,2,2,1]=(0.352696956576)/(o+1.)+(-0.252899306452)
        ref[2,3,0,0]=(0.266365999523)/(o+1.)+(0.249791335977)
        ref[2,3,0,1]=(0.926084735451)/(o+1.)+(0.0271701662571)
        ref[2,3,1,0]=(-0.138787407751)/(o+1.)+(-0.652714809939)
        ref[2,3,1,1]=(-0.834750293031)/(o+1.)+(-0.112504360161)
        ref[2,3,2,0]=(-0.806210182586)/(o+1.)+(0.415200684382)
        ref[2,3,2,1]=(0.577899253552)/(o+1.)+(-0.913828206984)
        ref[2,4,0,0]=(1.38802720612)/(o+1.)+(0.755900031203)
        ref[2,4,0,1]=(-1.33634216788)/(o+1.)+(0.504253453293)
        ref[2,4,1,0]=(-1.13393506986)/(o+1.)+(0.195255119392)
        ref[2,4,1,1]=(-0.384732222354)/(o+1.)+(0.203237915028)
        ref[2,4,2,0]=(-1.18866097183)/(o+1.)+(-0.122726302784)
        ref[2,4,2,1]=(-1.41914128138)/(o+1.)+(-0.382918250045)
        ref[3,0,0,0]=(-1.3617379499)/(o+1.)+(0.916513859836)
        ref[3,0,0,1]=(-0.577580679368)/(o+1.)+(-0.580633018955)
        ref[3,0,1,0]=(-0.730926522369)/(o+1.)+(-0.50988617222)
        ref[3,0,1,1]=(0.852352706539)/(o+1.)+(-0.314072812402)
        ref[3,0,2,0]=(0.63914695576)/(o+1.)+(-0.155678014016)
        ref[3,0,2,1]=(-2.31555597527)/(o+1.)+(-0.593748666755)
        ref[3,1,0,0]=(-0.31308710102)/(o+1.)+(-0.011689493559)
        ref[3,1,0,1]=(0.565049631081)/(o+1.)+(-0.115943082793)
        ref[3,1,1,0]=(1.76264026827)/(o+1.)+(1.35490058502)
        ref[3,1,1,1]=(1.34557111025)/(o+1.)+(0.873578306883)
        ref[3,1,2,0]=(0.924587947935)/(o+1.)+(-0.626617402844)
        ref[3,1,2,1]=(-0.679695689354)/(o+1.)+(0.143800073503)
        ref[3,2,0,0]=(-0.408824291494)/(o+1.)+(-0.330341171766)
        ref[3,2,0,1]=(1.02728720579)/(o+1.)+(0.860379917667)
        ref[3,2,1,0]=(-1.99227170213)/(o+1.)+(-0.251611418656)
        ref[3,2,1,1]=(-0.844161339595)/(o+1.)+(0.159252406352)
        ref[3,2,2,0]=(1.52009831693)/(o+1.)+(-0.519116196235)
        ref[3,2,2,1]=(0.323553722724)/(o+1.)+(-1.02888651238)
        ref[3,3,0,0]=(-1.39647666034)/(o+1.)+(0.637724793483)
        ref[3,3,0,1]=(0.960901654854)/(o+1.)+(-0.00807626431577)
        ref[3,3,1,0]=(0.383998350003)/(o+1.)+(-0.154799534246)
        ref[3,3,1,1]=(-0.851062083214)/(o+1.)+(0.752100475729)
        ref[3,3,2,0]=(0.788418151505)/(o+1.)+(-0.614906659263)
        ref[3,3,2,1]=(-0.1028922667)/(o+1.)+(0.135563961629)
        ref[3,4,0,0]=(-0.540240088251)/(o+1.)+(-0.425382378277)
        ref[3,4,0,1]=(0.236730341461)/(o+1.)+(0.979828209623)
        ref[3,4,1,0]=(-0.9880898216)/(o+1.)+(-0.198536176202)
        ref[3,4,1,1]=(1.06221574228)/(o+1.)+(-0.46475456894)
        ref[3,4,2,0]=(-1.89471538439)/(o+1.)+(-0.0317829587581)
        ref[3,4,2,1]=(-1.20699948566)/(o+1.)+(0.907108895566)
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Function_rank0(self):
      """
      tests integral of rank 0 Symbol on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-0.107044842683)*x[0]**o+(-0.198407800146)*x[0]+(0.877472712926)*x[1]**o+(-0.647405831691)*x[1]
        ref=(0.770427870243)/(o+1.)+(-0.422906815918)
      else:
        s=(-0.559912240782)*x[0]**o+(0.766296134438)*x[0]+(-0.110980192077)*x[1]**o+(-0.608865520099)*x[1]+(0.672667086497)*x[2]**o+(0.334463167521)*x[2]
        ref=(0.00177465363795)/(o+1.)+(0.24594689093)
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Function_rank1(self):
      """
      tests integral of rank 1 Symbol on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.416213605972)*x[0]**o+(0.77813592218)*x[0]+(-0.222437793488)*x[1]**o+(-0.933738289486)*x[1]
        s[1]=(0.455257144475)*x[0]**o+(-0.622417334686)*x[0]+(0.806205896623)*x[1]**o+(0.675691766701)*x[1]
        ref[0]=(-0.638651399461)/(o+1.)+(-0.0778011836529)
        ref[1]=(1.2614630411)/(o+1.)+(0.0266372160075)
      else:
        s[0]=(0.753437228142)*x[0]**o+(0.148952810054)*x[0]+(0.179818865036)*x[1]**o+(0.490547213201)*x[1]+(0.977606414203)*x[2]**o+(0.0928058817324)*x[2]
        s[1]=(0.964988411956)*x[0]**o+(0.446937048611)*x[0]+(-0.110739634254)*x[1]**o+(0.906002899971)*x[1]+(0.666451027663)*x[2]**o+(0.270230684952)*x[2]
        ref[0]=(1.91086250738)/(o+1.)+(0.366152952493)
        ref[1]=(1.52069980537)/(o+1.)+(0.811585316767)
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Function_rank2(self):
      """
      tests integral of rank 2 Symbol on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.08214321783)*x[0]**o+(-0.496010136907)*x[0]+(-0.661161523248)*x[1]**o+(-0.151256978215)*x[1]
        s[0,1]=(0.00779835697637)*x[0]**o+(0.307130297185)*x[0]+(-0.111598029557)*x[1]**o+(-0.00186165192551)*x[1]
        s[0,2]=(0.0978324862172)*x[0]**o+(-0.746313762674)*x[0]+(0.519229413642)*x[1]**o+(0.892797139942)*x[1]
        s[0,3]=(-0.598407415713)*x[0]**o+(0.801307410865)*x[0]+(0.894609711877)*x[1]**o+(0.0520830645255)*x[1]
        s[0,4]=(0.580674315696)*x[0]**o+(-0.000690290928564)*x[0]+(0.909550857813)*x[1]**o+(-0.766950054968)*x[1]
        s[1,0]=(0.293745692233)*x[0]**o+(0.581206623889)*x[0]+(0.154848883067)*x[1]**o+(0.260519542891)*x[1]
        s[1,1]=(0.81822409326)*x[0]**o+(0.0527752269091)*x[0]+(0.960312253084)*x[1]**o+(-0.844575939421)*x[1]
        s[1,2]=(-0.186016521867)*x[0]**o+(0.316565783375)*x[0]+(-0.206256264607)*x[1]**o+(0.951167349262)*x[1]
        s[1,3]=(-0.355700637442)*x[0]**o+(-0.636455488757)*x[0]+(0.623605194008)*x[1]**o+(-0.0426220883099)*x[1]
        s[1,4]=(0.72832697443)*x[0]**o+(-0.349553513535)*x[0]+(-0.128283294734)*x[1]**o+(-0.280029190018)*x[1]
        s[2,0]=(0.634737331487)*x[0]**o+(-0.0784762897091)*x[0]+(0.49107451702)*x[1]**o+(-0.927830147754)*x[1]
        s[2,1]=(-0.561516427218)*x[0]**o+(0.414180445476)*x[0]+(-0.32846350728)*x[1]**o+(0.653302722231)*x[1]
        s[2,2]=(-0.285665357177)*x[0]**o+(-0.495353890909)*x[0]+(-0.300417232522)*x[1]**o+(0.828720486127)*x[1]
        s[2,3]=(0.582282364197)*x[0]**o+(-0.491365235361)*x[0]+(-0.481532775048)*x[1]**o+(0.843340014315)*x[1]
        s[2,4]=(0.467528444795)*x[0]**o+(-0.617430509987)*x[0]+(0.0370576618542)*x[1]**o+(0.124933927604)*x[1]
        s[3,0]=(0.76865308901)*x[0]**o+(0.270205155941)*x[0]+(0.239796830473)*x[1]**o+(-0.732593342574)*x[1]
        s[3,1]=(0.276346458614)*x[0]**o+(-0.637344640378)*x[0]+(-0.697338900523)*x[1]**o+(0.136084835992)*x[1]
        s[3,2]=(-0.932808156816)*x[0]**o+(0.296855273797)*x[0]+(-0.417934077535)*x[1]**o+(0.897857223334)*x[1]
        s[3,3]=(0.358813012298)*x[0]**o+(-0.421306401815)*x[0]+(0.682226516534)*x[1]**o+(-0.0533913429448)*x[1]
        s[3,4]=(0.27862707257)*x[0]**o+(-0.227499516484)*x[0]+(0.502409049994)*x[1]**o+(0.348218429657)*x[1]
        ref[0,0]=(-0.579018305418)/(o+1.)+(-0.323633557561)
        ref[0,1]=(-0.103799672581)/(o+1.)+(0.15263432263)
        ref[0,2]=(0.617061899859)/(o+1.)+(0.0732416886339)
        ref[0,3]=(0.296202296164)/(o+1.)+(0.426695237695)
        ref[0,4]=(1.49022517351)/(o+1.)+(-0.383820172948)
        ref[1,0]=(0.4485945753)/(o+1.)+(0.42086308339)
        ref[1,1]=(1.77853634634)/(o+1.)+(-0.395900356256)
        ref[1,2]=(-0.392272786474)/(o+1.)+(0.633866566319)
        ref[1,3]=(0.267904556566)/(o+1.)+(-0.339538788533)
        ref[1,4]=(0.600043679696)/(o+1.)+(-0.314791351776)
        ref[2,0]=(1.12581184851)/(o+1.)+(-0.503153218732)
        ref[2,1]=(-0.889979934498)/(o+1.)+(0.533741583854)
        ref[2,2]=(-0.586082589699)/(o+1.)+(0.166683297609)
        ref[2,3]=(0.100749589149)/(o+1.)+(0.175987389477)
        ref[2,4]=(0.504586106649)/(o+1.)+(-0.246248291192)
        ref[3,0]=(1.00844991948)/(o+1.)+(-0.231194093316)
        ref[3,1]=(-0.420992441909)/(o+1.)+(-0.250629902193)
        ref[3,2]=(-1.35074223435)/(o+1.)+(0.597356248566)
        ref[3,3]=(1.04103952883)/(o+1.)+(-0.23734887238)
        ref[3,4]=(0.781036122564)/(o+1.)+(0.0603594565866)
      else:
        s[0,0]=(-0.941295734032)*x[0]**o+(0.396841358423)*x[0]+(-0.490021992176)*x[1]**o+(-0.346405280728)*x[1]+(-0.201846160921)*x[2]**o+(0.20749764579)*x[2]
        s[0,1]=(-0.88981448497)*x[0]**o+(-0.884955504659)*x[0]+(0.182259548742)*x[1]**o+(-0.235489618403)*x[1]+(-0.977189329039)*x[2]**o+(-0.514950614838)*x[2]
        s[0,2]=(0.328187150969)*x[0]**o+(-0.448497961254)*x[0]+(0.472389791923)*x[1]**o+(-0.624930304822)*x[1]+(0.265474988322)*x[2]**o+(-0.0214969683756)*x[2]
        s[0,3]=(-0.735757404485)*x[0]**o+(-0.92658492028)*x[0]+(0.684533158897)*x[1]**o+(-0.865066520203)*x[1]+(-0.190890639018)*x[2]**o+(-0.529642573907)*x[2]
        s[0,4]=(0.955420842735)*x[0]**o+(0.773074765628)*x[0]+(-0.382656468864)*x[1]**o+(0.47181739927)*x[1]+(0.873841536673)*x[2]**o+(-0.526372620067)*x[2]
        s[1,0]=(0.770067221954)*x[0]**o+(-0.406438793272)*x[0]+(0.51351865241)*x[1]**o+(-0.856834133418)*x[1]+(0.589461089026)*x[2]**o+(-0.141812408947)*x[2]
        s[1,1]=(-0.812514809415)*x[0]**o+(-0.456460678755)*x[0]+(0.430628764669)*x[1]**o+(0.262068556418)*x[1]+(0.597424763719)*x[2]**o+(-0.157908736594)*x[2]
        s[1,2]=(-0.46727482012)*x[0]**o+(-0.744512472884)*x[0]+(-0.365664650476)*x[1]**o+(-0.361046498637)*x[1]+(-0.166284258648)*x[2]**o+(0.528262791587)*x[2]
        s[1,3]=(-0.273755634801)*x[0]**o+(-0.15873969342)*x[0]+(-0.368357879665)*x[1]**o+(0.283273650468)*x[1]+(-0.0175031061849)*x[2]**o+(-0.0417868805286)*x[2]
        s[1,4]=(0.349815667052)*x[0]**o+(-0.175629838767)*x[0]+(0.272305468439)*x[1]**o+(-0.750728619331)*x[1]+(0.0723037064016)*x[2]**o+(0.911924754086)*x[2]
        s[2,0]=(0.834136592552)*x[0]**o+(0.227306622837)*x[0]+(-0.468357820454)*x[1]**o+(0.0429839240965)*x[1]+(0.397233264579)*x[2]**o+(0.645297775174)*x[2]
        s[2,1]=(-0.420265217156)*x[0]**o+(-0.762906499224)*x[0]+(0.16960694356)*x[1]**o+(0.381251517238)*x[1]+(-0.740637261618)*x[2]**o+(-0.437283161876)*x[2]
        s[2,2]=(-0.957535003492)*x[0]**o+(0.546534458865)*x[0]+(0.10634355782)*x[1]**o+(0.0575530053655)*x[1]+(0.395304821296)*x[2]**o+(0.0507237509151)*x[2]
        s[2,3]=(0.130545158576)*x[0]**o+(-0.297688721316)*x[0]+(-0.193136907135)*x[1]**o+(-0.530687107912)*x[1]+(0.891112852449)*x[2]**o+(0.89025257856)*x[2]
        s[2,4]=(-0.452227707094)*x[0]**o+(0.518745990389)*x[0]+(-0.848908958687)*x[1]**o+(-0.984222753382)*x[1]+(-0.725703746452)*x[2]**o+(0.29370062408)*x[2]
        s[3,0]=(0.451818718553)*x[0]**o+(0.15228149344)*x[0]+(0.309329014013)*x[1]**o+(-0.629074550954)*x[1]+(0.925898897131)*x[2]**o+(-0.530392928354)*x[2]
        s[3,1]=(0.48661045622)*x[0]**o+(0.362115939707)*x[0]+(0.461789600557)*x[1]**o+(-0.0265394801756)*x[1]+(-0.52060582127)*x[2]**o+(0.847046142749)*x[2]
        s[3,2]=(0.356328974486)*x[0]**o+(0.735492369055)*x[0]+(0.833634465835)*x[1]**o+(-0.603533125221)*x[1]+(-0.799865132292)*x[2]**o+(0.255351535539)*x[2]
        s[3,3]=(0.821371453867)*x[0]**o+(0.360956876043)*x[0]+(0.0191507582216)*x[1]**o+(-0.995259844736)*x[1]+(-0.00388518722366)*x[2]**o+(-0.0360171649464)*x[2]
        s[3,4]=(-0.248806545065)*x[0]**o+(-0.598745625081)*x[0]+(0.722047538053)*x[1]**o+(-0.840877899002)*x[1]+(0.920023026949)*x[2]**o+(0.503521861458)*x[2]
        ref[0,0]=(-1.63316388713)/(o+1.)+(0.128966861742)
        ref[0,1]=(-1.68474426527)/(o+1.)+(-0.81769786895)
        ref[0,2]=(1.06605193121)/(o+1.)+(-0.547462617226)
        ref[0,3]=(-0.242114884606)/(o+1.)+(-1.16064700719)
        ref[0,4]=(1.44660591054)/(o+1.)+(0.359259772415)
        ref[1,0]=(1.87304696339)/(o+1.)+(-0.702542667819)
        ref[1,1]=(0.215538718973)/(o+1.)+(-0.176150429465)
        ref[1,2]=(-0.999223729244)/(o+1.)+(-0.288648089967)
        ref[1,3]=(-0.659616620651)/(o+1.)+(0.04137353826)
        ref[1,4]=(0.694424841892)/(o+1.)+(-0.00721685200611)
        ref[2,0]=(0.763012036677)/(o+1.)+(0.457794161054)
        ref[2,1]=(-0.991295535214)/(o+1.)+(-0.409469071931)
        ref[2,2]=(-0.455886624375)/(o+1.)+(0.327405607573)
        ref[2,3]=(0.82852110389)/(o+1.)+(0.030938374666)
        ref[2,4]=(-2.02684041223)/(o+1.)+(-0.0858880694563)
        ref[3,0]=(1.6870466297)/(o+1.)+(-0.503592992934)
        ref[3,1]=(0.427794235507)/(o+1.)+(0.59131130114)
        ref[3,2]=(0.39009830803)/(o+1.)+(0.193655389686)
        ref[3,3]=(0.836637024865)/(o+1.)+(-0.33516006682)
        ref[3,4]=(1.39326401994)/(o+1.)+(-0.468050831312)
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Function_rank3(self):
      """
      tests integral of rank 3 Symbol on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.944773955793)*x[0]**o+(-0.662996681032)*x[0]+(-0.442867713759)*x[1]**o+(-0.229023301726)*x[1]
        s[0,0,1]=(0.0407144183428)*x[0]**o+(-0.669891322439)*x[0]+(0.920328407938)*x[1]**o+(-0.320681600926)*x[1]
        s[0,1,0]=(0.179693170721)*x[0]**o+(-0.671664515028)*x[0]+(0.525108213743)*x[1]**o+(0.310882938487)*x[1]
        s[0,1,1]=(-0.0540671676637)*x[0]**o+(0.000853108264254)*x[0]+(-0.370081882537)*x[1]**o+(-0.138484250063)*x[1]
        s[1,0,0]=(0.631472269828)*x[0]**o+(-0.294848092138)*x[0]+(0.0730087097944)*x[1]**o+(0.0292051228565)*x[1]
        s[1,0,1]=(-0.576009492093)*x[0]**o+(-0.228105833611)*x[0]+(-0.0563734559287)*x[1]**o+(-0.242583876037)*x[1]
        s[1,1,0]=(-0.597734903158)*x[0]**o+(0.960078413053)*x[0]+(0.881951380528)*x[1]**o+(-0.186121672274)*x[1]
        s[1,1,1]=(-0.117005971726)*x[0]**o+(-0.809886380446)*x[0]+(-0.981092676193)*x[1]**o+(0.0636030759105)*x[1]
        s[2,0,0]=(-0.197553649616)*x[0]**o+(-0.820287165629)*x[0]+(0.359670409851)*x[1]**o+(-0.861222386581)*x[1]
        s[2,0,1]=(0.968998274457)*x[0]**o+(0.376230063695)*x[0]+(0.283097885679)*x[1]**o+(-0.128262765246)*x[1]
        s[2,1,0]=(0.0310410423851)*x[0]**o+(0.611929570715)*x[0]+(-0.972311035606)*x[1]**o+(-0.568277782449)*x[1]
        s[2,1,1]=(0.95074765381)*x[0]**o+(0.338991372672)*x[0]+(0.264103717561)*x[1]**o+(0.370834284282)*x[1]
        s[3,0,0]=(-0.664867197259)*x[0]**o+(0.917684307761)*x[0]+(-0.319774527149)*x[1]**o+(0.432915185753)*x[1]
        s[3,0,1]=(-0.162944024583)*x[0]**o+(-0.123907346782)*x[0]+(0.325356901629)*x[1]**o+(0.90249028492)*x[1]
        s[3,1,0]=(-0.135439910119)*x[0]**o+(0.920226918882)*x[0]+(0.112667508952)*x[1]**o+(0.710942378416)*x[1]
        s[3,1,1]=(-0.370025988485)*x[0]**o+(0.146841174972)*x[0]+(-0.209033207026)*x[1]**o+(0.270439136519)*x[1]
        s[4,0,0]=(0.724119312565)*x[0]**o+(0.726636721509)*x[0]+(-0.643509558883)*x[1]**o+(-0.544447102654)*x[1]
        s[4,0,1]=(-0.563641108028)*x[0]**o+(-0.320916186803)*x[0]+(0.935527371187)*x[1]**o+(0.535917271795)*x[1]
        s[4,1,0]=(-0.482028335236)*x[0]**o+(-0.510759210235)*x[0]+(-0.105477148218)*x[1]**o+(0.54069501931)*x[1]
        s[4,1,1]=(0.305620947599)*x[0]**o+(-0.724738374933)*x[0]+(0.470881233144)*x[1]**o+(-0.705410563798)*x[1]
        s[5,0,0]=(0.168173718235)*x[0]**o+(0.578831386242)*x[0]+(-0.869711732793)*x[1]**o+(-0.176143888818)*x[1]
        s[5,0,1]=(-0.228160489841)*x[0]**o+(-0.0297036971933)*x[0]+(0.391702396499)*x[1]**o+(0.875713079041)*x[1]
        s[5,1,0]=(-0.910154283353)*x[0]**o+(-0.0651085103088)*x[0]+(0.0884987382756)*x[1]**o+(-0.937409873275)*x[1]
        s[5,1,1]=(0.41106472762)*x[0]**o+(-0.801661249269)*x[0]+(0.201137556319)*x[1]**o+(-0.665423718838)*x[1]
        ref[0,0,0]=(-1.38764166955)/(o+1.)+(-0.446009991379)
        ref[0,0,1]=(0.961042826281)/(o+1.)+(-0.495286461682)
        ref[0,1,0]=(0.704801384464)/(o+1.)+(-0.180390788271)
        ref[0,1,1]=(-0.424149050201)/(o+1.)+(-0.0688155708996)
        ref[1,0,0]=(0.704480979622)/(o+1.)+(-0.132821484641)
        ref[1,0,1]=(-0.632382948021)/(o+1.)+(-0.235344854824)
        ref[1,1,0]=(0.28421647737)/(o+1.)+(0.386978370389)
        ref[1,1,1]=(-1.09809864792)/(o+1.)+(-0.373141652268)
        ref[2,0,0]=(0.162116760235)/(o+1.)+(-0.840754776105)
        ref[2,0,1]=(1.25209616014)/(o+1.)+(0.123983649224)
        ref[2,1,0]=(-0.941269993221)/(o+1.)+(0.0218258941331)
        ref[2,1,1]=(1.21485137137)/(o+1.)+(0.354912828477)
        ref[3,0,0]=(-0.984641724408)/(o+1.)+(0.675299746757)
        ref[3,0,1]=(0.162412877046)/(o+1.)+(0.389291469069)
        ref[3,1,0]=(-0.0227724011669)/(o+1.)+(0.815584648649)
        ref[3,1,1]=(-0.579059195511)/(o+1.)+(0.208640155746)
        ref[4,0,0]=(0.0806097536818)/(o+1.)+(0.0910948094271)
        ref[4,0,1]=(0.371886263159)/(o+1.)+(0.107500542496)
        ref[4,1,0]=(-0.587505483453)/(o+1.)+(0.0149679045376)
        ref[4,1,1]=(0.776502180743)/(o+1.)+(-0.715074469366)
        ref[5,0,0]=(-0.701538014558)/(o+1.)+(0.201343748712)
        ref[5,0,1]=(0.163541906658)/(o+1.)+(0.423004690924)
        ref[5,1,0]=(-0.821655545078)/(o+1.)+(-0.501259191792)
        ref[5,1,1]=(0.612202283939)/(o+1.)+(-0.733542484054)
      else:
        s[0,0,0]=(-0.0829784527698)*x[0]**o+(-0.332549632616)*x[0]+(0.255962043751)*x[1]**o+(-0.176352635053)*x[1]+(-0.954055133743)*x[2]**o+(-0.898668627164)*x[2]
        s[0,0,1]=(-0.0566639977041)*x[0]**o+(0.64899823634)*x[0]+(0.339703741475)*x[1]**o+(-0.754613713569)*x[1]+(0.379536135428)*x[2]**o+(0.118057489576)*x[2]
        s[0,1,0]=(-0.718453260796)*x[0]**o+(0.997156187689)*x[0]+(0.914514642799)*x[1]**o+(-0.633873909376)*x[1]+(-0.485691739694)*x[2]**o+(0.415370908143)*x[2]
        s[0,1,1]=(0.553256681553)*x[0]**o+(-0.191413319548)*x[0]+(0.800894762679)*x[1]**o+(0.919882584486)*x[1]+(0.127165880997)*x[2]**o+(-0.690488492514)*x[2]
        s[1,0,0]=(-0.142765560936)*x[0]**o+(-0.303407652797)*x[0]+(0.989394601479)*x[1]**o+(-0.484741465949)*x[1]+(0.732648062756)*x[2]**o+(-0.678857629867)*x[2]
        s[1,0,1]=(0.288139139594)*x[0]**o+(-0.534820162236)*x[0]+(0.554980676789)*x[1]**o+(-0.917630291921)*x[1]+(0.170042991043)*x[2]**o+(0.826809263768)*x[2]
        s[1,1,0]=(-0.901850450639)*x[0]**o+(-0.0365789634899)*x[0]+(0.0622336448434)*x[1]**o+(0.22005965603)*x[1]+(0.857183927574)*x[2]**o+(0.254453636804)*x[2]
        s[1,1,1]=(-0.888020161965)*x[0]**o+(-0.0741224453822)*x[0]+(0.887224038781)*x[1]**o+(0.742137909151)*x[1]+(-0.587100789782)*x[2]**o+(-0.928415179888)*x[2]
        s[2,0,0]=(0.00216356197373)*x[0]**o+(0.248793770338)*x[0]+(0.518030493147)*x[1]**o+(-0.508299580849)*x[1]+(-0.0290711721801)*x[2]**o+(0.662305993163)*x[2]
        s[2,0,1]=(0.924293736923)*x[0]**o+(0.218836928692)*x[0]+(-0.270314297479)*x[1]**o+(0.20290032209)*x[1]+(-0.87536943379)*x[2]**o+(-0.864192540105)*x[2]
        s[2,1,0]=(0.416159016379)*x[0]**o+(-0.30257442476)*x[0]+(-0.257298173268)*x[1]**o+(-0.398564079155)*x[1]+(-0.0699018670952)*x[2]**o+(-0.540145396091)*x[2]
        s[2,1,1]=(0.82076420765)*x[0]**o+(-0.265319227281)*x[0]+(-0.156971036756)*x[1]**o+(-0.468527020278)*x[1]+(0.2455572117)*x[2]**o+(0.237918192218)*x[2]
        s[3,0,0]=(-0.645207425303)*x[0]**o+(0.992013339436)*x[0]+(-0.814115520055)*x[1]**o+(-0.0863699557395)*x[1]+(0.356684159665)*x[2]**o+(0.0215161017879)*x[2]
        s[3,0,1]=(0.429124334865)*x[0]**o+(-0.516632695494)*x[0]+(0.276076705271)*x[1]**o+(0.73233754297)*x[1]+(-0.499960919138)*x[2]**o+(0.927448433933)*x[2]
        s[3,1,0]=(0.105016655639)*x[0]**o+(0.627563943644)*x[0]+(0.0134384788636)*x[1]**o+(-0.491675197932)*x[1]+(0.850898525327)*x[2]**o+(-0.153767354797)*x[2]
        s[3,1,1]=(0.0927473537694)*x[0]**o+(-0.164202910181)*x[0]+(-0.246744412752)*x[1]**o+(0.812782310771)*x[1]+(0.452025251957)*x[2]**o+(-0.46155534584)*x[2]
        s[4,0,0]=(0.466686843553)*x[0]**o+(-0.454360335871)*x[0]+(0.600983402349)*x[1]**o+(-0.248407743104)*x[1]+(-0.114458429866)*x[2]**o+(0.363120759629)*x[2]
        s[4,0,1]=(0.108248019353)*x[0]**o+(-0.386567024916)*x[0]+(0.589911190112)*x[1]**o+(0.974355188979)*x[1]+(0.956434046018)*x[2]**o+(-0.750308948178)*x[2]
        s[4,1,0]=(-0.0575495701591)*x[0]**o+(-0.297079422559)*x[0]+(0.173709916352)*x[1]**o+(-0.703203763304)*x[1]+(-0.206920064792)*x[2]**o+(-0.566180018312)*x[2]
        s[4,1,1]=(0.752722443401)*x[0]**o+(0.287487922131)*x[0]+(-0.253690778509)*x[1]**o+(0.158399655258)*x[1]+(0.365133322462)*x[2]**o+(-0.765340889542)*x[2]
        s[5,0,0]=(-0.249224479124)*x[0]**o+(-0.81760956491)*x[0]+(0.664454285698)*x[1]**o+(-0.111438607721)*x[1]+(-0.34058205464)*x[2]**o+(-0.604036230847)*x[2]
        s[5,0,1]=(-0.0489505541715)*x[0]**o+(-0.216719586033)*x[0]+(0.862292178064)*x[1]**o+(-0.978934839395)*x[1]+(-0.229118015068)*x[2]**o+(-0.220547177874)*x[2]
        s[5,1,0]=(-0.200117801874)*x[0]**o+(0.826116119716)*x[0]+(0.180058706489)*x[1]**o+(0.938844014751)*x[1]+(0.232853505918)*x[2]**o+(-0.0718472890928)*x[2]
        s[5,1,1]=(0.335820727851)*x[0]**o+(-0.30183416972)*x[0]+(-0.69421482762)*x[1]**o+(0.105894103212)*x[1]+(0.620400009549)*x[2]**o+(0.970029758381)*x[2]
        ref[0,0,0]=(-0.781071542761)/(o+1.)+(-0.703785447417)
        ref[0,0,1]=(0.662575879198)/(o+1.)+(0.00622100617352)
        ref[0,1,0]=(-0.289630357691)/(o+1.)+(0.389326593228)
        ref[0,1,1]=(1.48131732523)/(o+1.)+(0.0189903862116)
        ref[1,0,0]=(1.5792771033)/(o+1.)+(-0.733503374307)
        ref[1,0,1]=(1.01316280743)/(o+1.)+(-0.312820595194)
        ref[1,1,0]=(0.0175671217784)/(o+1.)+(0.218967164672)
        ref[1,1,1]=(-0.587896912967)/(o+1.)+(-0.13019985806)
        ref[2,0,0]=(0.49112288294)/(o+1.)+(0.201400091326)
        ref[2,0,1]=(-0.221389994346)/(o+1.)+(-0.221227644661)
        ref[2,1,0]=(0.0889589760167)/(o+1.)+(-0.620641950003)
        ref[2,1,1]=(0.909350382595)/(o+1.)+(-0.24796402767)
        ref[3,0,0]=(-1.10263878569)/(o+1.)+(0.463579742742)
        ref[3,0,1]=(0.205240120999)/(o+1.)+(0.571576640705)
        ref[3,1,0]=(0.96935365983)/(o+1.)+(-0.00893930454231)
        ref[3,1,1]=(0.298028192975)/(o+1.)+(0.0935120273748)
        ref[4,0,0]=(0.953211816036)/(o+1.)+(-0.169823659673)
        ref[4,0,1]=(1.65459325548)/(o+1.)+(-0.0812603920577)
        ref[4,1,0]=(-0.0907597185993)/(o+1.)+(-0.783231602088)
        ref[4,1,1]=(0.864164987355)/(o+1.)+(-0.159726656077)
        ref[5,0,0]=(0.0746477519342)/(o+1.)+(-0.766542201739)
        ref[5,0,1]=(0.584223608825)/(o+1.)+(-0.708100801651)
        ref[5,1,0]=(0.212794410532)/(o+1.)+(0.846556422687)
        ref[5,1,1]=(0.262005909781)/(o+1.)+(0.387044845936)
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunction_fromSymbol_Function_rank4(self):
      """
      tests integral of rank 4 Symbol on the Function

      assumptions: Function(self.domain) exists
                   self.domain supports integral on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      w=Function(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.64587181131)*x[0]**o+(-0.142518178492)*x[0]+(-0.399846110498)*x[1]**o+(0.00236392286301)*x[1]
        s[0,0,0,1]=(0.298109366098)*x[0]**o+(-0.0843450895271)*x[0]+(0.574794599006)*x[1]**o+(-0.107008590623)*x[1]
        s[0,0,1,0]=(-0.424486704098)*x[0]**o+(-0.382352426027)*x[0]+(0.275387919625)*x[1]**o+(-0.161015391255)*x[1]
        s[0,0,1,1]=(0.643084919048)*x[0]**o+(0.44303782474)*x[0]+(0.17010706601)*x[1]**o+(-0.160095051974)*x[1]
        s[0,0,2,0]=(0.255268276945)*x[0]**o+(-0.867088236584)*x[0]+(-0.809452452666)*x[1]**o+(-0.376237703808)*x[1]
        s[0,0,2,1]=(-0.773368404022)*x[0]**o+(-0.655491257176)*x[0]+(-0.256178554483)*x[1]**o+(0.582354235979)*x[1]
        s[0,1,0,0]=(0.312387735876)*x[0]**o+(0.36653787868)*x[0]+(-0.160583709945)*x[1]**o+(-0.791133941857)*x[1]
        s[0,1,0,1]=(-0.57693493814)*x[0]**o+(-0.862135922856)*x[0]+(0.0439301419063)*x[1]**o+(0.959289798443)*x[1]
        s[0,1,1,0]=(0.121311324776)*x[0]**o+(0.907585047473)*x[0]+(-0.923686957239)*x[1]**o+(-0.652706978591)*x[1]
        s[0,1,1,1]=(0.682901593615)*x[0]**o+(-0.306481093391)*x[0]+(-0.35714675383)*x[1]**o+(0.500943467097)*x[1]
        s[0,1,2,0]=(0.647130385973)*x[0]**o+(0.873804224811)*x[0]+(0.78779813495)*x[1]**o+(0.430789257821)*x[1]
        s[0,1,2,1]=(0.135833683749)*x[0]**o+(0.32862510689)*x[0]+(-0.48350127573)*x[1]**o+(-0.649354230648)*x[1]
        s[0,2,0,0]=(-0.641045806017)*x[0]**o+(-0.654315036977)*x[0]+(-0.729951508044)*x[1]**o+(0.766934507787)*x[1]
        s[0,2,0,1]=(0.481734616023)*x[0]**o+(-0.687904467365)*x[0]+(0.630779635862)*x[1]**o+(-0.982134985324)*x[1]
        s[0,2,1,0]=(-0.0488969750979)*x[0]**o+(-0.804550194421)*x[0]+(-0.721206215475)*x[1]**o+(0.184754632486)*x[1]
        s[0,2,1,1]=(-0.0554773461175)*x[0]**o+(0.501447670577)*x[0]+(0.214749897505)*x[1]**o+(0.912271898356)*x[1]
        s[0,2,2,0]=(0.0902819474814)*x[0]**o+(0.182092397318)*x[0]+(-0.48175183483)*x[1]**o+(-0.598040724808)*x[1]
        s[0,2,2,1]=(0.720795079983)*x[0]**o+(-0.339928403247)*x[0]+(-0.762363891559)*x[1]**o+(0.460915902605)*x[1]
        s[0,3,0,0]=(0.508573641682)*x[0]**o+(-0.015037165373)*x[0]+(0.448986097944)*x[1]**o+(0.471102721761)*x[1]
        s[0,3,0,1]=(-0.341905079065)*x[0]**o+(-0.95312476241)*x[0]+(-0.749402955548)*x[1]**o+(-0.372596238803)*x[1]
        s[0,3,1,0]=(-0.0690403122223)*x[0]**o+(-0.08921421318)*x[0]+(-0.380821740415)*x[1]**o+(-0.599974433304)*x[1]
        s[0,3,1,1]=(-0.50179318754)*x[0]**o+(0.355355851326)*x[0]+(0.721120108213)*x[1]**o+(0.454667741643)*x[1]
        s[0,3,2,0]=(0.213191653894)*x[0]**o+(-0.637815219816)*x[0]+(0.0628021542224)*x[1]**o+(-0.284841867085)*x[1]
        s[0,3,2,1]=(0.226011558647)*x[0]**o+(0.926633205695)*x[0]+(-0.801045292364)*x[1]**o+(0.84320696071)*x[1]
        s[0,4,0,0]=(-0.925639600998)*x[0]**o+(-0.743975200606)*x[0]+(0.950987915324)*x[1]**o+(-0.919549720538)*x[1]
        s[0,4,0,1]=(0.295152910157)*x[0]**o+(-0.155400545856)*x[0]+(-0.888657028463)*x[1]**o+(-0.0245586756163)*x[1]
        s[0,4,1,0]=(0.659416651507)*x[0]**o+(-0.0687605790427)*x[0]+(0.287026029448)*x[1]**o+(0.749704220615)*x[1]
        s[0,4,1,1]=(0.195399326633)*x[0]**o+(-0.690030508171)*x[0]+(0.812925291301)*x[1]**o+(-0.288219851462)*x[1]
        s[0,4,2,0]=(0.92210509534)*x[0]**o+(-0.746377740152)*x[0]+(-0.263846201131)*x[1]**o+(0.241927075102)*x[1]
        s[0,4,2,1]=(-0.342776236669)*x[0]**o+(-0.678319456068)*x[0]+(0.533446356713)*x[1]**o+(0.893285310119)*x[1]
        s[1,0,0,0]=(-0.35370685183)*x[0]**o+(-0.649199740924)*x[0]+(-0.284557848052)*x[1]**o+(-0.108918514336)*x[1]
        s[1,0,0,1]=(0.435799676535)*x[0]**o+(-0.560606926167)*x[0]+(0.422473364618)*x[1]**o+(-0.644113034355)*x[1]
        s[1,0,1,0]=(0.371384490035)*x[0]**o+(0.468745463643)*x[0]+(0.824650091185)*x[1]**o+(0.779212641032)*x[1]
        s[1,0,1,1]=(0.566680148615)*x[0]**o+(0.70499851212)*x[0]+(-0.622667334132)*x[1]**o+(0.0793283623173)*x[1]
        s[1,0,2,0]=(-0.137422675839)*x[0]**o+(-0.0828536384824)*x[0]+(0.34029178349)*x[1]**o+(-0.572205817396)*x[1]
        s[1,0,2,1]=(0.849275927844)*x[0]**o+(0.588676957111)*x[0]+(-0.351435931217)*x[1]**o+(-0.985192646644)*x[1]
        s[1,1,0,0]=(-0.832427042757)*x[0]**o+(0.511670148283)*x[0]+(-0.225009791535)*x[1]**o+(-0.726486541188)*x[1]
        s[1,1,0,1]=(-0.370148483489)*x[0]**o+(0.0364804235508)*x[0]+(-0.740077305856)*x[1]**o+(0.123450524426)*x[1]
        s[1,1,1,0]=(0.989855829356)*x[0]**o+(-0.183176166338)*x[0]+(0.0388003238684)*x[1]**o+(-0.0395036587674)*x[1]
        s[1,1,1,1]=(-0.775089474977)*x[0]**o+(-0.976089661518)*x[0]+(0.387965308645)*x[1]**o+(0.712155002639)*x[1]
        s[1,1,2,0]=(0.86011220616)*x[0]**o+(-0.95431213868)*x[0]+(-0.495540857845)*x[1]**o+(-0.701111767974)*x[1]
        s[1,1,2,1]=(0.827371223575)*x[0]**o+(-0.650031455862)*x[0]+(-0.0269816386714)*x[1]**o+(-0.490304255652)*x[1]
        s[1,2,0,0]=(-0.718249056807)*x[0]**o+(-0.812216925478)*x[0]+(0.358363619384)*x[1]**o+(-0.555431408236)*x[1]
        s[1,2,0,1]=(0.502681744448)*x[0]**o+(0.568656095603)*x[0]+(-0.642171078627)*x[1]**o+(-0.678715038904)*x[1]
        s[1,2,1,0]=(-0.321002503528)*x[0]**o+(0.399915822381)*x[0]+(0.378527801988)*x[1]**o+(0.261422806614)*x[1]
        s[1,2,1,1]=(-0.296716183029)*x[0]**o+(0.497650651416)*x[0]+(-0.386922791311)*x[1]**o+(-0.91901564657)*x[1]
        s[1,2,2,0]=(-0.828712534186)*x[0]**o+(-0.0114777410069)*x[0]+(-0.142857241422)*x[1]**o+(0.527573020984)*x[1]
        s[1,2,2,1]=(0.341639667906)*x[0]**o+(0.773780839708)*x[0]+(0.625113762311)*x[1]**o+(0.700528961096)*x[1]
        s[1,3,0,0]=(0.763866858532)*x[0]**o+(0.934384862727)*x[0]+(-0.192635958925)*x[1]**o+(-0.531023677701)*x[1]
        s[1,3,0,1]=(-0.559232654796)*x[0]**o+(-0.381248359127)*x[0]+(0.042953808137)*x[1]**o+(-0.0258385267166)*x[1]
        s[1,3,1,0]=(-0.596069058223)*x[0]**o+(0.611041390676)*x[0]+(0.320050026897)*x[1]**o+(0.31950524284)*x[1]
        s[1,3,1,1]=(0.874401923132)*x[0]**o+(0.995518258803)*x[0]+(-0.535120262939)*x[1]**o+(0.160955202392)*x[1]
        s[1,3,2,0]=(0.352942439272)*x[0]**o+(-0.198121930351)*x[0]+(0.458180780997)*x[1]**o+(-0.415159831726)*x[1]
        s[1,3,2,1]=(-0.511099937481)*x[0]**o+(0.297820678198)*x[0]+(0.908702936015)*x[1]**o+(0.965700845817)*x[1]
        s[1,4,0,0]=(0.484158989021)*x[0]**o+(-0.339968620521)*x[0]+(-0.213631360058)*x[1]**o+(0.0279496812648)*x[1]
        s[1,4,0,1]=(-0.217367899821)*x[0]**o+(0.433458086428)*x[0]+(0.244095485621)*x[1]**o+(-0.210532522829)*x[1]
        s[1,4,1,0]=(-0.254889249994)*x[0]**o+(-0.61248326904)*x[0]+(0.372253508249)*x[1]**o+(-0.642709327921)*x[1]
        s[1,4,1,1]=(0.880474654934)*x[0]**o+(0.68839232824)*x[0]+(0.189353506343)*x[1]**o+(-0.880653838654)*x[1]
        s[1,4,2,0]=(0.894790715592)*x[0]**o+(-0.0486173810442)*x[0]+(-0.246550765358)*x[1]**o+(-0.343955068452)*x[1]
        s[1,4,2,1]=(-0.801075573104)*x[0]**o+(-0.749933700542)*x[0]+(0.527976119218)*x[1]**o+(-0.671158980138)*x[1]
        s[2,0,0,0]=(0.114632100765)*x[0]**o+(0.61717357379)*x[0]+(-0.0549019501391)*x[1]**o+(-0.749508575346)*x[1]
        s[2,0,0,1]=(-0.130970404194)*x[0]**o+(0.707199821591)*x[0]+(-0.903645272692)*x[1]**o+(-0.0334328361989)*x[1]
        s[2,0,1,0]=(-0.715712763894)*x[0]**o+(-0.675427980461)*x[0]+(-0.366134531475)*x[1]**o+(0.201815564551)*x[1]
        s[2,0,1,1]=(-0.269870188604)*x[0]**o+(-0.147598844928)*x[0]+(0.677047514973)*x[1]**o+(-0.675438319339)*x[1]
        s[2,0,2,0]=(0.212062724301)*x[0]**o+(-0.0250868236126)*x[0]+(-0.100922604124)*x[1]**o+(0.427937448863)*x[1]
        s[2,0,2,1]=(-0.666239860886)*x[0]**o+(0.438278520576)*x[0]+(0.544120816825)*x[1]**o+(-0.473903266225)*x[1]
        s[2,1,0,0]=(-0.361166717507)*x[0]**o+(0.901751988241)*x[0]+(0.638709648231)*x[1]**o+(-0.235793145944)*x[1]
        s[2,1,0,1]=(-0.11628481466)*x[0]**o+(-0.0851943604844)*x[0]+(0.832299993845)*x[1]**o+(-0.619236617136)*x[1]
        s[2,1,1,0]=(-0.960053497178)*x[0]**o+(-0.455025261633)*x[0]+(-0.701715648299)*x[1]**o+(0.728639782857)*x[1]
        s[2,1,1,1]=(-0.533289133278)*x[0]**o+(-0.370102308202)*x[0]+(0.99106398096)*x[1]**o+(-0.0538096992941)*x[1]
        s[2,1,2,0]=(0.224553214823)*x[0]**o+(-0.500053815427)*x[0]+(-0.0704009106671)*x[1]**o+(0.0488366166495)*x[1]
        s[2,1,2,1]=(0.337180739675)*x[0]**o+(-0.981874806959)*x[0]+(-0.731568712654)*x[1]**o+(0.0847072795393)*x[1]
        s[2,2,0,0]=(-0.222325355327)*x[0]**o+(-0.276984511347)*x[0]+(-0.948381537292)*x[1]**o+(0.766624524385)*x[1]
        s[2,2,0,1]=(0.938320523187)*x[0]**o+(0.808908551771)*x[0]+(0.765330540739)*x[1]**o+(0.41183946621)*x[1]
        s[2,2,1,0]=(-0.356223597296)*x[0]**o+(0.898624256746)*x[0]+(0.491456887622)*x[1]**o+(0.454642872239)*x[1]
        s[2,2,1,1]=(0.70662625865)*x[0]**o+(0.0268161060988)*x[0]+(-0.17883477863)*x[1]**o+(-0.379062708108)*x[1]
        s[2,2,2,0]=(0.405231213751)*x[0]**o+(-0.339541044657)*x[0]+(0.92369283669)*x[1]**o+(-0.521296842329)*x[1]
        s[2,2,2,1]=(0.371621085625)*x[0]**o+(-0.277933239024)*x[0]+(0.99545384432)*x[1]**o+(-0.458904147226)*x[1]
        s[2,3,0,0]=(-0.978371890906)*x[0]**o+(-0.220612890504)*x[0]+(0.485724985276)*x[1]**o+(0.566941748451)*x[1]
        s[2,3,0,1]=(-0.784455960641)*x[0]**o+(0.488256734495)*x[0]+(-0.85203669445)*x[1]**o+(-0.573678796739)*x[1]
        s[2,3,1,0]=(-0.083067317174)*x[0]**o+(0.284336362391)*x[0]+(-0.671352852822)*x[1]**o+(0.585391001713)*x[1]
        s[2,3,1,1]=(0.453596080554)*x[0]**o+(0.382646103643)*x[0]+(0.976202291904)*x[1]**o+(0.269885074758)*x[1]
        s[2,3,2,0]=(0.58278560743)*x[0]**o+(-0.641861358694)*x[0]+(0.65546441735)*x[1]**o+(-0.510301705975)*x[1]
        s[2,3,2,1]=(-0.462458062923)*x[0]**o+(-0.860624656355)*x[0]+(-0.795012311004)*x[1]**o+(-0.945015232064)*x[1]
        s[2,4,0,0]=(0.373515573367)*x[0]**o+(0.429646026706)*x[0]+(0.107731590254)*x[1]**o+(0.404788302157)*x[1]
        s[2,4,0,1]=(0.922575542165)*x[0]**o+(0.990525976075)*x[0]+(-0.920047278057)*x[1]**o+(-0.606366502396)*x[1]
        s[2,4,1,0]=(-0.395749593133)*x[0]**o+(-0.303444216059)*x[0]+(0.279159896939)*x[1]**o+(-0.998124949675)*x[1]
        s[2,4,1,1]=(0.608308919638)*x[0]**o+(0.547633707859)*x[0]+(-0.335546391995)*x[1]**o+(-0.49712570743)*x[1]
        s[2,4,2,0]=(-0.764049221842)*x[0]**o+(-0.691060860074)*x[0]+(0.576144131381)*x[1]**o+(-0.0692145325011)*x[1]
        s[2,4,2,1]=(-0.445193960624)*x[0]**o+(-0.299673373394)*x[0]+(-0.17618349631)*x[1]**o+(0.6882025213)*x[1]
        s[3,0,0,0]=(-0.363639361841)*x[0]**o+(-0.637031005499)*x[0]+(0.750565431989)*x[1]**o+(-0.713309519647)*x[1]
        s[3,0,0,1]=(0.86686475536)*x[0]**o+(0.857916166663)*x[0]+(-0.233119477582)*x[1]**o+(-0.275718321599)*x[1]
        s[3,0,1,0]=(0.676379750639)*x[0]**o+(-0.221464786801)*x[0]+(-0.307372968314)*x[1]**o+(-0.974878791542)*x[1]
        s[3,0,1,1]=(0.963332442265)*x[0]**o+(0.873237489049)*x[0]+(0.347621440028)*x[1]**o+(-0.447236045492)*x[1]
        s[3,0,2,0]=(0.574231383242)*x[0]**o+(0.406006911504)*x[0]+(0.998282029235)*x[1]**o+(-0.713526415934)*x[1]
        s[3,0,2,1]=(0.130477890591)*x[0]**o+(-0.994273713498)*x[0]+(-0.836645831178)*x[1]**o+(0.23964737976)*x[1]
        s[3,1,0,0]=(0.681027983965)*x[0]**o+(0.277762028836)*x[0]+(-0.476680449158)*x[1]**o+(0.863218206262)*x[1]
        s[3,1,0,1]=(-0.551857608855)*x[0]**o+(0.714701927775)*x[0]+(0.0805460030018)*x[1]**o+(-0.75844120919)*x[1]
        s[3,1,1,0]=(-0.699952165487)*x[0]**o+(-0.829498201164)*x[0]+(0.518643791102)*x[1]**o+(0.748348341191)*x[1]
        s[3,1,1,1]=(0.628926227064)*x[0]**o+(0.756291174101)*x[0]+(0.847249240418)*x[1]**o+(-0.694296012132)*x[1]
        s[3,1,2,0]=(0.300066092357)*x[0]**o+(0.0979478221525)*x[0]+(-0.652853644798)*x[1]**o+(0.87892206219)*x[1]
        s[3,1,2,1]=(0.820578435316)*x[0]**o+(-0.151267836854)*x[0]+(0.288662297283)*x[1]**o+(-0.530205788227)*x[1]
        s[3,2,0,0]=(-0.262081376064)*x[0]**o+(0.564488927009)*x[0]+(-0.574271798456)*x[1]**o+(-0.103341985058)*x[1]
        s[3,2,0,1]=(0.264373345575)*x[0]**o+(0.505975223545)*x[0]+(0.760869432805)*x[1]**o+(-0.348245510796)*x[1]
        s[3,2,1,0]=(0.382085638525)*x[0]**o+(0.271178748741)*x[0]+(-0.344266263181)*x[1]**o+(0.949904496331)*x[1]
        s[3,2,1,1]=(0.570382182257)*x[0]**o+(-0.507665638153)*x[0]+(0.675674419969)*x[1]**o+(-0.741319149319)*x[1]
        s[3,2,2,0]=(-0.0159674521901)*x[0]**o+(-0.201449258763)*x[0]+(-0.774168601079)*x[1]**o+(-0.333025684689)*x[1]
        s[3,2,2,1]=(0.21116026219)*x[0]**o+(0.174264855243)*x[0]+(-0.693006543432)*x[1]**o+(-0.117768474854)*x[1]
        s[3,3,0,0]=(-0.0965568139991)*x[0]**o+(-0.305779611724)*x[0]+(-0.905575174356)*x[1]**o+(-0.0438869174233)*x[1]
        s[3,3,0,1]=(-0.517028280471)*x[0]**o+(0.725783549398)*x[0]+(0.346469604255)*x[1]**o+(-0.958724910661)*x[1]
        s[3,3,1,0]=(0.673217439387)*x[0]**o+(0.171407887035)*x[0]+(-0.931242988664)*x[1]**o+(0.905785986466)*x[1]
        s[3,3,1,1]=(-0.806309377174)*x[0]**o+(-0.39154927098)*x[0]+(-0.353245837689)*x[1]**o+(-0.0891421463801)*x[1]
        s[3,3,2,0]=(0.54365433687)*x[0]**o+(0.328598607479)*x[0]+(-0.134078804517)*x[1]**o+(0.368297327809)*x[1]
        s[3,3,2,1]=(0.309908919248)*x[0]**o+(-0.366081335409)*x[0]+(0.287094150861)*x[1]**o+(-0.311725137682)*x[1]
        s[3,4,0,0]=(0.0350561429151)*x[0]**o+(-0.587757161762)*x[0]+(0.105785456873)*x[1]**o+(0.00732306049631)*x[1]
        s[3,4,0,1]=(0.110213440973)*x[0]**o+(-0.429550096051)*x[0]+(0.471367364287)*x[1]**o+(0.580191251114)*x[1]
        s[3,4,1,0]=(0.349823338156)*x[0]**o+(0.474522056666)*x[0]+(-0.190656365622)*x[1]**o+(0.872370974782)*x[1]
        s[3,4,1,1]=(-0.694637797093)*x[0]**o+(0.648769674687)*x[0]+(-0.0962824527574)*x[1]**o+(0.669702141463)*x[1]
        s[3,4,2,0]=(-0.954369212248)*x[0]**o+(0.558821994909)*x[0]+(-0.196151296515)*x[1]**o+(0.475540095693)*x[1]
        s[3,4,2,1]=(0.946611204124)*x[0]**o+(-0.452828842027)*x[0]+(-0.167471954345)*x[1]**o+(0.0326624440493)*x[1]
        ref[0,0,0,0]=(0.246025700812)/(o+1.)+(-0.0700771278147)
        ref[0,0,0,1]=(0.872903965104)/(o+1.)+(-0.0956768400749)
        ref[0,0,1,0]=(-0.149098784473)/(o+1.)+(-0.271683908641)
        ref[0,0,1,1]=(0.813191985058)/(o+1.)+(0.141471386383)
        ref[0,0,2,0]=(-0.554184175721)/(o+1.)+(-0.621662970196)
        ref[0,0,2,1]=(-1.0295469585)/(o+1.)+(-0.0365685105983)
        ref[0,1,0,0]=(0.151804025931)/(o+1.)+(-0.212298031588)
        ref[0,1,0,1]=(-0.533004796234)/(o+1.)+(0.0485769377937)
        ref[0,1,1,0]=(-0.802375632463)/(o+1.)+(0.127439034441)
        ref[0,1,1,1]=(0.325754839785)/(o+1.)+(0.0972311868531)
        ref[0,1,2,0]=(1.43492852092)/(o+1.)+(0.652296741316)
        ref[0,1,2,1]=(-0.347667591981)/(o+1.)+(-0.160364561879)
        ref[0,2,0,0]=(-1.37099731406)/(o+1.)+(0.0563097354051)
        ref[0,2,0,1]=(1.11251425188)/(o+1.)+(-0.835019726344)
        ref[0,2,1,0]=(-0.770103190572)/(o+1.)+(-0.309897780967)
        ref[0,2,1,1]=(0.159272551388)/(o+1.)+(0.706859784466)
        ref[0,2,2,0]=(-0.391469887349)/(o+1.)+(-0.207974163745)
        ref[0,2,2,1]=(-0.0415688115757)/(o+1.)+(0.0604937496788)
        ref[0,3,0,0]=(0.957559739626)/(o+1.)+(0.228032778194)
        ref[0,3,0,1]=(-1.09130803461)/(o+1.)+(-0.662860500606)
        ref[0,3,1,0]=(-0.449862052638)/(o+1.)+(-0.344594323242)
        ref[0,3,1,1]=(0.219326920673)/(o+1.)+(0.405011796484)
        ref[0,3,2,0]=(0.275993808116)/(o+1.)+(-0.461328543451)
        ref[0,3,2,1]=(-0.575033733717)/(o+1.)+(0.884920083202)
        ref[0,4,0,0]=(0.0253483143264)/(o+1.)+(-0.831762460572)
        ref[0,4,0,1]=(-0.593504118306)/(o+1.)+(-0.0899796107363)
        ref[0,4,1,0]=(0.946442680954)/(o+1.)+(0.340471820786)
        ref[0,4,1,1]=(1.00832461793)/(o+1.)+(-0.489125179816)
        ref[0,4,2,0]=(0.658258894209)/(o+1.)+(-0.252225332525)
        ref[0,4,2,1]=(0.190670120044)/(o+1.)+(0.107482927026)
        ref[1,0,0,0]=(-0.638264699882)/(o+1.)+(-0.37905912763)
        ref[1,0,0,1]=(0.858273041153)/(o+1.)+(-0.602359980261)
        ref[1,0,1,0]=(1.19603458122)/(o+1.)+(0.623979052337)
        ref[1,0,1,1]=(-0.0559871855173)/(o+1.)+(0.392163437219)
        ref[1,0,2,0]=(0.202869107651)/(o+1.)+(-0.327529727939)
        ref[1,0,2,1]=(0.497839996627)/(o+1.)+(-0.198257844767)
        ref[1,1,0,0]=(-1.05743683429)/(o+1.)+(-0.107408196452)
        ref[1,1,0,1]=(-1.11022578935)/(o+1.)+(0.0799654739886)
        ref[1,1,1,0]=(1.02865615322)/(o+1.)+(-0.111339912553)
        ref[1,1,1,1]=(-0.387124166332)/(o+1.)+(-0.13196732944)
        ref[1,1,2,0]=(0.364571348315)/(o+1.)+(-0.827711953327)
        ref[1,1,2,1]=(0.800389584904)/(o+1.)+(-0.570167855757)
        ref[1,2,0,0]=(-0.359885437423)/(o+1.)+(-0.683824166857)
        ref[1,2,0,1]=(-0.139489334179)/(o+1.)+(-0.0550294716506)
        ref[1,2,1,0]=(0.05752529846)/(o+1.)+(0.330669314498)
        ref[1,2,1,1]=(-0.68363897434)/(o+1.)+(-0.210682497577)
        ref[1,2,2,0]=(-0.971569775609)/(o+1.)+(0.258047639988)
        ref[1,2,2,1]=(0.966753430217)/(o+1.)+(0.737154900402)
        ref[1,3,0,0]=(0.571230899607)/(o+1.)+(0.201680592513)
        ref[1,3,0,1]=(-0.516278846659)/(o+1.)+(-0.203543442922)
        ref[1,3,1,0]=(-0.276019031326)/(o+1.)+(0.465273316758)
        ref[1,3,1,1]=(0.339281660193)/(o+1.)+(0.578236730598)
        ref[1,3,2,0]=(0.811123220269)/(o+1.)+(-0.306640881038)
        ref[1,3,2,1]=(0.397602998535)/(o+1.)+(0.631760762007)
        ref[1,4,0,0]=(0.270527628963)/(o+1.)+(-0.156009469628)
        ref[1,4,0,1]=(0.0267275858003)/(o+1.)+(0.1114627818)
        ref[1,4,1,0]=(0.117364258255)/(o+1.)+(-0.627596298481)
        ref[1,4,1,1]=(1.06982816128)/(o+1.)+(-0.0961307552069)
        ref[1,4,2,0]=(0.648239950234)/(o+1.)+(-0.196286224748)
        ref[1,4,2,1]=(-0.273099453886)/(o+1.)+(-0.71054634034)
        ref[2,0,0,0]=(0.0597301506259)/(o+1.)+(-0.0661675007782)
        ref[2,0,0,1]=(-1.03461567689)/(o+1.)+(0.336883492696)
        ref[2,0,1,0]=(-1.08184729537)/(o+1.)+(-0.236806207955)
        ref[2,0,1,1]=(0.407177326369)/(o+1.)+(-0.411518582134)
        ref[2,0,2,0]=(0.111140120177)/(o+1.)+(0.201425312625)
        ref[2,0,2,1]=(-0.122119044061)/(o+1.)+(-0.0178123728248)
        ref[2,1,0,0]=(0.277542930723)/(o+1.)+(0.332979421149)
        ref[2,1,0,1]=(0.716015179185)/(o+1.)+(-0.35221548881)
        ref[2,1,1,0]=(-1.66176914548)/(o+1.)+(0.136807260612)
        ref[2,1,1,1]=(0.457774847682)/(o+1.)+(-0.211956003748)
        ref[2,1,2,0]=(0.154152304156)/(o+1.)+(-0.225608599389)
        ref[2,1,2,1]=(-0.394387972979)/(o+1.)+(-0.44858376371)
        ref[2,2,0,0]=(-1.17070689262)/(o+1.)+(0.244820006519)
        ref[2,2,0,1]=(1.70365106393)/(o+1.)+(0.61037400899)
        ref[2,2,1,0]=(0.135233290326)/(o+1.)+(0.676633564493)
        ref[2,2,1,1]=(0.527791480019)/(o+1.)+(-0.176123301004)
        ref[2,2,2,0]=(1.32892405044)/(o+1.)+(-0.430418943493)
        ref[2,2,2,1]=(1.36707492995)/(o+1.)+(-0.368418693125)
        ref[2,3,0,0]=(-0.492646905629)/(o+1.)+(0.173164428973)
        ref[2,3,0,1]=(-1.63649265509)/(o+1.)+(-0.0427110311218)
        ref[2,3,1,0]=(-0.754420169996)/(o+1.)+(0.434863682052)
        ref[2,3,1,1]=(1.42979837246)/(o+1.)+(0.3262655892)
        ref[2,3,2,0]=(1.23825002478)/(o+1.)+(-0.576081532335)
        ref[2,3,2,1]=(-1.25747037393)/(o+1.)+(-0.902819944209)
        ref[2,4,0,0]=(0.48124716362)/(o+1.)+(0.417217164431)
        ref[2,4,0,1]=(0.00252826410759)/(o+1.)+(0.192079736839)
        ref[2,4,1,0]=(-0.116589696194)/(o+1.)+(-0.650784582867)
        ref[2,4,1,1]=(0.272762527643)/(o+1.)+(0.0252540002143)
        ref[2,4,2,0]=(-0.187905090461)/(o+1.)+(-0.380137696288)
        ref[2,4,2,1]=(-0.621377456934)/(o+1.)+(0.194264573953)
        ref[3,0,0,0]=(0.386926070148)/(o+1.)+(-0.675170262573)
        ref[3,0,0,1]=(0.633745277778)/(o+1.)+(0.291098922532)
        ref[3,0,1,0]=(0.369006782325)/(o+1.)+(-0.598171789171)
        ref[3,0,1,1]=(1.31095388229)/(o+1.)+(0.213000721778)
        ref[3,0,2,0]=(1.57251341248)/(o+1.)+(-0.153759752215)
        ref[3,0,2,1]=(-0.706167940587)/(o+1.)+(-0.377313166869)
        ref[3,1,0,0]=(0.204347534807)/(o+1.)+(0.570490117549)
        ref[3,1,0,1]=(-0.471311605853)/(o+1.)+(-0.0218696407078)
        ref[3,1,1,0]=(-0.181308374385)/(o+1.)+(-0.0405749299865)
        ref[3,1,1,1]=(1.47617546748)/(o+1.)+(0.0309975809845)
        ref[3,1,2,0]=(-0.352787552441)/(o+1.)+(0.488434942171)
        ref[3,1,2,1]=(1.1092407326)/(o+1.)+(-0.34073681254)
        ref[3,2,0,0]=(-0.83635317452)/(o+1.)+(0.230573470976)
        ref[3,2,0,1]=(1.02524277838)/(o+1.)+(0.0788648563748)
        ref[3,2,1,0]=(0.0378193753437)/(o+1.)+(0.610541622536)
        ref[3,2,1,1]=(1.24605660223)/(o+1.)+(-0.624492393736)
        ref[3,2,2,0]=(-0.79013605327)/(o+1.)+(-0.267237471726)
        ref[3,2,2,1]=(-0.481846281241)/(o+1.)+(0.0282481901946)
        ref[3,3,0,0]=(-1.00213198835)/(o+1.)+(-0.174833264573)
        ref[3,3,0,1]=(-0.170558676217)/(o+1.)+(-0.116470680631)
        ref[3,3,1,0]=(-0.258025549277)/(o+1.)+(0.538596936751)
        ref[3,3,1,1]=(-1.15955521486)/(o+1.)+(-0.24034570868)
        ref[3,3,2,0]=(0.409575532352)/(o+1.)+(0.348447967644)
        ref[3,3,2,1]=(0.597003070109)/(o+1.)+(-0.338903236546)
        ref[3,4,0,0]=(0.140841599788)/(o+1.)+(-0.290217050633)
        ref[3,4,0,1]=(0.581580805261)/(o+1.)+(0.0753205775318)
        ref[3,4,1,0]=(0.159166972534)/(o+1.)+(0.673446515724)
        ref[3,4,1,1]=(-0.79092024985)/(o+1.)+(0.659235908075)
        ref[3,4,2,0]=(-1.15052050876)/(o+1.)+(0.517181045301)
        ref[3,4,2,1]=(0.779139249778)/(o+1.)+(-0.210083198989)
      else:
        s[0,0,0,0]=(0.748319783349)*x[0]**o+(-0.176566570347)*x[0]+(-0.302910837408)*x[1]**o+(0.492350205415)*x[1]+(-0.160456161783)*x[2]**o+(0.868280836814)*x[2]
        s[0,0,0,1]=(-0.51136577317)*x[0]**o+(-0.242417336787)*x[0]+(-0.785996766849)*x[1]**o+(0.606869170308)*x[1]+(0.49391109913)*x[2]**o+(-0.319568202304)*x[2]
        s[0,0,1,0]=(0.640062862527)*x[0]**o+(0.566706264858)*x[0]+(0.907582097741)*x[1]**o+(0.350910171053)*x[1]+(-0.909242439832)*x[2]**o+(-0.85540876524)*x[2]
        s[0,0,1,1]=(-0.377548918631)*x[0]**o+(-0.630218128454)*x[0]+(0.45141559373)*x[1]**o+(0.0832708083581)*x[1]+(0.233405447853)*x[2]**o+(0.567903425032)*x[2]
        s[0,0,2,0]=(-0.497312249883)*x[0]**o+(-0.651244043641)*x[0]+(-0.575450843765)*x[1]**o+(0.0219939930053)*x[1]+(0.570655374403)*x[2]**o+(-0.402040210721)*x[2]
        s[0,0,2,1]=(0.383694368889)*x[0]**o+(-0.280765736983)*x[0]+(0.644560587428)*x[1]**o+(-0.263879759253)*x[1]+(0.78943504044)*x[2]**o+(0.838120969604)*x[2]
        s[0,1,0,0]=(0.331871753344)*x[0]**o+(0.731388799379)*x[0]+(0.394440515222)*x[1]**o+(-0.337910220731)*x[1]+(-0.078492234799)*x[2]**o+(0.388988268348)*x[2]
        s[0,1,0,1]=(0.197262971559)*x[0]**o+(0.482585248548)*x[0]+(0.0890475484335)*x[1]**o+(-0.154881471591)*x[1]+(0.14978160538)*x[2]**o+(-0.115243504627)*x[2]
        s[0,1,1,0]=(0.338072090662)*x[0]**o+(0.238967458874)*x[0]+(0.4078504965)*x[1]**o+(-0.941497950412)*x[1]+(0.539654579256)*x[2]**o+(0.777502770306)*x[2]
        s[0,1,1,1]=(-0.876894224774)*x[0]**o+(-0.413741121497)*x[0]+(0.841988144013)*x[1]**o+(-0.987067492493)*x[1]+(-0.0142647738806)*x[2]**o+(0.809756634084)*x[2]
        s[0,1,2,0]=(0.771962423748)*x[0]**o+(-0.274151695697)*x[0]+(-0.0583329632543)*x[1]**o+(0.290755268126)*x[1]+(0.986842038664)*x[2]**o+(-0.445513638841)*x[2]
        s[0,1,2,1]=(0.235289294125)*x[0]**o+(-0.0230216115543)*x[0]+(-0.39449823454)*x[1]**o+(0.758538375985)*x[1]+(-0.990485958396)*x[2]**o+(0.441787118653)*x[2]
        s[0,2,0,0]=(-0.860580472907)*x[0]**o+(-0.480513252563)*x[0]+(0.388567023408)*x[1]**o+(-0.435900869228)*x[1]+(-0.483812008458)*x[2]**o+(0.87821418943)*x[2]
        s[0,2,0,1]=(-0.391914341084)*x[0]**o+(-0.813798019851)*x[0]+(0.681793443132)*x[1]**o+(-0.422727355552)*x[1]+(-0.0599492576813)*x[2]**o+(0.630302059584)*x[2]
        s[0,2,1,0]=(-0.857349416782)*x[0]**o+(0.0937767571422)*x[0]+(-0.935044609271)*x[1]**o+(-0.825241166723)*x[1]+(-0.78223171556)*x[2]**o+(0.33550368528)*x[2]
        s[0,2,1,1]=(-0.366924211693)*x[0]**o+(0.572797118425)*x[0]+(-0.289194982186)*x[1]**o+(-0.942701172085)*x[1]+(0.614219031682)*x[2]**o+(-0.389753632964)*x[2]
        s[0,2,2,0]=(-0.404732972636)*x[0]**o+(0.631781218361)*x[0]+(-0.263486337549)*x[1]**o+(0.631746356812)*x[1]+(-0.515291196501)*x[2]**o+(-0.363991020547)*x[2]
        s[0,2,2,1]=(0.892685628814)*x[0]**o+(0.963218649844)*x[0]+(0.483947727789)*x[1]**o+(0.211028649587)*x[1]+(0.50159178018)*x[2]**o+(0.0711392272561)*x[2]
        s[0,3,0,0]=(-0.33216085676)*x[0]**o+(0.906269165577)*x[0]+(0.874123825651)*x[1]**o+(-0.570808752482)*x[1]+(-0.561182318614)*x[2]**o+(-0.884125641249)*x[2]
        s[0,3,0,1]=(-0.0703055529684)*x[0]**o+(-0.101044608869)*x[0]+(0.829269084242)*x[1]**o+(-0.497613621381)*x[1]+(0.297140846283)*x[2]**o+(0.566992550301)*x[2]
        s[0,3,1,0]=(0.00230797481965)*x[0]**o+(-0.561978070323)*x[0]+(-0.874987267344)*x[1]**o+(0.404602330516)*x[1]+(0.541390115931)*x[2]**o+(0.109832470538)*x[2]
        s[0,3,1,1]=(-0.738073409216)*x[0]**o+(0.016899800363)*x[0]+(0.606773214528)*x[1]**o+(0.607363930641)*x[1]+(-0.755469399679)*x[2]**o+(-0.585951709489)*x[2]
        s[0,3,2,0]=(0.754566844048)*x[0]**o+(0.353623703809)*x[0]+(0.300465743201)*x[1]**o+(0.4804155825)*x[1]+(-0.500709775706)*x[2]**o+(-0.184866087487)*x[2]
        s[0,3,2,1]=(0.656642762895)*x[0]**o+(-0.522249569275)*x[0]+(-0.689897112218)*x[1]**o+(0.197660165382)*x[1]+(0.790618474391)*x[2]**o+(0.34534294776)*x[2]
        s[0,4,0,0]=(0.951780164354)*x[0]**o+(0.227261667276)*x[0]+(-0.388326921756)*x[1]**o+(-0.143812077493)*x[1]+(0.869741228576)*x[2]**o+(0.896296431361)*x[2]
        s[0,4,0,1]=(0.0418495997166)*x[0]**o+(0.378737546698)*x[0]+(-0.893460535382)*x[1]**o+(-0.0409222699203)*x[1]+(-0.6955627414)*x[2]**o+(-0.993500126323)*x[2]
        s[0,4,1,0]=(-0.47303219937)*x[0]**o+(0.488878345444)*x[0]+(0.110295068747)*x[1]**o+(-0.775897017507)*x[1]+(-0.664013808104)*x[2]**o+(-0.125758726632)*x[2]
        s[0,4,1,1]=(0.326490818022)*x[0]**o+(-0.785954928184)*x[0]+(0.85336153105)*x[1]**o+(-0.573522941199)*x[1]+(-0.42185352182)*x[2]**o+(-0.425049668912)*x[2]
        s[0,4,2,0]=(0.290783142101)*x[0]**o+(-0.502056588268)*x[0]+(0.433355340131)*x[1]**o+(-0.717832338133)*x[1]+(0.254866069131)*x[2]**o+(-0.383849864093)*x[2]
        s[0,4,2,1]=(-0.796340985968)*x[0]**o+(-0.732115333195)*x[0]+(-0.829732009003)*x[1]**o+(-0.790621874069)*x[1]+(-0.60818338505)*x[2]**o+(-0.892012123169)*x[2]
        s[1,0,0,0]=(0.150096606609)*x[0]**o+(0.713142060809)*x[0]+(0.0898795205212)*x[1]**o+(-0.682356428859)*x[1]+(0.275326716654)*x[2]**o+(-0.356136748426)*x[2]
        s[1,0,0,1]=(0.104574120129)*x[0]**o+(-0.895395804614)*x[0]+(-0.00895409609851)*x[1]**o+(0.852200905159)*x[1]+(0.25757145031)*x[2]**o+(-0.578299505429)*x[2]
        s[1,0,1,0]=(-0.83104126362)*x[0]**o+(-0.587286782794)*x[0]+(0.043755441563)*x[1]**o+(-0.357299738488)*x[1]+(0.900592455437)*x[2]**o+(0.885645422129)*x[2]
        s[1,0,1,1]=(-0.144444995355)*x[0]**o+(-0.667350132103)*x[0]+(0.949183394884)*x[1]**o+(-0.519086948324)*x[1]+(-0.74215320159)*x[2]**o+(-0.202102401774)*x[2]
        s[1,0,2,0]=(0.303496934218)*x[0]**o+(-0.02461446864)*x[0]+(-0.0867456086666)*x[1]**o+(0.730962877622)*x[1]+(-0.851607522381)*x[2]**o+(-0.239310033319)*x[2]
        s[1,0,2,1]=(-0.512139821912)*x[0]**o+(-0.69403755459)*x[0]+(0.462840604615)*x[1]**o+(-0.192161565941)*x[1]+(0.807307771096)*x[2]**o+(0.440024157111)*x[2]
        s[1,1,0,0]=(-0.693987625939)*x[0]**o+(0.410652593337)*x[0]+(0.665893670901)*x[1]**o+(0.525886124327)*x[1]+(0.200291951309)*x[2]**o+(0.793353011987)*x[2]
        s[1,1,0,1]=(-0.667911914141)*x[0]**o+(0.693960372567)*x[0]+(-0.0892935574405)*x[1]**o+(0.669184962503)*x[1]+(0.664202374165)*x[2]**o+(-0.474657421474)*x[2]
        s[1,1,1,0]=(0.4341035606)*x[0]**o+(0.707815942288)*x[0]+(-0.204720100594)*x[1]**o+(-0.816120724182)*x[1]+(-0.259566839542)*x[2]**o+(0.918010553929)*x[2]
        s[1,1,1,1]=(0.280925026809)*x[0]**o+(0.895509529721)*x[0]+(0.244175246656)*x[1]**o+(0.692059608476)*x[1]+(-0.424963623478)*x[2]**o+(0.985618462184)*x[2]
        s[1,1,2,0]=(0.172285590575)*x[0]**o+(0.0614208586474)*x[0]+(-0.751024157153)*x[1]**o+(0.182364162229)*x[1]+(-0.400270263752)*x[2]**o+(0.6410957443)*x[2]
        s[1,1,2,1]=(0.621541338202)*x[0]**o+(0.716601026013)*x[0]+(0.822288477475)*x[1]**o+(0.200859656154)*x[1]+(-0.651437159651)*x[2]**o+(-0.554048539377)*x[2]
        s[1,2,0,0]=(-0.835149004101)*x[0]**o+(-0.748380867211)*x[0]+(-0.445526738596)*x[1]**o+(0.782304294095)*x[1]+(0.827204947885)*x[2]**o+(0.188779249069)*x[2]
        s[1,2,0,1]=(0.354866953137)*x[0]**o+(-0.981132219204)*x[0]+(0.488043961513)*x[1]**o+(0.257052078929)*x[1]+(0.719111294043)*x[2]**o+(-0.298289862834)*x[2]
        s[1,2,1,0]=(0.552605101038)*x[0]**o+(0.145016605474)*x[0]+(0.119161182879)*x[1]**o+(0.723703065293)*x[1]+(-0.011955307053)*x[2]**o+(0.374814299212)*x[2]
        s[1,2,1,1]=(0.448055014229)*x[0]**o+(-0.320498330109)*x[0]+(0.812977543935)*x[1]**o+(0.374118976348)*x[1]+(0.656782601024)*x[2]**o+(0.0845883407242)*x[2]
        s[1,2,2,0]=(0.418470977027)*x[0]**o+(-0.324185586615)*x[0]+(0.576184154734)*x[1]**o+(-0.244791711079)*x[1]+(-0.383448002434)*x[2]**o+(-0.425391146295)*x[2]
        s[1,2,2,1]=(0.885670287748)*x[0]**o+(0.804245948464)*x[0]+(-0.122365449147)*x[1]**o+(0.0526689576387)*x[1]+(0.886983215847)*x[2]**o+(-0.9130795011)*x[2]
        s[1,3,0,0]=(-0.698202951872)*x[0]**o+(-0.753867598728)*x[0]+(-0.729720876147)*x[1]**o+(-0.535739350698)*x[1]+(0.140570380613)*x[2]**o+(-0.0716035886696)*x[2]
        s[1,3,0,1]=(-0.898459992298)*x[0]**o+(0.372462814699)*x[0]+(0.605465414867)*x[1]**o+(-0.684605485569)*x[1]+(0.549437793056)*x[2]**o+(-0.010737341414)*x[2]
        s[1,3,1,0]=(0.792329973599)*x[0]**o+(-0.52685018301)*x[0]+(0.200314760956)*x[1]**o+(0.632873255355)*x[1]+(-0.43152569425)*x[2]**o+(0.348904687244)*x[2]
        s[1,3,1,1]=(0.209464885105)*x[0]**o+(-0.0146787858502)*x[0]+(0.320235817099)*x[1]**o+(0.86370910616)*x[1]+(-0.202145495919)*x[2]**o+(-0.25657518419)*x[2]
        s[1,3,2,0]=(0.489051201235)*x[0]**o+(0.349594264623)*x[0]+(-0.574002000861)*x[1]**o+(0.390761344969)*x[1]+(0.1514845518)*x[2]**o+(0.802240236468)*x[2]
        s[1,3,2,1]=(-0.0182530256393)*x[0]**o+(0.303828930846)*x[0]+(0.618612491362)*x[1]**o+(0.293473693133)*x[1]+(0.763201722939)*x[2]**o+(-0.652537522965)*x[2]
        s[1,4,0,0]=(0.349015278137)*x[0]**o+(-0.0165197033193)*x[0]+(0.63228324617)*x[1]**o+(-0.934745316284)*x[1]+(-0.187390369535)*x[2]**o+(-0.456599706963)*x[2]
        s[1,4,0,1]=(0.310212294648)*x[0]**o+(-0.898896972668)*x[0]+(0.229475812326)*x[1]**o+(0.787159228942)*x[1]+(0.133488840506)*x[2]**o+(0.949893906424)*x[2]
        s[1,4,1,0]=(-0.869667859962)*x[0]**o+(0.624210860706)*x[0]+(0.122085293209)*x[1]**o+(-0.624604470463)*x[1]+(-0.878410325648)*x[2]**o+(-0.0841801197816)*x[2]
        s[1,4,1,1]=(0.706521970977)*x[0]**o+(0.23837086782)*x[0]+(-0.960682169998)*x[1]**o+(-0.707493453388)*x[1]+(0.828048621994)*x[2]**o+(0.327258769743)*x[2]
        s[1,4,2,0]=(-0.291203807685)*x[0]**o+(0.707463915698)*x[0]+(-0.860720761064)*x[1]**o+(0.802477835676)*x[1]+(-0.16905212173)*x[2]**o+(0.453497949714)*x[2]
        s[1,4,2,1]=(0.789863893897)*x[0]**o+(-0.945472074403)*x[0]+(-0.047780484871)*x[1]**o+(0.199167500985)*x[1]+(0.575959160298)*x[2]**o+(-0.181712597239)*x[2]
        s[2,0,0,0]=(0.61569741708)*x[0]**o+(0.609998488119)*x[0]+(-0.943339902899)*x[1]**o+(-0.962332686128)*x[1]+(0.458927713248)*x[2]**o+(-0.191444752971)*x[2]
        s[2,0,0,1]=(0.0306432921503)*x[0]**o+(0.326065705299)*x[0]+(0.29054908043)*x[1]**o+(-0.498110577924)*x[1]+(-0.855604413911)*x[2]**o+(-0.832549081863)*x[2]
        s[2,0,1,0]=(0.539469235745)*x[0]**o+(0.549053450527)*x[0]+(0.379811452156)*x[1]**o+(0.383008863276)*x[1]+(-0.835777000108)*x[2]**o+(0.418879791451)*x[2]
        s[2,0,1,1]=(0.0773392682115)*x[0]**o+(0.594680641339)*x[0]+(-0.514207317809)*x[1]**o+(0.516677819046)*x[1]+(-0.616548060204)*x[2]**o+(-0.487308340419)*x[2]
        s[2,0,2,0]=(0.308538286588)*x[0]**o+(0.553188024822)*x[0]+(0.640606076984)*x[1]**o+(0.851001392437)*x[1]+(-0.175136140727)*x[2]**o+(-0.0677219547255)*x[2]
        s[2,0,2,1]=(0.689683007295)*x[0]**o+(0.0205486604859)*x[0]+(-0.513197632413)*x[1]**o+(-0.589507997499)*x[1]+(0.0967263356508)*x[2]**o+(-0.743224844971)*x[2]
        s[2,1,0,0]=(0.175040132619)*x[0]**o+(0.0564766932006)*x[0]+(-0.641666937619)*x[1]**o+(0.820974466919)*x[1]+(0.494310429863)*x[2]**o+(-0.704304819607)*x[2]
        s[2,1,0,1]=(-0.890775824863)*x[0]**o+(-0.500686412296)*x[0]+(0.153470124596)*x[1]**o+(-0.64297395847)*x[1]+(-0.716566099394)*x[2]**o+(0.74578557063)*x[2]
        s[2,1,1,0]=(-0.999358965815)*x[0]**o+(-0.657733542154)*x[0]+(0.197035042134)*x[1]**o+(-0.887786199345)*x[1]+(-0.0685059299499)*x[2]**o+(0.498972129916)*x[2]
        s[2,1,1,1]=(0.627376530136)*x[0]**o+(-0.681228319483)*x[0]+(0.552935442983)*x[1]**o+(-0.813921943144)*x[1]+(-0.192761641367)*x[2]**o+(-0.248022829303)*x[2]
        s[2,1,2,0]=(0.845230425625)*x[0]**o+(-0.503049369073)*x[0]+(-0.705939778787)*x[1]**o+(-0.862373899236)*x[1]+(-0.327695135868)*x[2]**o+(-0.469012024699)*x[2]
        s[2,1,2,1]=(-0.509720328843)*x[0]**o+(-0.595784133936)*x[0]+(0.703072807212)*x[1]**o+(0.413326203128)*x[1]+(0.819831655306)*x[2]**o+(-0.494002066589)*x[2]
        s[2,2,0,0]=(-0.349642870638)*x[0]**o+(0.530770622335)*x[0]+(0.132675549915)*x[1]**o+(-0.234998432688)*x[1]+(-0.928123366402)*x[2]**o+(-0.578031336794)*x[2]
        s[2,2,0,1]=(-0.38335511074)*x[0]**o+(-0.993906933916)*x[0]+(-0.82535132107)*x[1]**o+(0.0112642210987)*x[1]+(0.904749217207)*x[2]**o+(-0.951098241145)*x[2]
        s[2,2,1,0]=(-0.387786853958)*x[0]**o+(0.455299305562)*x[0]+(0.690526696082)*x[1]**o+(0.192809198912)*x[1]+(-0.0217815689027)*x[2]**o+(0.853966231049)*x[2]
        s[2,2,1,1]=(0.399193164297)*x[0]**o+(0.19349639518)*x[0]+(0.317501609824)*x[1]**o+(0.240510267197)*x[1]+(0.0450712212053)*x[2]**o+(0.565853605939)*x[2]
        s[2,2,2,0]=(0.0853562286915)*x[0]**o+(0.122662799465)*x[0]+(0.26271658282)*x[1]**o+(0.90975618664)*x[1]+(-0.4111835609)*x[2]**o+(0.813644048231)*x[2]
        s[2,2,2,1]=(-0.852594000157)*x[0]**o+(-0.38507970023)*x[0]+(-0.232827312227)*x[1]**o+(0.00790525919862)*x[1]+(-0.3900612508)*x[2]**o+(-0.655554313153)*x[2]
        s[2,3,0,0]=(0.636184557317)*x[0]**o+(-0.549119485575)*x[0]+(-0.948821359516)*x[1]**o+(0.131451687899)*x[1]+(0.670399101185)*x[2]**o+(0.489217491983)*x[2]
        s[2,3,0,1]=(-0.856150893763)*x[0]**o+(-0.280815300266)*x[0]+(-0.523050266221)*x[1]**o+(0.520191604865)*x[1]+(0.0521766680699)*x[2]**o+(0.900107417471)*x[2]
        s[2,3,1,0]=(0.826705547671)*x[0]**o+(0.840439089501)*x[0]+(0.170261390802)*x[1]**o+(0.0811180372799)*x[1]+(-0.150910532868)*x[2]**o+(-0.312396418734)*x[2]
        s[2,3,1,1]=(-0.761542055765)*x[0]**o+(-0.972348306591)*x[0]+(0.872426053365)*x[1]**o+(-0.395809987519)*x[1]+(0.731896957461)*x[2]**o+(0.743098137394)*x[2]
        s[2,3,2,0]=(0.702021470374)*x[0]**o+(-0.378108346769)*x[0]+(-0.931728063859)*x[1]**o+(0.387496129463)*x[1]+(-0.0627914582829)*x[2]**o+(-0.648454760891)*x[2]
        s[2,3,2,1]=(0.694922709107)*x[0]**o+(0.348731283066)*x[0]+(-0.772113301946)*x[1]**o+(0.958191340446)*x[1]+(0.227272159891)*x[2]**o+(-0.553319421819)*x[2]
        s[2,4,0,0]=(0.201119725976)*x[0]**o+(0.593100698188)*x[0]+(-0.140057809068)*x[1]**o+(-0.0952566649925)*x[1]+(-0.851826547872)*x[2]**o+(0.505822022941)*x[2]
        s[2,4,0,1]=(0.0212756051792)*x[0]**o+(0.612323788569)*x[0]+(-0.582655513686)*x[1]**o+(0.461920977901)*x[1]+(0.45615084988)*x[2]**o+(-0.831485043604)*x[2]
        s[2,4,1,0]=(-0.896264627494)*x[0]**o+(0.130655495842)*x[0]+(-0.51905734937)*x[1]**o+(-0.850916009006)*x[1]+(-0.927481150342)*x[2]**o+(-0.394829448395)*x[2]
        s[2,4,1,1]=(0.589011113198)*x[0]**o+(0.779837449297)*x[0]+(-0.404231103183)*x[1]**o+(-0.818485472133)*x[1]+(-0.975586808573)*x[2]**o+(-0.140406688026)*x[2]
        s[2,4,2,0]=(0.621779862491)*x[0]**o+(-0.761880142681)*x[0]+(0.373695582445)*x[1]**o+(0.822746723299)*x[1]+(-0.0828625534579)*x[2]**o+(0.0737978389046)*x[2]
        s[2,4,2,1]=(-0.565625067907)*x[0]**o+(-0.494605807934)*x[0]+(-0.16016442955)*x[1]**o+(0.154859091053)*x[1]+(0.274690562477)*x[2]**o+(-0.0880681582431)*x[2]
        s[3,0,0,0]=(-0.876284142284)*x[0]**o+(0.833701643665)*x[0]+(-0.343394927755)*x[1]**o+(0.750989322932)*x[1]+(-0.0929682612771)*x[2]**o+(-0.098548374762)*x[2]
        s[3,0,0,1]=(-0.894241201097)*x[0]**o+(0.960924642371)*x[0]+(-0.385879848199)*x[1]**o+(-0.0740790803068)*x[1]+(-0.202098139954)*x[2]**o+(0.881367694352)*x[2]
        s[3,0,1,0]=(-0.462333015258)*x[0]**o+(-0.209675407943)*x[0]+(-0.162580359293)*x[1]**o+(0.699769354405)*x[1]+(0.505842739219)*x[2]**o+(-0.0511954656814)*x[2]
        s[3,0,1,1]=(-0.560563273256)*x[0]**o+(-0.798740244759)*x[0]+(0.661483757231)*x[1]**o+(0.160669606575)*x[1]+(-0.433798248002)*x[2]**o+(-0.573448279579)*x[2]
        s[3,0,2,0]=(-0.05963441333)*x[0]**o+(0.123422468842)*x[0]+(-0.0794480113474)*x[1]**o+(-0.980566064632)*x[1]+(0.172807620144)*x[2]**o+(0.290739484628)*x[2]
        s[3,0,2,1]=(-0.824869737132)*x[0]**o+(-0.236911913997)*x[0]+(-0.168741303105)*x[1]**o+(0.115993599766)*x[1]+(0.345866352676)*x[2]**o+(-0.810213944202)*x[2]
        s[3,1,0,0]=(-0.413325465485)*x[0]**o+(0.622383829933)*x[0]+(-0.517445935411)*x[1]**o+(0.968177050325)*x[1]+(-0.257376473971)*x[2]**o+(0.614956161076)*x[2]
        s[3,1,0,1]=(0.998189367064)*x[0]**o+(0.222064685116)*x[0]+(0.0082228342872)*x[1]**o+(-0.779543154084)*x[1]+(-0.566689004021)*x[2]**o+(0.580783912818)*x[2]
        s[3,1,1,0]=(0.245064518006)*x[0]**o+(0.252652697672)*x[0]+(-0.0750782925877)*x[1]**o+(0.216217715236)*x[1]+(-0.0766336852144)*x[2]**o+(0.819380420323)*x[2]
        s[3,1,1,1]=(-0.262865184606)*x[0]**o+(0.200232864872)*x[0]+(0.378217877682)*x[1]**o+(-0.560693320189)*x[1]+(0.235131793324)*x[2]**o+(0.0374878565262)*x[2]
        s[3,1,2,0]=(0.475538018977)*x[0]**o+(-0.731782099691)*x[0]+(-0.983895939904)*x[1]**o+(-0.505746472336)*x[1]+(-0.393214081403)*x[2]**o+(0.48342413719)*x[2]
        s[3,1,2,1]=(0.298214379)*x[0]**o+(-0.232901801182)*x[0]+(-0.47025072398)*x[1]**o+(-0.0935590248775)*x[1]+(-0.270755608412)*x[2]**o+(0.232963599748)*x[2]
        s[3,2,0,0]=(0.544547455045)*x[0]**o+(-0.238443336164)*x[0]+(0.104607358043)*x[1]**o+(0.700551882808)*x[1]+(-0.154865547453)*x[2]**o+(0.897044366696)*x[2]
        s[3,2,0,1]=(-0.226438512542)*x[0]**o+(-0.889161505097)*x[0]+(0.844759329847)*x[1]**o+(0.67393984486)*x[1]+(0.600583328853)*x[2]**o+(0.14085768238)*x[2]
        s[3,2,1,0]=(-0.303519143875)*x[0]**o+(-0.480627582343)*x[0]+(0.711647844961)*x[1]**o+(-0.827593833605)*x[1]+(-0.551933240305)*x[2]**o+(-0.358612992123)*x[2]
        s[3,2,1,1]=(-0.284375845165)*x[0]**o+(-0.144660681111)*x[0]+(-0.520160492072)*x[1]**o+(0.175169216201)*x[1]+(-0.500839582917)*x[2]**o+(-0.816514398637)*x[2]
        s[3,2,2,0]=(-0.563952264023)*x[0]**o+(0.104321734788)*x[0]+(-0.469018385204)*x[1]**o+(0.0093577376129)*x[1]+(-0.732696251175)*x[2]**o+(-0.178803413304)*x[2]
        s[3,2,2,1]=(0.774737106755)*x[0]**o+(0.860675883412)*x[0]+(0.79787325945)*x[1]**o+(0.664362658951)*x[1]+(-0.178147456548)*x[2]**o+(-0.253548140518)*x[2]
        s[3,3,0,0]=(-0.218464111878)*x[0]**o+(-0.255988638178)*x[0]+(0.278107535041)*x[1]**o+(0.40326101595)*x[1]+(-0.2331761004)*x[2]**o+(-0.317553406707)*x[2]
        s[3,3,0,1]=(-0.537282071415)*x[0]**o+(0.601952446965)*x[0]+(0.381109335541)*x[1]**o+(0.669261809466)*x[1]+(0.945072492166)*x[2]**o+(0.853596132501)*x[2]
        s[3,3,1,0]=(0.847664465983)*x[0]**o+(0.8066212639)*x[0]+(-0.857726357776)*x[1]**o+(0.474266813247)*x[1]+(-0.201605613201)*x[2]**o+(-0.793421334897)*x[2]
        s[3,3,1,1]=(-0.420235472332)*x[0]**o+(0.691721844986)*x[0]+(-0.265495062345)*x[1]**o+(0.275291637819)*x[1]+(0.935918852363)*x[2]**o+(0.682857746339)*x[2]
        s[3,3,2,0]=(-0.507370968068)*x[0]**o+(0.73174079427)*x[0]+(0.260834780217)*x[1]**o+(0.0234116684785)*x[1]+(-0.259405028241)*x[2]**o+(-0.95866122285)*x[2]
        s[3,3,2,1]=(-0.739777982614)*x[0]**o+(-0.634784565277)*x[0]+(-0.459700756224)*x[1]**o+(-0.668028439149)*x[1]+(0.543643060627)*x[2]**o+(0.481120453087)*x[2]
        s[3,4,0,0]=(-0.564521203332)*x[0]**o+(0.875264891992)*x[0]+(-0.711596964515)*x[1]**o+(0.516599187629)*x[1]+(0.803187045453)*x[2]**o+(0.130416944939)*x[2]
        s[3,4,0,1]=(-0.233194158029)*x[0]**o+(0.124405220571)*x[0]+(-0.0969251448946)*x[1]**o+(-0.13351738113)*x[1]+(-0.426939325117)*x[2]**o+(-0.0127989581875)*x[2]
        s[3,4,1,0]=(-0.654825260357)*x[0]**o+(-0.073851613222)*x[0]+(-0.866970362806)*x[1]**o+(-0.417768390991)*x[1]+(0.876189107492)*x[2]**o+(0.57905826773)*x[2]
        s[3,4,1,1]=(0.62991933581)*x[0]**o+(0.0333499904703)*x[0]+(0.296962053291)*x[1]**o+(-0.203151609982)*x[1]+(-0.416709189249)*x[2]**o+(-0.815746328506)*x[2]
        s[3,4,2,0]=(-0.720775085901)*x[0]**o+(0.96283858374)*x[0]+(0.23423515114)*x[1]**o+(0.640634860355)*x[1]+(-0.819346396686)*x[2]**o+(-0.807002446047)*x[2]
        s[3,4,2,1]=(-0.0608202717996)*x[0]**o+(0.339885794306)*x[0]+(-0.317314034496)*x[1]**o+(-0.672508392809)*x[1]+(0.63517267097)*x[2]**o+(-0.00885735344423)*x[2]
        ref[0,0,0,0]=(0.284952784158)/(o+1.)+(0.592032235941)
        ref[0,0,0,1]=(-0.803451440889)/(o+1.)+(0.0224418156084)
        ref[0,0,1,0]=(0.638402520436)/(o+1.)+(0.0311038353355)
        ref[0,0,1,1]=(0.307272122952)/(o+1.)+(0.0104780524684)
        ref[0,0,2,0]=(-0.502107719245)/(o+1.)+(-0.515645130678)
        ref[0,0,2,1]=(1.81768999676)/(o+1.)+(0.146737736684)
        ref[0,1,0,0]=(0.647820033767)/(o+1.)+(0.391233423499)
        ref[0,1,0,1]=(0.436092125372)/(o+1.)+(0.106230136165)
        ref[0,1,1,0]=(1.28557716642)/(o+1.)+(0.0374861393842)
        ref[0,1,1,1]=(-0.0491708546408)/(o+1.)+(-0.295525989953)
        ref[0,1,2,0]=(1.70047149916)/(o+1.)+(-0.214455033205)
        ref[0,1,2,1]=(-1.14969489881)/(o+1.)+(0.588651941542)
        ref[0,2,0,0]=(-0.955825457958)/(o+1.)+(-0.0190999661809)
        ref[0,2,0,1]=(0.229929844366)/(o+1.)+(-0.30311165791)
        ref[0,2,1,0]=(-2.57462574161)/(o+1.)+(-0.197980362151)
        ref[0,2,1,1]=(-0.0419001621974)/(o+1.)+(-0.379828843312)
        ref[0,2,2,0]=(-1.18351050669)/(o+1.)+(0.449768277313)
        ref[0,2,2,1]=(1.87822513678)/(o+1.)+(0.622693263344)
        ref[0,3,0,0]=(-0.0192193497223)/(o+1.)+(-0.274332614077)
        ref[0,3,0,1]=(1.05610437756)/(o+1.)+(-0.0158328399745)
        ref[0,3,1,0]=(-0.331289176593)/(o+1.)+(-0.023771634635)
        ref[0,3,1,1]=(-0.886769594367)/(o+1.)+(0.0191560107572)
        ref[0,3,2,0]=(0.554322811543)/(o+1.)+(0.324586599411)
        ref[0,3,2,1]=(0.757364125068)/(o+1.)+(0.0103767719331)
        ref[0,4,0,0]=(1.43319447117)/(o+1.)+(0.489873010572)
        ref[0,4,0,1]=(-1.54717367706)/(o+1.)+(-0.327842424773)
        ref[0,4,1,0]=(-1.02675093873)/(o+1.)+(-0.206388699347)
        ref[0,4,1,1]=(0.757998827253)/(o+1.)+(-0.892263769148)
        ref[0,4,2,0]=(0.979004551362)/(o+1.)+(-0.801869395247)
        ref[0,4,2,1]=(-2.23425638002)/(o+1.)+(-1.20737466522)
        ref[1,0,0,0]=(0.515302843784)/(o+1.)+(-0.162675558238)
        ref[1,0,0,1]=(0.353191474341)/(o+1.)+(-0.310747202442)
        ref[1,0,1,0]=(0.11330663338)/(o+1.)+(-0.0294705495767)
        ref[1,0,1,1]=(0.0625851979387)/(o+1.)+(-0.6942697411)
        ref[1,0,2,0]=(-0.634856196829)/(o+1.)+(0.233519187832)
        ref[1,0,2,1]=(0.758008553799)/(o+1.)+(-0.22308748171)
        ref[1,1,0,0]=(0.172197996272)/(o+1.)+(0.864945864826)
        ref[1,1,0,1]=(-0.0930030974171)/(o+1.)+(0.444243956798)
        ref[1,1,1,0]=(-0.0301833795362)/(o+1.)+(0.404852886018)
        ref[1,1,1,1]=(0.100136649986)/(o+1.)+(1.28659380019)
        ref[1,1,2,0]=(-0.97900883033)/(o+1.)+(0.442440382588)
        ref[1,1,2,1]=(0.792392656026)/(o+1.)+(0.181706071395)
        ref[1,2,0,0]=(-0.453470794812)/(o+1.)+(0.111351337976)
        ref[1,2,0,1]=(1.56202220869)/(o+1.)+(-0.511185001555)
        ref[1,2,1,0]=(0.659810976864)/(o+1.)+(0.621766984989)
        ref[1,2,1,1]=(1.91781515919)/(o+1.)+(0.0691044934815)
        ref[1,2,2,0]=(0.611207129327)/(o+1.)+(-0.497184221995)
        ref[1,2,2,1]=(1.65028805445)/(o+1.)+(-0.0280822974985)
        ref[1,3,0,0]=(-1.28735344741)/(o+1.)+(-0.680605269048)
        ref[1,3,0,1]=(0.256443215625)/(o+1.)+(-0.161440006142)
        ref[1,3,1,0]=(0.561119040305)/(o+1.)+(0.227463879795)
        ref[1,3,1,1]=(0.327555206284)/(o+1.)+(0.29622756806)
        ref[1,3,2,0]=(0.0665337521742)/(o+1.)+(0.77129792303)
        ref[1,3,2,1]=(1.36356118866)/(o+1.)+(-0.0276174494925)
        ref[1,4,0,0]=(0.793908154771)/(o+1.)+(-0.703932363283)
        ref[1,4,0,1]=(0.67317694748)/(o+1.)+(0.419078081349)
        ref[1,4,1,0]=(-1.6259928924)/(o+1.)+(-0.0422868647694)
        ref[1,4,1,1]=(0.573888422973)/(o+1.)+(-0.0709319079127)
        ref[1,4,2,0]=(-1.32097669048)/(o+1.)+(0.981719850544)
        ref[1,4,2,1]=(1.31804256932)/(o+1.)+(-0.464008585329)
        ref[2,0,0,0]=(0.131285227429)/(o+1.)+(-0.27188947549)
        ref[2,0,0,1]=(-0.534412041331)/(o+1.)+(-0.502296977244)
        ref[2,0,1,0]=(0.0835036877928)/(o+1.)+(0.675471052627)
        ref[2,0,1,1]=(-1.0534161098)/(o+1.)+(0.312025059983)
        ref[2,0,2,0]=(0.774008222845)/(o+1.)+(0.668233731266)
        ref[2,0,2,1]=(0.273211710533)/(o+1.)+(-0.656092090992)
        ref[2,1,0,0]=(0.0276836248637)/(o+1.)+(0.0865731702563)
        ref[2,1,0,1]=(-1.45387179966)/(o+1.)+(-0.198937400068)
        ref[2,1,1,0]=(-0.870829853631)/(o+1.)+(-0.523273805792)
        ref[2,1,1,1]=(0.987550331752)/(o+1.)+(-0.871586545966)
        ref[2,1,2,0]=(-0.188404489031)/(o+1.)+(-0.917217646504)
        ref[2,1,2,1]=(1.01318413367)/(o+1.)+(-0.338229998699)
        ref[2,2,0,0]=(-1.14509068713)/(o+1.)+(-0.141129573573)
        ref[2,2,0,1]=(-0.303957214603)/(o+1.)+(-0.966870476981)
        ref[2,2,1,0]=(0.280958273221)/(o+1.)+(0.751037367762)
        ref[2,2,1,1]=(0.761765995326)/(o+1.)+(0.499930134158)
        ref[2,2,2,0]=(-0.0631107493882)/(o+1.)+(0.923031517168)
        ref[2,2,2,1]=(-1.47548256318)/(o+1.)+(-0.516364377092)
        ref[2,3,0,0]=(0.357762298985)/(o+1.)+(0.0357748471536)
        ref[2,3,0,1]=(-1.32702449191)/(o+1.)+(0.569741861035)
        ref[2,3,1,0]=(0.846056405606)/(o+1.)+(0.304580354023)
        ref[2,3,1,1]=(0.842780955061)/(o+1.)+(-0.312530078358)
        ref[2,3,2,0]=(-0.292498051768)/(o+1.)+(-0.319533489098)
        ref[2,3,2,1]=(0.150081567052)/(o+1.)+(0.376801600846)
        ref[2,4,0,0]=(-0.790764630964)/(o+1.)+(0.501833028068)
        ref[2,4,0,1]=(-0.105229058628)/(o+1.)+(0.121379861433)
        ref[2,4,1,0]=(-2.34280312721)/(o+1.)+(-0.557544980779)
        ref[2,4,1,1]=(-0.790806798558)/(o+1.)+(-0.0895273554309)
        ref[2,4,2,0]=(0.912612891478)/(o+1.)+(0.0673322097612)
        ref[2,4,2,1]=(-0.45109893498)/(o+1.)+(-0.213907437562)
        ref[3,0,0,0]=(-1.31264733132)/(o+1.)+(0.743071295917)
        ref[3,0,0,1]=(-1.48221918925)/(o+1.)+(0.884106628208)
        ref[3,0,1,0]=(-0.119070635332)/(o+1.)+(0.21944924039)
        ref[3,0,1,1]=(-0.332877764028)/(o+1.)+(-0.605759458881)
        ref[3,0,2,0]=(0.0337251954668)/(o+1.)+(-0.283202055581)
        ref[3,0,2,1]=(-0.64774468756)/(o+1.)+(-0.465566129216)
        ref[3,1,0,0]=(-1.18814787487)/(o+1.)+(1.10275852067)
        ref[3,1,0,1]=(0.43972319733)/(o+1.)+(0.0116527219252)
        ref[3,1,1,0]=(0.0933525402037)/(o+1.)+(0.644125416616)
        ref[3,1,1,1]=(0.350484486401)/(o+1.)+(-0.161486299395)
        ref[3,1,2,0]=(-0.90157200233)/(o+1.)+(-0.377052217418)
        ref[3,1,2,1]=(-0.442791953392)/(o+1.)+(-0.0467486131556)
        ref[3,2,0,0]=(0.494289265635)/(o+1.)+(0.67957645667)
        ref[3,2,0,1]=(1.21890414616)/(o+1.)+(-0.0371819889285)
        ref[3,2,1,0]=(-0.143804539219)/(o+1.)+(-0.833417204036)
        ref[3,2,1,1]=(-1.30537592015)/(o+1.)+(-0.393002931773)
        ref[3,2,2,0]=(-1.7656669004)/(o+1.)+(-0.0325619704518)
        ref[3,2,2,1]=(1.39446290966)/(o+1.)+(0.635745200922)
        ref[3,3,0,0]=(-0.173532677236)/(o+1.)+(-0.0851405144673)
        ref[3,3,0,1]=(0.788899756292)/(o+1.)+(1.06240519447)
        ref[3,3,1,0]=(-0.211667504994)/(o+1.)+(0.243733371125)
        ref[3,3,1,1]=(0.250188317686)/(o+1.)+(0.824935614572)
        ref[3,3,2,0]=(-0.505941216092)/(o+1.)+(-0.101754380051)
        ref[3,3,2,1]=(-0.655835678211)/(o+1.)+(-0.410846275669)
        ref[3,4,0,0]=(-0.472931122393)/(o+1.)+(0.76114051228)
        ref[3,4,0,1]=(-0.757058628041)/(o+1.)+(-0.0109555593731)
        ref[3,4,1,0]=(-0.645606515671)/(o+1.)+(0.0437191317586)
        ref[3,4,1,1]=(0.510172199852)/(o+1.)+(-0.492773974009)
        ref[3,4,2,0]=(-1.30588633145)/(o+1.)+(0.398235499024)
        ref[3,4,2,1]=(0.257038364674)/(o+1.)+(-0.170739975974)
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.506621877215)*x[0]**o+(-0.45560383685)*x[0]+(-0.598137301806)*x[1]**o+(0.784241595615)*x[1]
        ref=(-0.0915154245913)*(1+2.*(dim-1.)/(o+1.))+(0.328637758765)*dim
      else:
        arg=(-0.505489131484)*x[0]**o+(0.58139159259)*x[0]+(0.458086828888)*x[1]**o+(0.549090746672)*x[1]+(-0.0882325936167)*x[2]**o+(0.0170295954808)*x[2]
        ref=(-0.135634896213)*(1+2.*(dim-1.)/(o+1.))+(1.14751193474)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(-0.88779433873)*x[0]**o+(0.507955012301)*x[0]+(0.652739274924)*x[1]**o+(-0.971975755989)*x[1]
        arg[1]=(-0.0812690931139)*x[0]**o+(-0.283880962354)*x[0]+(0.094904517439)*x[1]**o+(-0.940528164353)*x[1]
        ref[0]=(-0.235055063806)*(1+2.*(dim-1.)/(o+1.))+(-0.464020743688)*dim
        ref[1]=(0.0136354243251)*(1+2.*(dim-1.)/(o+1.))+(-1.22440912671)*dim
      else:
        arg[0]=(-0.506412384389)*x[0]**o+(-0.465794405394)*x[0]+(0.346977499982)*x[1]**o+(0.386181176987)*x[1]+(-0.476729572397)*x[2]**o+(-0.956945933508)*x[2]
        arg[1]=(0.267092807416)*x[0]**o+(-0.54211155802)*x[0]+(-0.27815411727)*x[1]**o+(-0.984542450102)*x[1]+(0.656389296076)*x[2]**o+(0.0395863971401)*x[2]
        ref[0]=(-0.636164456804)*(1+2.*(dim-1.)/(o+1.))+(-1.03655916191)*dim
        ref[1]=(0.645327986222)*(1+2.*(dim-1.)/(o+1.))+(-1.48706761098)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(0.0607636892262)*x[0]**o+(0.740866012668)*x[0]+(0.145223136928)*x[1]**o+(-0.738387773526)*x[1]
        arg[0,1]=(0.0292598484511)*x[0]**o+(-0.189208290889)*x[0]+(0.902021405165)*x[1]**o+(0.423106545559)*x[1]
        arg[0,2]=(0.519658217226)*x[0]**o+(-0.768406018136)*x[0]+(-0.189532527097)*x[1]**o+(0.256417429833)*x[1]
        arg[0,3]=(-0.565327663481)*x[0]**o+(0.876762003673)*x[0]+(-0.243804758063)*x[1]**o+(0.399476036454)*x[1]
        arg[0,4]=(0.0632252409818)*x[0]**o+(0.0951130662538)*x[0]+(0.185662425763)*x[1]**o+(0.907446482506)*x[1]
        arg[1,0]=(-0.430504584794)*x[0]**o+(0.864814314023)*x[0]+(0.47460095501)*x[1]**o+(-0.599679142188)*x[1]
        arg[1,1]=(0.699618175298)*x[0]**o+(-0.561782605517)*x[0]+(-0.304250865015)*x[1]**o+(-0.341836776795)*x[1]
        arg[1,2]=(0.856956767316)*x[0]**o+(0.610026903213)*x[0]+(-0.666749954599)*x[1]**o+(0.885388885234)*x[1]
        arg[1,3]=(0.699377007631)*x[0]**o+(0.699906750287)*x[0]+(0.486690669414)*x[1]**o+(0.167425901549)*x[1]
        arg[1,4]=(0.466701415896)*x[0]**o+(-0.0719752759126)*x[0]+(0.795662047062)*x[1]**o+(0.979862503926)*x[1]
        arg[2,0]=(-0.912218732612)*x[0]**o+(0.950990472894)*x[0]+(-0.527999708902)*x[1]**o+(0.695735593043)*x[1]
        arg[2,1]=(-0.223468270048)*x[0]**o+(-0.882565147673)*x[0]+(0.750516681645)*x[1]**o+(-0.652794590093)*x[1]
        arg[2,2]=(0.897646682412)*x[0]**o+(-0.815401214058)*x[0]+(0.629680741327)*x[1]**o+(-0.9716988156)*x[1]
        arg[2,3]=(0.279739517524)*x[0]**o+(-0.0859797206016)*x[0]+(-0.0454325622757)*x[1]**o+(0.301214753868)*x[1]
        arg[2,4]=(-0.358056827092)*x[0]**o+(0.254207762658)*x[0]+(0.831499219864)*x[1]**o+(0.0930388028811)*x[1]
        arg[3,0]=(0.0761520020047)*x[0]**o+(0.650696394486)*x[0]+(-0.132369660678)*x[1]**o+(-0.321220385971)*x[1]
        arg[3,1]=(0.238715231585)*x[0]**o+(-0.297219391083)*x[0]+(-0.15446552614)*x[1]**o+(0.860560615056)*x[1]
        arg[3,2]=(0.708864754538)*x[0]**o+(-0.221186702958)*x[0]+(-0.478127729891)*x[1]**o+(0.0309604412212)*x[1]
        arg[3,3]=(0.362909366479)*x[0]**o+(0.382279106813)*x[0]+(0.827905062086)*x[1]**o+(-0.303048355949)*x[1]
        arg[3,4]=(0.573736946844)*x[0]**o+(0.645059764766)*x[0]+(0.301945383678)*x[1]**o+(-0.103083649994)*x[1]
        ref[0,0]=(0.205986826154)*(1+2.*(dim-1.)/(o+1.))+(0.0024782391428)*dim
        ref[0,1]=(0.931281253617)*(1+2.*(dim-1.)/(o+1.))+(0.23389825467)*dim
        ref[0,2]=(0.330125690129)*(1+2.*(dim-1.)/(o+1.))+(-0.511988588303)*dim
        ref[0,3]=(-0.809132421544)*(1+2.*(dim-1.)/(o+1.))+(1.27623804013)*dim
        ref[0,4]=(0.248887666745)*(1+2.*(dim-1.)/(o+1.))+(1.00255954876)*dim
        ref[1,0]=(0.044096370216)*(1+2.*(dim-1.)/(o+1.))+(0.265135171835)*dim
        ref[1,1]=(0.395367310283)*(1+2.*(dim-1.)/(o+1.))+(-0.903619382312)*dim
        ref[1,2]=(0.190206812717)*(1+2.*(dim-1.)/(o+1.))+(1.49541578845)*dim
        ref[1,3]=(1.18606767705)*(1+2.*(dim-1.)/(o+1.))+(0.867332651836)*dim
        ref[1,4]=(1.26236346296)*(1+2.*(dim-1.)/(o+1.))+(0.907887228013)*dim
        ref[2,0]=(-1.44021844151)*(1+2.*(dim-1.)/(o+1.))+(1.64672606594)*dim
        ref[2,1]=(0.527048411596)*(1+2.*(dim-1.)/(o+1.))+(-1.53535973777)*dim
        ref[2,2]=(1.52732742374)*(1+2.*(dim-1.)/(o+1.))+(-1.78710002966)*dim
        ref[2,3]=(0.234306955249)*(1+2.*(dim-1.)/(o+1.))+(0.215235033266)*dim
        ref[2,4]=(0.473442392772)*(1+2.*(dim-1.)/(o+1.))+(0.34724656554)*dim
        ref[3,0]=(-0.0562176586729)*(1+2.*(dim-1.)/(o+1.))+(0.329476008516)*dim
        ref[3,1]=(0.0842497054449)*(1+2.*(dim-1.)/(o+1.))+(0.563341223973)*dim
        ref[3,2]=(0.230737024647)*(1+2.*(dim-1.)/(o+1.))+(-0.190226261737)*dim
        ref[3,3]=(1.19081442856)*(1+2.*(dim-1.)/(o+1.))+(0.079230750864)*dim
        ref[3,4]=(0.875682330522)*(1+2.*(dim-1.)/(o+1.))+(0.541976114772)*dim
      else:
        arg[0,0]=(0.0640108068236)*x[0]**o+(0.0322830166043)*x[0]+(-0.703691335255)*x[1]**o+(-0.185228770711)*x[1]+(-0.738714166313)*x[2]**o+(-0.423576647077)*x[2]
        arg[0,1]=(-0.738341351945)*x[0]**o+(0.396306395436)*x[0]+(-0.369974848568)*x[1]**o+(0.750933208783)*x[1]+(0.554069869127)*x[2]**o+(0.634275493051)*x[2]
        arg[0,2]=(-0.259193248708)*x[0]**o+(-0.900007449583)*x[0]+(0.894379436915)*x[1]**o+(0.997814320752)*x[1]+(0.233192116622)*x[2]**o+(0.986616259649)*x[2]
        arg[0,3]=(0.381480250594)*x[0]**o+(0.734823219057)*x[0]+(0.569912440169)*x[1]**o+(-0.441084504695)*x[1]+(0.312539701584)*x[2]**o+(-0.3733004974)*x[2]
        arg[0,4]=(-0.779059807622)*x[0]**o+(0.538777922322)*x[0]+(-0.0695879211612)*x[1]**o+(-0.204862216499)*x[1]+(-0.0109698525672)*x[2]**o+(0.981875117617)*x[2]
        arg[1,0]=(-0.415857630044)*x[0]**o+(-0.356607866913)*x[0]+(-0.628854326903)*x[1]**o+(0.0401233333505)*x[1]+(0.687470169579)*x[2]**o+(-0.565349753114)*x[2]
        arg[1,1]=(-0.438364910402)*x[0]**o+(0.498078194367)*x[0]+(-0.120729597948)*x[1]**o+(-0.622076117713)*x[1]+(0.995130029172)*x[2]**o+(-0.7234601064)*x[2]
        arg[1,2]=(-0.957869585558)*x[0]**o+(0.374693219824)*x[0]+(0.0355192120972)*x[1]**o+(-0.516770140651)*x[1]+(0.521887953791)*x[2]**o+(0.00771564236502)*x[2]
        arg[1,3]=(-0.0495580194062)*x[0]**o+(-0.183895326318)*x[0]+(-0.55304086303)*x[1]**o+(0.920204449879)*x[1]+(0.143165855157)*x[2]**o+(-0.773684620462)*x[2]
        arg[1,4]=(0.795913131087)*x[0]**o+(0.653826129199)*x[0]+(-0.585562760813)*x[1]**o+(0.274083108918)*x[1]+(-0.165275654116)*x[2]**o+(0.358678758212)*x[2]
        arg[2,0]=(-0.0699685857843)*x[0]**o+(-0.42922435931)*x[0]+(-0.0494308981938)*x[1]**o+(-0.956597829176)*x[1]+(-0.912941305307)*x[2]**o+(0.214777332562)*x[2]
        arg[2,1]=(-0.900983338173)*x[0]**o+(-0.779729884378)*x[0]+(-0.860100306508)*x[1]**o+(0.14211537281)*x[1]+(-0.984439938285)*x[2]**o+(-0.549987779842)*x[2]
        arg[2,2]=(0.801489512389)*x[0]**o+(0.896468923826)*x[0]+(-0.155737972887)*x[1]**o+(0.639864330477)*x[1]+(0.798598705038)*x[2]**o+(-0.863019041525)*x[2]
        arg[2,3]=(-0.453612136504)*x[0]**o+(0.522662491688)*x[0]+(-0.463058076486)*x[1]**o+(0.398018809499)*x[1]+(-0.612044961611)*x[2]**o+(-0.481951883217)*x[2]
        arg[2,4]=(-0.0739336519425)*x[0]**o+(-0.241753740154)*x[0]+(0.0176292058898)*x[1]**o+(0.435641132809)*x[1]+(-0.0592828584976)*x[2]**o+(0.430115620801)*x[2]
        arg[3,0]=(0.604784358152)*x[0]**o+(-0.817214179503)*x[0]+(-0.423104272008)*x[1]**o+(0.287787881773)*x[1]+(0.678036469241)*x[2]**o+(0.578347129563)*x[2]
        arg[3,1]=(0.362390778598)*x[0]**o+(-0.389066580119)*x[0]+(-0.934087580396)*x[1]**o+(0.907587485226)*x[1]+(-0.902083043406)*x[2]**o+(0.904707538314)*x[2]
        arg[3,2]=(0.862463207465)*x[0]**o+(0.904923219336)*x[0]+(0.421361696042)*x[1]**o+(-0.779329196171)*x[1]+(0.059521522394)*x[2]**o+(-0.744510067387)*x[2]
        arg[3,3]=(0.412029226851)*x[0]**o+(-0.649730143511)*x[0]+(0.579628017001)*x[1]**o+(-0.949180147129)*x[1]+(-0.073016492309)*x[2]**o+(0.666554170757)*x[2]
        arg[3,4]=(-0.700401396504)*x[0]**o+(-0.89194120812)*x[0]+(0.592387042213)*x[1]**o+(-0.906632787891)*x[1]+(-0.486072860812)*x[2]**o+(-0.505386176523)*x[2]
        ref[0,0]=(-1.37839469474)*(1+2.*(dim-1.)/(o+1.))+(-0.576522401184)*dim
        ref[0,1]=(-0.554246331386)*(1+2.*(dim-1.)/(o+1.))+(1.78151509727)*dim
        ref[0,2]=(0.868378304829)*(1+2.*(dim-1.)/(o+1.))+(1.08442313082)*dim
        ref[0,3]=(1.26393239235)*(1+2.*(dim-1.)/(o+1.))+(-0.0795617830385)*dim
        ref[0,4]=(-0.85961758135)*(1+2.*(dim-1.)/(o+1.))+(1.31579082344)*dim
        ref[1,0]=(-0.357241787368)*(1+2.*(dim-1.)/(o+1.))+(-0.881834286676)*dim
        ref[1,1]=(0.436035520821)*(1+2.*(dim-1.)/(o+1.))+(-0.847458029746)*dim
        ref[1,2]=(-0.40046241967)*(1+2.*(dim-1.)/(o+1.))+(-0.134361278462)*dim
        ref[1,3]=(-0.459433027279)*(1+2.*(dim-1.)/(o+1.))+(-0.0373754969011)*dim
        ref[1,4]=(0.0450747161574)*(1+2.*(dim-1.)/(o+1.))+(1.28658799633)*dim
        ref[2,0]=(-1.03234078929)*(1+2.*(dim-1.)/(o+1.))+(-1.17104485592)*dim
        ref[2,1]=(-2.74552358297)*(1+2.*(dim-1.)/(o+1.))+(-1.18760229141)*dim
        ref[2,2]=(1.44435024454)*(1+2.*(dim-1.)/(o+1.))+(0.673314212777)*dim
        ref[2,3]=(-1.5287151746)*(1+2.*(dim-1.)/(o+1.))+(0.43872941797)*dim
        ref[2,4]=(-0.11558730455)*(1+2.*(dim-1.)/(o+1.))+(0.624003013456)*dim
        ref[3,0]=(0.859716555385)*(1+2.*(dim-1.)/(o+1.))+(0.0489208318321)*dim
        ref[3,1]=(-1.4737798452)*(1+2.*(dim-1.)/(o+1.))+(1.42322844342)*dim
        ref[3,2]=(1.3433464259)*(1+2.*(dim-1.)/(o+1.))+(-0.618916044222)*dim
        ref[3,3]=(0.918640751542)*(1+2.*(dim-1.)/(o+1.))+(-0.932356119883)*dim
        ref[3,4]=(-0.594087215103)*(1+2.*(dim-1.)/(o+1.))+(-2.30396017253)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(0.662707930283)*x[0]**o+(0.625512077969)*x[0]+(-0.222208840922)*x[1]**o+(0.374614317804)*x[1]
        arg[0,0,1]=(0.685952252808)*x[0]**o+(-0.88219802797)*x[0]+(-0.948918831634)*x[1]**o+(-0.00615202896776)*x[1]
        arg[0,1,0]=(-0.555231206657)*x[0]**o+(0.997112425959)*x[0]+(-0.186247870511)*x[1]**o+(-0.0658892046229)*x[1]
        arg[0,1,1]=(-0.735288285178)*x[0]**o+(0.941234848614)*x[0]+(-0.307761737256)*x[1]**o+(0.933293069433)*x[1]
        arg[1,0,0]=(-0.618191337825)*x[0]**o+(-0.12930895166)*x[0]+(0.76213325083)*x[1]**o+(-0.744049403156)*x[1]
        arg[1,0,1]=(-0.793412570981)*x[0]**o+(0.533175323401)*x[0]+(-0.87398581932)*x[1]**o+(-0.279651754725)*x[1]
        arg[1,1,0]=(-0.0654077907694)*x[0]**o+(0.239040458488)*x[0]+(0.730639927837)*x[1]**o+(0.805020533329)*x[1]
        arg[1,1,1]=(-0.560195748542)*x[0]**o+(-0.265389430135)*x[0]+(-0.295142324741)*x[1]**o+(-0.929699771024)*x[1]
        arg[2,0,0]=(0.935760865577)*x[0]**o+(-0.332458843131)*x[0]+(0.257302695187)*x[1]**o+(-0.347547927033)*x[1]
        arg[2,0,1]=(-0.245770653276)*x[0]**o+(0.126945988409)*x[0]+(0.302793434995)*x[1]**o+(-0.997483200172)*x[1]
        arg[2,1,0]=(0.523494364951)*x[0]**o+(-0.323782740449)*x[0]+(-0.563752593454)*x[1]**o+(-0.358325752838)*x[1]
        arg[2,1,1]=(-0.506330114515)*x[0]**o+(-0.733234050567)*x[0]+(0.734774667778)*x[1]**o+(0.795264566776)*x[1]
        arg[3,0,0]=(-0.21258295235)*x[0]**o+(-0.929331330718)*x[0]+(-0.546061847742)*x[1]**o+(0.0613931491065)*x[1]
        arg[3,0,1]=(-0.357847946656)*x[0]**o+(-0.133795684508)*x[0]+(-0.796646028688)*x[1]**o+(0.875795801429)*x[1]
        arg[3,1,0]=(0.923717804039)*x[0]**o+(-0.176266633621)*x[0]+(-0.605892867534)*x[1]**o+(0.633377612365)*x[1]
        arg[3,1,1]=(0.729025508129)*x[0]**o+(0.412034955257)*x[0]+(0.0933054864485)*x[1]**o+(0.386019085532)*x[1]
        arg[4,0,0]=(-0.0705524918008)*x[0]**o+(-0.869605321304)*x[0]+(0.244351267755)*x[1]**o+(0.898883388102)*x[1]
        arg[4,0,1]=(-0.453297333327)*x[0]**o+(-0.67824185123)*x[0]+(0.0497322840245)*x[1]**o+(0.581677879069)*x[1]
        arg[4,1,0]=(0.343975006358)*x[0]**o+(0.724084357103)*x[0]+(-0.186292335362)*x[1]**o+(-0.257997075018)*x[1]
        arg[4,1,1]=(-0.389731923798)*x[0]**o+(0.0949155578616)*x[0]+(-0.298428138752)*x[1]**o+(0.819510069666)*x[1]
        arg[5,0,0]=(0.827670169513)*x[0]**o+(-0.584607978668)*x[0]+(0.669056948658)*x[1]**o+(-0.393158541985)*x[1]
        arg[5,0,1]=(-0.471551968206)*x[0]**o+(-0.339964831396)*x[0]+(0.354554393554)*x[1]**o+(-0.334773591957)*x[1]
        arg[5,1,0]=(0.113562904864)*x[0]**o+(-0.775045505123)*x[0]+(0.783044874931)*x[1]**o+(0.52265843873)*x[1]
        arg[5,1,1]=(-0.115476036205)*x[0]**o+(-0.290822012728)*x[0]+(-0.398510477854)*x[1]**o+(0.398737205542)*x[1]
        ref[0,0,0]=(0.440499089362)*(1+2.*(dim-1.)/(o+1.))+(1.00012639577)*dim
        ref[0,0,1]=(-0.262966578826)*(1+2.*(dim-1.)/(o+1.))+(-0.888350056938)*dim
        ref[0,1,0]=(-0.741479077167)*(1+2.*(dim-1.)/(o+1.))+(0.931223221336)*dim
        ref[0,1,1]=(-1.04305002243)*(1+2.*(dim-1.)/(o+1.))+(1.87452791805)*dim
        ref[1,0,0]=(0.143941913005)*(1+2.*(dim-1.)/(o+1.))+(-0.873358354816)*dim
        ref[1,0,1]=(-1.6673983903)*(1+2.*(dim-1.)/(o+1.))+(0.253523568676)*dim
        ref[1,1,0]=(0.665232137068)*(1+2.*(dim-1.)/(o+1.))+(1.04406099182)*dim
        ref[1,1,1]=(-0.855338073283)*(1+2.*(dim-1.)/(o+1.))+(-1.19508920116)*dim
        ref[2,0,0]=(1.19306356076)*(1+2.*(dim-1.)/(o+1.))+(-0.680006770164)*dim
        ref[2,0,1]=(0.0570227817187)*(1+2.*(dim-1.)/(o+1.))+(-0.870537211764)*dim
        ref[2,1,0]=(-0.0402582285028)*(1+2.*(dim-1.)/(o+1.))+(-0.682108493287)*dim
        ref[2,1,1]=(0.228444553263)*(1+2.*(dim-1.)/(o+1.))+(0.0620305162089)*dim
        ref[3,0,0]=(-0.758644800093)*(1+2.*(dim-1.)/(o+1.))+(-0.867938181611)*dim
        ref[3,0,1]=(-1.15449397534)*(1+2.*(dim-1.)/(o+1.))+(0.742000116921)*dim
        ref[3,1,0]=(0.317824936505)*(1+2.*(dim-1.)/(o+1.))+(0.457110978744)*dim
        ref[3,1,1]=(0.822330994578)*(1+2.*(dim-1.)/(o+1.))+(0.798054040789)*dim
        ref[4,0,0]=(0.173798775954)*(1+2.*(dim-1.)/(o+1.))+(0.0292780667983)*dim
        ref[4,0,1]=(-0.403565049303)*(1+2.*(dim-1.)/(o+1.))+(-0.0965639721601)*dim
        ref[4,1,0]=(0.157682670995)*(1+2.*(dim-1.)/(o+1.))+(0.466087282085)*dim
        ref[4,1,1]=(-0.68816006255)*(1+2.*(dim-1.)/(o+1.))+(0.914425627528)*dim
        ref[5,0,0]=(1.49672711817)*(1+2.*(dim-1.)/(o+1.))+(-0.977766520654)*dim
        ref[5,0,1]=(-0.116997574651)*(1+2.*(dim-1.)/(o+1.))+(-0.674738423353)*dim
        ref[5,1,0]=(0.896607779795)*(1+2.*(dim-1.)/(o+1.))+(-0.252387066394)*dim
        ref[5,1,1]=(-0.513986514058)*(1+2.*(dim-1.)/(o+1.))+(0.107915192814)*dim
      else:
        arg[0,0,0]=(-0.418671467289)*x[0]**o+(0.498387164484)*x[0]+(0.208896299314)*x[1]**o+(-0.643038678771)*x[1]+(-0.85475466439)*x[2]**o+(0.59586368009)*x[2]
        arg[0,0,1]=(0.149229891253)*x[0]**o+(0.229836799955)*x[0]+(0.557946253001)*x[1]**o+(-0.434223003739)*x[1]+(-0.250979831671)*x[2]**o+(0.762582320269)*x[2]
        arg[0,1,0]=(-0.950902166094)*x[0]**o+(-0.312913424444)*x[0]+(-0.573887973428)*x[1]**o+(-0.372485255069)*x[1]+(-0.18228472562)*x[2]**o+(-0.566679093436)*x[2]
        arg[0,1,1]=(-0.191769651257)*x[0]**o+(-0.344504306057)*x[0]+(0.355926399715)*x[1]**o+(-0.721341598375)*x[1]+(0.362401271289)*x[2]**o+(0.601351093654)*x[2]
        arg[1,0,0]=(-0.375572370375)*x[0]**o+(-0.532723139333)*x[0]+(-0.738166755424)*x[1]**o+(0.785506757134)*x[1]+(0.192667976423)*x[2]**o+(-0.06534893872)*x[2]
        arg[1,0,1]=(-0.353750712453)*x[0]**o+(0.401872866285)*x[0]+(-0.747783222746)*x[1]**o+(0.663116752574)*x[1]+(-0.162954382466)*x[2]**o+(0.318112656687)*x[2]
        arg[1,1,0]=(-0.711345828912)*x[0]**o+(0.764701438614)*x[0]+(-0.232576947703)*x[1]**o+(-0.50541791533)*x[1]+(0.604603682696)*x[2]**o+(0.498828792648)*x[2]
        arg[1,1,1]=(-0.72474879447)*x[0]**o+(0.888266999605)*x[0]+(0.639903282531)*x[1]**o+(-0.777435844156)*x[1]+(-0.0814738680964)*x[2]**o+(-0.0135286853237)*x[2]
        arg[2,0,0]=(0.839793308998)*x[0]**o+(0.374051014226)*x[0]+(0.594653957466)*x[1]**o+(-0.962352782345)*x[1]+(0.888632514336)*x[2]**o+(0.491195067464)*x[2]
        arg[2,0,1]=(-0.827615661598)*x[0]**o+(0.675227575488)*x[0]+(-0.93068580658)*x[1]**o+(0.694434337954)*x[1]+(0.3583179263)*x[2]**o+(0.775147111187)*x[2]
        arg[2,1,0]=(-0.772656999491)*x[0]**o+(-0.464476706435)*x[0]+(0.569832694977)*x[1]**o+(0.500517676542)*x[1]+(-0.272153062279)*x[2]**o+(-0.398436498506)*x[2]
        arg[2,1,1]=(-0.3065198839)*x[0]**o+(-0.454353346315)*x[0]+(-0.539448433869)*x[1]**o+(0.776950547078)*x[1]+(-0.987178147402)*x[2]**o+(0.368935549126)*x[2]
        arg[3,0,0]=(-0.516131622594)*x[0]**o+(-0.680922252714)*x[0]+(0.304951059501)*x[1]**o+(-0.236361364379)*x[1]+(-0.37983306233)*x[2]**o+(0.693426329316)*x[2]
        arg[3,0,1]=(0.85094983056)*x[0]**o+(-0.356782375867)*x[0]+(0.362116478047)*x[1]**o+(0.269126381543)*x[1]+(0.950254707197)*x[2]**o+(0.592028802301)*x[2]
        arg[3,1,0]=(-0.17721437307)*x[0]**o+(-0.127432965766)*x[0]+(-0.754975923735)*x[1]**o+(0.755938625221)*x[1]+(0.776393089777)*x[2]**o+(0.913028629874)*x[2]
        arg[3,1,1]=(-0.779840479711)*x[0]**o+(0.432392796542)*x[0]+(0.0457670482312)*x[1]**o+(0.493363120993)*x[1]+(-0.290308698356)*x[2]**o+(0.263565329052)*x[2]
        arg[4,0,0]=(-0.594371032991)*x[0]**o+(0.673573089348)*x[0]+(0.0301238273919)*x[1]**o+(-0.900766544194)*x[1]+(0.937125579182)*x[2]**o+(-0.360512287398)*x[2]
        arg[4,0,1]=(-0.187561420369)*x[0]**o+(-0.727058667406)*x[0]+(0.643904893485)*x[1]**o+(0.547358609515)*x[1]+(-0.810276689361)*x[2]**o+(0.347967967049)*x[2]
        arg[4,1,0]=(0.0261452776327)*x[0]**o+(0.630125453041)*x[0]+(0.884509651558)*x[1]**o+(-0.580251885597)*x[1]+(0.141608918047)*x[2]**o+(0.417140237181)*x[2]
        arg[4,1,1]=(0.943149763428)*x[0]**o+(0.0414421588123)*x[0]+(-0.453944232191)*x[1]**o+(0.817963360891)*x[1]+(-0.0132464046434)*x[2]**o+(-0.247024507218)*x[2]
        arg[5,0,0]=(0.993356103007)*x[0]**o+(-0.604991443085)*x[0]+(-0.0141942193536)*x[1]**o+(-0.467982818195)*x[1]+(0.907608332852)*x[2]**o+(-0.918494340721)*x[2]
        arg[5,0,1]=(0.782079295393)*x[0]**o+(0.0125642236587)*x[0]+(-0.512764292821)*x[1]**o+(-0.0699705327379)*x[1]+(0.141341885735)*x[2]**o+(0.420508183565)*x[2]
        arg[5,1,0]=(-0.835665486427)*x[0]**o+(-0.536850925449)*x[0]+(-0.0958499285885)*x[1]**o+(-0.541119926637)*x[1]+(0.341886033336)*x[2]**o+(-0.772823771771)*x[2]
        arg[5,1,1]=(-0.391737530391)*x[0]**o+(-0.160045087084)*x[0]+(-0.984350699381)*x[1]**o+(0.303782477449)*x[1]+(-0.279906615513)*x[2]**o+(-0.690872289955)*x[2]
        ref[0,0,0]=(-1.06452983237)*(1+2.*(dim-1.)/(o+1.))+(0.451212165803)*dim
        ref[0,0,1]=(0.456196312583)*(1+2.*(dim-1.)/(o+1.))+(0.558196116486)*dim
        ref[0,1,0]=(-1.70707486514)*(1+2.*(dim-1.)/(o+1.))+(-1.25207777295)*dim
        ref[0,1,1]=(0.526558019747)*(1+2.*(dim-1.)/(o+1.))+(-0.464494810779)*dim
        ref[1,0,0]=(-0.921071149376)*(1+2.*(dim-1.)/(o+1.))+(0.187434679081)*dim
        ref[1,0,1]=(-1.26448831766)*(1+2.*(dim-1.)/(o+1.))+(1.38310227555)*dim
        ref[1,1,0]=(-0.339319093919)*(1+2.*(dim-1.)/(o+1.))+(0.758112315932)*dim
        ref[1,1,1]=(-0.166319380035)*(1+2.*(dim-1.)/(o+1.))+(0.0973024701251)*dim
        ref[2,0,0]=(2.3230797808)*(1+2.*(dim-1.)/(o+1.))+(-0.0971067006546)*dim
        ref[2,0,1]=(-1.39998354188)*(1+2.*(dim-1.)/(o+1.))+(2.14480902463)*dim
        ref[2,1,0]=(-0.474977366793)*(1+2.*(dim-1.)/(o+1.))+(-0.362395528399)*dim
        ref[2,1,1]=(-1.83314646517)*(1+2.*(dim-1.)/(o+1.))+(0.69153274989)*dim
        ref[3,0,0]=(-0.591013625423)*(1+2.*(dim-1.)/(o+1.))+(-0.223857287777)*dim
        ref[3,0,1]=(2.1633210158)*(1+2.*(dim-1.)/(o+1.))+(0.504372807977)*dim
        ref[3,1,0]=(-0.155797207029)*(1+2.*(dim-1.)/(o+1.))+(1.54153428933)*dim
        ref[3,1,1]=(-1.02438212984)*(1+2.*(dim-1.)/(o+1.))+(1.18932124659)*dim
        ref[4,0,0]=(0.372878373583)*(1+2.*(dim-1.)/(o+1.))+(-0.587705742243)*dim
        ref[4,0,1]=(-0.353933216245)*(1+2.*(dim-1.)/(o+1.))+(0.168267909158)*dim
        ref[4,1,0]=(1.05226384724)*(1+2.*(dim-1.)/(o+1.))+(0.467013804625)*dim
        ref[4,1,1]=(0.475959126593)*(1+2.*(dim-1.)/(o+1.))+(0.612381012486)*dim
        ref[5,0,0]=(1.88677021651)*(1+2.*(dim-1.)/(o+1.))+(-1.991468602)*dim
        ref[5,0,1]=(0.410656888307)*(1+2.*(dim-1.)/(o+1.))+(0.363101874486)*dim
        ref[5,1,0]=(-0.58962938168)*(1+2.*(dim-1.)/(o+1.))+(-1.85079462386)*dim
        ref[5,1,1]=(-1.65599484529)*(1+2.*(dim-1.)/(o+1.))+(-0.54713489959)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.606358724075)*x[0]**o+(-0.6326664687)*x[0]+(-0.521101256804)*x[1]**o+(0.702113497865)*x[1]
        arg[0,0,0,1]=(0.528315511137)*x[0]**o+(-0.116566989978)*x[0]+(-0.350847384045)*x[1]**o+(-0.581988878345)*x[1]
        arg[0,0,1,0]=(0.565076347032)*x[0]**o+(0.752532782601)*x[0]+(0.00706163321089)*x[1]**o+(-0.89265244135)*x[1]
        arg[0,0,1,1]=(-0.342136497951)*x[0]**o+(0.753153993866)*x[0]+(-0.199643944066)*x[1]**o+(0.995411752312)*x[1]
        arg[0,0,2,0]=(0.621283193015)*x[0]**o+(0.591186318333)*x[0]+(0.880169584588)*x[1]**o+(-0.11839698224)*x[1]
        arg[0,0,2,1]=(-0.831745199475)*x[0]**o+(0.293656166596)*x[0]+(0.0717745661823)*x[1]**o+(0.827680695965)*x[1]
        arg[0,1,0,0]=(0.686864676707)*x[0]**o+(-0.6552976723)*x[0]+(-0.65589888943)*x[1]**o+(-0.878054891784)*x[1]
        arg[0,1,0,1]=(-0.43359086203)*x[0]**o+(0.723819586663)*x[0]+(0.0741799035834)*x[1]**o+(0.13005305188)*x[1]
        arg[0,1,1,0]=(-0.0605346127445)*x[0]**o+(-0.717729061173)*x[0]+(0.825539660518)*x[1]**o+(0.873033938391)*x[1]
        arg[0,1,1,1]=(-0.286483607332)*x[0]**o+(-0.577255191498)*x[0]+(-0.328362280683)*x[1]**o+(0.499078653745)*x[1]
        arg[0,1,2,0]=(-0.334132932545)*x[0]**o+(0.462461110225)*x[0]+(-0.932311565873)*x[1]**o+(0.934683608666)*x[1]
        arg[0,1,2,1]=(-0.383203086272)*x[0]**o+(0.261035781624)*x[0]+(-0.203936125231)*x[1]**o+(0.657584310755)*x[1]
        arg[0,2,0,0]=(-0.637642146695)*x[0]**o+(0.80524493224)*x[0]+(-0.139137135459)*x[1]**o+(0.947434162736)*x[1]
        arg[0,2,0,1]=(-0.0738996477961)*x[0]**o+(0.0663360260869)*x[0]+(-0.599113718918)*x[1]**o+(-0.349514990363)*x[1]
        arg[0,2,1,0]=(-0.0539211250603)*x[0]**o+(0.262567947534)*x[0]+(0.115386681137)*x[1]**o+(-0.68179682822)*x[1]
        arg[0,2,1,1]=(-0.770114869627)*x[0]**o+(-0.388068404619)*x[0]+(-0.712914716647)*x[1]**o+(-0.810536809871)*x[1]
        arg[0,2,2,0]=(0.274425895455)*x[0]**o+(0.338467327995)*x[0]+(-0.78223636363)*x[1]**o+(0.406149090351)*x[1]
        arg[0,2,2,1]=(-0.748672361572)*x[0]**o+(0.508311939723)*x[0]+(0.875797107098)*x[1]**o+(0.0992795348726)*x[1]
        arg[0,3,0,0]=(-0.547350688209)*x[0]**o+(0.671683747412)*x[0]+(-0.0954212965969)*x[1]**o+(0.983487887304)*x[1]
        arg[0,3,0,1]=(0.626104338883)*x[0]**o+(-0.825311449834)*x[0]+(-0.422521614246)*x[1]**o+(0.304208397592)*x[1]
        arg[0,3,1,0]=(0.698777992012)*x[0]**o+(0.00291670095874)*x[0]+(0.327527809646)*x[1]**o+(0.283289333886)*x[1]
        arg[0,3,1,1]=(-0.0197648150597)*x[0]**o+(-0.902860814776)*x[0]+(0.663961228673)*x[1]**o+(0.675952386365)*x[1]
        arg[0,3,2,0]=(0.286747814345)*x[0]**o+(-0.0641946364041)*x[0]+(0.812019228115)*x[1]**o+(-0.225698609001)*x[1]
        arg[0,3,2,1]=(0.879776322226)*x[0]**o+(-0.251856143047)*x[0]+(-0.252403834757)*x[1]**o+(0.650790406323)*x[1]
        arg[0,4,0,0]=(-0.58782572388)*x[0]**o+(-0.144122228965)*x[0]+(0.521707348991)*x[1]**o+(-0.0460840614459)*x[1]
        arg[0,4,0,1]=(-0.777497837497)*x[0]**o+(-0.229011563089)*x[0]+(0.754657080443)*x[1]**o+(-0.690675521089)*x[1]
        arg[0,4,1,0]=(0.351528557097)*x[0]**o+(0.00192986530026)*x[0]+(-0.414849484269)*x[1]**o+(-0.250205659505)*x[1]
        arg[0,4,1,1]=(-0.814037796843)*x[0]**o+(0.00188512986627)*x[0]+(-0.810799710998)*x[1]**o+(-0.114406174711)*x[1]
        arg[0,4,2,0]=(-0.755511212878)*x[0]**o+(-0.502206951212)*x[0]+(0.555738333365)*x[1]**o+(-0.220359547926)*x[1]
        arg[0,4,2,1]=(0.247108894345)*x[0]**o+(0.479239235148)*x[0]+(0.663958827816)*x[1]**o+(0.220938477625)*x[1]
        arg[1,0,0,0]=(0.818774052595)*x[0]**o+(-0.651584728881)*x[0]+(-0.780674092348)*x[1]**o+(-0.397277502644)*x[1]
        arg[1,0,0,1]=(0.482101508249)*x[0]**o+(-0.523618202277)*x[0]+(0.806406836488)*x[1]**o+(-0.883738297664)*x[1]
        arg[1,0,1,0]=(0.272517667346)*x[0]**o+(-0.700461889638)*x[0]+(0.280736354342)*x[1]**o+(0.182983247089)*x[1]
        arg[1,0,1,1]=(0.566589111451)*x[0]**o+(-0.876744547538)*x[0]+(-0.934741703566)*x[1]**o+(-0.562770667492)*x[1]
        arg[1,0,2,0]=(-0.954128714623)*x[0]**o+(0.115699770127)*x[0]+(-0.580663262426)*x[1]**o+(-0.451619694161)*x[1]
        arg[1,0,2,1]=(0.268605150185)*x[0]**o+(-0.233415174179)*x[0]+(0.477143801066)*x[1]**o+(0.443696994244)*x[1]
        arg[1,1,0,0]=(-0.00240846686485)*x[0]**o+(0.776336851643)*x[0]+(0.488314964094)*x[1]**o+(-0.840196476788)*x[1]
        arg[1,1,0,1]=(-0.511732155638)*x[0]**o+(0.528782039485)*x[0]+(0.51274502262)*x[1]**o+(-0.700213610705)*x[1]
        arg[1,1,1,0]=(0.300359000499)*x[0]**o+(0.405101876401)*x[0]+(-0.47022583299)*x[1]**o+(-0.977634916267)*x[1]
        arg[1,1,1,1]=(-0.494482318948)*x[0]**o+(0.254112728167)*x[0]+(-0.541672595343)*x[1]**o+(-0.270970064522)*x[1]
        arg[1,1,2,0]=(-0.586624294233)*x[0]**o+(0.629601920904)*x[0]+(-0.525092252936)*x[1]**o+(-0.44611635978)*x[1]
        arg[1,1,2,1]=(0.716927085139)*x[0]**o+(0.700193925267)*x[0]+(0.0624921446647)*x[1]**o+(0.109485129877)*x[1]
        arg[1,2,0,0]=(0.325729307898)*x[0]**o+(0.773432634097)*x[0]+(-0.675612597356)*x[1]**o+(-0.0554913733692)*x[1]
        arg[1,2,0,1]=(-0.381606382262)*x[0]**o+(-0.689040382854)*x[0]+(-0.580191973398)*x[1]**o+(0.951689147387)*x[1]
        arg[1,2,1,0]=(-0.527642403744)*x[0]**o+(-0.936915203927)*x[0]+(0.631733997289)*x[1]**o+(-0.715975680015)*x[1]
        arg[1,2,1,1]=(0.0886898373323)*x[0]**o+(-0.0943320873915)*x[0]+(0.470668750443)*x[1]**o+(0.773832960093)*x[1]
        arg[1,2,2,0]=(-0.727720290197)*x[0]**o+(0.422119803173)*x[0]+(0.705882951779)*x[1]**o+(-0.350801865244)*x[1]
        arg[1,2,2,1]=(0.879335475407)*x[0]**o+(-0.0307168471577)*x[0]+(0.458578151544)*x[1]**o+(0.788796576339)*x[1]
        arg[1,3,0,0]=(0.182143508146)*x[0]**o+(-0.680787176288)*x[0]+(0.626099489145)*x[1]**o+(-0.771540378408)*x[1]
        arg[1,3,0,1]=(-0.578341681282)*x[0]**o+(0.856407179963)*x[0]+(0.525319425356)*x[1]**o+(0.345651851179)*x[1]
        arg[1,3,1,0]=(-0.316652838058)*x[0]**o+(0.652409898929)*x[0]+(-0.82123442746)*x[1]**o+(-0.136868558081)*x[1]
        arg[1,3,1,1]=(-0.755530700082)*x[0]**o+(0.354429731374)*x[0]+(-0.14330437792)*x[1]**o+(-0.221454495186)*x[1]
        arg[1,3,2,0]=(-0.520261483769)*x[0]**o+(0.0873707179205)*x[0]+(-0.882995356682)*x[1]**o+(-0.773921687804)*x[1]
        arg[1,3,2,1]=(0.404278952718)*x[0]**o+(0.651166017764)*x[0]+(-0.496695253747)*x[1]**o+(0.625671754182)*x[1]
        arg[1,4,0,0]=(-0.730831539043)*x[0]**o+(0.219467989041)*x[0]+(-0.853784008431)*x[1]**o+(0.274799624897)*x[1]
        arg[1,4,0,1]=(0.893313801855)*x[0]**o+(-0.539687651773)*x[0]+(-0.411582029239)*x[1]**o+(-0.293521483805)*x[1]
        arg[1,4,1,0]=(0.484878049594)*x[0]**o+(0.218930293134)*x[0]+(-0.138362733141)*x[1]**o+(-0.663241354177)*x[1]
        arg[1,4,1,1]=(-0.608410207857)*x[0]**o+(-0.0921006917331)*x[0]+(-0.885705130565)*x[1]**o+(0.103724764404)*x[1]
        arg[1,4,2,0]=(0.150946260009)*x[0]**o+(-0.601834829203)*x[0]+(0.0141091402169)*x[1]**o+(-0.98316187826)*x[1]
        arg[1,4,2,1]=(0.98764918249)*x[0]**o+(-0.841155365687)*x[0]+(0.185525084432)*x[1]**o+(-0.613421841538)*x[1]
        arg[2,0,0,0]=(0.485337970037)*x[0]**o+(-0.898602108837)*x[0]+(0.847812629133)*x[1]**o+(-0.23522051021)*x[1]
        arg[2,0,0,1]=(0.835641029366)*x[0]**o+(-0.0524661277338)*x[0]+(0.41697147238)*x[1]**o+(-0.622813671618)*x[1]
        arg[2,0,1,0]=(0.505181088966)*x[0]**o+(-0.870141755006)*x[0]+(0.451139050304)*x[1]**o+(0.957790881903)*x[1]
        arg[2,0,1,1]=(0.822955028051)*x[0]**o+(-0.103028201548)*x[0]+(-0.604614127349)*x[1]**o+(-0.655334670762)*x[1]
        arg[2,0,2,0]=(-0.166647802545)*x[0]**o+(-0.466885186725)*x[0]+(0.0782333081578)*x[1]**o+(0.814414769115)*x[1]
        arg[2,0,2,1]=(-0.980310280968)*x[0]**o+(-0.884306329761)*x[0]+(-0.895550319566)*x[1]**o+(0.160657671233)*x[1]
        arg[2,1,0,0]=(-0.846405435483)*x[0]**o+(-0.625465093616)*x[0]+(-0.0789995975268)*x[1]**o+(-0.440180761086)*x[1]
        arg[2,1,0,1]=(-0.949855662419)*x[0]**o+(-0.013707742372)*x[0]+(0.0397729185783)*x[1]**o+(-0.836054083952)*x[1]
        arg[2,1,1,0]=(0.427246928002)*x[0]**o+(0.835369889909)*x[0]+(0.925300799558)*x[1]**o+(-0.328266770631)*x[1]
        arg[2,1,1,1]=(-0.36143365614)*x[0]**o+(-0.744107540819)*x[0]+(-0.358554131639)*x[1]**o+(-0.562674543946)*x[1]
        arg[2,1,2,0]=(0.60580594275)*x[0]**o+(0.644796993923)*x[0]+(-0.682407021927)*x[1]**o+(0.938016908061)*x[1]
        arg[2,1,2,1]=(-0.934393274317)*x[0]**o+(-0.718420272664)*x[0]+(0.0357039032065)*x[1]**o+(0.446387943344)*x[1]
        arg[2,2,0,0]=(-0.329105411737)*x[0]**o+(0.588935500072)*x[0]+(-0.833362483432)*x[1]**o+(0.629996961074)*x[1]
        arg[2,2,0,1]=(0.723977530226)*x[0]**o+(0.0698430385616)*x[0]+(-0.503761809156)*x[1]**o+(0.907472279839)*x[1]
        arg[2,2,1,0]=(-0.767545510793)*x[0]**o+(0.615094783682)*x[0]+(0.894594933703)*x[1]**o+(0.922357219049)*x[1]
        arg[2,2,1,1]=(-0.155739055576)*x[0]**o+(0.646142299486)*x[0]+(0.865932681534)*x[1]**o+(-0.126887380871)*x[1]
        arg[2,2,2,0]=(-0.629534320112)*x[0]**o+(-0.0904366301836)*x[0]+(0.193019806731)*x[1]**o+(-0.866080160466)*x[1]
        arg[2,2,2,1]=(-0.714527761053)*x[0]**o+(-0.813712879405)*x[0]+(-0.291734238438)*x[1]**o+(0.232675536415)*x[1]
        arg[2,3,0,0]=(-0.447474292879)*x[0]**o+(-0.639046887788)*x[0]+(0.159616683647)*x[1]**o+(0.564127141623)*x[1]
        arg[2,3,0,1]=(-0.608953936619)*x[0]**o+(0.273179484103)*x[0]+(0.42693156927)*x[1]**o+(-0.983331075647)*x[1]
        arg[2,3,1,0]=(0.855859483301)*x[0]**o+(-0.432495503925)*x[0]+(-0.67928203769)*x[1]**o+(-0.856541006702)*x[1]
        arg[2,3,1,1]=(-0.581185594204)*x[0]**o+(0.947720323693)*x[0]+(-0.520212852628)*x[1]**o+(-0.37563221594)*x[1]
        arg[2,3,2,0]=(0.351358492535)*x[0]**o+(0.367210525846)*x[0]+(0.97870179383)*x[1]**o+(-0.199559052968)*x[1]
        arg[2,3,2,1]=(0.797294518541)*x[0]**o+(0.546397721552)*x[0]+(0.374121851646)*x[1]**o+(0.704436689798)*x[1]
        arg[2,4,0,0]=(-0.756047775149)*x[0]**o+(-0.705403684825)*x[0]+(-0.662421213376)*x[1]**o+(0.390069314234)*x[1]
        arg[2,4,0,1]=(-0.658842889869)*x[0]**o+(0.766273769822)*x[0]+(-0.779201775962)*x[1]**o+(-0.968670270742)*x[1]
        arg[2,4,1,0]=(-0.336220564628)*x[0]**o+(-0.134745604319)*x[0]+(0.391939888428)*x[1]**o+(-0.113113999792)*x[1]
        arg[2,4,1,1]=(-0.8345363851)*x[0]**o+(0.339223929857)*x[0]+(0.628403353717)*x[1]**o+(0.799364167182)*x[1]
        arg[2,4,2,0]=(-0.898050446701)*x[0]**o+(-0.666373288962)*x[0]+(-0.620778021659)*x[1]**o+(-0.990359850049)*x[1]
        arg[2,4,2,1]=(-0.933931027675)*x[0]**o+(-0.119077281033)*x[0]+(0.557313533556)*x[1]**o+(0.160336158304)*x[1]
        arg[3,0,0,0]=(0.972462636314)*x[0]**o+(0.607913740671)*x[0]+(0.490168539257)*x[1]**o+(-0.12515921391)*x[1]
        arg[3,0,0,1]=(0.856370886333)*x[0]**o+(-0.143225009869)*x[0]+(-0.330381845603)*x[1]**o+(-0.271958059018)*x[1]
        arg[3,0,1,0]=(0.86742129112)*x[0]**o+(-0.0259756341823)*x[0]+(-0.0137047849942)*x[1]**o+(-0.0165444161044)*x[1]
        arg[3,0,1,1]=(-0.445996036941)*x[0]**o+(0.247936136111)*x[0]+(-0.381484740124)*x[1]**o+(0.836678417006)*x[1]
        arg[3,0,2,0]=(0.161387456771)*x[0]**o+(0.687533753311)*x[0]+(-0.463845417603)*x[1]**o+(0.665023823118)*x[1]
        arg[3,0,2,1]=(0.243410612742)*x[0]**o+(-0.52431675734)*x[0]+(0.75630192488)*x[1]**o+(-0.703601557317)*x[1]
        arg[3,1,0,0]=(0.793530689056)*x[0]**o+(0.814806726176)*x[0]+(0.582051068232)*x[1]**o+(0.692432923027)*x[1]
        arg[3,1,0,1]=(-0.283506909465)*x[0]**o+(0.21438128538)*x[0]+(-0.327476122861)*x[1]**o+(0.990178870269)*x[1]
        arg[3,1,1,0]=(-0.117386491827)*x[0]**o+(0.747771272481)*x[0]+(-0.439767754004)*x[1]**o+(-0.905218338639)*x[1]
        arg[3,1,1,1]=(-0.544805647706)*x[0]**o+(-0.0484033735345)*x[0]+(0.861443439156)*x[1]**o+(-0.992086899129)*x[1]
        arg[3,1,2,0]=(0.596208599112)*x[0]**o+(-0.276136075021)*x[0]+(0.079604120535)*x[1]**o+(0.124232758054)*x[1]
        arg[3,1,2,1]=(0.809847641841)*x[0]**o+(0.956041370087)*x[0]+(0.65224420189)*x[1]**o+(0.565327743771)*x[1]
        arg[3,2,0,0]=(-0.264599479107)*x[0]**o+(-0.276726556903)*x[0]+(0.577911819561)*x[1]**o+(-0.656157381756)*x[1]
        arg[3,2,0,1]=(-0.0636193103458)*x[0]**o+(0.941482878452)*x[0]+(0.877581030494)*x[1]**o+(-0.254911385455)*x[1]
        arg[3,2,1,0]=(-0.28083673633)*x[0]**o+(0.849095032935)*x[0]+(0.6825284068)*x[1]**o+(0.445605171749)*x[1]
        arg[3,2,1,1]=(-0.729331034619)*x[0]**o+(0.036400895394)*x[0]+(0.365733359214)*x[1]**o+(0.0305324156609)*x[1]
        arg[3,2,2,0]=(-0.70932226428)*x[0]**o+(0.310455571562)*x[0]+(-0.101305643894)*x[1]**o+(0.346873071627)*x[1]
        arg[3,2,2,1]=(0.712053329488)*x[0]**o+(-0.845042122758)*x[0]+(0.909517101069)*x[1]**o+(-0.163109058477)*x[1]
        arg[3,3,0,0]=(0.451744730688)*x[0]**o+(0.308756227526)*x[0]+(0.13963307493)*x[1]**o+(-0.945789640023)*x[1]
        arg[3,3,0,1]=(-0.852609785834)*x[0]**o+(-0.821513824231)*x[0]+(-0.544690113726)*x[1]**o+(0.335547843106)*x[1]
        arg[3,3,1,0]=(0.337600834432)*x[0]**o+(-0.170181468776)*x[0]+(-0.302415145845)*x[1]**o+(0.985425450212)*x[1]
        arg[3,3,1,1]=(-0.638242591048)*x[0]**o+(-0.0221442303187)*x[0]+(0.421311946694)*x[1]**o+(-0.43495081316)*x[1]
        arg[3,3,2,0]=(-0.734168622382)*x[0]**o+(-0.889300572069)*x[0]+(0.808161580285)*x[1]**o+(-0.526348332439)*x[1]
        arg[3,3,2,1]=(0.998918324168)*x[0]**o+(-0.953729666152)*x[0]+(0.665101882861)*x[1]**o+(-0.581118145725)*x[1]
        arg[3,4,0,0]=(-0.251226888098)*x[0]**o+(-0.711615999514)*x[0]+(0.291022154479)*x[1]**o+(0.0772744442604)*x[1]
        arg[3,4,0,1]=(0.162379537091)*x[0]**o+(0.363750962136)*x[0]+(0.635943839083)*x[1]**o+(0.513856953389)*x[1]
        arg[3,4,1,0]=(-0.99052354199)*x[0]**o+(0.289202668813)*x[0]+(-0.759078503012)*x[1]**o+(-0.588801682903)*x[1]
        arg[3,4,1,1]=(-0.942278699306)*x[0]**o+(0.476003512559)*x[0]+(0.873920293292)*x[1]**o+(0.867413991424)*x[1]
        arg[3,4,2,0]=(-0.602386702281)*x[0]**o+(0.694432164577)*x[0]+(0.367008950869)*x[1]**o+(-0.803331549449)*x[1]
        arg[3,4,2,1]=(-0.00204465287104)*x[0]**o+(-0.697572466685)*x[0]+(-0.84755978799)*x[1]**o+(-0.758946055726)*x[1]
        ref[0,0,0,0]=(0.0852574672711)*(1+2.*(dim-1.)/(o+1.))+(0.069447029165)*dim
        ref[0,0,0,1]=(0.177468127092)*(1+2.*(dim-1.)/(o+1.))+(-0.698555868323)*dim
        ref[0,0,1,0]=(0.572137980243)*(1+2.*(dim-1.)/(o+1.))+(-0.140119658749)*dim
        ref[0,0,1,1]=(-0.541780442017)*(1+2.*(dim-1.)/(o+1.))+(1.74856574618)*dim
        ref[0,0,2,0]=(1.5014527776)*(1+2.*(dim-1.)/(o+1.))+(0.472789336092)*dim
        ref[0,0,2,1]=(-0.759970633293)*(1+2.*(dim-1.)/(o+1.))+(1.12133686256)*dim
        ref[0,1,0,0]=(0.030965787278)*(1+2.*(dim-1.)/(o+1.))+(-1.53335256408)*dim
        ref[0,1,0,1]=(-0.359410958446)*(1+2.*(dim-1.)/(o+1.))+(0.853872638544)*dim
        ref[0,1,1,0]=(0.765005047774)*(1+2.*(dim-1.)/(o+1.))+(0.155304877218)*dim
        ref[0,1,1,1]=(-0.614845888015)*(1+2.*(dim-1.)/(o+1.))+(-0.0781765377528)*dim
        ref[0,1,2,0]=(-1.26644449842)*(1+2.*(dim-1.)/(o+1.))+(1.39714471889)*dim
        ref[0,1,2,1]=(-0.587139211502)*(1+2.*(dim-1.)/(o+1.))+(0.918620092379)*dim
        ref[0,2,0,0]=(-0.776779282155)*(1+2.*(dim-1.)/(o+1.))+(1.75267909498)*dim
        ref[0,2,0,1]=(-0.673013366714)*(1+2.*(dim-1.)/(o+1.))+(-0.283178964276)*dim
        ref[0,2,1,0]=(0.0614655560763)*(1+2.*(dim-1.)/(o+1.))+(-0.419228880686)*dim
        ref[0,2,1,1]=(-1.48302958627)*(1+2.*(dim-1.)/(o+1.))+(-1.19860521449)*dim
        ref[0,2,2,0]=(-0.507810468175)*(1+2.*(dim-1.)/(o+1.))+(0.744616418346)*dim
        ref[0,2,2,1]=(0.127124745526)*(1+2.*(dim-1.)/(o+1.))+(0.607591474596)*dim
        ref[0,3,0,0]=(-0.642771984806)*(1+2.*(dim-1.)/(o+1.))+(1.65517163472)*dim
        ref[0,3,0,1]=(0.203582724637)*(1+2.*(dim-1.)/(o+1.))+(-0.521103052242)*dim
        ref[0,3,1,0]=(1.02630580166)*(1+2.*(dim-1.)/(o+1.))+(0.286206034845)*dim
        ref[0,3,1,1]=(0.644196413613)*(1+2.*(dim-1.)/(o+1.))+(-0.226908428411)*dim
        ref[0,3,2,0]=(1.09876704246)*(1+2.*(dim-1.)/(o+1.))+(-0.289893245405)*dim
        ref[0,3,2,1]=(0.627372487469)*(1+2.*(dim-1.)/(o+1.))+(0.398934263276)*dim
        ref[0,4,0,0]=(-0.0661183748894)*(1+2.*(dim-1.)/(o+1.))+(-0.190206290411)*dim
        ref[0,4,0,1]=(-0.022840757054)*(1+2.*(dim-1.)/(o+1.))+(-0.919687084178)*dim
        ref[0,4,1,0]=(-0.063320927172)*(1+2.*(dim-1.)/(o+1.))+(-0.248275794205)*dim
        ref[0,4,1,1]=(-1.62483750784)*(1+2.*(dim-1.)/(o+1.))+(-0.112521044845)*dim
        ref[0,4,2,0]=(-0.199772879513)*(1+2.*(dim-1.)/(o+1.))+(-0.722566499138)*dim
        ref[0,4,2,1]=(0.911067722161)*(1+2.*(dim-1.)/(o+1.))+(0.700177712774)*dim
        ref[1,0,0,0]=(0.0380999602468)*(1+2.*(dim-1.)/(o+1.))+(-1.04886223152)*dim
        ref[1,0,0,1]=(1.28850834474)*(1+2.*(dim-1.)/(o+1.))+(-1.40735649994)*dim
        ref[1,0,1,0]=(0.553254021688)*(1+2.*(dim-1.)/(o+1.))+(-0.517478642549)*dim
        ref[1,0,1,1]=(-0.368152592115)*(1+2.*(dim-1.)/(o+1.))+(-1.43951521503)*dim
        ref[1,0,2,0]=(-1.53479197705)*(1+2.*(dim-1.)/(o+1.))+(-0.335919924034)*dim
        ref[1,0,2,1]=(0.745748951251)*(1+2.*(dim-1.)/(o+1.))+(0.210281820065)*dim
        ref[1,1,0,0]=(0.485906497229)*(1+2.*(dim-1.)/(o+1.))+(-0.0638596251453)*dim
        ref[1,1,0,1]=(0.00101286698233)*(1+2.*(dim-1.)/(o+1.))+(-0.17143157122)*dim
        ref[1,1,1,0]=(-0.169866832491)*(1+2.*(dim-1.)/(o+1.))+(-0.572533039866)*dim
        ref[1,1,1,1]=(-1.03615491429)*(1+2.*(dim-1.)/(o+1.))+(-0.016857336355)*dim
        ref[1,1,2,0]=(-1.11171654717)*(1+2.*(dim-1.)/(o+1.))+(0.183485561125)*dim
        ref[1,1,2,1]=(0.779419229804)*(1+2.*(dim-1.)/(o+1.))+(0.809679055143)*dim
        ref[1,2,0,0]=(-0.349883289458)*(1+2.*(dim-1.)/(o+1.))+(0.717941260728)*dim
        ref[1,2,0,1]=(-0.96179835566)*(1+2.*(dim-1.)/(o+1.))+(0.262648764533)*dim
        ref[1,2,1,0]=(0.104091593546)*(1+2.*(dim-1.)/(o+1.))+(-1.65289088394)*dim
        ref[1,2,1,1]=(0.559358587775)*(1+2.*(dim-1.)/(o+1.))+(0.679500872701)*dim
        ref[1,2,2,0]=(-0.0218373384179)*(1+2.*(dim-1.)/(o+1.))+(0.0713179379289)*dim
        ref[1,2,2,1]=(1.33791362695)*(1+2.*(dim-1.)/(o+1.))+(0.758079729181)*dim
        ref[1,3,0,0]=(0.808242997292)*(1+2.*(dim-1.)/(o+1.))+(-1.4523275547)*dim
        ref[1,3,0,1]=(-0.0530222559262)*(1+2.*(dim-1.)/(o+1.))+(1.20205903114)*dim
        ref[1,3,1,0]=(-1.13788726552)*(1+2.*(dim-1.)/(o+1.))+(0.515541340848)*dim
        ref[1,3,1,1]=(-0.898835078002)*(1+2.*(dim-1.)/(o+1.))+(0.132975236188)*dim
        ref[1,3,2,0]=(-1.40325684045)*(1+2.*(dim-1.)/(o+1.))+(-0.686550969884)*dim
        ref[1,3,2,1]=(-0.0924163010291)*(1+2.*(dim-1.)/(o+1.))+(1.27683777195)*dim
        ref[1,4,0,0]=(-1.58461554747)*(1+2.*(dim-1.)/(o+1.))+(0.494267613937)*dim
        ref[1,4,0,1]=(0.481731772616)*(1+2.*(dim-1.)/(o+1.))+(-0.833209135578)*dim
        ref[1,4,1,0]=(0.346515316453)*(1+2.*(dim-1.)/(o+1.))+(-0.444311061043)*dim
        ref[1,4,1,1]=(-1.49411533842)*(1+2.*(dim-1.)/(o+1.))+(0.0116240726713)*dim
        ref[1,4,2,0]=(0.165055400226)*(1+2.*(dim-1.)/(o+1.))+(-1.58499670746)*dim
        ref[1,4,2,1]=(1.17317426692)*(1+2.*(dim-1.)/(o+1.))+(-1.45457720722)*dim
        ref[2,0,0,0]=(1.33315059917)*(1+2.*(dim-1.)/(o+1.))+(-1.13382261905)*dim
        ref[2,0,0,1]=(1.25261250175)*(1+2.*(dim-1.)/(o+1.))+(-0.675279799352)*dim
        ref[2,0,1,0]=(0.95632013927)*(1+2.*(dim-1.)/(o+1.))+(0.0876491268976)*dim
        ref[2,0,1,1]=(0.218340900702)*(1+2.*(dim-1.)/(o+1.))+(-0.75836287231)*dim
        ref[2,0,2,0]=(-0.0884144943875)*(1+2.*(dim-1.)/(o+1.))+(0.34752958239)*dim
        ref[2,0,2,1]=(-1.87586060053)*(1+2.*(dim-1.)/(o+1.))+(-0.723648658528)*dim
        ref[2,1,0,0]=(-0.92540503301)*(1+2.*(dim-1.)/(o+1.))+(-1.0656458547)*dim
        ref[2,1,0,1]=(-0.910082743841)*(1+2.*(dim-1.)/(o+1.))+(-0.849761826324)*dim
        ref[2,1,1,0]=(1.35254772756)*(1+2.*(dim-1.)/(o+1.))+(0.507103119278)*dim
        ref[2,1,1,1]=(-0.719987787779)*(1+2.*(dim-1.)/(o+1.))+(-1.30678208477)*dim
        ref[2,1,2,0]=(-0.0766010791773)*(1+2.*(dim-1.)/(o+1.))+(1.58281390198)*dim
        ref[2,1,2,1]=(-0.89868937111)*(1+2.*(dim-1.)/(o+1.))+(-0.27203232932)*dim
        ref[2,2,0,0]=(-1.16246789517)*(1+2.*(dim-1.)/(o+1.))+(1.21893246115)*dim
        ref[2,2,0,1]=(0.22021572107)*(1+2.*(dim-1.)/(o+1.))+(0.977315318401)*dim
        ref[2,2,1,0]=(0.12704942291)*(1+2.*(dim-1.)/(o+1.))+(1.53745200273)*dim
        ref[2,2,1,1]=(0.710193625958)*(1+2.*(dim-1.)/(o+1.))+(0.519254918615)*dim
        ref[2,2,2,0]=(-0.43651451338)*(1+2.*(dim-1.)/(o+1.))+(-0.956516790649)*dim
        ref[2,2,2,1]=(-1.00626199949)*(1+2.*(dim-1.)/(o+1.))+(-0.581037342991)*dim
        ref[2,3,0,0]=(-0.287857609232)*(1+2.*(dim-1.)/(o+1.))+(-0.0749197461649)*dim
        ref[2,3,0,1]=(-0.182022367349)*(1+2.*(dim-1.)/(o+1.))+(-0.710151591543)*dim
        ref[2,3,1,0]=(0.176577445611)*(1+2.*(dim-1.)/(o+1.))+(-1.28903651063)*dim
        ref[2,3,1,1]=(-1.10139844683)*(1+2.*(dim-1.)/(o+1.))+(0.572088107754)*dim
        ref[2,3,2,0]=(1.33006028637)*(1+2.*(dim-1.)/(o+1.))+(0.167651472878)*dim
        ref[2,3,2,1]=(1.17141637019)*(1+2.*(dim-1.)/(o+1.))+(1.25083441135)*dim
        ref[2,4,0,0]=(-1.41846898852)*(1+2.*(dim-1.)/(o+1.))+(-0.315334370591)*dim
        ref[2,4,0,1]=(-1.43804466583)*(1+2.*(dim-1.)/(o+1.))+(-0.20239650092)*dim
        ref[2,4,1,0]=(0.0557193237997)*(1+2.*(dim-1.)/(o+1.))+(-0.247859604111)*dim
        ref[2,4,1,1]=(-0.206133031383)*(1+2.*(dim-1.)/(o+1.))+(1.13858809704)*dim
        ref[2,4,2,0]=(-1.51882846836)*(1+2.*(dim-1.)/(o+1.))+(-1.65673313901)*dim
        ref[2,4,2,1]=(-0.376617494119)*(1+2.*(dim-1.)/(o+1.))+(0.041258877271)*dim
        ref[3,0,0,0]=(1.46263117557)*(1+2.*(dim-1.)/(o+1.))+(0.482754526761)*dim
        ref[3,0,0,1]=(0.52598904073)*(1+2.*(dim-1.)/(o+1.))+(-0.415183068887)*dim
        ref[3,0,1,0]=(0.853716506126)*(1+2.*(dim-1.)/(o+1.))+(-0.0425200502867)*dim
        ref[3,0,1,1]=(-0.827480777065)*(1+2.*(dim-1.)/(o+1.))+(1.08461455312)*dim
        ref[3,0,2,0]=(-0.302457960832)*(1+2.*(dim-1.)/(o+1.))+(1.35255757643)*dim
        ref[3,0,2,1]=(0.999712537623)*(1+2.*(dim-1.)/(o+1.))+(-1.22791831466)*dim
        ref[3,1,0,0]=(1.37558175729)*(1+2.*(dim-1.)/(o+1.))+(1.5072396492)*dim
        ref[3,1,0,1]=(-0.610983032326)*(1+2.*(dim-1.)/(o+1.))+(1.20456015565)*dim
        ref[3,1,1,0]=(-0.557154245831)*(1+2.*(dim-1.)/(o+1.))+(-0.157447066158)*dim
        ref[3,1,1,1]=(0.316637791451)*(1+2.*(dim-1.)/(o+1.))+(-1.04049027266)*dim
        ref[3,1,2,0]=(0.675812719647)*(1+2.*(dim-1.)/(o+1.))+(-0.151903316967)*dim
        ref[3,1,2,1]=(1.46209184373)*(1+2.*(dim-1.)/(o+1.))+(1.52136911386)*dim
        ref[3,2,0,0]=(0.313312340454)*(1+2.*(dim-1.)/(o+1.))+(-0.93288393866)*dim
        ref[3,2,0,1]=(0.813961720148)*(1+2.*(dim-1.)/(o+1.))+(0.686571492997)*dim
        ref[3,2,1,0]=(0.40169167047)*(1+2.*(dim-1.)/(o+1.))+(1.29470020468)*dim
        ref[3,2,1,1]=(-0.363597675405)*(1+2.*(dim-1.)/(o+1.))+(0.066933311055)*dim
        ref[3,2,2,0]=(-0.810627908174)*(1+2.*(dim-1.)/(o+1.))+(0.657328643189)*dim
        ref[3,2,2,1]=(1.62157043056)*(1+2.*(dim-1.)/(o+1.))+(-1.00815118124)*dim
        ref[3,3,0,0]=(0.591377805617)*(1+2.*(dim-1.)/(o+1.))+(-0.637033412497)*dim
        ref[3,3,0,1]=(-1.39729989956)*(1+2.*(dim-1.)/(o+1.))+(-0.485965981125)*dim
        ref[3,3,1,0]=(0.0351856885862)*(1+2.*(dim-1.)/(o+1.))+(0.815243981437)*dim
        ref[3,3,1,1]=(-0.216930644354)*(1+2.*(dim-1.)/(o+1.))+(-0.457095043478)*dim
        ref[3,3,2,0]=(0.0739929579029)*(1+2.*(dim-1.)/(o+1.))+(-1.41564890451)*dim
        ref[3,3,2,1]=(1.66402020703)*(1+2.*(dim-1.)/(o+1.))+(-1.53484781188)*dim
        ref[3,4,0,0]=(0.0397952663815)*(1+2.*(dim-1.)/(o+1.))+(-0.634341555254)*dim
        ref[3,4,0,1]=(0.798323376174)*(1+2.*(dim-1.)/(o+1.))+(0.877607915525)*dim
        ref[3,4,1,0]=(-1.749602045)*(1+2.*(dim-1.)/(o+1.))+(-0.29959901409)*dim
        ref[3,4,1,1]=(-0.0683584060144)*(1+2.*(dim-1.)/(o+1.))+(1.34341750398)*dim
        ref[3,4,2,0]=(-0.235377751413)*(1+2.*(dim-1.)/(o+1.))+(-0.108899384872)*dim
        ref[3,4,2,1]=(-0.849604440861)*(1+2.*(dim-1.)/(o+1.))+(-1.45651852241)*dim
      else:
        arg[0,0,0,0]=(-0.229219068739)*x[0]**o+(0.293241016924)*x[0]+(-0.2730739542)*x[1]**o+(0.980438707356)*x[1]+(-0.712463216466)*x[2]**o+(0.201036317883)*x[2]
        arg[0,0,0,1]=(0.626271947422)*x[0]**o+(0.379293769575)*x[0]+(-0.476378592342)*x[1]**o+(-0.0089906260934)*x[1]+(-0.433154385811)*x[2]**o+(0.126766298748)*x[2]
        arg[0,0,1,0]=(-0.517950283035)*x[0]**o+(-0.219780986066)*x[0]+(0.345048580545)*x[1]**o+(0.116833851128)*x[1]+(-0.790641523314)*x[2]**o+(0.40506306417)*x[2]
        arg[0,0,1,1]=(0.910924420538)*x[0]**o+(0.281102231596)*x[0]+(0.115454208619)*x[1]**o+(0.164254056171)*x[1]+(0.44960060103)*x[2]**o+(-0.14238069165)*x[2]
        arg[0,0,2,0]=(0.86195808217)*x[0]**o+(0.775425956811)*x[0]+(0.214559021523)*x[1]**o+(0.400663063038)*x[1]+(0.995663608954)*x[2]**o+(0.228658543268)*x[2]
        arg[0,0,2,1]=(0.9025917492)*x[0]**o+(0.643205662573)*x[0]+(-0.304382459664)*x[1]**o+(-0.653256441532)*x[1]+(0.591142459807)*x[2]**o+(-0.888899030043)*x[2]
        arg[0,1,0,0]=(-0.874720784838)*x[0]**o+(-0.961456282274)*x[0]+(-0.954972993457)*x[1]**o+(0.00963939708746)*x[1]+(-0.884848381277)*x[2]**o+(-0.859924591622)*x[2]
        arg[0,1,0,1]=(0.133592941787)*x[0]**o+(0.12505415793)*x[0]+(-0.872197297559)*x[1]**o+(-0.666936976734)*x[1]+(-0.540166108036)*x[2]**o+(0.739145002101)*x[2]
        arg[0,1,1,0]=(0.543825266564)*x[0]**o+(0.167854064952)*x[0]+(-0.876426395953)*x[1]**o+(0.317538118917)*x[1]+(0.0454531201303)*x[2]**o+(0.822731343286)*x[2]
        arg[0,1,1,1]=(0.294557050513)*x[0]**o+(0.811698886899)*x[0]+(0.906213580147)*x[1]**o+(0.47895749797)*x[1]+(-0.937617554883)*x[2]**o+(0.171907458148)*x[2]
        arg[0,1,2,0]=(-0.843310949654)*x[0]**o+(0.766452648675)*x[0]+(-0.801151193917)*x[1]**o+(-0.373068887299)*x[1]+(-0.908043738284)*x[2]**o+(0.742278324563)*x[2]
        arg[0,1,2,1]=(-0.83259110525)*x[0]**o+(-0.303796015231)*x[0]+(0.153727560059)*x[1]**o+(-0.848393854019)*x[1]+(0.887795931916)*x[2]**o+(0.713486413074)*x[2]
        arg[0,2,0,0]=(-0.928603918182)*x[0]**o+(0.631213545526)*x[0]+(0.0149216054247)*x[1]**o+(0.136454313226)*x[1]+(-0.182080277504)*x[2]**o+(-0.898437757742)*x[2]
        arg[0,2,0,1]=(0.553844129645)*x[0]**o+(0.91439079798)*x[0]+(0.260424446678)*x[1]**o+(0.786629777779)*x[1]+(-0.412353876109)*x[2]**o+(0.496953000487)*x[2]
        arg[0,2,1,0]=(-0.48365422571)*x[0]**o+(-0.772252454664)*x[0]+(0.692592845143)*x[1]**o+(0.861992232175)*x[1]+(0.65169271692)*x[2]**o+(0.889175716524)*x[2]
        arg[0,2,1,1]=(-0.761086015475)*x[0]**o+(-0.616528617148)*x[0]+(-0.949399556926)*x[1]**o+(-0.783355074724)*x[1]+(-0.260470660608)*x[2]**o+(-0.854537542803)*x[2]
        arg[0,2,2,0]=(-0.812649439778)*x[0]**o+(-0.844862957855)*x[0]+(0.719928253134)*x[1]**o+(-0.892803903061)*x[1]+(-0.434753054503)*x[2]**o+(0.814188548451)*x[2]
        arg[0,2,2,1]=(-0.831106881173)*x[0]**o+(0.893305297647)*x[0]+(-0.351357795644)*x[1]**o+(0.0318574503478)*x[1]+(0.721896657873)*x[2]**o+(-0.75215838035)*x[2]
        arg[0,3,0,0]=(-0.868084492214)*x[0]**o+(-0.108398365838)*x[0]+(0.994384983885)*x[1]**o+(0.199445529335)*x[1]+(-0.570120483013)*x[2]**o+(0.992752456282)*x[2]
        arg[0,3,0,1]=(-0.304553428923)*x[0]**o+(-0.589461304318)*x[0]+(-0.570142565817)*x[1]**o+(-0.858530013475)*x[1]+(0.0690574539796)*x[2]**o+(-0.0321587525658)*x[2]
        arg[0,3,1,0]=(-0.729413026954)*x[0]**o+(-0.728248951404)*x[0]+(-0.568598599095)*x[1]**o+(0.0823012989572)*x[1]+(0.248614424573)*x[2]**o+(-0.116584878805)*x[2]
        arg[0,3,1,1]=(0.586846538084)*x[0]**o+(-0.406933529762)*x[0]+(0.839125682244)*x[1]**o+(0.237338453386)*x[1]+(-0.953101889056)*x[2]**o+(0.164147861616)*x[2]
        arg[0,3,2,0]=(-0.603895026116)*x[0]**o+(-0.401045478885)*x[0]+(-0.524739550832)*x[1]**o+(-0.077907095917)*x[1]+(0.535404409567)*x[2]**o+(0.745721528391)*x[2]
        arg[0,3,2,1]=(-0.189151084147)*x[0]**o+(-0.865927541126)*x[0]+(0.55265091657)*x[1]**o+(-0.592847311104)*x[1]+(-0.467509383222)*x[2]**o+(-0.779649276678)*x[2]
        arg[0,4,0,0]=(-0.564283606569)*x[0]**o+(-0.588029571592)*x[0]+(0.544948665159)*x[1]**o+(0.140885576219)*x[1]+(-0.333531842397)*x[2]**o+(-0.579095398292)*x[2]
        arg[0,4,0,1]=(-0.189127238455)*x[0]**o+(-0.693907127162)*x[0]+(0.40947793861)*x[1]**o+(-0.371098494308)*x[1]+(-0.189273002147)*x[2]**o+(-0.863169616331)*x[2]
        arg[0,4,1,0]=(-0.929838141145)*x[0]**o+(-0.0237583231579)*x[0]+(0.721069982341)*x[1]**o+(0.0378559913864)*x[1]+(-0.354729434476)*x[2]**o+(0.486256042969)*x[2]
        arg[0,4,1,1]=(0.349085173473)*x[0]**o+(0.398939355666)*x[0]+(-0.165772805366)*x[1]**o+(-0.532771334584)*x[1]+(-0.971868054413)*x[2]**o+(-0.38430185761)*x[2]
        arg[0,4,2,0]=(0.0330282399287)*x[0]**o+(0.157336131691)*x[0]+(-0.232739262685)*x[1]**o+(-0.280149712596)*x[1]+(0.374058430291)*x[2]**o+(0.594113015973)*x[2]
        arg[0,4,2,1]=(0.841740974112)*x[0]**o+(-0.454359680369)*x[0]+(-0.29970574726)*x[1]**o+(-0.234747232007)*x[1]+(0.590942390095)*x[2]**o+(-0.241807214234)*x[2]
        arg[1,0,0,0]=(0.815585848775)*x[0]**o+(-0.915020392674)*x[0]+(-0.0246530790781)*x[1]**o+(-0.783552074981)*x[1]+(0.539847778607)*x[2]**o+(-0.239345161181)*x[2]
        arg[1,0,0,1]=(-0.34212551354)*x[0]**o+(-0.231769108271)*x[0]+(-0.495709071836)*x[1]**o+(-0.301124823696)*x[1]+(-0.567450536966)*x[2]**o+(0.553640896859)*x[2]
        arg[1,0,1,0]=(0.507091065517)*x[0]**o+(-0.844317985101)*x[0]+(0.488126307787)*x[1]**o+(-0.624165922596)*x[1]+(0.00960189690918)*x[2]**o+(-0.35617062688)*x[2]
        arg[1,0,1,1]=(-0.219877421252)*x[0]**o+(-0.574843930095)*x[0]+(-0.846995760292)*x[1]**o+(-0.778496435041)*x[1]+(-0.817593097977)*x[2]**o+(0.387406829939)*x[2]
        arg[1,0,2,0]=(-0.774922277048)*x[0]**o+(-0.238152671014)*x[0]+(-0.913770877808)*x[1]**o+(-0.737305937434)*x[1]+(-0.13977056904)*x[2]**o+(-0.0156668131016)*x[2]
        arg[1,0,2,1]=(0.565993265911)*x[0]**o+(0.0690768496992)*x[0]+(-0.019845214223)*x[1]**o+(0.16253166701)*x[1]+(0.848117215885)*x[2]**o+(0.838075165243)*x[2]
        arg[1,1,0,0]=(0.871499694148)*x[0]**o+(-0.640851595157)*x[0]+(-0.170827284611)*x[1]**o+(-0.855550549988)*x[1]+(0.796086141249)*x[2]**o+(-0.214410672377)*x[2]
        arg[1,1,0,1]=(-0.903644604832)*x[0]**o+(0.0604780584681)*x[0]+(0.12800839523)*x[1]**o+(-0.594186752891)*x[1]+(0.415537334962)*x[2]**o+(0.122944611099)*x[2]
        arg[1,1,1,0]=(-0.611432775957)*x[0]**o+(0.391078622669)*x[0]+(-0.943091949273)*x[1]**o+(0.952739057317)*x[1]+(0.205104161722)*x[2]**o+(-0.946040001739)*x[2]
        arg[1,1,1,1]=(0.122941344579)*x[0]**o+(0.836981501711)*x[0]+(0.488970739079)*x[1]**o+(0.210062341907)*x[1]+(0.0264620393683)*x[2]**o+(-0.396386059797)*x[2]
        arg[1,1,2,0]=(-0.782658774038)*x[0]**o+(0.00611865020069)*x[0]+(0.806802875462)*x[1]**o+(-0.504323859583)*x[1]+(0.796276800331)*x[2]**o+(-0.792865116401)*x[2]
        arg[1,1,2,1]=(-0.249170081188)*x[0]**o+(-0.0234780571796)*x[0]+(-0.314017467872)*x[1]**o+(-0.0819148249592)*x[1]+(-0.71553368486)*x[2]**o+(0.763463207899)*x[2]
        arg[1,2,0,0]=(-0.722263632571)*x[0]**o+(-0.922870211147)*x[0]+(0.380794419995)*x[1]**o+(-0.76088532378)*x[1]+(0.417253071012)*x[2]**o+(0.152980049966)*x[2]
        arg[1,2,0,1]=(-0.667661997967)*x[0]**o+(-0.520570751147)*x[0]+(0.526368189149)*x[1]**o+(-0.0729376045288)*x[1]+(-0.434764684251)*x[2]**o+(0.124284939267)*x[2]
        arg[1,2,1,0]=(0.610868035553)*x[0]**o+(0.958644088455)*x[0]+(0.876029854699)*x[1]**o+(-0.278348787699)*x[1]+(-0.576695356283)*x[2]**o+(-0.302696556744)*x[2]
        arg[1,2,1,1]=(-0.224897853162)*x[0]**o+(0.89405397732)*x[0]+(-0.865281799513)*x[1]**o+(0.778866760053)*x[1]+(-0.939295291326)*x[2]**o+(0.256725768393)*x[2]
        arg[1,2,2,0]=(0.763785330202)*x[0]**o+(-0.92861265304)*x[0]+(-0.73488309202)*x[1]**o+(0.912711310857)*x[1]+(-0.359622626692)*x[2]**o+(-0.901261216611)*x[2]
        arg[1,2,2,1]=(-0.70687794303)*x[0]**o+(0.186497640523)*x[0]+(-0.587602932017)*x[1]**o+(0.439204174904)*x[1]+(0.0527573129765)*x[2]**o+(-0.121921819047)*x[2]
        arg[1,3,0,0]=(-0.576513727689)*x[0]**o+(0.228971758182)*x[0]+(0.282735129059)*x[1]**o+(-0.375270097915)*x[1]+(0.360087142563)*x[2]**o+(-0.0629946372113)*x[2]
        arg[1,3,0,1]=(-0.934375471561)*x[0]**o+(-0.710481522462)*x[0]+(-0.506438555546)*x[1]**o+(0.515278994703)*x[1]+(-0.789552111338)*x[2]**o+(0.556694887963)*x[2]
        arg[1,3,1,0]=(0.418081142778)*x[0]**o+(-0.990334755424)*x[0]+(0.465998147831)*x[1]**o+(0.85211792131)*x[1]+(0.64293315455)*x[2]**o+(0.418636667223)*x[2]
        arg[1,3,1,1]=(-0.192682640907)*x[0]**o+(-0.367176463246)*x[0]+(-0.512565915338)*x[1]**o+(0.431102518715)*x[1]+(-0.0213613616827)*x[2]**o+(-0.329868944656)*x[2]
        arg[1,3,2,0]=(-0.63277285658)*x[0]**o+(0.679819079734)*x[0]+(0.986520110022)*x[1]**o+(0.988046257154)*x[1]+(0.973419900492)*x[2]**o+(-0.177540534942)*x[2]
        arg[1,3,2,1]=(-0.660456888389)*x[0]**o+(0.546277948387)*x[0]+(-0.437065207396)*x[1]**o+(-0.310754727958)*x[1]+(-0.786950057282)*x[2]**o+(0.959526365177)*x[2]
        arg[1,4,0,0]=(0.764190976082)*x[0]**o+(0.970535029727)*x[0]+(0.389051006993)*x[1]**o+(-0.289346925704)*x[1]+(-0.386263606576)*x[2]**o+(0.624234063589)*x[2]
        arg[1,4,0,1]=(-0.982030683687)*x[0]**o+(-0.310500292581)*x[0]+(-0.559096285575)*x[1]**o+(-0.622541272039)*x[1]+(0.49924233081)*x[2]**o+(-0.219258681197)*x[2]
        arg[1,4,1,0]=(-0.124268932891)*x[0]**o+(0.102696501388)*x[0]+(-0.135123912862)*x[1]**o+(-0.960215132796)*x[1]+(-0.63171550556)*x[2]**o+(-0.493725285999)*x[2]
        arg[1,4,1,1]=(-0.397915436399)*x[0]**o+(-0.629822230732)*x[0]+(-0.65097233947)*x[1]**o+(0.915396047247)*x[1]+(0.835684562564)*x[2]**o+(-0.538096550078)*x[2]
        arg[1,4,2,0]=(-0.946429448216)*x[0]**o+(-0.310412085571)*x[0]+(-0.0984587257278)*x[1]**o+(-0.662090989911)*x[1]+(-0.424711481307)*x[2]**o+(0.00916879493127)*x[2]
        arg[1,4,2,1]=(0.919399549311)*x[0]**o+(-0.890110018315)*x[0]+(-0.685928475328)*x[1]**o+(-0.4731186395)*x[1]+(0.961887038718)*x[2]**o+(0.850957316131)*x[2]
        arg[2,0,0,0]=(0.834851801283)*x[0]**o+(-0.401572429371)*x[0]+(0.313309302528)*x[1]**o+(0.0368590314435)*x[1]+(-0.299807168778)*x[2]**o+(0.250599904818)*x[2]
        arg[2,0,0,1]=(-0.717562866174)*x[0]**o+(0.374797888506)*x[0]+(0.254329847579)*x[1]**o+(-0.987429692718)*x[1]+(-0.886758521324)*x[2]**o+(0.309486900444)*x[2]
        arg[2,0,1,0]=(0.139962143021)*x[0]**o+(-0.134735774213)*x[0]+(-0.231254041503)*x[1]**o+(0.0694785371931)*x[1]+(0.769929630132)*x[2]**o+(0.486646094292)*x[2]
        arg[2,0,1,1]=(0.349691701871)*x[0]**o+(-0.0308285150496)*x[0]+(0.00977143515921)*x[1]**o+(0.0970015800122)*x[1]+(-0.725991176667)*x[2]**o+(0.433663449433)*x[2]
        arg[2,0,2,0]=(0.564474039592)*x[0]**o+(0.950620065312)*x[0]+(0.256658075134)*x[1]**o+(0.774458453189)*x[1]+(0.00181734756534)*x[2]**o+(-0.270638852561)*x[2]
        arg[2,0,2,1]=(-0.175813811707)*x[0]**o+(0.821341326493)*x[0]+(-0.464966990893)*x[1]**o+(-0.310747066257)*x[1]+(-0.413557861251)*x[2]**o+(-0.799160067701)*x[2]
        arg[2,1,0,0]=(-0.449817381621)*x[0]**o+(-0.0573780378383)*x[0]+(-0.22675349133)*x[1]**o+(-0.150314340624)*x[1]+(-0.116693721705)*x[2]**o+(-0.20577625675)*x[2]
        arg[2,1,0,1]=(0.955318430674)*x[0]**o+(-0.148100168239)*x[0]+(0.741705440574)*x[1]**o+(-0.0768022054634)*x[1]+(-0.721807872287)*x[2]**o+(-0.898235041116)*x[2]
        arg[2,1,1,0]=(-0.183120810472)*x[0]**o+(0.307305712226)*x[0]+(0.699835684443)*x[1]**o+(0.964082351856)*x[1]+(-0.0348051023458)*x[2]**o+(0.544435382916)*x[2]
        arg[2,1,1,1]=(0.786862912642)*x[0]**o+(0.37388939814)*x[0]+(0.608937302857)*x[1]**o+(0.122305286217)*x[1]+(-0.892536849678)*x[2]**o+(0.119257478145)*x[2]
        arg[2,1,2,0]=(0.758154908623)*x[0]**o+(0.695188856067)*x[0]+(0.458313343957)*x[1]**o+(0.979157471455)*x[1]+(0.194237063725)*x[2]**o+(0.773001101454)*x[2]
        arg[2,1,2,1]=(0.0754678814151)*x[0]**o+(-0.639556181007)*x[0]+(0.934627102078)*x[1]**o+(0.0832082572611)*x[1]+(0.668822756858)*x[2]**o+(0.627532210297)*x[2]
        arg[2,2,0,0]=(-0.192921889174)*x[0]**o+(0.989703287553)*x[0]+(0.00517568784693)*x[1]**o+(-0.360076937731)*x[1]+(0.947056110784)*x[2]**o+(0.469841550381)*x[2]
        arg[2,2,0,1]=(0.201501669595)*x[0]**o+(-0.959957961834)*x[0]+(0.0229159090152)*x[1]**o+(0.396188263084)*x[1]+(0.186211667989)*x[2]**o+(0.304503474778)*x[2]
        arg[2,2,1,0]=(0.333974995608)*x[0]**o+(0.210202867626)*x[0]+(-0.410565897643)*x[1]**o+(0.52659985644)*x[1]+(0.983960564934)*x[2]**o+(-0.439323691866)*x[2]
        arg[2,2,1,1]=(0.706119074329)*x[0]**o+(-0.00220875175563)*x[0]+(0.143693169123)*x[1]**o+(0.217254593235)*x[1]+(-0.412057975252)*x[2]**o+(-0.967360361422)*x[2]
        arg[2,2,2,0]=(0.217307356597)*x[0]**o+(0.861728452163)*x[0]+(-0.193239462241)*x[1]**o+(0.872273176526)*x[1]+(-0.436414721507)*x[2]**o+(-0.62398425635)*x[2]
        arg[2,2,2,1]=(0.467099668794)*x[0]**o+(0.109742400918)*x[0]+(-0.987522191801)*x[1]**o+(-0.250251964275)*x[1]+(0.442152166523)*x[2]**o+(-0.709157679576)*x[2]
        arg[2,3,0,0]=(0.769666242031)*x[0]**o+(0.2352745864)*x[0]+(-0.302893533611)*x[1]**o+(0.0806677655098)*x[1]+(0.886434893279)*x[2]**o+(0.366016417047)*x[2]
        arg[2,3,0,1]=(-0.612204706187)*x[0]**o+(-0.242961993133)*x[0]+(0.946225816441)*x[1]**o+(0.528642650581)*x[1]+(-0.0166837450337)*x[2]**o+(-0.0889397945206)*x[2]
        arg[2,3,1,0]=(0.218589745288)*x[0]**o+(-0.296125811204)*x[0]+(0.358743045538)*x[1]**o+(-0.945778818656)*x[1]+(-0.33155158646)*x[2]**o+(-0.293038455557)*x[2]
        arg[2,3,1,1]=(0.753737723433)*x[0]**o+(-0.772926141856)*x[0]+(-0.0107183417902)*x[1]**o+(0.125538612735)*x[1]+(0.225277420156)*x[2]**o+(-0.54876651451)*x[2]
        arg[2,3,2,0]=(0.947419453319)*x[0]**o+(-0.101935160067)*x[0]+(0.481841505589)*x[1]**o+(-0.873842146032)*x[1]+(-0.377764402402)*x[2]**o+(-0.361560947647)*x[2]
        arg[2,3,2,1]=(0.745703609187)*x[0]**o+(-0.488401078192)*x[0]+(0.190261500318)*x[1]**o+(-0.22176180212)*x[1]+(0.80182740764)*x[2]**o+(-0.504953098351)*x[2]
        arg[2,4,0,0]=(0.476355625206)*x[0]**o+(0.452225231178)*x[0]+(0.669315429911)*x[1]**o+(0.159511010158)*x[1]+(0.652056592943)*x[2]**o+(0.44515033609)*x[2]
        arg[2,4,0,1]=(0.512194809916)*x[0]**o+(0.654452558318)*x[0]+(-0.526832882528)*x[1]**o+(0.590859897981)*x[1]+(-0.155989159043)*x[2]**o+(-0.689178072559)*x[2]
        arg[2,4,1,0]=(0.0450244624553)*x[0]**o+(0.0790299000335)*x[0]+(-0.690643908994)*x[1]**o+(-0.262426911912)*x[1]+(-0.426935471303)*x[2]**o+(-0.434570506153)*x[2]
        arg[2,4,1,1]=(-0.04445890079)*x[0]**o+(-0.541574770252)*x[0]+(-0.879290270122)*x[1]**o+(0.545302743626)*x[1]+(-0.836472565261)*x[2]**o+(0.66750272736)*x[2]
        arg[2,4,2,0]=(-0.477788509677)*x[0]**o+(0.706195950613)*x[0]+(0.628430029293)*x[1]**o+(-0.297608932813)*x[1]+(0.38364501438)*x[2]**o+(0.855444938831)*x[2]
        arg[2,4,2,1]=(0.123183000451)*x[0]**o+(0.41176132265)*x[0]+(-0.379498883356)*x[1]**o+(-0.53442961658)*x[1]+(-0.101215056317)*x[2]**o+(0.247971839461)*x[2]
        arg[3,0,0,0]=(-0.239170701904)*x[0]**o+(0.369420936359)*x[0]+(0.972913513036)*x[1]**o+(0.775248415403)*x[1]+(-0.850310640223)*x[2]**o+(-0.815345534491)*x[2]
        arg[3,0,0,1]=(0.591124498004)*x[0]**o+(0.529522171858)*x[0]+(-0.974005221641)*x[1]**o+(0.430102201571)*x[1]+(0.570519406976)*x[2]**o+(-0.0915083364671)*x[2]
        arg[3,0,1,0]=(-0.27678065557)*x[0]**o+(-0.53225308602)*x[0]+(0.902356190541)*x[1]**o+(-0.564808732046)*x[1]+(0.0981283775668)*x[2]**o+(-0.64957631107)*x[2]
        arg[3,0,1,1]=(0.230523873408)*x[0]**o+(-0.382745197262)*x[0]+(0.41507101812)*x[1]**o+(0.48492708335)*x[1]+(-0.11672353881)*x[2]**o+(-0.56902283397)*x[2]
        arg[3,0,2,0]=(-0.400023140104)*x[0]**o+(-0.406234012546)*x[0]+(-0.17810623045)*x[1]**o+(-0.833748300281)*x[1]+(-0.463689953863)*x[2]**o+(-0.11095482465)*x[2]
        arg[3,0,2,1]=(0.448885918108)*x[0]**o+(0.0447046792888)*x[0]+(-0.781652457281)*x[1]**o+(-0.893726375109)*x[1]+(0.918099233406)*x[2]**o+(0.560717614604)*x[2]
        arg[3,1,0,0]=(0.046700262853)*x[0]**o+(0.729867044213)*x[0]+(-0.870868205823)*x[1]**o+(-0.711267787629)*x[1]+(0.760550112312)*x[2]**o+(-0.0188334901698)*x[2]
        arg[3,1,0,1]=(0.304305551549)*x[0]**o+(-0.73527291962)*x[0]+(0.722134673974)*x[1]**o+(-0.40822784698)*x[1]+(0.912464122456)*x[2]**o+(-0.857656020349)*x[2]
        arg[3,1,1,0]=(-0.857864508282)*x[0]**o+(-0.22160002809)*x[0]+(-0.0892530574233)*x[1]**o+(-0.547259900671)*x[1]+(0.641858628113)*x[2]**o+(-0.203700292205)*x[2]
        arg[3,1,1,1]=(-0.47064403668)*x[0]**o+(-0.105885697358)*x[0]+(-0.899570240486)*x[1]**o+(0.660942689756)*x[1]+(-0.365836826289)*x[2]**o+(0.9593955249)*x[2]
        arg[3,1,2,0]=(-0.51407433496)*x[0]**o+(0.369092182634)*x[0]+(-0.740281092517)*x[1]**o+(0.383443939366)*x[1]+(-0.140318759419)*x[2]**o+(-0.481274651104)*x[2]
        arg[3,1,2,1]=(-0.938924125636)*x[0]**o+(0.41994781084)*x[0]+(-0.946320511542)*x[1]**o+(-0.86702606561)*x[1]+(0.63547569926)*x[2]**o+(0.923988068696)*x[2]
        arg[3,2,0,0]=(0.212833889165)*x[0]**o+(-0.0823077975238)*x[0]+(0.038483237489)*x[1]**o+(0.393784376623)*x[1]+(0.573190557103)*x[2]**o+(0.403015743632)*x[2]
        arg[3,2,0,1]=(-0.169294531943)*x[0]**o+(-0.769228919251)*x[0]+(-0.907462814057)*x[1]**o+(-0.188574782291)*x[1]+(-0.859793027531)*x[2]**o+(-0.673334626964)*x[2]
        arg[3,2,1,0]=(0.646744388517)*x[0]**o+(0.346749855021)*x[0]+(-0.314382791156)*x[1]**o+(-0.0396545336605)*x[1]+(0.844678566939)*x[2]**o+(0.724721336727)*x[2]
        arg[3,2,1,1]=(-0.471761417345)*x[0]**o+(-0.801631597222)*x[0]+(-0.376444012893)*x[1]**o+(0.920939382926)*x[1]+(-0.728019331398)*x[2]**o+(0.905808341144)*x[2]
        arg[3,2,2,0]=(-0.713759272803)*x[0]**o+(-0.930638013429)*x[0]+(0.864451879958)*x[1]**o+(0.0566794358824)*x[1]+(-0.292092226905)*x[2]**o+(-0.195695530268)*x[2]
        arg[3,2,2,1]=(0.843437618194)*x[0]**o+(0.214911962718)*x[0]+(0.475690162826)*x[1]**o+(0.0744570063618)*x[1]+(0.351711310616)*x[2]**o+(-0.187223450548)*x[2]
        arg[3,3,0,0]=(0.108651500878)*x[0]**o+(-0.402624590847)*x[0]+(0.120700159277)*x[1]**o+(-0.363139807635)*x[1]+(-0.62413441951)*x[2]**o+(-0.474236131596)*x[2]
        arg[3,3,0,1]=(-0.0836636547536)*x[0]**o+(-0.187959781777)*x[0]+(0.756983584308)*x[1]**o+(0.756573839599)*x[1]+(0.195640878564)*x[2]**o+(-0.566596474032)*x[2]
        arg[3,3,1,0]=(-0.171427844449)*x[0]**o+(-0.266807792484)*x[0]+(0.380046037965)*x[1]**o+(-0.129297371793)*x[1]+(0.79139100315)*x[2]**o+(0.223804751067)*x[2]
        arg[3,3,1,1]=(-0.054757303264)*x[0]**o+(-0.823878124196)*x[0]+(0.80695256107)*x[1]**o+(0.583250192211)*x[1]+(0.894937939133)*x[2]**o+(0.878757173892)*x[2]
        arg[3,3,2,0]=(0.13923802434)*x[0]**o+(-0.600732296834)*x[0]+(0.111226716676)*x[1]**o+(-0.474524749496)*x[1]+(0.674290476359)*x[2]**o+(-0.06714767759)*x[2]
        arg[3,3,2,1]=(0.246187769682)*x[0]**o+(-0.871969439162)*x[0]+(0.56748693564)*x[1]**o+(-0.0831774328079)*x[1]+(-0.27380467532)*x[2]**o+(-0.623711953244)*x[2]
        arg[3,4,0,0]=(-0.345947366312)*x[0]**o+(-0.304842609526)*x[0]+(-0.720722450633)*x[1]**o+(0.889712922756)*x[1]+(-0.0451362945237)*x[2]**o+(-0.52344522887)*x[2]
        arg[3,4,0,1]=(-0.830119647904)*x[0]**o+(0.577888363835)*x[0]+(0.180691945154)*x[1]**o+(-0.489554894073)*x[1]+(0.848489044545)*x[2]**o+(-0.243139985297)*x[2]
        arg[3,4,1,0]=(0.846597693999)*x[0]**o+(0.757477455396)*x[0]+(-0.827604908657)*x[1]**o+(-0.108392312717)*x[1]+(0.597454707613)*x[2]**o+(0.35846243312)*x[2]
        arg[3,4,1,1]=(0.107973753109)*x[0]**o+(0.578649460223)*x[0]+(0.609012033524)*x[1]**o+(-0.8428861922)*x[1]+(0.42144759968)*x[2]**o+(-0.938952208084)*x[2]
        arg[3,4,2,0]=(0.286586330618)*x[0]**o+(0.7324646289)*x[0]+(-0.448461377611)*x[1]**o+(0.62562408085)*x[1]+(0.352429283116)*x[2]**o+(0.112047034296)*x[2]
        arg[3,4,2,1]=(-0.431663387082)*x[0]**o+(-0.612934322552)*x[0]+(-0.426644797074)*x[1]**o+(0.768645027094)*x[1]+(-0.453242885757)*x[2]**o+(0.893748345809)*x[2]
        ref[0,0,0,0]=(-1.2147562394)*(1+2.*(dim-1.)/(o+1.))+(1.47471604216)*dim
        ref[0,0,0,1]=(-0.283261030731)*(1+2.*(dim-1.)/(o+1.))+(0.49706944223)*dim
        ref[0,0,1,0]=(-0.963543225803)*(1+2.*(dim-1.)/(o+1.))+(0.302115929232)*dim
        ref[0,0,1,1]=(1.47597923019)*(1+2.*(dim-1.)/(o+1.))+(0.302975596116)*dim
        ref[0,0,2,0]=(2.07218071265)*(1+2.*(dim-1.)/(o+1.))+(1.40474756312)*dim
        ref[0,0,2,1]=(1.18935174934)*(1+2.*(dim-1.)/(o+1.))+(-0.898949809002)*dim
        ref[0,1,0,0]=(-2.71454215957)*(1+2.*(dim-1.)/(o+1.))+(-1.81174147681)*dim
        ref[0,1,0,1]=(-1.27877046381)*(1+2.*(dim-1.)/(o+1.))+(0.197262183297)*dim
        ref[0,1,1,0]=(-0.287148009258)*(1+2.*(dim-1.)/(o+1.))+(1.30812352716)*dim
        ref[0,1,1,1]=(0.263153075777)*(1+2.*(dim-1.)/(o+1.))+(1.46256384302)*dim
        ref[0,1,2,0]=(-2.55250588186)*(1+2.*(dim-1.)/(o+1.))+(1.13566208594)*dim
        ref[0,1,2,1]=(0.208932386724)*(1+2.*(dim-1.)/(o+1.))+(-0.438703456176)*dim
        ref[0,2,0,0]=(-1.09576259026)*(1+2.*(dim-1.)/(o+1.))+(-0.13076989899)*dim
        ref[0,2,0,1]=(0.401914700214)*(1+2.*(dim-1.)/(o+1.))+(2.19797357625)*dim
        ref[0,2,1,0]=(0.860631336354)*(1+2.*(dim-1.)/(o+1.))+(0.978915494035)*dim
        ref[0,2,1,1]=(-1.97095623301)*(1+2.*(dim-1.)/(o+1.))+(-2.25442123467)*dim
        ref[0,2,2,0]=(-0.527474241147)*(1+2.*(dim-1.)/(o+1.))+(-0.923478312465)*dim
        ref[0,2,2,1]=(-0.460568018944)*(1+2.*(dim-1.)/(o+1.))+(0.173004367644)*dim
        ref[0,3,0,0]=(-0.443819991343)*(1+2.*(dim-1.)/(o+1.))+(1.08379961978)*dim
        ref[0,3,0,1]=(-0.80563854076)*(1+2.*(dim-1.)/(o+1.))+(-1.48015007036)*dim
        ref[0,3,1,0]=(-1.04939720148)*(1+2.*(dim-1.)/(o+1.))+(-0.762532531252)*dim
        ref[0,3,1,1]=(0.472870331273)*(1+2.*(dim-1.)/(o+1.))+(-0.00544721475928)*dim
        ref[0,3,2,0]=(-0.593230167381)*(1+2.*(dim-1.)/(o+1.))+(0.26676895359)*dim
        ref[0,3,2,1]=(-0.104009550799)*(1+2.*(dim-1.)/(o+1.))+(-2.23842412891)*dim
        ref[0,4,0,0]=(-0.352866783806)*(1+2.*(dim-1.)/(o+1.))+(-1.02623939367)*dim
        ref[0,4,0,1]=(0.0310776980081)*(1+2.*(dim-1.)/(o+1.))+(-1.9281752378)*dim
        ref[0,4,1,0]=(-0.56349759328)*(1+2.*(dim-1.)/(o+1.))+(0.500353711197)*dim
        ref[0,4,1,1]=(-0.788555686306)*(1+2.*(dim-1.)/(o+1.))+(-0.518133836527)*dim
        ref[0,4,2,0]=(0.174347407535)*(1+2.*(dim-1.)/(o+1.))+(0.471299435068)*dim
        ref[0,4,2,1]=(1.13297761695)*(1+2.*(dim-1.)/(o+1.))+(-0.93091412661)*dim
        ref[1,0,0,0]=(1.3307805483)*(1+2.*(dim-1.)/(o+1.))+(-1.93791762884)*dim
        ref[1,0,0,1]=(-1.40528512234)*(1+2.*(dim-1.)/(o+1.))+(0.0207469648915)*dim
        ref[1,0,1,0]=(1.00481927021)*(1+2.*(dim-1.)/(o+1.))+(-1.82465453458)*dim
        ref[1,0,1,1]=(-1.88446627952)*(1+2.*(dim-1.)/(o+1.))+(-0.965933535196)*dim
        ref[1,0,2,0]=(-1.8284637239)*(1+2.*(dim-1.)/(o+1.))+(-0.991125421549)*dim
        ref[1,0,2,1]=(1.39426526757)*(1+2.*(dim-1.)/(o+1.))+(1.06968368195)*dim
        ref[1,1,0,0]=(1.49675855079)*(1+2.*(dim-1.)/(o+1.))+(-1.71081281752)*dim
        ref[1,1,0,1]=(-0.36009887464)*(1+2.*(dim-1.)/(o+1.))+(-0.410764083324)*dim
        ref[1,1,1,0]=(-1.34942056351)*(1+2.*(dim-1.)/(o+1.))+(0.397777678247)*dim
        ref[1,1,1,1]=(0.638374123027)*(1+2.*(dim-1.)/(o+1.))+(0.650657783821)*dim
        ref[1,1,2,0]=(0.820420901755)*(1+2.*(dim-1.)/(o+1.))+(-1.29107032578)*dim
        ref[1,1,2,1]=(-1.27872123392)*(1+2.*(dim-1.)/(o+1.))+(0.65807032576)*dim
        ref[1,2,0,0]=(0.075783858436)*(1+2.*(dim-1.)/(o+1.))+(-1.53077548496)*dim
        ref[1,2,0,1]=(-0.576058493068)*(1+2.*(dim-1.)/(o+1.))+(-0.469223416409)*dim
        ref[1,2,1,0]=(0.91020253397)*(1+2.*(dim-1.)/(o+1.))+(0.377598744012)*dim
        ref[1,2,1,1]=(-2.029474944)*(1+2.*(dim-1.)/(o+1.))+(1.92964650577)*dim
        ref[1,2,2,0]=(-0.330720388509)*(1+2.*(dim-1.)/(o+1.))+(-0.917162558794)*dim
        ref[1,2,2,1]=(-1.24172356207)*(1+2.*(dim-1.)/(o+1.))+(0.503779996381)*dim
        ref[1,3,0,0]=(0.0663085439332)*(1+2.*(dim-1.)/(o+1.))+(-0.209292976945)*dim
        ref[1,3,0,1]=(-2.23036613844)*(1+2.*(dim-1.)/(o+1.))+(0.361492360204)*dim
        ref[1,3,1,0]=(1.52701244516)*(1+2.*(dim-1.)/(o+1.))+(0.280419833109)*dim
        ref[1,3,1,1]=(-0.726609917928)*(1+2.*(dim-1.)/(o+1.))+(-0.265942889187)*dim
        ref[1,3,2,0]=(1.32716715393)*(1+2.*(dim-1.)/(o+1.))+(1.49032480195)*dim
        ref[1,3,2,1]=(-1.88447215307)*(1+2.*(dim-1.)/(o+1.))+(1.19504958561)*dim
        ref[1,4,0,0]=(0.766978376499)*(1+2.*(dim-1.)/(o+1.))+(1.30542216761)*dim
        ref[1,4,0,1]=(-1.04188463845)*(1+2.*(dim-1.)/(o+1.))+(-1.15230024582)*dim
        ref[1,4,1,0]=(-0.891108351313)*(1+2.*(dim-1.)/(o+1.))+(-1.35124391741)*dim
        ref[1,4,1,1]=(-0.213203213304)*(1+2.*(dim-1.)/(o+1.))+(-0.252522733564)*dim
        ref[1,4,2,0]=(-1.46959965525)*(1+2.*(dim-1.)/(o+1.))+(-0.963334280551)*dim
        ref[1,4,2,1]=(1.1953581127)*(1+2.*(dim-1.)/(o+1.))+(-0.512271341684)*dim
        ref[2,0,0,0]=(0.848353935033)*(1+2.*(dim-1.)/(o+1.))+(-0.11411349311)*dim
        ref[2,0,0,1]=(-1.34999153992)*(1+2.*(dim-1.)/(o+1.))+(-0.303144903768)*dim
        ref[2,0,1,0]=(0.67863773165)*(1+2.*(dim-1.)/(o+1.))+(0.421388857272)*dim
        ref[2,0,1,1]=(-0.366528039637)*(1+2.*(dim-1.)/(o+1.))+(0.499836514396)*dim
        ref[2,0,2,0]=(0.822949462292)*(1+2.*(dim-1.)/(o+1.))+(1.45443966594)*dim
        ref[2,0,2,1]=(-1.05433866385)*(1+2.*(dim-1.)/(o+1.))+(-0.288565807465)*dim
        ref[2,1,0,0]=(-0.793264594657)*(1+2.*(dim-1.)/(o+1.))+(-0.413468635212)*dim
        ref[2,1,0,1]=(0.975215998961)*(1+2.*(dim-1.)/(o+1.))+(-1.12313741482)*dim
        ref[2,1,1,0]=(0.481909771625)*(1+2.*(dim-1.)/(o+1.))+(1.815823447)*dim
        ref[2,1,1,1]=(0.503263365821)*(1+2.*(dim-1.)/(o+1.))+(0.615452162503)*dim
        ref[2,1,2,0]=(1.41070531631)*(1+2.*(dim-1.)/(o+1.))+(2.44734742898)*dim
        ref[2,1,2,1]=(1.67891774035)*(1+2.*(dim-1.)/(o+1.))+(0.0711842865505)*dim
        ref[2,2,0,0]=(0.759309909457)*(1+2.*(dim-1.)/(o+1.))+(1.0994679002)*dim
        ref[2,2,0,1]=(0.410629246599)*(1+2.*(dim-1.)/(o+1.))+(-0.259266223972)*dim
        ref[2,2,1,0]=(0.907369662899)*(1+2.*(dim-1.)/(o+1.))+(0.297479032201)*dim
        ref[2,2,1,1]=(0.437754268199)*(1+2.*(dim-1.)/(o+1.))+(-0.752314519943)*dim
        ref[2,2,2,0]=(-0.412346827151)*(1+2.*(dim-1.)/(o+1.))+(1.11001737234)*dim
        ref[2,2,2,1]=(-0.0782703564833)*(1+2.*(dim-1.)/(o+1.))+(-0.849667242932)*dim
        ref[2,3,0,0]=(1.3532076017)*(1+2.*(dim-1.)/(o+1.))+(0.681958768956)*dim
        ref[2,3,0,1]=(0.317337365221)*(1+2.*(dim-1.)/(o+1.))+(0.196740862928)*dim
        ref[2,3,1,0]=(0.245781204366)*(1+2.*(dim-1.)/(o+1.))+(-1.53494308542)*dim
        ref[2,3,1,1]=(0.968296801799)*(1+2.*(dim-1.)/(o+1.))+(-1.19615404363)*dim
        ref[2,3,2,0]=(1.05149655651)*(1+2.*(dim-1.)/(o+1.))+(-1.33733825375)*dim
        ref[2,3,2,1]=(1.73779251715)*(1+2.*(dim-1.)/(o+1.))+(-1.21511597866)*dim
        ref[2,4,0,0]=(1.79772764806)*(1+2.*(dim-1.)/(o+1.))+(1.05688657743)*dim
        ref[2,4,0,1]=(-0.170627231654)*(1+2.*(dim-1.)/(o+1.))+(0.55613438374)*dim
        ref[2,4,1,0]=(-1.07255491784)*(1+2.*(dim-1.)/(o+1.))+(-0.617967518031)*dim
        ref[2,4,1,1]=(-1.76022173617)*(1+2.*(dim-1.)/(o+1.))+(0.671230700733)*dim
        ref[2,4,2,0]=(0.534286533995)*(1+2.*(dim-1.)/(o+1.))+(1.26403195663)*dim
        ref[2,4,2,1]=(-0.357530939222)*(1+2.*(dim-1.)/(o+1.))+(0.12530354553)*dim
        ref[3,0,0,0]=(-0.11656782909)*(1+2.*(dim-1.)/(o+1.))+(0.32932381727)*dim
        ref[3,0,0,1]=(0.187638683339)*(1+2.*(dim-1.)/(o+1.))+(0.868116036962)*dim
        ref[3,0,1,0]=(0.723703912538)*(1+2.*(dim-1.)/(o+1.))+(-1.74663812914)*dim
        ref[3,0,1,1]=(0.528871352717)*(1+2.*(dim-1.)/(o+1.))+(-0.466840947882)*dim
        ref[3,0,2,0]=(-1.04181932442)*(1+2.*(dim-1.)/(o+1.))+(-1.35093713748)*dim
        ref[3,0,2,1]=(0.585332694234)*(1+2.*(dim-1.)/(o+1.))+(-0.288304081216)*dim
        ref[3,1,0,0]=(-0.0636178306576)*(1+2.*(dim-1.)/(o+1.))+(-0.000234233586678)*dim
        ref[3,1,0,1]=(1.93890434798)*(1+2.*(dim-1.)/(o+1.))+(-2.00115678695)*dim
        ref[3,1,1,0]=(-0.305258937592)*(1+2.*(dim-1.)/(o+1.))+(-0.972560220966)*dim
        ref[3,1,1,1]=(-1.73605110346)*(1+2.*(dim-1.)/(o+1.))+(1.5144525173)*dim
        ref[3,1,2,0]=(-1.3946741869)*(1+2.*(dim-1.)/(o+1.))+(0.271261470896)*dim
        ref[3,1,2,1]=(-1.24976893792)*(1+2.*(dim-1.)/(o+1.))+(0.476909813927)*dim
        ref[3,2,0,0]=(0.824507683756)*(1+2.*(dim-1.)/(o+1.))+(0.71449232273)*dim
        ref[3,2,0,1]=(-1.93655037353)*(1+2.*(dim-1.)/(o+1.))+(-1.63113832851)*dim
        ref[3,2,1,0]=(1.1770401643)*(1+2.*(dim-1.)/(o+1.))+(1.03181665809)*dim
        ref[3,2,1,1]=(-1.57622476164)*(1+2.*(dim-1.)/(o+1.))+(1.02511612685)*dim
        ref[3,2,2,0]=(-0.141399619749)*(1+2.*(dim-1.)/(o+1.))+(-1.06965410781)*dim
        ref[3,2,2,1]=(1.67083909164)*(1+2.*(dim-1.)/(o+1.))+(0.102145518531)*dim
        ref[3,3,0,0]=(-0.394782759355)*(1+2.*(dim-1.)/(o+1.))+(-1.24000053008)*dim
        ref[3,3,0,1]=(0.868960808118)*(1+2.*(dim-1.)/(o+1.))+(0.00201758379073)*dim
        ref[3,3,1,0]=(1.00000919667)*(1+2.*(dim-1.)/(o+1.))+(-0.17230041321)*dim
        ref[3,3,1,1]=(1.64713319694)*(1+2.*(dim-1.)/(o+1.))+(0.638129241907)*dim
        ref[3,3,2,0]=(0.924755217374)*(1+2.*(dim-1.)/(o+1.))+(-1.14240472392)*dim
        ref[3,3,2,1]=(0.539870030002)*(1+2.*(dim-1.)/(o+1.))+(-1.57885882521)*dim
        ref[3,4,0,0]=(-1.11180611147)*(1+2.*(dim-1.)/(o+1.))+(0.0614250843596)*dim
        ref[3,4,0,1]=(0.199061341795)*(1+2.*(dim-1.)/(o+1.))+(-0.154806515534)*dim
        ref[3,4,1,0]=(0.616447492955)*(1+2.*(dim-1.)/(o+1.))+(1.0075475758)*dim
        ref[3,4,1,1]=(1.13843338631)*(1+2.*(dim-1.)/(o+1.))+(-1.20318894006)*dim
        ref[3,4,2,0]=(0.190554236123)*(1+2.*(dim-1.)/(o+1.))+(1.47013574405)*dim
        ref[3,4,2,1]=(-1.31155106991)*(1+2.*(dim-1.)/(o+1.))+(1.04945905035)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_Solution_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.416878137535)*x[0]**o+(0.0809721296208)*x[0]+(-0.275084069478)*x[1]**o+(-0.704226656249)*x[1]
        ref=(0.141794068057)*(1+2.*(dim-1.)/(o+1.))+(-0.623254526628)*dim
      else:
        arg=(0.587142789605)*x[0]**o+(0.894018391929)*x[0]+(-0.417709558814)*x[1]**o+(0.0970658484968)*x[1]+(-0.840982437679)*x[2]**o+(-0.400242562091)*x[2]
        ref=(-0.671549206889)*(1+2.*(dim-1.)/(o+1.))+(0.590841678335)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_Solution_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.051335729494)*x[0]**o+(0.257057962305)*x[0]+(0.00794214446212)*x[1]**o+(0.52307365061)*x[1]
        arg[1]=(0.419915493803)*x[0]**o+(-0.0105826268931)*x[0]+(0.369274332127)*x[1]**o+(0.340796701053)*x[1]
        ref[0]=(0.0592778739561)*(1+2.*(dim-1.)/(o+1.))+(0.780131612915)*dim
        ref[1]=(0.789189825931)*(1+2.*(dim-1.)/(o+1.))+(0.33021407416)*dim
      else:
        arg[0]=(-0.483302491019)*x[0]**o+(0.223892398776)*x[0]+(-0.555612541317)*x[1]**o+(0.75535374219)*x[1]+(-0.208573228788)*x[2]**o+(0.479879212564)*x[2]
        arg[1]=(-0.012341185885)*x[0]**o+(-0.959474230066)*x[0]+(0.397671123434)*x[1]**o+(-0.120340696903)*x[1]+(-0.645757653205)*x[2]**o+(-0.216057959957)*x[2]
        ref[0]=(-1.24748826112)*(1+2.*(dim-1.)/(o+1.))+(1.45912535353)*dim
        ref[1]=(-0.260427715657)*(1+2.*(dim-1.)/(o+1.))+(-1.29587288693)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_Solution_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.493237934301)*x[0]**o+(-0.977176505302)*x[0]+(-0.837740403623)*x[1]**o+(0.204709065496)*x[1]
        arg[0,1]=(0.794064508577)*x[0]**o+(-0.917060945623)*x[0]+(0.0114185601474)*x[1]**o+(0.547108694374)*x[1]
        arg[0,2]=(-0.989778984923)*x[0]**o+(-0.499651095311)*x[0]+(-0.126817505183)*x[1]**o+(0.889077385524)*x[1]
        arg[0,3]=(-0.223453594493)*x[0]**o+(-0.17983229649)*x[0]+(0.352602269148)*x[1]**o+(0.00617724258273)*x[1]
        arg[0,4]=(0.401784356952)*x[0]**o+(0.839308128877)*x[0]+(0.322943402455)*x[1]**o+(0.770206521944)*x[1]
        arg[1,0]=(0.491015078355)*x[0]**o+(0.194909202321)*x[0]+(0.38986016491)*x[1]**o+(0.671106836372)*x[1]
        arg[1,1]=(0.200697856784)*x[0]**o+(0.389746053244)*x[0]+(0.850237988574)*x[1]**o+(-0.677750684271)*x[1]
        arg[1,2]=(0.300444129016)*x[0]**o+(-0.502811932395)*x[0]+(0.390751425646)*x[1]**o+(-0.0234058348564)*x[1]
        arg[1,3]=(-0.451410318068)*x[0]**o+(0.0959092789621)*x[0]+(0.364602756931)*x[1]**o+(-0.637883149677)*x[1]
        arg[1,4]=(0.84148898142)*x[0]**o+(0.447701396385)*x[0]+(-0.925960934959)*x[1]**o+(-0.216915201171)*x[1]
        arg[2,0]=(0.497685540053)*x[0]**o+(0.706445401439)*x[0]+(0.278688226804)*x[1]**o+(0.263560807934)*x[1]
        arg[2,1]=(0.846700886302)*x[0]**o+(0.794459987626)*x[0]+(0.206707548962)*x[1]**o+(0.536938178952)*x[1]
        arg[2,2]=(-0.825060225713)*x[0]**o+(0.00650901742391)*x[0]+(0.500591036904)*x[1]**o+(0.86251606869)*x[1]
        arg[2,3]=(-0.490203731083)*x[0]**o+(-0.758885551614)*x[0]+(0.44212368096)*x[1]**o+(0.422183463853)*x[1]
        arg[2,4]=(0.326180837967)*x[0]**o+(0.0511693925274)*x[0]+(0.450713817213)*x[1]**o+(-0.788372992203)*x[1]
        arg[3,0]=(0.427328335694)*x[0]**o+(-0.549570782632)*x[0]+(0.0484849428866)*x[1]**o+(-0.488921618371)*x[1]
        arg[3,1]=(-0.000395237589224)*x[0]**o+(-0.902889768871)*x[0]+(-0.991821787559)*x[1]**o+(-0.907842202962)*x[1]
        arg[3,2]=(0.737156280391)*x[0]**o+(0.104714673958)*x[0]+(0.102528971835)*x[1]**o+(-0.0982626427735)*x[1]
        arg[3,3]=(0.971460723075)*x[0]**o+(-0.759821212391)*x[0]+(0.385963754923)*x[1]**o+(-0.533924725996)*x[1]
        arg[3,4]=(0.25440424638)*x[0]**o+(-0.82432588605)*x[0]+(0.759285911224)*x[1]**o+(0.328467600746)*x[1]
        ref[0,0]=(-1.33097833792)*(1+2.*(dim-1.)/(o+1.))+(-0.772467439806)*dim
        ref[0,1]=(0.805483068724)*(1+2.*(dim-1.)/(o+1.))+(-0.36995225125)*dim
        ref[0,2]=(-1.11659649011)*(1+2.*(dim-1.)/(o+1.))+(0.389426290213)*dim
        ref[0,3]=(0.129148674655)*(1+2.*(dim-1.)/(o+1.))+(-0.173655053907)*dim
        ref[0,4]=(0.724727759407)*(1+2.*(dim-1.)/(o+1.))+(1.60951465082)*dim
        ref[1,0]=(0.880875243265)*(1+2.*(dim-1.)/(o+1.))+(0.866016038693)*dim
        ref[1,1]=(1.05093584536)*(1+2.*(dim-1.)/(o+1.))+(-0.288004631027)*dim
        ref[1,2]=(0.691195554662)*(1+2.*(dim-1.)/(o+1.))+(-0.526217767251)*dim
        ref[1,3]=(-0.0868075611369)*(1+2.*(dim-1.)/(o+1.))+(-0.541973870715)*dim
        ref[1,4]=(-0.0844719535392)*(1+2.*(dim-1.)/(o+1.))+(0.230786195214)*dim
        ref[2,0]=(0.776373766857)*(1+2.*(dim-1.)/(o+1.))+(0.970006209374)*dim
        ref[2,1]=(1.05340843526)*(1+2.*(dim-1.)/(o+1.))+(1.33139816658)*dim
        ref[2,2]=(-0.324469188808)*(1+2.*(dim-1.)/(o+1.))+(0.869025086114)*dim
        ref[2,3]=(-0.0480800501232)*(1+2.*(dim-1.)/(o+1.))+(-0.336702087761)*dim
        ref[2,4]=(0.776894655179)*(1+2.*(dim-1.)/(o+1.))+(-0.737203599675)*dim
        ref[3,0]=(0.47581327858)*(1+2.*(dim-1.)/(o+1.))+(-1.038492401)*dim
        ref[3,1]=(-0.992217025148)*(1+2.*(dim-1.)/(o+1.))+(-1.81073197183)*dim
        ref[3,2]=(0.839685252226)*(1+2.*(dim-1.)/(o+1.))+(0.00645203118434)*dim
        ref[3,3]=(1.357424478)*(1+2.*(dim-1.)/(o+1.))+(-1.29374593839)*dim
        ref[3,4]=(1.0136901576)*(1+2.*(dim-1.)/(o+1.))+(-0.495858285305)*dim
      else:
        arg[0,0]=(-0.543785449843)*x[0]**o+(-0.593471310422)*x[0]+(0.223732084513)*x[1]**o+(-0.126390494354)*x[1]+(0.602561108649)*x[2]**o+(-0.879650196727)*x[2]
        arg[0,1]=(-0.373708985284)*x[0]**o+(0.274723212925)*x[0]+(0.0901068561926)*x[1]**o+(0.0705878267418)*x[1]+(-0.87124855534)*x[2]**o+(-0.342156987834)*x[2]
        arg[0,2]=(0.197662792758)*x[0]**o+(0.993389348528)*x[0]+(0.300080063659)*x[1]**o+(-0.87329423474)*x[1]+(-0.708861668092)*x[2]**o+(-0.145567510817)*x[2]
        arg[0,3]=(-0.641680604707)*x[0]**o+(0.502870155472)*x[0]+(0.726460257571)*x[1]**o+(-0.796246941548)*x[1]+(-0.034138694789)*x[2]**o+(-0.756773445728)*x[2]
        arg[0,4]=(-0.910301138852)*x[0]**o+(0.370603440687)*x[0]+(0.30908632679)*x[1]**o+(0.399307258883)*x[1]+(0.734329887794)*x[2]**o+(-0.105355323212)*x[2]
        arg[1,0]=(-0.998162269861)*x[0]**o+(0.744436497607)*x[0]+(0.474991680035)*x[1]**o+(-0.523297766774)*x[1]+(-0.147411103004)*x[2]**o+(-0.366260797475)*x[2]
        arg[1,1]=(-0.895068058812)*x[0]**o+(-0.543026567202)*x[0]+(0.681910579939)*x[1]**o+(0.839238385122)*x[1]+(-0.943454697555)*x[2]**o+(-0.942882687085)*x[2]
        arg[1,2]=(-0.0327934757673)*x[0]**o+(-0.551060110327)*x[0]+(0.0246419122114)*x[1]**o+(0.290492943846)*x[1]+(-0.81629260256)*x[2]**o+(-0.0703654573398)*x[2]
        arg[1,3]=(0.0101368428324)*x[0]**o+(0.169228100407)*x[0]+(-0.0720675504637)*x[1]**o+(0.854569517064)*x[1]+(-0.185495614033)*x[2]**o+(0.159402892807)*x[2]
        arg[1,4]=(-0.879056526056)*x[0]**o+(-0.499865495878)*x[0]+(0.389281340553)*x[1]**o+(0.208323326648)*x[1]+(0.201495185869)*x[2]**o+(0.287693342543)*x[2]
        arg[2,0]=(-0.0980367959573)*x[0]**o+(-0.743908923973)*x[0]+(0.612332291133)*x[1]**o+(-0.833162883242)*x[1]+(-0.149234146487)*x[2]**o+(-0.265352382043)*x[2]
        arg[2,1]=(-0.731053054407)*x[0]**o+(-0.328824749845)*x[0]+(-0.270771833154)*x[1]**o+(-0.924718425874)*x[1]+(-0.333737248999)*x[2]**o+(-0.437707530432)*x[2]
        arg[2,2]=(0.0568240255423)*x[0]**o+(0.889929679474)*x[0]+(-0.550346007257)*x[1]**o+(-0.276114383355)*x[1]+(0.818856335741)*x[2]**o+(0.949830759195)*x[2]
        arg[2,3]=(-0.487278099196)*x[0]**o+(0.621833922878)*x[0]+(-0.641187646288)*x[1]**o+(-0.62187991518)*x[1]+(0.193101177186)*x[2]**o+(0.574039256278)*x[2]
        arg[2,4]=(0.411046922073)*x[0]**o+(-0.10196277248)*x[0]+(-0.880065306034)*x[1]**o+(0.629582927604)*x[1]+(-0.364618567951)*x[2]**o+(0.130293365676)*x[2]
        arg[3,0]=(-0.625244224555)*x[0]**o+(0.50345243521)*x[0]+(0.701616120451)*x[1]**o+(0.44401843794)*x[1]+(-0.881068054195)*x[2]**o+(0.337405641389)*x[2]
        arg[3,1]=(0.244113319139)*x[0]**o+(0.739760310044)*x[0]+(0.439528183979)*x[1]**o+(0.808496622595)*x[1]+(0.432069187682)*x[2]**o+(-0.106394550529)*x[2]
        arg[3,2]=(-0.200973139796)*x[0]**o+(-0.373932231384)*x[0]+(-0.438946407503)*x[1]**o+(0.543079830762)*x[1]+(-0.499599010695)*x[2]**o+(0.501967674296)*x[2]
        arg[3,3]=(-0.128263000609)*x[0]**o+(-0.408181851435)*x[0]+(0.403315054177)*x[1]**o+(0.75067593555)*x[1]+(0.361607987217)*x[2]**o+(0.269483801463)*x[2]
        arg[3,4]=(0.821969994275)*x[0]**o+(0.350771424951)*x[0]+(-0.761235507511)*x[1]**o+(0.148329827876)*x[1]+(-0.918493845231)*x[2]**o+(0.592094636272)*x[2]
        ref[0,0]=(0.282507743319)*(1+2.*(dim-1.)/(o+1.))+(-1.5995120015)*dim
        ref[0,1]=(-1.15485068443)*(1+2.*(dim-1.)/(o+1.))+(0.00315405183214)*dim
        ref[0,2]=(-0.211118811675)*(1+2.*(dim-1.)/(o+1.))+(-0.0254723970291)*dim
        ref[0,3]=(0.0506409580755)*(1+2.*(dim-1.)/(o+1.))+(-1.0501502318)*dim
        ref[0,4]=(0.133115075732)*(1+2.*(dim-1.)/(o+1.))+(0.664555376358)*dim
        ref[1,0]=(-0.67058169283)*(1+2.*(dim-1.)/(o+1.))+(-0.145122066642)*dim
        ref[1,1]=(-1.15661217643)*(1+2.*(dim-1.)/(o+1.))+(-0.646670869164)*dim
        ref[1,2]=(-0.824444166116)*(1+2.*(dim-1.)/(o+1.))+(-0.330932623821)*dim
        ref[1,3]=(-0.247426321664)*(1+2.*(dim-1.)/(o+1.))+(1.18320051028)*dim
        ref[1,4]=(-0.288279999634)*(1+2.*(dim-1.)/(o+1.))+(-0.00384882668765)*dim
        ref[2,0]=(0.365061348688)*(1+2.*(dim-1.)/(o+1.))+(-1.84242418926)*dim
        ref[2,1]=(-1.33556213656)*(1+2.*(dim-1.)/(o+1.))+(-1.69125070615)*dim
        ref[2,2]=(0.325334354026)*(1+2.*(dim-1.)/(o+1.))+(1.56364605531)*dim
        ref[2,3]=(-0.935364568298)*(1+2.*(dim-1.)/(o+1.))+(0.573993263976)*dim
        ref[2,4]=(-0.833636951913)*(1+2.*(dim-1.)/(o+1.))+(0.6579135208)*dim
        ref[3,0]=(-0.804696158299)*(1+2.*(dim-1.)/(o+1.))+(1.28487651454)*dim
        ref[3,1]=(1.1157106908)*(1+2.*(dim-1.)/(o+1.))+(1.44186238211)*dim
        ref[3,2]=(-1.13951855799)*(1+2.*(dim-1.)/(o+1.))+(0.671115273674)*dim
        ref[3,3]=(0.636660040784)*(1+2.*(dim-1.)/(o+1.))+(0.611977885578)*dim
        ref[3,4]=(-0.857759358467)*(1+2.*(dim-1.)/(o+1.))+(1.0911958891)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_Solution_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.331954160625)*x[0]**o+(0.713423346586)*x[0]+(0.922333771405)*x[1]**o+(-0.306799323245)*x[1]
        arg[0,0,1]=(-0.837278273696)*x[0]**o+(-0.322068356249)*x[0]+(-0.952056283446)*x[1]**o+(0.78147215355)*x[1]
        arg[0,1,0]=(-0.71217197633)*x[0]**o+(-0.222121067189)*x[0]+(-0.740851323426)*x[1]**o+(-0.664415003166)*x[1]
        arg[0,1,1]=(0.304797844524)*x[0]**o+(-0.644642249615)*x[0]+(-0.942312793933)*x[1]**o+(0.758857258357)*x[1]
        arg[1,0,0]=(-0.978734634026)*x[0]**o+(0.697829375729)*x[0]+(-0.161023313194)*x[1]**o+(0.61960280308)*x[1]
        arg[1,0,1]=(0.65091302745)*x[0]**o+(-0.411592147008)*x[0]+(0.748017319704)*x[1]**o+(0.751661257345)*x[1]
        arg[1,1,0]=(-0.752749816617)*x[0]**o+(-0.889417028079)*x[0]+(0.187075769961)*x[1]**o+(0.96605423194)*x[1]
        arg[1,1,1]=(-0.791276410919)*x[0]**o+(-0.66910236639)*x[0]+(-0.107283654349)*x[1]**o+(0.556315348977)*x[1]
        arg[2,0,0]=(0.0717781211643)*x[0]**o+(-0.895974517834)*x[0]+(-0.388350799289)*x[1]**o+(0.55541171641)*x[1]
        arg[2,0,1]=(0.886475701949)*x[0]**o+(0.0794480579219)*x[0]+(-0.77671944551)*x[1]**o+(-0.29611930088)*x[1]
        arg[2,1,0]=(0.891530897911)*x[0]**o+(-0.767892439984)*x[0]+(-0.692871902002)*x[1]**o+(0.296346783431)*x[1]
        arg[2,1,1]=(0.904417221616)*x[0]**o+(-0.379208335246)*x[0]+(0.491675297059)*x[1]**o+(0.994131453216)*x[1]
        arg[3,0,0]=(-0.278750282129)*x[0]**o+(-0.889235749208)*x[0]+(-0.970025256676)*x[1]**o+(0.459265023633)*x[1]
        arg[3,0,1]=(-0.718548177793)*x[0]**o+(-0.801618785436)*x[0]+(-0.0489351007933)*x[1]**o+(-0.0331281021404)*x[1]
        arg[3,1,0]=(0.838645233036)*x[0]**o+(0.174830460073)*x[0]+(0.343887140274)*x[1]**o+(0.475643625956)*x[1]
        arg[3,1,1]=(-0.376629360434)*x[0]**o+(0.965850026388)*x[0]+(-0.62284011199)*x[1]**o+(-0.548261522438)*x[1]
        arg[4,0,0]=(-0.747109622101)*x[0]**o+(-0.793286186527)*x[0]+(0.700502366132)*x[1]**o+(0.708459489695)*x[1]
        arg[4,0,1]=(-0.372920704339)*x[0]**o+(-0.856662712404)*x[0]+(0.735191558102)*x[1]**o+(0.451959287084)*x[1]
        arg[4,1,0]=(-0.825227447648)*x[0]**o+(-0.978701927456)*x[0]+(0.856562109765)*x[1]**o+(0.226820057686)*x[1]
        arg[4,1,1]=(-0.883951567752)*x[0]**o+(0.346114896878)*x[0]+(0.22103721575)*x[1]**o+(0.766907412924)*x[1]
        arg[5,0,0]=(0.440140408264)*x[0]**o+(0.576442002932)*x[0]+(0.181136518153)*x[1]**o+(0.467290325887)*x[1]
        arg[5,0,1]=(0.323653297993)*x[0]**o+(-0.0169080219964)*x[0]+(-0.790889359324)*x[1]**o+(-0.752609210154)*x[1]
        arg[5,1,0]=(-0.771859095701)*x[0]**o+(0.392074466446)*x[0]+(0.672832544535)*x[1]**o+(-0.518196376899)*x[1]
        arg[5,1,1]=(-0.714106835785)*x[0]**o+(-0.392974811152)*x[0]+(0.477349412757)*x[1]**o+(-0.978738343032)*x[1]
        ref[0,0,0]=(0.59037961078)*(1+2.*(dim-1.)/(o+1.))+(0.406624023341)*dim
        ref[0,0,1]=(-1.78933455714)*(1+2.*(dim-1.)/(o+1.))+(0.459403797301)*dim
        ref[0,1,0]=(-1.45302329976)*(1+2.*(dim-1.)/(o+1.))+(-0.886536070355)*dim
        ref[0,1,1]=(-0.637514949409)*(1+2.*(dim-1.)/(o+1.))+(0.114215008741)*dim
        ref[1,0,0]=(-1.13975794722)*(1+2.*(dim-1.)/(o+1.))+(1.31743217881)*dim
        ref[1,0,1]=(1.39893034715)*(1+2.*(dim-1.)/(o+1.))+(0.340069110337)*dim
        ref[1,1,0]=(-0.565674046656)*(1+2.*(dim-1.)/(o+1.))+(0.076637203861)*dim
        ref[1,1,1]=(-0.898560065268)*(1+2.*(dim-1.)/(o+1.))+(-0.112787017413)*dim
        ref[2,0,0]=(-0.316572678125)*(1+2.*(dim-1.)/(o+1.))+(-0.340562801424)*dim
        ref[2,0,1]=(0.10975625644)*(1+2.*(dim-1.)/(o+1.))+(-0.216671242958)*dim
        ref[2,1,0]=(0.198658995909)*(1+2.*(dim-1.)/(o+1.))+(-0.471545656553)*dim
        ref[2,1,1]=(1.39609251868)*(1+2.*(dim-1.)/(o+1.))+(0.614923117971)*dim
        ref[3,0,0]=(-1.2487755388)*(1+2.*(dim-1.)/(o+1.))+(-0.429970725575)*dim
        ref[3,0,1]=(-0.767483278586)*(1+2.*(dim-1.)/(o+1.))+(-0.834746887577)*dim
        ref[3,1,0]=(1.18253237331)*(1+2.*(dim-1.)/(o+1.))+(0.650474086029)*dim
        ref[3,1,1]=(-0.999469472424)*(1+2.*(dim-1.)/(o+1.))+(0.41758850395)*dim
        ref[4,0,0]=(-0.0466072559697)*(1+2.*(dim-1.)/(o+1.))+(-0.0848266968319)*dim
        ref[4,0,1]=(0.362270853763)*(1+2.*(dim-1.)/(o+1.))+(-0.404703425319)*dim
        ref[4,1,0]=(0.0313346621166)*(1+2.*(dim-1.)/(o+1.))+(-0.75188186977)*dim
        ref[4,1,1]=(-0.662914352001)*(1+2.*(dim-1.)/(o+1.))+(1.1130223098)*dim
        ref[5,0,0]=(0.621276926417)*(1+2.*(dim-1.)/(o+1.))+(1.04373232882)*dim
        ref[5,0,1]=(-0.467236061331)*(1+2.*(dim-1.)/(o+1.))+(-0.76951723215)*dim
        ref[5,1,0]=(-0.0990265511653)*(1+2.*(dim-1.)/(o+1.))+(-0.126121910453)*dim
        ref[5,1,1]=(-0.236757423028)*(1+2.*(dim-1.)/(o+1.))+(-1.37171315418)*dim
      else:
        arg[0,0,0]=(-0.676850371385)*x[0]**o+(0.343194249293)*x[0]+(-0.289569238124)*x[1]**o+(0.546143025789)*x[1]+(-0.292429216951)*x[2]**o+(0.100638805907)*x[2]
        arg[0,0,1]=(-0.558403199885)*x[0]**o+(0.369265961569)*x[0]+(0.098539502761)*x[1]**o+(-0.555747072012)*x[1]+(0.0142505043744)*x[2]**o+(0.110677590143)*x[2]
        arg[0,1,0]=(0.480265324249)*x[0]**o+(-0.0801799981418)*x[0]+(-0.659040110213)*x[1]**o+(0.315685251032)*x[1]+(0.146222780181)*x[2]**o+(-0.307845817615)*x[2]
        arg[0,1,1]=(-0.469643195547)*x[0]**o+(0.631180947887)*x[0]+(0.0873749097691)*x[1]**o+(-0.907805635326)*x[1]+(-0.445238378297)*x[2]**o+(-0.583750385876)*x[2]
        arg[1,0,0]=(-0.519648347947)*x[0]**o+(-0.580046561107)*x[0]+(-0.474702629402)*x[1]**o+(-0.76698196707)*x[1]+(0.631290211156)*x[2]**o+(0.283150656338)*x[2]
        arg[1,0,1]=(0.828049802595)*x[0]**o+(-0.0996271417739)*x[0]+(0.13247948046)*x[1]**o+(0.64657332105)*x[1]+(0.901448888477)*x[2]**o+(0.895379597076)*x[2]
        arg[1,1,0]=(-0.197367099356)*x[0]**o+(-0.933210661759)*x[0]+(-0.0134349749548)*x[1]**o+(-0.651111981269)*x[1]+(0.256945439519)*x[2]**o+(0.528412689094)*x[2]
        arg[1,1,1]=(-0.922943172982)*x[0]**o+(-0.883102479542)*x[0]+(-0.0037345936911)*x[1]**o+(-0.598256159261)*x[1]+(-0.8562089409)*x[2]**o+(-0.298502617143)*x[2]
        arg[2,0,0]=(0.499285053237)*x[0]**o+(-0.347877602065)*x[0]+(0.783117300662)*x[1]**o+(0.0413016895448)*x[1]+(0.22555777414)*x[2]**o+(0.089246166469)*x[2]
        arg[2,0,1]=(-0.180602931202)*x[0]**o+(0.883958054663)*x[0]+(0.904974519387)*x[1]**o+(-0.169618307434)*x[1]+(0.361963890467)*x[2]**o+(-0.364236450353)*x[2]
        arg[2,1,0]=(0.332239090882)*x[0]**o+(-0.392239851855)*x[0]+(0.905142609029)*x[1]**o+(-0.471493540964)*x[1]+(-0.305327788141)*x[2]**o+(0.581213078834)*x[2]
        arg[2,1,1]=(0.481276189253)*x[0]**o+(0.645400809127)*x[0]+(-0.840844470697)*x[1]**o+(-0.47587396865)*x[1]+(0.134145050668)*x[2]**o+(-0.315081369951)*x[2]
        arg[3,0,0]=(-0.480497217552)*x[0]**o+(0.595345393671)*x[0]+(0.776315451392)*x[1]**o+(-0.396110510671)*x[1]+(0.0437422791996)*x[2]**o+(0.348675326203)*x[2]
        arg[3,0,1]=(0.867117243092)*x[0]**o+(-0.222483151231)*x[0]+(0.0856439550139)*x[1]**o+(0.355855801395)*x[1]+(-0.779380984653)*x[2]**o+(0.799440639884)*x[2]
        arg[3,1,0]=(-0.869234399353)*x[0]**o+(-0.747500724089)*x[0]+(-0.83154206968)*x[1]**o+(-0.771906212766)*x[1]+(-0.188734869619)*x[2]**o+(0.7312382704)*x[2]
        arg[3,1,1]=(-0.729677636148)*x[0]**o+(-0.358066533942)*x[0]+(-0.342651052704)*x[1]**o+(-0.531453801913)*x[1]+(-0.898300547827)*x[2]**o+(0.0387220517653)*x[2]
        arg[4,0,0]=(-0.380489041999)*x[0]**o+(0.517823660835)*x[0]+(0.722149782685)*x[1]**o+(0.510169845258)*x[1]+(-0.979340093133)*x[2]**o+(0.846050053391)*x[2]
        arg[4,0,1]=(0.390895580804)*x[0]**o+(0.122461788897)*x[0]+(-0.809243912452)*x[1]**o+(0.871689879803)*x[1]+(-0.991689466458)*x[2]**o+(-0.0373953689911)*x[2]
        arg[4,1,0]=(0.00670611033858)*x[0]**o+(-0.700084486793)*x[0]+(0.365358002826)*x[1]**o+(-0.928347441251)*x[1]+(-0.675081280461)*x[2]**o+(-0.262871553902)*x[2]
        arg[4,1,1]=(-0.566521655794)*x[0]**o+(-0.23325381374)*x[0]+(0.744538505444)*x[1]**o+(0.263970013855)*x[1]+(0.360984907343)*x[2]**o+(0.704696800059)*x[2]
        arg[5,0,0]=(0.754229123633)*x[0]**o+(-0.523353302691)*x[0]+(0.404181763418)*x[1]**o+(0.175414644029)*x[1]+(0.627455124887)*x[2]**o+(-0.450163514418)*x[2]
        arg[5,0,1]=(0.804547370453)*x[0]**o+(-0.748034210243)*x[0]+(-0.943261499953)*x[1]**o+(0.360715335834)*x[1]+(-0.952785406204)*x[2]**o+(0.188838771539)*x[2]
        arg[5,1,0]=(0.653730390007)*x[0]**o+(0.663746229033)*x[0]+(0.454911944273)*x[1]**o+(-0.548110740107)*x[1]+(0.799171265206)*x[2]**o+(-0.646356900812)*x[2]
        arg[5,1,1]=(0.533464266683)*x[0]**o+(-0.0650985333228)*x[0]+(-0.599880569232)*x[1]**o+(0.645120695827)*x[1]+(0.985316456657)*x[2]**o+(0.527848503917)*x[2]
        ref[0,0,0]=(-1.25884882646)*(1+2.*(dim-1.)/(o+1.))+(0.989976080988)*dim
        ref[0,0,1]=(-0.445613192749)*(1+2.*(dim-1.)/(o+1.))+(-0.0758035202994)*dim
        ref[0,1,0]=(-0.0325520057832)*(1+2.*(dim-1.)/(o+1.))+(-0.0723405647253)*dim
        ref[0,1,1]=(-0.827506664075)*(1+2.*(dim-1.)/(o+1.))+(-0.860375073315)*dim
        ref[1,0,0]=(-0.363060766193)*(1+2.*(dim-1.)/(o+1.))+(-1.06387787184)*dim
        ref[1,0,1]=(1.86197817153)*(1+2.*(dim-1.)/(o+1.))+(1.44232577635)*dim
        ref[1,1,0]=(0.0461433652081)*(1+2.*(dim-1.)/(o+1.))+(-1.05590995393)*dim
        ref[1,1,1]=(-1.78288670757)*(1+2.*(dim-1.)/(o+1.))+(-1.77986125595)*dim
        ref[2,0,0]=(1.50796012804)*(1+2.*(dim-1.)/(o+1.))+(-0.217329746051)*dim
        ref[2,0,1]=(1.08633547865)*(1+2.*(dim-1.)/(o+1.))+(0.350103296876)*dim
        ref[2,1,0]=(0.932053911771)*(1+2.*(dim-1.)/(o+1.))+(-0.282520313985)*dim
        ref[2,1,1]=(-0.225423230776)*(1+2.*(dim-1.)/(o+1.))+(-0.145554529474)*dim
        ref[3,0,0]=(0.33956051304)*(1+2.*(dim-1.)/(o+1.))+(0.547910209204)*dim
        ref[3,0,1]=(0.173380213454)*(1+2.*(dim-1.)/(o+1.))+(0.932813290049)*dim
        ref[3,1,0]=(-1.88951133865)*(1+2.*(dim-1.)/(o+1.))+(-0.788168666455)*dim
        ref[3,1,1]=(-1.97062923668)*(1+2.*(dim-1.)/(o+1.))+(-0.850798284089)*dim
        ref[4,0,0]=(-0.637679352447)*(1+2.*(dim-1.)/(o+1.))+(1.87404355948)*dim
        ref[4,0,1]=(-1.41003779811)*(1+2.*(dim-1.)/(o+1.))+(0.956756299709)*dim
        ref[4,1,0]=(-0.303017167297)*(1+2.*(dim-1.)/(o+1.))+(-1.89130348195)*dim
        ref[4,1,1]=(0.539001756993)*(1+2.*(dim-1.)/(o+1.))+(0.735413000173)*dim
        ref[5,0,0]=(1.78586601194)*(1+2.*(dim-1.)/(o+1.))+(-0.79810217308)*dim
        ref[5,0,1]=(-1.0914995357)*(1+2.*(dim-1.)/(o+1.))+(-0.198480102871)*dim
        ref[5,1,0]=(1.90781359949)*(1+2.*(dim-1.)/(o+1.))+(-0.530721411887)*dim
        ref[5,1,1]=(0.918900154108)*(1+2.*(dim-1.)/(o+1.))+(1.10787066642)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_Solution_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.181966612335)*x[0]**o+(-0.461883712153)*x[0]+(-0.420217253531)*x[1]**o+(0.52197109374)*x[1]
        arg[0,0,0,1]=(-0.122704378373)*x[0]**o+(0.549708706786)*x[0]+(-0.728108908074)*x[1]**o+(-0.839262748545)*x[1]
        arg[0,0,1,0]=(0.58557741427)*x[0]**o+(-0.970633305521)*x[0]+(0.215513381389)*x[1]**o+(-0.178877868196)*x[1]
        arg[0,0,1,1]=(0.646118894595)*x[0]**o+(0.839917605008)*x[0]+(-0.608843960266)*x[1]**o+(-0.840842208189)*x[1]
        arg[0,0,2,0]=(-0.126004594384)*x[0]**o+(0.663487355648)*x[0]+(0.801751176464)*x[1]**o+(-0.76620842256)*x[1]
        arg[0,0,2,1]=(-0.244425023768)*x[0]**o+(0.736809513316)*x[0]+(0.736776514098)*x[1]**o+(0.382648973627)*x[1]
        arg[0,1,0,0]=(-0.264460763052)*x[0]**o+(-0.325868872518)*x[0]+(-0.0636203008538)*x[1]**o+(-0.398059740187)*x[1]
        arg[0,1,0,1]=(0.443639751435)*x[0]**o+(0.523903519493)*x[0]+(-0.222575248757)*x[1]**o+(-0.168203019401)*x[1]
        arg[0,1,1,0]=(-0.329523829258)*x[0]**o+(-0.908408437436)*x[0]+(0.695441587034)*x[1]**o+(-0.236957609006)*x[1]
        arg[0,1,1,1]=(-0.57363301023)*x[0]**o+(-0.168677045141)*x[0]+(0.455235475098)*x[1]**o+(-0.498803217861)*x[1]
        arg[0,1,2,0]=(0.09906404243)*x[0]**o+(0.48682122702)*x[0]+(-0.250940180366)*x[1]**o+(-0.641013418008)*x[1]
        arg[0,1,2,1]=(-0.963193555161)*x[0]**o+(0.129868691037)*x[0]+(0.821192174481)*x[1]**o+(-0.245576703223)*x[1]
        arg[0,2,0,0]=(-0.867410251576)*x[0]**o+(0.170194043006)*x[0]+(0.837669366536)*x[1]**o+(0.285772890787)*x[1]
        arg[0,2,0,1]=(0.767089114154)*x[0]**o+(-0.425174482112)*x[0]+(-0.460840645159)*x[1]**o+(-0.314295694392)*x[1]
        arg[0,2,1,0]=(-0.932934920269)*x[0]**o+(0.399552332498)*x[0]+(-0.137764102275)*x[1]**o+(-0.0375128952657)*x[1]
        arg[0,2,1,1]=(0.507999826854)*x[0]**o+(-0.60826518686)*x[0]+(0.766838061511)*x[1]**o+(0.800723296773)*x[1]
        arg[0,2,2,0]=(0.372064864992)*x[0]**o+(0.29029476011)*x[0]+(0.203299629846)*x[1]**o+(-0.386357855884)*x[1]
        arg[0,2,2,1]=(0.661268311956)*x[0]**o+(0.60257115577)*x[0]+(0.88881711536)*x[1]**o+(0.335431084294)*x[1]
        arg[0,3,0,0]=(-0.756295024079)*x[0]**o+(-0.982472476783)*x[0]+(-0.264060825724)*x[1]**o+(0.082684535426)*x[1]
        arg[0,3,0,1]=(0.514580120205)*x[0]**o+(0.524816925461)*x[0]+(-0.745096223094)*x[1]**o+(-0.0796881815577)*x[1]
        arg[0,3,1,0]=(0.597556449974)*x[0]**o+(0.527680495979)*x[0]+(0.517638167762)*x[1]**o+(-0.357836534374)*x[1]
        arg[0,3,1,1]=(0.354366560101)*x[0]**o+(-0.617697325436)*x[0]+(0.339071431286)*x[1]**o+(0.299934132319)*x[1]
        arg[0,3,2,0]=(0.26563455123)*x[0]**o+(0.821495614519)*x[0]+(0.177496963332)*x[1]**o+(-0.154521746257)*x[1]
        arg[0,3,2,1]=(0.983477388632)*x[0]**o+(0.524806318175)*x[0]+(-0.604096007297)*x[1]**o+(0.350360164328)*x[1]
        arg[0,4,0,0]=(0.311369778768)*x[0]**o+(-0.648416457513)*x[0]+(0.463469290711)*x[1]**o+(0.0719628828709)*x[1]
        arg[0,4,0,1]=(-0.743081056195)*x[0]**o+(-0.803573973461)*x[0]+(-0.766982068691)*x[1]**o+(0.387240020398)*x[1]
        arg[0,4,1,0]=(-0.0715117411345)*x[0]**o+(-0.341871715212)*x[0]+(0.0593378446291)*x[1]**o+(-0.10183864979)*x[1]
        arg[0,4,1,1]=(0.538850329978)*x[0]**o+(0.0280201497914)*x[0]+(0.350206859589)*x[1]**o+(0.316831165676)*x[1]
        arg[0,4,2,0]=(-0.327852385434)*x[0]**o+(0.408866306659)*x[0]+(0.940378517318)*x[1]**o+(0.578309623908)*x[1]
        arg[0,4,2,1]=(0.378380112483)*x[0]**o+(0.696828716067)*x[0]+(-0.908233000582)*x[1]**o+(-0.328611483675)*x[1]
        arg[1,0,0,0]=(0.753991558436)*x[0]**o+(0.0542891140783)*x[0]+(-0.428934638249)*x[1]**o+(0.318155063446)*x[1]
        arg[1,0,0,1]=(-0.387609085343)*x[0]**o+(0.711023478158)*x[0]+(-0.969026331169)*x[1]**o+(0.456175434422)*x[1]
        arg[1,0,1,0]=(-0.468504469917)*x[0]**o+(-0.314756281356)*x[0]+(0.0145647044588)*x[1]**o+(0.074035761055)*x[1]
        arg[1,0,1,1]=(0.240749620446)*x[0]**o+(0.906736060537)*x[0]+(0.391320123368)*x[1]**o+(-0.261639387239)*x[1]
        arg[1,0,2,0]=(-0.461436333094)*x[0]**o+(-0.809258428817)*x[0]+(0.0670777162266)*x[1]**o+(-0.445304287721)*x[1]
        arg[1,0,2,1]=(-0.569794448172)*x[0]**o+(-0.0624052432724)*x[0]+(-0.759840810858)*x[1]**o+(-0.609106375016)*x[1]
        arg[1,1,0,0]=(0.751570143287)*x[0]**o+(0.78189919599)*x[0]+(-0.103246458909)*x[1]**o+(0.732156635312)*x[1]
        arg[1,1,0,1]=(-0.0126214545951)*x[0]**o+(-0.612853966263)*x[0]+(-0.238555698245)*x[1]**o+(-0.668009933698)*x[1]
        arg[1,1,1,0]=(0.816325838743)*x[0]**o+(0.545518357738)*x[0]+(0.893296287925)*x[1]**o+(0.694579919864)*x[1]
        arg[1,1,1,1]=(0.927638834795)*x[0]**o+(0.750347688466)*x[0]+(-0.15924462002)*x[1]**o+(-0.952995938892)*x[1]
        arg[1,1,2,0]=(0.970761253678)*x[0]**o+(0.205308852313)*x[0]+(0.909209906751)*x[1]**o+(-0.178635180174)*x[1]
        arg[1,1,2,1]=(-0.632065128479)*x[0]**o+(-0.300905398347)*x[0]+(0.865317638002)*x[1]**o+(0.886398250669)*x[1]
        arg[1,2,0,0]=(-0.0529293620539)*x[0]**o+(-0.909022003179)*x[0]+(0.235231916345)*x[1]**o+(-0.623380752415)*x[1]
        arg[1,2,0,1]=(0.873344987616)*x[0]**o+(0.144231546529)*x[0]+(0.307375566381)*x[1]**o+(-0.201617507084)*x[1]
        arg[1,2,1,0]=(-0.957945047658)*x[0]**o+(-0.432955474381)*x[0]+(0.0742288164869)*x[1]**o+(-0.106080430366)*x[1]
        arg[1,2,1,1]=(-0.664227561512)*x[0]**o+(0.0821007781774)*x[0]+(-0.541506076231)*x[1]**o+(-0.88307957937)*x[1]
        arg[1,2,2,0]=(0.754702675232)*x[0]**o+(0.175176916913)*x[0]+(0.519607893979)*x[1]**o+(-0.24129526204)*x[1]
        arg[1,2,2,1]=(-0.415660998528)*x[0]**o+(-0.964071393069)*x[0]+(0.458656303526)*x[1]**o+(0.752153826846)*x[1]
        arg[1,3,0,0]=(-0.15638393187)*x[0]**o+(0.0828824719)*x[0]+(-0.0846205011509)*x[1]**o+(-0.438939463736)*x[1]
        arg[1,3,0,1]=(0.222994482074)*x[0]**o+(-0.488426101986)*x[0]+(-0.799262651825)*x[1]**o+(0.0638880385288)*x[1]
        arg[1,3,1,0]=(0.690529298963)*x[0]**o+(-0.845248154386)*x[0]+(0.748635110096)*x[1]**o+(0.820882250869)*x[1]
        arg[1,3,1,1]=(-0.0989162396328)*x[0]**o+(-0.171252734498)*x[0]+(-0.363447812361)*x[1]**o+(-0.06937701403)*x[1]
        arg[1,3,2,0]=(-0.739647298124)*x[0]**o+(-0.83384135572)*x[0]+(0.546124768813)*x[1]**o+(0.415761104064)*x[1]
        arg[1,3,2,1]=(0.859487140106)*x[0]**o+(0.481214854724)*x[0]+(0.788685241166)*x[1]**o+(-0.776410333263)*x[1]
        arg[1,4,0,0]=(-0.312428038681)*x[0]**o+(-0.178596293803)*x[0]+(-0.229770546807)*x[1]**o+(-0.43765633326)*x[1]
        arg[1,4,0,1]=(-0.974305286188)*x[0]**o+(-0.978154435248)*x[0]+(-0.671799350916)*x[1]**o+(0.645287291694)*x[1]
        arg[1,4,1,0]=(-0.219711371151)*x[0]**o+(-0.432784911532)*x[0]+(0.552940388883)*x[1]**o+(-0.622742205614)*x[1]
        arg[1,4,1,1]=(0.677289749287)*x[0]**o+(-0.92825132284)*x[0]+(0.818767358259)*x[1]**o+(-0.426000012305)*x[1]
        arg[1,4,2,0]=(-0.507474696573)*x[0]**o+(0.0882151625837)*x[0]+(0.826611187078)*x[1]**o+(0.157884229299)*x[1]
        arg[1,4,2,1]=(0.902398378671)*x[0]**o+(-0.372679984773)*x[0]+(-0.998272135687)*x[1]**o+(0.292294917465)*x[1]
        arg[2,0,0,0]=(0.699035433674)*x[0]**o+(0.380640017665)*x[0]+(-0.650735771214)*x[1]**o+(-0.55187467604)*x[1]
        arg[2,0,0,1]=(0.703438074924)*x[0]**o+(0.795508285134)*x[0]+(-0.0650847718675)*x[1]**o+(-0.0250766383001)*x[1]
        arg[2,0,1,0]=(0.493174434488)*x[0]**o+(-0.775523541313)*x[0]+(0.23184619496)*x[1]**o+(0.343368328234)*x[1]
        arg[2,0,1,1]=(0.404974280918)*x[0]**o+(0.0673627086244)*x[0]+(-0.843957699955)*x[1]**o+(0.645895713789)*x[1]
        arg[2,0,2,0]=(0.985047143685)*x[0]**o+(0.969582300743)*x[0]+(0.929427858098)*x[1]**o+(-0.951787413112)*x[1]
        arg[2,0,2,1]=(0.618505056215)*x[0]**o+(0.685760720523)*x[0]+(0.14594727158)*x[1]**o+(0.816579780815)*x[1]
        arg[2,1,0,0]=(0.0824953418089)*x[0]**o+(-0.896753351387)*x[0]+(0.415841596602)*x[1]**o+(0.349436600222)*x[1]
        arg[2,1,0,1]=(-0.904246301273)*x[0]**o+(0.51403543319)*x[0]+(0.0950147832662)*x[1]**o+(0.0482220256459)*x[1]
        arg[2,1,1,0]=(0.653418547332)*x[0]**o+(0.703094950575)*x[0]+(-0.294924381355)*x[1]**o+(0.889408306649)*x[1]
        arg[2,1,1,1]=(-0.329361050221)*x[0]**o+(-0.93072021487)*x[0]+(0.0845194032793)*x[1]**o+(-0.310617126183)*x[1]
        arg[2,1,2,0]=(-0.282371473471)*x[0]**o+(0.387458491178)*x[0]+(0.643908016757)*x[1]**o+(0.303741991451)*x[1]
        arg[2,1,2,1]=(-0.416872502153)*x[0]**o+(0.373465764073)*x[0]+(-0.90689140487)*x[1]**o+(-0.351052228378)*x[1]
        arg[2,2,0,0]=(0.494198770026)*x[0]**o+(0.744917026846)*x[0]+(-0.806591346974)*x[1]**o+(-0.812396479226)*x[1]
        arg[2,2,0,1]=(0.230573331783)*x[0]**o+(-0.449815323831)*x[0]+(-0.662178492084)*x[1]**o+(0.0281786827584)*x[1]
        arg[2,2,1,0]=(-0.546296599764)*x[0]**o+(-0.457939754236)*x[0]+(-0.0432225723667)*x[1]**o+(0.0431706529852)*x[1]
        arg[2,2,1,1]=(-0.808174460895)*x[0]**o+(-0.473584203382)*x[0]+(0.567514752294)*x[1]**o+(-0.115780229631)*x[1]
        arg[2,2,2,0]=(-0.134425008633)*x[0]**o+(-0.103550646345)*x[0]+(-0.588484951305)*x[1]**o+(0.955148281194)*x[1]
        arg[2,2,2,1]=(0.550095417437)*x[0]**o+(0.943564321046)*x[0]+(-0.990366145789)*x[1]**o+(0.872652302953)*x[1]
        arg[2,3,0,0]=(0.209341033615)*x[0]**o+(-0.285197252362)*x[0]+(0.961111991429)*x[1]**o+(0.810022268034)*x[1]
        arg[2,3,0,1]=(0.238319839582)*x[0]**o+(-0.714990515235)*x[0]+(0.0925371590198)*x[1]**o+(0.938145796375)*x[1]
        arg[2,3,1,0]=(0.889068347007)*x[0]**o+(-0.301904392078)*x[0]+(0.41386941601)*x[1]**o+(-0.973115118701)*x[1]
        arg[2,3,1,1]=(-0.522083695846)*x[0]**o+(-0.582455208417)*x[0]+(0.725431346859)*x[1]**o+(-0.950157996033)*x[1]
        arg[2,3,2,0]=(-0.897838142917)*x[0]**o+(0.745488698358)*x[0]+(-0.38910727894)*x[1]**o+(0.614539961316)*x[1]
        arg[2,3,2,1]=(0.924500645496)*x[0]**o+(-0.68988446876)*x[0]+(-0.466238481805)*x[1]**o+(-0.957703006413)*x[1]
        arg[2,4,0,0]=(0.280692018949)*x[0]**o+(0.600320489083)*x[0]+(-0.402390231845)*x[1]**o+(0.906721159456)*x[1]
        arg[2,4,0,1]=(0.50594574787)*x[0]**o+(0.130986910768)*x[0]+(0.272643351394)*x[1]**o+(0.53790545383)*x[1]
        arg[2,4,1,0]=(-0.627308461808)*x[0]**o+(0.690560028115)*x[0]+(-0.455768647207)*x[1]**o+(0.134926199015)*x[1]
        arg[2,4,1,1]=(-0.501163279392)*x[0]**o+(0.980144824993)*x[0]+(-0.0358930723173)*x[1]**o+(0.720157452357)*x[1]
        arg[2,4,2,0]=(-0.609861117539)*x[0]**o+(0.965699461849)*x[0]+(0.305674136837)*x[1]**o+(-0.578333683729)*x[1]
        arg[2,4,2,1]=(-0.921051416627)*x[0]**o+(-0.703479746028)*x[0]+(-0.0189027931731)*x[1]**o+(0.403415497212)*x[1]
        arg[3,0,0,0]=(-0.846266714886)*x[0]**o+(-0.103621657972)*x[0]+(0.217340457606)*x[1]**o+(-0.537654290693)*x[1]
        arg[3,0,0,1]=(0.186251745403)*x[0]**o+(0.694458841658)*x[0]+(0.126837362883)*x[1]**o+(0.0997502401792)*x[1]
        arg[3,0,1,0]=(0.153737843143)*x[0]**o+(0.811590040899)*x[0]+(0.189363446699)*x[1]**o+(0.00688399857093)*x[1]
        arg[3,0,1,1]=(-0.912444421339)*x[0]**o+(-0.68504171198)*x[0]+(-0.820717153919)*x[1]**o+(-0.00475951426309)*x[1]
        arg[3,0,2,0]=(0.908522439455)*x[0]**o+(-0.911126936858)*x[0]+(0.0424198145962)*x[1]**o+(-0.352097158128)*x[1]
        arg[3,0,2,1]=(0.935127271967)*x[0]**o+(0.154700792222)*x[0]+(-0.283148208173)*x[1]**o+(-0.607541482501)*x[1]
        arg[3,1,0,0]=(-0.131329160543)*x[0]**o+(0.24170180662)*x[0]+(-0.00893591013587)*x[1]**o+(0.262635048958)*x[1]
        arg[3,1,0,1]=(-0.559200924561)*x[0]**o+(0.509310116425)*x[0]+(0.484486720282)*x[1]**o+(-0.89314080386)*x[1]
        arg[3,1,1,0]=(0.355094442114)*x[0]**o+(-0.748398915688)*x[0]+(-0.379187476624)*x[1]**o+(0.447409858108)*x[1]
        arg[3,1,1,1]=(0.170855109103)*x[0]**o+(-0.48925054508)*x[0]+(0.840559727559)*x[1]**o+(0.0359562471889)*x[1]
        arg[3,1,2,0]=(0.827586094521)*x[0]**o+(0.0231820503547)*x[0]+(0.457192172855)*x[1]**o+(0.826960230377)*x[1]
        arg[3,1,2,1]=(-0.962890676345)*x[0]**o+(-0.112439391098)*x[0]+(-0.865510686025)*x[1]**o+(-0.539059426684)*x[1]
        arg[3,2,0,0]=(-0.165030011664)*x[0]**o+(-0.285694090419)*x[0]+(-0.522579583443)*x[1]**o+(0.73946640768)*x[1]
        arg[3,2,0,1]=(0.809351962503)*x[0]**o+(-0.872047628102)*x[0]+(0.61415433255)*x[1]**o+(0.132268088986)*x[1]
        arg[3,2,1,0]=(-0.587823544835)*x[0]**o+(-0.416092975475)*x[0]+(0.829027070431)*x[1]**o+(0.805271620727)*x[1]
        arg[3,2,1,1]=(-0.0107935093527)*x[0]**o+(0.988434287979)*x[0]+(0.941743055822)*x[1]**o+(0.137807879334)*x[1]
        arg[3,2,2,0]=(-0.855931527408)*x[0]**o+(0.575075608849)*x[0]+(0.11916967111)*x[1]**o+(-0.472844336533)*x[1]
        arg[3,2,2,1]=(-0.542112514875)*x[0]**o+(0.081308081083)*x[0]+(-0.934575648869)*x[1]**o+(-0.218208369535)*x[1]
        arg[3,3,0,0]=(0.486635391195)*x[0]**o+(0.995728500002)*x[0]+(-0.686767180456)*x[1]**o+(0.246849483855)*x[1]
        arg[3,3,0,1]=(-0.331571848212)*x[0]**o+(0.801870431206)*x[0]+(-0.91142654055)*x[1]**o+(0.089854528457)*x[1]
        arg[3,3,1,0]=(-0.657455652936)*x[0]**o+(-0.721466128651)*x[0]+(0.0420989631458)*x[1]**o+(-0.982316453325)*x[1]
        arg[3,3,1,1]=(-0.709257565086)*x[0]**o+(0.689028730506)*x[0]+(-0.196516960475)*x[1]**o+(-0.216704841188)*x[1]
        arg[3,3,2,0]=(-0.910547650394)*x[0]**o+(-0.977471949987)*x[0]+(0.37319115353)*x[1]**o+(-0.248978955796)*x[1]
        arg[3,3,2,1]=(-0.71025804576)*x[0]**o+(0.373559860529)*x[0]+(-0.9064074733)*x[1]**o+(-0.542012058073)*x[1]
        arg[3,4,0,0]=(-0.649273580176)*x[0]**o+(0.525784948768)*x[0]+(-0.213929862516)*x[1]**o+(-0.162295172275)*x[1]
        arg[3,4,0,1]=(0.209784328978)*x[0]**o+(-0.972601183002)*x[0]+(-0.730886568265)*x[1]**o+(0.966415518759)*x[1]
        arg[3,4,1,0]=(-0.334060094293)*x[0]**o+(0.29371522739)*x[0]+(0.936156150108)*x[1]**o+(-0.257026769476)*x[1]
        arg[3,4,1,1]=(-0.0465451767064)*x[0]**o+(0.115525862669)*x[0]+(0.891280073228)*x[1]**o+(-0.0436233989979)*x[1]
        arg[3,4,2,0]=(-0.748697989123)*x[0]**o+(0.246672415445)*x[0]+(0.62642302161)*x[1]**o+(-0.411644161038)*x[1]
        arg[3,4,2,1]=(0.850132316298)*x[0]**o+(0.939463534845)*x[0]+(0.0437756618735)*x[1]**o+(-0.955198146074)*x[1]
        ref[0,0,0,0]=(-0.238250641196)*(1+2.*(dim-1.)/(o+1.))+(0.0600873815876)*dim
        ref[0,0,0,1]=(-0.850813286447)*(1+2.*(dim-1.)/(o+1.))+(-0.28955404176)*dim
        ref[0,0,1,0]=(0.801090795659)*(1+2.*(dim-1.)/(o+1.))+(-1.14951117372)*dim
        ref[0,0,1,1]=(0.0372749343294)*(1+2.*(dim-1.)/(o+1.))+(-0.000924603180129)*dim
        ref[0,0,2,0]=(0.675746582079)*(1+2.*(dim-1.)/(o+1.))+(-0.102721066912)*dim
        ref[0,0,2,1]=(0.49235149033)*(1+2.*(dim-1.)/(o+1.))+(1.11945848694)*dim
        ref[0,1,0,0]=(-0.328081063906)*(1+2.*(dim-1.)/(o+1.))+(-0.723928612706)*dim
        ref[0,1,0,1]=(0.221064502678)*(1+2.*(dim-1.)/(o+1.))+(0.355700500092)*dim
        ref[0,1,1,0]=(0.365917757777)*(1+2.*(dim-1.)/(o+1.))+(-1.14536604644)*dim
        ref[0,1,1,1]=(-0.118397535132)*(1+2.*(dim-1.)/(o+1.))+(-0.667480263002)*dim
        ref[0,1,2,0]=(-0.151876137936)*(1+2.*(dim-1.)/(o+1.))+(-0.154192190988)*dim
        ref[0,1,2,1]=(-0.14200138068)*(1+2.*(dim-1.)/(o+1.))+(-0.115708012186)*dim
        ref[0,2,0,0]=(-0.0297408850402)*(1+2.*(dim-1.)/(o+1.))+(0.455966933793)*dim
        ref[0,2,0,1]=(0.306248468995)*(1+2.*(dim-1.)/(o+1.))+(-0.739470176504)*dim
        ref[0,2,1,0]=(-1.07069902254)*(1+2.*(dim-1.)/(o+1.))+(0.362039437233)*dim
        ref[0,2,1,1]=(1.27483788836)*(1+2.*(dim-1.)/(o+1.))+(0.192458109913)*dim
        ref[0,2,2,0]=(0.575364494839)*(1+2.*(dim-1.)/(o+1.))+(-0.0960630957749)*dim
        ref[0,2,2,1]=(1.55008542732)*(1+2.*(dim-1.)/(o+1.))+(0.938002240064)*dim
        ref[0,3,0,0]=(-1.0203558498)*(1+2.*(dim-1.)/(o+1.))+(-0.899787941357)*dim
        ref[0,3,0,1]=(-0.230516102889)*(1+2.*(dim-1.)/(o+1.))+(0.445128743903)*dim
        ref[0,3,1,0]=(1.11519461774)*(1+2.*(dim-1.)/(o+1.))+(0.169843961604)*dim
        ref[0,3,1,1]=(0.693437991388)*(1+2.*(dim-1.)/(o+1.))+(-0.317763193117)*dim
        ref[0,3,2,0]=(0.443131514562)*(1+2.*(dim-1.)/(o+1.))+(0.666973868262)*dim
        ref[0,3,2,1]=(0.379381381335)*(1+2.*(dim-1.)/(o+1.))+(0.875166482503)*dim
        ref[0,4,0,0]=(0.774839069479)*(1+2.*(dim-1.)/(o+1.))+(-0.576453574642)*dim
        ref[0,4,0,1]=(-1.51006312489)*(1+2.*(dim-1.)/(o+1.))+(-0.416333953063)*dim
        ref[0,4,1,0]=(-0.0121738965054)*(1+2.*(dim-1.)/(o+1.))+(-0.443710365002)*dim
        ref[0,4,1,1]=(0.889057189568)*(1+2.*(dim-1.)/(o+1.))+(0.344851315468)*dim
        ref[0,4,2,0]=(0.612526131884)*(1+2.*(dim-1.)/(o+1.))+(0.987175930567)*dim
        ref[0,4,2,1]=(-0.529852888099)*(1+2.*(dim-1.)/(o+1.))+(0.368217232392)*dim
        ref[1,0,0,0]=(0.325056920187)*(1+2.*(dim-1.)/(o+1.))+(0.372444177524)*dim
        ref[1,0,0,1]=(-1.35663541651)*(1+2.*(dim-1.)/(o+1.))+(1.16719891258)*dim
        ref[1,0,1,0]=(-0.453939765458)*(1+2.*(dim-1.)/(o+1.))+(-0.240720520301)*dim
        ref[1,0,1,1]=(0.632069743814)*(1+2.*(dim-1.)/(o+1.))+(0.645096673298)*dim
        ref[1,0,2,0]=(-0.394358616867)*(1+2.*(dim-1.)/(o+1.))+(-1.25456271654)*dim
        ref[1,0,2,1]=(-1.32963525903)*(1+2.*(dim-1.)/(o+1.))+(-0.671511618288)*dim
        ref[1,1,0,0]=(0.648323684378)*(1+2.*(dim-1.)/(o+1.))+(1.5140558313)*dim
        ref[1,1,0,1]=(-0.251177152841)*(1+2.*(dim-1.)/(o+1.))+(-1.28086389996)*dim
        ref[1,1,1,0]=(1.70962212667)*(1+2.*(dim-1.)/(o+1.))+(1.2400982776)*dim
        ref[1,1,1,1]=(0.768394214775)*(1+2.*(dim-1.)/(o+1.))+(-0.202648250425)*dim
        ref[1,1,2,0]=(1.87997116043)*(1+2.*(dim-1.)/(o+1.))+(0.0266736721392)*dim
        ref[1,1,2,1]=(0.233252509524)*(1+2.*(dim-1.)/(o+1.))+(0.585492852322)*dim
        ref[1,2,0,0]=(0.182302554291)*(1+2.*(dim-1.)/(o+1.))+(-1.53240275559)*dim
        ref[1,2,0,1]=(1.180720554)*(1+2.*(dim-1.)/(o+1.))+(-0.0573859605549)*dim
        ref[1,2,1,0]=(-0.883716231171)*(1+2.*(dim-1.)/(o+1.))+(-0.539035904746)*dim
        ref[1,2,1,1]=(-1.20573363774)*(1+2.*(dim-1.)/(o+1.))+(-0.800978801193)*dim
        ref[1,2,2,0]=(1.27431056921)*(1+2.*(dim-1.)/(o+1.))+(-0.066118345127)*dim
        ref[1,2,2,1]=(0.0429953049979)*(1+2.*(dim-1.)/(o+1.))+(-0.211917566223)*dim
        ref[1,3,0,0]=(-0.241004433021)*(1+2.*(dim-1.)/(o+1.))+(-0.356056991836)*dim
        ref[1,3,0,1]=(-0.576268169751)*(1+2.*(dim-1.)/(o+1.))+(-0.424538063457)*dim
        ref[1,3,1,0]=(1.43916440906)*(1+2.*(dim-1.)/(o+1.))+(-0.0243659035174)*dim
        ref[1,3,1,1]=(-0.462364051993)*(1+2.*(dim-1.)/(o+1.))+(-0.240629748528)*dim
        ref[1,3,2,0]=(-0.193522529311)*(1+2.*(dim-1.)/(o+1.))+(-0.418080251656)*dim
        ref[1,3,2,1]=(1.64817238127)*(1+2.*(dim-1.)/(o+1.))+(-0.295195478539)*dim
        ref[1,4,0,0]=(-0.542198585489)*(1+2.*(dim-1.)/(o+1.))+(-0.616252627062)*dim
        ref[1,4,0,1]=(-1.6461046371)*(1+2.*(dim-1.)/(o+1.))+(-0.332867143554)*dim
        ref[1,4,1,0]=(0.333229017732)*(1+2.*(dim-1.)/(o+1.))+(-1.05552711715)*dim
        ref[1,4,1,1]=(1.49605710755)*(1+2.*(dim-1.)/(o+1.))+(-1.35425133515)*dim
        ref[1,4,2,0]=(0.319136490505)*(1+2.*(dim-1.)/(o+1.))+(0.246099391883)*dim
        ref[1,4,2,1]=(-0.0958737570155)*(1+2.*(dim-1.)/(o+1.))+(-0.0803850673082)*dim
        ref[2,0,0,0]=(0.0482996624604)*(1+2.*(dim-1.)/(o+1.))+(-0.171234658375)*dim
        ref[2,0,0,1]=(0.638353303057)*(1+2.*(dim-1.)/(o+1.))+(0.770431646834)*dim
        ref[2,0,1,0]=(0.725020629449)*(1+2.*(dim-1.)/(o+1.))+(-0.432155213079)*dim
        ref[2,0,1,1]=(-0.438983419037)*(1+2.*(dim-1.)/(o+1.))+(0.713258422414)*dim
        ref[2,0,2,0]=(1.91447500178)*(1+2.*(dim-1.)/(o+1.))+(0.0177948876308)*dim
        ref[2,0,2,1]=(0.764452327795)*(1+2.*(dim-1.)/(o+1.))+(1.50234050134)*dim
        ref[2,1,0,0]=(0.498336938411)*(1+2.*(dim-1.)/(o+1.))+(-0.547316751164)*dim
        ref[2,1,0,1]=(-0.809231518007)*(1+2.*(dim-1.)/(o+1.))+(0.562257458836)*dim
        ref[2,1,1,0]=(0.358494165977)*(1+2.*(dim-1.)/(o+1.))+(1.59250325722)*dim
        ref[2,1,1,1]=(-0.244841646941)*(1+2.*(dim-1.)/(o+1.))+(-1.24133734105)*dim
        ref[2,1,2,0]=(0.361536543287)*(1+2.*(dim-1.)/(o+1.))+(0.691200482629)*dim
        ref[2,1,2,1]=(-1.32376390702)*(1+2.*(dim-1.)/(o+1.))+(0.0224135356952)*dim
        ref[2,2,0,0]=(-0.312392576948)*(1+2.*(dim-1.)/(o+1.))+(-0.06747945238)*dim
        ref[2,2,0,1]=(-0.431605160301)*(1+2.*(dim-1.)/(o+1.))+(-0.421636641073)*dim
        ref[2,2,1,0]=(-0.589519172131)*(1+2.*(dim-1.)/(o+1.))+(-0.414769101251)*dim
        ref[2,2,1,1]=(-0.240659708601)*(1+2.*(dim-1.)/(o+1.))+(-0.589364433013)*dim
        ref[2,2,2,0]=(-0.722909959939)*(1+2.*(dim-1.)/(o+1.))+(0.851597634849)*dim
        ref[2,2,2,1]=(-0.440270728352)*(1+2.*(dim-1.)/(o+1.))+(1.816216624)*dim
        ref[2,3,0,0]=(1.17045302504)*(1+2.*(dim-1.)/(o+1.))+(0.524825015672)*dim
        ref[2,3,0,1]=(0.330856998602)*(1+2.*(dim-1.)/(o+1.))+(0.22315528114)*dim
        ref[2,3,1,0]=(1.30293776302)*(1+2.*(dim-1.)/(o+1.))+(-1.27501951078)*dim
        ref[2,3,1,1]=(0.203347651013)*(1+2.*(dim-1.)/(o+1.))+(-1.53261320445)*dim
        ref[2,3,2,0]=(-1.28694542186)*(1+2.*(dim-1.)/(o+1.))+(1.36002865967)*dim
        ref[2,3,2,1]=(0.458262163691)*(1+2.*(dim-1.)/(o+1.))+(-1.64758747517)*dim
        ref[2,4,0,0]=(-0.121698212896)*(1+2.*(dim-1.)/(o+1.))+(1.50704164854)*dim
        ref[2,4,0,1]=(0.778589099264)*(1+2.*(dim-1.)/(o+1.))+(0.668892364598)*dim
        ref[2,4,1,0]=(-1.08307710902)*(1+2.*(dim-1.)/(o+1.))+(0.82548622713)*dim
        ref[2,4,1,1]=(-0.537056351709)*(1+2.*(dim-1.)/(o+1.))+(1.70030227735)*dim
        ref[2,4,2,0]=(-0.304186980702)*(1+2.*(dim-1.)/(o+1.))+(0.38736577812)*dim
        ref[2,4,2,1]=(-0.9399542098)*(1+2.*(dim-1.)/(o+1.))+(-0.300064248815)*dim
        ref[3,0,0,0]=(-0.62892625728)*(1+2.*(dim-1.)/(o+1.))+(-0.641275948665)*dim
        ref[3,0,0,1]=(0.313089108286)*(1+2.*(dim-1.)/(o+1.))+(0.794209081837)*dim
        ref[3,0,1,0]=(0.343101289842)*(1+2.*(dim-1.)/(o+1.))+(0.81847403947)*dim
        ref[3,0,1,1]=(-1.73316157526)*(1+2.*(dim-1.)/(o+1.))+(-0.689801226243)*dim
        ref[3,0,2,0]=(0.950942254051)*(1+2.*(dim-1.)/(o+1.))+(-1.26322409499)*dim
        ref[3,0,2,1]=(0.651979063795)*(1+2.*(dim-1.)/(o+1.))+(-0.452840690279)*dim
        ref[3,1,0,0]=(-0.140265070679)*(1+2.*(dim-1.)/(o+1.))+(0.504336855579)*dim
        ref[3,1,0,1]=(-0.074714204279)*(1+2.*(dim-1.)/(o+1.))+(-0.383830687435)*dim
        ref[3,1,1,0]=(-0.0240930345095)*(1+2.*(dim-1.)/(o+1.))+(-0.30098905758)*dim
        ref[3,1,1,1]=(1.01141483666)*(1+2.*(dim-1.)/(o+1.))+(-0.453294297891)*dim
        ref[3,1,2,0]=(1.28477826738)*(1+2.*(dim-1.)/(o+1.))+(0.850142280731)*dim
        ref[3,1,2,1]=(-1.82840136237)*(1+2.*(dim-1.)/(o+1.))+(-0.651498817783)*dim
        ref[3,2,0,0]=(-0.687609595107)*(1+2.*(dim-1.)/(o+1.))+(0.453772317262)*dim
        ref[3,2,0,1]=(1.42350629505)*(1+2.*(dim-1.)/(o+1.))+(-0.739779539116)*dim
        ref[3,2,1,0]=(0.241203525596)*(1+2.*(dim-1.)/(o+1.))+(0.389178645253)*dim
        ref[3,2,1,1]=(0.930949546469)*(1+2.*(dim-1.)/(o+1.))+(1.12624216731)*dim
        ref[3,2,2,0]=(-0.736761856298)*(1+2.*(dim-1.)/(o+1.))+(0.102231272315)*dim
        ref[3,2,2,1]=(-1.47668816374)*(1+2.*(dim-1.)/(o+1.))+(-0.136900288452)*dim
        ref[3,3,0,0]=(-0.200131789262)*(1+2.*(dim-1.)/(o+1.))+(1.24257798386)*dim
        ref[3,3,0,1]=(-1.24299838876)*(1+2.*(dim-1.)/(o+1.))+(0.891724959663)*dim
        ref[3,3,1,0]=(-0.61535668979)*(1+2.*(dim-1.)/(o+1.))+(-1.70378258198)*dim
        ref[3,3,1,1]=(-0.905774525561)*(1+2.*(dim-1.)/(o+1.))+(0.472323889318)*dim
        ref[3,3,2,0]=(-0.537356496864)*(1+2.*(dim-1.)/(o+1.))+(-1.22645090578)*dim
        ref[3,3,2,1]=(-1.61666551906)*(1+2.*(dim-1.)/(o+1.))+(-0.168452197544)*dim
        ref[3,4,0,0]=(-0.863203442693)*(1+2.*(dim-1.)/(o+1.))+(0.363489776493)*dim
        ref[3,4,0,1]=(-0.521102239287)*(1+2.*(dim-1.)/(o+1.))+(-0.00618566424301)*dim
        ref[3,4,1,0]=(0.602096055815)*(1+2.*(dim-1.)/(o+1.))+(0.0366884579134)*dim
        ref[3,4,1,1]=(0.844734896522)*(1+2.*(dim-1.)/(o+1.))+(0.0719024636709)*dim
        ref[3,4,2,0]=(-0.122274967513)*(1+2.*(dim-1.)/(o+1.))+(-0.164971745593)*dim
        ref[3,4,2,1]=(0.893907978172)*(1+2.*(dim-1.)/(o+1.))+(-0.0157346112292)*dim
      else:
        arg[0,0,0,0]=(-0.0445963085788)*x[0]**o+(0.649401127647)*x[0]+(-0.949035518207)*x[1]**o+(0.620675629012)*x[1]+(0.379727527503)*x[2]**o+(0.0321033403935)*x[2]
        arg[0,0,0,1]=(-0.334483142061)*x[0]**o+(-0.408749824143)*x[0]+(-0.427042441291)*x[1]**o+(-0.263818177378)*x[1]+(-0.0490001897328)*x[2]**o+(0.925792628022)*x[2]
        arg[0,0,1,0]=(0.632498844224)*x[0]**o+(-0.756487058254)*x[0]+(-0.0277391041902)*x[1]**o+(0.615017171892)*x[1]+(-0.0956053270216)*x[2]**o+(-0.0383148218356)*x[2]
        arg[0,0,1,1]=(0.560189295143)*x[0]**o+(-0.565632451768)*x[0]+(0.131609132282)*x[1]**o+(0.689012872903)*x[1]+(-0.0542418297927)*x[2]**o+(-0.816694105058)*x[2]
        arg[0,0,2,0]=(-0.606523401606)*x[0]**o+(-0.129782638438)*x[0]+(0.286554604329)*x[1]**o+(-0.264164004519)*x[1]+(-0.145168356054)*x[2]**o+(0.346147680755)*x[2]
        arg[0,0,2,1]=(-0.847528471559)*x[0]**o+(-0.50641170288)*x[0]+(-0.773325001399)*x[1]**o+(0.517649361249)*x[1]+(-0.531000881434)*x[2]**o+(0.220222077563)*x[2]
        arg[0,1,0,0]=(-0.0946495378384)*x[0]**o+(-0.312650449416)*x[0]+(0.183321918505)*x[1]**o+(-0.359448777446)*x[1]+(0.713219915733)*x[2]**o+(-0.436742264028)*x[2]
        arg[0,1,0,1]=(0.856947337921)*x[0]**o+(0.497228192699)*x[0]+(0.351718755501)*x[1]**o+(-0.928210477058)*x[1]+(0.586853747677)*x[2]**o+(-0.915642724205)*x[2]
        arg[0,1,1,0]=(-0.745330469339)*x[0]**o+(-0.724610807566)*x[0]+(0.821804346007)*x[1]**o+(0.241991559492)*x[1]+(0.508380905493)*x[2]**o+(0.756706999359)*x[2]
        arg[0,1,1,1]=(-0.647952004012)*x[0]**o+(0.940964624139)*x[0]+(-0.620895246845)*x[1]**o+(0.577736885116)*x[1]+(0.228716730257)*x[2]**o+(0.336914427419)*x[2]
        arg[0,1,2,0]=(-0.671541115529)*x[0]**o+(0.153595444626)*x[0]+(0.420649971716)*x[1]**o+(-0.459078302559)*x[1]+(-0.583263239511)*x[2]**o+(-0.927250932344)*x[2]
        arg[0,1,2,1]=(-0.893954406097)*x[0]**o+(0.266297374506)*x[0]+(-0.777463374391)*x[1]**o+(0.0905062188555)*x[1]+(-0.668756964585)*x[2]**o+(-0.580980380472)*x[2]
        arg[0,2,0,0]=(0.424449538697)*x[0]**o+(0.0787502268502)*x[0]+(-0.645996834851)*x[1]**o+(-0.0409730346273)*x[1]+(0.835463212243)*x[2]**o+(0.716052012249)*x[2]
        arg[0,2,0,1]=(0.0241441154932)*x[0]**o+(-0.580242261617)*x[0]+(0.693484316968)*x[1]**o+(0.198598746328)*x[1]+(-0.586283866696)*x[2]**o+(-0.595008846645)*x[2]
        arg[0,2,1,0]=(0.074643270363)*x[0]**o+(0.454053362138)*x[0]+(0.861855819289)*x[1]**o+(-0.0310194739742)*x[1]+(-0.35738290172)*x[2]**o+(-0.400226698584)*x[2]
        arg[0,2,1,1]=(0.61780464269)*x[0]**o+(-0.702818770068)*x[0]+(0.0840653474306)*x[1]**o+(0.786842849442)*x[1]+(0.0704342755849)*x[2]**o+(0.386459053939)*x[2]
        arg[0,2,2,0]=(-0.815363379053)*x[0]**o+(-0.621823615812)*x[0]+(-0.13535005543)*x[1]**o+(-0.127080917834)*x[1]+(-0.178866000441)*x[2]**o+(-0.0753933476244)*x[2]
        arg[0,2,2,1]=(0.400194366678)*x[0]**o+(0.075003395019)*x[0]+(-0.35708995046)*x[1]**o+(-0.370028795924)*x[1]+(-0.674944523932)*x[2]**o+(-0.437373855225)*x[2]
        arg[0,3,0,0]=(-0.736317751792)*x[0]**o+(0.671627391036)*x[0]+(0.0768737429532)*x[1]**o+(-0.90036869218)*x[1]+(0.796767364925)*x[2]**o+(-0.185034722102)*x[2]
        arg[0,3,0,1]=(0.530921403378)*x[0]**o+(0.970385957718)*x[0]+(-0.75659968724)*x[1]**o+(-0.437200812366)*x[1]+(0.0519374612092)*x[2]**o+(0.657323406602)*x[2]
        arg[0,3,1,0]=(-0.109751102222)*x[0]**o+(-0.154990305064)*x[0]+(-0.502004367351)*x[1]**o+(0.535266424739)*x[1]+(-0.968926773395)*x[2]**o+(-0.138032126456)*x[2]
        arg[0,3,1,1]=(0.509506900641)*x[0]**o+(-0.872357145765)*x[0]+(-0.154129018225)*x[1]**o+(0.0190914956768)*x[1]+(0.119094726078)*x[2]**o+(0.29593674915)*x[2]
        arg[0,3,2,0]=(-0.133398979819)*x[0]**o+(-0.780852347888)*x[0]+(-0.346576066687)*x[1]**o+(0.187923380934)*x[1]+(0.939817544138)*x[2]**o+(-0.497081081638)*x[2]
        arg[0,3,2,1]=(-0.908783140711)*x[0]**o+(0.541754659297)*x[0]+(-0.297350066105)*x[1]**o+(0.118676031731)*x[1]+(0.985854358996)*x[2]**o+(-0.424715359194)*x[2]
        arg[0,4,0,0]=(0.341191520307)*x[0]**o+(-0.252381555804)*x[0]+(-0.307289805415)*x[1]**o+(0.762228901652)*x[1]+(0.390901852611)*x[2]**o+(0.147349139229)*x[2]
        arg[0,4,0,1]=(0.236625833503)*x[0]**o+(0.856322905978)*x[0]+(-0.160244298088)*x[1]**o+(-0.971940590481)*x[1]+(-0.0829366716357)*x[2]**o+(-0.687610358703)*x[2]
        arg[0,4,1,0]=(0.619591455739)*x[0]**o+(-0.62589432832)*x[0]+(-0.0275687591477)*x[1]**o+(0.367590198294)*x[1]+(0.745367285277)*x[2]**o+(0.232571513762)*x[2]
        arg[0,4,1,1]=(0.317669904199)*x[0]**o+(0.741734360559)*x[0]+(-0.923644886773)*x[1]**o+(-0.725994528938)*x[1]+(-0.949385908603)*x[2]**o+(-0.0515088731457)*x[2]
        arg[0,4,2,0]=(0.82547889841)*x[0]**o+(-0.926970312436)*x[0]+(0.946941744691)*x[1]**o+(-0.171582097545)*x[1]+(-0.185628570945)*x[2]**o+(0.40495393086)*x[2]
        arg[0,4,2,1]=(0.51879613184)*x[0]**o+(-0.517447781109)*x[0]+(-0.288826585096)*x[1]**o+(-0.736890998485)*x[1]+(-0.167119326999)*x[2]**o+(-0.653082372893)*x[2]
        arg[1,0,0,0]=(-0.879008868811)*x[0]**o+(-0.0613987509179)*x[0]+(-0.671288168832)*x[1]**o+(-0.959517297906)*x[1]+(0.292554039162)*x[2]**o+(0.942246368678)*x[2]
        arg[1,0,0,1]=(0.599956815218)*x[0]**o+(0.731601305574)*x[0]+(-0.61593947163)*x[1]**o+(-0.597924796707)*x[1]+(-0.791620695721)*x[2]**o+(-0.562978718552)*x[2]
        arg[1,0,1,0]=(0.448381207242)*x[0]**o+(-0.178004176549)*x[0]+(0.631841924913)*x[1]**o+(0.311836637044)*x[1]+(0.0619475841251)*x[2]**o+(0.606564490624)*x[2]
        arg[1,0,1,1]=(0.159907398582)*x[0]**o+(-0.278605461684)*x[0]+(0.822914081538)*x[1]**o+(0.75112795022)*x[1]+(0.91389895436)*x[2]**o+(0.929177149059)*x[2]
        arg[1,0,2,0]=(-0.472286972241)*x[0]**o+(0.00950883684535)*x[0]+(0.41110884679)*x[1]**o+(0.109422159345)*x[1]+(-0.707436024011)*x[2]**o+(0.795057014561)*x[2]
        arg[1,0,2,1]=(-0.0156784802605)*x[0]**o+(-0.657283760492)*x[0]+(-0.0422880440635)*x[1]**o+(-0.326436491982)*x[1]+(-0.543917764251)*x[2]**o+(-0.691698129266)*x[2]
        arg[1,1,0,0]=(-0.814424723604)*x[0]**o+(0.746801606056)*x[0]+(0.22025107532)*x[1]**o+(-0.785254149057)*x[1]+(-0.845637273475)*x[2]**o+(-0.468272754144)*x[2]
        arg[1,1,0,1]=(-0.0815177460988)*x[0]**o+(-0.47210691717)*x[0]+(-0.285964111717)*x[1]**o+(0.527387496664)*x[1]+(0.87059583429)*x[2]**o+(-0.543899395468)*x[2]
        arg[1,1,1,0]=(0.424163426295)*x[0]**o+(0.649692204305)*x[0]+(0.0570010318344)*x[1]**o+(-0.426047169951)*x[1]+(0.334750596342)*x[2]**o+(-0.746549570927)*x[2]
        arg[1,1,1,1]=(-0.120493849358)*x[0]**o+(0.567677110538)*x[0]+(-0.355891513526)*x[1]**o+(0.68069794787)*x[1]+(0.786560156246)*x[2]**o+(-0.422804642829)*x[2]
        arg[1,1,2,0]=(-0.80298202932)*x[0]**o+(-0.674766348751)*x[0]+(-0.29945072468)*x[1]**o+(0.385941328636)*x[1]+(-0.756272624651)*x[2]**o+(-0.607541099269)*x[2]
        arg[1,1,2,1]=(0.915020713521)*x[0]**o+(-0.875957199283)*x[0]+(0.0217597029367)*x[1]**o+(-0.0649461013997)*x[1]+(-0.302450259541)*x[2]**o+(0.738498325526)*x[2]
        arg[1,2,0,0]=(0.239905462913)*x[0]**o+(0.197348893262)*x[0]+(-0.151173414577)*x[1]**o+(0.368405558905)*x[1]+(0.891448032058)*x[2]**o+(0.874975769684)*x[2]
        arg[1,2,0,1]=(-0.304971614823)*x[0]**o+(-0.0166065674003)*x[0]+(0.883397157318)*x[1]**o+(-0.918803270424)*x[1]+(0.590875856583)*x[2]**o+(-0.360659400522)*x[2]
        arg[1,2,1,0]=(0.185368540041)*x[0]**o+(0.498866146124)*x[0]+(0.591601152982)*x[1]**o+(-0.986932631453)*x[1]+(-0.525706872664)*x[2]**o+(-0.0462993899877)*x[2]
        arg[1,2,1,1]=(0.260677894495)*x[0]**o+(-0.216847258131)*x[0]+(0.932876363707)*x[1]**o+(0.761630676808)*x[1]+(0.260889221066)*x[2]**o+(0.546259908582)*x[2]
        arg[1,2,2,0]=(-0.316803600202)*x[0]**o+(-0.898044300642)*x[0]+(-0.0865001657852)*x[1]**o+(0.760424275199)*x[1]+(0.771564532427)*x[2]**o+(-0.0852237819025)*x[2]
        arg[1,2,2,1]=(-0.54274371504)*x[0]**o+(0.0822524750896)*x[0]+(0.872655885939)*x[1]**o+(0.594054041006)*x[1]+(0.322150325252)*x[2]**o+(0.774020612668)*x[2]
        arg[1,3,0,0]=(0.034593806358)*x[0]**o+(0.541638857337)*x[0]+(0.291359214696)*x[1]**o+(-0.203872730757)*x[1]+(0.0312260615928)*x[2]**o+(0.62568815669)*x[2]
        arg[1,3,0,1]=(-0.31929050432)*x[0]**o+(-0.931756481553)*x[0]+(0.755537511071)*x[1]**o+(-0.182578278538)*x[1]+(0.00958902784528)*x[2]**o+(0.345520390047)*x[2]
        arg[1,3,1,0]=(-0.435083251076)*x[0]**o+(0.248332963857)*x[0]+(-0.122701495966)*x[1]**o+(0.669350594899)*x[1]+(-0.0758596665333)*x[2]**o+(0.0784997907526)*x[2]
        arg[1,3,1,1]=(-0.725479421981)*x[0]**o+(0.657242746138)*x[0]+(-0.199958263735)*x[1]**o+(-0.784165440236)*x[1]+(-0.550936676647)*x[2]**o+(-0.31907813038)*x[2]
        arg[1,3,2,0]=(0.657177346512)*x[0]**o+(-0.168053866293)*x[0]+(0.782142168258)*x[1]**o+(0.660514922866)*x[1]+(0.788106295165)*x[2]**o+(-0.254290645125)*x[2]
        arg[1,3,2,1]=(-0.215166688682)*x[0]**o+(0.743577328376)*x[0]+(-0.374827404054)*x[1]**o+(0.267885661143)*x[1]+(0.728818301014)*x[2]**o+(0.6828999278)*x[2]
        arg[1,4,0,0]=(0.371646403413)*x[0]**o+(0.00998777673275)*x[0]+(-0.313378345871)*x[1]**o+(-0.952580545501)*x[1]+(-0.680596974717)*x[2]**o+(-0.181426263871)*x[2]
        arg[1,4,0,1]=(-0.828437965469)*x[0]**o+(0.302443878606)*x[0]+(0.581310358652)*x[1]**o+(0.714092786618)*x[1]+(0.650179420347)*x[2]**o+(0.663482256421)*x[2]
        arg[1,4,1,0]=(0.220318191456)*x[0]**o+(0.443108440795)*x[0]+(-0.538413779146)*x[1]**o+(0.660052783252)*x[1]+(-0.846698606343)*x[2]**o+(-0.0447806256913)*x[2]
        arg[1,4,1,1]=(0.866921895372)*x[0]**o+(0.776291161128)*x[0]+(-0.385318933957)*x[1]**o+(0.841514060614)*x[1]+(-0.401465329431)*x[2]**o+(0.474475442638)*x[2]
        arg[1,4,2,0]=(-0.222535436657)*x[0]**o+(0.921341450452)*x[0]+(-0.765043798058)*x[1]**o+(-0.492946667792)*x[1]+(0.758817008648)*x[2]**o+(0.0950595321909)*x[2]
        arg[1,4,2,1]=(0.333884542089)*x[0]**o+(0.671265678974)*x[0]+(-0.719262407869)*x[1]**o+(0.498176251457)*x[1]+(-0.867726438404)*x[2]**o+(-0.872614195608)*x[2]
        arg[2,0,0,0]=(-0.303331399994)*x[0]**o+(-0.563887060818)*x[0]+(0.64537626236)*x[1]**o+(-0.657611314342)*x[1]+(0.800882746828)*x[2]**o+(0.700671892157)*x[2]
        arg[2,0,0,1]=(0.417691239931)*x[0]**o+(-0.822789801933)*x[0]+(0.712214951539)*x[1]**o+(0.160960575173)*x[1]+(0.0400205244239)*x[2]**o+(0.49892939112)*x[2]
        arg[2,0,1,0]=(-0.828677767124)*x[0]**o+(-0.347411290435)*x[0]+(-0.700177402223)*x[1]**o+(-0.42498634463)*x[1]+(0.984172081328)*x[2]**o+(-0.677168643292)*x[2]
        arg[2,0,1,1]=(-0.423091398412)*x[0]**o+(-0.786913239913)*x[0]+(-0.888102258019)*x[1]**o+(-0.119525894432)*x[1]+(-0.158513498081)*x[2]**o+(0.503403674219)*x[2]
        arg[2,0,2,0]=(0.547217868614)*x[0]**o+(-0.737401808325)*x[0]+(-0.865530737659)*x[1]**o+(-0.750671412749)*x[1]+(-0.06731420082)*x[2]**o+(0.658572191108)*x[2]
        arg[2,0,2,1]=(0.501785022047)*x[0]**o+(-0.0542441989122)*x[0]+(-0.379614025724)*x[1]**o+(-0.785618793316)*x[1]+(0.994476365391)*x[2]**o+(-0.436996817494)*x[2]
        arg[2,1,0,0]=(0.0329439903445)*x[0]**o+(0.688097592632)*x[0]+(0.554030860489)*x[1]**o+(0.60949736297)*x[1]+(0.499716171437)*x[2]**o+(0.501464282299)*x[2]
        arg[2,1,0,1]=(0.459629414019)*x[0]**o+(0.810658146454)*x[0]+(-0.902023596001)*x[1]**o+(-0.982998009297)*x[1]+(0.487736529196)*x[2]**o+(-0.509164692477)*x[2]
        arg[2,1,1,0]=(0.0818151896334)*x[0]**o+(-0.931023788966)*x[0]+(-0.217349745187)*x[1]**o+(-0.785586110912)*x[1]+(0.16783052001)*x[2]**o+(-0.515867681053)*x[2]
        arg[2,1,1,1]=(-0.758874975703)*x[0]**o+(0.219408816573)*x[0]+(0.508187203896)*x[1]**o+(0.306700464008)*x[1]+(-0.641891226105)*x[2]**o+(-0.137752888266)*x[2]
        arg[2,1,2,0]=(-0.952430879482)*x[0]**o+(0.179895758684)*x[0]+(0.502285174801)*x[1]**o+(-0.82300826605)*x[1]+(-0.267848001419)*x[2]**o+(-0.882529775244)*x[2]
        arg[2,1,2,1]=(0.371372868601)*x[0]**o+(-0.521801538326)*x[0]+(0.894906517432)*x[1]**o+(0.205799057307)*x[1]+(-0.315840560279)*x[2]**o+(0.65823096555)*x[2]
        arg[2,2,0,0]=(0.585088762354)*x[0]**o+(0.527662713737)*x[0]+(0.83511043292)*x[1]**o+(-0.263597549489)*x[1]+(-0.342210974079)*x[2]**o+(0.532149528802)*x[2]
        arg[2,2,0,1]=(0.985868978475)*x[0]**o+(0.162798954854)*x[0]+(-0.887525429296)*x[1]**o+(0.618905848201)*x[1]+(-0.213643353241)*x[2]**o+(0.0170513098359)*x[2]
        arg[2,2,1,0]=(-0.216402064475)*x[0]**o+(0.350853951704)*x[0]+(0.592219675443)*x[1]**o+(-0.915293916561)*x[1]+(0.160588856435)*x[2]**o+(-0.574686420146)*x[2]
        arg[2,2,1,1]=(0.233118497878)*x[0]**o+(0.482035958353)*x[0]+(-0.581971661478)*x[1]**o+(0.832450520208)*x[1]+(-0.430914444794)*x[2]**o+(-0.791658025494)*x[2]
        arg[2,2,2,0]=(-0.710516844)*x[0]**o+(0.0266391730256)*x[0]+(-0.154541997151)*x[1]**o+(-0.232843778379)*x[1]+(0.453522207498)*x[2]**o+(-0.688939516711)*x[2]
        arg[2,2,2,1]=(0.26860058468)*x[0]**o+(-0.969638661751)*x[0]+(0.623784614857)*x[1]**o+(0.686359051774)*x[1]+(0.677056704385)*x[2]**o+(0.156688176847)*x[2]
        arg[2,3,0,0]=(-0.0620909841534)*x[0]**o+(-0.364946660535)*x[0]+(-0.388275430806)*x[1]**o+(-0.947908160286)*x[1]+(0.0774302410344)*x[2]**o+(0.374469033649)*x[2]
        arg[2,3,0,1]=(0.164845147121)*x[0]**o+(0.480213031852)*x[0]+(0.58157030274)*x[1]**o+(0.882820521347)*x[1]+(0.584714825748)*x[2]**o+(0.0285154925376)*x[2]
        arg[2,3,1,0]=(0.664711234489)*x[0]**o+(0.247415435607)*x[0]+(0.741592287061)*x[1]**o+(0.963505986041)*x[1]+(-0.987844687003)*x[2]**o+(0.998294459659)*x[2]
        arg[2,3,1,1]=(-0.734529316764)*x[0]**o+(-0.177480004713)*x[0]+(0.923555424779)*x[1]**o+(0.727331498256)*x[1]+(0.452312367674)*x[2]**o+(0.00652243396085)*x[2]
        arg[2,3,2,0]=(-0.367377897953)*x[0]**o+(-0.157529442804)*x[0]+(-0.121881528621)*x[1]**o+(0.865116726884)*x[1]+(-0.200087079925)*x[2]**o+(0.930889629788)*x[2]
        arg[2,3,2,1]=(-0.900394562978)*x[0]**o+(-0.762334071565)*x[0]+(-0.723776245294)*x[1]**o+(0.332728994729)*x[1]+(0.390453779523)*x[2]**o+(0.0447350797932)*x[2]
        arg[2,4,0,0]=(0.178230443819)*x[0]**o+(0.0898732089623)*x[0]+(0.808448952186)*x[1]**o+(0.164579824494)*x[1]+(-0.553032263217)*x[2]**o+(-0.782141879825)*x[2]
        arg[2,4,0,1]=(-0.105582488753)*x[0]**o+(0.995415696949)*x[0]+(0.978971670365)*x[1]**o+(-0.977866735017)*x[1]+(0.156938966924)*x[2]**o+(-0.120871488936)*x[2]
        arg[2,4,1,0]=(0.652354601889)*x[0]**o+(0.381186764672)*x[0]+(-0.783479778972)*x[1]**o+(-0.158898829615)*x[1]+(0.794693790129)*x[2]**o+(0.914720093741)*x[2]
        arg[2,4,1,1]=(0.571506419376)*x[0]**o+(0.906086581152)*x[0]+(-0.798519792125)*x[1]**o+(-0.22840897962)*x[1]+(-0.750891721145)*x[2]**o+(-0.591014038221)*x[2]
        arg[2,4,2,0]=(0.515982716306)*x[0]**o+(0.299569326845)*x[0]+(-0.407423180268)*x[1]**o+(-0.252103363573)*x[1]+(-0.0228238994531)*x[2]**o+(-0.282150542844)*x[2]
        arg[2,4,2,1]=(0.5335415942)*x[0]**o+(-0.885728570489)*x[0]+(-0.750810131327)*x[1]**o+(0.604053940679)*x[1]+(-0.0946405866686)*x[2]**o+(-0.423845465234)*x[2]
        arg[3,0,0,0]=(-0.498025341136)*x[0]**o+(-0.296354416633)*x[0]+(-0.600874889655)*x[1]**o+(0.544042300882)*x[1]+(0.318784851038)*x[2]**o+(-0.801109111437)*x[2]
        arg[3,0,0,1]=(-0.492361949745)*x[0]**o+(-0.708188092599)*x[0]+(-0.863737808435)*x[1]**o+(0.674889485553)*x[1]+(-0.982254652233)*x[2]**o+(0.682172862189)*x[2]
        arg[3,0,1,0]=(-0.872692397532)*x[0]**o+(0.563852836655)*x[0]+(-0.0219331486599)*x[1]**o+(-0.858175679559)*x[1]+(0.802432631538)*x[2]**o+(-0.655545287387)*x[2]
        arg[3,0,1,1]=(-0.538117166854)*x[0]**o+(-0.62507518352)*x[0]+(0.101524298816)*x[1]**o+(0.590432448393)*x[1]+(0.668057302006)*x[2]**o+(0.405382330056)*x[2]
        arg[3,0,2,0]=(-0.322916455064)*x[0]**o+(0.950624857669)*x[0]+(0.485623846818)*x[1]**o+(-0.12611522301)*x[1]+(0.503586393973)*x[2]**o+(0.109451719709)*x[2]
        arg[3,0,2,1]=(0.0289965995645)*x[0]**o+(0.0101440661359)*x[0]+(-0.303827119958)*x[1]**o+(0.355269935141)*x[1]+(0.29889427526)*x[2]**o+(-0.707999988781)*x[2]
        arg[3,1,0,0]=(-0.541382521848)*x[0]**o+(0.534108535206)*x[0]+(0.875610773119)*x[1]**o+(-0.575849439451)*x[1]+(-0.0836939606164)*x[2]**o+(0.433678856889)*x[2]
        arg[3,1,0,1]=(0.0322576144027)*x[0]**o+(0.794219359514)*x[0]+(0.629442621265)*x[1]**o+(0.0517726053499)*x[1]+(-0.776050101686)*x[2]**o+(0.697910196708)*x[2]
        arg[3,1,1,0]=(-0.198211682395)*x[0]**o+(-0.926268101941)*x[0]+(-0.904760383993)*x[1]**o+(-0.820075667018)*x[1]+(-0.101262044428)*x[2]**o+(-0.0621221772941)*x[2]
        arg[3,1,1,1]=(-0.531324749521)*x[0]**o+(0.736017207718)*x[0]+(0.487299696259)*x[1]**o+(-0.00604423021253)*x[1]+(-0.635722590088)*x[2]**o+(-0.143501730927)*x[2]
        arg[3,1,2,0]=(-0.731421637848)*x[0]**o+(-0.0371648783851)*x[0]+(-0.290362466891)*x[1]**o+(-0.375048584106)*x[1]+(-0.854622532092)*x[2]**o+(-0.794295905388)*x[2]
        arg[3,1,2,1]=(-0.766383422105)*x[0]**o+(0.149248159984)*x[0]+(0.970103674649)*x[1]**o+(-0.117794368107)*x[1]+(0.0178775633047)*x[2]**o+(-0.221126829278)*x[2]
        arg[3,2,0,0]=(0.706586887601)*x[0]**o+(0.162520023447)*x[0]+(-0.731539880336)*x[1]**o+(-0.992558519713)*x[1]+(0.426569303014)*x[2]**o+(0.0451783819487)*x[2]
        arg[3,2,0,1]=(0.0392295508272)*x[0]**o+(-0.157929005382)*x[0]+(0.0636418899878)*x[1]**o+(0.892501759578)*x[1]+(-0.368161001401)*x[2]**o+(-0.715520794543)*x[2]
        arg[3,2,1,0]=(0.889667707133)*x[0]**o+(0.308604168817)*x[0]+(-0.275558663983)*x[1]**o+(-0.408210095215)*x[1]+(-0.0918000869138)*x[2]**o+(0.142754064645)*x[2]
        arg[3,2,1,1]=(0.585831954407)*x[0]**o+(-0.705004375516)*x[0]+(0.657277099061)*x[1]**o+(-0.972401794257)*x[1]+(-0.658049310396)*x[2]**o+(-0.553961555706)*x[2]
        arg[3,2,2,0]=(0.88916769079)*x[0]**o+(-0.1401162684)*x[0]+(-0.396496633317)*x[1]**o+(0.215029522669)*x[1]+(-0.619023294208)*x[2]**o+(-0.187670706968)*x[2]
        arg[3,2,2,1]=(-0.262983340384)*x[0]**o+(-0.763236528477)*x[0]+(-0.339720289405)*x[1]**o+(-0.283077066751)*x[1]+(0.625600522278)*x[2]**o+(-0.132697432298)*x[2]
        arg[3,3,0,0]=(-0.346408105223)*x[0]**o+(0.299760534041)*x[0]+(0.567951405594)*x[1]**o+(-0.880683463459)*x[1]+(0.784127947661)*x[2]**o+(0.268895744072)*x[2]
        arg[3,3,0,1]=(0.064159345936)*x[0]**o+(-0.685098798117)*x[0]+(-0.182310885124)*x[1]**o+(-0.700081075257)*x[1]+(0.543959312437)*x[2]**o+(0.125104170434)*x[2]
        arg[3,3,1,0]=(0.460375837083)*x[0]**o+(0.82355800923)*x[0]+(-0.186000244328)*x[1]**o+(0.8418355439)*x[1]+(-0.375269292115)*x[2]**o+(0.712431840155)*x[2]
        arg[3,3,1,1]=(0.57260867805)*x[0]**o+(-0.146405851776)*x[0]+(-0.50640779246)*x[1]**o+(0.741760309299)*x[1]+(0.069752390409)*x[2]**o+(-0.376724191471)*x[2]
        arg[3,3,2,0]=(0.795493408403)*x[0]**o+(0.396861648344)*x[0]+(-0.728716068325)*x[1]**o+(0.739330072416)*x[1]+(0.202019645585)*x[2]**o+(0.841240509566)*x[2]
        arg[3,3,2,1]=(-0.967372744621)*x[0]**o+(-0.334044549662)*x[0]+(-0.0686982670779)*x[1]**o+(0.180083293629)*x[1]+(-0.208697793793)*x[2]**o+(0.0305446253751)*x[2]
        arg[3,4,0,0]=(0.94168350996)*x[0]**o+(0.0545532586137)*x[0]+(-0.300430532207)*x[1]**o+(-0.960362884765)*x[1]+(0.738261342527)*x[2]**o+(-0.351477574571)*x[2]
        arg[3,4,0,1]=(-0.525893857873)*x[0]**o+(0.227252001588)*x[0]+(0.179831911446)*x[1]**o+(0.350952712138)*x[1]+(-0.671550635312)*x[2]**o+(-0.338834217909)*x[2]
        arg[3,4,1,0]=(-0.60610056656)*x[0]**o+(0.219192673102)*x[0]+(-0.801595717702)*x[1]**o+(-0.696853420225)*x[1]+(-0.495201990047)*x[2]**o+(-0.500683649414)*x[2]
        arg[3,4,1,1]=(-0.37343020332)*x[0]**o+(-0.585536591527)*x[0]+(0.81794997494)*x[1]**o+(-0.240232527585)*x[1]+(-0.538970681636)*x[2]**o+(-0.146105210473)*x[2]
        arg[3,4,2,0]=(0.857322149358)*x[0]**o+(-0.552847286493)*x[0]+(0.530970378294)*x[1]**o+(0.0746811386922)*x[1]+(0.946170976628)*x[2]**o+(-0.329916962713)*x[2]
        arg[3,4,2,1]=(-0.353323100685)*x[0]**o+(0.808796594618)*x[0]+(0.481450588496)*x[1]**o+(0.1202874944)*x[1]+(0.671293736572)*x[2]**o+(-0.905074286629)*x[2]
        ref[0,0,0,0]=(-0.613904299283)*(1+2.*(dim-1.)/(o+1.))+(1.30218009705)*dim
        ref[0,0,0,1]=(-0.810525773084)*(1+2.*(dim-1.)/(o+1.))+(0.253224626501)*dim
        ref[0,0,1,0]=(0.509154413012)*(1+2.*(dim-1.)/(o+1.))+(-0.179784708198)*dim
        ref[0,0,1,1]=(0.637556597632)*(1+2.*(dim-1.)/(o+1.))+(-0.693313683923)*dim
        ref[0,0,2,0]=(-0.465137153331)*(1+2.*(dim-1.)/(o+1.))+(-0.0477989622018)*dim
        ref[0,0,2,1]=(-2.15185435439)*(1+2.*(dim-1.)/(o+1.))+(0.231459735932)*dim
        ref[0,1,0,0]=(0.8018922964)*(1+2.*(dim-1.)/(o+1.))+(-1.10884149089)*dim
        ref[0,1,0,1]=(1.7955198411)*(1+2.*(dim-1.)/(o+1.))+(-1.34662500856)*dim
        ref[0,1,1,0]=(0.584854782162)*(1+2.*(dim-1.)/(o+1.))+(0.274087751285)*dim
        ref[0,1,1,1]=(-1.0401305206)*(1+2.*(dim-1.)/(o+1.))+(1.85561593667)*dim
        ref[0,1,2,0]=(-0.834154383324)*(1+2.*(dim-1.)/(o+1.))+(-1.23273379028)*dim
        ref[0,1,2,1]=(-2.34017474507)*(1+2.*(dim-1.)/(o+1.))+(-0.224176787111)*dim
        ref[0,2,0,0]=(0.613915916089)*(1+2.*(dim-1.)/(o+1.))+(0.753829204471)*dim
        ref[0,2,0,1]=(0.131344565765)*(1+2.*(dim-1.)/(o+1.))+(-0.976652361934)*dim
        ref[0,2,1,0]=(0.579116187931)*(1+2.*(dim-1.)/(o+1.))+(0.0228071895801)*dim
        ref[0,2,1,1]=(0.772304265705)*(1+2.*(dim-1.)/(o+1.))+(0.470483133313)*dim
        ref[0,2,2,0]=(-1.12957943492)*(1+2.*(dim-1.)/(o+1.))+(-0.82429788127)*dim
        ref[0,2,2,1]=(-0.631840107715)*(1+2.*(dim-1.)/(o+1.))+(-0.732399256131)*dim
        ref[0,3,0,0]=(0.137323356087)*(1+2.*(dim-1.)/(o+1.))+(-0.413776023245)*dim
        ref[0,3,0,1]=(-0.173740822652)*(1+2.*(dim-1.)/(o+1.))+(1.19050855195)*dim
        ref[0,3,1,0]=(-1.58068224297)*(1+2.*(dim-1.)/(o+1.))+(0.24224399322)*dim
        ref[0,3,1,1]=(0.474472608494)*(1+2.*(dim-1.)/(o+1.))+(-0.557328900938)*dim
        ref[0,3,2,0]=(0.459842497633)*(1+2.*(dim-1.)/(o+1.))+(-1.09001004859)*dim
        ref[0,3,2,1]=(-0.22027884782)*(1+2.*(dim-1.)/(o+1.))+(0.235715331835)*dim
        ref[0,4,0,0]=(0.424803567504)*(1+2.*(dim-1.)/(o+1.))+(0.657196485077)*dim
        ref[0,4,0,1]=(-0.00655513622033)*(1+2.*(dim-1.)/(o+1.))+(-0.803228043207)*dim
        ref[0,4,1,0]=(1.33738998187)*(1+2.*(dim-1.)/(o+1.))+(-0.0257326162636)*dim
        ref[0,4,1,1]=(-1.55536089118)*(1+2.*(dim-1.)/(o+1.))+(-0.0357690415245)*dim
        ref[0,4,2,0]=(1.58679207216)*(1+2.*(dim-1.)/(o+1.))+(-0.693598479122)*dim
        ref[0,4,2,1]=(0.0628502197447)*(1+2.*(dim-1.)/(o+1.))+(-1.90742115249)*dim
        ref[1,0,0,0]=(-1.25774299848)*(1+2.*(dim-1.)/(o+1.))+(-0.0786696801461)*dim
        ref[1,0,0,1]=(-0.807603352133)*(1+2.*(dim-1.)/(o+1.))+(-0.429302209684)*dim
        ref[1,0,1,0]=(1.14217071628)*(1+2.*(dim-1.)/(o+1.))+(0.740396951119)*dim
        ref[1,0,1,1]=(1.89672043448)*(1+2.*(dim-1.)/(o+1.))+(1.4016996376)*dim
        ref[1,0,2,0]=(-0.768614149462)*(1+2.*(dim-1.)/(o+1.))+(0.913988010751)*dim
        ref[1,0,2,1]=(-0.601884288575)*(1+2.*(dim-1.)/(o+1.))+(-1.67541838174)*dim
        ref[1,1,0,0]=(-1.43981092176)*(1+2.*(dim-1.)/(o+1.))+(-0.506725297145)*dim
        ref[1,1,0,1]=(0.503113976474)*(1+2.*(dim-1.)/(o+1.))+(-0.488618815974)*dim
        ref[1,1,1,0]=(0.815915054472)*(1+2.*(dim-1.)/(o+1.))+(-0.522904536573)*dim
        ref[1,1,1,1]=(0.310174793362)*(1+2.*(dim-1.)/(o+1.))+(0.825570415579)*dim
        ref[1,1,2,0]=(-1.85870537865)*(1+2.*(dim-1.)/(o+1.))+(-0.896366119383)*dim
        ref[1,1,2,1]=(0.634330156916)*(1+2.*(dim-1.)/(o+1.))+(-0.202404975156)*dim
        ref[1,2,0,0]=(0.980180080393)*(1+2.*(dim-1.)/(o+1.))+(1.44073022185)*dim
        ref[1,2,0,1]=(1.16930139908)*(1+2.*(dim-1.)/(o+1.))+(-1.29606923835)*dim
        ref[1,2,1,0]=(0.251262820359)*(1+2.*(dim-1.)/(o+1.))+(-0.534365875316)*dim
        ref[1,2,1,1]=(1.45444347927)*(1+2.*(dim-1.)/(o+1.))+(1.09104332726)*dim
        ref[1,2,2,0]=(0.36826076644)*(1+2.*(dim-1.)/(o+1.))+(-0.222843807345)*dim
        ref[1,2,2,1]=(0.652062496151)*(1+2.*(dim-1.)/(o+1.))+(1.45032712876)*dim
        ref[1,3,0,0]=(0.357179082647)*(1+2.*(dim-1.)/(o+1.))+(0.96345428327)*dim
        ref[1,3,0,1]=(0.445836034597)*(1+2.*(dim-1.)/(o+1.))+(-0.768814370045)*dim
        ref[1,3,1,0]=(-0.633644413575)*(1+2.*(dim-1.)/(o+1.))+(0.996183349509)*dim
        ref[1,3,1,1]=(-1.47637436236)*(1+2.*(dim-1.)/(o+1.))+(-0.446000824477)*dim
        ref[1,3,2,0]=(2.22742580994)*(1+2.*(dim-1.)/(o+1.))+(0.238170411449)*dim
        ref[1,3,2,1]=(0.138824208277)*(1+2.*(dim-1.)/(o+1.))+(1.69436291732)*dim
        ref[1,4,0,0]=(-0.622328917175)*(1+2.*(dim-1.)/(o+1.))+(-1.12401903264)*dim
        ref[1,4,0,1]=(0.40305181353)*(1+2.*(dim-1.)/(o+1.))+(1.68001892165)*dim
        ref[1,4,1,0]=(-1.16479419403)*(1+2.*(dim-1.)/(o+1.))+(1.05838059836)*dim
        ref[1,4,1,1]=(0.0801376319834)*(1+2.*(dim-1.)/(o+1.))+(2.09228066438)*dim
        ref[1,4,2,0]=(-0.228762226067)*(1+2.*(dim-1.)/(o+1.))+(0.523454314851)*dim
        ref[1,4,2,1]=(-1.25310430418)*(1+2.*(dim-1.)/(o+1.))+(0.296827734822)*dim
        ref[2,0,0,0]=(1.14292760919)*(1+2.*(dim-1.)/(o+1.))+(-0.520826483003)*dim
        ref[2,0,0,1]=(1.16992671589)*(1+2.*(dim-1.)/(o+1.))+(-0.162899835641)*dim
        ref[2,0,1,0]=(-0.544683088018)*(1+2.*(dim-1.)/(o+1.))+(-1.44956627836)*dim
        ref[2,0,1,1]=(-1.46970715451)*(1+2.*(dim-1.)/(o+1.))+(-0.403035460127)*dim
        ref[2,0,2,0]=(-0.385627069865)*(1+2.*(dim-1.)/(o+1.))+(-0.829501029966)*dim
        ref[2,0,2,1]=(1.11664736171)*(1+2.*(dim-1.)/(o+1.))+(-1.27685980972)*dim
        ref[2,1,0,0]=(1.08669102227)*(1+2.*(dim-1.)/(o+1.))+(1.7990592379)*dim
        ref[2,1,0,1]=(0.0453423472143)*(1+2.*(dim-1.)/(o+1.))+(-0.68150455532)*dim
        ref[2,1,1,0]=(0.0322959644566)*(1+2.*(dim-1.)/(o+1.))+(-2.23247758093)*dim
        ref[2,1,1,1]=(-0.892578997912)*(1+2.*(dim-1.)/(o+1.))+(0.388356392315)*dim
        ref[2,1,2,0]=(-0.7179937061)*(1+2.*(dim-1.)/(o+1.))+(-1.52564228261)*dim
        ref[2,1,2,1]=(0.950438825754)*(1+2.*(dim-1.)/(o+1.))+(0.342228484532)*dim
        ref[2,2,0,0]=(1.0779882212)*(1+2.*(dim-1.)/(o+1.))+(0.796214693049)*dim
        ref[2,2,0,1]=(-0.115299804062)*(1+2.*(dim-1.)/(o+1.))+(0.798756112891)*dim
        ref[2,2,1,0]=(0.536406467403)*(1+2.*(dim-1.)/(o+1.))+(-1.139126385)*dim
        ref[2,2,1,1]=(-0.779767608394)*(1+2.*(dim-1.)/(o+1.))+(0.522828453067)*dim
        ref[2,2,2,0]=(-0.411536633652)*(1+2.*(dim-1.)/(o+1.))+(-0.895144122064)*dim
        ref[2,2,2,1]=(1.56944190392)*(1+2.*(dim-1.)/(o+1.))+(-0.12659143313)*dim
        ref[2,3,0,0]=(-0.372936173925)*(1+2.*(dim-1.)/(o+1.))+(-0.938385787171)*dim
        ref[2,3,0,1]=(1.33113027561)*(1+2.*(dim-1.)/(o+1.))+(1.39154904574)*dim
        ref[2,3,1,0]=(0.418458834548)*(1+2.*(dim-1.)/(o+1.))+(2.20921588131)*dim
        ref[2,3,1,1]=(0.64133847569)*(1+2.*(dim-1.)/(o+1.))+(0.556373927504)*dim
        ref[2,3,2,0]=(-0.689346506499)*(1+2.*(dim-1.)/(o+1.))+(1.63847691387)*dim
        ref[2,3,2,1]=(-1.23371702875)*(1+2.*(dim-1.)/(o+1.))+(-0.384869997042)*dim
        ref[2,4,0,0]=(0.433647132788)*(1+2.*(dim-1.)/(o+1.))+(-0.527688846368)*dim
        ref[2,4,0,1]=(1.03032814854)*(1+2.*(dim-1.)/(o+1.))+(-0.103322527004)*dim
        ref[2,4,1,0]=(0.663568613046)*(1+2.*(dim-1.)/(o+1.))+(1.1370080288)*dim
        ref[2,4,1,1]=(-0.977905093893)*(1+2.*(dim-1.)/(o+1.))+(0.0866635633103)*dim
        ref[2,4,2,0]=(0.085735636585)*(1+2.*(dim-1.)/(o+1.))+(-0.234684579572)*dim
        ref[2,4,2,1]=(-0.311909123795)*(1+2.*(dim-1.)/(o+1.))+(-0.705520095044)*dim
        ref[3,0,0,0]=(-0.780115379753)*(1+2.*(dim-1.)/(o+1.))+(-0.553421227188)*dim
        ref[3,0,0,1]=(-2.33835441041)*(1+2.*(dim-1.)/(o+1.))+(0.648874255143)*dim
        ref[3,0,1,0]=(-0.0921929146543)*(1+2.*(dim-1.)/(o+1.))+(-0.949868130291)*dim
        ref[3,0,1,1]=(0.231464433969)*(1+2.*(dim-1.)/(o+1.))+(0.370739594929)*dim
        ref[3,0,2,0]=(0.666293785727)*(1+2.*(dim-1.)/(o+1.))+(0.933961354368)*dim
        ref[3,0,2,1]=(0.0240637548661)*(1+2.*(dim-1.)/(o+1.))+(-0.342585987504)*dim
        ref[3,1,0,0]=(0.250534290654)*(1+2.*(dim-1.)/(o+1.))+(0.391937952644)*dim
        ref[3,1,0,1]=(-0.114349866018)*(1+2.*(dim-1.)/(o+1.))+(1.54390216157)*dim
        ref[3,1,1,0]=(-1.20423411082)*(1+2.*(dim-1.)/(o+1.))+(-1.80846594625)*dim
        ref[3,1,1,1]=(-0.679747643349)*(1+2.*(dim-1.)/(o+1.))+(0.586471246578)*dim
        ref[3,1,2,0]=(-1.87640663683)*(1+2.*(dim-1.)/(o+1.))+(-1.20650936788)*dim
        ref[3,1,2,1]=(0.221597815849)*(1+2.*(dim-1.)/(o+1.))+(-0.189673037401)*dim
        ref[3,2,0,0]=(0.40161631028)*(1+2.*(dim-1.)/(o+1.))+(-0.784860114318)*dim
        ref[3,2,0,1]=(-0.265289560586)*(1+2.*(dim-1.)/(o+1.))+(0.0190519596518)*dim
        ref[3,2,1,0]=(0.522308956237)*(1+2.*(dim-1.)/(o+1.))+(0.0431481382473)*dim
        ref[3,2,1,1]=(0.585059743072)*(1+2.*(dim-1.)/(o+1.))+(-2.23136772548)*dim
        ref[3,2,2,0]=(-0.126352236735)*(1+2.*(dim-1.)/(o+1.))+(-0.112757452698)*dim
        ref[3,2,2,1]=(0.0228968924883)*(1+2.*(dim-1.)/(o+1.))+(-1.17901102753)*dim
        ref[3,3,0,0]=(1.00567124803)*(1+2.*(dim-1.)/(o+1.))+(-0.312027185345)*dim
        ref[3,3,0,1]=(0.425807773249)*(1+2.*(dim-1.)/(o+1.))+(-1.26007570294)*dim
        ref[3,3,1,0]=(-0.10089369936)*(1+2.*(dim-1.)/(o+1.))+(2.37782539328)*dim
        ref[3,3,1,1]=(0.135953275999)*(1+2.*(dim-1.)/(o+1.))+(0.218630266051)*dim
        ref[3,3,2,0]=(0.268796985663)*(1+2.*(dim-1.)/(o+1.))+(1.97743223033)*dim
        ref[3,3,2,1]=(-1.24476880549)*(1+2.*(dim-1.)/(o+1.))+(-0.123416630658)*dim
        ref[3,4,0,0]=(1.37951432028)*(1+2.*(dim-1.)/(o+1.))+(-1.25728720072)*dim
        ref[3,4,0,1]=(-1.01761258174)*(1+2.*(dim-1.)/(o+1.))+(0.239370495817)*dim
        ref[3,4,1,0]=(-1.90289827431)*(1+2.*(dim-1.)/(o+1.))+(-0.978344396537)*dim
        ref[3,4,1,1]=(-0.0944509100161)*(1+2.*(dim-1.)/(o+1.))+(-0.971874329585)*dim
        ref[3,4,2,0]=(2.33446350428)*(1+2.*(dim-1.)/(o+1.))+(-0.808083110513)*dim
        ref[3,4,2,1]=(0.799421224383)*(1+2.*(dim-1.)/(o+1.))+(0.0240098023897)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.0177156089276)*x[0]+(-1.07750293477)*x[1]
        ref=(0.674554765151)*(1+2.*(dim-1.)/(o+1.))+(-1.76977330884)*dim
      else:
        arg=(0.304688056778)*x[0]+(0.548485298428)*x[1]+(0.672370309114)*x[2]
        ref=(0.0121419382123)*(1+2.*(dim-1.)/(o+1.))+(1.51340172611)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(-1.81332918209)*x[0]+(0.825631690982)*x[1]
        arg[1]=(0.568335098118)*x[0]+(-0.504485431124)*x[1]
        ref[0]=(0.0338855214148)*(1+2.*(dim-1.)/(o+1.))+(-1.02158301252)*dim
        ref[1]=(0.348045520014)*(1+2.*(dim-1.)/(o+1.))+(-0.284195853019)*dim
      else:
        arg[0]=(-0.34247651789)*x[0]+(0.952434108232)*x[1]+(0.956872478767)*x[2]
        arg[1]=(-0.73212870207)*x[0]+(1.25659546958)*x[1]+(-0.690842998605)*x[2]
        ref[0]=(1.22184577749)*(1+2.*(dim-1.)/(o+1.))+(0.344984291617)*dim
        ref[1]=(-0.600249739257)*(1+2.*(dim-1.)/(o+1.))+(0.433873508162)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-1.78262197231)*x[0]+(1.45174573417)*x[1]
        arg[0,1]=(0.213586223199)*x[0]+(-0.917876059198)*x[1]
        arg[0,2]=(-1.12034819339)*x[0]+(0.59993130233)*x[1]
        arg[0,3]=(-0.156732957083)*x[0]+(0.744660873695)*x[1]
        arg[0,4]=(0.217327014577)*x[0]+(1.40157420042)*x[1]
        arg[1,0]=(0.0588042984116)*x[0]+(1.40376148561)*x[1]
        arg[1,1]=(-0.264973303233)*x[0]+(1.77692483003)*x[1]
        arg[1,2]=(-1.17910097102)*x[0]+(-1.20301960774)*x[1]
        arg[1,3]=(-0.511409983468)*x[0]+(-1.02065230228)*x[1]
        arg[1,4]=(1.1254497221)*x[0]+(-1.23163629376)*x[1]
        arg[2,0]=(-0.780207200735)*x[0]+(-1.49983791458)*x[1]
        arg[2,1]=(0.20679132359)*x[0]+(0.640203014983)*x[1]
        arg[2,2]=(0.198135205267)*x[0]+(0.30781411018)*x[1]
        arg[2,3]=(0.465906968942)*x[0]+(-0.812198212)*x[1]
        arg[2,4]=(0.190357350559)*x[0]+(-1.5894498455)*x[1]
        arg[3,0]=(-1.1362863086)*x[0]+(-0.0654142353086)*x[1]
        arg[3,1]=(0.0545924852084)*x[0]+(0.00262152155818)*x[1]
        arg[3,2]=(-0.0497600832907)*x[0]+(-0.609396009303)*x[1]
        arg[3,3]=(0.347834191962)*x[0]+(-0.768159599963)*x[1]
        arg[3,4]=(-0.178383166761)*x[0]+(-0.0690942212822)*x[1]
        ref[0,0]=(0.0436748214249)*(1+2.*(dim-1.)/(o+1.))+(-0.374551059559)*dim
        ref[0,1]=(-1.05854206043)*(1+2.*(dim-1.)/(o+1.))+(0.354252224435)*dim
        ref[0,2]=(-0.71782952995)*(1+2.*(dim-1.)/(o+1.))+(0.197412638885)*dim
        ref[0,3]=(-0.255252590976)*(1+2.*(dim-1.)/(o+1.))+(0.843180507587)*dim
        ref[0,4]=(0.177908820578)*(1+2.*(dim-1.)/(o+1.))+(1.44099239442)*dim
        ref[1,0]=(1.56040501086)*(1+2.*(dim-1.)/(o+1.))+(-0.0978392268304)*dim
        ref[1,1]=(1.33164571828)*(1+2.*(dim-1.)/(o+1.))+(0.180305808513)*dim
        ref[1,2]=(-0.885397553926)*(1+2.*(dim-1.)/(o+1.))+(-1.49672302484)*dim
        ref[1,3]=(0.105451964854)*(1+2.*(dim-1.)/(o+1.))+(-1.63751425061)*dim
        ref[1,4]=(-0.774237262923)*(1+2.*(dim-1.)/(o+1.))+(0.668050691269)*dim
        ref[2,0]=(-0.626493344552)*(1+2.*(dim-1.)/(o+1.))+(-1.65355177076)*dim
        ref[2,1]=(0.383826450148)*(1+2.*(dim-1.)/(o+1.))+(0.463167888425)*dim
        ref[2,2]=(-0.530241676713)*(1+2.*(dim-1.)/(o+1.))+(1.03619099216)*dim
        ref[2,3]=(-1.18245389658)*(1+2.*(dim-1.)/(o+1.))+(0.836162653525)*dim
        ref[2,4]=(-1.32396763993)*(1+2.*(dim-1.)/(o+1.))+(-0.0751248550082)*dim
        ref[3,0]=(0.15610314985)*(1+2.*(dim-1.)/(o+1.))+(-1.35780369376)*dim
        ref[3,1]=(-0.376931239611)*(1+2.*(dim-1.)/(o+1.))+(0.434145246378)*dim
        ref[3,2]=(0.0188741177717)*(1+2.*(dim-1.)/(o+1.))+(-0.678030210365)*dim
        ref[3,3]=(-0.264501990209)*(1+2.*(dim-1.)/(o+1.))+(-0.155823417792)*dim
        ref[3,4]=(-0.394609208758)*(1+2.*(dim-1.)/(o+1.))+(0.147131820715)*dim
      else:
        arg[0,0]=(-1.55600852596)*x[0]+(-0.624393737912)*x[1]+(-0.747032596279)*x[2]
        arg[0,1]=(0.158636782846)*x[0]+(-0.751760245066)*x[1]+(-1.62081735864)*x[2]
        arg[0,2]=(1.18083264152)*x[0]+(-1.16696814878)*x[1]+(-0.567354369023)*x[2]
        arg[0,3]=(0.176344525636)*x[0]+(-0.825319538089)*x[1]+(0.32760822446)*x[2]
        arg[0,4]=(0.570849136808)*x[0]+(-0.86277959325)*x[1]+(-0.253106033513)*x[2]
        arg[1,0]=(0.325475826081)*x[0]+(0.338988467638)*x[1]+(-0.596090654044)*x[2]
        arg[1,1]=(-1.29950586693)*x[0]+(-0.980591079821)*x[1]+(-0.7995507704)*x[2]
        arg[1,2]=(0.108948096835)*x[0]+(0.323001832704)*x[1]+(1.09678982473)*x[2]
        arg[1,3]=(-0.0307191696266)*x[0]+(0.134014984197)*x[1]+(-0.271363693134)*x[2]
        arg[1,4]=(0.0166805959434)*x[0]+(-0.323260440667)*x[1]+(-0.0168023639197)*x[2]
        arg[2,0]=(1.66243206086)*x[0]+(-0.478403313987)*x[1]+(1.45469230407)*x[2]
        arg[2,1]=(0.635927142861)*x[0]+(0.00628277747568)*x[1]+(-0.335502970321)*x[2]
        arg[2,2]=(-0.168440428449)*x[0]+(-0.302470381257)*x[1]+(1.26059253147)*x[2]
        arg[2,3]=(-0.0183286590129)*x[0]+(-0.0950506276918)*x[1]+(-0.721364110928)*x[2]
        arg[2,4]=(-1.04551179644)*x[0]+(0.20728433783)*x[1]+(-0.631521487025)*x[2]
        arg[3,0]=(1.0112442447)*x[0]+(0.0279472213885)*x[1]+(-1.24445628735)*x[2]
        arg[3,1]=(-1.36197290176)*x[0]+(0.145431495907)*x[1]+(0.518562214899)*x[2]
        arg[3,2]=(-0.249567074212)*x[0]+(-1.02991047199)*x[1]+(1.34627546588)*x[2]
        arg[3,3]=(1.72315708213)*x[0]+(0.00515532937983)*x[1]+(-0.479917704073)*x[2]
        arg[3,4]=(1.16297504595)*x[0]+(-0.176518851423)*x[1]+(0.184727222764)*x[2]
        ref[0,0]=(-2.09480681002)*(1+2.*(dim-1.)/(o+1.))+(-0.832628050126)*dim
        ref[0,1]=(-0.759565702286)*(1+2.*(dim-1.)/(o+1.))+(-1.45437511857)*dim
        ref[0,2]=(-1.08318812741)*(1+2.*(dim-1.)/(o+1.))+(0.529698251127)*dim
        ref[0,3]=(1.48988138495)*(1+2.*(dim-1.)/(o+1.))+(-1.81124817294)*dim
        ref[0,4]=(0.116706866039)*(1+2.*(dim-1.)/(o+1.))+(-0.661743355994)*dim
        ref[1,0]=(0.584176790043)*(1+2.*(dim-1.)/(o+1.))+(-0.515803150369)*dim
        ref[1,1]=(-1.25638916576)*(1+2.*(dim-1.)/(o+1.))+(-1.82325855139)*dim
        ref[1,2]=(-0.276318333951)*(1+2.*(dim-1.)/(o+1.))+(1.80505808822)*dim
        ref[1,3]=(-0.732277841606)*(1+2.*(dim-1.)/(o+1.))+(0.564209963043)*dim
        ref[1,4]=(-0.540285295646)*(1+2.*(dim-1.)/(o+1.))+(0.216903087004)*dim
        ref[2,0]=(2.23339929969)*(1+2.*(dim-1.)/(o+1.))+(0.405321751257)*dim
        ref[2,1]=(0.706137929075)*(1+2.*(dim-1.)/(o+1.))+(-0.39943097906)*dim
        ref[2,2]=(-0.474421381251)*(1+2.*(dim-1.)/(o+1.))+(1.26410310301)*dim
        ref[2,3]=(1.43870260444)*(1+2.*(dim-1.)/(o+1.))+(-2.27344600207)*dim
        ref[2,4]=(-1.00154864599)*(1+2.*(dim-1.)/(o+1.))+(-0.468200299646)*dim
        ref[3,0]=(-1.42181650401)*(1+2.*(dim-1.)/(o+1.))+(1.21655168275)*dim
        ref[3,1]=(-0.853191175508)*(1+2.*(dim-1.)/(o+1.))+(0.155211984554)*dim
        ref[3,2]=(-0.823496284217)*(1+2.*(dim-1.)/(o+1.))+(0.890294203901)*dim
        ref[3,3]=(1.54168027082)*(1+2.*(dim-1.)/(o+1.))+(-0.293285563378)*dim
        ref[3,4]=(1.66366656195)*(1+2.*(dim-1.)/(o+1.))+(-0.492483144667)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.775903850503)*x[0]+(0.20657985447)*x[1]
        arg[0,0,1]=(1.42793412139)*x[0]+(1.11703130088)*x[1]
        arg[0,1,0]=(1.89750028353)*x[0]+(1.77903425203)*x[1]
        arg[0,1,1]=(-0.67280619036)*x[0]+(-0.283600511942)*x[1]
        arg[1,0,0]=(0.12590667282)*x[0]+(-0.109778270548)*x[1]
        arg[1,0,1]=(-1.06454156291)*x[0]+(-0.952754071628)*x[1]
        arg[1,1,0]=(1.27939438243)*x[0]+(1.41358757535)*x[1]
        arg[1,1,1]=(-1.68847666929)*x[0]+(-0.13467497005)*x[1]
        arg[2,0,0]=(0.116194220064)*x[0]+(0.457728827844)*x[1]
        arg[2,0,1]=(0.205487821412)*x[0]+(-0.657189976052)*x[1]
        arg[2,1,0]=(0.276192450801)*x[0]+(0.998191496643)*x[1]
        arg[2,1,1]=(1.63929218914)*x[0]+(0.268648283241)*x[1]
        arg[3,0,0]=(-0.419114071163)*x[0]+(-0.365697048391)*x[1]
        arg[3,0,1]=(0.802747458947)*x[0]+(0.137023645119)*x[1]
        arg[3,1,0]=(-0.0712635889142)*x[0]+(0.495489688269)*x[1]
        arg[3,1,1]=(-0.559073395964)*x[0]+(0.248364992354)*x[1]
        arg[4,0,0]=(0.372130696656)*x[0]+(1.22892579337)*x[1]
        arg[4,0,1]=(-1.47944537272)*x[0]+(1.46750125425)*x[1]
        arg[4,1,0]=(-0.0683410762004)*x[0]+(0.0982446782745)*x[1]
        arg[4,1,1]=(0.0698227670903)*x[0]+(0.227875508249)*x[1]
        arg[5,0,0]=(0.237110604157)*x[0]+(0.814767844631)*x[1]
        arg[5,0,1]=(0.172109909542)*x[0]+(-1.56055537357)*x[1]
        arg[5,1,0]=(0.92885449265)*x[0]+(0.820977987322)*x[1]
        arg[5,1,1]=(-1.76483093472)*x[0]+(0.526316351009)*x[1]
        ref[0,0,0]=(0.574633189339)*(1+2.*(dim-1.)/(o+1.))+(-1.14395718537)*dim
        ref[0,0,1]=(1.25832290545)*(1+2.*(dim-1.)/(o+1.))+(1.28664251682)*dim
        ref[0,1,0]=(1.75085914739)*(1+2.*(dim-1.)/(o+1.))+(1.92567538817)*dim
        ref[0,1,1]=(-1.57747201281)*(1+2.*(dim-1.)/(o+1.))+(0.621065310511)*dim
        ref[1,0,0]=(0.710883587246)*(1+2.*(dim-1.)/(o+1.))+(-0.694755184974)*dim
        ref[1,0,1]=(-0.870861363869)*(1+2.*(dim-1.)/(o+1.))+(-1.14643427067)*dim
        ref[1,1,0]=(1.21302125269)*(1+2.*(dim-1.)/(o+1.))+(1.4799607051)*dim
        ref[1,1,1]=(-0.163344093083)*(1+2.*(dim-1.)/(o+1.))+(-1.65980754626)*dim
        ref[2,0,0]=(1.18070929814)*(1+2.*(dim-1.)/(o+1.))+(-0.606786250235)*dim
        ref[2,0,1]=(-1.26011538751)*(1+2.*(dim-1.)/(o+1.))+(0.808413232875)*dim
        ref[2,1,0]=(-0.128253427149)*(1+2.*(dim-1.)/(o+1.))+(1.40263737459)*dim
        ref[2,1,1]=(1.22388877116)*(1+2.*(dim-1.)/(o+1.))+(0.68405170122)*dim
        ref[3,0,0]=(-1.51984063257)*(1+2.*(dim-1.)/(o+1.))+(0.735029513018)*dim
        ref[3,0,1]=(1.63702893126)*(1+2.*(dim-1.)/(o+1.))+(-0.697257827196)*dim
        ref[3,1,0]=(-0.274208683077)*(1+2.*(dim-1.)/(o+1.))+(0.698434782432)*dim
        ref[3,1,1]=(0.649113059071)*(1+2.*(dim-1.)/(o+1.))+(-0.95982146268)*dim
        ref[4,0,0]=(1.11723294318)*(1+2.*(dim-1.)/(o+1.))+(0.483823546848)*dim
        ref[4,0,1]=(-0.0369311601619)*(1+2.*(dim-1.)/(o+1.))+(0.0249870416905)*dim
        ref[4,1,0]=(-0.0969818481854)*(1+2.*(dim-1.)/(o+1.))+(0.126885450259)*dim
        ref[4,1,1]=(0.607834304349)*(1+2.*(dim-1.)/(o+1.))+(-0.31013602901)*dim
        ref[5,0,0]=(0.612356854718)*(1+2.*(dim-1.)/(o+1.))+(0.43952159407)*dim
        ref[5,0,1]=(-0.245849747535)*(1+2.*(dim-1.)/(o+1.))+(-1.1425957165)*dim
        ref[5,1,0]=(0.218025498167)*(1+2.*(dim-1.)/(o+1.))+(1.5318069818)*dim
        ref[5,1,1]=(-0.39419356418)*(1+2.*(dim-1.)/(o+1.))+(-0.844321019532)*dim
      else:
        arg[0,0,0]=(1.52622777835)*x[0]+(-0.627217363559)*x[1]+(-0.221339024656)*x[2]
        arg[0,0,1]=(-0.0735955925339)*x[0]+(-1.44492195287)*x[1]+(-0.0704081180966)*x[2]
        arg[0,1,0]=(-0.330700790074)*x[0]+(-1.04769579979)*x[1]+(0.508799976666)*x[2]
        arg[0,1,1]=(0.349349373439)*x[0]+(0.174054703574)*x[1]+(-0.129296220879)*x[2]
        arg[1,0,0]=(0.0683757878129)*x[0]+(1.33394387082)*x[1]+(0.892302980732)*x[2]
        arg[1,0,1]=(0.61014567223)*x[0]+(1.23846801628)*x[1]+(-0.990674941877)*x[2]
        arg[1,1,0]=(0.964575308424)*x[0]+(0.354822939168)*x[1]+(-0.466180761866)*x[2]
        arg[1,1,1]=(-1.79700594499)*x[0]+(-1.41821199521)*x[1]+(0.366764057361)*x[2]
        arg[2,0,0]=(0.670092254407)*x[0]+(-0.188523225253)*x[1]+(0.363046866484)*x[2]
        arg[2,0,1]=(0.420367065732)*x[0]+(0.798321474665)*x[1]+(-1.11347160928)*x[2]
        arg[2,1,0]=(0.54732858526)*x[0]+(0.249248458735)*x[1]+(1.33905485076)*x[2]
        arg[2,1,1]=(-1.45292600653)*x[0]+(-0.0838212918177)*x[1]+(-0.210961166185)*x[2]
        arg[3,0,0]=(-0.406792355772)*x[0]+(-0.230709788944)*x[1]+(1.12300383125)*x[2]
        arg[3,0,1]=(-1.02748413184)*x[0]+(-1.3840845484)*x[1]+(-0.181262479318)*x[2]
        arg[3,1,0]=(-1.39003872882)*x[0]+(-0.302577309791)*x[1]+(-0.627070288119)*x[2]
        arg[3,1,1]=(0.258496709277)*x[0]+(-1.32012543621)*x[1]+(0.921022534515)*x[2]
        arg[4,0,0]=(-0.639952053735)*x[0]+(0.172303718581)*x[1]+(-1.55894055416)*x[2]
        arg[4,0,1]=(-1.27660129414)*x[0]+(0.142177942574)*x[1]+(0.84156755899)*x[2]
        arg[4,1,0]=(0.49812465572)*x[0]+(1.53755810837)*x[1]+(0.10504146131)*x[2]
        arg[4,1,1]=(0.114534785643)*x[0]+(0.616103931999)*x[1]+(0.515764206037)*x[2]
        arg[5,0,0]=(0.22562941228)*x[0]+(0.70743104453)*x[1]+(0.882965136406)*x[2]
        arg[5,0,1]=(0.674003358504)*x[0]+(0.753008881236)*x[1]+(0.033083269963)*x[2]
        arg[5,1,0]=(-0.495809169314)*x[0]+(-1.09613938465)*x[1]+(-1.03297996938)*x[2]
        arg[5,1,1]=(-0.5222251005)*x[0]+(-0.56129023192)*x[1]+(0.529084741893)*x[2]
        ref[0,0,0]=(0.164333186185)*(1+2.*(dim-1.)/(o+1.))+(0.513338203948)*dim
        ref[0,0,1]=(-0.322072217228)*(1+2.*(dim-1.)/(o+1.))+(-1.26685344627)*dim
        ref[0,1,0]=(1.37061498302)*(1+2.*(dim-1.)/(o+1.))+(-2.24021159622)*dim
        ref[0,1,1]=(0.65996582358)*(1+2.*(dim-1.)/(o+1.))+(-0.265857967445)*dim
        ref[1,0,0]=(1.83616555678)*(1+2.*(dim-1.)/(o+1.))+(0.458457082585)*dim
        ref[1,0,1]=(1.01886896436)*(1+2.*(dim-1.)/(o+1.))+(-0.160930217723)*dim
        ref[1,1,0]=(0.95375222959)*(1+2.*(dim-1.)/(o+1.))+(-0.100534743865)*dim
        ref[1,1,1]=(-1.48059917075)*(1+2.*(dim-1.)/(o+1.))+(-1.3678547121)*dim
        ref[2,0,0]=(-0.0805152837328)*(1+2.*(dim-1.)/(o+1.))+(0.925131179371)*dim
        ref[2,0,1]=(0.155604473013)*(1+2.*(dim-1.)/(o+1.))+(-0.0503875419008)*dim
        ref[2,1,0]=(0.117237902139)*(1+2.*(dim-1.)/(o+1.))+(2.01839399262)*dim
        ref[2,1,1]=(0.196870433027)*(1+2.*(dim-1.)/(o+1.))+(-1.94457889755)*dim
        ref[3,0,0]=(-1.16272511547)*(1+2.*(dim-1.)/(o+1.))+(1.648226802)*dim
        ref[3,0,1]=(-1.54275766077)*(1+2.*(dim-1.)/(o+1.))+(-1.05007349878)*dim
        ref[3,1,0]=(-2.21939430114)*(1+2.*(dim-1.)/(o+1.))+(-0.100292025596)*dim
        ref[3,1,1]=(-0.974866109202)*(1+2.*(dim-1.)/(o+1.))+(0.834259916779)*dim
        ref[4,0,0]=(-1.81015652027)*(1+2.*(dim-1.)/(o+1.))+(-0.216432369042)*dim
        ref[4,0,1]=(-0.0692225921476)*(1+2.*(dim-1.)/(o+1.))+(-0.223633200428)*dim
        ref[4,1,0]=(0.907628019251)*(1+2.*(dim-1.)/(o+1.))+(1.23309620615)*dim
        ref[4,1,1]=(-0.77625708658)*(1+2.*(dim-1.)/(o+1.))+(2.02266001026)*dim
        ref[5,0,0]=(0.040336826806)*(1+2.*(dim-1.)/(o+1.))+(1.77568876641)*dim
        ref[5,0,1]=(-0.741065482842)*(1+2.*(dim-1.)/(o+1.))+(2.20116099255)*dim
        ref[5,1,0]=(-1.93385845474)*(1+2.*(dim-1.)/(o+1.))+(-0.691070068594)*dim
        ref[5,1,1]=(-0.539652361393)*(1+2.*(dim-1.)/(o+1.))+(-0.014778229134)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.139765044323)*x[0]+(0.763652540371)*x[1]
        arg[0,0,0,1]=(1.22422998499)*x[0]+(-0.704059494925)*x[1]
        arg[0,0,1,0]=(-0.0738568759745)*x[0]+(0.227297731345)*x[1]
        arg[0,0,1,1]=(-0.438016525512)*x[0]+(-0.00290173552923)*x[1]
        arg[0,0,2,0]=(-0.142466265385)*x[0]+(0.159086109387)*x[1]
        arg[0,0,2,1]=(-1.29207470861)*x[0]+(0.171024552932)*x[1]
        arg[0,1,0,0]=(0.228469040214)*x[0]+(-1.11207386711)*x[1]
        arg[0,1,0,1]=(-0.0716121324998)*x[0]+(-0.293214318059)*x[1]
        arg[0,1,1,0]=(-0.552331240231)*x[0]+(0.483311325934)*x[1]
        arg[0,1,1,1]=(0.759050036013)*x[0]+(-0.192218075397)*x[1]
        arg[0,1,2,0]=(0.736408127399)*x[0]+(0.61962966835)*x[1]
        arg[0,1,2,1]=(-0.170110592043)*x[0]+(1.12024324836)*x[1]
        arg[0,2,0,0]=(1.15358129137)*x[0]+(0.00288801991025)*x[1]
        arg[0,2,0,1]=(0.34101930461)*x[0]+(1.44561406668)*x[1]
        arg[0,2,1,0]=(1.20180064935)*x[0]+(1.53696717349)*x[1]
        arg[0,2,1,1]=(-0.955282659666)*x[0]+(-0.232022391367)*x[1]
        arg[0,2,2,0]=(0.0907361523468)*x[0]+(0.0735957910178)*x[1]
        arg[0,2,2,1]=(0.377295180443)*x[0]+(-0.694318356175)*x[1]
        arg[0,3,0,0]=(1.38936937129)*x[0]+(-1.11460156576)*x[1]
        arg[0,3,0,1]=(-0.477623155591)*x[0]+(-1.38984205639)*x[1]
        arg[0,3,1,0]=(0.0643534425446)*x[0]+(1.38744715898)*x[1]
        arg[0,3,1,1]=(0.0144448337619)*x[0]+(-0.107478295727)*x[1]
        arg[0,3,2,0]=(0.494522779873)*x[0]+(-0.623994602046)*x[1]
        arg[0,3,2,1]=(0.865352526765)*x[0]+(-0.0330471549519)*x[1]
        arg[0,4,0,0]=(0.876802965861)*x[0]+(-0.72991482831)*x[1]
        arg[0,4,0,1]=(-1.59217671369)*x[0]+(-1.17443275047)*x[1]
        arg[0,4,1,0]=(0.980556838858)*x[0]+(-0.134374268551)*x[1]
        arg[0,4,1,1]=(-0.799387621998)*x[0]+(0.290707689722)*x[1]
        arg[0,4,2,0]=(-0.152070506377)*x[0]+(-0.720051351365)*x[1]
        arg[0,4,2,1]=(-0.726386342076)*x[0]+(-0.821126213298)*x[1]
        arg[1,0,0,0]=(0.0108792321621)*x[0]+(1.08482229519)*x[1]
        arg[1,0,0,1]=(0.395066734758)*x[0]+(-0.147576996716)*x[1]
        arg[1,0,1,0]=(1.34674167646)*x[0]+(-1.7762597766)*x[1]
        arg[1,0,1,1]=(0.145955749421)*x[0]+(0.0758020791017)*x[1]
        arg[1,0,2,0]=(-1.3779896638)*x[0]+(0.879047617812)*x[1]
        arg[1,0,2,1]=(-0.034533186491)*x[0]+(-0.961616456719)*x[1]
        arg[1,1,0,0]=(1.93531133223)*x[0]+(0.085806770105)*x[1]
        arg[1,1,0,1]=(-1.40810156335)*x[0]+(0.647954800386)*x[1]
        arg[1,1,1,0]=(-0.898682130534)*x[0]+(0.0293908578939)*x[1]
        arg[1,1,1,1]=(0.906365050374)*x[0]+(0.493604087615)*x[1]
        arg[1,1,2,0]=(0.200697611638)*x[0]+(0.595460978794)*x[1]
        arg[1,1,2,1]=(-0.137201357175)*x[0]+(-0.456327010456)*x[1]
        arg[1,2,0,0]=(-0.435882659968)*x[0]+(-0.0312083604574)*x[1]
        arg[1,2,0,1]=(-0.678923893852)*x[0]+(-0.559827568731)*x[1]
        arg[1,2,1,0]=(-0.721204171338)*x[0]+(-0.054379212442)*x[1]
        arg[1,2,1,1]=(-0.0624007046506)*x[0]+(0.168316149134)*x[1]
        arg[1,2,2,0]=(-1.58839995565)*x[0]+(-0.212071943846)*x[1]
        arg[1,2,2,1]=(-1.12936118963)*x[0]+(1.37132899453)*x[1]
        arg[1,3,0,0]=(-0.382791970195)*x[0]+(-1.08331380956)*x[1]
        arg[1,3,0,1]=(-0.83075188923)*x[0]+(-0.771795988467)*x[1]
        arg[1,3,1,0]=(-0.491393878842)*x[0]+(0.256082770048)*x[1]
        arg[1,3,1,1]=(1.16535762668)*x[0]+(1.15868916612)*x[1]
        arg[1,3,2,0]=(0.930916100823)*x[0]+(0.447810335514)*x[1]
        arg[1,3,2,1]=(0.542008480891)*x[0]+(0.428660301354)*x[1]
        arg[1,4,0,0]=(0.820283847448)*x[0]+(-0.861049765761)*x[1]
        arg[1,4,0,1]=(0.794597952616)*x[0]+(0.484963133102)*x[1]
        arg[1,4,1,0]=(-0.0864183500936)*x[0]+(-0.48652009912)*x[1]
        arg[1,4,1,1]=(-0.729261074705)*x[0]+(0.572520019661)*x[1]
        arg[1,4,2,0]=(0.874563670592)*x[0]+(-1.03978413308)*x[1]
        arg[1,4,2,1]=(-0.119980177921)*x[0]+(-0.416981275935)*x[1]
        arg[2,0,0,0]=(0.00851163981688)*x[0]+(0.0537719250367)*x[1]
        arg[2,0,0,1]=(0.325152071307)*x[0]+(0.852063357275)*x[1]
        arg[2,0,1,0]=(0.3798978673)*x[0]+(0.103107604149)*x[1]
        arg[2,0,1,1]=(0.241778324259)*x[0]+(0.840767359849)*x[1]
        arg[2,0,2,0]=(0.504220642882)*x[0]+(-0.296421218478)*x[1]
        arg[2,0,2,1]=(1.21850888213)*x[0]+(0.361422173343)*x[1]
        arg[2,1,0,0]=(1.23948863042)*x[0]+(-0.454591957846)*x[1]
        arg[2,1,0,1]=(-0.834341417745)*x[0]+(0.836809823188)*x[1]
        arg[2,1,1,0]=(0.305283593888)*x[0]+(-0.443709359754)*x[1]
        arg[2,1,1,1]=(-1.73751494542)*x[0]+(0.28249619071)*x[1]
        arg[2,1,2,0]=(1.64628846378)*x[0]+(0.929422692022)*x[1]
        arg[2,1,2,1]=(1.55964953056)*x[0]+(0.294507226966)*x[1]
        arg[2,2,0,0]=(-0.122178600734)*x[0]+(-0.836106215351)*x[1]
        arg[2,2,0,1]=(0.0560920262009)*x[0]+(-0.959524453552)*x[1]
        arg[2,2,1,0]=(-0.0235093950509)*x[0]+(1.00069942275)*x[1]
        arg[2,2,1,1]=(-1.6685983361)*x[0]+(-0.283415608089)*x[1]
        arg[2,2,2,0]=(1.88757268407)*x[0]+(-0.0970308753337)*x[1]
        arg[2,2,2,1]=(-0.620474974074)*x[0]+(0.24769276713)*x[1]
        arg[2,3,0,0]=(1.01637595389)*x[0]+(0.705160942822)*x[1]
        arg[2,3,0,1]=(1.14707395208)*x[0]+(0.705275592532)*x[1]
        arg[2,3,1,0]=(-0.758160952494)*x[0]+(0.305309048122)*x[1]
        arg[2,3,1,1]=(0.772402918026)*x[0]+(-0.052854508055)*x[1]
        arg[2,3,2,0]=(-0.154978687298)*x[0]+(0.418368826949)*x[1]
        arg[2,3,2,1]=(-0.845976442257)*x[0]+(0.20623978887)*x[1]
        arg[2,4,0,0]=(-0.466185710519)*x[0]+(-0.233766119139)*x[1]
        arg[2,4,0,1]=(-0.922877220469)*x[0]+(-0.688487528304)*x[1]
        arg[2,4,1,0]=(0.95836287786)*x[0]+(0.939609093639)*x[1]
        arg[2,4,1,1]=(-0.11982304155)*x[0]+(-0.257073186684)*x[1]
        arg[2,4,2,0]=(0.345817495959)*x[0]+(0.151979044778)*x[1]
        arg[2,4,2,1]=(-1.05379548205)*x[0]+(-0.436065928744)*x[1]
        arg[3,0,0,0]=(0.744945706398)*x[0]+(-0.649458468468)*x[1]
        arg[3,0,0,1]=(-1.04958965249)*x[0]+(0.639942303499)*x[1]
        arg[3,0,1,0]=(0.337716118074)*x[0]+(1.93458666396)*x[1]
        arg[3,0,1,1]=(0.303244531116)*x[0]+(0.436648998724)*x[1]
        arg[3,0,2,0]=(-1.55484904142)*x[0]+(0.0691158242075)*x[1]
        arg[3,0,2,1]=(-0.184571563941)*x[0]+(-0.617496186026)*x[1]
        arg[3,1,0,0]=(0.54665472418)*x[0]+(-0.685197219861)*x[1]
        arg[3,1,0,1]=(0.270341054659)*x[0]+(0.0123904138595)*x[1]
        arg[3,1,1,0]=(-0.551927232745)*x[0]+(-0.0835992799883)*x[1]
        arg[3,1,1,1]=(-0.731741032186)*x[0]+(0.351597478907)*x[1]
        arg[3,1,2,0]=(-0.678408784965)*x[0]+(-0.0779391332051)*x[1]
        arg[3,1,2,1]=(-0.873182924195)*x[0]+(-0.641772673128)*x[1]
        arg[3,2,0,0]=(-0.826223714873)*x[0]+(0.631844849849)*x[1]
        arg[3,2,0,1]=(-0.899714515249)*x[0]+(-0.010350665009)*x[1]
        arg[3,2,1,0]=(0.290678744119)*x[0]+(-0.5871053663)*x[1]
        arg[3,2,1,1]=(0.208288673139)*x[0]+(0.631917010925)*x[1]
        arg[3,2,2,0]=(-0.262706136542)*x[0]+(0.0853212850096)*x[1]
        arg[3,2,2,1]=(-1.28934754486)*x[0]+(0.686855142119)*x[1]
        arg[3,3,0,0]=(-1.36704032596)*x[0]+(-1.55543480824)*x[1]
        arg[3,3,0,1]=(-1.17014698336)*x[0]+(-0.652446157654)*x[1]
        arg[3,3,1,0]=(-0.547499757476)*x[0]+(-0.156519515585)*x[1]
        arg[3,3,1,1]=(0.228140026291)*x[0]+(-1.41014817371)*x[1]
        arg[3,3,2,0]=(-0.055056583329)*x[0]+(-0.412525603966)*x[1]
        arg[3,3,2,1]=(-0.524790489086)*x[0]+(-0.774411367008)*x[1]
        arg[3,4,0,0]=(-1.33491047191)*x[0]+(1.47855022808)*x[1]
        arg[3,4,0,1]=(-0.301405501225)*x[0]+(0.687178741851)*x[1]
        arg[3,4,1,0]=(0.213050803289)*x[0]+(0.428086322291)*x[1]
        arg[3,4,1,1]=(-1.67469009469)*x[0]+(0.857275314994)*x[1]
        arg[3,4,2,0]=(0.748812148687)*x[0]+(-0.0339722859922)*x[1]
        arg[3,4,2,1]=(-0.829454912563)*x[0]+(-0.637161668052)*x[1]
        ref[0,0,0,0]=(0.538138880568)*(1+2.*(dim-1.)/(o+1.))+(0.365278704126)*dim
        ref[0,0,0,1]=(0.532354921417)*(1+2.*(dim-1.)/(o+1.))+(-0.0121844313566)*dim
        ref[0,0,1,0]=(1.27037934234)*(1+2.*(dim-1.)/(o+1.))+(-1.11693848697)*dim
        ref[0,0,1,1]=(-0.317494874699)*(1+2.*(dim-1.)/(o+1.))+(-0.123423386343)*dim
        ref[0,0,2,0]=(-0.274542501137)*(1+2.*(dim-1.)/(o+1.))+(0.291162345138)*dim
        ref[0,0,2,1]=(-0.669231324784)*(1+2.*(dim-1.)/(o+1.))+(-0.451818830894)*dim
        ref[0,1,0,0]=(-1.55791021679)*(1+2.*(dim-1.)/(o+1.))+(0.674305389899)*dim
        ref[0,1,0,1]=(-1.04225461385)*(1+2.*(dim-1.)/(o+1.))+(0.67742816329)*dim
        ref[0,1,1,0]=(-0.553787932867)*(1+2.*(dim-1.)/(o+1.))+(0.48476801857)*dim
        ref[0,1,1,1]=(0.774284436582)*(1+2.*(dim-1.)/(o+1.))+(-0.207452475966)*dim
        ref[0,1,2,0]=(0.754663298028)*(1+2.*(dim-1.)/(o+1.))+(0.601374497721)*dim
        ref[0,1,2,1]=(0.378489135155)*(1+2.*(dim-1.)/(o+1.))+(0.571643521166)*dim
        ref[0,2,0,0]=(0.84270626402)*(1+2.*(dim-1.)/(o+1.))+(0.313763047258)*dim
        ref[0,2,0,1]=(0.741388749098)*(1+2.*(dim-1.)/(o+1.))+(1.0452446222)*dim
        ref[0,2,1,0]=(1.31801677967)*(1+2.*(dim-1.)/(o+1.))+(1.42075104317)*dim
        ref[0,2,1,1]=(0.342128499103)*(1+2.*(dim-1.)/(o+1.))+(-1.52943355014)*dim
        ref[0,2,2,0]=(-0.2097885639)*(1+2.*(dim-1.)/(o+1.))+(0.374120507264)*dim
        ref[0,2,2,1]=(0.517181369396)*(1+2.*(dim-1.)/(o+1.))+(-0.834204545127)*dim
        ref[0,3,0,0]=(0.546538945104)*(1+2.*(dim-1.)/(o+1.))+(-0.271771139576)*dim
        ref[0,3,0,1]=(-1.11041658618)*(1+2.*(dim-1.)/(o+1.))+(-0.757048625806)*dim
        ref[0,3,1,0]=(1.71248931933)*(1+2.*(dim-1.)/(o+1.))+(-0.260688717804)*dim
        ref[0,3,1,1]=(0.426783834682)*(1+2.*(dim-1.)/(o+1.))+(-0.519817296646)*dim
        ref[0,3,2,0]=(-0.159038051631)*(1+2.*(dim-1.)/(o+1.))+(0.0295662294573)*dim
        ref[0,3,2,1]=(-0.0935533877409)*(1+2.*(dim-1.)/(o+1.))+(0.925858759554)*dim
        ref[0,4,0,0]=(0.254413611162)*(1+2.*(dim-1.)/(o+1.))+(-0.107525473611)*dim
        ref[0,4,0,1]=(-1.80344635667)*(1+2.*(dim-1.)/(o+1.))+(-0.963163107492)*dim
        ref[0,4,1,0]=(0.77936654687)*(1+2.*(dim-1.)/(o+1.))+(0.0668160234379)*dim
        ref[0,4,1,1]=(-0.854656189741)*(1+2.*(dim-1.)/(o+1.))+(0.345976257465)*dim
        ref[0,4,2,0]=(0.236075361826)*(1+2.*(dim-1.)/(o+1.))+(-1.10819721957)*dim
        ref[0,4,2,1]=(-1.41443045549)*(1+2.*(dim-1.)/(o+1.))+(-0.133082099885)*dim
        ref[1,0,0,0]=(0.254601110632)*(1+2.*(dim-1.)/(o+1.))+(0.841100416717)*dim
        ref[1,0,0,1]=(-1.05142234949)*(1+2.*(dim-1.)/(o+1.))+(1.29891208753)*dim
        ref[1,0,1,0]=(-0.476182365596)*(1+2.*(dim-1.)/(o+1.))+(0.0466642654563)*dim
        ref[1,0,1,1]=(-1.2117362156)*(1+2.*(dim-1.)/(o+1.))+(1.43349404413)*dim
        ref[1,0,2,0]=(-0.82694411065)*(1+2.*(dim-1.)/(o+1.))+(0.328002064662)*dim
        ref[1,0,2,1]=(-0.784489634199)*(1+2.*(dim-1.)/(o+1.))+(-0.211660009011)*dim
        ref[1,1,0,0]=(1.67906802629)*(1+2.*(dim-1.)/(o+1.))+(0.342050076043)*dim
        ref[1,1,0,1]=(-0.798764638314)*(1+2.*(dim-1.)/(o+1.))+(0.03861787535)*dim
        ref[1,1,1,0]=(0.348279136631)*(1+2.*(dim-1.)/(o+1.))+(-1.21757040927)*dim
        ref[1,1,1,1]=(0.452104104709)*(1+2.*(dim-1.)/(o+1.))+(0.94786503328)*dim
        ref[1,1,2,0]=(0.855057493837)*(1+2.*(dim-1.)/(o+1.))+(-0.0588989034046)*dim
        ref[1,1,2,1]=(-0.666495642664)*(1+2.*(dim-1.)/(o+1.))+(0.0729672750328)*dim
        ref[1,2,0,0]=(-0.566691483673)*(1+2.*(dim-1.)/(o+1.))+(0.0996004632473)*dim
        ref[1,2,0,1]=(-0.127941886194)*(1+2.*(dim-1.)/(o+1.))+(-1.11080957639)*dim
        ref[1,2,1,0]=(-0.249856548379)*(1+2.*(dim-1.)/(o+1.))+(-0.525726835401)*dim
        ref[1,2,1,1]=(1.00195986166)*(1+2.*(dim-1.)/(o+1.))+(-0.896044417179)*dim
        ref[1,2,2,0]=(-0.96849834562)*(1+2.*(dim-1.)/(o+1.))+(-0.831973553872)*dim
        ref[1,2,2,1]=(0.204504064885)*(1+2.*(dim-1.)/(o+1.))+(0.0374637400154)*dim
        ref[1,3,0,0]=(-0.587139938504)*(1+2.*(dim-1.)/(o+1.))+(-0.878965841253)*dim
        ref[1,3,0,1]=(-0.013960550118)*(1+2.*(dim-1.)/(o+1.))+(-1.58858732758)*dim
        ref[1,3,1,0]=(-0.626445648631)*(1+2.*(dim-1.)/(o+1.))+(0.391134539838)*dim
        ref[1,3,1,1]=(0.793357894316)*(1+2.*(dim-1.)/(o+1.))+(1.53068889848)*dim
        ref[1,3,2,0]=(-0.30795291971)*(1+2.*(dim-1.)/(o+1.))+(1.68667935605)*dim
        ref[1,3,2,1]=(0.865506632636)*(1+2.*(dim-1.)/(o+1.))+(0.105162149608)*dim
        ref[1,4,0,0]=(0.0142921032519)*(1+2.*(dim-1.)/(o+1.))+(-0.0550580215643)*dim
        ref[1,4,0,1]=(1.74635688975)*(1+2.*(dim-1.)/(o+1.))+(-0.466795804028)*dim
        ref[1,4,1,0]=(0.202247079284)*(1+2.*(dim-1.)/(o+1.))+(-0.775185528498)*dim
        ref[1,4,1,1]=(0.518302547238)*(1+2.*(dim-1.)/(o+1.))+(-0.675043602282)*dim
        ref[1,4,2,0]=(-0.0110996487494)*(1+2.*(dim-1.)/(o+1.))+(-0.154120813742)*dim
        ref[1,4,2,1]=(0.445368223328)*(1+2.*(dim-1.)/(o+1.))+(-0.982329677184)*dim
        ref[2,0,0,0]=(1.11858205689)*(1+2.*(dim-1.)/(o+1.))+(-1.05629849203)*dim
        ref[2,0,0,1]=(0.326749663749)*(1+2.*(dim-1.)/(o+1.))+(0.850465764833)*dim
        ref[2,0,1,0]=(1.17260350442)*(1+2.*(dim-1.)/(o+1.))+(-0.689598032967)*dim
        ref[2,0,1,1]=(1.26453211291)*(1+2.*(dim-1.)/(o+1.))+(-0.181986428807)*dim
        ref[2,0,2,0]=(0.28543047736)*(1+2.*(dim-1.)/(o+1.))+(-0.0776310529561)*dim
        ref[2,0,2,1]=(1.67283723918)*(1+2.*(dim-1.)/(o+1.))+(-0.092906183711)*dim
        ref[2,1,0,0]=(0.375606493975)*(1+2.*(dim-1.)/(o+1.))+(0.409290178597)*dim
        ref[2,1,0,1]=(0.391717224425)*(1+2.*(dim-1.)/(o+1.))+(-0.389248818981)*dim
        ref[2,1,1,0]=(0.540376031372)*(1+2.*(dim-1.)/(o+1.))+(-0.678801797238)*dim
        ref[2,1,1,1]=(-0.781880488997)*(1+2.*(dim-1.)/(o+1.))+(-0.673138265714)*dim
        ref[2,1,2,0]=(1.19474704445)*(1+2.*(dim-1.)/(o+1.))+(1.38096411135)*dim
        ref[2,1,2,1]=(0.3333062674)*(1+2.*(dim-1.)/(o+1.))+(1.52085049012)*dim
        ref[2,2,0,0]=(-0.570564746042)*(1+2.*(dim-1.)/(o+1.))+(-0.387720070044)*dim
        ref[2,2,0,1]=(-0.906439974412)*(1+2.*(dim-1.)/(o+1.))+(0.00300754706095)*dim
        ref[2,2,1,0]=(1.35643048678)*(1+2.*(dim-1.)/(o+1.))+(-0.379240459088)*dim
        ref[2,2,1,1]=(-1.68522696847)*(1+2.*(dim-1.)/(o+1.))+(-0.266786975721)*dim
        ref[2,2,2,0]=(1.64773077393)*(1+2.*(dim-1.)/(o+1.))+(0.14281103481)*dim
        ref[2,2,2,1]=(0.161577377439)*(1+2.*(dim-1.)/(o+1.))+(-0.534359584383)*dim
        ref[2,3,0,0]=(0.117577368411)*(1+2.*(dim-1.)/(o+1.))+(1.6039595283)*dim
        ref[2,3,0,1]=(1.07270794583)*(1+2.*(dim-1.)/(o+1.))+(0.779641598778)*dim
        ref[2,3,1,0]=(0.940083930247)*(1+2.*(dim-1.)/(o+1.))+(-1.39293583462)*dim
        ref[2,3,1,1]=(-0.322170646263)*(1+2.*(dim-1.)/(o+1.))+(1.04171905623)*dim
        ref[2,3,2,0]=(-1.00498391043)*(1+2.*(dim-1.)/(o+1.))+(1.26837405008)*dim
        ref[2,3,2,1]=(0.148227404921)*(1+2.*(dim-1.)/(o+1.))+(-0.787964058307)*dim
        ref[2,4,0,0]=(-0.567878073929)*(1+2.*(dim-1.)/(o+1.))+(-0.132073755729)*dim
        ref[2,4,0,1]=(-0.265369521409)*(1+2.*(dim-1.)/(o+1.))+(-1.34599522736)*dim
        ref[2,4,1,0]=(0.87362235129)*(1+2.*(dim-1.)/(o+1.))+(1.02434962021)*dim
        ref[2,4,1,1]=(-1.05435356817)*(1+2.*(dim-1.)/(o+1.))+(0.67745733994)*dim
        ref[2,4,2,0]=(-0.0889174414067)*(1+2.*(dim-1.)/(o+1.))+(0.586713982143)*dim
        ref[2,4,2,1]=(-0.950446212097)*(1+2.*(dim-1.)/(o+1.))+(-0.539415198695)*dim
        ref[3,0,0,0]=(0.585351095733)*(1+2.*(dim-1.)/(o+1.))+(-0.489863857802)*dim
        ref[3,0,0,1]=(0.0818488289135)*(1+2.*(dim-1.)/(o+1.))+(-0.491496177908)*dim
        ref[3,0,1,0]=(1.83790469827)*(1+2.*(dim-1.)/(o+1.))+(0.43439808376)*dim
        ref[3,0,1,1]=(-0.812249042145)*(1+2.*(dim-1.)/(o+1.))+(1.55214257198)*dim
        ref[3,0,2,0]=(-1.62498605972)*(1+2.*(dim-1.)/(o+1.))+(0.139252842511)*dim
        ref[3,0,2,1]=(0.248660359392)*(1+2.*(dim-1.)/(o+1.))+(-1.05072810936)*dim
        ref[3,1,0,0]=(0.701570774477)*(1+2.*(dim-1.)/(o+1.))+(-0.840113270158)*dim
        ref[3,1,0,1]=(-1.01112314775)*(1+2.*(dim-1.)/(o+1.))+(1.29385461627)*dim
        ref[3,1,1,0]=(-0.38604780773)*(1+2.*(dim-1.)/(o+1.))+(-0.249478705003)*dim
        ref[3,1,1,1]=(-0.505728989541)*(1+2.*(dim-1.)/(o+1.))+(0.125585436262)*dim
        ref[3,1,2,0]=(0.170090820399)*(1+2.*(dim-1.)/(o+1.))+(-0.926438738569)*dim
        ref[3,1,2,1]=(-0.929125306455)*(1+2.*(dim-1.)/(o+1.))+(-0.585830290868)*dim
        ref[3,2,0,0]=(-0.155713736332)*(1+2.*(dim-1.)/(o+1.))+(-0.038665128691)*dim
        ref[3,2,0,1]=(-1.52172024486)*(1+2.*(dim-1.)/(o+1.))+(0.6116550646)*dim
        ref[3,2,1,0]=(0.320960641588)*(1+2.*(dim-1.)/(o+1.))+(-0.617387263769)*dim
        ref[3,2,1,1]=(1.35000898226)*(1+2.*(dim-1.)/(o+1.))+(-0.509803298192)*dim
        ref[3,2,2,0]=(-1.08694938974)*(1+2.*(dim-1.)/(o+1.))+(0.909564538204)*dim
        ref[3,2,2,1]=(-0.484173893901)*(1+2.*(dim-1.)/(o+1.))+(-0.11831850884)*dim
        ref[3,3,0,0]=(-1.30137401361)*(1+2.*(dim-1.)/(o+1.))+(-1.62110112059)*dim
        ref[3,3,0,1]=(-1.01955795295)*(1+2.*(dim-1.)/(o+1.))+(-0.803035188058)*dim
        ref[3,3,1,0]=(-0.86522946065)*(1+2.*(dim-1.)/(o+1.))+(0.161210187589)*dim
        ref[3,3,1,1]=(-1.45434545656)*(1+2.*(dim-1.)/(o+1.))+(0.272337309144)*dim
        ref[3,3,2,0]=(-1.09044516001)*(1+2.*(dim-1.)/(o+1.))+(0.622862972717)*dim
        ref[3,3,2,1]=(-1.56164744337)*(1+2.*(dim-1.)/(o+1.))+(0.262445587275)*dim
        ref[3,4,0,0]=(-0.0717688395634)*(1+2.*(dim-1.)/(o+1.))+(0.215408595737)*dim
        ref[3,4,0,1]=(-0.361057910751)*(1+2.*(dim-1.)/(o+1.))+(0.746831151378)*dim
        ref[3,4,1,0]=(1.3065764036)*(1+2.*(dim-1.)/(o+1.))+(-0.665439278018)*dim
        ref[3,4,1,1]=(0.00897444539195)*(1+2.*(dim-1.)/(o+1.))+(-0.826389225091)*dim
        ref[3,4,2,0]=(0.0968985993748)*(1+2.*(dim-1.)/(o+1.))+(0.61794126332)*dim
        ref[3,4,2,1]=(-0.247002319776)*(1+2.*(dim-1.)/(o+1.))+(-1.21961426084)*dim
      else:
        arg[0,0,0,0]=(0.249559417601)*x[0]+(-1.12919415836)*x[1]+(0.535083953587)*x[2]
        arg[0,0,0,1]=(-1.61154525877)*x[0]+(-0.339535503099)*x[1]+(-0.3734414422)*x[2]
        arg[0,0,1,0]=(-1.33426413331)*x[0]+(0.503654661149)*x[1]+(0.900718166029)*x[2]
        arg[0,0,1,1]=(-1.47348135079)*x[0]+(0.294426872223)*x[1]+(-0.092932038156)*x[2]
        arg[0,0,2,0]=(-0.659338105033)*x[0]+(0.276825152205)*x[1]+(-0.825904690993)*x[2]
        arg[0,0,2,1]=(-0.871512897535)*x[0]+(0.16237107696)*x[1]+(-1.37935248231)*x[2]
        arg[0,1,0,0]=(-0.83315792018)*x[0]+(-0.00675809409276)*x[1]+(0.464774846632)*x[2]
        arg[0,1,0,1]=(0.527155362932)*x[0]+(0.856707619808)*x[1]+(-1.68267649456)*x[2]
        arg[0,1,1,0]=(-0.524091384241)*x[0]+(-0.540620074365)*x[1]+(0.992745803077)*x[2]
        arg[0,1,1,1]=(1.61356254869)*x[0]+(1.50422956091)*x[1]+(0.522074610423)*x[2]
        arg[0,1,2,0]=(-0.786383950132)*x[0]+(0.240998133454)*x[1]+(-0.609039834527)*x[2]
        arg[0,1,2,1]=(-0.549608404174)*x[0]+(-0.850827315095)*x[1]+(0.267519458624)*x[2]
        arg[0,2,0,0]=(-0.171255468598)*x[0]+(-0.315808418391)*x[1]+(-1.31408126593)*x[2]
        arg[0,2,0,1]=(-0.0537048497397)*x[0]+(-1.05283989597)*x[1]+(-0.230505226375)*x[2]
        arg[0,2,1,0]=(0.175422426556)*x[0]+(-1.37203245283)*x[1]+(-1.31579047196)*x[2]
        arg[0,2,1,1]=(-0.678719594441)*x[0]+(0.325375648943)*x[1]+(-1.3715383088)*x[2]
        arg[0,2,2,0]=(1.34295310191)*x[0]+(-1.29856762722)*x[1]+(-0.604804069008)*x[2]
        arg[0,2,2,1]=(-0.38925176646)*x[0]+(-0.391078913511)*x[1]+(-0.147119806342)*x[2]
        arg[0,3,0,0]=(0.55897935716)*x[0]+(-0.938161813577)*x[1]+(-1.01170144437)*x[2]
        arg[0,3,0,1]=(-0.214720994691)*x[0]+(-0.936636326408)*x[1]+(1.23434495942)*x[2]
        arg[0,3,1,0]=(0.665136478224)*x[0]+(-0.223132283946)*x[1]+(0.513937660496)*x[2]
        arg[0,3,1,1]=(0.99663942166)*x[0]+(-0.870793744717)*x[1]+(-0.44642261239)*x[2]
        arg[0,3,2,0]=(0.426708530385)*x[0]+(-0.399913590631)*x[1]+(0.621569032554)*x[2]
        arg[0,3,2,1]=(-0.385564378699)*x[0]+(-1.17310910463)*x[1]+(-0.386725711607)*x[2]
        arg[0,4,0,0]=(-0.907605366918)*x[0]+(-1.15620807313)*x[1]+(0.690709991448)*x[2]
        arg[0,4,0,1]=(0.68925487184)*x[0]+(-0.731402302062)*x[1]+(-0.278506722879)*x[2]
        arg[0,4,1,0]=(0.607545316973)*x[0]+(-0.480514687124)*x[1]+(-0.261850296368)*x[2]
        arg[0,4,1,1]=(1.39016358303)*x[0]+(0.571194445557)*x[1]+(1.02359000173)*x[2]
        arg[0,4,2,0]=(1.19042892582)*x[0]+(-0.265599567429)*x[1]+(-0.412933583721)*x[2]
        arg[0,4,2,1]=(0.105768402681)*x[0]+(0.529442827604)*x[1]+(1.70332495695)*x[2]
        arg[1,0,0,0]=(-0.466512450689)*x[0]+(-0.821724116037)*x[1]+(0.315646947734)*x[2]
        arg[1,0,0,1]=(-0.343965024161)*x[0]+(-0.718276908655)*x[1]+(-0.89648206258)*x[2]
        arg[1,0,1,0]=(0.533001165605)*x[0]+(0.0431632707839)*x[1]+(-0.34028160642)*x[2]
        arg[1,0,1,1]=(-0.0905898060243)*x[0]+(-0.634642149101)*x[1]+(-1.13501642684)*x[2]
        arg[1,0,2,0]=(0.660943497868)*x[0]+(-0.354792953445)*x[1]+(1.28780893672)*x[2]
        arg[1,0,2,1]=(-1.2338460337)*x[0]+(-1.07489268654)*x[1]+(-1.32063885434)*x[2]
        arg[1,1,0,0]=(-0.564276365398)*x[0]+(1.03120151704)*x[1]+(-1.15799041025)*x[2]
        arg[1,1,0,1]=(0.715308242213)*x[0]+(1.38372056508)*x[1]+(0.143855804663)*x[2]
        arg[1,1,1,0]=(-0.359352464902)*x[0]+(1.12698364061)*x[1]+(0.592356171876)*x[2]
        arg[1,1,1,1]=(-0.450554686066)*x[0]+(-0.546866217679)*x[1]+(1.0842968414)*x[2]
        arg[1,1,2,0]=(-0.477267172046)*x[0]+(-0.863491255396)*x[1]+(-0.991333852913)*x[2]
        arg[1,1,2,1]=(0.402599196931)*x[0]+(-0.635287203482)*x[1]+(-0.277210261227)*x[2]
        arg[1,2,0,0]=(-1.56932441015)*x[0]+(-1.56442238007)*x[1]+(-0.375354109955)*x[2]
        arg[1,2,0,1]=(0.193969262086)*x[0]+(-0.0913153952113)*x[1]+(-0.764434182025)*x[2]
        arg[1,2,1,0]=(-0.836765580561)*x[0]+(0.84683301026)*x[1]+(-1.05033967172)*x[2]
        arg[1,2,1,1]=(1.68348957076)*x[0]+(-1.14474223991)*x[1]+(-0.0028142026612)*x[2]
        arg[1,2,2,0]=(-0.0921618478149)*x[0]+(-0.555660652821)*x[1]+(-0.398214997034)*x[2]
        arg[1,2,2,1]=(1.03261791276)*x[0]+(-0.650225649301)*x[1]+(1.63375423051)*x[2]
        arg[1,3,0,0]=(-0.348599695393)*x[0]+(-1.20215183267)*x[1]+(-0.1129459677)*x[2]
        arg[1,3,0,1]=(0.877317784105)*x[0]+(-0.587978566735)*x[1]+(1.10042804546)*x[2]
        arg[1,3,1,0]=(-0.547033849227)*x[0]+(-1.28198893788)*x[1]+(-0.424854587074)*x[2]
        arg[1,3,1,1]=(0.739360669292)*x[0]+(-0.66359460621)*x[1]+(1.08588749669)*x[2]
        arg[1,3,2,0]=(0.137130432185)*x[0]+(-0.123436803848)*x[1]+(-1.31161936702)*x[2]
        arg[1,3,2,1]=(-0.0171220220237)*x[0]+(1.44556512776)*x[1]+(0.665008556384)*x[2]
        arg[1,4,0,0]=(-0.304568160155)*x[0]+(-0.453489411096)*x[1]+(0.769736915169)*x[2]
        arg[1,4,0,1]=(-0.389567079496)*x[0]+(1.01465816808)*x[1]+(1.05389792181)*x[2]
        arg[1,4,1,0]=(-0.293019902659)*x[0]+(0.935020375302)*x[1]+(0.465003429909)*x[2]
        arg[1,4,1,1]=(1.26426164192)*x[0]+(0.53660188438)*x[1]+(-1.26997852414)*x[2]
        arg[1,4,2,0]=(0.447013260347)*x[0]+(-0.292646095073)*x[1]+(-0.141236248636)*x[2]
        arg[1,4,2,1]=(0.627246227193)*x[0]+(-1.07310030602)*x[1]+(0.414244174014)*x[2]
        arg[2,0,0,0]=(0.0450404092088)*x[0]+(-0.092484507099)*x[1]+(0.416562031216)*x[2]
        arg[2,0,0,1]=(0.437290559939)*x[0]+(-1.00144259207)*x[1]+(1.26666155425)*x[2]
        arg[2,0,1,0]=(0.0919297766737)*x[0]+(0.925519273623)*x[1]+(-0.582669368425)*x[2]
        arg[2,0,1,1]=(1.40247347323)*x[0]+(-0.896360612277)*x[1]+(-0.235401929947)*x[2]
        arg[2,0,2,0]=(-0.0760543780641)*x[0]+(-1.12543060216)*x[1]+(-1.73005861985)*x[2]
        arg[2,0,2,1]=(-0.0540914682488)*x[0]+(0.686173107995)*x[1]+(-0.499264219762)*x[2]
        arg[2,1,0,0]=(1.29412006754)*x[0]+(1.17564161143)*x[1]+(0.30140132879)*x[2]
        arg[2,1,0,1]=(-0.987572082341)*x[0]+(-1.73401714184)*x[1]+(0.542753625023)*x[2]
        arg[2,1,1,0]=(-0.162426291727)*x[0]+(0.508287986142)*x[1]+(0.42345261935)*x[2]
        arg[2,1,1,1]=(-0.436007145923)*x[0]+(0.344485478615)*x[1]+(0.867081685885)*x[2]
        arg[2,1,2,0]=(1.23340638096)*x[0]+(1.16627983483)*x[1]+(0.291792397233)*x[2]
        arg[2,1,2,1]=(1.81405521045)*x[0]+(-0.358711641776)*x[1]+(1.67495221975)*x[2]
        arg[2,2,0,0]=(-0.998776647505)*x[0]+(1.38487801142)*x[1]+(-0.199886556937)*x[2]
        arg[2,2,0,1]=(-0.151564577745)*x[0]+(0.100245326484)*x[1]+(-0.98457000197)*x[2]
        arg[2,2,1,0]=(-0.767959771993)*x[0]+(-0.641538616024)*x[1]+(0.0206020120898)*x[2]
        arg[2,2,1,1]=(-0.116988718822)*x[0]+(-1.15499563681)*x[1]+(-0.187589599016)*x[2]
        arg[2,2,2,0]=(0.682354528276)*x[0]+(0.606005834005)*x[1]+(0.11468472132)*x[2]
        arg[2,2,2,1]=(-0.547781355521)*x[0]+(1.23047427005)*x[1]+(0.854018236174)*x[2]
        arg[2,3,0,0]=(0.368349078554)*x[0]+(-1.12153473446)*x[1]+(0.114116055257)*x[2]
        arg[2,3,0,1]=(0.838089123891)*x[0]+(0.283469213399)*x[1]+(0.249874271688)*x[2]
        arg[2,3,1,0]=(-1.03882746612)*x[0]+(0.159711106612)*x[1]+(-1.57272656988)*x[2]
        arg[2,3,1,1]=(-1.25439210606)*x[0]+(-0.801588333704)*x[1]+(-0.166928557775)*x[2]
        arg[2,3,2,0]=(0.0650011438717)*x[0]+(0.879974749381)*x[1]+(-0.276534309239)*x[2]
        arg[2,3,2,1]=(-0.774913691581)*x[0]+(-0.360358063631)*x[1]+(-0.368288145309)*x[2]
        arg[2,4,0,0]=(-0.855093207242)*x[0]+(0.82049336972)*x[1]+(-0.496007273696)*x[2]
        arg[2,4,0,1]=(-0.113408635338)*x[0]+(0.116297312211)*x[1]+(-1.05279504872)*x[2]
        arg[2,4,1,0]=(1.59034968962)*x[0]+(-0.993664270946)*x[1]+(-1.44097244774)*x[2]
        arg[2,4,1,1]=(-0.554191144546)*x[0]+(-1.30747375036)*x[1]+(-1.17946836248)*x[2]
        arg[2,4,2,0]=(0.626012137217)*x[0]+(0.518243725142)*x[1]+(0.0933303150622)*x[2]
        arg[2,4,2,1]=(-0.10169564723)*x[0]+(1.45820149276)*x[1]+(-0.0393269028179)*x[2]
        arg[3,0,0,0]=(-0.0404687905735)*x[0]+(0.0715700915639)*x[1]+(1.45121483418)*x[2]
        arg[3,0,0,1]=(1.25470808156)*x[0]+(-0.119317783496)*x[1]+(0.28341020961)*x[2]
        arg[3,0,1,0]=(0.352807293701)*x[0]+(0.230591898707)*x[1]+(-0.580416381826)*x[2]
        arg[3,0,1,1]=(1.6169875055)*x[0]+(0.515147269207)*x[1]+(-0.461088044559)*x[2]
        arg[3,0,2,0]=(0.345374169211)*x[0]+(0.165179946106)*x[1]+(0.0761591935161)*x[2]
        arg[3,0,2,1]=(-0.367306414632)*x[0]+(-0.236156646602)*x[1]+(-0.388955870267)*x[2]
        arg[3,1,0,0]=(-0.27984693051)*x[0]+(-0.0431489812153)*x[1]+(-0.315624571395)*x[2]
        arg[3,1,0,1]=(-0.923109329983)*x[0]+(0.71133451696)*x[1]+(-0.793551470792)*x[2]
        arg[3,1,1,0]=(-0.434858211337)*x[0]+(0.943115368224)*x[1]+(0.195339633021)*x[2]
        arg[3,1,1,1]=(0.517533657447)*x[0]+(-0.975487574798)*x[1]+(0.00389777788827)*x[2]
        arg[3,1,2,0]=(-1.29728995298)*x[0]+(-0.519355341481)*x[1]+(-0.986985327874)*x[2]
        arg[3,1,2,1]=(-0.104824066468)*x[0]+(0.155059832097)*x[1]+(-0.513194354212)*x[2]
        arg[3,2,0,0]=(-0.053676798897)*x[0]+(-0.957854779002)*x[1]+(0.575673251241)*x[2]
        arg[3,2,0,1]=(0.828930053602)*x[0]+(0.122518313839)*x[1]+(-0.711848816688)*x[2]
        arg[3,2,1,0]=(0.468063581449)*x[0]+(0.233244036405)*x[1]+(-1.06333921952)*x[2]
        arg[3,2,1,1]=(-0.178080946586)*x[0]+(0.481804828166)*x[1]+(-0.25332042181)*x[2]
        arg[3,2,2,0]=(-0.2520881536)*x[0]+(-1.03459378989)*x[1]+(-0.284550808049)*x[2]
        arg[3,2,2,1]=(-0.778922518429)*x[0]+(1.0037625091)*x[1]+(-0.252088333444)*x[2]
        arg[3,3,0,0]=(0.467759844055)*x[0]+(0.598630111441)*x[1]+(-0.180631591223)*x[2]
        arg[3,3,0,1]=(-0.704465112342)*x[0]+(0.577992884135)*x[1]+(0.614639798328)*x[2]
        arg[3,3,1,0]=(0.58772281958)*x[0]+(0.267751378071)*x[1]+(0.11546949909)*x[2]
        arg[3,3,1,1]=(-0.220490484007)*x[0]+(-0.346075755455)*x[1]+(0.709249188793)*x[2]
        arg[3,3,2,0]=(-0.03823885045)*x[0]+(1.0070390689)*x[1]+(0.786191739951)*x[2]
        arg[3,3,2,1]=(0.468772686804)*x[0]+(-0.416774817651)*x[1]+(1.65342478719)*x[2]
        arg[3,4,0,0]=(0.69436779527)*x[0]+(-0.644342658009)*x[1]+(-0.6765845785)*x[2]
        arg[3,4,0,1]=(0.210253965392)*x[0]+(0.208735045316)*x[1]+(-0.553442080096)*x[2]
        arg[3,4,1,0]=(-0.0680478107141)*x[0]+(0.770215954791)*x[1]+(-0.876270039559)*x[2]
        arg[3,4,1,1]=(-0.384812708168)*x[0]+(-0.482707860969)*x[1]+(1.00274437781)*x[2]
        arg[3,4,2,0]=(-0.144567417774)*x[0]+(0.277773632892)*x[1]+(1.3123295509)*x[2]
        arg[3,4,2,1]=(0.00870646304914)*x[0]+(-0.254229329332)*x[1]+(-1.66538680273)*x[2]
        ref[0,0,0,0]=(0.841760617241)*(1+2.*(dim-1.)/(o+1.))+(-1.18631140441)*dim
        ref[0,0,0,1]=(-0.610007337864)*(1+2.*(dim-1.)/(o+1.))+(-1.71451486621)*dim
        ref[0,0,1,0]=(-0.765605897612)*(1+2.*(dim-1.)/(o+1.))+(0.83571459148)*dim
        ref[0,0,1,1]=(-0.128014940891)*(1+2.*(dim-1.)/(o+1.))+(-1.14397157584)*dim
        ref[0,0,2,0]=(-0.969876086955)*(1+2.*(dim-1.)/(o+1.))+(-0.238541556867)*dim
        ref[0,0,2,1]=(-0.434074835341)*(1+2.*(dim-1.)/(o+1.))+(-1.65441946755)*dim
        ref[0,1,0,0]=(0.346878720962)*(1+2.*(dim-1.)/(o+1.))+(-0.722019888602)*dim
        ref[0,1,0,1]=(-0.163332213104)*(1+2.*(dim-1.)/(o+1.))+(-0.135481298717)*dim
        ref[0,1,1,0]=(0.64836517897)*(1+2.*(dim-1.)/(o+1.))+(-0.720330834499)*dim
        ref[0,1,1,1]=(1.50578185724)*(1+2.*(dim-1.)/(o+1.))+(2.13408486278)*dim
        ref[0,1,2,0]=(-1.24719412419)*(1+2.*(dim-1.)/(o+1.))+(0.0927684729819)*dim
        ref[0,1,2,1]=(0.798388744364)*(1+2.*(dim-1.)/(o+1.))+(-1.93130500501)*dim
        ref[0,2,0,0]=(-1.9926882083)*(1+2.*(dim-1.)/(o+1.))+(0.191543055387)*dim
        ref[0,2,0,1]=(-2.16203894433)*(1+2.*(dim-1.)/(o+1.))+(0.824988972246)*dim
        ref[0,2,1,0]=(-2.24934415172)*(1+2.*(dim-1.)/(o+1.))+(-0.263056346511)*dim
        ref[0,2,1,1]=(-0.719152132879)*(1+2.*(dim-1.)/(o+1.))+(-1.00573012142)*dim
        ref[0,2,2,0]=(-0.83751635258)*(1+2.*(dim-1.)/(o+1.))+(0.277097758257)*dim
        ref[0,2,2,1]=(-0.979077481565)*(1+2.*(dim-1.)/(o+1.))+(0.0516269952525)*dim
        ref[0,3,0,0]=(-0.623873484234)*(1+2.*(dim-1.)/(o+1.))+(-0.767010416553)*dim
        ref[0,3,0,1]=(-1.0425822452)*(1+2.*(dim-1.)/(o+1.))+(1.12556988353)*dim
        ref[0,3,1,0]=(0.548600253744)*(1+2.*(dim-1.)/(o+1.))+(0.407341601031)*dim
        ref[0,3,1,1]=(-0.531963828356)*(1+2.*(dim-1.)/(o+1.))+(0.211386892908)*dim
        ref[0,3,2,0]=(1.33006849004)*(1+2.*(dim-1.)/(o+1.))+(-0.681704517735)*dim
        ref[0,3,2,1]=(-1.98393315604)*(1+2.*(dim-1.)/(o+1.))+(0.0385339611081)*dim
        ref[0,4,0,0]=(-0.381511396261)*(1+2.*(dim-1.)/(o+1.))+(-0.991592052336)*dim
        ref[0,4,0,1]=(1.00472425157)*(1+2.*(dim-1.)/(o+1.))+(-1.32537840467)*dim
        ref[0,4,1,0]=(1.04630307783)*(1+2.*(dim-1.)/(o+1.))+(-1.18112274434)*dim
        ref[0,4,1,1]=(1.61731240292)*(1+2.*(dim-1.)/(o+1.))+(1.3676356274)*dim
        ref[0,4,2,0]=(1.41653781097)*(1+2.*(dim-1.)/(o+1.))+(-0.904642036296)*dim
        ref[0,4,2,1]=(1.61515833451)*(1+2.*(dim-1.)/(o+1.))+(0.723377852725)*dim
        ref[1,0,0,0]=(-0.879218635)*(1+2.*(dim-1.)/(o+1.))+(-0.0933709839921)*dim
        ref[1,0,0,1]=(-1.26687353853)*(1+2.*(dim-1.)/(o+1.))+(-0.691850456865)*dim
        ref[1,0,1,0]=(1.79928802103)*(1+2.*(dim-1.)/(o+1.))+(-1.56340519106)*dim
        ref[1,0,1,1]=(-1.05495675007)*(1+2.*(dim-1.)/(o+1.))+(-0.805291631901)*dim
        ref[1,0,2,0]=(-0.339423840638)*(1+2.*(dim-1.)/(o+1.))+(1.93338332178)*dim
        ref[1,0,2,1]=(-1.15347644771)*(1+2.*(dim-1.)/(o+1.))+(-2.47590112686)*dim
        ref[1,1,0,0]=(-1.22232845026)*(1+2.*(dim-1.)/(o+1.))+(0.531263191656)*dim
        ref[1,1,0,1]=(0.318005373727)*(1+2.*(dim-1.)/(o+1.))+(1.92487923823)*dim
        ref[1,1,1,0]=(0.157193055461)*(1+2.*(dim-1.)/(o+1.))+(1.20279429213)*dim
        ref[1,1,1,1]=(0.0525914033484)*(1+2.*(dim-1.)/(o+1.))+(0.0342845343071)*dim
        ref[1,1,2,0]=(-0.319573431275)*(1+2.*(dim-1.)/(o+1.))+(-2.01251884908)*dim
        ref[1,1,2,1]=(-1.67524932091)*(1+2.*(dim-1.)/(o+1.))+(1.16535105313)*dim
        ref[1,2,0,0]=(-2.25088459423)*(1+2.*(dim-1.)/(o+1.))+(-1.25821630594)*dim
        ref[1,2,0,1]=(-0.447759463011)*(1+2.*(dim-1.)/(o+1.))+(-0.214020852139)*dim
        ref[1,2,1,0]=(-1.26590071291)*(1+2.*(dim-1.)/(o+1.))+(0.225628470886)*dim
        ref[1,2,1,1]=(-0.372878924951)*(1+2.*(dim-1.)/(o+1.))+(0.90881205314)*dim
        ref[1,2,2,0]=(1.36047043606)*(1+2.*(dim-1.)/(o+1.))+(-2.40650793373)*dim
        ref[1,2,2,1]=(1.13871462186)*(1+2.*(dim-1.)/(o+1.))+(0.877431872103)*dim
        ref[1,3,0,0]=(-1.17967356605)*(1+2.*(dim-1.)/(o+1.))+(-0.48402392971)*dim
        ref[1,3,0,1]=(-0.177974933247)*(1+2.*(dim-1.)/(o+1.))+(1.56774219607)*dim
        ref[1,3,1,0]=(-1.40936193115)*(1+2.*(dim-1.)/(o+1.))+(-0.844515443034)*dim
        ref[1,3,1,1]=(0.790537554795)*(1+2.*(dim-1.)/(o+1.))+(0.371116004973)*dim
        ref[1,3,2,0]=(0.242057644413)*(1+2.*(dim-1.)/(o+1.))+(-1.5399833831)*dim
        ref[1,3,2,1]=(1.70371239948)*(1+2.*(dim-1.)/(o+1.))+(0.389739262639)*dim
        ref[1,4,0,0]=(-0.375645743677)*(1+2.*(dim-1.)/(o+1.))+(0.387325087595)*dim
        ref[1,4,0,1]=(0.0489286471987)*(1+2.*(dim-1.)/(o+1.))+(1.63006036319)*dim
        ref[1,4,1,0]=(1.33203691786)*(1+2.*(dim-1.)/(o+1.))+(-0.225033015313)*dim
        ref[1,4,1,1]=(0.332297845981)*(1+2.*(dim-1.)/(o+1.))+(0.198587156175)*dim
        ref[1,4,2,0]=(-1.22288078692)*(1+2.*(dim-1.)/(o+1.))+(1.23601170355)*dim
        ref[1,4,2,1]=(0.0299493142028)*(1+2.*(dim-1.)/(o+1.))+(-0.0615592190171)*dim
        ref[2,0,0,0]=(0.0963155205346)*(1+2.*(dim-1.)/(o+1.))+(0.272802412791)*dim
        ref[2,0,0,1]=(1.12280541023)*(1+2.*(dim-1.)/(o+1.))+(-0.420295888105)*dim
        ref[2,0,1,0]=(-0.296878488858)*(1+2.*(dim-1.)/(o+1.))+(0.73165817073)*dim
        ref[2,0,1,1]=(-0.407704337172)*(1+2.*(dim-1.)/(o+1.))+(0.678415268175)*dim
        ref[2,0,2,0]=(-2.37402978977)*(1+2.*(dim-1.)/(o+1.))+(-0.557513810308)*dim
        ref[2,0,2,1]=(1.2564150767)*(1+2.*(dim-1.)/(o+1.))+(-1.12359765672)*dim
        ref[2,1,0,0]=(0.824412811392)*(1+2.*(dim-1.)/(o+1.))+(1.94675019637)*dim
        ref[2,1,0,1]=(-1.06505178789)*(1+2.*(dim-1.)/(o+1.))+(-1.11378381126)*dim
        ref[2,1,1,0]=(0.200096305752)*(1+2.*(dim-1.)/(o+1.))+(0.569218008012)*dim
        ref[2,1,1,1]=(1.08680720067)*(1+2.*(dim-1.)/(o+1.))+(-0.311247182096)*dim
        ref[2,1,2,0]=(1.3764914842)*(1+2.*(dim-1.)/(o+1.))+(1.31498712883)*dim
        ref[2,1,2,1]=(2.26537199157)*(1+2.*(dim-1.)/(o+1.))+(0.864923796858)*dim
        ref[2,2,0,0]=(0.750025182887)*(1+2.*(dim-1.)/(o+1.))+(-0.563810375913)*dim
        ref[2,2,0,1]=(-0.806933575047)*(1+2.*(dim-1.)/(o+1.))+(-0.228955678184)*dim
        ref[2,2,1,0]=(-1.53132620021)*(1+2.*(dim-1.)/(o+1.))+(0.14242982428)*dim
        ref[2,2,1,1]=(-0.889411443106)*(1+2.*(dim-1.)/(o+1.))+(-0.570162511538)*dim
        ref[2,2,2,0]=(-0.0309717316948)*(1+2.*(dim-1.)/(o+1.))+(1.4340168153)*dim
        ref[2,2,2,1]=(1.48963237375)*(1+2.*(dim-1.)/(o+1.))+(0.0470787769518)*dim
        ref[2,3,0,0]=(-0.0184174113004)*(1+2.*(dim-1.)/(o+1.))+(-0.620652189349)*dim
        ref[2,3,0,1]=(0.597433991421)*(1+2.*(dim-1.)/(o+1.))+(0.773998617557)*dim
        ref[2,3,1,0]=(-1.10704622688)*(1+2.*(dim-1.)/(o+1.))+(-1.34479670251)*dim
        ref[2,3,1,1]=(-0.369209798891)*(1+2.*(dim-1.)/(o+1.))+(-1.85369919864)*dim
        ref[2,3,2,0]=(-0.286165609161)*(1+2.*(dim-1.)/(o+1.))+(0.954607193175)*dim
        ref[2,3,2,1]=(-0.0948450773617)*(1+2.*(dim-1.)/(o+1.))+(-1.40871482316)*dim
        ref[2,4,0,0]=(-0.350521344827)*(1+2.*(dim-1.)/(o+1.))+(-0.180085766391)*dim
        ref[2,4,0,1]=(-1.10948105015)*(1+2.*(dim-1.)/(o+1.))+(0.0595746783013)*dim
        ref[2,4,1,0]=(-0.251521967553)*(1+2.*(dim-1.)/(o+1.))+(-0.592765061514)*dim
        ref[2,4,1,1]=(-2.22732408506)*(1+2.*(dim-1.)/(o+1.))+(-0.813809172329)*dim
        ref[2,4,2,0]=(-1.4091057051)*(1+2.*(dim-1.)/(o+1.))+(2.64669188252)*dim
        ref[2,4,2,1]=(-0.0262518153279)*(1+2.*(dim-1.)/(o+1.))+(1.34343075804)*dim
        ref[3,0,0,0]=(2.08524442815)*(1+2.*(dim-1.)/(o+1.))+(-0.602928292982)*dim
        ref[3,0,0,1]=(0.227442743255)*(1+2.*(dim-1.)/(o+1.))+(1.19135776442)*dim
        ref[3,0,1,0]=(1.03371796145)*(1+2.*(dim-1.)/(o+1.))+(-1.03073515087)*dim
        ref[3,0,1,1]=(0.205903763449)*(1+2.*(dim-1.)/(o+1.))+(1.4651429667)*dim
        ref[3,0,2,0]=(1.54387435524)*(1+2.*(dim-1.)/(o+1.))+(-0.957161046404)*dim
        ref[3,0,2,1]=(-0.487693556268)*(1+2.*(dim-1.)/(o+1.))+(-0.504725375232)*dim
        ref[3,1,0,0]=(0.319450917291)*(1+2.*(dim-1.)/(o+1.))+(-0.958071400411)*dim
        ref[3,1,0,1]=(-0.0756676477654)*(1+2.*(dim-1.)/(o+1.))+(-0.929658636049)*dim
        ref[3,1,1,0]=(0.0109030665653)*(1+2.*(dim-1.)/(o+1.))+(0.692693723343)*dim
        ref[3,1,1,1]=(0.540904091106)*(1+2.*(dim-1.)/(o+1.))+(-0.994960230569)*dim
        ref[3,1,2,0]=(-1.39229945953)*(1+2.*(dim-1.)/(o+1.))+(-1.4113311628)*dim
        ref[3,1,2,1]=(-0.120906779216)*(1+2.*(dim-1.)/(o+1.))+(-0.342051809366)*dim
        ref[3,2,0,0]=(-0.61477618653)*(1+2.*(dim-1.)/(o+1.))+(0.178917859873)*dim
        ref[3,2,0,1]=(0.286238606318)*(1+2.*(dim-1.)/(o+1.))+(-0.0466390555654)*dim
        ref[3,2,1,0]=(-0.0560560726323)*(1+2.*(dim-1.)/(o+1.))+(-0.305975529033)*dim
        ref[3,2,1,1]=(0.935166077059)*(1+2.*(dim-1.)/(o+1.))+(-0.884762617288)*dim
        ref[3,2,2,0]=(0.57015079501)*(1+2.*(dim-1.)/(o+1.))+(-2.14138354655)*dim
        ref[3,2,2,1]=(-0.699470490706)*(1+2.*(dim-1.)/(o+1.))+(0.672222147932)*dim
        ref[3,3,0,0]=(1.33431543118)*(1+2.*(dim-1.)/(o+1.))+(-0.448557066912)*dim
        ref[3,3,0,1]=(-1.03724498716)*(1+2.*(dim-1.)/(o+1.))+(1.52541255729)*dim
        ref[3,3,1,0]=(-0.00371131395733)*(1+2.*(dim-1.)/(o+1.))+(0.974655010698)*dim
        ref[3,3,1,1]=(0.0918410742793)*(1+2.*(dim-1.)/(o+1.))+(0.0508418750519)*dim
        ref[3,3,2,0]=(1.63372857769)*(1+2.*(dim-1.)/(o+1.))+(0.121263380706)*dim
        ref[3,3,2,1]=(0.761569446324)*(1+2.*(dim-1.)/(o+1.))+(0.943853210019)*dim
        ref[3,4,0,0]=(-0.625751279162)*(1+2.*(dim-1.)/(o+1.))+(-0.000808162076656)*dim
        ref[3,4,0,1]=(-0.113324890356)*(1+2.*(dim-1.)/(o+1.))+(-0.0211281790319)*dim
        ref[3,4,1,0]=(0.296144237506)*(1+2.*(dim-1.)/(o+1.))+(-0.470246132989)*dim
        ref[3,4,1,1]=(0.194264324372)*(1+2.*(dim-1.)/(o+1.))+(-0.0590405157015)*dim
        ref[3,4,2,0]=(1.63851379122)*(1+2.*(dim-1.)/(o+1.))+(-0.192978025203)*dim
        ref[3,4,2,1]=(-0.757374882295)*(1+2.*(dim-1.)/(o+1.))+(-1.15353478672)*dim
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_FunctionOnBoundary_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.626062912046)*x[0]**o+(0.600712856149)*x[0]+(0.0478861882442)*x[1]**o+(0.77008552734)*x[1]
        ref=(0.67394910029)*(1+2.*(dim-1.)/(o+1.))+(1.37079838349)*dim
      else:
        arg=(0.85588880126)*x[0]**o+(-0.898804533462)*x[0]+(-0.270816921088)*x[1]**o+(-0.842823912373)*x[1]+(-0.47559690762)*x[2]**o+(0.751770125129)*x[2]
        ref=(0.109474972552)*(1+2.*(dim-1.)/(o+1.))+(-0.989858320706)*dim
      res=integrate(arg)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_FunctionOnBoundary_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.298913063662)*x[0]**o+(-0.250822875451)*x[0]+(0.707311253225)*x[1]**o+(0.0408091445557)*x[1]
        arg[1]=(-0.70143850042)*x[0]**o+(-0.80121227022)*x[0]+(0.0731514590408)*x[1]**o+(0.621969876113)*x[1]
        ref[0]=(1.00622431689)*(1+2.*(dim-1.)/(o+1.))+(-0.210013730895)*dim
        ref[1]=(-0.628287041379)*(1+2.*(dim-1.)/(o+1.))+(-0.179242394108)*dim
      else:
        arg[0]=(0.676976938336)*x[0]**o+(-0.928207054947)*x[0]+(0.864749399199)*x[1]**o+(0.864358390848)*x[1]+(-0.0255569869984)*x[2]**o+(0.0268536872793)*x[2]
        arg[1]=(0.270542056965)*x[0]**o+(0.0696194435081)*x[0]+(0.401360001043)*x[1]**o+(0.917064528874)*x[1]+(-0.755510144559)*x[2]**o+(0.881244515908)*x[2]
        ref[0]=(1.51616935054)*(1+2.*(dim-1.)/(o+1.))+(-0.0369949768193)*dim
        ref[1]=(-0.083608086551)*(1+2.*(dim-1.)/(o+1.))+(1.86792848829)*dim
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_FunctionOnBoundary_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.381843423534)*x[0]**o+(-0.563210012057)*x[0]+(0.730631055205)*x[1]**o+(0.13636238698)*x[1]
        arg[0,1]=(0.306357653338)*x[0]**o+(-0.797201232101)*x[0]+(-0.66333793372)*x[1]**o+(-0.943650360464)*x[1]
        arg[0,2]=(-0.34058649734)*x[0]**o+(-0.27047792232)*x[0]+(0.57156687267)*x[1]**o+(-0.659114355468)*x[1]
        arg[0,3]=(0.73319004289)*x[0]**o+(0.229139540294)*x[0]+(-0.51558765225)*x[1]**o+(0.45052521066)*x[1]
        arg[0,4]=(-0.264117198359)*x[0]**o+(0.807950109095)*x[0]+(-0.290558748289)*x[1]**o+(0.161864708045)*x[1]
        arg[1,0]=(0.988732415297)*x[0]**o+(-0.725047414136)*x[0]+(-0.722337599885)*x[1]**o+(0.739130135256)*x[1]
        arg[1,1]=(-0.315086233906)*x[0]**o+(-0.783177846939)*x[0]+(-0.271931454399)*x[1]**o+(-0.935744613016)*x[1]
        arg[1,2]=(-0.787047622811)*x[0]**o+(0.00746242211892)*x[0]+(-0.539716273578)*x[1]**o+(-0.340449115622)*x[1]
        arg[1,3]=(-0.782830405823)*x[0]**o+(0.842318742811)*x[0]+(-0.118894493096)*x[1]**o+(0.645943277412)*x[1]
        arg[1,4]=(0.0594068367647)*x[0]**o+(-0.184711682975)*x[0]+(-0.0643050731295)*x[1]**o+(-0.981593287261)*x[1]
        arg[2,0]=(0.17170754931)*x[0]**o+(0.582651363494)*x[0]+(0.334422749985)*x[1]**o+(0.852747429144)*x[1]
        arg[2,1]=(0.683967516208)*x[0]**o+(-0.612989314204)*x[0]+(0.845175135723)*x[1]**o+(0.374223395314)*x[1]
        arg[2,2]=(0.588917536035)*x[0]**o+(0.0130713873939)*x[0]+(0.881942872071)*x[1]**o+(0.683941046151)*x[1]
        arg[2,3]=(-0.63861264887)*x[0]**o+(0.453919752415)*x[0]+(0.448731342326)*x[1]**o+(-0.259183783496)*x[1]
        arg[2,4]=(-0.132175638549)*x[0]**o+(0.710071566415)*x[0]+(-0.870119332524)*x[1]**o+(0.523394538403)*x[1]
        arg[3,0]=(0.768036036634)*x[0]**o+(-0.218321673662)*x[0]+(0.50224512768)*x[1]**o+(0.694191572559)*x[1]
        arg[3,1]=(-0.298369075336)*x[0]**o+(-0.276776010079)*x[0]+(-0.659309162004)*x[1]**o+(0.436841182692)*x[1]
        arg[3,2]=(-0.00370049871499)*x[0]**o+(-0.41700259949)*x[0]+(0.726806931339)*x[1]**o+(-0.113165181924)*x[1]
        arg[3,3]=(0.288175924931)*x[0]**o+(-0.489667003521)*x[0]+(-0.531842953651)*x[1]**o+(-0.443517285929)*x[1]
        arg[3,4]=(-0.645574931589)*x[0]**o+(0.464738749544)*x[0]+(-0.538213524368)*x[1]**o+(-0.94443292146)*x[1]
        ref[0,0]=(0.348787631671)*(1+2.*(dim-1.)/(o+1.))+(-0.426847625077)*dim
        ref[0,1]=(-0.356980280382)*(1+2.*(dim-1.)/(o+1.))+(-1.74085159257)*dim
        ref[0,2]=(0.23098037533)*(1+2.*(dim-1.)/(o+1.))+(-0.929592277787)*dim
        ref[0,3]=(0.21760239064)*(1+2.*(dim-1.)/(o+1.))+(0.679664750954)*dim
        ref[0,4]=(-0.554675946648)*(1+2.*(dim-1.)/(o+1.))+(0.96981481714)*dim
        ref[1,0]=(0.266394815412)*(1+2.*(dim-1.)/(o+1.))+(0.0140827211195)*dim
        ref[1,1]=(-0.587017688304)*(1+2.*(dim-1.)/(o+1.))+(-1.71892245996)*dim
        ref[1,2]=(-1.32676389639)*(1+2.*(dim-1.)/(o+1.))+(-0.332986693503)*dim
        ref[1,3]=(-0.901724898919)*(1+2.*(dim-1.)/(o+1.))+(1.48826202022)*dim
        ref[1,4]=(-0.00489823636486)*(1+2.*(dim-1.)/(o+1.))+(-1.16630497024)*dim
        ref[2,0]=(0.506130299295)*(1+2.*(dim-1.)/(o+1.))+(1.43539879264)*dim
        ref[2,1]=(1.52914265193)*(1+2.*(dim-1.)/(o+1.))+(-0.238765918889)*dim
        ref[2,2]=(1.47086040811)*(1+2.*(dim-1.)/(o+1.))+(0.697012433545)*dim
        ref[2,3]=(-0.189881306544)*(1+2.*(dim-1.)/(o+1.))+(0.194735968919)*dim
        ref[2,4]=(-1.00229497107)*(1+2.*(dim-1.)/(o+1.))+(1.23346610482)*dim
        ref[3,0]=(1.27028116431)*(1+2.*(dim-1.)/(o+1.))+(0.475869898897)*dim
        ref[3,1]=(-0.957678237339)*(1+2.*(dim-1.)/(o+1.))+(0.160065172613)*dim
        ref[3,2]=(0.723106432624)*(1+2.*(dim-1.)/(o+1.))+(-0.530167781414)*dim
        ref[3,3]=(-0.243667028719)*(1+2.*(dim-1.)/(o+1.))+(-0.93318428945)*dim
        ref[3,4]=(-1.18378845596)*(1+2.*(dim-1.)/(o+1.))+(-0.479694171917)*dim
      else:
        arg[0,0]=(0.751222317885)*x[0]**o+(0.953666267123)*x[0]+(-0.707417048158)*x[1]**o+(0.310686543483)*x[1]+(0.326267797641)*x[2]**o+(-0.722772500437)*x[2]
        arg[0,1]=(-0.038709086264)*x[0]**o+(-0.483307819428)*x[0]+(0.611120835303)*x[1]**o+(0.885935954604)*x[1]+(0.630199910046)*x[2]**o+(-0.101764126615)*x[2]
        arg[0,2]=(0.890606731439)*x[0]**o+(-0.0555491679283)*x[0]+(0.334835177686)*x[1]**o+(0.999030888839)*x[1]+(-0.891653525154)*x[2]**o+(-0.14056280616)*x[2]
        arg[0,3]=(-0.458305223634)*x[0]**o+(0.679075077126)*x[0]+(0.1176620176)*x[1]**o+(0.685223087684)*x[1]+(-0.952262623464)*x[2]**o+(-0.905568306628)*x[2]
        arg[0,4]=(0.623179050934)*x[0]**o+(-0.0150847487218)*x[0]+(0.0823495403769)*x[1]**o+(0.48303169009)*x[1]+(0.610276253905)*x[2]**o+(0.353104308072)*x[2]
        arg[1,0]=(-0.709185342895)*x[0]**o+(0.789980598884)*x[0]+(0.655538102878)*x[1]**o+(0.713913568814)*x[1]+(0.222131732773)*x[2]**o+(0.712644729381)*x[2]
        arg[1,1]=(-0.683646421822)*x[0]**o+(-0.943691516528)*x[0]+(-0.134261002557)*x[1]**o+(0.28225941018)*x[1]+(0.906235993779)*x[2]**o+(-0.819214603609)*x[2]
        arg[1,2]=(0.713781993938)*x[0]**o+(-0.189551367619)*x[0]+(-0.021310841804)*x[1]**o+(-0.873466428012)*x[1]+(0.248337664546)*x[2]**o+(0.911824874935)*x[2]
        arg[1,3]=(-0.393142772637)*x[0]**o+(0.773501237865)*x[0]+(0.759039429922)*x[1]**o+(0.67036876499)*x[1]+(-0.921411979023)*x[2]**o+(-0.649371534276)*x[2]
        arg[1,4]=(0.526708082723)*x[0]**o+(-0.522449586718)*x[0]+(0.951176548558)*x[1]**o+(0.604602039898)*x[1]+(0.345888192325)*x[2]**o+(-0.973729954334)*x[2]
        arg[2,0]=(-0.139931215293)*x[0]**o+(-0.996072915638)*x[0]+(-0.0451731431264)*x[1]**o+(0.433694224874)*x[1]+(-0.955189760302)*x[2]**o+(-0.68361667242)*x[2]
        arg[2,1]=(0.139626552661)*x[0]**o+(-0.91217468751)*x[0]+(-0.854252204911)*x[1]**o+(0.417539913464)*x[1]+(0.557096050124)*x[2]**o+(-0.195272359868)*x[2]
        arg[2,2]=(0.960352725049)*x[0]**o+(0.98274500341)*x[0]+(0.967782565025)*x[1]**o+(0.566011353381)*x[1]+(0.583885094583)*x[2]**o+(-0.943173847936)*x[2]
        arg[2,3]=(0.959388333494)*x[0]**o+(0.531908797155)*x[0]+(-0.62531126203)*x[1]**o+(-0.288763293646)*x[1]+(-0.823398780526)*x[2]**o+(-0.164348871248)*x[2]
        arg[2,4]=(0.73397702179)*x[0]**o+(0.407844592399)*x[0]+(-0.835769355727)*x[1]**o+(0.742360626394)*x[1]+(0.31130186529)*x[2]**o+(0.114221168872)*x[2]
        arg[3,0]=(-0.42278940444)*x[0]**o+(-0.513158064442)*x[0]+(-0.133233894233)*x[1]**o+(0.701381913887)*x[1]+(0.283776333553)*x[2]**o+(-0.805096661642)*x[2]
        arg[3,1]=(-0.417338508269)*x[0]**o+(0.535961900783)*x[0]+(0.0836386907734)*x[1]**o+(0.449680928704)*x[1]+(0.998998322868)*x[2]**o+(0.983057825698)*x[2]
        arg[3,2]=(0.24102382276)*x[0]**o+(0.0291470157398)*x[0]+(-0.539542451698)*x[1]**o+(0.281017043631)*x[1]+(-0.464652133499)*x[2]**o+(0.652828720185)*x[2]
        arg[3,3]=(-0.482577920013)*x[0]**o+(0.931756756394)*x[0]+(0.96648206338)*x[1]**o+(0.73941459549)*x[1]+(0.136743015429)*x[2]**o+(0.41477914722)*x[2]
        arg[3,4]=(0.879881885972)*x[0]**o+(0.208970079585)*x[0]+(-0.200079958414)*x[1]**o+(-0.0291238772241)*x[1]+(-0.333569505857)*x[2]**o+(0.846835729875)*x[2]
        ref[0,0]=(0.370073067368)*(1+2.*(dim-1.)/(o+1.))+(0.541580310169)*dim
        ref[0,1]=(1.20261165909)*(1+2.*(dim-1.)/(o+1.))+(0.300864008561)*dim
        ref[0,2]=(0.333788383971)*(1+2.*(dim-1.)/(o+1.))+(0.80291891475)*dim
        ref[0,3]=(-1.2929058295)*(1+2.*(dim-1.)/(o+1.))+(0.458729858183)*dim
        ref[0,4]=(1.31580484522)*(1+2.*(dim-1.)/(o+1.))+(0.82105124944)*dim
        ref[1,0]=(0.168484492756)*(1+2.*(dim-1.)/(o+1.))+(2.21653889708)*dim
        ref[1,1]=(0.0883285694004)*(1+2.*(dim-1.)/(o+1.))+(-1.48064670996)*dim
        ref[1,2]=(0.940808816681)*(1+2.*(dim-1.)/(o+1.))+(-0.151192920696)*dim
        ref[1,3]=(-0.555515321739)*(1+2.*(dim-1.)/(o+1.))+(0.79449846858)*dim
        ref[1,4]=(1.82377282361)*(1+2.*(dim-1.)/(o+1.))+(-0.891577501154)*dim
        ref[2,0]=(-1.14029411872)*(1+2.*(dim-1.)/(o+1.))+(-1.24599536318)*dim
        ref[2,1]=(-0.157529602127)*(1+2.*(dim-1.)/(o+1.))+(-0.689907133913)*dim
        ref[2,2]=(2.51202038466)*(1+2.*(dim-1.)/(o+1.))+(0.605582508855)*dim
        ref[2,3]=(-0.489321709063)*(1+2.*(dim-1.)/(o+1.))+(0.0787966322607)*dim
        ref[2,4]=(0.209509531353)*(1+2.*(dim-1.)/(o+1.))+(1.26442638766)*dim
        ref[3,0]=(-0.27224696512)*(1+2.*(dim-1.)/(o+1.))+(-0.616872812198)*dim
        ref[3,1]=(0.665298505372)*(1+2.*(dim-1.)/(o+1.))+(1.96870065519)*dim
        ref[3,2]=(-0.763170762437)*(1+2.*(dim-1.)/(o+1.))+(0.962992779555)*dim
        ref[3,3]=(0.620647158797)*(1+2.*(dim-1.)/(o+1.))+(2.0859504991)*dim
        ref[3,4]=(0.346232421701)*(1+2.*(dim-1.)/(o+1.))+(1.02668193224)*dim
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_FunctionOnBoundary_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(0.201115186772)*x[0]**o+(0.324758103748)*x[0]+(0.285065583242)*x[1]**o+(0.0264985832782)*x[1]
        arg[0,0,1]=(-0.443023003973)*x[0]**o+(-0.194732927607)*x[0]+(0.64414908519)*x[1]**o+(-0.248261857779)*x[1]
        arg[0,1,0]=(0.587534172195)*x[0]**o+(0.021088951369)*x[0]+(-0.986195557459)*x[1]**o+(0.595659005312)*x[1]
        arg[0,1,1]=(-0.916961145134)*x[0]**o+(-0.766484469605)*x[0]+(-0.281345964683)*x[1]**o+(-0.399113856826)*x[1]
        arg[1,0,0]=(0.175943424949)*x[0]**o+(0.344853386001)*x[0]+(0.175474681848)*x[1]**o+(-0.0775102874697)*x[1]
        arg[1,0,1]=(-0.874074467007)*x[0]**o+(0.903506914387)*x[0]+(0.177699372538)*x[1]**o+(0.969818154968)*x[1]
        arg[1,1,0]=(0.765751472387)*x[0]**o+(-0.0288724203687)*x[0]+(0.655676828008)*x[1]**o+(0.22281307247)*x[1]
        arg[1,1,1]=(0.871009077152)*x[0]**o+(-0.20052353101)*x[0]+(-0.889496767621)*x[1]**o+(0.8458762887)*x[1]
        arg[2,0,0]=(-0.15377513542)*x[0]**o+(0.963714892768)*x[0]+(0.942514815983)*x[1]**o+(0.846111018838)*x[1]
        arg[2,0,1]=(0.000727086938663)*x[0]**o+(0.243136987492)*x[0]+(-0.308674899886)*x[1]**o+(-0.963435664436)*x[1]
        arg[2,1,0]=(0.780912245051)*x[0]**o+(0.227139041778)*x[0]+(-0.336203258384)*x[1]**o+(0.092568284679)*x[1]
        arg[2,1,1]=(0.0464862681168)*x[0]**o+(0.284493375176)*x[0]+(-0.811073509077)*x[1]**o+(0.54280235419)*x[1]
        arg[3,0,0]=(0.605642304612)*x[0]**o+(-0.103442921567)*x[0]+(0.106253324829)*x[1]**o+(0.562480007904)*x[1]
        arg[3,0,1]=(0.497668538008)*x[0]**o+(-0.859679982844)*x[0]+(-0.255499355194)*x[1]**o+(0.0725919239243)*x[1]
        arg[3,1,0]=(0.641826893201)*x[0]**o+(0.889514581887)*x[0]+(-0.211781857836)*x[1]**o+(0.45900873193)*x[1]
        arg[3,1,1]=(-0.29349600565)*x[0]**o+(-0.627542961817)*x[0]+(0.313009642686)*x[1]**o+(0.338028134809)*x[1]
        arg[4,0,0]=(-0.641915241397)*x[0]**o+(-0.682547311604)*x[0]+(-0.106472077451)*x[1]**o+(0.103402239052)*x[1]
        arg[4,0,1]=(-0.822562520978)*x[0]**o+(-0.430539530156)*x[0]+(-0.0225528898923)*x[1]**o+(-0.0908986665674)*x[1]
        arg[4,1,0]=(-0.456160645978)*x[0]**o+(-0.264592336242)*x[0]+(-0.672702978868)*x[1]**o+(-0.893197955639)*x[1]
        arg[4,1,1]=(-0.714689169676)*x[0]**o+(0.513612105215)*x[0]+(-0.3093340377)*x[1]**o+(-0.34467035156)*x[1]
        arg[5,0,0]=(-0.993761664154)*x[0]**o+(0.375953817044)*x[0]+(0.0463240503072)*x[1]**o+(-0.595646829466)*x[1]
        arg[5,0,1]=(0.453145186545)*x[0]**o+(0.331353840672)*x[0]+(-0.908533078632)*x[1]**o+(0.755175839674)*x[1]
        arg[5,1,0]=(-0.736874540101)*x[0]**o+(-0.867437170846)*x[0]+(-0.472395301622)*x[1]**o+(0.78289019661)*x[1]
        arg[5,1,1]=(-0.900966156016)*x[0]**o+(-0.160363876891)*x[0]+(-0.0969222200475)*x[1]**o+(0.0527983470624)*x[1]
        ref[0,0,0]=(0.486180770014)*(1+2.*(dim-1.)/(o+1.))+(0.351256687026)*dim
        ref[0,0,1]=(0.201126081217)*(1+2.*(dim-1.)/(o+1.))+(-0.442994785386)*dim
        ref[0,1,0]=(-0.398661385264)*(1+2.*(dim-1.)/(o+1.))+(0.616747956681)*dim
        ref[0,1,1]=(-1.19830710982)*(1+2.*(dim-1.)/(o+1.))+(-1.16559832643)*dim
        ref[1,0,0]=(0.351418106797)*(1+2.*(dim-1.)/(o+1.))+(0.267343098531)*dim
        ref[1,0,1]=(-0.696375094469)*(1+2.*(dim-1.)/(o+1.))+(1.87332506936)*dim
        ref[1,1,0]=(1.42142830039)*(1+2.*(dim-1.)/(o+1.))+(0.193940652101)*dim
        ref[1,1,1]=(-0.0184876904693)*(1+2.*(dim-1.)/(o+1.))+(0.64535275769)*dim
        ref[2,0,0]=(0.788739680562)*(1+2.*(dim-1.)/(o+1.))+(1.80982591161)*dim
        ref[2,0,1]=(-0.307947812947)*(1+2.*(dim-1.)/(o+1.))+(-0.720298676944)*dim
        ref[2,1,0]=(0.444708986667)*(1+2.*(dim-1.)/(o+1.))+(0.319707326457)*dim
        ref[2,1,1]=(-0.76458724096)*(1+2.*(dim-1.)/(o+1.))+(0.827295729366)*dim
        ref[3,0,0]=(0.711895629441)*(1+2.*(dim-1.)/(o+1.))+(0.459037086337)*dim
        ref[3,0,1]=(0.242169182814)*(1+2.*(dim-1.)/(o+1.))+(-0.78708805892)*dim
        ref[3,1,0]=(0.430045035365)*(1+2.*(dim-1.)/(o+1.))+(1.34852331382)*dim
        ref[3,1,1]=(0.019513637036)*(1+2.*(dim-1.)/(o+1.))+(-0.289514827008)*dim
        ref[4,0,0]=(-0.748387318848)*(1+2.*(dim-1.)/(o+1.))+(-0.579145072551)*dim
        ref[4,0,1]=(-0.845115410871)*(1+2.*(dim-1.)/(o+1.))+(-0.521438196723)*dim
        ref[4,1,0]=(-1.12886362485)*(1+2.*(dim-1.)/(o+1.))+(-1.15779029188)*dim
        ref[4,1,1]=(-1.02402320738)*(1+2.*(dim-1.)/(o+1.))+(0.168941753655)*dim
        ref[5,0,0]=(-0.947437613847)*(1+2.*(dim-1.)/(o+1.))+(-0.219693012422)*dim
        ref[5,0,1]=(-0.455387892087)*(1+2.*(dim-1.)/(o+1.))+(1.08652968035)*dim
        ref[5,1,0]=(-1.20926984172)*(1+2.*(dim-1.)/(o+1.))+(-0.0845469742352)*dim
        ref[5,1,1]=(-0.997888376064)*(1+2.*(dim-1.)/(o+1.))+(-0.107565529828)*dim
      else:
        arg[0,0,0]=(-0.760764230601)*x[0]**o+(-0.955215307904)*x[0]+(0.376251560231)*x[1]**o+(0.147849416477)*x[1]+(0.627037741745)*x[2]**o+(-0.93996244415)*x[2]
        arg[0,0,1]=(0.904449671196)*x[0]**o+(-0.297804849063)*x[0]+(0.773059038176)*x[1]**o+(-0.836104534497)*x[1]+(-0.150040994258)*x[2]**o+(0.837988726131)*x[2]
        arg[0,1,0]=(0.354255190058)*x[0]**o+(0.463977999833)*x[0]+(0.218855388406)*x[1]**o+(-0.163086423536)*x[1]+(0.653790071045)*x[2]**o+(-0.457721486689)*x[2]
        arg[0,1,1]=(0.357317871424)*x[0]**o+(-0.752862019242)*x[0]+(0.674187130836)*x[1]**o+(-0.983503125785)*x[1]+(-0.776153051078)*x[2]**o+(0.390700377058)*x[2]
        arg[1,0,0]=(-0.465423805042)*x[0]**o+(0.629855541232)*x[0]+(-0.405300083887)*x[1]**o+(-0.211254598072)*x[1]+(0.502581881406)*x[2]**o+(-0.853779249469)*x[2]
        arg[1,0,1]=(0.716025450344)*x[0]**o+(0.876021396077)*x[0]+(-0.530324190586)*x[1]**o+(0.700207449985)*x[1]+(-0.788565669024)*x[2]**o+(0.963118484198)*x[2]
        arg[1,1,0]=(0.813943574582)*x[0]**o+(-0.938778607938)*x[0]+(-0.451619613547)*x[1]**o+(-0.916990884105)*x[1]+(-0.671730738367)*x[2]**o+(0.109664560689)*x[2]
        arg[1,1,1]=(-0.557598711518)*x[0]**o+(-0.541691706474)*x[0]+(0.500874328683)*x[1]**o+(-0.959653364589)*x[1]+(0.572057415183)*x[2]**o+(-0.842306660222)*x[2]
        arg[2,0,0]=(0.0470537168687)*x[0]**o+(-0.151521222488)*x[0]+(0.168279496456)*x[1]**o+(0.869948894317)*x[1]+(-0.554196665086)*x[2]**o+(0.444189090676)*x[2]
        arg[2,0,1]=(-0.662480394662)*x[0]**o+(0.506778773041)*x[0]+(0.664368833417)*x[1]**o+(-0.76728005759)*x[1]+(0.729668063743)*x[2]**o+(-0.476499535761)*x[2]
        arg[2,1,0]=(0.40405640406)*x[0]**o+(0.537691275434)*x[0]+(0.675845932799)*x[1]**o+(-0.663037107454)*x[1]+(-0.947246204559)*x[2]**o+(-0.210977364198)*x[2]
        arg[2,1,1]=(-0.460999541334)*x[0]**o+(-0.403551870206)*x[0]+(-0.59751233801)*x[1]**o+(0.389018763902)*x[1]+(-0.916883519483)*x[2]**o+(0.712714107738)*x[2]
        arg[3,0,0]=(-0.547139864054)*x[0]**o+(0.91774354334)*x[0]+(-0.953248927323)*x[1]**o+(0.693673610785)*x[1]+(-0.474082903895)*x[2]**o+(0.187174904886)*x[2]
        arg[3,0,1]=(0.538597533339)*x[0]**o+(0.903368885629)*x[0]+(-0.548058780044)*x[1]**o+(-0.380406303455)*x[1]+(-0.389244091021)*x[2]**o+(0.137402766164)*x[2]
        arg[3,1,0]=(-0.11691167078)*x[0]**o+(-0.812294829383)*x[0]+(0.592192015269)*x[1]**o+(-0.3278056345)*x[1]+(-0.60462640896)*x[2]**o+(-0.701541632465)*x[2]
        arg[3,1,1]=(-0.196382907034)*x[0]**o+(-0.496234735923)*x[0]+(-0.646502033751)*x[1]**o+(-0.18981379172)*x[1]+(0.627608199527)*x[2]**o+(-0.468659552408)*x[2]
        arg[4,0,0]=(0.56789650708)*x[0]**o+(0.854984079971)*x[0]+(-0.641473205573)*x[1]**o+(-0.791240666887)*x[1]+(0.453562162212)*x[2]**o+(0.849111318036)*x[2]
        arg[4,0,1]=(0.90836228457)*x[0]**o+(-0.666684673376)*x[0]+(0.245928632693)*x[1]**o+(0.313580017685)*x[1]+(0.353126203728)*x[2]**o+(0.467530918033)*x[2]
        arg[4,1,0]=(0.670926585272)*x[0]**o+(0.768555336283)*x[0]+(-0.170656824353)*x[1]**o+(-0.346425800834)*x[1]+(-0.969641886683)*x[2]**o+(0.775335418066)*x[2]
        arg[4,1,1]=(-0.152500967035)*x[0]**o+(0.575400101502)*x[0]+(0.901331752685)*x[1]**o+(-0.672576642993)*x[1]+(0.803176375377)*x[2]**o+(0.202785337179)*x[2]
        arg[5,0,0]=(-0.798851736802)*x[0]**o+(-0.221276048656)*x[0]+(0.773295190339)*x[1]**o+(0.0903112854292)*x[1]+(0.884961364642)*x[2]**o+(0.326429585537)*x[2]
        arg[5,0,1]=(0.482124059007)*x[0]**o+(-0.39227677557)*x[0]+(-0.23074922677)*x[1]**o+(0.986783507045)*x[1]+(0.591759402442)*x[2]**o+(-0.680278617308)*x[2]
        arg[5,1,0]=(-0.857456972644)*x[0]**o+(-0.200661025977)*x[0]+(-0.850031395341)*x[1]**o+(0.830863037447)*x[1]+(-0.323765625026)*x[2]**o+(-0.969463605839)*x[2]
        arg[5,1,1]=(-0.582538216697)*x[0]**o+(-0.495303456972)*x[0]+(0.0134139524699)*x[1]**o+(-0.750144603651)*x[1]+(-0.632380446311)*x[2]**o+(0.38782755017)*x[2]
        ref[0,0,0]=(0.242525071375)*(1+2.*(dim-1.)/(o+1.))+(-1.74732833558)*dim
        ref[0,0,1]=(1.52746771511)*(1+2.*(dim-1.)/(o+1.))+(-0.295920657428)*dim
        ref[0,1,0]=(1.22690064951)*(1+2.*(dim-1.)/(o+1.))+(-0.156829910392)*dim
        ref[0,1,1]=(0.255351951182)*(1+2.*(dim-1.)/(o+1.))+(-1.34566476797)*dim
        ref[1,0,0]=(-0.368142007523)*(1+2.*(dim-1.)/(o+1.))+(-0.43517830631)*dim
        ref[1,0,1]=(-0.602864409266)*(1+2.*(dim-1.)/(o+1.))+(2.53934733026)*dim
        ref[1,1,0]=(-0.309406777332)*(1+2.*(dim-1.)/(o+1.))+(-1.74610493135)*dim
        ref[1,1,1]=(0.515333032348)*(1+2.*(dim-1.)/(o+1.))+(-2.34365173129)*dim
        ref[2,0,0]=(-0.338863451761)*(1+2.*(dim-1.)/(o+1.))+(1.16261676251)*dim
        ref[2,0,1]=(0.731556502498)*(1+2.*(dim-1.)/(o+1.))+(-0.73700082031)*dim
        ref[2,1,0]=(0.132656132299)*(1+2.*(dim-1.)/(o+1.))+(-0.336323196217)*dim
        ref[2,1,1]=(-1.97539539883)*(1+2.*(dim-1.)/(o+1.))+(0.698181001434)*dim
        ref[3,0,0]=(-1.97447169527)*(1+2.*(dim-1.)/(o+1.))+(1.79859205901)*dim
        ref[3,0,1]=(-0.398705337727)*(1+2.*(dim-1.)/(o+1.))+(0.660365348338)*dim
        ref[3,1,0]=(-0.129346064471)*(1+2.*(dim-1.)/(o+1.))+(-1.84164209635)*dim
        ref[3,1,1]=(-0.215276741258)*(1+2.*(dim-1.)/(o+1.))+(-1.15470808005)*dim
        ref[4,0,0]=(0.379985463719)*(1+2.*(dim-1.)/(o+1.))+(0.91285473112)*dim
        ref[4,0,1]=(1.50741712099)*(1+2.*(dim-1.)/(o+1.))+(0.114426262342)*dim
        ref[4,1,0]=(-0.469372125764)*(1+2.*(dim-1.)/(o+1.))+(1.19746495352)*dim
        ref[4,1,1]=(1.55200716103)*(1+2.*(dim-1.)/(o+1.))+(0.105608795688)*dim
        ref[5,0,0]=(0.859404818179)*(1+2.*(dim-1.)/(o+1.))+(0.19546482231)*dim
        ref[5,0,1]=(0.843134234679)*(1+2.*(dim-1.)/(o+1.))+(-0.085771885833)*dim
        ref[5,1,0]=(-2.03125399301)*(1+2.*(dim-1.)/(o+1.))+(-0.339261594369)*dim
        ref[5,1,1]=(-1.20150471054)*(1+2.*(dim-1.)/(o+1.))+(-0.857620510454)*dim
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromData_FunctionOnBoundary_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.161068279134)*x[0]**o+(-0.20016693624)*x[0]+(0.360967926263)*x[1]**o+(0.519774730324)*x[1]
        arg[0,0,0,1]=(-0.470257945181)*x[0]**o+(0.0652334206708)*x[0]+(0.652139991357)*x[1]**o+(-0.592482756578)*x[1]
        arg[0,0,1,0]=(0.143126570256)*x[0]**o+(0.683474249212)*x[0]+(0.839611756722)*x[1]**o+(-0.436612603526)*x[1]
        arg[0,0,1,1]=(-0.82328367976)*x[0]**o+(-0.848145278113)*x[0]+(-0.649046694126)*x[1]**o+(0.7686615034)*x[1]
        arg[0,0,2,0]=(-0.89676527056)*x[0]**o+(-0.466316806084)*x[0]+(-0.454908744166)*x[1]**o+(0.425524454897)*x[1]
        arg[0,0,2,1]=(-0.720978656424)*x[0]**o+(-0.655449460498)*x[0]+(0.466383340682)*x[1]**o+(-0.609615749634)*x[1]
        arg[0,1,0,0]=(-0.358670380794)*x[0]**o+(-0.764939003508)*x[0]+(-0.550898156906)*x[1]**o+(0.803150103728)*x[1]
        arg[0,1,0,1]=(-0.652241076457)*x[0]**o+(-0.614033274928)*x[0]+(-0.308770011731)*x[1]**o+(0.925847136965)*x[1]
        arg[0,1,1,0]=(0.710539026622)*x[0]**o+(-0.345587804078)*x[0]+(-0.170026226995)*x[1]**o+(0.340557574804)*x[1]
        arg[0,1,1,1]=(0.348069554895)*x[0]**o+(-0.633629515001)*x[0]+(-0.199233786202)*x[1]**o+(0.500291488845)*x[1]
        arg[0,1,2,0]=(0.262179751197)*x[0]**o+(-0.55460029497)*x[0]+(-0.354335283745)*x[1]**o+(0.301130103531)*x[1]
        arg[0,1,2,1]=(0.212709964525)*x[0]**o+(0.205907518129)*x[0]+(0.167040570615)*x[1]**o+(-0.0684155270612)*x[1]
        arg[0,2,0,0]=(-0.272141616042)*x[0]**o+(0.187045318075)*x[0]+(-0.364974531949)*x[1]**o+(-0.969702579161)*x[1]
        arg[0,2,0,1]=(-0.997155483171)*x[0]**o+(0.864439328971)*x[0]+(0.887907754657)*x[1]**o+(-0.323021835147)*x[1]
        arg[0,2,1,0]=(-0.544228085563)*x[0]**o+(-0.56752289714)*x[0]+(-0.389234395916)*x[1]**o+(-0.969287386144)*x[1]
        arg[0,2,1,1]=(-0.786136450866)*x[0]**o+(0.589465339989)*x[0]+(-0.411595778776)*x[1]**o+(0.726975706536)*x[1]
        arg[0,2,2,0]=(-0.788299350517)*x[0]**o+(0.697037609691)*x[0]+(-0.391342918209)*x[1]**o+(0.432368662365)*x[1]
        arg[0,2,2,1]=(-0.390536554506)*x[0]**o+(0.547528359725)*x[0]+(0.58957966188)*x[1]**o+(0.146918361066)*x[1]
        arg[0,3,0,0]=(0.176059579799)*x[0]**o+(-0.774041865433)*x[0]+(0.52369869825)*x[1]**o+(-0.812474996262)*x[1]
        arg[0,3,0,1]=(-0.938727595513)*x[0]**o+(0.734277246158)*x[0]+(-0.500452658276)*x[1]**o+(0.591562924701)*x[1]
        arg[0,3,1,0]=(-0.109970490351)*x[0]**o+(-0.463382333915)*x[0]+(0.430588389365)*x[1]**o+(-0.174978181104)*x[1]
        arg[0,3,1,1]=(-0.564486046162)*x[0]**o+(0.325599920584)*x[0]+(-0.177334934858)*x[1]**o+(-0.789210879368)*x[1]
        arg[0,3,2,0]=(-0.409769653157)*x[0]**o+(-0.674668709075)*x[0]+(0.977465383205)*x[1]**o+(-0.178249094926)*x[1]
        arg[0,3,2,1]=(0.112394584736)*x[0]**o+(-0.229767891006)*x[0]+(0.952422132907)*x[1]**o+(-0.133952947363)*x[1]
        arg[0,4,0,0]=(0.927747625444)*x[0]**o+(-0.147390883234)*x[0]+(-0.0523168758823)*x[1]**o+(0.698643952882)*x[1]
        arg[0,4,0,1]=(0.986627759385)*x[0]**o+(-0.0486375625834)*x[0]+(0.27598075052)*x[1]**o+(0.970272004318)*x[1]
        arg[0,4,1,0]=(-0.461643441984)*x[0]**o+(-0.815261492927)*x[0]+(-0.0806771439228)*x[1]**o+(0.877302861263)*x[1]
        arg[0,4,1,1]=(-0.108403920958)*x[0]**o+(0.651566419087)*x[0]+(-0.629972296369)*x[1]**o+(-0.235413582155)*x[1]
        arg[0,4,2,0]=(-0.177527213798)*x[0]**o+(0.987202381273)*x[0]+(-0.15522298966)*x[1]**o+(0.234268561378)*x[1]
        arg[0,4,2,1]=(0.521954293269)*x[0]**o+(-0.776898814469)*x[0]+(0.783085515988)*x[1]**o+(-0.469921197982)*x[1]
        arg[1,0,0,0]=(0.858157489751)*x[0]**o+(0.444181035326)*x[0]+(0.3426806552)*x[1]**o+(-0.219249318925)*x[1]
        arg[1,0,0,1]=(0.405857394564)*x[0]**o+(0.178361294933)*x[0]+(0.0879917927852)*x[1]**o+(-0.0689581267347)*x[1]
        arg[1,0,1,0]=(0.63175565694)*x[0]**o+(0.0810462363705)*x[0]+(0.0350399072162)*x[1]**o+(-0.269906961338)*x[1]
        arg[1,0,1,1]=(-0.273973794035)*x[0]**o+(0.824519533391)*x[0]+(0.596785621044)*x[1]**o+(-0.243043370261)*x[1]
        arg[1,0,2,0]=(-0.959246118913)*x[0]**o+(0.3570024829)*x[0]+(-0.260098162669)*x[1]**o+(0.341044029457)*x[1]
        arg[1,0,2,1]=(0.966671029776)*x[0]**o+(0.598898116395)*x[0]+(0.392360541053)*x[1]**o+(-0.322723646751)*x[1]
        arg[1,1,0,0]=(-0.658365963559)*x[0]**o+(-0.674107595463)*x[0]+(-0.0103911551403)*x[1]**o+(0.858879803218)*x[1]
        arg[1,1,0,1]=(0.340459206102)*x[0]**o+(-0.681434505015)*x[0]+(0.917412924129)*x[1]**o+(0.703699154381)*x[1]
        arg[1,1,1,0]=(0.0473840209756)*x[0]**o+(-0.787070458106)*x[0]+(0.11979244907)*x[1]**o+(0.541238063489)*x[1]
        arg[1,1,1,1]=(0.184943768213)*x[0]**o+(-0.942961758488)*x[0]+(-0.844785429901)*x[1]**o+(-0.0109779269179)*x[1]
        arg[1,1,2,0]=(0.921469748172)*x[0]**o+(-0.122684636542)*x[0]+(0.149552532716)*x[1]**o+(-0.0102623511735)*x[1]
        arg[1,1,2,1]=(-0.720466710917)*x[0]**o+(-0.755841224189)*x[0]+(0.372635950892)*x[1]**o+(0.271604227274)*x[1]
        arg[1,2,0,0]=(-0.548557725319)*x[0]**o+(0.745340396995)*x[0]+(0.461556064961)*x[1]**o+(0.696460891668)*x[1]
        arg[1,2,0,1]=(-0.738939238644)*x[0]**o+(0.344829756443)*x[0]+(0.272341172248)*x[1]**o+(0.768063359753)*x[1]
        arg[1,2,1,0]=(-0.213161389496)*x[0]**o+(0.458730188555)*x[0]+(-0.783049463147)*x[1]**o+(0.785273989074)*x[1]
        arg[1,2,1,1]=(0.189092239774)*x[0]**o+(-0.0649917239139)*x[0]+(0.0171281685468)*x[1]**o+(0.397065812267)*x[1]
        arg[1,2,2,0]=(-0.809663598067)*x[0]**o+(0.587214021528)*x[0]+(0.912814601228)*x[1]**o+(0.860792008172)*x[1]
        arg[1,2,2,1]=(0.487927123118)*x[0]**o+(-0.760831928598)*x[0]+(-0.770486346056)*x[1]**o+(-0.715077841171)*x[1]
        arg[1,3,0,0]=(0.0202747853647)*x[0]**o+(0.0666642857036)*x[0]+(-0.717756666598)*x[1]**o+(-0.481009806467)*x[1]
        arg[1,3,0,1]=(-0.251164550146)*x[0]**o+(0.0519935051437)*x[0]+(-0.703400138413)*x[1]**o+(-0.990329903234)*x[1]
        arg[1,3,1,0]=(0.970793375169)*x[0]**o+(-0.365675269998)*x[0]+(0.77706784549)*x[1]**o+(-0.237785293481)*x[1]
        arg[1,3,1,1]=(-0.162786953006)*x[0]**o+(0.985402077919)*x[0]+(0.739483663725)*x[1]**o+(0.559554321882)*x[1]
        arg[1,3,2,0]=(0.184701463663)*x[0]**o+(0.946173117295)*x[0]+(-0.451420616712)*x[1]**o+(0.244506578089)*x[1]
        arg[1,3,2,1]=(0.894307549357)*x[0]**o+(0.474983970689)*x[0]+(0.626273940678)*x[1]**o+(0.107985157225)*x[1]
        arg[1,4,0,0]=(-0.180994231135)*x[0]**o+(-0.899808624585)*x[0]+(0.395935138342)*x[1]**o+(-0.387788497342)*x[1]
        arg[1,4,0,1]=(0.0713358452056)*x[0]**o+(0.505276043139)*x[0]+(-0.635565006093)*x[1]**o+(0.956951408169)*x[1]
        arg[1,4,1,0]=(0.355608577722)*x[0]**o+(0.58482326687)*x[0]+(0.654137690443)*x[1]**o+(-0.849016362888)*x[1]
        arg[1,4,1,1]=(-0.275966957458)*x[0]**o+(0.856095068377)*x[0]+(-0.760077050664)*x[1]**o+(-0.904159432699)*x[1]
        arg[1,4,2,0]=(-0.0637454805096)*x[0]**o+(-0.833057387633)*x[0]+(0.279008913569)*x[1]**o+(-0.093356790193)*x[1]
        arg[1,4,2,1]=(0.165869666472)*x[0]**o+(-0.4554345089)*x[0]+(0.697149094381)*x[1]**o+(0.244460087482)*x[1]
        arg[2,0,0,0]=(0.388188511348)*x[0]**o+(-0.00552398040882)*x[0]+(0.0679336322536)*x[1]**o+(-0.281132460216)*x[1]
        arg[2,0,0,1]=(0.968019690109)*x[0]**o+(0.525335591339)*x[0]+(0.660069087546)*x[1]**o+(-0.795388487336)*x[1]
        arg[2,0,1,0]=(-0.444010450901)*x[0]**o+(-0.498771184141)*x[0]+(-0.394999176962)*x[1]**o+(-0.579230388911)*x[1]
        arg[2,0,1,1]=(-0.96211072138)*x[0]**o+(-0.0977519108256)*x[0]+(0.206179333903)*x[1]**o+(-0.206155312014)*x[1]
        arg[2,0,2,0]=(0.131307090845)*x[0]**o+(0.179396626286)*x[0]+(-0.436118623166)*x[1]**o+(0.829727875456)*x[1]
        arg[2,0,2,1]=(-0.206336435516)*x[0]**o+(0.175744210813)*x[0]+(0.818204199205)*x[1]**o+(0.433292546177)*x[1]
        arg[2,1,0,0]=(0.920189410059)*x[0]**o+(-0.629286762249)*x[0]+(-0.14444305096)*x[1]**o+(0.564022686795)*x[1]
        arg[2,1,0,1]=(0.43550707444)*x[0]**o+(-0.0203691253164)*x[0]+(0.632472807002)*x[1]**o+(0.722390213081)*x[1]
        arg[2,1,1,0]=(0.827084071535)*x[0]**o+(0.864139638834)*x[0]+(0.795893591186)*x[1]**o+(0.0492667773115)*x[1]
        arg[2,1,1,1]=(0.863813787478)*x[0]**o+(0.268800194137)*x[0]+(-0.567637801205)*x[1]**o+(0.931221493563)*x[1]
        arg[2,1,2,0]=(-0.613463525024)*x[0]**o+(-0.0688030533166)*x[0]+(-0.786395692457)*x[1]**o+(0.862189706883)*x[1]
        arg[2,1,2,1]=(0.315306814851)*x[0]**o+(0.76879509223)*x[0]+(0.451451342779)*x[1]**o+(-0.478873421268)*x[1]
        arg[2,2,0,0]=(-0.785116047841)*x[0]**o+(0.347614087057)*x[0]+(-0.0106716042015)*x[1]**o+(-0.350898768187)*x[1]
        arg[2,2,0,1]=(-0.987778931187)*x[0]**o+(-0.380379654757)*x[0]+(-0.383604999655)*x[1]**o+(0.022203803886)*x[1]
        arg[2,2,1,0]=(0.508327115069)*x[0]**o+(0.443678958632)*x[0]+(-0.320069211602)*x[1]**o+(-0.778140184171)*x[1]
        arg[2,2,1,1]=(-0.532025577107)*x[0]**o+(-0.0475799386434)*x[0]+(0.650417175266)*x[1]**o+(0.33739661369)*x[1]
        arg[2,2,2,0]=(-0.406412097333)*x[0]**o+(0.0510500610605)*x[0]+(-0.25755890225)*x[1]**o+(-0.350209779392)*x[1]
        arg[2,2,2,1]=(0.401361048956)*x[0]**o+(-0.594793585281)*x[0]+(0.155257431052)*x[1]**o+(-0.674885216524)*x[1]
        arg[2,3,0,0]=(0.352606222236)*x[0]**o+(0.64529574473)*x[0]+(-0.838258091233)*x[1]**o+(0.527911574536)*x[1]
        arg[2,3,0,1]=(-0.62652610251)*x[0]**o+(0.879664434218)*x[0]+(0.730845316192)*x[1]**o+(0.0318659384791)*x[1]
        arg[2,3,1,0]=(-0.311152313179)*x[0]**o+(-0.333154399786)*x[0]+(0.743640958069)*x[1]**o+(0.313394944493)*x[1]
        arg[2,3,1,1]=(-0.728968478378)*x[0]**o+(0.500229380574)*x[0]+(0.756628133572)*x[1]**o+(0.270533146994)*x[1]
        arg[2,3,2,0]=(-0.219775843272)*x[0]**o+(0.882943220401)*x[0]+(0.79341547188)*x[1]**o+(0.503486054551)*x[1]
        arg[2,3,2,1]=(-0.850285149353)*x[0]**o+(0.78820884302)*x[0]+(0.348024963962)*x[1]**o+(0.83743616537)*x[1]
        arg[2,4,0,0]=(0.868649421127)*x[0]**o+(-0.622361223999)*x[0]+(0.836321867516)*x[1]**o+(0.423582994131)*x[1]
        arg[2,4,0,1]=(0.140963355402)*x[0]**o+(0.190496469385)*x[0]+(0.765311231744)*x[1]**o+(0.368696267095)*x[1]
        arg[2,4,1,0]=(-0.680854080076)*x[0]**o+(-0.729641193897)*x[0]+(-0.843347646585)*x[1]**o+(-0.0993036180842)*x[1]
        arg[2,4,1,1]=(-0.130039648356)*x[0]**o+(0.534197300899)*x[0]+(-0.142588861186)*x[1]**o+(-0.308376644249)*x[1]
        arg[2,4,2,0]=(0.331212825202)*x[0]**o+(0.466247840288)*x[0]+(-0.201714210846)*x[1]**o+(0.80521345364)*x[1]
        arg[2,4,2,1]=(0.454299813247)*x[0]**o+(0.646694941459)*x[0]+(-0.929854585458)*x[1]**o+(-0.365252296746)*x[1]
        arg[3,0,0,0]=(-0.623915395721)*x[0]**o+(-0.789827882448)*x[0]+(-0.862568457189)*x[1]**o+(-0.141799958679)*x[1]
        arg[3,0,0,1]=(0.197040281353)*x[0]**o+(0.155785418081)*x[0]+(-0.587898788817)*x[1]**o+(0.700612189317)*x[1]
        arg[3,0,1,0]=(-0.899654954269)*x[0]**o+(-0.801426785588)*x[0]+(-0.528678401571)*x[1]**o+(-0.224185097206)*x[1]
        arg[3,0,1,1]=(0.291298188198)*x[0]**o+(0.786698690825)*x[0]+(0.925634940697)*x[1]**o+(0.617661715197)*x[1]
        arg[3,0,2,0]=(0.788272473274)*x[0]**o+(-0.0400044705274)*x[0]+(-0.669092974469)*x[1]**o+(-0.063697728491)*x[1]
        arg[3,0,2,1]=(-0.0612398565521)*x[0]**o+(-0.884311783009)*x[0]+(0.444689078628)*x[1]**o+(0.302741981611)*x[1]
        arg[3,1,0,0]=(0.483756249722)*x[0]**o+(-0.214185139167)*x[0]+(0.526387014144)*x[1]**o+(-0.172619975799)*x[1]
        arg[3,1,0,1]=(0.0685836489777)*x[0]**o+(-0.425861440836)*x[0]+(0.94669899123)*x[1]**o+(-0.649068988929)*x[1]
        arg[3,1,1,0]=(0.935225203148)*x[0]**o+(-0.649378812349)*x[0]+(-0.791553458732)*x[1]**o+(0.776307740809)*x[1]
        arg[3,1,1,1]=(-0.45319945403)*x[0]**o+(-0.473310763902)*x[0]+(-0.268480872039)*x[1]**o+(0.847382076174)*x[1]
        arg[3,1,2,0]=(-0.573022434421)*x[0]**o+(0.584143976397)*x[0]+(0.131688457808)*x[1]**o+(-0.628894863435)*x[1]
        arg[3,1,2,1]=(0.628566928363)*x[0]**o+(-0.868564569338)*x[0]+(-0.482273553287)*x[1]**o+(0.679652796519)*x[1]
        arg[3,2,0,0]=(-0.64046509323)*x[0]**o+(-0.108928537952)*x[0]+(-0.512288515479)*x[1]**o+(0.683072290041)*x[1]
        arg[3,2,0,1]=(0.472589328326)*x[0]**o+(0.219741638671)*x[0]+(0.136368535311)*x[1]**o+(-0.525113003647)*x[1]
        arg[3,2,1,0]=(-0.45731256203)*x[0]**o+(0.0854410475382)*x[0]+(0.257725845542)*x[1]**o+(0.430430185351)*x[1]
        arg[3,2,1,1]=(0.948699678725)*x[0]**o+(-0.00538658505415)*x[0]+(0.921898600708)*x[1]**o+(-0.448522286404)*x[1]
        arg[3,2,2,0]=(-0.0863353766204)*x[0]**o+(-0.652417730681)*x[0]+(0.755871413533)*x[1]**o+(0.206065623655)*x[1]
        arg[3,2,2,1]=(0.263075920527)*x[0]**o+(0.94162407402)*x[0]+(0.750015836722)*x[1]**o+(-0.815154267718)*x[1]
        arg[3,3,0,0]=(-0.606984299829)*x[0]**o+(0.120704522147)*x[0]+(-0.324211323778)*x[1]**o+(-0.123647081263)*x[1]
        arg[3,3,0,1]=(0.838995936232)*x[0]**o+(0.854147779134)*x[0]+(-0.192271552952)*x[1]**o+(0.0281108740635)*x[1]
        arg[3,3,1,0]=(-0.0343159887291)*x[0]**o+(0.242432659911)*x[0]+(-0.37299830191)*x[1]**o+(-0.456792158625)*x[1]
        arg[3,3,1,1]=(-0.305277044867)*x[0]**o+(-0.930386582491)*x[0]+(-0.979921197617)*x[1]**o+(-0.507736755766)*x[1]
        arg[3,3,2,0]=(0.548675744195)*x[0]**o+(0.755596482286)*x[0]+(0.0722267054576)*x[1]**o+(-0.393768047035)*x[1]
        arg[3,3,2,1]=(0.74781993508)*x[0]**o+(-0.655033306209)*x[0]+(0.480653847364)*x[1]**o+(-0.169400714085)*x[1]
        arg[3,4,0,0]=(0.269186769422)*x[0]**o+(-0.0786214595922)*x[0]+(-0.975508552024)*x[1]**o+(-0.798249509899)*x[1]
        arg[3,4,0,1]=(-0.599201275441)*x[0]**o+(0.473490319504)*x[0]+(0.0277044125859)*x[1]**o+(0.818107843614)*x[1]
        arg[3,4,1,0]=(-0.46272642862)*x[0]**o+(0.740282148493)*x[0]+(0.35998379499)*x[1]**o+(-0.938681489717)*x[1]
        arg[3,4,1,1]=(0.187067286301)*x[0]**o+(-0.284171344521)*x[0]+(0.612229918327)*x[1]**o+(0.3917984881)*x[1]
        arg[3,4,2,0]=(-0.535270910341)*x[0]**o+(-0.00723888213927)*x[0]+(-0.776984534618)*x[1]**o+(-0.0899536033273)*x[1]
        arg[3,4,2,1]=(-0.382290376155)*x[0]**o+(-0.0593490177599)*x[0]+(-0.19716515678)*x[1]**o+(-0.268991693613)*x[1]
        ref[0,0,0,0]=(0.19989964713)*(1+2.*(dim-1.)/(o+1.))+(0.319607794084)*dim
        ref[0,0,0,1]=(0.181882046176)*(1+2.*(dim-1.)/(o+1.))+(-0.527249335907)*dim
        ref[0,0,1,0]=(0.982738326978)*(1+2.*(dim-1.)/(o+1.))+(0.246861645686)*dim
        ref[0,0,1,1]=(-1.47233037389)*(1+2.*(dim-1.)/(o+1.))+(-0.0794837747136)*dim
        ref[0,0,2,0]=(-1.35167401473)*(1+2.*(dim-1.)/(o+1.))+(-0.0407923511861)*dim
        ref[0,0,2,1]=(-0.254595315742)*(1+2.*(dim-1.)/(o+1.))+(-1.26506521013)*dim
        ref[0,1,0,0]=(-0.909568537701)*(1+2.*(dim-1.)/(o+1.))+(0.0382111002203)*dim
        ref[0,1,0,1]=(-0.961011088187)*(1+2.*(dim-1.)/(o+1.))+(0.311813862038)*dim
        ref[0,1,1,0]=(0.540512799627)*(1+2.*(dim-1.)/(o+1.))+(-0.00503022927381)*dim
        ref[0,1,1,1]=(0.148835768693)*(1+2.*(dim-1.)/(o+1.))+(-0.133338026157)*dim
        ref[0,1,2,0]=(-0.0921555325482)*(1+2.*(dim-1.)/(o+1.))+(-0.253470191439)*dim
        ref[0,1,2,1]=(0.37975053514)*(1+2.*(dim-1.)/(o+1.))+(0.137491991068)*dim
        ref[0,2,0,0]=(-0.637116147991)*(1+2.*(dim-1.)/(o+1.))+(-0.782657261086)*dim
        ref[0,2,0,1]=(-0.109247728514)*(1+2.*(dim-1.)/(o+1.))+(0.541417493824)*dim
        ref[0,2,1,0]=(-0.933462481479)*(1+2.*(dim-1.)/(o+1.))+(-1.53681028328)*dim
        ref[0,2,1,1]=(-1.19773222964)*(1+2.*(dim-1.)/(o+1.))+(1.31644104653)*dim
        ref[0,2,2,0]=(-1.17964226873)*(1+2.*(dim-1.)/(o+1.))+(1.12940627206)*dim
        ref[0,2,2,1]=(0.199043107375)*(1+2.*(dim-1.)/(o+1.))+(0.694446720792)*dim
        ref[0,3,0,0]=(0.699758278049)*(1+2.*(dim-1.)/(o+1.))+(-1.5865168617)*dim
        ref[0,3,0,1]=(-1.43918025379)*(1+2.*(dim-1.)/(o+1.))+(1.32584017086)*dim
        ref[0,3,1,0]=(0.320617899014)*(1+2.*(dim-1.)/(o+1.))+(-0.63836051502)*dim
        ref[0,3,1,1]=(-0.741820981021)*(1+2.*(dim-1.)/(o+1.))+(-0.463610958784)*dim
        ref[0,3,2,0]=(0.567695730048)*(1+2.*(dim-1.)/(o+1.))+(-0.852917804)*dim
        ref[0,3,2,1]=(1.06481671764)*(1+2.*(dim-1.)/(o+1.))+(-0.363720838369)*dim
        ref[0,4,0,0]=(0.875430749562)*(1+2.*(dim-1.)/(o+1.))+(0.551253069648)*dim
        ref[0,4,0,1]=(1.26260850991)*(1+2.*(dim-1.)/(o+1.))+(0.921634441735)*dim
        ref[0,4,1,0]=(-0.542320585907)*(1+2.*(dim-1.)/(o+1.))+(0.0620413683361)*dim
        ref[0,4,1,1]=(-0.738376217327)*(1+2.*(dim-1.)/(o+1.))+(0.416152836932)*dim
        ref[0,4,2,0]=(-0.332750203458)*(1+2.*(dim-1.)/(o+1.))+(1.22147094265)*dim
        ref[0,4,2,1]=(1.30503980926)*(1+2.*(dim-1.)/(o+1.))+(-1.24682001245)*dim
        ref[1,0,0,0]=(1.20083814495)*(1+2.*(dim-1.)/(o+1.))+(0.224931716401)*dim
        ref[1,0,0,1]=(0.493849187349)*(1+2.*(dim-1.)/(o+1.))+(0.109403168198)*dim
        ref[1,0,1,0]=(0.666795564157)*(1+2.*(dim-1.)/(o+1.))+(-0.188860724968)*dim
        ref[1,0,1,1]=(0.322811827009)*(1+2.*(dim-1.)/(o+1.))+(0.58147616313)*dim
        ref[1,0,2,0]=(-1.21934428158)*(1+2.*(dim-1.)/(o+1.))+(0.698046512357)*dim
        ref[1,0,2,1]=(1.35903157083)*(1+2.*(dim-1.)/(o+1.))+(0.276174469644)*dim
        ref[1,1,0,0]=(-0.668757118699)*(1+2.*(dim-1.)/(o+1.))+(0.184772207756)*dim
        ref[1,1,0,1]=(1.25787213023)*(1+2.*(dim-1.)/(o+1.))+(0.0222646493659)*dim
        ref[1,1,1,0]=(0.167176470046)*(1+2.*(dim-1.)/(o+1.))+(-0.245832394617)*dim
        ref[1,1,1,1]=(-0.659841661688)*(1+2.*(dim-1.)/(o+1.))+(-0.953939685406)*dim
        ref[1,1,2,0]=(1.07102228089)*(1+2.*(dim-1.)/(o+1.))+(-0.132946987715)*dim
        ref[1,1,2,1]=(-0.347830760025)*(1+2.*(dim-1.)/(o+1.))+(-0.484236996915)*dim
        ref[1,2,0,0]=(-0.087001660358)*(1+2.*(dim-1.)/(o+1.))+(1.44180128866)*dim
        ref[1,2,0,1]=(-0.466598066397)*(1+2.*(dim-1.)/(o+1.))+(1.1128931162)*dim
        ref[1,2,1,0]=(-0.996210852643)*(1+2.*(dim-1.)/(o+1.))+(1.24400417763)*dim
        ref[1,2,1,1]=(0.206220408321)*(1+2.*(dim-1.)/(o+1.))+(0.332074088353)*dim
        ref[1,2,2,0]=(0.103151003161)*(1+2.*(dim-1.)/(o+1.))+(1.4480060297)*dim
        ref[1,2,2,1]=(-0.282559222939)*(1+2.*(dim-1.)/(o+1.))+(-1.47590976977)*dim
        ref[1,3,0,0]=(-0.697481881234)*(1+2.*(dim-1.)/(o+1.))+(-0.414345520764)*dim
        ref[1,3,0,1]=(-0.954564688559)*(1+2.*(dim-1.)/(o+1.))+(-0.93833639809)*dim
        ref[1,3,1,0]=(1.74786122066)*(1+2.*(dim-1.)/(o+1.))+(-0.603460563479)*dim
        ref[1,3,1,1]=(0.576696710719)*(1+2.*(dim-1.)/(o+1.))+(1.5449563998)*dim
        ref[1,3,2,0]=(-0.26671915305)*(1+2.*(dim-1.)/(o+1.))+(1.19067969538)*dim
        ref[1,3,2,1]=(1.52058149003)*(1+2.*(dim-1.)/(o+1.))+(0.582969127914)*dim
        ref[1,4,0,0]=(0.214940907208)*(1+2.*(dim-1.)/(o+1.))+(-1.28759712193)*dim
        ref[1,4,0,1]=(-0.564229160887)*(1+2.*(dim-1.)/(o+1.))+(1.46222745131)*dim
        ref[1,4,1,0]=(1.00974626816)*(1+2.*(dim-1.)/(o+1.))+(-0.264193096019)*dim
        ref[1,4,1,1]=(-1.03604400812)*(1+2.*(dim-1.)/(o+1.))+(-0.048064364322)*dim
        ref[1,4,2,0]=(0.215263433059)*(1+2.*(dim-1.)/(o+1.))+(-0.926414177826)*dim
        ref[1,4,2,1]=(0.863018760853)*(1+2.*(dim-1.)/(o+1.))+(-0.210974421418)*dim
        ref[2,0,0,0]=(0.456122143601)*(1+2.*(dim-1.)/(o+1.))+(-0.286656440625)*dim
        ref[2,0,0,1]=(1.62808877765)*(1+2.*(dim-1.)/(o+1.))+(-0.270052895997)*dim
        ref[2,0,1,0]=(-0.839009627862)*(1+2.*(dim-1.)/(o+1.))+(-1.07800157305)*dim
        ref[2,0,1,1]=(-0.755931387477)*(1+2.*(dim-1.)/(o+1.))+(-0.30390722284)*dim
        ref[2,0,2,0]=(-0.304811532322)*(1+2.*(dim-1.)/(o+1.))+(1.00912450174)*dim
        ref[2,0,2,1]=(0.61186776369)*(1+2.*(dim-1.)/(o+1.))+(0.60903675699)*dim
        ref[2,1,0,0]=(0.775746359099)*(1+2.*(dim-1.)/(o+1.))+(-0.0652640754538)*dim
        ref[2,1,0,1]=(1.06797988144)*(1+2.*(dim-1.)/(o+1.))+(0.702021087765)*dim
        ref[2,1,1,0]=(1.62297766272)*(1+2.*(dim-1.)/(o+1.))+(0.913406416145)*dim
        ref[2,1,1,1]=(0.296175986273)*(1+2.*(dim-1.)/(o+1.))+(1.2000216877)*dim
        ref[2,1,2,0]=(-1.39985921748)*(1+2.*(dim-1.)/(o+1.))+(0.793386653567)*dim
        ref[2,1,2,1]=(0.76675815763)*(1+2.*(dim-1.)/(o+1.))+(0.289921670962)*dim
        ref[2,2,0,0]=(-0.795787652043)*(1+2.*(dim-1.)/(o+1.))+(-0.0032846811301)*dim
        ref[2,2,0,1]=(-1.37138393084)*(1+2.*(dim-1.)/(o+1.))+(-0.358175850871)*dim
        ref[2,2,1,0]=(0.188257903467)*(1+2.*(dim-1.)/(o+1.))+(-0.334461225539)*dim
        ref[2,2,1,1]=(0.118391598158)*(1+2.*(dim-1.)/(o+1.))+(0.289816675047)*dim
        ref[2,2,2,0]=(-0.663970999582)*(1+2.*(dim-1.)/(o+1.))+(-0.299159718332)*dim
        ref[2,2,2,1]=(0.556618480008)*(1+2.*(dim-1.)/(o+1.))+(-1.2696788018)*dim
        ref[2,3,0,0]=(-0.485651868997)*(1+2.*(dim-1.)/(o+1.))+(1.17320731927)*dim
        ref[2,3,0,1]=(0.104319213682)*(1+2.*(dim-1.)/(o+1.))+(0.911530372697)*dim
        ref[2,3,1,0]=(0.43248864489)*(1+2.*(dim-1.)/(o+1.))+(-0.0197594552935)*dim
        ref[2,3,1,1]=(0.0276596551936)*(1+2.*(dim-1.)/(o+1.))+(0.770762527568)*dim
        ref[2,3,2,0]=(0.573639628608)*(1+2.*(dim-1.)/(o+1.))+(1.38642927495)*dim
        ref[2,3,2,1]=(-0.502260185391)*(1+2.*(dim-1.)/(o+1.))+(1.62564500839)*dim
        ref[2,4,0,0]=(1.70497128864)*(1+2.*(dim-1.)/(o+1.))+(-0.198778229868)*dim
        ref[2,4,0,1]=(0.906274587146)*(1+2.*(dim-1.)/(o+1.))+(0.55919273648)*dim
        ref[2,4,1,0]=(-1.52420172666)*(1+2.*(dim-1.)/(o+1.))+(-0.828944811982)*dim
        ref[2,4,1,1]=(-0.272628509541)*(1+2.*(dim-1.)/(o+1.))+(0.225820656649)*dim
        ref[2,4,2,0]=(0.129498614356)*(1+2.*(dim-1.)/(o+1.))+(1.27146129393)*dim
        ref[2,4,2,1]=(-0.475554772211)*(1+2.*(dim-1.)/(o+1.))+(0.281442644713)*dim
        ref[3,0,0,0]=(-1.48648385291)*(1+2.*(dim-1.)/(o+1.))+(-0.931627841127)*dim
        ref[3,0,0,1]=(-0.390858507465)*(1+2.*(dim-1.)/(o+1.))+(0.856397607398)*dim
        ref[3,0,1,0]=(-1.42833335584)*(1+2.*(dim-1.)/(o+1.))+(-1.02561188279)*dim
        ref[3,0,1,1]=(1.2169331289)*(1+2.*(dim-1.)/(o+1.))+(1.40436040602)*dim
        ref[3,0,2,0]=(0.119179498805)*(1+2.*(dim-1.)/(o+1.))+(-0.103702199018)*dim
        ref[3,0,2,1]=(0.383449222076)*(1+2.*(dim-1.)/(o+1.))+(-0.581569801398)*dim
        ref[3,1,0,0]=(1.01014326387)*(1+2.*(dim-1.)/(o+1.))+(-0.386805114966)*dim
        ref[3,1,0,1]=(1.01528264021)*(1+2.*(dim-1.)/(o+1.))+(-1.07493042977)*dim
        ref[3,1,1,0]=(0.143671744416)*(1+2.*(dim-1.)/(o+1.))+(0.12692892846)*dim
        ref[3,1,1,1]=(-0.721680326068)*(1+2.*(dim-1.)/(o+1.))+(0.374071312272)*dim
        ref[3,1,2,0]=(-0.441333976613)*(1+2.*(dim-1.)/(o+1.))+(-0.0447508870373)*dim
        ref[3,1,2,1]=(0.146293375075)*(1+2.*(dim-1.)/(o+1.))+(-0.188911772819)*dim
        ref[3,2,0,0]=(-1.15275360871)*(1+2.*(dim-1.)/(o+1.))+(0.57414375209)*dim
        ref[3,2,0,1]=(0.608957863637)*(1+2.*(dim-1.)/(o+1.))+(-0.305371364976)*dim
        ref[3,2,1,0]=(-0.199586716488)*(1+2.*(dim-1.)/(o+1.))+(0.515871232889)*dim
        ref[3,2,1,1]=(1.87059827943)*(1+2.*(dim-1.)/(o+1.))+(-0.453908871458)*dim
        ref[3,2,2,0]=(0.669536036913)*(1+2.*(dim-1.)/(o+1.))+(-0.446352107026)*dim
        ref[3,2,2,1]=(1.01309175725)*(1+2.*(dim-1.)/(o+1.))+(0.126469806303)*dim
        ref[3,3,0,0]=(-0.931195623607)*(1+2.*(dim-1.)/(o+1.))+(-0.00294255911617)*dim
        ref[3,3,0,1]=(0.64672438328)*(1+2.*(dim-1.)/(o+1.))+(0.882258653197)*dim
        ref[3,3,1,0]=(-0.407314290639)*(1+2.*(dim-1.)/(o+1.))+(-0.214359498715)*dim
        ref[3,3,1,1]=(-1.28519824248)*(1+2.*(dim-1.)/(o+1.))+(-1.43812333826)*dim
        ref[3,3,2,0]=(0.620902449652)*(1+2.*(dim-1.)/(o+1.))+(0.361828435252)*dim
        ref[3,3,2,1]=(1.22847378244)*(1+2.*(dim-1.)/(o+1.))+(-0.824434020294)*dim
        ref[3,4,0,0]=(-0.706321782603)*(1+2.*(dim-1.)/(o+1.))+(-0.876870969492)*dim
        ref[3,4,0,1]=(-0.571496862855)*(1+2.*(dim-1.)/(o+1.))+(1.29159816312)*dim
        ref[3,4,1,0]=(-0.102742633631)*(1+2.*(dim-1.)/(o+1.))+(-0.198399341224)*dim
        ref[3,4,1,1]=(0.799297204627)*(1+2.*(dim-1.)/(o+1.))+(0.107627143578)*dim
        ref[3,4,2,0]=(-1.31225544496)*(1+2.*(dim-1.)/(o+1.))+(-0.0971924854666)*dim
        ref[3,4,2,1]=(-0.579455532935)*(1+2.*(dim-1.)/(o+1.))+(-0.328340711373)*dim
      else:
        arg[0,0,0,0]=(-0.727570048979)*x[0]**o+(-0.769770353069)*x[0]+(-0.532381054852)*x[1]**o+(0.590589994369)*x[1]+(0.775348726284)*x[2]**o+(-0.840239939796)*x[2]
        arg[0,0,0,1]=(-0.441856577751)*x[0]**o+(-0.39234308235)*x[0]+(-0.834378647798)*x[1]**o+(0.84269918161)*x[1]+(0.441102591728)*x[2]**o+(0.166331058665)*x[2]
        arg[0,0,1,0]=(0.391773069521)*x[0]**o+(0.496759920942)*x[0]+(0.555386226902)*x[1]**o+(0.980197783628)*x[1]+(0.549622021652)*x[2]**o+(-0.596179893504)*x[2]
        arg[0,0,1,1]=(-0.104197387892)*x[0]**o+(-0.64636505375)*x[0]+(0.377612339028)*x[1]**o+(-0.215111619231)*x[1]+(0.637249692625)*x[2]**o+(-0.0998227822351)*x[2]
        arg[0,0,2,0]=(0.780693043561)*x[0]**o+(0.571405344342)*x[0]+(-0.793680154472)*x[1]**o+(-0.0481469136436)*x[1]+(0.959561051293)*x[2]**o+(0.0756152497582)*x[2]
        arg[0,0,2,1]=(0.88678762282)*x[0]**o+(0.254753272214)*x[0]+(0.344376798516)*x[1]**o+(-0.908135902735)*x[1]+(-0.3584387726)*x[2]**o+(-0.890225037617)*x[2]
        arg[0,1,0,0]=(0.680262917473)*x[0]**o+(0.65860357305)*x[0]+(0.859832322473)*x[1]**o+(0.326105580592)*x[1]+(0.132170297876)*x[2]**o+(-0.928606849775)*x[2]
        arg[0,1,0,1]=(-0.500503822293)*x[0]**o+(-0.456331012174)*x[0]+(0.900478846187)*x[1]**o+(0.350542503874)*x[1]+(0.755849038617)*x[2]**o+(-0.514240007142)*x[2]
        arg[0,1,1,0]=(0.124404217291)*x[0]**o+(-0.499651000805)*x[0]+(-0.968178694708)*x[1]**o+(0.306780500818)*x[1]+(-0.946470794819)*x[2]**o+(0.919424575523)*x[2]
        arg[0,1,1,1]=(0.722520017474)*x[0]**o+(-0.718216593718)*x[0]+(0.801196051455)*x[1]**o+(-0.791951278546)*x[1]+(-0.675975417529)*x[2]**o+(0.355069676047)*x[2]
        arg[0,1,2,0]=(-0.137017428857)*x[0]**o+(-0.760267879487)*x[0]+(0.625869259413)*x[1]**o+(-0.697626713352)*x[1]+(-0.467876751423)*x[2]**o+(0.456475454123)*x[2]
        arg[0,1,2,1]=(0.646536442797)*x[0]**o+(0.0981671744166)*x[0]+(0.477147756414)*x[1]**o+(-0.23211823966)*x[1]+(-0.553808167147)*x[2]**o+(0.405402676302)*x[2]
        arg[0,2,0,0]=(-0.0604502966371)*x[0]**o+(0.297995946813)*x[0]+(0.837045433858)*x[1]**o+(-0.270340963575)*x[1]+(-0.58462190484)*x[2]**o+(0.292953993287)*x[2]
        arg[0,2,0,1]=(-0.463109088268)*x[0]**o+(0.346260157368)*x[0]+(0.0228615151352)*x[1]**o+(0.905507471559)*x[1]+(-0.423777553665)*x[2]**o+(-0.45964535654)*x[2]
        arg[0,2,1,0]=(-0.50761294542)*x[0]**o+(-0.465260578419)*x[0]+(-0.729953382373)*x[1]**o+(0.903666219263)*x[1]+(-0.756794344711)*x[2]**o+(0.817263008431)*x[2]
        arg[0,2,1,1]=(-0.551253781393)*x[0]**o+(-0.911481117802)*x[0]+(0.180349330394)*x[1]**o+(0.419118491074)*x[1]+(-0.691917875703)*x[2]**o+(-0.835365504347)*x[2]
        arg[0,2,2,0]=(0.32567932803)*x[0]**o+(0.413167839883)*x[0]+(0.781320691089)*x[1]**o+(-0.777223093057)*x[1]+(0.297556831029)*x[2]**o+(-0.952676550814)*x[2]
        arg[0,2,2,1]=(0.226250474873)*x[0]**o+(0.279287242249)*x[0]+(0.421824124143)*x[1]**o+(-0.97664927412)*x[1]+(0.703245736838)*x[2]**o+(-0.629660622476)*x[2]
        arg[0,3,0,0]=(-0.138403445102)*x[0]**o+(0.0979152923187)*x[0]+(-0.177116218507)*x[1]**o+(0.0100523961708)*x[1]+(-0.634159492232)*x[2]**o+(-0.847618220907)*x[2]
        arg[0,3,0,1]=(0.612268738957)*x[0]**o+(-0.462682392204)*x[0]+(-0.146623835506)*x[1]**o+(0.699258469487)*x[1]+(0.0139983038691)*x[2]**o+(0.236461011719)*x[2]
        arg[0,3,1,0]=(-0.0518123102809)*x[0]**o+(0.386822059696)*x[0]+(-0.208858744655)*x[1]**o+(0.971393362011)*x[1]+(-0.171649562077)*x[2]**o+(-0.507479926411)*x[2]
        arg[0,3,1,1]=(0.0140396270391)*x[0]**o+(-0.837711757872)*x[0]+(-0.00108924459289)*x[1]**o+(-0.724087080496)*x[1]+(-0.793071741694)*x[2]**o+(0.38654936043)*x[2]
        arg[0,3,2,0]=(-0.897711437057)*x[0]**o+(0.562533782571)*x[0]+(-0.354013039442)*x[1]**o+(-0.473034213198)*x[1]+(0.4598333464)*x[2]**o+(0.467503992754)*x[2]
        arg[0,3,2,1]=(-0.198441232877)*x[0]**o+(-0.411568849672)*x[0]+(0.0850211273328)*x[1]**o+(-0.333702582633)*x[1]+(0.727888461746)*x[2]**o+(-0.174835541819)*x[2]
        arg[0,4,0,0]=(-0.114679585752)*x[0]**o+(0.0446596462171)*x[0]+(-0.950604674991)*x[1]**o+(-0.307622186566)*x[1]+(0.956712754366)*x[2]**o+(0.334630480874)*x[2]
        arg[0,4,0,1]=(0.345475911118)*x[0]**o+(0.834620576123)*x[0]+(0.903176273684)*x[1]**o+(-0.364211856466)*x[1]+(0.910903954488)*x[2]**o+(0.392248545744)*x[2]
        arg[0,4,1,0]=(-0.593360797686)*x[0]**o+(-0.0199892857836)*x[0]+(0.293839091284)*x[1]**o+(0.580208854742)*x[1]+(0.060499817751)*x[2]**o+(0.907498841261)*x[2]
        arg[0,4,1,1]=(-0.446192713548)*x[0]**o+(0.29870251614)*x[0]+(0.754231657585)*x[1]**o+(0.321710920549)*x[1]+(0.287978396665)*x[2]**o+(-0.963473165492)*x[2]
        arg[0,4,2,0]=(0.780174386478)*x[0]**o+(0.603377914483)*x[0]+(-0.841703120145)*x[1]**o+(0.316522795462)*x[1]+(-0.192916583378)*x[2]**o+(-0.734091913995)*x[2]
        arg[0,4,2,1]=(-0.130567656486)*x[0]**o+(-0.342928842892)*x[0]+(-0.0827376128775)*x[1]**o+(-0.771104057041)*x[1]+(0.733571283734)*x[2]**o+(-0.880531838119)*x[2]
        arg[1,0,0,0]=(-0.634428121043)*x[0]**o+(0.294135783753)*x[0]+(-0.566305561339)*x[1]**o+(0.0332700472211)*x[1]+(0.128130119463)*x[2]**o+(0.0468678470468)*x[2]
        arg[1,0,0,1]=(0.82168858107)*x[0]**o+(-0.75544177649)*x[0]+(0.260115562827)*x[1]**o+(-0.149575433725)*x[1]+(-0.780945910032)*x[2]**o+(-0.0539291857071)*x[2]
        arg[1,0,1,0]=(-0.97885291605)*x[0]**o+(0.777955971883)*x[0]+(0.115355866293)*x[1]**o+(-0.456449594589)*x[1]+(-0.832816352387)*x[2]**o+(-0.418070257158)*x[2]
        arg[1,0,1,1]=(-0.908396506245)*x[0]**o+(-0.982147653872)*x[0]+(0.138657052347)*x[1]**o+(0.633837624386)*x[1]+(-0.529748303776)*x[2]**o+(-0.950225664343)*x[2]
        arg[1,0,2,0]=(0.733974435377)*x[0]**o+(-0.758228777635)*x[0]+(0.841368499977)*x[1]**o+(0.871715889444)*x[1]+(0.541055759071)*x[2]**o+(0.669798500731)*x[2]
        arg[1,0,2,1]=(-0.572994548563)*x[0]**o+(0.806241853906)*x[0]+(0.141217952929)*x[1]**o+(0.832291361477)*x[1]+(0.207737014762)*x[2]**o+(-0.279769695917)*x[2]
        arg[1,1,0,0]=(-0.394247339923)*x[0]**o+(0.548338039327)*x[0]+(-0.845822483858)*x[1]**o+(-0.941161341738)*x[1]+(-0.244513027249)*x[2]**o+(-0.524790843131)*x[2]
        arg[1,1,0,1]=(0.509994957918)*x[0]**o+(0.691470630092)*x[0]+(0.249241759795)*x[1]**o+(-0.995293157716)*x[1]+(0.162652088127)*x[2]**o+(0.873578806104)*x[2]
        arg[1,1,1,0]=(-0.22367137056)*x[0]**o+(-0.896306406631)*x[0]+(0.613214186844)*x[1]**o+(-0.460055562163)*x[1]+(-0.704736634406)*x[2]**o+(-0.517741014186)*x[2]
        arg[1,1,1,1]=(-0.426072795689)*x[0]**o+(-0.13452184053)*x[0]+(0.908778671123)*x[1]**o+(0.194472828672)*x[1]+(-0.658909495204)*x[2]**o+(-0.234260758459)*x[2]
        arg[1,1,2,0]=(0.236086562474)*x[0]**o+(0.33312461561)*x[0]+(0.867089643801)*x[1]**o+(-0.720157305369)*x[1]+(0.812845198077)*x[2]**o+(-0.375694713863)*x[2]
        arg[1,1,2,1]=(-0.561145817489)*x[0]**o+(0.746630137163)*x[0]+(-0.809280840008)*x[1]**o+(-0.690912076356)*x[1]+(0.88933641231)*x[2]**o+(0.246647817564)*x[2]
        arg[1,2,0,0]=(0.701319152729)*x[0]**o+(-0.309074024603)*x[0]+(0.567988628717)*x[1]**o+(-0.0596939135728)*x[1]+(0.242135294918)*x[2]**o+(-0.101136005445)*x[2]
        arg[1,2,0,1]=(0.880665674235)*x[0]**o+(-0.833066777852)*x[0]+(-0.0556340786728)*x[1]**o+(0.620095583249)*x[1]+(-0.390556829051)*x[2]**o+(0.793481461864)*x[2]
        arg[1,2,1,0]=(0.832046852431)*x[0]**o+(0.4276990324)*x[0]+(-0.486292331356)*x[1]**o+(0.990296730852)*x[1]+(-0.381732943927)*x[2]**o+(0.225838720655)*x[2]
        arg[1,2,1,1]=(-0.971477034333)*x[0]**o+(0.819409035213)*x[0]+(-0.610341797903)*x[1]**o+(0.842186877805)*x[1]+(0.571187503044)*x[2]**o+(-0.150565006374)*x[2]
        arg[1,2,2,0]=(0.266080624706)*x[0]**o+(0.893377400845)*x[0]+(0.718525426441)*x[1]**o+(-0.847615622286)*x[1]+(0.614914866)*x[2]**o+(0.826503774974)*x[2]
        arg[1,2,2,1]=(0.998060871997)*x[0]**o+(-0.572523112154)*x[0]+(-0.786785614822)*x[1]**o+(0.556952019953)*x[1]+(0.804849394796)*x[2]**o+(-0.201157281118)*x[2]
        arg[1,3,0,0]=(-0.322048105751)*x[0]**o+(0.215441634353)*x[0]+(0.203298400258)*x[1]**o+(0.452071048161)*x[1]+(0.0134315902731)*x[2]**o+(0.240098266028)*x[2]
        arg[1,3,0,1]=(-0.109845136841)*x[0]**o+(0.0479663457074)*x[0]+(0.899394604931)*x[1]**o+(0.853608214151)*x[1]+(-0.27487885579)*x[2]**o+(-0.0236702866567)*x[2]
        arg[1,3,1,0]=(0.948550474293)*x[0]**o+(0.359077475995)*x[0]+(0.655387467125)*x[1]**o+(-0.0501114084308)*x[1]+(-0.244470769181)*x[2]**o+(0.670276065978)*x[2]
        arg[1,3,1,1]=(-0.860769147822)*x[0]**o+(-0.738449680804)*x[0]+(0.840959189643)*x[1]**o+(0.229930283198)*x[1]+(-0.521034843253)*x[2]**o+(-0.50213233896)*x[2]
        arg[1,3,2,0]=(0.29910216992)*x[0]**o+(0.411953562132)*x[0]+(0.777584507308)*x[1]**o+(0.41482951697)*x[1]+(-0.948751119313)*x[2]**o+(-0.526573791564)*x[2]
        arg[1,3,2,1]=(-0.768167653244)*x[0]**o+(-0.318762199437)*x[0]+(0.7566706966)*x[1]**o+(-0.151347269999)*x[1]+(-0.626690637485)*x[2]**o+(-0.731518248609)*x[2]
        arg[1,4,0,0]=(0.0147733854143)*x[0]**o+(-0.812988077571)*x[0]+(0.815385483312)*x[1]**o+(0.285326283687)*x[1]+(0.872502797762)*x[2]**o+(-0.748392032843)*x[2]
        arg[1,4,0,1]=(0.172931930795)*x[0]**o+(0.425088340505)*x[0]+(0.0122969950852)*x[1]**o+(0.556865378995)*x[1]+(0.614686173604)*x[2]**o+(0.966581266651)*x[2]
        arg[1,4,1,0]=(0.725270959871)*x[0]**o+(-0.672683754253)*x[0]+(0.486696038678)*x[1]**o+(-0.53856418144)*x[1]+(-0.295197744155)*x[2]**o+(0.0610876962829)*x[2]
        arg[1,4,1,1]=(0.942300770794)*x[0]**o+(0.876440453364)*x[0]+(0.432652207093)*x[1]**o+(-0.562629961162)*x[1]+(0.497526473424)*x[2]**o+(-0.165824324383)*x[2]
        arg[1,4,2,0]=(-0.668927175078)*x[0]**o+(0.587283304457)*x[0]+(0.588305038304)*x[1]**o+(0.087906366831)*x[1]+(-0.907721198172)*x[2]**o+(-0.506067369924)*x[2]
        arg[1,4,2,1]=(0.899071894553)*x[0]**o+(0.920678485704)*x[0]+(-0.244107214117)*x[1]**o+(0.196327093214)*x[1]+(-0.538075261013)*x[2]**o+(-0.925646646321)*x[2]
        arg[2,0,0,0]=(-0.113452114076)*x[0]**o+(0.541178389983)*x[0]+(0.501083424074)*x[1]**o+(-0.234654083639)*x[1]+(-0.435569149263)*x[2]**o+(0.671517947867)*x[2]
        arg[2,0,0,1]=(-0.00139653535956)*x[0]**o+(-0.93731587459)*x[0]+(-0.387786776826)*x[1]**o+(0.361445822788)*x[1]+(-0.0958490804452)*x[2]**o+(0.22475163005)*x[2]
        arg[2,0,1,0]=(0.100832420019)*x[0]**o+(-0.957577198313)*x[0]+(0.244479124631)*x[1]**o+(-0.589295650233)*x[1]+(-0.11020792463)*x[2]**o+(0.969023424875)*x[2]
        arg[2,0,1,1]=(-0.82757398282)*x[0]**o+(0.665274113482)*x[0]+(0.219624146627)*x[1]**o+(0.604687589384)*x[1]+(0.539774513376)*x[2]**o+(0.676136495778)*x[2]
        arg[2,0,2,0]=(-0.869539421193)*x[0]**o+(0.449645390105)*x[0]+(-0.216356671763)*x[1]**o+(-0.191616800811)*x[1]+(-0.324126591392)*x[2]**o+(0.726527544226)*x[2]
        arg[2,0,2,1]=(-0.522340761977)*x[0]**o+(-0.253136332372)*x[0]+(-0.993693358789)*x[1]**o+(0.689338979208)*x[1]+(-0.73030598892)*x[2]**o+(0.604868622965)*x[2]
        arg[2,1,0,0]=(-0.87285436276)*x[0]**o+(-0.665917385941)*x[0]+(0.105570880359)*x[1]**o+(0.773780432278)*x[1]+(-0.0932677950401)*x[2]**o+(0.55563257373)*x[2]
        arg[2,1,0,1]=(-0.717823895492)*x[0]**o+(-0.843992380543)*x[0]+(0.348730031558)*x[1]**o+(-0.0641727895105)*x[1]+(-0.575332519937)*x[2]**o+(0.566731137573)*x[2]
        arg[2,1,1,0]=(-0.749216309273)*x[0]**o+(0.945232679736)*x[0]+(-0.984694983452)*x[1]**o+(-0.697422850579)*x[1]+(0.573407778839)*x[2]**o+(0.654548962131)*x[2]
        arg[2,1,1,1]=(-0.951637762959)*x[0]**o+(-0.0299724748286)*x[0]+(-0.784527116834)*x[1]**o+(0.490138786409)*x[1]+(0.945743565011)*x[2]**o+(0.158024494836)*x[2]
        arg[2,1,2,0]=(0.80439224967)*x[0]**o+(0.889509225531)*x[0]+(-0.178335319647)*x[1]**o+(-0.365669987413)*x[1]+(-0.170055755127)*x[2]**o+(0.258843711555)*x[2]
        arg[2,1,2,1]=(0.520706901588)*x[0]**o+(0.897178241272)*x[0]+(-0.128495163664)*x[1]**o+(-0.404742110163)*x[1]+(0.140333496135)*x[2]**o+(0.31429703244)*x[2]
        arg[2,2,0,0]=(-0.933201442136)*x[0]**o+(0.0083650170184)*x[0]+(-0.281807642508)*x[1]**o+(-0.09193002721)*x[1]+(-0.422582781227)*x[2]**o+(0.358915935551)*x[2]
        arg[2,2,0,1]=(-0.09712053324)*x[0]**o+(-0.0752448353447)*x[0]+(0.41291697894)*x[1]**o+(0.593823615119)*x[1]+(0.954183095989)*x[2]**o+(0.479576723309)*x[2]
        arg[2,2,1,0]=(-0.48592273499)*x[0]**o+(-0.555807193072)*x[0]+(0.842926147107)*x[1]**o+(-0.0760474608316)*x[1]+(0.864590424311)*x[2]**o+(-0.854721691042)*x[2]
        arg[2,2,1,1]=(0.238261310086)*x[0]**o+(-0.506114025767)*x[0]+(-0.534154656267)*x[1]**o+(-0.282262066272)*x[1]+(-0.241950678835)*x[2]**o+(-0.596913007205)*x[2]
        arg[2,2,2,0]=(0.35002425052)*x[0]**o+(-0.724235915518)*x[0]+(-0.443311896206)*x[1]**o+(0.0183169190559)*x[1]+(-0.180995873436)*x[2]**o+(0.949105760518)*x[2]
        arg[2,2,2,1]=(-0.524596480672)*x[0]**o+(-0.72511087285)*x[0]+(-0.793159588655)*x[1]**o+(0.197579071177)*x[1]+(0.214510478855)*x[2]**o+(0.592011219443)*x[2]
        arg[2,3,0,0]=(-0.777144207151)*x[0]**o+(0.821815068413)*x[0]+(0.828183715461)*x[1]**o+(-0.77742744879)*x[1]+(0.520088528639)*x[2]**o+(0.564796500907)*x[2]
        arg[2,3,0,1]=(-0.444252706506)*x[0]**o+(-0.999658246414)*x[0]+(0.458490846376)*x[1]**o+(0.206371738627)*x[1]+(-0.5943830165)*x[2]**o+(0.125954475804)*x[2]
        arg[2,3,1,0]=(-0.499555379078)*x[0]**o+(0.667767779032)*x[0]+(-0.169053599596)*x[1]**o+(0.587608309525)*x[1]+(-0.99317016838)*x[2]**o+(-0.580232194372)*x[2]
        arg[2,3,1,1]=(0.881736170108)*x[0]**o+(-0.0221128885544)*x[0]+(-0.239202356219)*x[1]**o+(-0.825250840397)*x[1]+(-0.34138233902)*x[2]**o+(-0.900437209752)*x[2]
        arg[2,3,2,0]=(-0.810415345283)*x[0]**o+(0.671639285402)*x[0]+(0.0577696593549)*x[1]**o+(0.12466039802)*x[1]+(-0.164952472389)*x[2]**o+(-0.881356759483)*x[2]
        arg[2,3,2,1]=(0.641411687742)*x[0]**o+(0.939465110042)*x[0]+(0.182541049996)*x[1]**o+(-0.502132165421)*x[1]+(-0.914212670088)*x[2]**o+(0.361356243622)*x[2]
        arg[2,4,0,0]=(0.696033328872)*x[0]**o+(0.854329989895)*x[0]+(0.66092830442)*x[1]**o+(-0.165623528752)*x[1]+(0.587322879532)*x[2]**o+(-0.441145527759)*x[2]
        arg[2,4,0,1]=(0.885589185979)*x[0]**o+(0.170856006811)*x[0]+(-0.500114387063)*x[1]**o+(-0.772574748562)*x[1]+(0.599300325869)*x[2]**o+(0.0950082175327)*x[2]
        arg[2,4,1,0]=(0.877739402691)*x[0]**o+(0.494715865857)*x[0]+(-0.4548916845)*x[1]**o+(-0.108381552398)*x[1]+(-0.620522177203)*x[2]**o+(-0.375546939131)*x[2]
        arg[2,4,1,1]=(-0.108044365878)*x[0]**o+(-0.592058059304)*x[0]+(-0.64481990676)*x[1]**o+(-0.903674017194)*x[1]+(0.0964052945913)*x[2]**o+(0.357819426568)*x[2]
        arg[2,4,2,0]=(-0.686157836559)*x[0]**o+(0.585514351597)*x[0]+(-0.5623443108)*x[1]**o+(-0.636059380122)*x[1]+(0.469863235081)*x[2]**o+(0.374567303622)*x[2]
        arg[2,4,2,1]=(0.214800008136)*x[0]**o+(0.0680448664819)*x[0]+(0.722930302776)*x[1]**o+(0.107573165145)*x[1]+(0.0027804595356)*x[2]**o+(0.725566605544)*x[2]
        arg[3,0,0,0]=(-0.273256791086)*x[0]**o+(0.801129507153)*x[0]+(-0.840227644476)*x[1]**o+(-0.31594258736)*x[1]+(-0.140806177065)*x[2]**o+(-0.0958103115672)*x[2]
        arg[3,0,0,1]=(0.588534583503)*x[0]**o+(0.242235627811)*x[0]+(-0.541539488722)*x[1]**o+(0.624385574868)*x[1]+(-0.0641371754789)*x[2]**o+(-0.635676751281)*x[2]
        arg[3,0,1,0]=(0.81967100218)*x[0]**o+(0.671597165436)*x[0]+(0.160179001916)*x[1]**o+(-0.226714136475)*x[1]+(-0.523709112534)*x[2]**o+(0.932797007296)*x[2]
        arg[3,0,1,1]=(0.707793115256)*x[0]**o+(-0.0995173271712)*x[0]+(-0.594597614398)*x[1]**o+(-0.72096550461)*x[1]+(-0.373631371949)*x[2]**o+(-0.282151921803)*x[2]
        arg[3,0,2,0]=(0.873307297971)*x[0]**o+(0.0950091191819)*x[0]+(-0.534108539131)*x[1]**o+(0.567381193719)*x[1]+(-0.276691140405)*x[2]**o+(0.84882104254)*x[2]
        arg[3,0,2,1]=(-0.895148878411)*x[0]**o+(-0.880973451462)*x[0]+(0.105602819158)*x[1]**o+(-0.836475687487)*x[1]+(-0.18380164164)*x[2]**o+(-0.391643939001)*x[2]
        arg[3,1,0,0]=(-0.144070349397)*x[0]**o+(-0.247578520564)*x[0]+(0.512469248899)*x[1]**o+(0.0369808259097)*x[1]+(0.67517925106)*x[2]**o+(-0.306122403522)*x[2]
        arg[3,1,0,1]=(0.389023591419)*x[0]**o+(0.0335324297663)*x[0]+(0.166380432563)*x[1]**o+(0.415133512101)*x[1]+(-0.956055398028)*x[2]**o+(-0.069254560597)*x[2]
        arg[3,1,1,0]=(-0.253194755795)*x[0]**o+(-0.432240637655)*x[0]+(0.886730830871)*x[1]**o+(0.94685399231)*x[1]+(-0.0193581886643)*x[2]**o+(-0.828124732153)*x[2]
        arg[3,1,1,1]=(0.948739050057)*x[0]**o+(-0.200402018913)*x[0]+(0.062573402994)*x[1]**o+(-0.408727698463)*x[1]+(-0.0334411087309)*x[2]**o+(-0.676147119957)*x[2]
        arg[3,1,2,0]=(0.249237167322)*x[0]**o+(-0.621387879739)*x[0]+(-0.745335388751)*x[1]**o+(-0.183173004074)*x[1]+(0.56632553768)*x[2]**o+(-0.519909176525)*x[2]
        arg[3,1,2,1]=(-0.660822495815)*x[0]**o+(0.0459275869317)*x[0]+(-0.0853936912232)*x[1]**o+(-0.895502076207)*x[1]+(0.150013238845)*x[2]**o+(0.201527905115)*x[2]
        arg[3,2,0,0]=(0.0846880899978)*x[0]**o+(-0.450721252185)*x[0]+(0.0100224498309)*x[1]**o+(-0.729399043167)*x[1]+(0.249073157161)*x[2]**o+(-0.313056982897)*x[2]
        arg[3,2,0,1]=(0.349123663394)*x[0]**o+(-0.0439266646004)*x[0]+(0.201749457716)*x[1]**o+(-0.29961557135)*x[1]+(0.247657591065)*x[2]**o+(0.702448030656)*x[2]
        arg[3,2,1,0]=(-0.67551758529)*x[0]**o+(-0.856271486186)*x[0]+(-0.337698270178)*x[1]**o+(-0.855526501932)*x[1]+(0.204628923051)*x[2]**o+(0.0425229547861)*x[2]
        arg[3,2,1,1]=(0.913895958603)*x[0]**o+(0.33488814727)*x[0]+(0.725768429772)*x[1]**o+(0.31487179035)*x[1]+(-0.926895768372)*x[2]**o+(-0.303623128744)*x[2]
        arg[3,2,2,0]=(0.695497510732)*x[0]**o+(-0.71819800795)*x[0]+(0.0949892877746)*x[1]**o+(-0.371952684199)*x[1]+(-0.712679288901)*x[2]**o+(-0.839032166941)*x[2]
        arg[3,2,2,1]=(0.847915632309)*x[0]**o+(0.489320767225)*x[0]+(0.884694888545)*x[1]**o+(-0.836734066966)*x[1]+(-0.782643394677)*x[2]**o+(0.998012000062)*x[2]
        arg[3,3,0,0]=(0.400343531732)*x[0]**o+(-0.977399566427)*x[0]+(-0.0491815761683)*x[1]**o+(0.820343030844)*x[1]+(0.145276965371)*x[2]**o+(0.106181410329)*x[2]
        arg[3,3,0,1]=(0.39509119571)*x[0]**o+(-0.532152199068)*x[0]+(0.0961163031465)*x[1]**o+(-0.845734786516)*x[1]+(0.0685207262665)*x[2]**o+(0.10725771579)*x[2]
        arg[3,3,1,0]=(-0.326475146957)*x[0]**o+(0.0491193078417)*x[0]+(-0.193405294452)*x[1]**o+(0.283579426128)*x[1]+(0.885442239373)*x[2]**o+(-0.838544460442)*x[2]
        arg[3,3,1,1]=(-0.502234549601)*x[0]**o+(-0.764617462736)*x[0]+(0.52701849705)*x[1]**o+(-0.423245302614)*x[1]+(0.728096320995)*x[2]**o+(0.143356081954)*x[2]
        arg[3,3,2,0]=(0.924562662058)*x[0]**o+(-0.0120799887424)*x[0]+(-0.342886608544)*x[1]**o+(0.609435784717)*x[1]+(0.392296911228)*x[2]**o+(0.572866548262)*x[2]
        arg[3,3,2,1]=(0.661267105524)*x[0]**o+(-0.71847134372)*x[0]+(-0.913866381825)*x[1]**o+(-0.502556458508)*x[1]+(0.201214639904)*x[2]**o+(-0.431939125167)*x[2]
        arg[3,4,0,0]=(0.391785002874)*x[0]**o+(0.424885787931)*x[0]+(-0.377558346944)*x[1]**o+(-0.556924666311)*x[1]+(0.511852194353)*x[2]**o+(0.514261734074)*x[2]
        arg[3,4,0,1]=(-0.269148156354)*x[0]**o+(0.692033978804)*x[0]+(-0.390604590454)*x[1]**o+(-0.551681907742)*x[1]+(0.0613720420346)*x[2]**o+(-0.508841982991)*x[2]
        arg[3,4,1,0]=(0.593170387694)*x[0]**o+(-0.00676980821753)*x[0]+(0.788564472913)*x[1]**o+(0.823094059865)*x[1]+(0.52895485971)*x[2]**o+(0.88849618397)*x[2]
        arg[3,4,1,1]=(0.772185283881)*x[0]**o+(0.759014894154)*x[0]+(-0.142739578724)*x[1]**o+(-0.141899255898)*x[1]+(0.479086662114)*x[2]**o+(0.68993908918)*x[2]
        arg[3,4,2,0]=(0.998097253401)*x[0]**o+(0.621254339576)*x[0]+(-0.692540865624)*x[1]**o+(0.716545091382)*x[1]+(0.478209703594)*x[2]**o+(0.259063088226)*x[2]
        arg[3,4,2,1]=(-0.321962318028)*x[0]**o+(0.0377531939042)*x[0]+(-0.362041758315)*x[1]**o+(0.632474956936)*x[1]+(0.133972776903)*x[2]**o+(-0.341803258375)*x[2]
        ref[0,0,0,0]=(-0.484602377547)*(1+2.*(dim-1.)/(o+1.))+(-1.0194202985)*dim
        ref[0,0,0,1]=(-0.835132633821)*(1+2.*(dim-1.)/(o+1.))+(0.616687157924)*dim
        ref[0,0,1,0]=(1.49678131808)*(1+2.*(dim-1.)/(o+1.))+(0.880777811066)*dim
        ref[0,0,1,1]=(0.910664643761)*(1+2.*(dim-1.)/(o+1.))+(-0.961299455217)*dim
        ref[0,0,2,0]=(0.946573940383)*(1+2.*(dim-1.)/(o+1.))+(0.598873680457)*dim
        ref[0,0,2,1]=(0.872725648736)*(1+2.*(dim-1.)/(o+1.))+(-1.54360766814)*dim
        ref[0,1,0,0]=(1.67226553782)*(1+2.*(dim-1.)/(o+1.))+(0.0561023038674)*dim
        ref[0,1,0,1]=(1.15582406251)*(1+2.*(dim-1.)/(o+1.))+(-0.620028515442)*dim
        ref[0,1,1,0]=(-1.79024527224)*(1+2.*(dim-1.)/(o+1.))+(0.726554075535)*dim
        ref[0,1,1,1]=(0.8477406514)*(1+2.*(dim-1.)/(o+1.))+(-1.15509819622)*dim
        ref[0,1,2,0]=(0.0209750791326)*(1+2.*(dim-1.)/(o+1.))+(-1.00141913872)*dim
        ref[0,1,2,1]=(0.569876032064)*(1+2.*(dim-1.)/(o+1.))+(0.271451611059)*dim
        ref[0,2,0,0]=(0.19197323238)*(1+2.*(dim-1.)/(o+1.))+(0.320608976525)*dim
        ref[0,2,0,1]=(-0.864025126798)*(1+2.*(dim-1.)/(o+1.))+(0.792122272387)*dim
        ref[0,2,1,0]=(-1.9943606725)*(1+2.*(dim-1.)/(o+1.))+(1.25566864927)*dim
        ref[0,2,1,1]=(-1.0628223267)*(1+2.*(dim-1.)/(o+1.))+(-1.32772813107)*dim
        ref[0,2,2,0]=(1.40455685015)*(1+2.*(dim-1.)/(o+1.))+(-1.31673180399)*dim
        ref[0,2,2,1]=(1.35132033585)*(1+2.*(dim-1.)/(o+1.))+(-1.32702265435)*dim
        ref[0,3,0,0]=(-0.949679155841)*(1+2.*(dim-1.)/(o+1.))+(-0.739650532418)*dim
        ref[0,3,0,1]=(0.47964320732)*(1+2.*(dim-1.)/(o+1.))+(0.473037089003)*dim
        ref[0,3,1,0]=(-0.432320617013)*(1+2.*(dim-1.)/(o+1.))+(0.850735495297)*dim
        ref[0,3,1,1]=(-0.780121359247)*(1+2.*(dim-1.)/(o+1.))+(-1.17524947794)*dim
        ref[0,3,2,0]=(-0.791891130098)*(1+2.*(dim-1.)/(o+1.))+(0.557003562128)*dim
        ref[0,3,2,1]=(0.614468356202)*(1+2.*(dim-1.)/(o+1.))+(-0.920106974125)*dim
        ref[0,4,0,0]=(-0.108571506377)*(1+2.*(dim-1.)/(o+1.))+(0.0716679405256)*dim
        ref[0,4,0,1]=(2.15955613929)*(1+2.*(dim-1.)/(o+1.))+(0.862657265402)*dim
        ref[0,4,1,0]=(-0.239021888652)*(1+2.*(dim-1.)/(o+1.))+(1.46771841022)*dim
        ref[0,4,1,1]=(0.596017340702)*(1+2.*(dim-1.)/(o+1.))+(-0.343059728803)*dim
        ref[0,4,2,0]=(-0.254445317045)*(1+2.*(dim-1.)/(o+1.))+(0.185808795951)*dim
        ref[0,4,2,1]=(0.520266014371)*(1+2.*(dim-1.)/(o+1.))+(-1.99456473805)*dim
        ref[1,0,0,0]=(-1.07260356292)*(1+2.*(dim-1.)/(o+1.))+(0.374273678021)*dim
        ref[1,0,0,1]=(0.300858233864)*(1+2.*(dim-1.)/(o+1.))+(-0.958946395922)*dim
        ref[1,0,1,0]=(-1.69631340214)*(1+2.*(dim-1.)/(o+1.))+(-0.096563879864)*dim
        ref[1,0,1,1]=(-1.29948775767)*(1+2.*(dim-1.)/(o+1.))+(-1.29853569383)*dim
        ref[1,0,2,0]=(2.11639869443)*(1+2.*(dim-1.)/(o+1.))+(0.783285612541)*dim
        ref[1,0,2,1]=(-0.224039580872)*(1+2.*(dim-1.)/(o+1.))+(1.35876351947)*dim
        ref[1,1,0,0]=(-1.48458285103)*(1+2.*(dim-1.)/(o+1.))+(-0.917614145542)*dim
        ref[1,1,0,1]=(0.92188880584)*(1+2.*(dim-1.)/(o+1.))+(0.569756278479)*dim
        ref[1,1,1,0]=(-0.315193818122)*(1+2.*(dim-1.)/(o+1.))+(-1.87410298298)*dim
        ref[1,1,1,1]=(-0.17620361977)*(1+2.*(dim-1.)/(o+1.))+(-0.174309770317)*dim
        ref[1,1,2,0]=(1.91602140435)*(1+2.*(dim-1.)/(o+1.))+(-0.762727403622)*dim
        ref[1,1,2,1]=(-0.481090245186)*(1+2.*(dim-1.)/(o+1.))+(0.302365878371)*dim
        ref[1,2,0,0]=(1.51144307636)*(1+2.*(dim-1.)/(o+1.))+(-0.469903943621)*dim
        ref[1,2,0,1]=(0.434474766511)*(1+2.*(dim-1.)/(o+1.))+(0.580510267262)*dim
        ref[1,2,1,0]=(-0.0359784228521)*(1+2.*(dim-1.)/(o+1.))+(1.64383448391)*dim
        ref[1,2,1,1]=(-1.01063132919)*(1+2.*(dim-1.)/(o+1.))+(1.51103090664)*dim
        ref[1,2,2,0]=(1.59952091715)*(1+2.*(dim-1.)/(o+1.))+(0.872265553532)*dim
        ref[1,2,2,1]=(1.01612465197)*(1+2.*(dim-1.)/(o+1.))+(-0.216728373319)*dim
        ref[1,3,0,0]=(-0.10531811522)*(1+2.*(dim-1.)/(o+1.))+(0.907610948542)*dim
        ref[1,3,0,1]=(0.5146706123)*(1+2.*(dim-1.)/(o+1.))+(0.877904273202)*dim
        ref[1,3,1,0]=(1.35946717224)*(1+2.*(dim-1.)/(o+1.))+(0.979242133542)*dim
        ref[1,3,1,1]=(-0.540844801432)*(1+2.*(dim-1.)/(o+1.))+(-1.01065173657)*dim
        ref[1,3,2,0]=(0.127935557915)*(1+2.*(dim-1.)/(o+1.))+(0.300209287538)*dim
        ref[1,3,2,1]=(-0.63818759413)*(1+2.*(dim-1.)/(o+1.))+(-1.20162771805)*dim
        ref[1,4,0,0]=(1.70266166649)*(1+2.*(dim-1.)/(o+1.))+(-1.27605382673)*dim
        ref[1,4,0,1]=(0.799915099484)*(1+2.*(dim-1.)/(o+1.))+(1.94853498615)*dim
        ref[1,4,1,0]=(0.916769254394)*(1+2.*(dim-1.)/(o+1.))+(-1.15016023941)*dim
        ref[1,4,1,1]=(1.87247945131)*(1+2.*(dim-1.)/(o+1.))+(0.147986167818)*dim
        ref[1,4,2,0]=(-0.988343334946)*(1+2.*(dim-1.)/(o+1.))+(0.169122301365)*dim
        ref[1,4,2,1]=(0.116889419423)*(1+2.*(dim-1.)/(o+1.))+(0.191358932597)*dim
        ref[2,0,0,0]=(-0.0479378392653)*(1+2.*(dim-1.)/(o+1.))+(0.978042254211)*dim
        ref[2,0,0,1]=(-0.485032392631)*(1+2.*(dim-1.)/(o+1.))+(-0.351118421752)*dim
        ref[2,0,1,0]=(0.23510362002)*(1+2.*(dim-1.)/(o+1.))+(-0.577849423671)*dim
        ref[2,0,1,1]=(-0.068175322817)*(1+2.*(dim-1.)/(o+1.))+(1.94609819864)*dim
        ref[2,0,2,0]=(-1.41002268435)*(1+2.*(dim-1.)/(o+1.))+(0.98455613352)*dim
        ref[2,0,2,1]=(-2.24634010969)*(1+2.*(dim-1.)/(o+1.))+(1.0410712698)*dim
        ref[2,1,0,0]=(-0.860551277441)*(1+2.*(dim-1.)/(o+1.))+(0.663495620068)*dim
        ref[2,1,0,1]=(-0.944426383871)*(1+2.*(dim-1.)/(o+1.))+(-0.341434032481)*dim
        ref[2,1,1,0]=(-1.16050351389)*(1+2.*(dim-1.)/(o+1.))+(0.902358791288)*dim
        ref[2,1,1,1]=(-0.790421314781)*(1+2.*(dim-1.)/(o+1.))+(0.618190806416)*dim
        ref[2,1,2,0]=(0.456001174897)*(1+2.*(dim-1.)/(o+1.))+(0.782682949672)*dim
        ref[2,1,2,1]=(0.532545234059)*(1+2.*(dim-1.)/(o+1.))+(0.806733163549)*dim
        ref[2,2,0,0]=(-1.63759186587)*(1+2.*(dim-1.)/(o+1.))+(0.275350925359)*dim
        ref[2,2,0,1]=(1.26997954169)*(1+2.*(dim-1.)/(o+1.))+(0.998155503083)*dim
        ref[2,2,1,0]=(1.22159383643)*(1+2.*(dim-1.)/(o+1.))+(-1.48657634495)*dim
        ref[2,2,1,1]=(-0.537844025016)*(1+2.*(dim-1.)/(o+1.))+(-1.38528909924)*dim
        ref[2,2,2,0]=(-0.274283519122)*(1+2.*(dim-1.)/(o+1.))+(0.243186764056)*dim
        ref[2,2,2,1]=(-1.10324559047)*(1+2.*(dim-1.)/(o+1.))+(0.0644794177698)*dim
        ref[2,3,0,0]=(0.571128036949)*(1+2.*(dim-1.)/(o+1.))+(0.60918412053)*dim
        ref[2,3,0,1]=(-0.580144876629)*(1+2.*(dim-1.)/(o+1.))+(-0.667332031982)*dim
        ref[2,3,1,0]=(-1.66177914705)*(1+2.*(dim-1.)/(o+1.))+(0.675143894185)*dim
        ref[2,3,1,1]=(0.301151474869)*(1+2.*(dim-1.)/(o+1.))+(-1.7478009387)*dim
        ref[2,3,2,0]=(-0.917598158317)*(1+2.*(dim-1.)/(o+1.))+(-0.0850570760611)*dim
        ref[2,3,2,1]=(-0.09025993235)*(1+2.*(dim-1.)/(o+1.))+(0.798689188243)*dim
        ref[2,4,0,0]=(1.94428451282)*(1+2.*(dim-1.)/(o+1.))+(0.247560933384)*dim
        ref[2,4,0,1]=(0.984775124785)*(1+2.*(dim-1.)/(o+1.))+(-0.506710524219)*dim
        ref[2,4,1,0]=(-0.197674459012)*(1+2.*(dim-1.)/(o+1.))+(0.0107873743289)*dim
        ref[2,4,1,1]=(-0.656458978046)*(1+2.*(dim-1.)/(o+1.))+(-1.13791264993)*dim
        ref[2,4,2,0]=(-0.778638912279)*(1+2.*(dim-1.)/(o+1.))+(0.324022275097)*dim
        ref[2,4,2,1]=(0.940510770447)*(1+2.*(dim-1.)/(o+1.))+(0.901184637171)*dim
        ref[3,0,0,0]=(-1.25429061263)*(1+2.*(dim-1.)/(o+1.))+(0.389376608226)*dim
        ref[3,0,0,1]=(-0.0171420806973)*(1+2.*(dim-1.)/(o+1.))+(0.230944451397)*dim
        ref[3,0,1,0]=(0.456140891562)*(1+2.*(dim-1.)/(o+1.))+(1.37768003626)*dim
        ref[3,0,1,1]=(-0.260435871091)*(1+2.*(dim-1.)/(o+1.))+(-1.10263475358)*dim
        ref[3,0,2,0]=(0.0625076184349)*(1+2.*(dim-1.)/(o+1.))+(1.51121135544)*dim
        ref[3,0,2,1]=(-0.973347700893)*(1+2.*(dim-1.)/(o+1.))+(-2.10909307795)*dim
        ref[3,1,0,0]=(1.04357815056)*(1+2.*(dim-1.)/(o+1.))+(-0.516720098176)*dim
        ref[3,1,0,1]=(-0.400651374046)*(1+2.*(dim-1.)/(o+1.))+(0.37941138127)*dim
        ref[3,1,1,0]=(0.614177886412)*(1+2.*(dim-1.)/(o+1.))+(-0.313511377498)*dim
        ref[3,1,1,1]=(0.97787134432)*(1+2.*(dim-1.)/(o+1.))+(-1.28527683733)*dim
        ref[3,1,2,0]=(0.0702273162506)*(1+2.*(dim-1.)/(o+1.))+(-1.32447006034)*dim
        ref[3,1,2,1]=(-0.596202948193)*(1+2.*(dim-1.)/(o+1.))+(-0.648046584161)*dim
        ref[3,2,0,0]=(0.34378369699)*(1+2.*(dim-1.)/(o+1.))+(-1.49317727825)*dim
        ref[3,2,0,1]=(0.798530712175)*(1+2.*(dim-1.)/(o+1.))+(0.358905794706)*dim
        ref[3,2,1,0]=(-0.808586932417)*(1+2.*(dim-1.)/(o+1.))+(-1.66927503333)*dim
        ref[3,2,1,1]=(0.712768620002)*(1+2.*(dim-1.)/(o+1.))+(0.346136808876)*dim
        ref[3,2,2,0]=(0.0778075096053)*(1+2.*(dim-1.)/(o+1.))+(-1.92918285909)*dim
        ref[3,2,2,1]=(0.949967126178)*(1+2.*(dim-1.)/(o+1.))+(0.650598700321)*dim
        ref[3,3,0,0]=(0.496438920934)*(1+2.*(dim-1.)/(o+1.))+(-0.0508751252546)*dim
        ref[3,3,0,1]=(0.559728225123)*(1+2.*(dim-1.)/(o+1.))+(-1.27062926979)*dim
        ref[3,3,1,0]=(0.365561797964)*(1+2.*(dim-1.)/(o+1.))+(-0.505845726473)*dim
        ref[3,3,1,1]=(0.752880268444)*(1+2.*(dim-1.)/(o+1.))+(-1.0445066834)*dim
        ref[3,3,2,0]=(0.973972964742)*(1+2.*(dim-1.)/(o+1.))+(1.17022234424)*dim
        ref[3,3,2,1]=(-0.0513846363967)*(1+2.*(dim-1.)/(o+1.))+(-1.65296692739)*dim
        ref[3,4,0,0]=(0.526078850284)*(1+2.*(dim-1.)/(o+1.))+(0.382222855695)*dim
        ref[3,4,0,1]=(-0.598380704773)*(1+2.*(dim-1.)/(o+1.))+(-0.368489911929)*dim
        ref[3,4,1,0]=(1.91068972032)*(1+2.*(dim-1.)/(o+1.))+(1.70482043562)*dim
        ref[3,4,1,1]=(1.10853236727)*(1+2.*(dim-1.)/(o+1.))+(1.30705472744)*dim
        ref[3,4,2,0]=(0.78376609137)*(1+2.*(dim-1.)/(o+1.))+(1.59686251918)*dim
        ref[3,4,2,1]=(-0.550031299439)*(1+2.*(dim-1.)/(o+1.))+(0.328424892465)*dim
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.276000764164)*x[0]**o+(-0.468805844816)*x[0]+(0.216181374155)*x[1]**o+(0.670874609882)*x[1]
        ref=(0.492182138319)*(1+2.*(dim-1.)/(o+1.))+(0.202068765065)*dim
      else:
        s=(0.959211859452)*x[0]**o+(0.856777496752)*x[0]+(-0.689682159726)*x[1]**o+(-0.0511538529405)*x[1]+(0.909142526772)*x[2]**o+(-0.851436719686)*x[2]
        ref=(1.1786722265)*(1+2.*(dim-1.)/(o+1.))+(-0.0458130758744)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(0.959628680059)*x[0]**o+(0.316358798368)*x[0]+(-0.11695939796)*x[1]**o+(0.467189695616)*x[1]
        s[1]=(-0.0914212792301)*x[0]**o+(-0.876964392495)*x[0]+(-0.241429076296)*x[1]**o+(-0.136283508929)*x[1]
        ref[0]=(0.842669282099)*(1+2.*(dim-1.)/(o+1.))+(0.783548493984)*dim
        ref[1]=(-0.332850355526)*(1+2.*(dim-1.)/(o+1.))+(-1.01324790142)*dim
      else:
        s[0]=(0.438221600861)*x[0]**o+(-0.675281168341)*x[0]+(-0.977876997798)*x[1]**o+(0.263292240228)*x[1]+(0.298700889488)*x[2]**o+(0.218464753318)*x[2]
        s[1]=(0.129309327387)*x[0]**o+(0.718818780853)*x[0]+(-0.829433536453)*x[1]**o+(0.189387074977)*x[1]+(-0.370123421171)*x[2]**o+(-0.944375947073)*x[2]
        ref[0]=(-0.240954507449)*(1+2.*(dim-1.)/(o+1.))+(-0.193524174795)*dim
        ref[1]=(-1.07024763024)*(1+2.*(dim-1.)/(o+1.))+(-0.0361700912426)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.179044774852)*x[0]**o+(-0.771154031526)*x[0]+(0.283792506671)*x[1]**o+(-0.402392048)*x[1]
        s[0,1]=(-0.232541435218)*x[0]**o+(-0.0245965827061)*x[0]+(0.645399819776)*x[1]**o+(-0.561735270705)*x[1]
        s[0,2]=(0.145947743942)*x[0]**o+(-0.575168618436)*x[0]+(-0.323186337184)*x[1]**o+(0.286768456651)*x[1]
        s[0,3]=(-0.850294957994)*x[0]**o+(0.338532201346)*x[0]+(-0.0793135342296)*x[1]**o+(-0.863030213073)*x[1]
        s[0,4]=(-0.250033615938)*x[0]**o+(0.0646802670443)*x[0]+(0.757218484623)*x[1]**o+(-0.136938974237)*x[1]
        s[1,0]=(-0.388186073304)*x[0]**o+(0.816982222815)*x[0]+(0.966648677362)*x[1]**o+(0.433441368441)*x[1]
        s[1,1]=(-0.26320466546)*x[0]**o+(0.814680348027)*x[0]+(0.121083870568)*x[1]**o+(0.546344037777)*x[1]
        s[1,2]=(0.999583479755)*x[0]**o+(-0.613738351596)*x[0]+(-0.15105692369)*x[1]**o+(-0.826110754043)*x[1]
        s[1,3]=(0.823160030826)*x[0]**o+(-0.986858175002)*x[0]+(0.979035971406)*x[1]**o+(0.495551722082)*x[1]
        s[1,4]=(0.322276907312)*x[0]**o+(-0.768815547878)*x[0]+(0.944581045957)*x[1]**o+(0.638853629633)*x[1]
        s[2,0]=(-0.715790872031)*x[0]**o+(-0.983342426781)*x[0]+(-0.584719832165)*x[1]**o+(0.372036497473)*x[1]
        s[2,1]=(0.00365756286977)*x[0]**o+(-0.715355493926)*x[0]+(0.812526897221)*x[1]**o+(-0.676997560296)*x[1]
        s[2,2]=(0.853542765125)*x[0]**o+(-0.468938820981)*x[0]+(0.958637393127)*x[1]**o+(-0.934834551087)*x[1]
        s[2,3]=(0.0411833783296)*x[0]**o+(0.668096714355)*x[0]+(-0.68394500964)*x[1]**o+(-0.915192447045)*x[1]
        s[2,4]=(0.477937998635)*x[0]**o+(-0.655023923727)*x[0]+(0.31178650811)*x[1]**o+(0.573276677618)*x[1]
        s[3,0]=(0.0827434421975)*x[0]**o+(0.116951368308)*x[0]+(-0.53041218008)*x[1]**o+(0.923217710706)*x[1]
        s[3,1]=(0.0352752409951)*x[0]**o+(0.186756758251)*x[0]+(-0.650196963391)*x[1]**o+(0.758872769044)*x[1]
        s[3,2]=(0.627293036559)*x[0]**o+(-0.101693009282)*x[0]+(-0.651126401234)*x[1]**o+(0.0946956663513)*x[1]
        s[3,3]=(-0.0645383041667)*x[0]**o+(0.411155076439)*x[0]+(0.936010412212)*x[1]**o+(-0.662112489076)*x[1]
        s[3,4]=(-0.749505083645)*x[0]**o+(0.767738728633)*x[0]+(-0.0521697451237)*x[1]**o+(0.743320460752)*x[1]
        ref[0,0]=(0.462837281523)*(1+2.*(dim-1.)/(o+1.))+(-1.17354607953)*dim
        ref[0,1]=(0.412858384558)*(1+2.*(dim-1.)/(o+1.))+(-0.586331853411)*dim
        ref[0,2]=(-0.177238593242)*(1+2.*(dim-1.)/(o+1.))+(-0.288400161786)*dim
        ref[0,3]=(-0.929608492223)*(1+2.*(dim-1.)/(o+1.))+(-0.524498011727)*dim
        ref[0,4]=(0.507184868685)*(1+2.*(dim-1.)/(o+1.))+(-0.0722587071931)*dim
        ref[1,0]=(0.578462604058)*(1+2.*(dim-1.)/(o+1.))+(1.25042359126)*dim
        ref[1,1]=(-0.142120794892)*(1+2.*(dim-1.)/(o+1.))+(1.3610243858)*dim
        ref[1,2]=(0.848526556066)*(1+2.*(dim-1.)/(o+1.))+(-1.43984910564)*dim
        ref[1,3]=(1.80219600223)*(1+2.*(dim-1.)/(o+1.))+(-0.49130645292)*dim
        ref[1,4]=(1.26685795327)*(1+2.*(dim-1.)/(o+1.))+(-0.129961918245)*dim
        ref[2,0]=(-1.3005107042)*(1+2.*(dim-1.)/(o+1.))+(-0.611305929308)*dim
        ref[2,1]=(0.816184460091)*(1+2.*(dim-1.)/(o+1.))+(-1.39235305422)*dim
        ref[2,2]=(1.81218015825)*(1+2.*(dim-1.)/(o+1.))+(-1.40377337207)*dim
        ref[2,3]=(-0.64276163131)*(1+2.*(dim-1.)/(o+1.))+(-0.247095732689)*dim
        ref[2,4]=(0.789724506745)*(1+2.*(dim-1.)/(o+1.))+(-0.0817472461083)*dim
        ref[3,0]=(-0.447668737882)*(1+2.*(dim-1.)/(o+1.))+(1.04016907901)*dim
        ref[3,1]=(-0.614921722396)*(1+2.*(dim-1.)/(o+1.))+(0.945629527295)*dim
        ref[3,2]=(-0.0238333646741)*(1+2.*(dim-1.)/(o+1.))+(-0.00699734293025)*dim
        ref[3,3]=(0.871472108046)*(1+2.*(dim-1.)/(o+1.))+(-0.250957412637)*dim
        ref[3,4]=(-0.801674828768)*(1+2.*(dim-1.)/(o+1.))+(1.51105918939)*dim
      else:
        s[0,0]=(-0.125646626393)*x[0]**o+(-0.248909495972)*x[0]+(0.694342489041)*x[1]**o+(-0.944409107438)*x[1]+(0.319473721262)*x[2]**o+(0.601806182335)*x[2]
        s[0,1]=(-0.505114968317)*x[0]**o+(-0.328058153553)*x[0]+(0.231927714111)*x[1]**o+(-0.20605100827)*x[1]+(0.441122232963)*x[2]**o+(-0.800716234123)*x[2]
        s[0,2]=(0.995136206899)*x[0]**o+(-0.853681974117)*x[0]+(-0.0627243072319)*x[1]**o+(0.974181482578)*x[1]+(0.719967223861)*x[2]**o+(0.714716693035)*x[2]
        s[0,3]=(-0.441934133426)*x[0]**o+(0.853576641618)*x[0]+(-0.981667008539)*x[1]**o+(0.628894290368)*x[1]+(-0.860902752279)*x[2]**o+(-0.265897164492)*x[2]
        s[0,4]=(0.793316938319)*x[0]**o+(-0.210698953461)*x[0]+(-0.642203222971)*x[1]**o+(-0.426236159989)*x[1]+(-0.425899483366)*x[2]**o+(0.160038345546)*x[2]
        s[1,0]=(0.708795168562)*x[0]**o+(-0.196948028271)*x[0]+(-0.935375576786)*x[1]**o+(0.0861198689411)*x[1]+(-0.921983001302)*x[2]**o+(0.460387290735)*x[2]
        s[1,1]=(0.929230715741)*x[0]**o+(-0.469953215705)*x[0]+(-0.327574657931)*x[1]**o+(0.508027765515)*x[1]+(-0.599239898886)*x[2]**o+(0.63360774997)*x[2]
        s[1,2]=(0.521095649571)*x[0]**o+(-0.306540618845)*x[0]+(0.989778780969)*x[1]**o+(0.942448043532)*x[1]+(0.696619526146)*x[2]**o+(0.316003759)*x[2]
        s[1,3]=(0.862728599037)*x[0]**o+(0.710693247125)*x[0]+(-0.319771560638)*x[1]**o+(0.00195165068796)*x[1]+(0.196231338915)*x[2]**o+(-0.540258673852)*x[2]
        s[1,4]=(0.608993531839)*x[0]**o+(-0.538278966186)*x[0]+(0.805409107065)*x[1]**o+(-0.306251894849)*x[1]+(0.137370330819)*x[2]**o+(0.723689377138)*x[2]
        s[2,0]=(0.725845088985)*x[0]**o+(-0.146963254784)*x[0]+(-0.33277537985)*x[1]**o+(0.905316206858)*x[1]+(0.833942228903)*x[2]**o+(-0.828915480014)*x[2]
        s[2,1]=(0.405007463559)*x[0]**o+(-0.58741177463)*x[0]+(-0.732389736864)*x[1]**o+(0.810006779688)*x[1]+(0.0934482848718)*x[2]**o+(-0.780478896444)*x[2]
        s[2,2]=(0.330277184347)*x[0]**o+(0.542618623736)*x[0]+(0.0984021435812)*x[1]**o+(0.528357675511)*x[1]+(-0.822522098782)*x[2]**o+(0.327999189729)*x[2]
        s[2,3]=(-0.65382619524)*x[0]**o+(0.683040803962)*x[0]+(-0.951007838791)*x[1]**o+(-0.907245567669)*x[1]+(-0.645828264634)*x[2]**o+(0.471775924817)*x[2]
        s[2,4]=(-0.881174731542)*x[0]**o+(0.902183751937)*x[0]+(0.0550862007787)*x[1]**o+(-0.251644685884)*x[1]+(0.220290011733)*x[2]**o+(-0.433798608361)*x[2]
        s[3,0]=(-0.822853797457)*x[0]**o+(0.92597725252)*x[0]+(0.151102447707)*x[1]**o+(-0.643773009686)*x[1]+(-0.82012950381)*x[2]**o+(-0.735602052424)*x[2]
        s[3,1]=(-0.0841053011733)*x[0]**o+(0.0930350084683)*x[0]+(0.276873742716)*x[1]**o+(-0.624783698693)*x[1]+(0.861829520969)*x[2]**o+(0.523311788689)*x[2]
        s[3,2]=(0.570824564972)*x[0]**o+(-0.258483951766)*x[0]+(-0.550248707418)*x[1]**o+(-0.762093783646)*x[1]+(-0.580531558601)*x[2]**o+(0.529122851261)*x[2]
        s[3,3]=(-0.945884266871)*x[0]**o+(0.947833330446)*x[0]+(0.94128603099)*x[1]**o+(-0.353478856114)*x[1]+(0.125480323773)*x[2]**o+(0.119572435249)*x[2]
        s[3,4]=(-0.0190004624928)*x[0]**o+(0.935780695738)*x[0]+(0.525428336584)*x[1]**o+(-0.94896065125)*x[1]+(-0.277950627306)*x[2]**o+(0.0152064531175)*x[2]
        ref[0,0]=(0.88816958391)*(1+2.*(dim-1.)/(o+1.))+(-0.591512421075)*dim
        ref[0,1]=(0.167934978757)*(1+2.*(dim-1.)/(o+1.))+(-1.33482539595)*dim
        ref[0,2]=(1.65237912353)*(1+2.*(dim-1.)/(o+1.))+(0.835216201496)*dim
        ref[0,3]=(-2.28450389424)*(1+2.*(dim-1.)/(o+1.))+(1.21657376749)*dim
        ref[0,4]=(-0.274785768018)*(1+2.*(dim-1.)/(o+1.))+(-0.476896767904)*dim
        ref[1,0]=(-1.14856340953)*(1+2.*(dim-1.)/(o+1.))+(0.349559131405)*dim
        ref[1,1]=(0.0024161589232)*(1+2.*(dim-1.)/(o+1.))+(0.67168229978)*dim
        ref[1,2]=(2.20749395669)*(1+2.*(dim-1.)/(o+1.))+(0.951911183687)*dim
        ref[1,3]=(0.739188377314)*(1+2.*(dim-1.)/(o+1.))+(0.172386223961)*dim
        ref[1,4]=(1.55177296972)*(1+2.*(dim-1.)/(o+1.))+(-0.120841483898)*dim
        ref[2,0]=(1.22701193804)*(1+2.*(dim-1.)/(o+1.))+(-0.0705625279405)*dim
        ref[2,1]=(-0.233933988434)*(1+2.*(dim-1.)/(o+1.))+(-0.557883891386)*dim
        ref[2,2]=(-0.393842770855)*(1+2.*(dim-1.)/(o+1.))+(1.39897548898)*dim
        ref[2,3]=(-2.25066229866)*(1+2.*(dim-1.)/(o+1.))+(0.247571161111)*dim
        ref[2,4]=(-0.60579851903)*(1+2.*(dim-1.)/(o+1.))+(0.216740457692)*dim
        ref[3,0]=(-1.49188085356)*(1+2.*(dim-1.)/(o+1.))+(-0.453397809589)*dim
        ref[3,1]=(1.05459796251)*(1+2.*(dim-1.)/(o+1.))+(-0.00843690153556)*dim
        ref[3,2]=(-0.559955701048)*(1+2.*(dim-1.)/(o+1.))+(-0.491454884151)*dim
        ref[3,3]=(0.120882087893)*(1+2.*(dim-1.)/(o+1.))+(0.713926909581)*dim
        ref[3,4]=(0.228477246785)*(1+2.*(dim-1.)/(o+1.))+(0.00202649760578)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.926772326685)*x[0]**o+(0.387486521987)*x[0]+(0.434356695921)*x[1]**o+(0.612313168985)*x[1]
        s[0,0,1]=(0.0416123602896)*x[0]**o+(0.688827142008)*x[0]+(-0.983728357354)*x[1]**o+(0.360807139866)*x[1]
        s[0,1,0]=(0.695266078006)*x[0]**o+(0.415695465239)*x[0]+(-0.679624573491)*x[1]**o+(0.428762900621)*x[1]
        s[0,1,1]=(0.313944654416)*x[0]**o+(0.0809925793325)*x[0]+(0.621639152049)*x[1]**o+(0.611203880481)*x[1]
        s[1,0,0]=(0.779313803934)*x[0]**o+(0.417564759976)*x[0]+(0.309499891258)*x[1]**o+(0.309580948656)*x[1]
        s[1,0,1]=(-0.165921233657)*x[0]**o+(0.754873050152)*x[0]+(-0.086251970981)*x[1]**o+(0.326647616211)*x[1]
        s[1,1,0]=(-0.803682583733)*x[0]**o+(-0.532584958606)*x[0]+(0.161316696631)*x[1]**o+(-0.956754947772)*x[1]
        s[1,1,1]=(0.229536665796)*x[0]**o+(0.436690509304)*x[0]+(0.111716074991)*x[1]**o+(0.0152188972478)*x[1]
        s[2,0,0]=(0.431277528457)*x[0]**o+(-0.549627071548)*x[0]+(0.896434242812)*x[1]**o+(0.310788829239)*x[1]
        s[2,0,1]=(0.337481979979)*x[0]**o+(-0.115120163813)*x[0]+(0.261492211787)*x[1]**o+(-0.78544941385)*x[1]
        s[2,1,0]=(-0.930198652575)*x[0]**o+(0.378441956425)*x[0]+(0.10805648813)*x[1]**o+(-0.436097313908)*x[1]
        s[2,1,1]=(0.249959291812)*x[0]**o+(0.836638711074)*x[0]+(0.0728794590137)*x[1]**o+(0.66862732862)*x[1]
        s[3,0,0]=(-0.738201854061)*x[0]**o+(0.772813906884)*x[0]+(-0.181342905715)*x[1]**o+(0.804464512448)*x[1]
        s[3,0,1]=(-0.196081244053)*x[0]**o+(0.994865977727)*x[0]+(0.842797040161)*x[1]**o+(0.821509016638)*x[1]
        s[3,1,0]=(0.833815509702)*x[0]**o+(0.577383594944)*x[0]+(-0.570130606584)*x[1]**o+(-0.0805462111487)*x[1]
        s[3,1,1]=(-0.8554995951)*x[0]**o+(0.720808128606)*x[0]+(0.457881428951)*x[1]**o+(-0.0471201858303)*x[1]
        s[4,0,0]=(0.48208350846)*x[0]**o+(0.47231745613)*x[0]+(-0.889701258367)*x[1]**o+(-0.630128265742)*x[1]
        s[4,0,1]=(-0.252911141671)*x[0]**o+(0.49998513292)*x[0]+(0.394792632318)*x[1]**o+(-0.622944802336)*x[1]
        s[4,1,0]=(-0.677909127453)*x[0]**o+(0.396645756207)*x[0]+(-0.723263540777)*x[1]**o+(-0.339508447056)*x[1]
        s[4,1,1]=(-0.807950411362)*x[0]**o+(-0.149082460629)*x[0]+(-0.841669340631)*x[1]**o+(0.888900711982)*x[1]
        s[5,0,0]=(-0.560462354311)*x[0]**o+(0.00127986811316)*x[0]+(-0.21694183911)*x[1]**o+(-0.815224807309)*x[1]
        s[5,0,1]=(0.767918970281)*x[0]**o+(-0.0975926175116)*x[0]+(0.281160215987)*x[1]**o+(0.38258099137)*x[1]
        s[5,1,0]=(-0.0755717349023)*x[0]**o+(-0.321990446321)*x[0]+(-0.203426543697)*x[1]**o+(0.782003123159)*x[1]
        s[5,1,1]=(-0.947191134408)*x[0]**o+(-0.710118492404)*x[0]+(-0.0923673220139)*x[1]**o+(-0.103352087028)*x[1]
        ref[0,0,0]=(-0.492415630764)*(1+2.*(dim-1.)/(o+1.))+(0.999799690972)*dim
        ref[0,0,1]=(-0.942115997065)*(1+2.*(dim-1.)/(o+1.))+(1.04963428187)*dim
        ref[0,1,0]=(0.0156415045147)*(1+2.*(dim-1.)/(o+1.))+(0.84445836586)*dim
        ref[0,1,1]=(0.935583806465)*(1+2.*(dim-1.)/(o+1.))+(0.692196459814)*dim
        ref[1,0,0]=(1.08881369519)*(1+2.*(dim-1.)/(o+1.))+(0.727145708632)*dim
        ref[1,0,1]=(-0.252173204638)*(1+2.*(dim-1.)/(o+1.))+(1.08152066636)*dim
        ref[1,1,0]=(-0.642365887101)*(1+2.*(dim-1.)/(o+1.))+(-1.48933990638)*dim
        ref[1,1,1]=(0.341252740787)*(1+2.*(dim-1.)/(o+1.))+(0.451909406552)*dim
        ref[2,0,0]=(1.32771177127)*(1+2.*(dim-1.)/(o+1.))+(-0.238838242309)*dim
        ref[2,0,1]=(0.598974191766)*(1+2.*(dim-1.)/(o+1.))+(-0.900569577663)*dim
        ref[2,1,0]=(-0.822142164446)*(1+2.*(dim-1.)/(o+1.))+(-0.0576553574825)*dim
        ref[2,1,1]=(0.322838750825)*(1+2.*(dim-1.)/(o+1.))+(1.50526603969)*dim
        ref[3,0,0]=(-0.919544759776)*(1+2.*(dim-1.)/(o+1.))+(1.57727841933)*dim
        ref[3,0,1]=(0.646715796109)*(1+2.*(dim-1.)/(o+1.))+(1.81637499436)*dim
        ref[3,1,0]=(0.263684903118)*(1+2.*(dim-1.)/(o+1.))+(0.496837383795)*dim
        ref[3,1,1]=(-0.39761816615)*(1+2.*(dim-1.)/(o+1.))+(0.673687942776)*dim
        ref[4,0,0]=(-0.407617749907)*(1+2.*(dim-1.)/(o+1.))+(-0.157810809613)*dim
        ref[4,0,1]=(0.141881490647)*(1+2.*(dim-1.)/(o+1.))+(-0.122959669416)*dim
        ref[4,1,0]=(-1.40117266823)*(1+2.*(dim-1.)/(o+1.))+(0.0571373091516)*dim
        ref[4,1,1]=(-1.64961975199)*(1+2.*(dim-1.)/(o+1.))+(0.739818251353)*dim
        ref[5,0,0]=(-0.777404193421)*(1+2.*(dim-1.)/(o+1.))+(-0.813944939196)*dim
        ref[5,0,1]=(1.04907918627)*(1+2.*(dim-1.)/(o+1.))+(0.284988373859)*dim
        ref[5,1,0]=(-0.278998278599)*(1+2.*(dim-1.)/(o+1.))+(0.460012676837)*dim
        ref[5,1,1]=(-1.03955845642)*(1+2.*(dim-1.)/(o+1.))+(-0.813470579432)*dim
      else:
        s[0,0,0]=(0.887591619739)*x[0]**o+(0.407256482081)*x[0]+(0.382561775603)*x[1]**o+(0.170135617346)*x[1]+(-0.745510574059)*x[2]**o+(-0.455506612867)*x[2]
        s[0,0,1]=(-0.906429753951)*x[0]**o+(0.650007305971)*x[0]+(0.679810544399)*x[1]**o+(-0.327318089388)*x[1]+(-0.682816086768)*x[2]**o+(0.213571445023)*x[2]
        s[0,1,0]=(-0.101321617665)*x[0]**o+(-0.830248450523)*x[0]+(0.968297844076)*x[1]**o+(-0.461609225074)*x[1]+(-0.803382287303)*x[2]**o+(-0.264990872553)*x[2]
        s[0,1,1]=(0.762025047301)*x[0]**o+(0.352751067716)*x[0]+(0.085082244422)*x[1]**o+(0.260281207839)*x[1]+(-0.838657429282)*x[2]**o+(-0.449142572742)*x[2]
        s[1,0,0]=(0.60404314316)*x[0]**o+(0.433627969764)*x[0]+(-0.187903979441)*x[1]**o+(-0.490170615337)*x[1]+(0.854829687117)*x[2]**o+(-0.0562457996778)*x[2]
        s[1,0,1]=(0.379185262336)*x[0]**o+(-0.127987724933)*x[0]+(-0.199149895558)*x[1]**o+(0.177834623561)*x[1]+(-0.528371897238)*x[2]**o+(-0.752877478181)*x[2]
        s[1,1,0]=(-0.639722907848)*x[0]**o+(0.595935571051)*x[0]+(0.660417028114)*x[1]**o+(-0.70337252144)*x[1]+(0.0532141342539)*x[2]**o+(0.335609331703)*x[2]
        s[1,1,1]=(0.918579942175)*x[0]**o+(-0.419345002272)*x[0]+(-0.733731200432)*x[1]**o+(-0.926576582075)*x[1]+(-0.596748064397)*x[2]**o+(-0.994146900668)*x[2]
        s[2,0,0]=(0.465936668326)*x[0]**o+(0.146304452558)*x[0]+(0.434641974102)*x[1]**o+(0.7475528675)*x[1]+(-0.9968692715)*x[2]**o+(0.761573606267)*x[2]
        s[2,0,1]=(-0.19499782219)*x[0]**o+(-0.0487068806171)*x[0]+(-0.466751862198)*x[1]**o+(0.748775488587)*x[1]+(-0.159041931091)*x[2]**o+(-0.786654864976)*x[2]
        s[2,1,0]=(0.497506698992)*x[0]**o+(0.00446974112015)*x[0]+(-0.57139775079)*x[1]**o+(0.794232026784)*x[1]+(0.788382405769)*x[2]**o+(-0.611606691539)*x[2]
        s[2,1,1]=(-0.744517152085)*x[0]**o+(0.826326809885)*x[0]+(-0.489647614501)*x[1]**o+(-0.798398764067)*x[1]+(0.622474900672)*x[2]**o+(-0.958167077873)*x[2]
        s[3,0,0]=(-0.54850657455)*x[0]**o+(0.907733944445)*x[0]+(0.150662161005)*x[1]**o+(0.329278515834)*x[1]+(0.612014869233)*x[2]**o+(-0.332197388537)*x[2]
        s[3,0,1]=(-0.977591157702)*x[0]**o+(0.0314123979019)*x[0]+(0.357325837849)*x[1]**o+(-0.121203337609)*x[1]+(-0.417779485304)*x[2]**o+(0.56339482028)*x[2]
        s[3,1,0]=(-0.0882818794492)*x[0]**o+(0.373727429506)*x[0]+(0.251705556572)*x[1]**o+(0.75208764669)*x[1]+(-0.243231080216)*x[2]**o+(0.408665593633)*x[2]
        s[3,1,1]=(0.902672970131)*x[0]**o+(0.0816189076234)*x[0]+(-0.0188617954975)*x[1]**o+(0.248727356198)*x[1]+(0.659217806257)*x[2]**o+(-0.521141634196)*x[2]
        s[4,0,0]=(-0.884907344323)*x[0]**o+(0.284225021738)*x[0]+(0.810073434041)*x[1]**o+(0.267855075455)*x[1]+(0.0897833985076)*x[2]**o+(0.622374196423)*x[2]
        s[4,0,1]=(0.512127530167)*x[0]**o+(-0.0208132068954)*x[0]+(0.258260560413)*x[1]**o+(0.206670909439)*x[1]+(-0.359616018773)*x[2]**o+(0.538953196654)*x[2]
        s[4,1,0]=(-0.775312439486)*x[0]**o+(0.781309943125)*x[0]+(0.277745830089)*x[1]**o+(-0.166968517573)*x[1]+(0.428260154734)*x[2]**o+(0.753276413709)*x[2]
        s[4,1,1]=(-0.575086193799)*x[0]**o+(0.488745961307)*x[0]+(0.828550042541)*x[1]**o+(-0.82220696841)*x[1]+(0.48247983233)*x[2]**o+(0.348574290989)*x[2]
        s[5,0,0]=(0.904922447578)*x[0]**o+(0.94372036658)*x[0]+(0.554305596085)*x[1]**o+(-0.633630196279)*x[1]+(0.0304645794125)*x[2]**o+(-0.338076751695)*x[2]
        s[5,0,1]=(0.157663141664)*x[0]**o+(0.27698264503)*x[0]+(-0.244811019178)*x[1]**o+(-0.86016833799)*x[1]+(0.0037249377228)*x[2]**o+(0.415013895956)*x[2]
        s[5,1,0]=(-0.0651731085463)*x[0]**o+(0.656433177612)*x[0]+(-0.693226351108)*x[1]**o+(-0.195335968106)*x[1]+(0.735806703428)*x[2]**o+(-0.284744282673)*x[2]
        s[5,1,1]=(0.14124610976)*x[0]**o+(0.114249449125)*x[0]+(-0.89675797948)*x[1]**o+(-0.109343809939)*x[1]+(-0.171059459418)*x[2]**o+(-0.125911673497)*x[2]
        ref[0,0,0]=(0.524642821284)*(1+2.*(dim-1.)/(o+1.))+(0.12188548656)*dim
        ref[0,0,1]=(-0.90943529632)*(1+2.*(dim-1.)/(o+1.))+(0.536260661607)*dim
        ref[0,1,0]=(0.0635939391079)*(1+2.*(dim-1.)/(o+1.))+(-1.55684854815)*dim
        ref[0,1,1]=(0.0084498624415)*(1+2.*(dim-1.)/(o+1.))+(0.163889702813)*dim
        ref[1,0,0]=(1.27096885084)*(1+2.*(dim-1.)/(o+1.))+(-0.112788445251)*dim
        ref[1,0,1]=(-0.34833653046)*(1+2.*(dim-1.)/(o+1.))+(-0.703030579553)*dim
        ref[1,1,0]=(0.0739082545202)*(1+2.*(dim-1.)/(o+1.))+(0.228172381314)*dim
        ref[1,1,1]=(-0.411899322654)*(1+2.*(dim-1.)/(o+1.))+(-2.34006848501)*dim
        ref[2,0,0]=(-0.0962906290716)*(1+2.*(dim-1.)/(o+1.))+(1.65543092632)*dim
        ref[2,0,1]=(-0.820791615479)*(1+2.*(dim-1.)/(o+1.))+(-0.0865862570057)*dim
        ref[2,1,0]=(0.714491353971)*(1+2.*(dim-1.)/(o+1.))+(0.187095076365)*dim
        ref[2,1,1]=(-0.611689865914)*(1+2.*(dim-1.)/(o+1.))+(-0.930239032054)*dim
        ref[3,0,0]=(0.214170455688)*(1+2.*(dim-1.)/(o+1.))+(0.904815071742)*dim
        ref[3,0,1]=(-1.03804480516)*(1+2.*(dim-1.)/(o+1.))+(0.473603880573)*dim
        ref[3,1,0]=(-0.0798074030926)*(1+2.*(dim-1.)/(o+1.))+(1.53448066983)*dim
        ref[3,1,1]=(1.54302898089)*(1+2.*(dim-1.)/(o+1.))+(-0.190795370375)*dim
        ref[4,0,0]=(0.0149494882254)*(1+2.*(dim-1.)/(o+1.))+(1.17445429362)*dim
        ref[4,0,1]=(0.410772071806)*(1+2.*(dim-1.)/(o+1.))+(0.724810899198)*dim
        ref[4,1,0]=(-0.0693064546636)*(1+2.*(dim-1.)/(o+1.))+(1.36761783926)*dim
        ref[4,1,1]=(0.735943681072)*(1+2.*(dim-1.)/(o+1.))+(0.0151132838872)*dim
        ref[5,0,0]=(1.48969262308)*(1+2.*(dim-1.)/(o+1.))+(-0.0279865813938)*dim
        ref[5,0,1]=(-0.0834229397911)*(1+2.*(dim-1.)/(o+1.))+(-0.168171797005)*dim
        ref[5,1,0]=(-0.0225927562259)*(1+2.*(dim-1.)/(o+1.))+(0.176352926834)*dim
        ref[5,1,1]=(-0.926571329138)*(1+2.*(dim-1.)/(o+1.))+(-0.121006034312)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.0564495520087)*x[0]**o+(0.322467947613)*x[0]+(-0.426040737283)*x[1]**o+(0.743030997838)*x[1]
        s[0,0,0,1]=(-0.705100478682)*x[0]**o+(0.0428011755277)*x[0]+(-0.667969683035)*x[1]**o+(-0.05268016216)*x[1]
        s[0,0,1,0]=(-0.646229122275)*x[0]**o+(-0.117856575975)*x[0]+(-0.928260620991)*x[1]**o+(-0.0295789972002)*x[1]
        s[0,0,1,1]=(0.684057019666)*x[0]**o+(0.217883017426)*x[0]+(-0.8003965891)*x[1]**o+(0.805481050427)*x[1]
        s[0,0,2,0]=(-0.517102518951)*x[0]**o+(0.703108669274)*x[0]+(-0.0818548881221)*x[1]**o+(0.967661353324)*x[1]
        s[0,0,2,1]=(-0.311422038099)*x[0]**o+(0.647051468428)*x[0]+(-0.0134135628666)*x[1]**o+(0.401772150809)*x[1]
        s[0,1,0,0]=(-0.372031418539)*x[0]**o+(-0.348570224054)*x[0]+(0.971394255739)*x[1]**o+(0.220452856894)*x[1]
        s[0,1,0,1]=(0.726171816717)*x[0]**o+(0.0115054389412)*x[0]+(-0.663899850543)*x[1]**o+(-0.00862058334168)*x[1]
        s[0,1,1,0]=(0.0546574475678)*x[0]**o+(-0.110568027517)*x[0]+(-0.490412123307)*x[1]**o+(0.70968579481)*x[1]
        s[0,1,1,1]=(0.525121644008)*x[0]**o+(-0.460449092422)*x[0]+(-0.105141027916)*x[1]**o+(0.70599530088)*x[1]
        s[0,1,2,0]=(-0.333393404511)*x[0]**o+(0.956105748878)*x[0]+(-0.542294839284)*x[1]**o+(0.856767614724)*x[1]
        s[0,1,2,1]=(0.499018678584)*x[0]**o+(0.709512775393)*x[0]+(-0.0278608905417)*x[1]**o+(-0.408880317793)*x[1]
        s[0,2,0,0]=(0.196709165539)*x[0]**o+(-0.824269904377)*x[0]+(-0.776756196058)*x[1]**o+(-0.21242798078)*x[1]
        s[0,2,0,1]=(0.101174745892)*x[0]**o+(0.103180763582)*x[0]+(-0.25979513904)*x[1]**o+(-0.595455963398)*x[1]
        s[0,2,1,0]=(-0.490524427754)*x[0]**o+(0.22473843241)*x[0]+(-0.559043751054)*x[1]**o+(-0.396861202642)*x[1]
        s[0,2,1,1]=(0.366671902637)*x[0]**o+(0.00444476264911)*x[0]+(0.84769491016)*x[1]**o+(0.340088796185)*x[1]
        s[0,2,2,0]=(0.0843962714222)*x[0]**o+(-0.678807745661)*x[0]+(0.0710532661834)*x[1]**o+(-0.131143081822)*x[1]
        s[0,2,2,1]=(-0.505967901175)*x[0]**o+(0.389944048429)*x[0]+(-0.607195013377)*x[1]**o+(0.615596624068)*x[1]
        s[0,3,0,0]=(0.480464466311)*x[0]**o+(-0.200660236866)*x[0]+(-0.366683832098)*x[1]**o+(0.473029292775)*x[1]
        s[0,3,0,1]=(0.503865126139)*x[0]**o+(0.620947845674)*x[0]+(0.482553725938)*x[1]**o+(0.903952597709)*x[1]
        s[0,3,1,0]=(-0.935816186601)*x[0]**o+(-0.694323019844)*x[0]+(-0.222643250757)*x[1]**o+(-0.61395534471)*x[1]
        s[0,3,1,1]=(-0.366248207885)*x[0]**o+(0.21981177916)*x[0]+(0.829964990663)*x[1]**o+(-0.458138466604)*x[1]
        s[0,3,2,0]=(-0.133505096099)*x[0]**o+(0.889073061727)*x[0]+(0.748032746123)*x[1]**o+(0.457372622346)*x[1]
        s[0,3,2,1]=(-0.940388978849)*x[0]**o+(0.194505986498)*x[0]+(0.277476781766)*x[1]**o+(0.0315390566538)*x[1]
        s[0,4,0,0]=(-0.246674730207)*x[0]**o+(-0.145685680956)*x[0]+(-0.855397050636)*x[1]**o+(0.332401911997)*x[1]
        s[0,4,0,1]=(-0.786787596226)*x[0]**o+(0.000178838426883)*x[0]+(0.0315355043243)*x[1]**o+(0.502956944109)*x[1]
        s[0,4,1,0]=(0.456353731831)*x[0]**o+(0.224571019711)*x[0]+(0.787432530547)*x[1]**o+(0.900715775247)*x[1]
        s[0,4,1,1]=(-0.87764927624)*x[0]**o+(0.547980575611)*x[0]+(-0.287094420401)*x[1]**o+(0.664160174901)*x[1]
        s[0,4,2,0]=(-0.195894642929)*x[0]**o+(-0.595129209807)*x[0]+(0.865849102635)*x[1]**o+(-0.677159397082)*x[1]
        s[0,4,2,1]=(-0.841735734151)*x[0]**o+(0.625862078643)*x[0]+(-0.545516568256)*x[1]**o+(0.114109991331)*x[1]
        s[1,0,0,0]=(0.209458674327)*x[0]**o+(-0.20896563634)*x[0]+(-0.579063332782)*x[1]**o+(-0.0433216462031)*x[1]
        s[1,0,0,1]=(0.0646951342633)*x[0]**o+(-0.999495478916)*x[0]+(-0.679168301408)*x[1]**o+(-0.357289498732)*x[1]
        s[1,0,1,0]=(0.19078385999)*x[0]**o+(0.14391750283)*x[0]+(-0.571814090672)*x[1]**o+(0.19532813646)*x[1]
        s[1,0,1,1]=(0.3385444312)*x[0]**o+(-0.961513536858)*x[0]+(-0.729134108689)*x[1]**o+(-0.477737542344)*x[1]
        s[1,0,2,0]=(0.545433953869)*x[0]**o+(-0.746630455132)*x[0]+(-0.49008038028)*x[1]**o+(-0.156535798648)*x[1]
        s[1,0,2,1]=(-0.718991145693)*x[0]**o+(-0.264354651201)*x[0]+(0.0812886298976)*x[1]**o+(-0.331692687243)*x[1]
        s[1,1,0,0]=(-0.646431085196)*x[0]**o+(-0.150073929112)*x[0]+(-0.919422164553)*x[1]**o+(-0.754093106669)*x[1]
        s[1,1,0,1]=(-0.424167875207)*x[0]**o+(0.00436241598561)*x[0]+(0.423024130972)*x[1]**o+(0.0414727269723)*x[1]
        s[1,1,1,0]=(0.972554573539)*x[0]**o+(-0.00871610987967)*x[0]+(-0.968130421895)*x[1]**o+(0.323276868881)*x[1]
        s[1,1,1,1]=(-0.223846361715)*x[0]**o+(0.0984359694216)*x[0]+(0.367109095942)*x[1]**o+(0.39421742616)*x[1]
        s[1,1,2,0]=(-0.532854459841)*x[0]**o+(0.0932005176653)*x[0]+(0.300915725885)*x[1]**o+(-0.407779066395)*x[1]
        s[1,1,2,1]=(-0.977204985435)*x[0]**o+(0.632461453595)*x[0]+(0.222769752858)*x[1]**o+(0.97524903541)*x[1]
        s[1,2,0,0]=(0.798817773565)*x[0]**o+(-0.687809695378)*x[0]+(-0.77661557915)*x[1]**o+(0.242848730169)*x[1]
        s[1,2,0,1]=(0.852738374774)*x[0]**o+(-0.353097828509)*x[0]+(-0.947070627494)*x[1]**o+(0.686527427094)*x[1]
        s[1,2,1,0]=(0.315473111735)*x[0]**o+(0.671113387299)*x[0]+(0.328881731518)*x[1]**o+(-0.269227909853)*x[1]
        s[1,2,1,1]=(-0.877500814779)*x[0]**o+(-0.508518061024)*x[0]+(-0.486367952918)*x[1]**o+(0.465181865784)*x[1]
        s[1,2,2,0]=(0.321396065376)*x[0]**o+(-0.977515734724)*x[0]+(-0.745047664798)*x[1]**o+(0.00770829984163)*x[1]
        s[1,2,2,1]=(0.217194865535)*x[0]**o+(0.84002706514)*x[0]+(0.4186527058)*x[1]**o+(-0.0197865947851)*x[1]
        s[1,3,0,0]=(-0.434267890176)*x[0]**o+(0.677387101394)*x[0]+(-0.433143616343)*x[1]**o+(0.76079607685)*x[1]
        s[1,3,0,1]=(-0.568019213241)*x[0]**o+(0.940292544942)*x[0]+(0.351503513272)*x[1]**o+(-0.8227358798)*x[1]
        s[1,3,1,0]=(0.225598112956)*x[0]**o+(-0.158411926824)*x[0]+(-0.0770214720299)*x[1]**o+(0.667242375231)*x[1]
        s[1,3,1,1]=(0.497365374413)*x[0]**o+(-0.402552536909)*x[0]+(-0.760975595637)*x[1]**o+(0.423931229263)*x[1]
        s[1,3,2,0]=(0.260548515487)*x[0]**o+(-0.723043083794)*x[0]+(0.40423813784)*x[1]**o+(0.591112253369)*x[1]
        s[1,3,2,1]=(0.0657703077553)*x[0]**o+(0.610016697083)*x[0]+(-0.515291622078)*x[1]**o+(-0.0821391959295)*x[1]
        s[1,4,0,0]=(-0.0842960021063)*x[0]**o+(0.830851714471)*x[0]+(0.571649443759)*x[1]**o+(-0.884015388056)*x[1]
        s[1,4,0,1]=(0.681962300417)*x[0]**o+(0.549746462866)*x[0]+(0.0330915607536)*x[1]**o+(0.757109551626)*x[1]
        s[1,4,1,0]=(0.413804087081)*x[0]**o+(-0.0713221635854)*x[0]+(0.153990572806)*x[1]**o+(-0.448202273823)*x[1]
        s[1,4,1,1]=(-0.109978839431)*x[0]**o+(-0.720641165805)*x[0]+(-0.465701345584)*x[1]**o+(-0.423310622549)*x[1]
        s[1,4,2,0]=(0.0884455154661)*x[0]**o+(0.341657397119)*x[0]+(-0.282148805378)*x[1]**o+(0.567581544922)*x[1]
        s[1,4,2,1]=(0.384270691665)*x[0]**o+(0.986879879066)*x[0]+(0.725843240631)*x[1]**o+(-0.888932402046)*x[1]
        s[2,0,0,0]=(0.915028230934)*x[0]**o+(0.0308158620736)*x[0]+(-0.534330519368)*x[1]**o+(-0.668490082908)*x[1]
        s[2,0,0,1]=(0.0447246773914)*x[0]**o+(-0.764286683802)*x[0]+(0.985272626016)*x[1]**o+(-0.582955807402)*x[1]
        s[2,0,1,0]=(-0.0982089493146)*x[0]**o+(-0.119886638989)*x[0]+(0.0918316786338)*x[1]**o+(-0.275013043117)*x[1]
        s[2,0,1,1]=(-0.187529321909)*x[0]**o+(0.715634182891)*x[0]+(0.554464679108)*x[1]**o+(0.75060799895)*x[1]
        s[2,0,2,0]=(0.402781810737)*x[0]**o+(-0.885441671822)*x[0]+(0.647449131552)*x[1]**o+(-0.82134489597)*x[1]
        s[2,0,2,1]=(0.903766197812)*x[0]**o+(0.397983290493)*x[0]+(-0.161556012403)*x[1]**o+(0.441970897)*x[1]
        s[2,1,0,0]=(-0.0286858171901)*x[0]**o+(0.152444209719)*x[0]+(0.713144598152)*x[1]**o+(-0.330803066479)*x[1]
        s[2,1,0,1]=(0.221312544677)*x[0]**o+(0.76681848391)*x[0]+(0.4237403202)*x[1]**o+(0.219978904876)*x[1]
        s[2,1,1,0]=(0.350534590086)*x[0]**o+(0.933385654173)*x[0]+(0.349813301929)*x[1]**o+(0.0427424949923)*x[1]
        s[2,1,1,1]=(0.660478429879)*x[0]**o+(-0.487740867789)*x[0]+(-0.270542163333)*x[1]**o+(-0.405080985084)*x[1]
        s[2,1,2,0]=(0.0114890380351)*x[0]**o+(-0.156620602559)*x[0]+(-0.494024071381)*x[1]**o+(0.164138650655)*x[1]
        s[2,1,2,1]=(0.688285293331)*x[0]**o+(-0.723548244407)*x[0]+(-0.979169222862)*x[1]**o+(-0.815167412147)*x[1]
        s[2,2,0,0]=(0.743910713659)*x[0]**o+(-0.319702207578)*x[0]+(0.464318179749)*x[1]**o+(-0.911256589955)*x[1]
        s[2,2,0,1]=(0.178943711133)*x[0]**o+(0.878989967814)*x[0]+(-0.584920241418)*x[1]**o+(-0.232803309459)*x[1]
        s[2,2,1,0]=(0.289708048016)*x[0]**o+(0.0250010477203)*x[0]+(0.231695416136)*x[1]**o+(0.00458067191189)*x[1]
        s[2,2,1,1]=(0.252996966945)*x[0]**o+(0.718948618791)*x[0]+(0.238406858981)*x[1]**o+(-0.222687536947)*x[1]
        s[2,2,2,0]=(0.707394678426)*x[0]**o+(-0.341044895187)*x[0]+(-0.924768233451)*x[1]**o+(-0.717376693436)*x[1]
        s[2,2,2,1]=(0.826870828657)*x[0]**o+(0.596221683232)*x[0]+(0.13184086469)*x[1]**o+(-0.122283119637)*x[1]
        s[2,3,0,0]=(0.082622085842)*x[0]**o+(0.802466780483)*x[0]+(-0.374536755651)*x[1]**o+(0.299695470983)*x[1]
        s[2,3,0,1]=(0.806722430379)*x[0]**o+(-0.307373050709)*x[0]+(-0.504241501795)*x[1]**o+(0.0365801039206)*x[1]
        s[2,3,1,0]=(-0.189680944199)*x[0]**o+(0.86059525782)*x[0]+(0.612911991629)*x[1]**o+(-0.868979910208)*x[1]
        s[2,3,1,1]=(-0.0606711884277)*x[0]**o+(-0.543604644984)*x[0]+(0.292808478791)*x[1]**o+(0.0024260857339)*x[1]
        s[2,3,2,0]=(0.258222812918)*x[0]**o+(0.304770046568)*x[0]+(-0.426946619435)*x[1]**o+(-0.0521912646177)*x[1]
        s[2,3,2,1]=(-0.324355225171)*x[0]**o+(-0.784048371347)*x[0]+(0.169611573731)*x[1]**o+(-0.548169504296)*x[1]
        s[2,4,0,0]=(0.0155438234769)*x[0]**o+(-0.620846826317)*x[0]+(0.409826337485)*x[1]**o+(0.129190074563)*x[1]
        s[2,4,0,1]=(0.923545504209)*x[0]**o+(-0.155101945409)*x[0]+(-0.717093202578)*x[1]**o+(-0.480920400256)*x[1]
        s[2,4,1,0]=(0.313709415121)*x[0]**o+(0.736484420744)*x[0]+(-0.0293655314952)*x[1]**o+(-0.599267629638)*x[1]
        s[2,4,1,1]=(0.463358526622)*x[0]**o+(-0.592469734442)*x[0]+(0.613104805703)*x[1]**o+(-0.178209835993)*x[1]
        s[2,4,2,0]=(-0.713644697339)*x[0]**o+(0.799721953045)*x[0]+(0.0589328481367)*x[1]**o+(0.547328786304)*x[1]
        s[2,4,2,1]=(0.993775334243)*x[0]**o+(0.553815998267)*x[0]+(0.1992862938)*x[1]**o+(0.81025353823)*x[1]
        s[3,0,0,0]=(0.160105719249)*x[0]**o+(-0.555881043013)*x[0]+(0.595178125526)*x[1]**o+(0.581499038384)*x[1]
        s[3,0,0,1]=(-0.073553285882)*x[0]**o+(0.302577114557)*x[0]+(0.170358740039)*x[1]**o+(0.75537952732)*x[1]
        s[3,0,1,0]=(-0.64563114781)*x[0]**o+(0.196969117846)*x[0]+(-0.972196629648)*x[1]**o+(-0.996586995934)*x[1]
        s[3,0,1,1]=(0.833966809791)*x[0]**o+(0.95981521797)*x[0]+(0.816649660191)*x[1]**o+(-0.220324291634)*x[1]
        s[3,0,2,0]=(0.102957823139)*x[0]**o+(-0.442375614091)*x[0]+(0.686402985053)*x[1]**o+(0.0731364854586)*x[1]
        s[3,0,2,1]=(-0.168212668775)*x[0]**o+(0.314439484314)*x[0]+(0.619151838083)*x[1]**o+(-0.360098253956)*x[1]
        s[3,1,0,0]=(-0.416264395501)*x[0]**o+(0.214984128512)*x[0]+(0.358642811015)*x[1]**o+(-0.869373823201)*x[1]
        s[3,1,0,1]=(0.181499327771)*x[0]**o+(-0.331648488714)*x[0]+(-0.191432513473)*x[1]**o+(0.0930773945136)*x[1]
        s[3,1,1,0]=(-0.976247847012)*x[0]**o+(-0.575393818806)*x[0]+(0.0929450161482)*x[1]**o+(-0.276689604101)*x[1]
        s[3,1,1,1]=(0.185352455216)*x[0]**o+(-0.931509714205)*x[0]+(-0.6870722095)*x[1]**o+(0.0624138101885)*x[1]
        s[3,1,2,0]=(-0.281042580465)*x[0]**o+(0.966028964753)*x[0]+(-0.419450359271)*x[1]**o+(0.873992760636)*x[1]
        s[3,1,2,1]=(0.993820925583)*x[0]**o+(0.690209908944)*x[0]+(0.148117153189)*x[1]**o+(0.71818108405)*x[1]
        s[3,2,0,0]=(-0.549354119752)*x[0]**o+(-0.282097817235)*x[0]+(0.896456051498)*x[1]**o+(-0.452485791074)*x[1]
        s[3,2,0,1]=(-0.0830679821316)*x[0]**o+(0.40212443752)*x[0]+(0.380555934515)*x[1]**o+(0.987505234574)*x[1]
        s[3,2,1,0]=(0.997713740817)*x[0]**o+(-0.692039069659)*x[0]+(-0.565960747782)*x[1]**o+(0.445414151858)*x[1]
        s[3,2,1,1]=(0.9675137078)*x[0]**o+(0.84769422726)*x[0]+(0.0938577014253)*x[1]**o+(-0.431299521474)*x[1]
        s[3,2,2,0]=(-0.868876045235)*x[0]**o+(-0.955493151846)*x[0]+(-0.9143773492)*x[1]**o+(0.899030565498)*x[1]
        s[3,2,2,1]=(0.629496450112)*x[0]**o+(-0.0218037231989)*x[0]+(-0.933196760824)*x[1]**o+(-0.549980925362)*x[1]
        s[3,3,0,0]=(-0.73789282568)*x[0]**o+(0.612764312125)*x[0]+(-0.80912954116)*x[1]**o+(0.608837621314)*x[1]
        s[3,3,0,1]=(0.465678249887)*x[0]**o+(-0.780539933825)*x[0]+(0.149236887279)*x[1]**o+(-0.842449293644)*x[1]
        s[3,3,1,0]=(-0.853285341888)*x[0]**o+(0.347485246788)*x[0]+(0.219773434631)*x[1]**o+(0.702046500252)*x[1]
        s[3,3,1,1]=(-0.0500921104166)*x[0]**o+(0.620181272972)*x[0]+(-0.514576066373)*x[1]**o+(0.0487351718037)*x[1]
        s[3,3,2,0]=(0.0904463554055)*x[0]**o+(0.268365306318)*x[0]+(-0.164684341011)*x[1]**o+(0.115207872226)*x[1]
        s[3,3,2,1]=(0.359085658137)*x[0]**o+(0.144112368075)*x[0]+(0.0650644733865)*x[1]**o+(0.176937328733)*x[1]
        s[3,4,0,0]=(-0.602904552775)*x[0]**o+(-0.648691919828)*x[0]+(-0.41237635973)*x[1]**o+(-0.282240953949)*x[1]
        s[3,4,0,1]=(-0.938255401084)*x[0]**o+(0.263050201557)*x[0]+(0.175643545166)*x[1]**o+(-0.995029122689)*x[1]
        s[3,4,1,0]=(0.728511178435)*x[0]**o+(-0.0673148421745)*x[0]+(-0.814903409759)*x[1]**o+(0.0229206126733)*x[1]
        s[3,4,1,1]=(-0.790381209272)*x[0]**o+(-0.326044592264)*x[0]+(-0.616797433118)*x[1]**o+(-0.0963030542755)*x[1]
        s[3,4,2,0]=(-0.286555245913)*x[0]**o+(-0.725972210674)*x[0]+(-0.809797611215)*x[1]**o+(0.477382881829)*x[1]
        s[3,4,2,1]=(0.947314594641)*x[0]**o+(0.731567714373)*x[0]+(0.104324647674)*x[1]**o+(0.0771726257761)*x[1]
        ref[0,0,0,0]=(-0.482490289291)*(1+2.*(dim-1.)/(o+1.))+(1.06549894545)*dim
        ref[0,0,0,1]=(-1.37307016172)*(1+2.*(dim-1.)/(o+1.))+(-0.00987898663227)*dim
        ref[0,0,1,0]=(-1.57448974327)*(1+2.*(dim-1.)/(o+1.))+(-0.147435573175)*dim
        ref[0,0,1,1]=(-0.116339569434)*(1+2.*(dim-1.)/(o+1.))+(1.02336406785)*dim
        ref[0,0,2,0]=(-0.598957407073)*(1+2.*(dim-1.)/(o+1.))+(1.6707700226)*dim
        ref[0,0,2,1]=(-0.324835600966)*(1+2.*(dim-1.)/(o+1.))+(1.04882361924)*dim
        ref[0,1,0,0]=(0.5993628372)*(1+2.*(dim-1.)/(o+1.))+(-0.128117367161)*dim
        ref[0,1,0,1]=(0.062271966174)*(1+2.*(dim-1.)/(o+1.))+(0.00288485559949)*dim
        ref[0,1,1,0]=(-0.43575467574)*(1+2.*(dim-1.)/(o+1.))+(0.599117767293)*dim
        ref[0,1,1,1]=(0.419980616092)*(1+2.*(dim-1.)/(o+1.))+(0.245546208457)*dim
        ref[0,1,2,0]=(-0.875688243795)*(1+2.*(dim-1.)/(o+1.))+(1.8128733636)*dim
        ref[0,1,2,1]=(0.471157788042)*(1+2.*(dim-1.)/(o+1.))+(0.3006324576)*dim
        ref[0,2,0,0]=(-0.580047030519)*(1+2.*(dim-1.)/(o+1.))+(-1.03669788516)*dim
        ref[0,2,0,1]=(-0.158620393148)*(1+2.*(dim-1.)/(o+1.))+(-0.492275199816)*dim
        ref[0,2,1,0]=(-1.04956817881)*(1+2.*(dim-1.)/(o+1.))+(-0.172122770232)*dim
        ref[0,2,1,1]=(1.2143668128)*(1+2.*(dim-1.)/(o+1.))+(0.344533558834)*dim
        ref[0,2,2,0]=(0.155449537606)*(1+2.*(dim-1.)/(o+1.))+(-0.809950827483)*dim
        ref[0,2,2,1]=(-1.11316291455)*(1+2.*(dim-1.)/(o+1.))+(1.0055406725)*dim
        ref[0,3,0,0]=(0.113780634213)*(1+2.*(dim-1.)/(o+1.))+(0.272369055909)*dim
        ref[0,3,0,1]=(0.986418852077)*(1+2.*(dim-1.)/(o+1.))+(1.52490044338)*dim
        ref[0,3,1,0]=(-1.15845943736)*(1+2.*(dim-1.)/(o+1.))+(-1.30827836455)*dim
        ref[0,3,1,1]=(0.463716782779)*(1+2.*(dim-1.)/(o+1.))+(-0.238326687444)*dim
        ref[0,3,2,0]=(0.614527650024)*(1+2.*(dim-1.)/(o+1.))+(1.34644568407)*dim
        ref[0,3,2,1]=(-0.662912197084)*(1+2.*(dim-1.)/(o+1.))+(0.226045043152)*dim
        ref[0,4,0,0]=(-1.10207178084)*(1+2.*(dim-1.)/(o+1.))+(0.186716231041)*dim
        ref[0,4,0,1]=(-0.755252091901)*(1+2.*(dim-1.)/(o+1.))+(0.503135782536)*dim
        ref[0,4,1,0]=(1.24378626238)*(1+2.*(dim-1.)/(o+1.))+(1.12528679496)*dim
        ref[0,4,1,1]=(-1.16474369664)*(1+2.*(dim-1.)/(o+1.))+(1.21214075051)*dim
        ref[0,4,2,0]=(0.669954459707)*(1+2.*(dim-1.)/(o+1.))+(-1.27228860689)*dim
        ref[0,4,2,1]=(-1.38725230241)*(1+2.*(dim-1.)/(o+1.))+(0.739972069974)*dim
        ref[1,0,0,0]=(-0.369604658454)*(1+2.*(dim-1.)/(o+1.))+(-0.252287282543)*dim
        ref[1,0,0,1]=(-0.614473167144)*(1+2.*(dim-1.)/(o+1.))+(-1.35678497765)*dim
        ref[1,0,1,0]=(-0.381030230682)*(1+2.*(dim-1.)/(o+1.))+(0.339245639291)*dim
        ref[1,0,1,1]=(-0.39058967749)*(1+2.*(dim-1.)/(o+1.))+(-1.4392510792)*dim
        ref[1,0,2,0]=(0.0553535735892)*(1+2.*(dim-1.)/(o+1.))+(-0.903166253779)*dim
        ref[1,0,2,1]=(-0.637702515795)*(1+2.*(dim-1.)/(o+1.))+(-0.596047338443)*dim
        ref[1,1,0,0]=(-1.56585324975)*(1+2.*(dim-1.)/(o+1.))+(-0.904167035781)*dim
        ref[1,1,0,1]=(-0.00114374423549)*(1+2.*(dim-1.)/(o+1.))+(0.0458351429579)*dim
        ref[1,1,1,0]=(0.00442415164442)*(1+2.*(dim-1.)/(o+1.))+(0.314560759001)*dim
        ref[1,1,1,1]=(0.143262734228)*(1+2.*(dim-1.)/(o+1.))+(0.492653395582)*dim
        ref[1,1,2,0]=(-0.231938733956)*(1+2.*(dim-1.)/(o+1.))+(-0.314578548729)*dim
        ref[1,1,2,1]=(-0.754435232577)*(1+2.*(dim-1.)/(o+1.))+(1.60771048901)*dim
        ref[1,2,0,0]=(0.0222021944152)*(1+2.*(dim-1.)/(o+1.))+(-0.444960965209)*dim
        ref[1,2,0,1]=(-0.0943322527204)*(1+2.*(dim-1.)/(o+1.))+(0.333429598586)*dim
        ref[1,2,1,0]=(0.644354843253)*(1+2.*(dim-1.)/(o+1.))+(0.401885477446)*dim
        ref[1,2,1,1]=(-1.3638687677)*(1+2.*(dim-1.)/(o+1.))+(-0.0433361952409)*dim
        ref[1,2,2,0]=(-0.423651599421)*(1+2.*(dim-1.)/(o+1.))+(-0.969807434883)*dim
        ref[1,2,2,1]=(0.635847571335)*(1+2.*(dim-1.)/(o+1.))+(0.820240470355)*dim
        ref[1,3,0,0]=(-0.867411506519)*(1+2.*(dim-1.)/(o+1.))+(1.43818317824)*dim
        ref[1,3,0,1]=(-0.21651569997)*(1+2.*(dim-1.)/(o+1.))+(0.117556665142)*dim
        ref[1,3,1,0]=(0.148576640926)*(1+2.*(dim-1.)/(o+1.))+(0.508830448407)*dim
        ref[1,3,1,1]=(-0.263610221224)*(1+2.*(dim-1.)/(o+1.))+(0.0213786923536)*dim
        ref[1,3,2,0]=(0.664786653328)*(1+2.*(dim-1.)/(o+1.))+(-0.131930830425)*dim
        ref[1,3,2,1]=(-0.449521314323)*(1+2.*(dim-1.)/(o+1.))+(0.527877501154)*dim
        ref[1,4,0,0]=(0.487353441653)*(1+2.*(dim-1.)/(o+1.))+(-0.0531636735847)*dim
        ref[1,4,0,1]=(0.715053861171)*(1+2.*(dim-1.)/(o+1.))+(1.30685601449)*dim
        ref[1,4,1,0]=(0.567794659886)*(1+2.*(dim-1.)/(o+1.))+(-0.519524437409)*dim
        ref[1,4,1,1]=(-0.575680185015)*(1+2.*(dim-1.)/(o+1.))+(-1.14395178835)*dim
        ref[1,4,2,0]=(-0.193703289912)*(1+2.*(dim-1.)/(o+1.))+(0.909238942041)*dim
        ref[1,4,2,1]=(1.1101139323)*(1+2.*(dim-1.)/(o+1.))+(0.0979474770197)*dim
        ref[2,0,0,0]=(0.380697711566)*(1+2.*(dim-1.)/(o+1.))+(-0.637674220835)*dim
        ref[2,0,0,1]=(1.02999730341)*(1+2.*(dim-1.)/(o+1.))+(-1.3472424912)*dim
        ref[2,0,1,0]=(-0.00637727068081)*(1+2.*(dim-1.)/(o+1.))+(-0.394899682106)*dim
        ref[2,0,1,1]=(0.366935357199)*(1+2.*(dim-1.)/(o+1.))+(1.46624218184)*dim
        ref[2,0,2,0]=(1.05023094229)*(1+2.*(dim-1.)/(o+1.))+(-1.70678656779)*dim
        ref[2,0,2,1]=(0.742210185409)*(1+2.*(dim-1.)/(o+1.))+(0.839954187494)*dim
        ref[2,1,0,0]=(0.684458780962)*(1+2.*(dim-1.)/(o+1.))+(-0.17835885676)*dim
        ref[2,1,0,1]=(0.645052864877)*(1+2.*(dim-1.)/(o+1.))+(0.986797388786)*dim
        ref[2,1,1,0]=(0.700347892015)*(1+2.*(dim-1.)/(o+1.))+(0.976128149165)*dim
        ref[2,1,1,1]=(0.389936266545)*(1+2.*(dim-1.)/(o+1.))+(-0.892821852874)*dim
        ref[2,1,2,0]=(-0.482535033346)*(1+2.*(dim-1.)/(o+1.))+(0.00751804809504)*dim
        ref[2,1,2,1]=(-0.29088392953)*(1+2.*(dim-1.)/(o+1.))+(-1.53871565655)*dim
        ref[2,2,0,0]=(1.20822889341)*(1+2.*(dim-1.)/(o+1.))+(-1.23095879753)*dim
        ref[2,2,0,1]=(-0.405976530285)*(1+2.*(dim-1.)/(o+1.))+(0.646186658355)*dim
        ref[2,2,1,0]=(0.521403464152)*(1+2.*(dim-1.)/(o+1.))+(0.0295817196322)*dim
        ref[2,2,1,1]=(0.491403825926)*(1+2.*(dim-1.)/(o+1.))+(0.496261081844)*dim
        ref[2,2,2,0]=(-0.217373555025)*(1+2.*(dim-1.)/(o+1.))+(-1.05842158862)*dim
        ref[2,2,2,1]=(0.958711693347)*(1+2.*(dim-1.)/(o+1.))+(0.473938563595)*dim
        ref[2,3,0,0]=(-0.291914669809)*(1+2.*(dim-1.)/(o+1.))+(1.10216225147)*dim
        ref[2,3,0,1]=(0.302480928584)*(1+2.*(dim-1.)/(o+1.))+(-0.270792946789)*dim
        ref[2,3,1,0]=(0.423231047429)*(1+2.*(dim-1.)/(o+1.))+(-0.00838465238812)*dim
        ref[2,3,1,1]=(0.232137290364)*(1+2.*(dim-1.)/(o+1.))+(-0.54117855925)*dim
        ref[2,3,2,0]=(-0.168723806518)*(1+2.*(dim-1.)/(o+1.))+(0.25257878195)*dim
        ref[2,3,2,1]=(-0.154743651439)*(1+2.*(dim-1.)/(o+1.))+(-1.33221787564)*dim
        ref[2,4,0,0]=(0.425370160961)*(1+2.*(dim-1.)/(o+1.))+(-0.491656751754)*dim
        ref[2,4,0,1]=(0.206452301631)*(1+2.*(dim-1.)/(o+1.))+(-0.636022345665)*dim
        ref[2,4,1,0]=(0.284343883626)*(1+2.*(dim-1.)/(o+1.))+(0.137216791106)*dim
        ref[2,4,1,1]=(1.07646333233)*(1+2.*(dim-1.)/(o+1.))+(-0.770679570435)*dim
        ref[2,4,2,0]=(-0.654711849202)*(1+2.*(dim-1.)/(o+1.))+(1.34705073935)*dim
        ref[2,4,2,1]=(1.19306162804)*(1+2.*(dim-1.)/(o+1.))+(1.3640695365)*dim
        ref[3,0,0,0]=(0.755283844775)*(1+2.*(dim-1.)/(o+1.))+(0.0256179953709)*dim
        ref[3,0,0,1]=(0.0968054541574)*(1+2.*(dim-1.)/(o+1.))+(1.05795664188)*dim
        ref[3,0,1,0]=(-1.61782777746)*(1+2.*(dim-1.)/(o+1.))+(-0.799617878088)*dim
        ref[3,0,1,1]=(1.65061646998)*(1+2.*(dim-1.)/(o+1.))+(0.739490926336)*dim
        ref[3,0,2,0]=(0.789360808191)*(1+2.*(dim-1.)/(o+1.))+(-0.369239128632)*dim
        ref[3,0,2,1]=(0.450939169308)*(1+2.*(dim-1.)/(o+1.))+(-0.0456587696413)*dim
        ref[3,1,0,0]=(-0.0576215844858)*(1+2.*(dim-1.)/(o+1.))+(-0.654389694689)*dim
        ref[3,1,0,1]=(-0.00993318570204)*(1+2.*(dim-1.)/(o+1.))+(-0.2385710942)*dim
        ref[3,1,1,0]=(-0.883302830864)*(1+2.*(dim-1.)/(o+1.))+(-0.852083422907)*dim
        ref[3,1,1,1]=(-0.501719754284)*(1+2.*(dim-1.)/(o+1.))+(-0.869095904016)*dim
        ref[3,1,2,0]=(-0.700492939735)*(1+2.*(dim-1.)/(o+1.))+(1.84002172539)*dim
        ref[3,1,2,1]=(1.14193807877)*(1+2.*(dim-1.)/(o+1.))+(1.40839099299)*dim
        ref[3,2,0,0]=(0.347101931746)*(1+2.*(dim-1.)/(o+1.))+(-0.73458360831)*dim
        ref[3,2,0,1]=(0.297487952383)*(1+2.*(dim-1.)/(o+1.))+(1.38962967209)*dim
        ref[3,2,1,0]=(0.431752993035)*(1+2.*(dim-1.)/(o+1.))+(-0.246624917801)*dim
        ref[3,2,1,1]=(1.06137140922)*(1+2.*(dim-1.)/(o+1.))+(0.416394705787)*dim
        ref[3,2,2,0]=(-1.78325339443)*(1+2.*(dim-1.)/(o+1.))+(-0.0564625863481)*dim
        ref[3,2,2,1]=(-0.303700310713)*(1+2.*(dim-1.)/(o+1.))+(-0.571784648561)*dim
        ref[3,3,0,0]=(-1.54702236684)*(1+2.*(dim-1.)/(o+1.))+(1.22160193344)*dim
        ref[3,3,0,1]=(0.614915137167)*(1+2.*(dim-1.)/(o+1.))+(-1.62298922747)*dim
        ref[3,3,1,0]=(-0.633511907257)*(1+2.*(dim-1.)/(o+1.))+(1.04953174704)*dim
        ref[3,3,1,1]=(-0.56466817679)*(1+2.*(dim-1.)/(o+1.))+(0.668916444776)*dim
        ref[3,3,2,0]=(-0.074237985605)*(1+2.*(dim-1.)/(o+1.))+(0.383573178544)*dim
        ref[3,3,2,1]=(0.424150131524)*(1+2.*(dim-1.)/(o+1.))+(0.321049696808)*dim
        ref[3,4,0,0]=(-1.01528091251)*(1+2.*(dim-1.)/(o+1.))+(-0.930932873777)*dim
        ref[3,4,0,1]=(-0.762611855917)*(1+2.*(dim-1.)/(o+1.))+(-0.731978921132)*dim
        ref[3,4,1,0]=(-0.0863922313234)*(1+2.*(dim-1.)/(o+1.))+(-0.0443942295012)*dim
        ref[3,4,1,1]=(-1.40717864239)*(1+2.*(dim-1.)/(o+1.))+(-0.42234764654)*dim
        ref[3,4,2,0]=(-1.09635285713)*(1+2.*(dim-1.)/(o+1.))+(-0.248589328845)*dim
        ref[3,4,2,1]=(1.05163924231)*(1+2.*(dim-1.)/(o+1.))+(0.808740340149)*dim
      else:
        s[0,0,0,0]=(0.315885178942)*x[0]**o+(-0.259227433663)*x[0]+(-0.985139490966)*x[1]**o+(-0.365399875853)*x[1]+(-0.378614709474)*x[2]**o+(-0.749166773032)*x[2]
        s[0,0,0,1]=(-0.980745316199)*x[0]**o+(0.917227239621)*x[0]+(-0.00961787312321)*x[1]**o+(-0.803272961034)*x[1]+(-0.569841488886)*x[2]**o+(-0.470914343673)*x[2]
        s[0,0,1,0]=(0.474857040946)*x[0]**o+(0.737872920694)*x[0]+(0.0428239150717)*x[1]**o+(0.805671300306)*x[1]+(-0.372628413406)*x[2]**o+(0.719721248997)*x[2]
        s[0,0,1,1]=(-0.711880589909)*x[0]**o+(0.321391465679)*x[0]+(0.519295140087)*x[1]**o+(0.038319529181)*x[1]+(0.38347458279)*x[2]**o+(0.331699888768)*x[2]
        s[0,0,2,0]=(-0.749496365536)*x[0]**o+(0.587604152085)*x[0]+(-0.713982951135)*x[1]**o+(-0.846872978696)*x[1]+(0.187878469529)*x[2]**o+(-0.605222544928)*x[2]
        s[0,0,2,1]=(-0.410414088285)*x[0]**o+(-0.767933775709)*x[0]+(-0.60156292058)*x[1]**o+(-0.489314475101)*x[1]+(0.888771153163)*x[2]**o+(-0.600341282488)*x[2]
        s[0,1,0,0]=(0.57725226271)*x[0]**o+(0.634144506828)*x[0]+(0.341370019875)*x[1]**o+(0.586961840417)*x[1]+(0.459018061293)*x[2]**o+(0.0746845088082)*x[2]
        s[0,1,0,1]=(0.0407919221935)*x[0]**o+(-0.360125630891)*x[0]+(-0.148792597333)*x[1]**o+(0.396869345515)*x[1]+(-0.745920425203)*x[2]**o+(0.0343202170743)*x[2]
        s[0,1,1,0]=(-0.924932256421)*x[0]**o+(0.516566988169)*x[0]+(-0.152377696008)*x[1]**o+(0.873885948456)*x[1]+(-0.360869839536)*x[2]**o+(-0.388854183331)*x[2]
        s[0,1,1,1]=(-0.323969456625)*x[0]**o+(0.304506990935)*x[0]+(-0.990292733104)*x[1]**o+(-0.245365945948)*x[1]+(0.181900978883)*x[2]**o+(-0.538788421192)*x[2]
        s[0,1,2,0]=(-0.374550735743)*x[0]**o+(0.564340899121)*x[0]+(0.801278948399)*x[1]**o+(-0.462054604952)*x[1]+(-0.785576728179)*x[2]**o+(0.0926519203136)*x[2]
        s[0,1,2,1]=(0.310136431429)*x[0]**o+(-0.00821101099015)*x[0]+(-0.974448609702)*x[1]**o+(0.348959120777)*x[1]+(-0.757748781922)*x[2]**o+(0.297755375582)*x[2]
        s[0,2,0,0]=(-0.812242021105)*x[0]**o+(0.898358963888)*x[0]+(0.77445189337)*x[1]**o+(0.786716425501)*x[1]+(0.544028378828)*x[2]**o+(0.549375386728)*x[2]
        s[0,2,0,1]=(-0.0378209686309)*x[0]**o+(-0.802035255239)*x[0]+(0.750004779554)*x[1]**o+(-0.671471110194)*x[1]+(0.993314295529)*x[2]**o+(-0.162020573179)*x[2]
        s[0,2,1,0]=(-0.492426591625)*x[0]**o+(0.902435821013)*x[0]+(0.557810230975)*x[1]**o+(-0.283019951662)*x[1]+(-0.987590772512)*x[2]**o+(-0.892849711933)*x[2]
        s[0,2,1,1]=(0.714593519237)*x[0]**o+(0.964018148555)*x[0]+(0.510176911254)*x[1]**o+(0.630953794541)*x[1]+(0.0297056372684)*x[2]**o+(0.554337702949)*x[2]
        s[0,2,2,0]=(-0.0754028072226)*x[0]**o+(0.0696670414466)*x[0]+(0.303440801227)*x[1]**o+(-0.876096813532)*x[1]+(-0.772838653879)*x[2]**o+(0.891062956492)*x[2]
        s[0,2,2,1]=(-0.517283509506)*x[0]**o+(-0.890513911735)*x[0]+(-0.850002026469)*x[1]**o+(0.0485442983018)*x[1]+(-0.690340415981)*x[2]**o+(0.356372135225)*x[2]
        s[0,3,0,0]=(0.00589321043146)*x[0]**o+(0.833040936257)*x[0]+(-0.779061736965)*x[1]**o+(0.596999628455)*x[1]+(0.185497386523)*x[2]**o+(-0.580282832451)*x[2]
        s[0,3,0,1]=(0.536520364057)*x[0]**o+(0.119573894206)*x[0]+(-0.481591297936)*x[1]**o+(-0.131066608017)*x[1]+(-0.714448088992)*x[2]**o+(-0.15245786606)*x[2]
        s[0,3,1,0]=(-0.649688821569)*x[0]**o+(0.872646765296)*x[0]+(0.996914263841)*x[1]**o+(-0.771999134903)*x[1]+(0.388158636968)*x[2]**o+(0.997694871854)*x[2]
        s[0,3,1,1]=(0.60805862552)*x[0]**o+(0.496342905951)*x[0]+(0.0678538981395)*x[1]**o+(-0.723458192199)*x[1]+(-0.227951366099)*x[2]**o+(-0.0454845476315)*x[2]
        s[0,3,2,0]=(0.927213775724)*x[0]**o+(-0.447976073985)*x[0]+(-0.176332048298)*x[1]**o+(0.177420385987)*x[1]+(0.752794515408)*x[2]**o+(-0.273183979432)*x[2]
        s[0,3,2,1]=(-0.648274135241)*x[0]**o+(0.16199869622)*x[0]+(-0.902866229405)*x[1]**o+(0.469114855264)*x[1]+(0.810779308988)*x[2]**o+(0.946561654853)*x[2]
        s[0,4,0,0]=(0.20080337911)*x[0]**o+(0.492510182922)*x[0]+(-0.39283470481)*x[1]**o+(-0.47885185637)*x[1]+(-0.925823446617)*x[2]**o+(0.222218483415)*x[2]
        s[0,4,0,1]=(-0.0972069635212)*x[0]**o+(0.183203800054)*x[0]+(-0.654862802864)*x[1]**o+(0.262618285977)*x[1]+(0.854563567237)*x[2]**o+(0.0964536047741)*x[2]
        s[0,4,1,0]=(0.45227435438)*x[0]**o+(0.538656962105)*x[0]+(0.365921783628)*x[1]**o+(0.215899953977)*x[1]+(0.592413111565)*x[2]**o+(-0.062048122597)*x[2]
        s[0,4,1,1]=(-0.818221902033)*x[0]**o+(-0.160355040635)*x[0]+(0.167475874143)*x[1]**o+(0.918522475482)*x[1]+(0.223565847733)*x[2]**o+(-0.552706943026)*x[2]
        s[0,4,2,0]=(0.917266921581)*x[0]**o+(-0.142334389128)*x[0]+(0.387287963005)*x[1]**o+(0.330170937971)*x[1]+(-0.822125826009)*x[2]**o+(-0.18853564744)*x[2]
        s[0,4,2,1]=(-0.720218394391)*x[0]**o+(0.844297728137)*x[0]+(0.428917747313)*x[1]**o+(0.0234117516707)*x[1]+(0.877188952533)*x[2]**o+(-0.580181524673)*x[2]
        s[1,0,0,0]=(-0.525360603901)*x[0]**o+(-0.444250370569)*x[0]+(-0.669034103414)*x[1]**o+(-0.463421879769)*x[1]+(-0.759457132782)*x[2]**o+(0.604035926001)*x[2]
        s[1,0,0,1]=(-0.0897354786393)*x[0]**o+(0.705360710589)*x[0]+(0.696483863344)*x[1]**o+(-0.241174862697)*x[1]+(-0.561951314355)*x[2]**o+(-0.912030054302)*x[2]
        s[1,0,1,0]=(0.52054104485)*x[0]**o+(0.0430575354511)*x[0]+(0.158290317145)*x[1]**o+(0.101019650181)*x[1]+(0.524338380356)*x[2]**o+(0.090701232108)*x[2]
        s[1,0,1,1]=(0.825208335954)*x[0]**o+(-0.473377827796)*x[0]+(0.68825627399)*x[1]**o+(0.494858806038)*x[1]+(0.224456734493)*x[2]**o+(0.406206820762)*x[2]
        s[1,0,2,0]=(-0.960366948345)*x[0]**o+(-0.234157118981)*x[0]+(-0.113359629154)*x[1]**o+(0.301361613247)*x[1]+(-0.594339813983)*x[2]**o+(-0.263211884586)*x[2]
        s[1,0,2,1]=(-0.94506913355)*x[0]**o+(0.389157389807)*x[0]+(-0.0470471678881)*x[1]**o+(-0.545905083414)*x[1]+(0.189132629724)*x[2]**o+(0.873560571105)*x[2]
        s[1,1,0,0]=(0.196235297476)*x[0]**o+(0.122584939735)*x[0]+(0.508485269882)*x[1]**o+(0.525003719219)*x[1]+(0.961756294197)*x[2]**o+(-0.766404136898)*x[2]
        s[1,1,0,1]=(0.158187473618)*x[0]**o+(0.570375022293)*x[0]+(0.815862093528)*x[1]**o+(-0.967297717974)*x[1]+(0.290548253702)*x[2]**o+(0.603934169794)*x[2]
        s[1,1,1,0]=(0.37168083831)*x[0]**o+(0.378783317761)*x[0]+(-0.62105516013)*x[1]**o+(-0.243670994716)*x[1]+(0.0493547361834)*x[2]**o+(-0.463410303505)*x[2]
        s[1,1,1,1]=(0.935366553895)*x[0]**o+(-0.62914115892)*x[0]+(-0.251619616412)*x[1]**o+(-0.00509465672734)*x[1]+(0.801300357872)*x[2]**o+(-0.225391368884)*x[2]
        s[1,1,2,0]=(-0.182365850951)*x[0]**o+(-0.510497578546)*x[0]+(-0.976490140605)*x[1]**o+(-0.810521612611)*x[1]+(0.568861407451)*x[2]**o+(0.984242045677)*x[2]
        s[1,1,2,1]=(0.438879837985)*x[0]**o+(0.123241828005)*x[0]+(-0.0920198739704)*x[1]**o+(0.0163670845773)*x[1]+(-0.170074389128)*x[2]**o+(0.9808945977)*x[2]
        s[1,2,0,0]=(0.844376099112)*x[0]**o+(0.281113346834)*x[0]+(0.678586875156)*x[1]**o+(-0.339719035096)*x[1]+(0.149112798051)*x[2]**o+(0.345737934766)*x[2]
        s[1,2,0,1]=(-0.823808399101)*x[0]**o+(0.741400052542)*x[0]+(0.631490960369)*x[1]**o+(0.884534048234)*x[1]+(0.986087890092)*x[2]**o+(0.0633984741173)*x[2]
        s[1,2,1,0]=(0.577630620249)*x[0]**o+(-0.875400887572)*x[0]+(0.282570000665)*x[1]**o+(-0.720651390173)*x[1]+(0.740020216206)*x[2]**o+(0.116758611432)*x[2]
        s[1,2,1,1]=(0.827573407856)*x[0]**o+(0.788455460143)*x[0]+(-0.935960102047)*x[1]**o+(0.128092793671)*x[1]+(-0.637271207159)*x[2]**o+(-0.0949607133369)*x[2]
        s[1,2,2,0]=(0.653489510769)*x[0]**o+(0.127242563347)*x[0]+(0.441720108695)*x[1]**o+(0.176710497085)*x[1]+(-0.466525521911)*x[2]**o+(-0.106726607773)*x[2]
        s[1,2,2,1]=(0.544895430642)*x[0]**o+(0.617184925179)*x[0]+(-0.590535213263)*x[1]**o+(-0.240993032963)*x[1]+(0.847624557098)*x[2]**o+(0.825419570696)*x[2]
        s[1,3,0,0]=(0.632663921163)*x[0]**o+(0.190826102102)*x[0]+(0.849534763016)*x[1]**o+(-0.0237561687913)*x[1]+(-0.269077077602)*x[2]**o+(-0.549527552663)*x[2]
        s[1,3,0,1]=(-0.573827583713)*x[0]**o+(0.698099772692)*x[0]+(-0.0111629174288)*x[1]**o+(0.779552959539)*x[1]+(0.268204963497)*x[2]**o+(0.598849955092)*x[2]
        s[1,3,1,0]=(-0.83963180468)*x[0]**o+(-0.688432739537)*x[0]+(-0.354553847784)*x[1]**o+(0.818998341858)*x[1]+(-0.214142424648)*x[2]**o+(-0.0349087206605)*x[2]
        s[1,3,1,1]=(0.961416480403)*x[0]**o+(0.214086874997)*x[0]+(-0.00837344828613)*x[1]**o+(0.907896124099)*x[1]+(-0.101452170826)*x[2]**o+(0.532739507876)*x[2]
        s[1,3,2,0]=(0.695510036287)*x[0]**o+(0.365801535675)*x[0]+(0.72964983115)*x[1]**o+(0.598376640377)*x[1]+(-0.786372424004)*x[2]**o+(-0.307873549549)*x[2]
        s[1,3,2,1]=(-0.00267955266574)*x[0]**o+(-0.36091144037)*x[0]+(-0.679691091713)*x[1]**o+(-0.728893213661)*x[1]+(-0.925050172841)*x[2]**o+(-0.218818592747)*x[2]
        s[1,4,0,0]=(-0.10754938599)*x[0]**o+(-0.412916506659)*x[0]+(0.688731006932)*x[1]**o+(0.878299598346)*x[1]+(0.726030761617)*x[2]**o+(0.637038101344)*x[2]
        s[1,4,0,1]=(0.262443563953)*x[0]**o+(-0.768431899484)*x[0]+(0.807995951545)*x[1]**o+(0.729996462998)*x[1]+(-0.128003445373)*x[2]**o+(0.516856350881)*x[2]
        s[1,4,1,0]=(-0.275354824026)*x[0]**o+(0.0620548936694)*x[0]+(-0.708292160104)*x[1]**o+(-0.138724590156)*x[1]+(-0.937760817006)*x[2]**o+(0.295878139279)*x[2]
        s[1,4,1,1]=(-0.194978075848)*x[0]**o+(0.116302091644)*x[0]+(0.668500205751)*x[1]**o+(-0.276843526204)*x[1]+(0.554624275832)*x[2]**o+(-0.0252161509726)*x[2]
        s[1,4,2,0]=(-0.980507466062)*x[0]**o+(0.345696047502)*x[0]+(0.990984322861)*x[1]**o+(-0.29237796986)*x[1]+(-0.113106912241)*x[2]**o+(-0.171569411982)*x[2]
        s[1,4,2,1]=(-0.996430023986)*x[0]**o+(0.0129252732357)*x[0]+(0.432605766267)*x[1]**o+(0.245516428361)*x[1]+(-0.287283002725)*x[2]**o+(0.496535294994)*x[2]
        s[2,0,0,0]=(-0.521251352762)*x[0]**o+(0.814082050334)*x[0]+(-0.342514979075)*x[1]**o+(0.180394009823)*x[1]+(-0.928876765188)*x[2]**o+(-0.177317444177)*x[2]
        s[2,0,0,1]=(-0.752594467046)*x[0]**o+(0.00697110526032)*x[0]+(0.107735313159)*x[1]**o+(0.507279243411)*x[1]+(0.246185410903)*x[2]**o+(-0.705550571172)*x[2]
        s[2,0,1,0]=(0.987074535948)*x[0]**o+(0.120612341024)*x[0]+(-0.00891981771691)*x[1]**o+(0.412034737534)*x[1]+(-0.641732350314)*x[2]**o+(0.702296660315)*x[2]
        s[2,0,1,1]=(0.545360348518)*x[0]**o+(0.246057841211)*x[0]+(0.68096977198)*x[1]**o+(0.16979635608)*x[1]+(-0.786467966954)*x[2]**o+(-0.604979391255)*x[2]
        s[2,0,2,0]=(0.390620126799)*x[0]**o+(-0.297208846965)*x[0]+(-0.1676231355)*x[1]**o+(-0.999842891217)*x[1]+(-0.525384600734)*x[2]**o+(-0.616431037869)*x[2]
        s[2,0,2,1]=(-0.114488632507)*x[0]**o+(-0.837696558005)*x[0]+(0.0856093277648)*x[1]**o+(-0.813930500792)*x[1]+(0.0242825112259)*x[2]**o+(-0.553431782224)*x[2]
        s[2,1,0,0]=(-0.158829154482)*x[0]**o+(0.944427245379)*x[0]+(0.288168271085)*x[1]**o+(0.294610923624)*x[1]+(-0.93996240515)*x[2]**o+(-0.141444934145)*x[2]
        s[2,1,0,1]=(0.600407255802)*x[0]**o+(0.466366546805)*x[0]+(0.293813875924)*x[1]**o+(0.824442365447)*x[1]+(-0.95914204615)*x[2]**o+(0.268073473809)*x[2]
        s[2,1,1,0]=(-0.00912285930883)*x[0]**o+(0.541241315284)*x[0]+(-0.941279012281)*x[1]**o+(0.192591379725)*x[1]+(0.84906414331)*x[2]**o+(0.739941920728)*x[2]
        s[2,1,1,1]=(-0.515663862321)*x[0]**o+(-0.995173844425)*x[0]+(-0.0545298263549)*x[1]**o+(0.0547616321893)*x[1]+(0.906580176018)*x[2]**o+(-0.724193715365)*x[2]
        s[2,1,2,0]=(-0.961884774945)*x[0]**o+(0.228071784467)*x[0]+(0.109594642294)*x[1]**o+(0.390512248069)*x[1]+(0.584516492005)*x[2]**o+(0.732112742614)*x[2]
        s[2,1,2,1]=(-0.447795495117)*x[0]**o+(-0.436915184002)*x[0]+(0.0097966293808)*x[1]**o+(0.00984049811243)*x[1]+(-0.534980632513)*x[2]**o+(0.847070567413)*x[2]
        s[2,2,0,0]=(-0.72527144583)*x[0]**o+(-0.328380984831)*x[0]+(0.891931683176)*x[1]**o+(0.731425008677)*x[1]+(0.451269066706)*x[2]**o+(-0.876119382129)*x[2]
        s[2,2,0,1]=(-0.645145440462)*x[0]**o+(0.549953455814)*x[0]+(-0.714731040969)*x[1]**o+(-0.367442134998)*x[1]+(-0.784974893863)*x[2]**o+(0.993294593495)*x[2]
        s[2,2,1,0]=(0.795416456648)*x[0]**o+(-0.249185994779)*x[0]+(0.0887737619644)*x[1]**o+(-0.8527851189)*x[1]+(-0.977545483463)*x[2]**o+(-0.458811422497)*x[2]
        s[2,2,1,1]=(0.448509047555)*x[0]**o+(0.251160841663)*x[0]+(-0.958180262344)*x[1]**o+(0.00687385479851)*x[1]+(0.415237807094)*x[2]**o+(0.454049069214)*x[2]
        s[2,2,2,0]=(-0.875182150725)*x[0]**o+(-0.164810616491)*x[0]+(-0.854984081654)*x[1]**o+(-0.487839136852)*x[1]+(-0.991611140703)*x[2]**o+(0.131746964462)*x[2]
        s[2,2,2,1]=(0.190113983979)*x[0]**o+(-0.0580500408307)*x[0]+(-0.987736788697)*x[1]**o+(0.29105974832)*x[1]+(-0.841830938414)*x[2]**o+(-0.399303249251)*x[2]
        s[2,3,0,0]=(0.375874939141)*x[0]**o+(0.0179896833971)*x[0]+(0.935171068662)*x[1]**o+(-0.605279673785)*x[1]+(-0.315907419394)*x[2]**o+(-0.653351592585)*x[2]
        s[2,3,0,1]=(-0.307367451597)*x[0]**o+(0.433464337349)*x[0]+(0.120694815275)*x[1]**o+(0.882573418509)*x[1]+(0.720880126974)*x[2]**o+(0.413515788634)*x[2]
        s[2,3,1,0]=(-0.360768726229)*x[0]**o+(-0.345798386124)*x[0]+(-0.158591700207)*x[1]**o+(0.777571415125)*x[1]+(-0.515278006685)*x[2]**o+(-0.60141050103)*x[2]
        s[2,3,1,1]=(0.19968785285)*x[0]**o+(-0.678957085866)*x[0]+(-0.504487760025)*x[1]**o+(-0.938195450799)*x[1]+(-0.869784726008)*x[2]**o+(0.611936589332)*x[2]
        s[2,3,2,0]=(-0.94908432374)*x[0]**o+(-0.764309365026)*x[0]+(0.299970983215)*x[1]**o+(0.76972605976)*x[1]+(0.808781373563)*x[2]**o+(-0.744690590895)*x[2]
        s[2,3,2,1]=(-0.827801524944)*x[0]**o+(-0.639131625181)*x[0]+(0.115482861386)*x[1]**o+(0.749852345379)*x[1]+(-0.876800704567)*x[2]**o+(-0.335471532349)*x[2]
        s[2,4,0,0]=(0.957721855837)*x[0]**o+(-0.37091118004)*x[0]+(-0.457918571765)*x[1]**o+(0.574281982261)*x[1]+(-0.0381561925569)*x[2]**o+(0.583211845309)*x[2]
        s[2,4,0,1]=(0.922272060507)*x[0]**o+(0.934043162659)*x[0]+(0.665312385413)*x[1]**o+(0.82839206727)*x[1]+(0.192535528872)*x[2]**o+(-0.170352598091)*x[2]
        s[2,4,1,0]=(0.696400806982)*x[0]**o+(-0.864993988074)*x[0]+(0.175067366294)*x[1]**o+(-0.117341125055)*x[1]+(-0.0862802982578)*x[2]**o+(0.360686011537)*x[2]
        s[2,4,1,1]=(0.285042052581)*x[0]**o+(0.819442194445)*x[0]+(0.985647806774)*x[1]**o+(-0.706227171911)*x[1]+(-0.854322012297)*x[2]**o+(-0.854051496942)*x[2]
        s[2,4,2,0]=(0.493375212662)*x[0]**o+(0.0135080286945)*x[0]+(-0.620056636744)*x[1]**o+(-0.160959399742)*x[1]+(-0.524788079589)*x[2]**o+(-0.421933761234)*x[2]
        s[2,4,2,1]=(0.657882929009)*x[0]**o+(0.164321066198)*x[0]+(0.0849684071734)*x[1]**o+(0.128314490298)*x[1]+(0.0313579868936)*x[2]**o+(0.608750041614)*x[2]
        s[3,0,0,0]=(0.401854741306)*x[0]**o+(0.134373785831)*x[0]+(-0.518732727663)*x[1]**o+(0.962631263931)*x[1]+(0.756955386629)*x[2]**o+(0.10153666864)*x[2]
        s[3,0,0,1]=(0.407206244876)*x[0]**o+(-0.432733726651)*x[0]+(-0.940640930336)*x[1]**o+(0.745788564728)*x[1]+(-0.342370630964)*x[2]**o+(-0.535375080975)*x[2]
        s[3,0,1,0]=(0.360769684176)*x[0]**o+(-0.931274190319)*x[0]+(0.86097262982)*x[1]**o+(0.767924495942)*x[1]+(0.751955166412)*x[2]**o+(-0.243315246145)*x[2]
        s[3,0,1,1]=(0.729403674327)*x[0]**o+(0.400842302945)*x[0]+(0.275966885949)*x[1]**o+(-0.546578452065)*x[1]+(-0.844280661655)*x[2]**o+(0.0715593226033)*x[2]
        s[3,0,2,0]=(-0.26926147241)*x[0]**o+(-0.313445919689)*x[0]+(0.0745755455487)*x[1]**o+(0.561797432558)*x[1]+(0.746592037865)*x[2]**o+(0.691841700089)*x[2]
        s[3,0,2,1]=(0.260642362402)*x[0]**o+(0.585261059676)*x[0]+(-0.226552249351)*x[1]**o+(-0.22018440207)*x[1]+(-0.913385081787)*x[2]**o+(0.641093619341)*x[2]
        s[3,1,0,0]=(0.371513393673)*x[0]**o+(0.0170798820983)*x[0]+(0.564278651267)*x[1]**o+(0.680930162447)*x[1]+(-0.706423458637)*x[2]**o+(0.0764206259648)*x[2]
        s[3,1,0,1]=(-0.948003266655)*x[0]**o+(0.491205780333)*x[0]+(-0.758784222468)*x[1]**o+(0.963242289935)*x[1]+(0.598059292168)*x[2]**o+(0.864032824015)*x[2]
        s[3,1,1,0]=(-0.238580509808)*x[0]**o+(-0.604062371822)*x[0]+(0.575641671747)*x[1]**o+(0.36375183411)*x[1]+(-0.972736699609)*x[2]**o+(0.880286281096)*x[2]
        s[3,1,1,1]=(0.0699909126019)*x[0]**o+(0.134320946509)*x[0]+(0.610933092241)*x[1]**o+(0.371352827221)*x[1]+(0.0323703390883)*x[2]**o+(-0.274126481723)*x[2]
        s[3,1,2,0]=(0.453740440957)*x[0]**o+(-0.943147597599)*x[0]+(0.881661129342)*x[1]**o+(-0.877404630304)*x[1]+(-0.565813043124)*x[2]**o+(0.730370433019)*x[2]
        s[3,1,2,1]=(0.55962110239)*x[0]**o+(-0.304753265168)*x[0]+(-0.446631806503)*x[1]**o+(-0.247296550227)*x[1]+(0.704691317199)*x[2]**o+(0.885258048422)*x[2]
        s[3,2,0,0]=(0.165892354646)*x[0]**o+(-0.910149277809)*x[0]+(0.512472386138)*x[1]**o+(0.783845430116)*x[1]+(0.748568950882)*x[2]**o+(0.279356093192)*x[2]
        s[3,2,0,1]=(-0.152647132155)*x[0]**o+(0.59980439016)*x[0]+(0.75599611367)*x[1]**o+(-0.492517161389)*x[1]+(-0.510828418476)*x[2]**o+(0.813006872834)*x[2]
        s[3,2,1,0]=(-0.732207745061)*x[0]**o+(-0.304109063819)*x[0]+(0.330171325627)*x[1]**o+(-0.934563542072)*x[1]+(0.529201115138)*x[2]**o+(0.837219324241)*x[2]
        s[3,2,1,1]=(0.697323448629)*x[0]**o+(0.34999597431)*x[0]+(0.67453985446)*x[1]**o+(-0.607043070971)*x[1]+(0.774743224308)*x[2]**o+(0.560978199188)*x[2]
        s[3,2,2,0]=(-0.826819922732)*x[0]**o+(-0.0808978789297)*x[0]+(0.391865159047)*x[1]**o+(-0.34035597887)*x[1]+(0.129988822983)*x[2]**o+(0.0782066826859)*x[2]
        s[3,2,2,1]=(-0.503921164807)*x[0]**o+(0.229433648691)*x[0]+(-0.224244626319)*x[1]**o+(0.307825062312)*x[1]+(0.778558288408)*x[2]**o+(0.236537878219)*x[2]
        s[3,3,0,0]=(-0.465572503617)*x[0]**o+(-0.505092598655)*x[0]+(-0.285232464978)*x[1]**o+(0.295822892399)*x[1]+(-0.678626607589)*x[2]**o+(-0.762910104233)*x[2]
        s[3,3,0,1]=(-0.313839797733)*x[0]**o+(-0.866968909594)*x[0]+(0.193089207451)*x[1]**o+(0.350572793209)*x[1]+(0.0985650768561)*x[2]**o+(0.61459734708)*x[2]
        s[3,3,1,0]=(-0.686947068473)*x[0]**o+(0.803092292826)*x[0]+(0.229346725739)*x[1]**o+(-0.523883629849)*x[1]+(-0.825851523578)*x[2]**o+(0.911991149266)*x[2]
        s[3,3,1,1]=(-0.0229534891291)*x[0]**o+(0.459587997571)*x[0]+(-0.0323375614527)*x[1]**o+(-0.960355649174)*x[1]+(-0.157463174284)*x[2]**o+(0.721625063029)*x[2]
        s[3,3,2,0]=(-0.244675134158)*x[0]**o+(-0.750815470458)*x[0]+(0.350391343156)*x[1]**o+(0.246114995378)*x[1]+(-0.299954768936)*x[2]**o+(0.621800581218)*x[2]
        s[3,3,2,1]=(0.517173606541)*x[0]**o+(0.175764075574)*x[0]+(0.423442626185)*x[1]**o+(0.803990330201)*x[1]+(0.286217667564)*x[2]**o+(-0.471348114366)*x[2]
        s[3,4,0,0]=(-0.351936186325)*x[0]**o+(-0.0279135493684)*x[0]+(0.143368480037)*x[1]**o+(-0.0914938899855)*x[1]+(-0.160075587837)*x[2]**o+(-0.504374107434)*x[2]
        s[3,4,0,1]=(0.585914411245)*x[0]**o+(0.274811379635)*x[0]+(-0.177534785865)*x[1]**o+(0.567196593954)*x[1]+(-0.510174432853)*x[2]**o+(0.930747960349)*x[2]
        s[3,4,1,0]=(0.992675673771)*x[0]**o+(-0.709559401209)*x[0]+(0.996108059004)*x[1]**o+(-0.264682085878)*x[1]+(0.336432533695)*x[2]**o+(0.439349601512)*x[2]
        s[3,4,1,1]=(-0.383904129095)*x[0]**o+(-0.640989586457)*x[0]+(0.876802160463)*x[1]**o+(-0.941096425806)*x[1]+(0.636317329751)*x[2]**o+(-0.922925940931)*x[2]
        s[3,4,2,0]=(0.215934904956)*x[0]**o+(-0.0763907072691)*x[0]+(0.864686802474)*x[1]**o+(-0.100958345332)*x[1]+(-0.545187503302)*x[2]**o+(0.896671191263)*x[2]
        s[3,4,2,1]=(-0.53798548609)*x[0]**o+(0.189564902905)*x[0]+(-0.352161561502)*x[1]**o+(0.726662085086)*x[1]+(0.514655541645)*x[2]**o+(-0.36993932162)*x[2]
        ref[0,0,0,0]=(-1.0478690215)*(1+2.*(dim-1.)/(o+1.))+(-1.37379408255)*dim
        ref[0,0,0,1]=(-1.56020467821)*(1+2.*(dim-1.)/(o+1.))+(-0.356960065085)*dim
        ref[0,0,1,0]=(0.145052542612)*(1+2.*(dim-1.)/(o+1.))+(2.26326547)*dim
        ref[0,0,1,1]=(0.190889132968)*(1+2.*(dim-1.)/(o+1.))+(0.691410883628)*dim
        ref[0,0,2,0]=(-1.27560084714)*(1+2.*(dim-1.)/(o+1.))+(-0.864491371539)*dim
        ref[0,0,2,1]=(-0.123205855702)*(1+2.*(dim-1.)/(o+1.))+(-1.8575895333)*dim
        ref[0,1,0,0]=(1.37764034388)*(1+2.*(dim-1.)/(o+1.))+(1.29579085605)*dim
        ref[0,1,0,1]=(-0.853921100343)*(1+2.*(dim-1.)/(o+1.))+(0.0710639316977)*dim
        ref[0,1,1,0]=(-1.43817979196)*(1+2.*(dim-1.)/(o+1.))+(1.00159875329)*dim
        ref[0,1,1,1]=(-1.13236121085)*(1+2.*(dim-1.)/(o+1.))+(-0.479647376205)*dim
        ref[0,1,2,0]=(-0.358848515523)*(1+2.*(dim-1.)/(o+1.))+(0.194938214483)*dim
        ref[0,1,2,1]=(-1.42206096019)*(1+2.*(dim-1.)/(o+1.))+(0.638503485369)*dim
        ref[0,2,0,0]=(0.506238251094)*(1+2.*(dim-1.)/(o+1.))+(2.23445077612)*dim
        ref[0,2,0,1]=(1.70549810645)*(1+2.*(dim-1.)/(o+1.))+(-1.63552693861)*dim
        ref[0,2,1,0]=(-0.922207133162)*(1+2.*(dim-1.)/(o+1.))+(-0.273433842582)*dim
        ref[0,2,1,1]=(1.25447606776)*(1+2.*(dim-1.)/(o+1.))+(2.14930964604)*dim
        ref[0,2,2,0]=(-0.544800659874)*(1+2.*(dim-1.)/(o+1.))+(0.0846331844061)*dim
        ref[0,2,2,1]=(-2.05762595196)*(1+2.*(dim-1.)/(o+1.))+(-0.485597478209)*dim
        ref[0,3,0,0]=(-0.587671140011)*(1+2.*(dim-1.)/(o+1.))+(0.84975773226)*dim
        ref[0,3,0,1]=(-0.659519022871)*(1+2.*(dim-1.)/(o+1.))+(-0.163950579871)*dim
        ref[0,3,1,0]=(0.73538407924)*(1+2.*(dim-1.)/(o+1.))+(1.09834250225)*dim
        ref[0,3,1,1]=(0.44796115756)*(1+2.*(dim-1.)/(o+1.))+(-0.27259983388)*dim
        ref[0,3,2,0]=(1.50367624283)*(1+2.*(dim-1.)/(o+1.))+(-0.54373966743)*dim
        ref[0,3,2,1]=(-0.740361055659)*(1+2.*(dim-1.)/(o+1.))+(1.57767520634)*dim
        ref[0,4,0,0]=(-1.11785477232)*(1+2.*(dim-1.)/(o+1.))+(0.235876809967)*dim
        ref[0,4,0,1]=(0.102493800852)*(1+2.*(dim-1.)/(o+1.))+(0.542275690805)*dim
        ref[0,4,1,0]=(1.41060924957)*(1+2.*(dim-1.)/(o+1.))+(0.692508793485)*dim
        ref[0,4,1,1]=(-0.427180180157)*(1+2.*(dim-1.)/(o+1.))+(0.205460491821)*dim
        ref[0,4,2,0]=(0.482429058578)*(1+2.*(dim-1.)/(o+1.))+(-0.000699098596959)*dim
        ref[0,4,2,1]=(0.585888305456)*(1+2.*(dim-1.)/(o+1.))+(0.287527955135)*dim
        ref[1,0,0,0]=(-1.9538518401)*(1+2.*(dim-1.)/(o+1.))+(-0.303636324337)*dim
        ref[1,0,0,1]=(0.0447970703505)*(1+2.*(dim-1.)/(o+1.))+(-0.447844206411)*dim
        ref[1,0,1,0]=(1.20316974235)*(1+2.*(dim-1.)/(o+1.))+(0.23477841774)*dim
        ref[1,0,1,1]=(1.73792134444)*(1+2.*(dim-1.)/(o+1.))+(0.427687799004)*dim
        ref[1,0,2,0]=(-1.66806639148)*(1+2.*(dim-1.)/(o+1.))+(-0.19600739032)*dim
        ref[1,0,2,1]=(-0.802983671714)*(1+2.*(dim-1.)/(o+1.))+(0.716812877498)*dim
        ref[1,1,0,0]=(1.66647686155)*(1+2.*(dim-1.)/(o+1.))+(-0.118815477944)*dim
        ref[1,1,0,1]=(1.26459782085)*(1+2.*(dim-1.)/(o+1.))+(0.207011474112)*dim
        ref[1,1,1,0]=(-0.200019585637)*(1+2.*(dim-1.)/(o+1.))+(-0.32829798046)*dim
        ref[1,1,1,1]=(1.48504729536)*(1+2.*(dim-1.)/(o+1.))+(-0.859627184532)*dim
        ref[1,1,2,0]=(-0.589994584106)*(1+2.*(dim-1.)/(o+1.))+(-0.336777145479)*dim
        ref[1,1,2,1]=(0.176785574887)*(1+2.*(dim-1.)/(o+1.))+(1.12050351028)*dim
        ref[1,2,0,0]=(1.67207577232)*(1+2.*(dim-1.)/(o+1.))+(0.287132246505)*dim
        ref[1,2,0,1]=(0.79377045136)*(1+2.*(dim-1.)/(o+1.))+(1.68933257489)*dim
        ref[1,2,1,0]=(1.60022083712)*(1+2.*(dim-1.)/(o+1.))+(-1.47929366631)*dim
        ref[1,2,1,1]=(-0.74565790135)*(1+2.*(dim-1.)/(o+1.))+(0.821587540478)*dim
        ref[1,2,2,0]=(0.628684097552)*(1+2.*(dim-1.)/(o+1.))+(0.19722645266)*dim
        ref[1,2,2,1]=(0.801984774477)*(1+2.*(dim-1.)/(o+1.))+(1.20161146291)*dim
        ref[1,3,0,0]=(1.21312160658)*(1+2.*(dim-1.)/(o+1.))+(-0.382457619353)*dim
        ref[1,3,0,1]=(-0.316785537645)*(1+2.*(dim-1.)/(o+1.))+(2.07650268732)*dim
        ref[1,3,1,0]=(-1.40832807711)*(1+2.*(dim-1.)/(o+1.))+(0.09565688166)*dim
        ref[1,3,1,1]=(0.851590861291)*(1+2.*(dim-1.)/(o+1.))+(1.65472250697)*dim
        ref[1,3,2,0]=(0.638787443433)*(1+2.*(dim-1.)/(o+1.))+(0.656304626504)*dim
        ref[1,3,2,1]=(-1.60742081722)*(1+2.*(dim-1.)/(o+1.))+(-1.30862324678)*dim
        ref[1,4,0,0]=(1.30721238256)*(1+2.*(dim-1.)/(o+1.))+(1.10242119303)*dim
        ref[1,4,0,1]=(0.942436070125)*(1+2.*(dim-1.)/(o+1.))+(0.478420914396)*dim
        ref[1,4,1,0]=(-1.92140780114)*(1+2.*(dim-1.)/(o+1.))+(0.219208442793)*dim
        ref[1,4,1,1]=(1.02814640573)*(1+2.*(dim-1.)/(o+1.))+(-0.185757585533)*dim
        ref[1,4,2,0]=(-0.102630055442)*(1+2.*(dim-1.)/(o+1.))+(-0.118251334341)*dim
        ref[1,4,2,1]=(-0.851107260444)*(1+2.*(dim-1.)/(o+1.))+(0.754976996591)*dim
        ref[2,0,0,0]=(-1.79264309703)*(1+2.*(dim-1.)/(o+1.))+(0.81715861598)*dim
        ref[2,0,0,1]=(-0.398673742984)*(1+2.*(dim-1.)/(o+1.))+(-0.191300222501)*dim
        ref[2,0,1,0]=(0.336422367917)*(1+2.*(dim-1.)/(o+1.))+(1.23494373887)*dim
        ref[2,0,1,1]=(0.439862153544)*(1+2.*(dim-1.)/(o+1.))+(-0.189125193964)*dim
        ref[2,0,2,0]=(-0.302387609436)*(1+2.*(dim-1.)/(o+1.))+(-1.91348277605)*dim
        ref[2,0,2,1]=(-0.00459679351666)*(1+2.*(dim-1.)/(o+1.))+(-2.20505884102)*dim
        ref[2,1,0,0]=(-0.810623288547)*(1+2.*(dim-1.)/(o+1.))+(1.09759323486)*dim
        ref[2,1,0,1]=(-0.0649209144233)*(1+2.*(dim-1.)/(o+1.))+(1.55888238606)*dim
        ref[2,1,1,0]=(-0.10133772828)*(1+2.*(dim-1.)/(o+1.))+(1.47377461574)*dim
        ref[2,1,1,1]=(0.336386487342)*(1+2.*(dim-1.)/(o+1.))+(-1.6646059276)*dim
        ref[2,1,2,0]=(-0.267773640646)*(1+2.*(dim-1.)/(o+1.))+(1.35069677515)*dim
        ref[2,1,2,1]=(-0.972979498249)*(1+2.*(dim-1.)/(o+1.))+(0.419995881524)*dim
        ref[2,2,0,0]=(0.617929304052)*(1+2.*(dim-1.)/(o+1.))+(-0.473075358283)*dim
        ref[2,2,0,1]=(-2.14485137529)*(1+2.*(dim-1.)/(o+1.))+(1.17580591431)*dim
        ref[2,2,1,0]=(-0.0933552648497)*(1+2.*(dim-1.)/(o+1.))+(-1.56078253618)*dim
        ref[2,2,1,1]=(-0.094433407695)*(1+2.*(dim-1.)/(o+1.))+(0.712083765676)*dim
        ref[2,2,2,0]=(-2.72177737308)*(1+2.*(dim-1.)/(o+1.))+(-0.520902788881)*dim
        ref[2,2,2,1]=(-1.63945374313)*(1+2.*(dim-1.)/(o+1.))+(-0.166293541762)*dim
        ref[2,3,0,0]=(0.995138588408)*(1+2.*(dim-1.)/(o+1.))+(-1.24064158297)*dim
        ref[2,3,0,1]=(0.534207490651)*(1+2.*(dim-1.)/(o+1.))+(1.72955354449)*dim
        ref[2,3,1,0]=(-1.03463843312)*(1+2.*(dim-1.)/(o+1.))+(-0.169637472029)*dim
        ref[2,3,1,1]=(-1.17458463318)*(1+2.*(dim-1.)/(o+1.))+(-1.00521594733)*dim
        ref[2,3,2,0]=(0.159668033037)*(1+2.*(dim-1.)/(o+1.))+(-0.739273896161)*dim
        ref[2,3,2,1]=(-1.58911936813)*(1+2.*(dim-1.)/(o+1.))+(-0.22475081215)*dim
        ref[2,4,0,0]=(0.461647091515)*(1+2.*(dim-1.)/(o+1.))+(0.786582647531)*dim
        ref[2,4,0,1]=(1.78011997479)*(1+2.*(dim-1.)/(o+1.))+(1.59208263184)*dim
        ref[2,4,1,0]=(0.785187875018)*(1+2.*(dim-1.)/(o+1.))+(-0.621649101592)*dim
        ref[2,4,1,1]=(0.416367847058)*(1+2.*(dim-1.)/(o+1.))+(-0.740836474409)*dim
        ref[2,4,2,0]=(-0.651469503672)*(1+2.*(dim-1.)/(o+1.))+(-0.569385132282)*dim
        ref[2,4,2,1]=(0.774209323076)*(1+2.*(dim-1.)/(o+1.))+(0.90138559811)*dim
        ref[3,0,0,0]=(0.640077400272)*(1+2.*(dim-1.)/(o+1.))+(1.1985417184)*dim
        ref[3,0,0,1]=(-0.875805316424)*(1+2.*(dim-1.)/(o+1.))+(-0.222320242899)*dim
        ref[3,0,1,0]=(1.97369748041)*(1+2.*(dim-1.)/(o+1.))+(-0.406664940521)*dim
        ref[3,0,1,1]=(0.161089898621)*(1+2.*(dim-1.)/(o+1.))+(-0.0741768265174)*dim
        ref[3,0,2,0]=(0.551906111004)*(1+2.*(dim-1.)/(o+1.))+(0.940193212958)*dim
        ref[3,0,2,1]=(-0.879294968735)*(1+2.*(dim-1.)/(o+1.))+(1.00617027695)*dim
        ref[3,1,0,0]=(0.229368586303)*(1+2.*(dim-1.)/(o+1.))+(0.77443067051)*dim
        ref[3,1,0,1]=(-1.10872819696)*(1+2.*(dim-1.)/(o+1.))+(2.31848089428)*dim
        ref[3,1,1,0]=(-0.63567553767)*(1+2.*(dim-1.)/(o+1.))+(0.639975743384)*dim
        ref[3,1,1,1]=(0.713294343931)*(1+2.*(dim-1.)/(o+1.))+(0.231547292007)*dim
        ref[3,1,2,0]=(0.769588527176)*(1+2.*(dim-1.)/(o+1.))+(-1.09018179488)*dim
        ref[3,1,2,1]=(0.817680613086)*(1+2.*(dim-1.)/(o+1.))+(0.333208233027)*dim
        ref[3,2,0,0]=(1.42693369167)*(1+2.*(dim-1.)/(o+1.))+(0.153052245499)*dim
        ref[3,2,0,1]=(0.0925205630387)*(1+2.*(dim-1.)/(o+1.))+(0.920294101604)*dim
        ref[3,2,1,0]=(0.127164695704)*(1+2.*(dim-1.)/(o+1.))+(-0.40145328165)*dim
        ref[3,2,1,1]=(2.1466065274)*(1+2.*(dim-1.)/(o+1.))+(0.303931102527)*dim
        ref[3,2,2,0]=(-0.304965940702)*(1+2.*(dim-1.)/(o+1.))+(-0.343047175114)*dim
        ref[3,2,2,1]=(0.0503924972819)*(1+2.*(dim-1.)/(o+1.))+(0.773796589222)*dim
        ref[3,3,0,0]=(-1.42943157618)*(1+2.*(dim-1.)/(o+1.))+(-0.972179810489)*dim
        ref[3,3,0,1]=(-0.0221855134254)*(1+2.*(dim-1.)/(o+1.))+(0.0982012306951)*dim
        ref[3,3,1,0]=(-1.28345186631)*(1+2.*(dim-1.)/(o+1.))+(1.19119981224)*dim
        ref[3,3,1,1]=(-0.212754224866)*(1+2.*(dim-1.)/(o+1.))+(0.220857411425)*dim
        ref[3,3,2,0]=(-0.194238559937)*(1+2.*(dim-1.)/(o+1.))+(0.117100106138)*dim
        ref[3,3,2,1]=(1.22683390029)*(1+2.*(dim-1.)/(o+1.))+(0.508406291409)*dim
        ref[3,4,0,0]=(-0.368643294124)*(1+2.*(dim-1.)/(o+1.))+(-0.623781546787)*dim
        ref[3,4,0,1]=(-0.101794807473)*(1+2.*(dim-1.)/(o+1.))+(1.77275593394)*dim
        ref[3,4,1,0]=(2.32521626647)*(1+2.*(dim-1.)/(o+1.))+(-0.534891885575)*dim
        ref[3,4,1,1]=(1.12921536112)*(1+2.*(dim-1.)/(o+1.))+(-2.50501195319)*dim
        ref[3,4,2,0]=(0.535434204129)*(1+2.*(dim-1.)/(o+1.))+(0.719322138661)*dim
        ref[3,4,2,1]=(-0.375491505946)*(1+2.*(dim-1.)/(o+1.))+(0.546287666371)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_Solution_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-0.747700242689)*x[0]**o+(-0.24253900484)*x[0]+(0.337715187384)*x[1]**o+(0.338764998592)*x[1]
        ref=(-0.409985055305)*(1+2.*(dim-1.)/(o+1.))+(0.0962259937514)*dim
      else:
        s=(-0.25178656924)*x[0]**o+(-0.295938166993)*x[0]+(0.0692176296902)*x[1]**o+(-0.514895147995)*x[1]+(0.34638140815)*x[2]**o+(-0.702417755803)*x[2]
        ref=(0.163812468601)*(1+2.*(dim-1.)/(o+1.))+(-1.51325107079)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_Solution_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(0.555314122492)*x[0]**o+(-0.808960080698)*x[0]+(0.884426560701)*x[1]**o+(-0.243549906992)*x[1]
        s[1]=(-0.0719219833378)*x[0]**o+(-0.403661400366)*x[0]+(0.666085789176)*x[1]**o+(-0.914772770267)*x[1]
        ref[0]=(1.43974068319)*(1+2.*(dim-1.)/(o+1.))+(-1.05250998769)*dim
        ref[1]=(0.594163805838)*(1+2.*(dim-1.)/(o+1.))+(-1.31843417063)*dim
      else:
        s[0]=(-0.826331014544)*x[0]**o+(-0.321975774952)*x[0]+(0.112378767915)*x[1]**o+(-0.756344985678)*x[1]+(0.719456760908)*x[2]**o+(-0.353602934037)*x[2]
        s[1]=(0.869195210566)*x[0]**o+(-0.315975726841)*x[0]+(0.712421301529)*x[1]**o+(0.215376989329)*x[1]+(0.964920869405)*x[2]**o+(0.922113174792)*x[2]
        ref[0]=(0.00550451427885)*(1+2.*(dim-1.)/(o+1.))+(-1.43192369467)*dim
        ref[1]=(2.5465373815)*(1+2.*(dim-1.)/(o+1.))+(0.82151443728)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_Solution_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.271641608649)*x[0]**o+(-0.685616858784)*x[0]+(0.644560357341)*x[1]**o+(0.294292988645)*x[1]
        s[0,1]=(-0.868199164404)*x[0]**o+(-0.352185589942)*x[0]+(-0.939001057807)*x[1]**o+(-0.806858466969)*x[1]
        s[0,2]=(-0.908891077111)*x[0]**o+(0.75605446917)*x[0]+(-0.921669916524)*x[1]**o+(-0.375347220131)*x[1]
        s[0,3]=(0.508605238535)*x[0]**o+(0.478464667724)*x[0]+(-0.632750076182)*x[1]**o+(-0.0150029824707)*x[1]
        s[0,4]=(-0.886187964736)*x[0]**o+(0.397671872055)*x[0]+(-0.216676829324)*x[1]**o+(0.986585859674)*x[1]
        s[1,0]=(0.630864334183)*x[0]**o+(-0.722653479356)*x[0]+(0.211515635986)*x[1]**o+(0.83331541895)*x[1]
        s[1,1]=(-0.354681281315)*x[0]**o+(-0.848733894579)*x[0]+(-0.101868246651)*x[1]**o+(-0.505303431554)*x[1]
        s[1,2]=(0.685694963182)*x[0]**o+(-0.950829894589)*x[0]+(-0.31792598055)*x[1]**o+(0.426249652943)*x[1]
        s[1,3]=(-0.614038433138)*x[0]**o+(0.723563718847)*x[0]+(0.752373220947)*x[1]**o+(0.613330337959)*x[1]
        s[1,4]=(-0.998818105353)*x[0]**o+(0.269274342639)*x[0]+(-0.902068964726)*x[1]**o+(-0.191309514428)*x[1]
        s[2,0]=(0.249323085595)*x[0]**o+(0.411304825013)*x[0]+(0.312377963164)*x[1]**o+(-0.311446803448)*x[1]
        s[2,1]=(-0.290453739481)*x[0]**o+(-0.202745911645)*x[0]+(-0.309021366331)*x[1]**o+(-0.173018322631)*x[1]
        s[2,2]=(0.691837531968)*x[0]**o+(0.672203641337)*x[0]+(0.0217882582663)*x[1]**o+(-0.776821250479)*x[1]
        s[2,3]=(0.00878696630163)*x[0]**o+(-0.565790699611)*x[0]+(-0.748591951135)*x[1]**o+(-0.46249464823)*x[1]
        s[2,4]=(-0.638178053099)*x[0]**o+(0.898061575109)*x[0]+(0.498715053696)*x[1]**o+(-0.236164377825)*x[1]
        s[3,0]=(0.843383855229)*x[0]**o+(0.652320113529)*x[0]+(0.34384880146)*x[1]**o+(-0.539878095901)*x[1]
        s[3,1]=(-0.0571664516277)*x[0]**o+(-0.658773983784)*x[0]+(0.160437286579)*x[1]**o+(-0.805774084186)*x[1]
        s[3,2]=(0.340124131227)*x[0]**o+(-0.464143943808)*x[0]+(-0.215724355021)*x[1]**o+(0.206995713005)*x[1]
        s[3,3]=(0.825533013397)*x[0]**o+(0.695982840481)*x[0]+(0.355542963602)*x[1]**o+(-0.401849802264)*x[1]
        s[3,4]=(-0.367312805197)*x[0]**o+(-0.012173639311)*x[0]+(0.581566155275)*x[1]**o+(-0.650284343373)*x[1]
        ref[0,0]=(0.91620196599)*(1+2.*(dim-1.)/(o+1.))+(-0.39132387014)*dim
        ref[0,1]=(-1.80720022221)*(1+2.*(dim-1.)/(o+1.))+(-1.15904405691)*dim
        ref[0,2]=(-1.83056099363)*(1+2.*(dim-1.)/(o+1.))+(0.380707249038)*dim
        ref[0,3]=(-0.124144837647)*(1+2.*(dim-1.)/(o+1.))+(0.463461685254)*dim
        ref[0,4]=(-1.10286479406)*(1+2.*(dim-1.)/(o+1.))+(1.38425773173)*dim
        ref[1,0]=(0.842379970168)*(1+2.*(dim-1.)/(o+1.))+(0.110661939594)*dim
        ref[1,1]=(-0.456549527966)*(1+2.*(dim-1.)/(o+1.))+(-1.35403732613)*dim
        ref[1,2]=(0.367768982632)*(1+2.*(dim-1.)/(o+1.))+(-0.524580241646)*dim
        ref[1,3]=(0.138334787809)*(1+2.*(dim-1.)/(o+1.))+(1.33689405681)*dim
        ref[1,4]=(-1.90088707008)*(1+2.*(dim-1.)/(o+1.))+(0.0779648282107)*dim
        ref[2,0]=(0.561701048758)*(1+2.*(dim-1.)/(o+1.))+(0.0998580215651)*dim
        ref[2,1]=(-0.599475105813)*(1+2.*(dim-1.)/(o+1.))+(-0.375764234276)*dim
        ref[2,2]=(0.713625790235)*(1+2.*(dim-1.)/(o+1.))+(-0.104617609143)*dim
        ref[2,3]=(-0.739804984833)*(1+2.*(dim-1.)/(o+1.))+(-1.02828534784)*dim
        ref[2,4]=(-0.139462999403)*(1+2.*(dim-1.)/(o+1.))+(0.661897197284)*dim
        ref[3,0]=(1.18723265669)*(1+2.*(dim-1.)/(o+1.))+(0.112442017629)*dim
        ref[3,1]=(0.103270834951)*(1+2.*(dim-1.)/(o+1.))+(-1.46454806797)*dim
        ref[3,2]=(0.124399776206)*(1+2.*(dim-1.)/(o+1.))+(-0.257148230803)*dim
        ref[3,3]=(1.181075977)*(1+2.*(dim-1.)/(o+1.))+(0.294133038216)*dim
        ref[3,4]=(0.214253350078)*(1+2.*(dim-1.)/(o+1.))+(-0.662457982684)*dim
      else:
        s[0,0]=(0.488698481646)*x[0]**o+(-0.0857636443438)*x[0]+(0.879463791392)*x[1]**o+(-0.748151251773)*x[1]+(0.342272219635)*x[2]**o+(0.148033760154)*x[2]
        s[0,1]=(0.716943874304)*x[0]**o+(-0.582838388256)*x[0]+(0.799901107796)*x[1]**o+(-0.814196005238)*x[1]+(0.229983496729)*x[2]**o+(-0.153919124028)*x[2]
        s[0,2]=(-0.898513198581)*x[0]**o+(0.380948693198)*x[0]+(0.357237014893)*x[1]**o+(0.650057181845)*x[1]+(0.192484147287)*x[2]**o+(-0.00114028159222)*x[2]
        s[0,3]=(0.882708886033)*x[0]**o+(0.412063277674)*x[0]+(-0.801825884205)*x[1]**o+(0.421365647832)*x[1]+(0.0732340922267)*x[2]**o+(0.831590828322)*x[2]
        s[0,4]=(-0.893541294976)*x[0]**o+(0.616353784204)*x[0]+(0.43931453774)*x[1]**o+(0.60163593029)*x[1]+(0.171225928123)*x[2]**o+(-0.809624161102)*x[2]
        s[1,0]=(0.3743694715)*x[0]**o+(0.973362616567)*x[0]+(-0.790022350688)*x[1]**o+(0.438346450916)*x[1]+(-0.85644858607)*x[2]**o+(0.861754412538)*x[2]
        s[1,1]=(0.0682853717145)*x[0]**o+(-0.483847902471)*x[0]+(0.830085512097)*x[1]**o+(0.330508826392)*x[1]+(-0.341254677789)*x[2]**o+(0.0388136714901)*x[2]
        s[1,2]=(0.740241060442)*x[0]**o+(0.569699186818)*x[0]+(0.292637941654)*x[1]**o+(-0.126938078274)*x[1]+(-0.400665686855)*x[2]**o+(-0.0981290395971)*x[2]
        s[1,3]=(0.611312886004)*x[0]**o+(0.570096324275)*x[0]+(0.222499932388)*x[1]**o+(-0.276552061893)*x[1]+(-0.370405232883)*x[2]**o+(-0.91757884865)*x[2]
        s[1,4]=(-0.844423209218)*x[0]**o+(-0.357603990072)*x[0]+(-0.291569596715)*x[1]**o+(0.127364564811)*x[1]+(-0.427115349787)*x[2]**o+(-0.689895532918)*x[2]
        s[2,0]=(-0.798050448891)*x[0]**o+(-0.197062766104)*x[0]+(-0.363892466443)*x[1]**o+(0.154013357585)*x[1]+(-0.398682782201)*x[2]**o+(-0.529551264949)*x[2]
        s[2,1]=(-0.0912777859374)*x[0]**o+(-0.675884283313)*x[0]+(0.516144657124)*x[1]**o+(-0.53265938856)*x[1]+(0.95476185698)*x[2]**o+(-0.313549200036)*x[2]
        s[2,2]=(0.868959641933)*x[0]**o+(0.962373087968)*x[0]+(-0.848379282457)*x[1]**o+(0.820817107146)*x[1]+(0.498221865324)*x[2]**o+(-0.885755811184)*x[2]
        s[2,3]=(0.552181728294)*x[0]**o+(-0.943385218578)*x[0]+(-0.650886151517)*x[1]**o+(0.204702323464)*x[1]+(-0.419413465102)*x[2]**o+(0.761759803195)*x[2]
        s[2,4]=(0.0446686935799)*x[0]**o+(-0.850084331283)*x[0]+(0.215197552732)*x[1]**o+(0.0524953736999)*x[1]+(-0.828056084121)*x[2]**o+(-0.960944367985)*x[2]
        s[3,0]=(-0.475014597092)*x[0]**o+(-0.100740967917)*x[0]+(0.76769378138)*x[1]**o+(0.846896186419)*x[1]+(0.794108335473)*x[2]**o+(-0.34345830075)*x[2]
        s[3,1]=(0.10453345316)*x[0]**o+(-0.677797655695)*x[0]+(0.471066711536)*x[1]**o+(0.534601952265)*x[1]+(-0.685589576412)*x[2]**o+(-0.025255709402)*x[2]
        s[3,2]=(0.0410162645138)*x[0]**o+(-0.948466999545)*x[0]+(0.147271170264)*x[1]**o+(0.17422632965)*x[1]+(0.425319252082)*x[2]**o+(-0.395792817384)*x[2]
        s[3,3]=(0.301093567659)*x[0]**o+(-0.48405705123)*x[0]+(-0.681930643655)*x[1]**o+(0.848540291162)*x[1]+(0.815437001935)*x[2]**o+(-0.734620301961)*x[2]
        s[3,4]=(-0.586209686649)*x[0]**o+(-0.747006165956)*x[0]+(0.0368543812482)*x[1]**o+(-0.976301323297)*x[1]+(0.748206708653)*x[2]**o+(0.833845422962)*x[2]
        ref[0,0]=(1.71043449267)*(1+2.*(dim-1.)/(o+1.))+(-0.685881135963)*dim
        ref[0,1]=(1.74682847883)*(1+2.*(dim-1.)/(o+1.))+(-1.55095351752)*dim
        ref[0,2]=(-0.348792036401)*(1+2.*(dim-1.)/(o+1.))+(1.02986559345)*dim
        ref[0,3]=(0.154117094054)*(1+2.*(dim-1.)/(o+1.))+(1.66501975383)*dim
        ref[0,4]=(-0.283000829113)*(1+2.*(dim-1.)/(o+1.))+(0.408365553392)*dim
        ref[1,0]=(-1.27210146526)*(1+2.*(dim-1.)/(o+1.))+(2.27346348002)*dim
        ref[1,1]=(0.557116206022)*(1+2.*(dim-1.)/(o+1.))+(-0.114525404589)*dim
        ref[1,2]=(0.632213315241)*(1+2.*(dim-1.)/(o+1.))+(0.344632068947)*dim
        ref[1,3]=(0.463407585509)*(1+2.*(dim-1.)/(o+1.))+(-0.624034586267)*dim
        ref[1,4]=(-1.56310815572)*(1+2.*(dim-1.)/(o+1.))+(-0.920134958179)*dim
        ref[2,0]=(-1.56062569754)*(1+2.*(dim-1.)/(o+1.))+(-0.572600673468)*dim
        ref[2,1]=(1.37962872817)*(1+2.*(dim-1.)/(o+1.))+(-1.52209287191)*dim
        ref[2,2]=(0.5188022248)*(1+2.*(dim-1.)/(o+1.))+(0.897434383931)*dim
        ref[2,3]=(-0.518117888325)*(1+2.*(dim-1.)/(o+1.))+(0.0230769080811)*dim
        ref[2,4]=(-0.568189837809)*(1+2.*(dim-1.)/(o+1.))+(-1.75853332557)*dim
        ref[3,0]=(1.08678751976)*(1+2.*(dim-1.)/(o+1.))+(0.402696917752)*dim
        ref[3,1]=(-0.109989411716)*(1+2.*(dim-1.)/(o+1.))+(-0.168451412832)*dim
        ref[3,2]=(0.61360668686)*(1+2.*(dim-1.)/(o+1.))+(-1.17003348728)*dim
        ref[3,3]=(0.434599925938)*(1+2.*(dim-1.)/(o+1.))+(-0.370137062028)*dim
        ref[3,4]=(0.198851403252)*(1+2.*(dim-1.)/(o+1.))+(-0.88946206629)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_Solution_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.591558717335)*x[0]**o+(-0.671839230736)*x[0]+(0.107743853024)*x[1]**o+(0.595347539232)*x[1]
        s[0,0,1]=(0.25500384698)*x[0]**o+(0.944399712188)*x[0]+(-0.999249484326)*x[1]**o+(-0.495212132457)*x[1]
        s[0,1,0]=(0.236244996704)*x[0]**o+(0.704807264803)*x[0]+(-0.242028416637)*x[1]**o+(-0.553320357705)*x[1]
        s[0,1,1]=(0.552969384309)*x[0]**o+(-0.941333552159)*x[0]+(-0.696785515448)*x[1]**o+(0.851994229748)*x[1]
        s[1,0,0]=(0.0953739386185)*x[0]**o+(-0.50227621093)*x[0]+(-0.994199466154)*x[1]**o+(0.975204139168)*x[1]
        s[1,0,1]=(0.0251612361822)*x[0]**o+(-0.984244259014)*x[0]+(0.928117852579)*x[1]**o+(0.0302634017269)*x[1]
        s[1,1,0]=(-0.800615084919)*x[0]**o+(0.71993242468)*x[0]+(0.714856567768)*x[1]**o+(-0.497753089167)*x[1]
        s[1,1,1]=(-0.916226186485)*x[0]**o+(0.81028396707)*x[0]+(-0.156900817441)*x[1]**o+(-0.093034093703)*x[1]
        s[2,0,0]=(-0.738732605581)*x[0]**o+(-0.77907436774)*x[0]+(0.948664797284)*x[1]**o+(-0.0764721201972)*x[1]
        s[2,0,1]=(-0.11146154208)*x[0]**o+(0.145299573751)*x[0]+(0.970129117378)*x[1]**o+(-0.272338564084)*x[1]
        s[2,1,0]=(-0.197948912143)*x[0]**o+(-0.902880824888)*x[0]+(0.579307317816)*x[1]**o+(-0.852996341605)*x[1]
        s[2,1,1]=(0.563711575633)*x[0]**o+(-0.288761476406)*x[0]+(0.7854621452)*x[1]**o+(-0.784647403092)*x[1]
        s[3,0,0]=(-0.116979739809)*x[0]**o+(0.964821934046)*x[0]+(0.441879236444)*x[1]**o+(0.245324297501)*x[1]
        s[3,0,1]=(-0.63895256779)*x[0]**o+(0.446532064378)*x[0]+(0.703018532945)*x[1]**o+(0.398978822243)*x[1]
        s[3,1,0]=(0.347022657024)*x[0]**o+(0.330266740052)*x[0]+(0.9044236351)*x[1]**o+(0.463728515326)*x[1]
        s[3,1,1]=(0.673344024583)*x[0]**o+(0.218503531592)*x[0]+(-0.981631285231)*x[1]**o+(0.493256781677)*x[1]
        s[4,0,0]=(-0.0337376408638)*x[0]**o+(0.006116830911)*x[0]+(-0.186073327302)*x[1]**o+(0.0809017607404)*x[1]
        s[4,0,1]=(0.624443889423)*x[0]**o+(0.727204963203)*x[0]+(0.724716349734)*x[1]**o+(-0.360798281504)*x[1]
        s[4,1,0]=(-0.316602217463)*x[0]**o+(-0.775985201313)*x[0]+(0.313467720837)*x[1]**o+(0.19768983092)*x[1]
        s[4,1,1]=(0.578665229532)*x[0]**o+(-0.962255191175)*x[0]+(0.341888555373)*x[1]**o+(-0.389440724436)*x[1]
        s[5,0,0]=(0.256912289915)*x[0]**o+(-0.171401072804)*x[0]+(-0.646582287213)*x[1]**o+(0.211366542089)*x[1]
        s[5,0,1]=(0.393310638354)*x[0]**o+(0.319973991926)*x[0]+(0.626363008584)*x[1]**o+(-0.0843826544875)*x[1]
        s[5,1,0]=(0.425476941925)*x[0]**o+(0.913999716353)*x[0]+(-0.534398944156)*x[1]**o+(-0.83386676719)*x[1]
        s[5,1,1]=(0.660737270239)*x[0]**o+(-0.828622795768)*x[0]+(0.488808193457)*x[1]**o+(-0.352537348251)*x[1]
        ref[0,0,0]=(0.699302570359)*(1+2.*(dim-1.)/(o+1.))+(-0.076491691504)*dim
        ref[0,0,1]=(-0.744245637345)*(1+2.*(dim-1.)/(o+1.))+(0.449187579731)*dim
        ref[0,1,0]=(-0.00578341993308)*(1+2.*(dim-1.)/(o+1.))+(0.151486907099)*dim
        ref[0,1,1]=(-0.14381613114)*(1+2.*(dim-1.)/(o+1.))+(-0.0893393224107)*dim
        ref[1,0,0]=(-0.898825527536)*(1+2.*(dim-1.)/(o+1.))+(0.472927928237)*dim
        ref[1,0,1]=(0.953279088761)*(1+2.*(dim-1.)/(o+1.))+(-0.953980857287)*dim
        ref[1,1,0]=(-0.0857585171509)*(1+2.*(dim-1.)/(o+1.))+(0.222179335513)*dim
        ref[1,1,1]=(-1.07312700393)*(1+2.*(dim-1.)/(o+1.))+(0.717249873367)*dim
        ref[2,0,0]=(0.209932191703)*(1+2.*(dim-1.)/(o+1.))+(-0.855546487937)*dim
        ref[2,0,1]=(0.858667575297)*(1+2.*(dim-1.)/(o+1.))+(-0.127038990333)*dim
        ref[2,1,0]=(0.381358405673)*(1+2.*(dim-1.)/(o+1.))+(-1.75587716649)*dim
        ref[2,1,1]=(1.34917372083)*(1+2.*(dim-1.)/(o+1.))+(-1.0734088795)*dim
        ref[3,0,0]=(0.324899496635)*(1+2.*(dim-1.)/(o+1.))+(1.21014623155)*dim
        ref[3,0,1]=(0.0640659651547)*(1+2.*(dim-1.)/(o+1.))+(0.84551088662)*dim
        ref[3,1,0]=(1.25144629212)*(1+2.*(dim-1.)/(o+1.))+(0.793995255378)*dim
        ref[3,1,1]=(-0.308287260648)*(1+2.*(dim-1.)/(o+1.))+(0.711760313269)*dim
        ref[4,0,0]=(-0.219810968166)*(1+2.*(dim-1.)/(o+1.))+(0.0870185916514)*dim
        ref[4,0,1]=(1.34916023916)*(1+2.*(dim-1.)/(o+1.))+(0.366406681699)*dim
        ref[4,1,0]=(-0.00313449662664)*(1+2.*(dim-1.)/(o+1.))+(-0.578295370393)*dim
        ref[4,1,1]=(0.920553784904)*(1+2.*(dim-1.)/(o+1.))+(-1.35169591561)*dim
        ref[5,0,0]=(-0.389669997298)*(1+2.*(dim-1.)/(o+1.))+(0.0399654692848)*dim
        ref[5,0,1]=(1.01967364694)*(1+2.*(dim-1.)/(o+1.))+(0.235591337439)*dim
        ref[5,1,0]=(-0.108922002231)*(1+2.*(dim-1.)/(o+1.))+(0.0801329491631)*dim
        ref[5,1,1]=(1.1495454637)*(1+2.*(dim-1.)/(o+1.))+(-1.18116014402)*dim
      else:
        s[0,0,0]=(0.267370933512)*x[0]**o+(0.155479029604)*x[0]+(0.483226114118)*x[1]**o+(0.0331367362161)*x[1]+(-0.958604071433)*x[2]**o+(-0.938589620173)*x[2]
        s[0,0,1]=(0.558184625201)*x[0]**o+(-0.442315117978)*x[0]+(0.443008244723)*x[1]**o+(0.10094012777)*x[1]+(-0.884286721018)*x[2]**o+(-0.234859150202)*x[2]
        s[0,1,0]=(0.00707521319666)*x[0]**o+(-0.436445369554)*x[0]+(0.0339511386587)*x[1]**o+(-0.4912959825)*x[1]+(0.387274090979)*x[2]**o+(-0.634777694546)*x[2]
        s[0,1,1]=(-0.169879301168)*x[0]**o+(0.745060242424)*x[0]+(-0.518240485868)*x[1]**o+(0.0555475122839)*x[1]+(0.420456483719)*x[2]**o+(-0.805694025108)*x[2]
        s[1,0,0]=(0.626862061657)*x[0]**o+(0.286735499998)*x[0]+(-0.154542230383)*x[1]**o+(-0.659059291598)*x[1]+(0.700399779356)*x[2]**o+(-0.149494578344)*x[2]
        s[1,0,1]=(-0.85312717829)*x[0]**o+(0.827572890814)*x[0]+(0.929068438324)*x[1]**o+(0.783234890681)*x[1]+(0.132385694002)*x[2]**o+(-0.0375332819318)*x[2]
        s[1,1,0]=(0.828428181973)*x[0]**o+(0.489617430458)*x[0]+(0.0915776189363)*x[1]**o+(-0.425176021653)*x[1]+(0.80387559654)*x[2]**o+(-0.681443382816)*x[2]
        s[1,1,1]=(-0.65230596594)*x[0]**o+(0.170131891444)*x[0]+(0.0830524896765)*x[1]**o+(-0.221764900615)*x[1]+(-0.645608220391)*x[2]**o+(0.400795086408)*x[2]
        s[2,0,0]=(0.893199207029)*x[0]**o+(-0.872998450109)*x[0]+(0.270918838822)*x[1]**o+(0.0111491233197)*x[1]+(-0.0264854465472)*x[2]**o+(0.955927944305)*x[2]
        s[2,0,1]=(0.240242096164)*x[0]**o+(-0.161479794451)*x[0]+(-0.66104753617)*x[1]**o+(0.946080550241)*x[1]+(-0.397485102557)*x[2]**o+(0.886966644933)*x[2]
        s[2,1,0]=(0.80637989046)*x[0]**o+(-0.876797025996)*x[0]+(-0.250156824474)*x[1]**o+(0.956885396073)*x[1]+(-0.721161989016)*x[2]**o+(-0.957921265653)*x[2]
        s[2,1,1]=(-0.769495191281)*x[0]**o+(-0.51589948382)*x[0]+(0.472246475849)*x[1]**o+(0.833747696193)*x[1]+(-0.810945745724)*x[2]**o+(0.00314465415233)*x[2]
        s[3,0,0]=(-0.710791737222)*x[0]**o+(0.608387037146)*x[0]+(0.911509216107)*x[1]**o+(-0.292243195309)*x[1]+(-0.957172951675)*x[2]**o+(0.524831114463)*x[2]
        s[3,0,1]=(0.892735233153)*x[0]**o+(0.28183990495)*x[0]+(0.168860806917)*x[1]**o+(0.388164284517)*x[1]+(0.144580027346)*x[2]**o+(0.881037146671)*x[2]
        s[3,1,0]=(0.221930595909)*x[0]**o+(0.903824792034)*x[0]+(0.271360511407)*x[1]**o+(-0.951642792919)*x[1]+(-0.100229570494)*x[2]**o+(-0.355195001599)*x[2]
        s[3,1,1]=(0.875769927418)*x[0]**o+(-0.161604269687)*x[0]+(0.74568148533)*x[1]**o+(-0.553173791916)*x[1]+(-0.458908157129)*x[2]**o+(-0.247242445331)*x[2]
        s[4,0,0]=(-0.515082637068)*x[0]**o+(0.456575233293)*x[0]+(-0.607867524532)*x[1]**o+(-0.155257786478)*x[1]+(-0.845324963524)*x[2]**o+(-0.862815318477)*x[2]
        s[4,0,1]=(0.922203259385)*x[0]**o+(-0.752313452972)*x[0]+(0.10594289591)*x[1]**o+(-0.370275136504)*x[1]+(-0.0979341688932)*x[2]**o+(-0.066305843593)*x[2]
        s[4,1,0]=(-0.849429313411)*x[0]**o+(-0.28348706029)*x[0]+(0.423697075901)*x[1]**o+(0.724791178434)*x[1]+(0.608888753747)*x[2]**o+(-0.975600085008)*x[2]
        s[4,1,1]=(-0.277835181883)*x[0]**o+(0.255125892715)*x[0]+(-0.801810191818)*x[1]**o+(-0.107375403424)*x[1]+(0.746887097735)*x[2]**o+(0.406084178688)*x[2]
        s[5,0,0]=(-0.137289244094)*x[0]**o+(0.76622915286)*x[0]+(-0.354285839406)*x[1]**o+(-0.195958436789)*x[1]+(-0.836211369427)*x[2]**o+(-0.684714854823)*x[2]
        s[5,0,1]=(0.263960517384)*x[0]**o+(0.908002470581)*x[0]+(0.439729777064)*x[1]**o+(-0.274244779759)*x[1]+(0.659934789159)*x[2]**o+(-0.672573099237)*x[2]
        s[5,1,0]=(-0.20882025835)*x[0]**o+(-0.528304766773)*x[0]+(-0.279646805628)*x[1]**o+(-0.23736563075)*x[1]+(-0.439565255672)*x[2]**o+(0.956815955079)*x[2]
        s[5,1,1]=(-0.294480977855)*x[0]**o+(-0.51059423384)*x[0]+(0.371920382084)*x[1]**o+(0.648458734295)*x[1]+(0.0335200465334)*x[2]**o+(-0.923801240024)*x[2]
        ref[0,0,0]=(-0.208007023803)*(1+2.*(dim-1.)/(o+1.))+(-0.749973854353)*dim
        ref[0,0,1]=(0.116906148907)*(1+2.*(dim-1.)/(o+1.))+(-0.57623414041)*dim
        ref[0,1,0]=(0.428300442835)*(1+2.*(dim-1.)/(o+1.))+(-1.5625190466)*dim
        ref[0,1,1]=(-0.267663303317)*(1+2.*(dim-1.)/(o+1.))+(-0.00508627039966)*dim
        ref[1,0,0]=(1.17271961063)*(1+2.*(dim-1.)/(o+1.))+(-0.521818369944)*dim
        ref[1,0,1]=(0.208326954036)*(1+2.*(dim-1.)/(o+1.))+(1.57327449956)*dim
        ref[1,1,0]=(1.72388139745)*(1+2.*(dim-1.)/(o+1.))+(-0.61700197401)*dim
        ref[1,1,1]=(-1.21486169665)*(1+2.*(dim-1.)/(o+1.))+(0.349162077237)*dim
        ref[2,0,0]=(1.1376325993)*(1+2.*(dim-1.)/(o+1.))+(0.0940786175155)*dim
        ref[2,0,1]=(-0.818290542564)*(1+2.*(dim-1.)/(o+1.))+(1.67156740072)*dim
        ref[2,1,0]=(-0.16493892303)*(1+2.*(dim-1.)/(o+1.))+(-0.877832895575)*dim
        ref[2,1,1]=(-1.10819446116)*(1+2.*(dim-1.)/(o+1.))+(0.320992866525)*dim
        ref[3,0,0]=(-0.75645547279)*(1+2.*(dim-1.)/(o+1.))+(0.8409749563)*dim
        ref[3,0,1]=(1.20617606742)*(1+2.*(dim-1.)/(o+1.))+(1.55104133614)*dim
        ref[3,1,0]=(0.393061536822)*(1+2.*(dim-1.)/(o+1.))+(-0.403013002484)*dim
        ref[3,1,1]=(1.16254325562)*(1+2.*(dim-1.)/(o+1.))+(-0.962020506935)*dim
        ref[4,0,0]=(-1.96827512512)*(1+2.*(dim-1.)/(o+1.))+(-0.561497871662)*dim
        ref[4,0,1]=(0.930211986402)*(1+2.*(dim-1.)/(o+1.))+(-1.18889443307)*dim
        ref[4,1,0]=(0.183156516238)*(1+2.*(dim-1.)/(o+1.))+(-0.534295966865)*dim
        ref[4,1,1]=(-0.332758275966)*(1+2.*(dim-1.)/(o+1.))+(0.553834667978)*dim
        ref[5,0,0]=(-1.32778645293)*(1+2.*(dim-1.)/(o+1.))+(-0.114444138751)*dim
        ref[5,0,1]=(1.36362508361)*(1+2.*(dim-1.)/(o+1.))+(-0.038815408415)*dim
        ref[5,1,0]=(-0.928032319651)*(1+2.*(dim-1.)/(o+1.))+(0.191145557556)*dim
        ref[5,1,1]=(0.110959450763)*(1+2.*(dim-1.)/(o+1.))+(-0.785936739569)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_Solution_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.512388618715)*x[0]**o+(-0.456786510339)*x[0]+(-0.369955618695)*x[1]**o+(0.284589526283)*x[1]
        s[0,0,0,1]=(0.45694429765)*x[0]**o+(-0.951226590686)*x[0]+(0.812195765321)*x[1]**o+(-0.450606422037)*x[1]
        s[0,0,1,0]=(0.917138960838)*x[0]**o+(0.846015644843)*x[0]+(0.311194587689)*x[1]**o+(0.318765403889)*x[1]
        s[0,0,1,1]=(0.912716498884)*x[0]**o+(-0.309788565863)*x[0]+(0.582625846661)*x[1]**o+(-0.786597172188)*x[1]
        s[0,0,2,0]=(-0.335643205116)*x[0]**o+(-0.162356382231)*x[0]+(0.33024736395)*x[1]**o+(0.137133359333)*x[1]
        s[0,0,2,1]=(-0.853219359404)*x[0]**o+(0.20806173242)*x[0]+(0.904614991529)*x[1]**o+(-0.0927322673776)*x[1]
        s[0,1,0,0]=(-0.116418078552)*x[0]**o+(-0.450766009165)*x[0]+(-0.109027531459)*x[1]**o+(-0.393345607974)*x[1]
        s[0,1,0,1]=(-0.425371185843)*x[0]**o+(-0.513194578298)*x[0]+(0.2204981189)*x[1]**o+(0.959807684568)*x[1]
        s[0,1,1,0]=(-0.184006516133)*x[0]**o+(0.724279611778)*x[0]+(0.233453086887)*x[1]**o+(-0.304433218327)*x[1]
        s[0,1,1,1]=(-0.675234346597)*x[0]**o+(0.444869722037)*x[0]+(-0.0503551086423)*x[1]**o+(-0.0766529306108)*x[1]
        s[0,1,2,0]=(0.841378546422)*x[0]**o+(-0.415767745596)*x[0]+(0.203941853234)*x[1]**o+(0.908654560689)*x[1]
        s[0,1,2,1]=(0.920754900511)*x[0]**o+(-0.630439736764)*x[0]+(-0.58028124877)*x[1]**o+(0.118829809363)*x[1]
        s[0,2,0,0]=(-0.307376557058)*x[0]**o+(0.782274756896)*x[0]+(0.996380983481)*x[1]**o+(-0.91041006941)*x[1]
        s[0,2,0,1]=(0.445454838496)*x[0]**o+(-0.278761052714)*x[0]+(-0.211616677518)*x[1]**o+(-0.982593785248)*x[1]
        s[0,2,1,0]=(-0.304509030828)*x[0]**o+(0.671529029626)*x[0]+(-0.883970223268)*x[1]**o+(-0.5778649808)*x[1]
        s[0,2,1,1]=(-0.463199486208)*x[0]**o+(0.346898357742)*x[0]+(-0.838746712872)*x[1]**o+(-0.303045089364)*x[1]
        s[0,2,2,0]=(-0.561239833326)*x[0]**o+(0.0861796115948)*x[0]+(-0.233810358053)*x[1]**o+(0.667590859355)*x[1]
        s[0,2,2,1]=(-0.0566127020774)*x[0]**o+(-0.702171135934)*x[0]+(0.156408646225)*x[1]**o+(0.503705135348)*x[1]
        s[0,3,0,0]=(-0.213903115172)*x[0]**o+(0.442577130625)*x[0]+(0.973915195866)*x[1]**o+(0.666138357006)*x[1]
        s[0,3,0,1]=(0.888546931537)*x[0]**o+(-0.581620837696)*x[0]+(-0.493141457997)*x[1]**o+(0.572137876409)*x[1]
        s[0,3,1,0]=(-0.198788230198)*x[0]**o+(0.399480321258)*x[0]+(0.437641855366)*x[1]**o+(-0.996597321011)*x[1]
        s[0,3,1,1]=(0.220561040916)*x[0]**o+(-0.613655442822)*x[0]+(0.961868845852)*x[1]**o+(-0.0593807869087)*x[1]
        s[0,3,2,0]=(0.590719334754)*x[0]**o+(0.675522468843)*x[0]+(0.420015363742)*x[1]**o+(-0.779408872787)*x[1]
        s[0,3,2,1]=(-0.739675077785)*x[0]**o+(0.868116107031)*x[0]+(-0.986504469737)*x[1]**o+(0.060324260277)*x[1]
        s[0,4,0,0]=(0.0611797596706)*x[0]**o+(0.804524773235)*x[0]+(0.987009736595)*x[1]**o+(0.811062048039)*x[1]
        s[0,4,0,1]=(0.47425001801)*x[0]**o+(-0.921861981358)*x[0]+(0.344921072375)*x[1]**o+(-0.601620009804)*x[1]
        s[0,4,1,0]=(0.0906565717033)*x[0]**o+(0.152797946513)*x[0]+(-0.567184628241)*x[1]**o+(-0.454348146448)*x[1]
        s[0,4,1,1]=(-0.0896053537692)*x[0]**o+(-0.895659709172)*x[0]+(0.0992922782923)*x[1]**o+(0.491225950996)*x[1]
        s[0,4,2,0]=(-0.810399276984)*x[0]**o+(-0.304522341713)*x[0]+(-0.247445852791)*x[1]**o+(-0.043454035062)*x[1]
        s[0,4,2,1]=(0.798398078646)*x[0]**o+(0.919534042298)*x[0]+(-0.558649299444)*x[1]**o+(-0.583442934514)*x[1]
        s[1,0,0,0]=(0.00573882500165)*x[0]**o+(-0.942216312116)*x[0]+(0.220926627969)*x[1]**o+(-0.363895609692)*x[1]
        s[1,0,0,1]=(-0.849679135789)*x[0]**o+(0.527924450097)*x[0]+(0.79947401514)*x[1]**o+(0.110179654418)*x[1]
        s[1,0,1,0]=(-0.990390680757)*x[0]**o+(0.115770686732)*x[0]+(0.0519459377792)*x[1]**o+(-0.405025360743)*x[1]
        s[1,0,1,1]=(-0.217170752126)*x[0]**o+(0.104026029604)*x[0]+(0.935952773688)*x[1]**o+(0.205909597691)*x[1]
        s[1,0,2,0]=(0.355936537495)*x[0]**o+(0.123599975203)*x[0]+(0.992745060396)*x[1]**o+(0.230955110212)*x[1]
        s[1,0,2,1]=(-0.337760143624)*x[0]**o+(-0.120785608957)*x[0]+(0.519621755185)*x[1]**o+(0.648090620962)*x[1]
        s[1,1,0,0]=(0.425227533029)*x[0]**o+(0.431947155274)*x[0]+(0.864871771139)*x[1]**o+(-0.421776717503)*x[1]
        s[1,1,0,1]=(-0.155048210381)*x[0]**o+(0.98349398745)*x[0]+(0.616262478346)*x[1]**o+(0.354130744218)*x[1]
        s[1,1,1,0]=(-0.255422611215)*x[0]**o+(0.610000128329)*x[0]+(0.692199306628)*x[1]**o+(-0.469569470881)*x[1]
        s[1,1,1,1]=(-0.00176886794175)*x[0]**o+(-0.408069848741)*x[0]+(0.708816789956)*x[1]**o+(0.823083702629)*x[1]
        s[1,1,2,0]=(0.229145338062)*x[0]**o+(-0.468402804906)*x[0]+(-0.352476560454)*x[1]**o+(0.968823931554)*x[1]
        s[1,1,2,1]=(-0.414346479022)*x[0]**o+(-0.0181085935776)*x[0]+(-0.170858935466)*x[1]**o+(-0.816432101623)*x[1]
        s[1,2,0,0]=(-0.0948608343933)*x[0]**o+(0.0068199755948)*x[0]+(-0.145376398386)*x[1]**o+(0.755438498846)*x[1]
        s[1,2,0,1]=(-0.665050941689)*x[0]**o+(-0.719231494887)*x[0]+(0.41492847392)*x[1]**o+(0.708962325583)*x[1]
        s[1,2,1,0]=(0.621628314609)*x[0]**o+(-0.997324959187)*x[0]+(0.211421770712)*x[1]**o+(0.272336354113)*x[1]
        s[1,2,1,1]=(-0.744309774218)*x[0]**o+(-0.901777776216)*x[0]+(-0.727378511259)*x[1]**o+(0.276331604178)*x[1]
        s[1,2,2,0]=(0.119470505814)*x[0]**o+(-0.377429184576)*x[0]+(0.634631061717)*x[1]**o+(0.71726575358)*x[1]
        s[1,2,2,1]=(0.196579032787)*x[0]**o+(-0.417495130697)*x[0]+(-0.469739874787)*x[1]**o+(-0.775290208858)*x[1]
        s[1,3,0,0]=(0.406483838142)*x[0]**o+(0.184354975226)*x[0]+(0.762003327026)*x[1]**o+(0.0300461028065)*x[1]
        s[1,3,0,1]=(-0.844790086513)*x[0]**o+(0.663686153475)*x[0]+(0.567312988723)*x[1]**o+(0.508368547154)*x[1]
        s[1,3,1,0]=(-0.6417260084)*x[0]**o+(0.592764591647)*x[0]+(-0.335643553939)*x[1]**o+(0.152782626)*x[1]
        s[1,3,1,1]=(-0.570864881875)*x[0]**o+(-0.610576918843)*x[0]+(-0.0434074971721)*x[1]**o+(0.373353748894)*x[1]
        s[1,3,2,0]=(0.951712868404)*x[0]**o+(0.837001943514)*x[0]+(-0.661919006256)*x[1]**o+(0.136870953867)*x[1]
        s[1,3,2,1]=(0.338496531342)*x[0]**o+(0.646315658139)*x[0]+(0.173960800908)*x[1]**o+(0.730170280099)*x[1]
        s[1,4,0,0]=(-0.00733305213967)*x[0]**o+(0.473349687079)*x[0]+(0.433262136464)*x[1]**o+(-0.122843871456)*x[1]
        s[1,4,0,1]=(-0.609798017036)*x[0]**o+(-0.271729269891)*x[0]+(-0.0473090363303)*x[1]**o+(-0.429215577266)*x[1]
        s[1,4,1,0]=(0.860194281311)*x[0]**o+(0.267299506296)*x[0]+(0.564929961344)*x[1]**o+(0.4738297918)*x[1]
        s[1,4,1,1]=(0.170949641101)*x[0]**o+(0.710820092329)*x[0]+(0.934882329613)*x[1]**o+(0.607064104034)*x[1]
        s[1,4,2,0]=(-0.299596799604)*x[0]**o+(-0.533859449337)*x[0]+(0.751725833171)*x[1]**o+(-0.690767322166)*x[1]
        s[1,4,2,1]=(-0.624424753627)*x[0]**o+(-0.947238508194)*x[0]+(0.456597368873)*x[1]**o+(-0.800064510218)*x[1]
        s[2,0,0,0]=(0.566979423938)*x[0]**o+(0.924856128006)*x[0]+(0.894661507372)*x[1]**o+(0.737960904672)*x[1]
        s[2,0,0,1]=(0.424224691717)*x[0]**o+(-0.290057017691)*x[0]+(0.524889948009)*x[1]**o+(-0.968728724115)*x[1]
        s[2,0,1,0]=(0.116336639818)*x[0]**o+(0.192371600611)*x[0]+(-0.303824973684)*x[1]**o+(-0.32000509975)*x[1]
        s[2,0,1,1]=(-0.327127663029)*x[0]**o+(0.715544836917)*x[0]+(0.347278471442)*x[1]**o+(0.109909231847)*x[1]
        s[2,0,2,0]=(0.793922217119)*x[0]**o+(0.262726473054)*x[0]+(0.172201555322)*x[1]**o+(0.770334659224)*x[1]
        s[2,0,2,1]=(0.988217831671)*x[0]**o+(0.399655753685)*x[0]+(-0.143569502754)*x[1]**o+(0.0617091702351)*x[1]
        s[2,1,0,0]=(0.775224667659)*x[0]**o+(-0.0668878550232)*x[0]+(-0.424553437498)*x[1]**o+(-0.472878522461)*x[1]
        s[2,1,0,1]=(0.214811724455)*x[0]**o+(0.331016899879)*x[0]+(0.137063379737)*x[1]**o+(-0.0540696322974)*x[1]
        s[2,1,1,0]=(-0.463688617296)*x[0]**o+(-0.373502340044)*x[0]+(-0.0840959194547)*x[1]**o+(0.399767480048)*x[1]
        s[2,1,1,1]=(-0.245792577875)*x[0]**o+(-0.996843380732)*x[0]+(-0.249517835294)*x[1]**o+(-0.594721563199)*x[1]
        s[2,1,2,0]=(0.671238831228)*x[0]**o+(0.899659387933)*x[0]+(-0.964232607177)*x[1]**o+(0.637445200931)*x[1]
        s[2,1,2,1]=(0.746879641209)*x[0]**o+(-0.247785412499)*x[0]+(-0.370865590053)*x[1]**o+(-0.302746229959)*x[1]
        s[2,2,0,0]=(0.336257487071)*x[0]**o+(-0.179673308736)*x[0]+(0.912054571446)*x[1]**o+(-0.716018450571)*x[1]
        s[2,2,0,1]=(-0.686601572148)*x[0]**o+(0.120899496999)*x[0]+(-0.419150767247)*x[1]**o+(-0.418707334342)*x[1]
        s[2,2,1,0]=(-0.354036063032)*x[0]**o+(0.363634583771)*x[0]+(0.691849369366)*x[1]**o+(-0.887830896718)*x[1]
        s[2,2,1,1]=(0.711473627816)*x[0]**o+(0.556386580914)*x[0]+(0.888396281963)*x[1]**o+(0.386590176165)*x[1]
        s[2,2,2,0]=(0.419814106708)*x[0]**o+(-0.0352463077763)*x[0]+(0.600680097958)*x[1]**o+(-0.884870139538)*x[1]
        s[2,2,2,1]=(0.203572624179)*x[0]**o+(-0.915173748563)*x[0]+(0.0466882954353)*x[1]**o+(0.567223966741)*x[1]
        s[2,3,0,0]=(0.365889449332)*x[0]**o+(-0.0875793555978)*x[0]+(-0.514531990304)*x[1]**o+(0.641244565067)*x[1]
        s[2,3,0,1]=(0.801255486954)*x[0]**o+(0.324497137754)*x[0]+(-0.750291931827)*x[1]**o+(-0.972736614855)*x[1]
        s[2,3,1,0]=(0.540943455318)*x[0]**o+(-0.507084574203)*x[0]+(0.903787268326)*x[1]**o+(0.192067385499)*x[1]
        s[2,3,1,1]=(0.50229010977)*x[0]**o+(0.327771429044)*x[0]+(-0.871646777584)*x[1]**o+(-0.915312646394)*x[1]
        s[2,3,2,0]=(0.816437071516)*x[0]**o+(-0.324552837786)*x[0]+(0.32191911659)*x[1]**o+(0.448902757154)*x[1]
        s[2,3,2,1]=(-0.688163580944)*x[0]**o+(0.00185099386065)*x[0]+(0.629596314583)*x[1]**o+(0.898968857239)*x[1]
        s[2,4,0,0]=(0.558694638173)*x[0]**o+(0.879817228992)*x[0]+(-0.779489055632)*x[1]**o+(-0.597316482587)*x[1]
        s[2,4,0,1]=(0.405266767625)*x[0]**o+(-0.803650202792)*x[0]+(-0.209683708637)*x[1]**o+(0.843260589899)*x[1]
        s[2,4,1,0]=(0.228094700844)*x[0]**o+(0.28915480893)*x[0]+(0.404160989937)*x[1]**o+(-0.837717657152)*x[1]
        s[2,4,1,1]=(-0.628771431514)*x[0]**o+(0.70484286338)*x[0]+(0.162686726925)*x[1]**o+(0.743576454116)*x[1]
        s[2,4,2,0]=(0.139366390708)*x[0]**o+(0.452232237593)*x[0]+(-0.0536300454799)*x[1]**o+(-0.0220704990737)*x[1]
        s[2,4,2,1]=(0.407548912264)*x[0]**o+(-0.184892320636)*x[0]+(0.945920847222)*x[1]**o+(-0.326239004837)*x[1]
        s[3,0,0,0]=(-0.893632035291)*x[0]**o+(0.605568638642)*x[0]+(-0.605327037586)*x[1]**o+(-0.129824948634)*x[1]
        s[3,0,0,1]=(0.058430352705)*x[0]**o+(0.724766033805)*x[0]+(0.900105388199)*x[1]**o+(-0.248904105045)*x[1]
        s[3,0,1,0]=(-0.151387812319)*x[0]**o+(0.434769353572)*x[0]+(0.525149052261)*x[1]**o+(-0.949942908295)*x[1]
        s[3,0,1,1]=(0.419206109353)*x[0]**o+(0.828163036942)*x[0]+(-0.388930812616)*x[1]**o+(0.247705907297)*x[1]
        s[3,0,2,0]=(0.0520861249252)*x[0]**o+(0.545440655049)*x[0]+(0.123957894743)*x[1]**o+(0.726676820938)*x[1]
        s[3,0,2,1]=(-0.832443800699)*x[0]**o+(-0.873219166703)*x[0]+(-0.09459670039)*x[1]**o+(-0.490598426074)*x[1]
        s[3,1,0,0]=(-0.0396898083178)*x[0]**o+(0.13897357947)*x[0]+(-0.570943434112)*x[1]**o+(0.113736405636)*x[1]
        s[3,1,0,1]=(-0.753753572629)*x[0]**o+(0.0105397073947)*x[0]+(-0.100456113737)*x[1]**o+(0.702912637963)*x[1]
        s[3,1,1,0]=(-0.2396162336)*x[0]**o+(0.0957817653067)*x[0]+(-0.426329991998)*x[1]**o+(-0.806921457576)*x[1]
        s[3,1,1,1]=(-0.00676639677643)*x[0]**o+(0.644421172464)*x[0]+(0.893174135862)*x[1]**o+(0.921265996277)*x[1]
        s[3,1,2,0]=(-0.370431629052)*x[0]**o+(-0.431968328195)*x[0]+(0.322907749791)*x[1]**o+(-0.734928059791)*x[1]
        s[3,1,2,1]=(0.565520417451)*x[0]**o+(0.5972374649)*x[0]+(-0.384953451928)*x[1]**o+(0.708513444822)*x[1]
        s[3,2,0,0]=(0.546973382463)*x[0]**o+(-0.391535907448)*x[0]+(0.743984877534)*x[1]**o+(0.690664640674)*x[1]
        s[3,2,0,1]=(0.286366773252)*x[0]**o+(-0.536931967236)*x[0]+(0.914555659603)*x[1]**o+(-0.978176990473)*x[1]
        s[3,2,1,0]=(-0.272652614089)*x[0]**o+(0.0235157061398)*x[0]+(-0.147489880453)*x[1]**o+(-0.698449540889)*x[1]
        s[3,2,1,1]=(0.856000001512)*x[0]**o+(-0.49804787796)*x[0]+(-0.993780459188)*x[1]**o+(0.851338346493)*x[1]
        s[3,2,2,0]=(-0.57527355268)*x[0]**o+(-0.760820441576)*x[0]+(-0.654096561486)*x[1]**o+(-0.736649206713)*x[1]
        s[3,2,2,1]=(-0.262714050973)*x[0]**o+(-0.182627531212)*x[0]+(0.845508653482)*x[1]**o+(0.335330629033)*x[1]
        s[3,3,0,0]=(0.284468477631)*x[0]**o+(0.778849843484)*x[0]+(-0.210037009712)*x[1]**o+(0.261684901446)*x[1]
        s[3,3,0,1]=(-0.702010952741)*x[0]**o+(-0.147730819043)*x[0]+(-0.251392638434)*x[1]**o+(-0.450438064218)*x[1]
        s[3,3,1,0]=(0.37599915758)*x[0]**o+(-0.663740528508)*x[0]+(0.831132392336)*x[1]**o+(-0.686462967317)*x[1]
        s[3,3,1,1]=(0.104633103538)*x[0]**o+(0.152999779786)*x[0]+(-0.617511701255)*x[1]**o+(-0.6261759882)*x[1]
        s[3,3,2,0]=(0.996985674737)*x[0]**o+(-0.113914220536)*x[0]+(0.815302144446)*x[1]**o+(0.426458911854)*x[1]
        s[3,3,2,1]=(0.79490425189)*x[0]**o+(-0.352566895288)*x[0]+(0.595219934007)*x[1]**o+(0.931962305688)*x[1]
        s[3,4,0,0]=(0.0342109984348)*x[0]**o+(0.756935167027)*x[0]+(-0.910031669765)*x[1]**o+(-0.768302193908)*x[1]
        s[3,4,0,1]=(-0.765106211079)*x[0]**o+(0.971115633922)*x[0]+(-0.682150454882)*x[1]**o+(0.345375833573)*x[1]
        s[3,4,1,0]=(0.392841668036)*x[0]**o+(0.06254598514)*x[0]+(0.66808036785)*x[1]**o+(-0.76724599164)*x[1]
        s[3,4,1,1]=(-0.155018584015)*x[0]**o+(0.100771866989)*x[0]+(-0.800809131287)*x[1]**o+(-0.481511683108)*x[1]
        s[3,4,2,0]=(0.420069461837)*x[0]**o+(0.116833735731)*x[0]+(-0.334781127089)*x[1]**o+(-0.278898259371)*x[1]
        s[3,4,2,1]=(-0.695614335152)*x[0]**o+(-0.116909319428)*x[0]+(-0.136699698838)*x[1]**o+(-0.199293217231)*x[1]
        ref[0,0,0,0]=(-0.882344237411)*(1+2.*(dim-1.)/(o+1.))+(-0.172196984056)*dim
        ref[0,0,0,1]=(1.26914006297)*(1+2.*(dim-1.)/(o+1.))+(-1.40183301272)*dim
        ref[0,0,1,0]=(1.22833354853)*(1+2.*(dim-1.)/(o+1.))+(1.16478104873)*dim
        ref[0,0,1,1]=(1.49534234555)*(1+2.*(dim-1.)/(o+1.))+(-1.09638573805)*dim
        ref[0,0,2,0]=(-0.00539584116507)*(1+2.*(dim-1.)/(o+1.))+(-0.0252230228979)*dim
        ref[0,0,2,1]=(0.0513956321246)*(1+2.*(dim-1.)/(o+1.))+(0.115329465043)*dim
        ref[0,1,0,0]=(-0.225445610011)*(1+2.*(dim-1.)/(o+1.))+(-0.84411161714)*dim
        ref[0,1,0,1]=(-0.204873066942)*(1+2.*(dim-1.)/(o+1.))+(0.44661310627)*dim
        ref[0,1,1,0]=(0.0494465707545)*(1+2.*(dim-1.)/(o+1.))+(0.419846393451)*dim
        ref[0,1,1,1]=(-0.725589455239)*(1+2.*(dim-1.)/(o+1.))+(0.368216791426)*dim
        ref[0,1,2,0]=(1.04532039966)*(1+2.*(dim-1.)/(o+1.))+(0.492886815094)*dim
        ref[0,1,2,1]=(0.340473651741)*(1+2.*(dim-1.)/(o+1.))+(-0.511609927401)*dim
        ref[0,2,0,0]=(0.689004426423)*(1+2.*(dim-1.)/(o+1.))+(-0.128135312514)*dim
        ref[0,2,0,1]=(0.233838160978)*(1+2.*(dim-1.)/(o+1.))+(-1.26135483796)*dim
        ref[0,2,1,0]=(-1.1884792541)*(1+2.*(dim-1.)/(o+1.))+(0.0936640488261)*dim
        ref[0,2,1,1]=(-1.30194619908)*(1+2.*(dim-1.)/(o+1.))+(0.0438532683776)*dim
        ref[0,2,2,0]=(-0.795050191379)*(1+2.*(dim-1.)/(o+1.))+(0.75377047095)*dim
        ref[0,2,2,1]=(0.099795944148)*(1+2.*(dim-1.)/(o+1.))+(-0.198466000586)*dim
        ref[0,3,0,0]=(0.760012080694)*(1+2.*(dim-1.)/(o+1.))+(1.10871548763)*dim
        ref[0,3,0,1]=(0.395405473541)*(1+2.*(dim-1.)/(o+1.))+(-0.00948296128713)*dim
        ref[0,3,1,0]=(0.238853625168)*(1+2.*(dim-1.)/(o+1.))+(-0.597116999753)*dim
        ref[0,3,1,1]=(1.18242988677)*(1+2.*(dim-1.)/(o+1.))+(-0.673036229731)*dim
        ref[0,3,2,0]=(1.0107346985)*(1+2.*(dim-1.)/(o+1.))+(-0.103886403944)*dim
        ref[0,3,2,1]=(-1.72617954752)*(1+2.*(dim-1.)/(o+1.))+(0.928440367308)*dim
        ref[0,4,0,0]=(1.04818949627)*(1+2.*(dim-1.)/(o+1.))+(1.61558682127)*dim
        ref[0,4,0,1]=(0.819171090384)*(1+2.*(dim-1.)/(o+1.))+(-1.52348199116)*dim
        ref[0,4,1,0]=(-0.476528056537)*(1+2.*(dim-1.)/(o+1.))+(-0.301550199935)*dim
        ref[0,4,1,1]=(0.00968692452303)*(1+2.*(dim-1.)/(o+1.))+(-0.404433758176)*dim
        ref[0,4,2,0]=(-1.05784512977)*(1+2.*(dim-1.)/(o+1.))+(-0.347976376775)*dim
        ref[0,4,2,1]=(0.239748779202)*(1+2.*(dim-1.)/(o+1.))+(0.336091107784)*dim
        ref[1,0,0,0]=(0.226665452971)*(1+2.*(dim-1.)/(o+1.))+(-1.30611192181)*dim
        ref[1,0,0,1]=(-0.050205120649)*(1+2.*(dim-1.)/(o+1.))+(0.638104104515)*dim
        ref[1,0,1,0]=(-0.938444742978)*(1+2.*(dim-1.)/(o+1.))+(-0.289254674011)*dim
        ref[1,0,1,1]=(0.718782021562)*(1+2.*(dim-1.)/(o+1.))+(0.309935627295)*dim
        ref[1,0,2,0]=(1.34868159789)*(1+2.*(dim-1.)/(o+1.))+(0.354555085415)*dim
        ref[1,0,2,1]=(0.181861611561)*(1+2.*(dim-1.)/(o+1.))+(0.527305012005)*dim
        ref[1,1,0,0]=(1.29009930417)*(1+2.*(dim-1.)/(o+1.))+(0.0101704377708)*dim
        ref[1,1,0,1]=(0.461214267966)*(1+2.*(dim-1.)/(o+1.))+(1.33762473167)*dim
        ref[1,1,1,0]=(0.436776695414)*(1+2.*(dim-1.)/(o+1.))+(0.140430657448)*dim
        ref[1,1,1,1]=(0.707047922014)*(1+2.*(dim-1.)/(o+1.))+(0.415013853887)*dim
        ref[1,1,2,0]=(-0.123331222393)*(1+2.*(dim-1.)/(o+1.))+(0.500421126648)*dim
        ref[1,1,2,1]=(-0.585205414488)*(1+2.*(dim-1.)/(o+1.))+(-0.8345406952)*dim
        ref[1,2,0,0]=(-0.240237232779)*(1+2.*(dim-1.)/(o+1.))+(0.762258474441)*dim
        ref[1,2,0,1]=(-0.250122467769)*(1+2.*(dim-1.)/(o+1.))+(-0.0102691693039)*dim
        ref[1,2,1,0]=(0.833050085321)*(1+2.*(dim-1.)/(o+1.))+(-0.724988605075)*dim
        ref[1,2,1,1]=(-1.47168828548)*(1+2.*(dim-1.)/(o+1.))+(-0.625446172039)*dim
        ref[1,2,2,0]=(0.75410156753)*(1+2.*(dim-1.)/(o+1.))+(0.339836569004)*dim
        ref[1,2,2,1]=(-0.273160842)*(1+2.*(dim-1.)/(o+1.))+(-1.19278533956)*dim
        ref[1,3,0,0]=(1.16848716517)*(1+2.*(dim-1.)/(o+1.))+(0.214401078033)*dim
        ref[1,3,0,1]=(-0.277477097791)*(1+2.*(dim-1.)/(o+1.))+(1.17205470063)*dim
        ref[1,3,1,0]=(-0.977369562339)*(1+2.*(dim-1.)/(o+1.))+(0.745547217647)*dim
        ref[1,3,1,1]=(-0.614272379047)*(1+2.*(dim-1.)/(o+1.))+(-0.237223169949)*dim
        ref[1,3,2,0]=(0.289793862148)*(1+2.*(dim-1.)/(o+1.))+(0.973872897381)*dim
        ref[1,3,2,1]=(0.512457332251)*(1+2.*(dim-1.)/(o+1.))+(1.37648593824)*dim
        ref[1,4,0,0]=(0.425929084324)*(1+2.*(dim-1.)/(o+1.))+(0.350505815623)*dim
        ref[1,4,0,1]=(-0.657107053366)*(1+2.*(dim-1.)/(o+1.))+(-0.700944847157)*dim
        ref[1,4,1,0]=(1.42512424265)*(1+2.*(dim-1.)/(o+1.))+(0.741129298097)*dim
        ref[1,4,1,1]=(1.10583197071)*(1+2.*(dim-1.)/(o+1.))+(1.31788419636)*dim
        ref[1,4,2,0]=(0.452129033567)*(1+2.*(dim-1.)/(o+1.))+(-1.2246267715)*dim
        ref[1,4,2,1]=(-0.167827384754)*(1+2.*(dim-1.)/(o+1.))+(-1.74730301841)*dim
        ref[2,0,0,0]=(1.46164093131)*(1+2.*(dim-1.)/(o+1.))+(1.66281703268)*dim
        ref[2,0,0,1]=(0.949114639726)*(1+2.*(dim-1.)/(o+1.))+(-1.25878574181)*dim
        ref[2,0,1,0]=(-0.187488333866)*(1+2.*(dim-1.)/(o+1.))+(-0.127633499139)*dim
        ref[2,0,1,1]=(0.020150808413)*(1+2.*(dim-1.)/(o+1.))+(0.825454068764)*dim
        ref[2,0,2,0]=(0.96612377244)*(1+2.*(dim-1.)/(o+1.))+(1.03306113228)*dim
        ref[2,0,2,1]=(0.844648328917)*(1+2.*(dim-1.)/(o+1.))+(0.46136492392)*dim
        ref[2,1,0,0]=(0.350671230162)*(1+2.*(dim-1.)/(o+1.))+(-0.539766377484)*dim
        ref[2,1,0,1]=(0.351875104192)*(1+2.*(dim-1.)/(o+1.))+(0.276947267582)*dim
        ref[2,1,1,0]=(-0.54778453675)*(1+2.*(dim-1.)/(o+1.))+(0.0262651400042)*dim
        ref[2,1,1,1]=(-0.495310413169)*(1+2.*(dim-1.)/(o+1.))+(-1.59156494393)*dim
        ref[2,1,2,0]=(-0.292993775949)*(1+2.*(dim-1.)/(o+1.))+(1.53710458886)*dim
        ref[2,1,2,1]=(0.376014051155)*(1+2.*(dim-1.)/(o+1.))+(-0.550531642457)*dim
        ref[2,2,0,0]=(1.24831205852)*(1+2.*(dim-1.)/(o+1.))+(-0.895691759307)*dim
        ref[2,2,0,1]=(-1.1057523394)*(1+2.*(dim-1.)/(o+1.))+(-0.297807837342)*dim
        ref[2,2,1,0]=(0.337813306334)*(1+2.*(dim-1.)/(o+1.))+(-0.524196312948)*dim
        ref[2,2,1,1]=(1.59986990978)*(1+2.*(dim-1.)/(o+1.))+(0.942976757078)*dim
        ref[2,2,2,0]=(1.02049420467)*(1+2.*(dim-1.)/(o+1.))+(-0.920116447314)*dim
        ref[2,2,2,1]=(0.250260919614)*(1+2.*(dim-1.)/(o+1.))+(-0.347949781822)*dim
        ref[2,3,0,0]=(-0.148642540972)*(1+2.*(dim-1.)/(o+1.))+(0.553665209469)*dim
        ref[2,3,0,1]=(0.0509635551269)*(1+2.*(dim-1.)/(o+1.))+(-0.6482394771)*dim
        ref[2,3,1,0]=(1.44473072364)*(1+2.*(dim-1.)/(o+1.))+(-0.315017188703)*dim
        ref[2,3,1,1]=(-0.369356667814)*(1+2.*(dim-1.)/(o+1.))+(-0.58754121735)*dim
        ref[2,3,2,0]=(1.13835618811)*(1+2.*(dim-1.)/(o+1.))+(0.124349919368)*dim
        ref[2,3,2,1]=(-0.058567266361)*(1+2.*(dim-1.)/(o+1.))+(0.900819851099)*dim
        ref[2,4,0,0]=(-0.220794417459)*(1+2.*(dim-1.)/(o+1.))+(0.282500746405)*dim
        ref[2,4,0,1]=(0.195583058988)*(1+2.*(dim-1.)/(o+1.))+(0.0396103871071)*dim
        ref[2,4,1,0]=(0.63225569078)*(1+2.*(dim-1.)/(o+1.))+(-0.548562848222)*dim
        ref[2,4,1,1]=(-0.466084704588)*(1+2.*(dim-1.)/(o+1.))+(1.4484193175)*dim
        ref[2,4,2,0]=(0.0857363452282)*(1+2.*(dim-1.)/(o+1.))+(0.430161738519)*dim
        ref[2,4,2,1]=(1.35346975949)*(1+2.*(dim-1.)/(o+1.))+(-0.511131325473)*dim
        ref[3,0,0,0]=(-1.49895907288)*(1+2.*(dim-1.)/(o+1.))+(0.475743690008)*dim
        ref[3,0,0,1]=(0.958535740904)*(1+2.*(dim-1.)/(o+1.))+(0.47586192876)*dim
        ref[3,0,1,0]=(0.373761239942)*(1+2.*(dim-1.)/(o+1.))+(-0.515173554723)*dim
        ref[3,0,1,1]=(0.0302752967372)*(1+2.*(dim-1.)/(o+1.))+(1.07586894424)*dim
        ref[3,0,2,0]=(0.176044019669)*(1+2.*(dim-1.)/(o+1.))+(1.27211747599)*dim
        ref[3,0,2,1]=(-0.927040501089)*(1+2.*(dim-1.)/(o+1.))+(-1.36381759278)*dim
        ref[3,1,0,0]=(-0.61063324243)*(1+2.*(dim-1.)/(o+1.))+(0.252709985106)*dim
        ref[3,1,0,1]=(-0.854209686365)*(1+2.*(dim-1.)/(o+1.))+(0.713452345358)*dim
        ref[3,1,1,0]=(-0.665946225598)*(1+2.*(dim-1.)/(o+1.))+(-0.711139692269)*dim
        ref[3,1,1,1]=(0.886407739085)*(1+2.*(dim-1.)/(o+1.))+(1.56568716874)*dim
        ref[3,1,2,0]=(-0.0475238792609)*(1+2.*(dim-1.)/(o+1.))+(-1.16689638799)*dim
        ref[3,1,2,1]=(0.180566965523)*(1+2.*(dim-1.)/(o+1.))+(1.30575090972)*dim
        ref[3,2,0,0]=(1.29095826)*(1+2.*(dim-1.)/(o+1.))+(0.299128733226)*dim
        ref[3,2,0,1]=(1.20092243286)*(1+2.*(dim-1.)/(o+1.))+(-1.51510895771)*dim
        ref[3,2,1,0]=(-0.420142494542)*(1+2.*(dim-1.)/(o+1.))+(-0.674933834749)*dim
        ref[3,2,1,1]=(-0.137780457676)*(1+2.*(dim-1.)/(o+1.))+(0.353290468533)*dim
        ref[3,2,2,0]=(-1.22937011417)*(1+2.*(dim-1.)/(o+1.))+(-1.49746964829)*dim
        ref[3,2,2,1]=(0.582794602509)*(1+2.*(dim-1.)/(o+1.))+(0.152703097821)*dim
        ref[3,3,0,0]=(0.0744314679194)*(1+2.*(dim-1.)/(o+1.))+(1.04053474493)*dim
        ref[3,3,0,1]=(-0.953403591176)*(1+2.*(dim-1.)/(o+1.))+(-0.598168883261)*dim
        ref[3,3,1,0]=(1.20713154992)*(1+2.*(dim-1.)/(o+1.))+(-1.35020349583)*dim
        ref[3,3,1,1]=(-0.512878597717)*(1+2.*(dim-1.)/(o+1.))+(-0.473176208414)*dim
        ref[3,3,2,0]=(1.81228781918)*(1+2.*(dim-1.)/(o+1.))+(0.312544691319)*dim
        ref[3,3,2,1]=(1.3901241859)*(1+2.*(dim-1.)/(o+1.))+(0.5793954104)*dim
        ref[3,4,0,0]=(-0.87582067133)*(1+2.*(dim-1.)/(o+1.))+(-0.0113670268806)*dim
        ref[3,4,0,1]=(-1.44725666596)*(1+2.*(dim-1.)/(o+1.))+(1.31649146749)*dim
        ref[3,4,1,0]=(1.06092203589)*(1+2.*(dim-1.)/(o+1.))+(-0.7047000065)*dim
        ref[3,4,1,1]=(-0.955827715302)*(1+2.*(dim-1.)/(o+1.))+(-0.38073981612)*dim
        ref[3,4,2,0]=(0.0852883347481)*(1+2.*(dim-1.)/(o+1.))+(-0.16206452364)*dim
        ref[3,4,2,1]=(-0.83231403399)*(1+2.*(dim-1.)/(o+1.))+(-0.316202536659)*dim
      else:
        s[0,0,0,0]=(-0.394972833746)*x[0]**o+(-0.555133440221)*x[0]+(-0.268090782116)*x[1]**o+(-0.279086182399)*x[1]+(0.647538832619)*x[2]**o+(0.403928571033)*x[2]
        s[0,0,0,1]=(-0.35392621979)*x[0]**o+(-0.492907886034)*x[0]+(-0.285991202298)*x[1]**o+(0.652256699399)*x[1]+(0.746644949246)*x[2]**o+(-0.81069060154)*x[2]
        s[0,0,1,0]=(-0.373534422869)*x[0]**o+(0.725526776416)*x[0]+(-0.228168552487)*x[1]**o+(0.530464480729)*x[1]+(-0.257805238342)*x[2]**o+(0.482778418004)*x[2]
        s[0,0,1,1]=(-0.19411212431)*x[0]**o+(0.45313120948)*x[0]+(0.159756421366)*x[1]**o+(0.124033159775)*x[1]+(0.395678187632)*x[2]**o+(-0.145495322245)*x[2]
        s[0,0,2,0]=(0.420598692135)*x[0]**o+(0.222648941851)*x[0]+(-0.964380624775)*x[1]**o+(0.419039850926)*x[1]+(-0.908861665427)*x[2]**o+(-0.13977247814)*x[2]
        s[0,0,2,1]=(-0.339655604031)*x[0]**o+(-0.81821640554)*x[0]+(-0.864798652203)*x[1]**o+(-0.695538165934)*x[1]+(0.535554008883)*x[2]**o+(-0.142485273891)*x[2]
        s[0,1,0,0]=(-0.221315603083)*x[0]**o+(0.437569708371)*x[0]+(0.702877377655)*x[1]**o+(0.169385737092)*x[1]+(-0.92490534465)*x[2]**o+(0.264213443224)*x[2]
        s[0,1,0,1]=(0.61945266928)*x[0]**o+(0.699276978747)*x[0]+(0.199776861853)*x[1]**o+(-0.615345507396)*x[1]+(-0.70081403292)*x[2]**o+(0.664056523269)*x[2]
        s[0,1,1,0]=(-0.479722011354)*x[0]**o+(-0.591782822119)*x[0]+(0.919441326242)*x[1]**o+(-0.886693034352)*x[1]+(0.48123492158)*x[2]**o+(0.308135102102)*x[2]
        s[0,1,1,1]=(-0.522342575747)*x[0]**o+(0.662917347867)*x[0]+(0.359887593621)*x[1]**o+(-0.228498407508)*x[1]+(0.705995139546)*x[2]**o+(-0.406581496679)*x[2]
        s[0,1,2,0]=(0.555378475566)*x[0]**o+(-0.680672745096)*x[0]+(-0.269859012441)*x[1]**o+(0.800892438723)*x[1]+(-0.455863363072)*x[2]**o+(-0.991391540158)*x[2]
        s[0,1,2,1]=(0.547403511029)*x[0]**o+(-0.154514192835)*x[0]+(0.177483676876)*x[1]**o+(0.887044119995)*x[1]+(-0.21971493108)*x[2]**o+(-0.262092872636)*x[2]
        s[0,2,0,0]=(0.976262232729)*x[0]**o+(0.548252161786)*x[0]+(-0.743334308912)*x[1]**o+(0.207627841895)*x[1]+(0.853225044125)*x[2]**o+(0.307558901346)*x[2]
        s[0,2,0,1]=(0.503102495469)*x[0]**o+(0.407241098221)*x[0]+(0.52413664456)*x[1]**o+(-0.00773056229007)*x[1]+(-0.292242153733)*x[2]**o+(0.17146852389)*x[2]
        s[0,2,1,0]=(0.13389613662)*x[0]**o+(-0.87587702201)*x[0]+(-0.678875907381)*x[1]**o+(0.543117132397)*x[1]+(0.393096793861)*x[2]**o+(0.959258318284)*x[2]
        s[0,2,1,1]=(-0.0940648527232)*x[0]**o+(-0.598198827088)*x[0]+(0.424517028995)*x[1]**o+(-0.345900941234)*x[1]+(0.758648965957)*x[2]**o+(0.25975303965)*x[2]
        s[0,2,2,0]=(-0.870274070711)*x[0]**o+(-0.78246615425)*x[0]+(0.392295964553)*x[1]**o+(0.844507475338)*x[1]+(0.528851559277)*x[2]**o+(-0.995729427392)*x[2]
        s[0,2,2,1]=(-0.0730197692456)*x[0]**o+(-0.312551702743)*x[0]+(0.623722578367)*x[1]**o+(-0.848292098624)*x[1]+(-0.779643252401)*x[2]**o+(-0.338597223715)*x[2]
        s[0,3,0,0]=(0.872506198169)*x[0]**o+(-0.500297419082)*x[0]+(0.269776051595)*x[1]**o+(0.566518089969)*x[1]+(-0.498369039824)*x[2]**o+(0.607886737439)*x[2]
        s[0,3,0,1]=(0.883053802312)*x[0]**o+(0.833130186655)*x[0]+(-0.921394587681)*x[1]**o+(0.0175686356791)*x[1]+(0.951456010531)*x[2]**o+(-0.571752807102)*x[2]
        s[0,3,1,0]=(-0.712330362129)*x[0]**o+(-0.676885540903)*x[0]+(-0.509633815107)*x[1]**o+(0.999769611236)*x[1]+(-0.186240684121)*x[2]**o+(-0.386806354224)*x[2]
        s[0,3,1,1]=(0.997518452801)*x[0]**o+(-0.269198998158)*x[0]+(-0.775427684973)*x[1]**o+(0.787580393259)*x[1]+(0.195858442466)*x[2]**o+(-0.734837176349)*x[2]
        s[0,3,2,0]=(0.888165993988)*x[0]**o+(-0.611433401469)*x[0]+(0.840713835877)*x[1]**o+(-0.805947825209)*x[1]+(-0.223790913101)*x[2]**o+(0.274074627813)*x[2]
        s[0,3,2,1]=(-0.0586612521858)*x[0]**o+(-0.904292259669)*x[0]+(0.701563259971)*x[1]**o+(-0.919454807365)*x[1]+(-0.432367433099)*x[2]**o+(-0.915055158557)*x[2]
        s[0,4,0,0]=(-0.896479628968)*x[0]**o+(-0.0775794895972)*x[0]+(0.952385683546)*x[1]**o+(0.101370020306)*x[1]+(-0.311916160508)*x[2]**o+(0.327792852845)*x[2]
        s[0,4,0,1]=(-0.368307750793)*x[0]**o+(-0.824637391638)*x[0]+(0.143668778522)*x[1]**o+(0.224471763433)*x[1]+(0.470345995942)*x[2]**o+(-0.238496191133)*x[2]
        s[0,4,1,0]=(0.978800093563)*x[0]**o+(0.356297491637)*x[0]+(-0.846067544583)*x[1]**o+(0.0112192363669)*x[1]+(-0.456308213004)*x[2]**o+(0.328816226899)*x[2]
        s[0,4,1,1]=(0.860778047982)*x[0]**o+(-0.85484855319)*x[0]+(0.431318104432)*x[1]**o+(0.0519725606118)*x[1]+(-0.37452257816)*x[2]**o+(0.387786048315)*x[2]
        s[0,4,2,0]=(-0.809652418528)*x[0]**o+(0.622059542769)*x[0]+(0.0769858780015)*x[1]**o+(-0.1118510671)*x[1]+(0.462693639527)*x[2]**o+(-0.321289200501)*x[2]
        s[0,4,2,1]=(-0.112319716285)*x[0]**o+(-0.97958472439)*x[0]+(0.471152868527)*x[1]**o+(0.979477042696)*x[1]+(0.343437406244)*x[2]**o+(0.330245074789)*x[2]
        s[1,0,0,0]=(-0.664959353312)*x[0]**o+(0.667428688064)*x[0]+(0.379323454697)*x[1]**o+(0.458212123636)*x[1]+(-0.583770985715)*x[2]**o+(0.926174954355)*x[2]
        s[1,0,0,1]=(0.463653553012)*x[0]**o+(-0.998470865927)*x[0]+(-0.0590876546604)*x[1]**o+(0.22211328071)*x[1]+(-0.741158466684)*x[2]**o+(-0.405853581466)*x[2]
        s[1,0,1,0]=(0.261926286639)*x[0]**o+(-0.291967639861)*x[0]+(-0.22306024334)*x[1]**o+(-0.266187302656)*x[1]+(0.0808303795362)*x[2]**o+(-0.0411340553637)*x[2]
        s[1,0,1,1]=(0.823792286605)*x[0]**o+(-0.622764469917)*x[0]+(0.532406278339)*x[1]**o+(-0.799863805036)*x[1]+(0.356182760763)*x[2]**o+(0.633305652052)*x[2]
        s[1,0,2,0]=(0.386490056692)*x[0]**o+(-0.538422996672)*x[0]+(-0.400192004838)*x[1]**o+(0.632203703462)*x[1]+(0.315043759293)*x[2]**o+(-0.10635477353)*x[2]
        s[1,0,2,1]=(0.911736934682)*x[0]**o+(0.874267947717)*x[0]+(0.716599906083)*x[1]**o+(-0.477115250943)*x[1]+(0.296312692731)*x[2]**o+(0.691409352221)*x[2]
        s[1,1,0,0]=(0.193258443163)*x[0]**o+(-0.479351523999)*x[0]+(0.426152720777)*x[1]**o+(0.577292380929)*x[1]+(0.781776817395)*x[2]**o+(-0.0622489459224)*x[2]
        s[1,1,0,1]=(-0.491606711738)*x[0]**o+(-0.138919126056)*x[0]+(0.10073957381)*x[1]**o+(0.560595873872)*x[1]+(0.661805959053)*x[2]**o+(0.999249400576)*x[2]
        s[1,1,1,0]=(-0.197096694248)*x[0]**o+(0.205033675186)*x[0]+(0.265896904632)*x[1]**o+(0.448157190065)*x[1]+(0.284574920599)*x[2]**o+(-0.466032134334)*x[2]
        s[1,1,1,1]=(0.852594063486)*x[0]**o+(-0.139990914704)*x[0]+(0.0792640568063)*x[1]**o+(0.279425947587)*x[1]+(-0.598534354914)*x[2]**o+(-0.423199533073)*x[2]
        s[1,1,2,0]=(0.576687955944)*x[0]**o+(-0.616599888356)*x[0]+(-0.826670910311)*x[1]**o+(0.54433728322)*x[1]+(0.00123761537904)*x[2]**o+(0.716238991968)*x[2]
        s[1,1,2,1]=(0.56855109067)*x[0]**o+(-0.0440632979111)*x[0]+(0.526871640009)*x[1]**o+(0.275141335835)*x[1]+(-0.983229310103)*x[2]**o+(0.700105733507)*x[2]
        s[1,2,0,0]=(-0.184742995569)*x[0]**o+(0.71036642023)*x[0]+(0.981161346217)*x[1]**o+(0.365488167653)*x[1]+(-0.398883902177)*x[2]**o+(-0.482354856056)*x[2]
        s[1,2,0,1]=(0.583421736253)*x[0]**o+(-0.279163572851)*x[0]+(0.503764541147)*x[1]**o+(0.292381662704)*x[1]+(-0.888007033365)*x[2]**o+(-0.448668581094)*x[2]
        s[1,2,1,0]=(0.806086468959)*x[0]**o+(-0.959525959302)*x[0]+(0.734809833547)*x[1]**o+(-0.284558836843)*x[1]+(-0.354048559091)*x[2]**o+(-0.464063301273)*x[2]
        s[1,2,1,1]=(0.20737358797)*x[0]**o+(-0.958445091026)*x[0]+(-0.207486744384)*x[1]**o+(-0.300655801991)*x[1]+(0.534182391535)*x[2]**o+(-0.630595215476)*x[2]
        s[1,2,2,0]=(0.573970416565)*x[0]**o+(0.0868191347586)*x[0]+(0.90996767074)*x[1]**o+(-0.556896647781)*x[1]+(-0.57168584006)*x[2]**o+(-0.000855122180503)*x[2]
        s[1,2,2,1]=(-0.0500416574964)*x[0]**o+(0.134962389253)*x[0]+(0.7037800261)*x[1]**o+(-0.46634099981)*x[1]+(-0.978823012363)*x[2]**o+(0.429717517544)*x[2]
        s[1,3,0,0]=(-0.480934294581)*x[0]**o+(-0.761664422527)*x[0]+(0.563388700943)*x[1]**o+(0.286474912293)*x[1]+(-0.254087945936)*x[2]**o+(0.823788425201)*x[2]
        s[1,3,0,1]=(0.287760411402)*x[0]**o+(-0.667747306058)*x[0]+(-0.801505580774)*x[1]**o+(0.642958552096)*x[1]+(-0.443695399886)*x[2]**o+(-0.840149579234)*x[2]
        s[1,3,1,0]=(-0.789394564521)*x[0]**o+(0.918638482871)*x[0]+(0.584254838389)*x[1]**o+(-0.150259802986)*x[1]+(0.794702325874)*x[2]**o+(0.0246788014415)*x[2]
        s[1,3,1,1]=(-0.1183405979)*x[0]**o+(0.0451549250255)*x[0]+(0.1517987763)*x[1]**o+(-0.200979231459)*x[1]+(-0.0817034681199)*x[2]**o+(0.664693805987)*x[2]
        s[1,3,2,0]=(-0.364619176305)*x[0]**o+(0.989060492595)*x[0]+(-0.452469848404)*x[1]**o+(-0.622993726081)*x[1]+(0.738661997825)*x[2]**o+(0.89325891611)*x[2]
        s[1,3,2,1]=(0.794435451296)*x[0]**o+(0.561632824215)*x[0]+(-0.661460086901)*x[1]**o+(0.110534045458)*x[1]+(-0.11627022197)*x[2]**o+(-0.737456873271)*x[2]
        s[1,4,0,0]=(0.821875192234)*x[0]**o+(0.378653978743)*x[0]+(0.384830574445)*x[1]**o+(0.815762479042)*x[1]+(0.709307414564)*x[2]**o+(0.785945406666)*x[2]
        s[1,4,0,1]=(-0.195473903829)*x[0]**o+(-0.792429456326)*x[0]+(0.475482962939)*x[1]**o+(0.02846998342)*x[1]+(0.433471515314)*x[2]**o+(0.0565560487548)*x[2]
        s[1,4,1,0]=(-0.927049196862)*x[0]**o+(-0.770563924424)*x[0]+(0.722391079777)*x[1]**o+(-0.962242600193)*x[1]+(-0.652853937129)*x[2]**o+(-0.583745627826)*x[2]
        s[1,4,1,1]=(-0.955616614181)*x[0]**o+(0.194945562768)*x[0]+(-0.517066615715)*x[1]**o+(-0.712362265862)*x[1]+(-0.524911207386)*x[2]**o+(-0.882591220196)*x[2]
        s[1,4,2,0]=(0.524532786764)*x[0]**o+(0.284840195202)*x[0]+(0.963855761362)*x[1]**o+(-0.856530057166)*x[1]+(-0.0740070151584)*x[2]**o+(0.226341867159)*x[2]
        s[1,4,2,1]=(0.446800509767)*x[0]**o+(-0.864046465502)*x[0]+(-0.517438631247)*x[1]**o+(0.901374962381)*x[1]+(0.601052625973)*x[2]**o+(-0.863564939303)*x[2]
        s[2,0,0,0]=(-0.701781199314)*x[0]**o+(0.264327906644)*x[0]+(0.971572320137)*x[1]**o+(-0.168607506193)*x[1]+(-0.526717738449)*x[2]**o+(0.226927089015)*x[2]
        s[2,0,0,1]=(-0.847412912499)*x[0]**o+(-0.401413370017)*x[0]+(0.759311464889)*x[1]**o+(0.457894962279)*x[1]+(-0.55434272035)*x[2]**o+(0.120326915639)*x[2]
        s[2,0,1,0]=(-0.517103294855)*x[0]**o+(0.492756717159)*x[0]+(0.973627035185)*x[1]**o+(-0.860482824403)*x[1]+(0.54057457411)*x[2]**o+(-0.874495812872)*x[2]
        s[2,0,1,1]=(-0.932588871815)*x[0]**o+(-0.741303214077)*x[0]+(0.468667081235)*x[1]**o+(0.395164667731)*x[1]+(0.412999483627)*x[2]**o+(0.827200271655)*x[2]
        s[2,0,2,0]=(0.324804049142)*x[0]**o+(0.687197584348)*x[0]+(0.48017530302)*x[1]**o+(0.0594198080606)*x[1]+(-0.243274785097)*x[2]**o+(0.561027778867)*x[2]
        s[2,0,2,1]=(-0.830970533632)*x[0]**o+(-0.399321288145)*x[0]+(-0.715545820929)*x[1]**o+(-0.290047681469)*x[1]+(-0.335483597978)*x[2]**o+(0.666741330684)*x[2]
        s[2,1,0,0]=(-0.734079757702)*x[0]**o+(0.290309222969)*x[0]+(0.764118958044)*x[1]**o+(0.4132335859)*x[1]+(0.257031297672)*x[2]**o+(0.244389627708)*x[2]
        s[2,1,0,1]=(0.687268551061)*x[0]**o+(-0.24563836651)*x[0]+(-0.123765123048)*x[1]**o+(-0.530923035235)*x[1]+(-0.720827493122)*x[2]**o+(0.210975066905)*x[2]
        s[2,1,1,0]=(0.813659604982)*x[0]**o+(0.893957744697)*x[0]+(0.991947458807)*x[1]**o+(0.793408082473)*x[1]+(0.609236290624)*x[2]**o+(-0.0658228268111)*x[2]
        s[2,1,1,1]=(-0.118289813545)*x[0]**o+(0.622749254009)*x[0]+(0.465005967301)*x[1]**o+(-0.878906002448)*x[1]+(0.168374644259)*x[2]**o+(0.149889108873)*x[2]
        s[2,1,2,0]=(-0.255533627884)*x[0]**o+(-0.436918772486)*x[0]+(0.29166400203)*x[1]**o+(0.928052058386)*x[1]+(0.303846927853)*x[2]**o+(0.158922482472)*x[2]
        s[2,1,2,1]=(-0.0504039593843)*x[0]**o+(0.170081032189)*x[0]+(-0.739948814307)*x[1]**o+(-0.52541309551)*x[1]+(0.797681120077)*x[2]**o+(0.247665713856)*x[2]
        s[2,2,0,0]=(-0.400562988004)*x[0]**o+(-0.128489671375)*x[0]+(-0.451867300451)*x[1]**o+(-0.343423869937)*x[1]+(0.663184069698)*x[2]**o+(0.926436292949)*x[2]
        s[2,2,0,1]=(-0.599719778431)*x[0]**o+(0.108577031922)*x[0]+(0.217879834507)*x[1]**o+(0.907899596451)*x[1]+(-0.161562448509)*x[2]**o+(-0.514018490585)*x[2]
        s[2,2,1,0]=(-0.736520696776)*x[0]**o+(0.166243034841)*x[0]+(0.438311085394)*x[1]**o+(0.802937292983)*x[1]+(-0.938817901098)*x[2]**o+(-0.205869039453)*x[2]
        s[2,2,1,1]=(0.555108741686)*x[0]**o+(-0.533145284484)*x[0]+(-0.763891188865)*x[1]**o+(0.515585725441)*x[1]+(0.638581800777)*x[2]**o+(0.629321554502)*x[2]
        s[2,2,2,0]=(-0.790093516383)*x[0]**o+(-0.0154620341689)*x[0]+(0.462011424745)*x[1]**o+(0.598267220586)*x[1]+(0.576054554929)*x[2]**o+(0.482972076666)*x[2]
        s[2,2,2,1]=(0.075201635129)*x[0]**o+(-0.660059195587)*x[0]+(0.00711502517884)*x[1]**o+(-0.391407272114)*x[1]+(-0.213729719317)*x[2]**o+(-0.561573742069)*x[2]
        s[2,3,0,0]=(0.350797999062)*x[0]**o+(0.250500699573)*x[0]+(0.818402537945)*x[1]**o+(-0.899093594018)*x[1]+(-0.162195807738)*x[2]**o+(-0.147586906331)*x[2]
        s[2,3,0,1]=(0.695618803281)*x[0]**o+(0.227239221026)*x[0]+(-0.968505693287)*x[1]**o+(-0.473260919549)*x[1]+(-0.746882331556)*x[2]**o+(0.486703205212)*x[2]
        s[2,3,1,0]=(-0.271378189855)*x[0]**o+(-0.561268063707)*x[0]+(-0.0252286382422)*x[1]**o+(0.229921692249)*x[1]+(0.989187908151)*x[2]**o+(0.643686783302)*x[2]
        s[2,3,1,1]=(0.750682282794)*x[0]**o+(-0.27757575698)*x[0]+(0.604377636669)*x[1]**o+(-0.733927934644)*x[1]+(-0.718229138068)*x[2]**o+(-0.435426875038)*x[2]
        s[2,3,2,0]=(0.0733516934174)*x[0]**o+(-0.174475004056)*x[0]+(0.478942713703)*x[1]**o+(0.662549744231)*x[1]+(-0.565016805898)*x[2]**o+(0.17793235315)*x[2]
        s[2,3,2,1]=(-0.15216608314)*x[0]**o+(0.999325854219)*x[0]+(0.496048192253)*x[1]**o+(-0.674178160594)*x[1]+(-0.927955584861)*x[2]**o+(0.156845563256)*x[2]
        s[2,4,0,0]=(-0.912208708086)*x[0]**o+(0.929579552168)*x[0]+(-0.0445821051156)*x[1]**o+(0.911346880333)*x[1]+(0.309997148008)*x[2]**o+(0.0975168137997)*x[2]
        s[2,4,0,1]=(0.65092333822)*x[0]**o+(0.605218122961)*x[0]+(-0.684013078124)*x[1]**o+(0.088688492152)*x[1]+(-0.0554688873336)*x[2]**o+(-0.292971890481)*x[2]
        s[2,4,1,0]=(-0.437643682456)*x[0]**o+(-0.161540806934)*x[0]+(-0.863085496236)*x[1]**o+(0.714210296119)*x[1]+(0.972219783929)*x[2]**o+(-0.0450752608276)*x[2]
        s[2,4,1,1]=(0.838644689829)*x[0]**o+(0.876692248024)*x[0]+(-0.787815110065)*x[1]**o+(-0.867528859191)*x[1]+(-0.393677502867)*x[2]**o+(-0.522478124784)*x[2]
        s[2,4,2,0]=(-0.606364594289)*x[0]**o+(0.88715735186)*x[0]+(-0.894189269194)*x[1]**o+(0.470967389174)*x[1]+(0.427781385837)*x[2]**o+(0.141054076833)*x[2]
        s[2,4,2,1]=(-0.0329322907424)*x[0]**o+(0.0437971796726)*x[0]+(-0.706648559646)*x[1]**o+(0.132643884341)*x[1]+(0.101209934477)*x[2]**o+(-0.556234167371)*x[2]
        s[3,0,0,0]=(0.25287903621)*x[0]**o+(-0.281221279197)*x[0]+(0.643850500988)*x[1]**o+(0.0269082516545)*x[1]+(0.157104400545)*x[2]**o+(-0.554382511827)*x[2]
        s[3,0,0,1]=(0.130965460225)*x[0]**o+(0.203133851634)*x[0]+(-0.876140347686)*x[1]**o+(0.871803270423)*x[1]+(-0.372911987943)*x[2]**o+(-0.296478871771)*x[2]
        s[3,0,1,0]=(0.395462973708)*x[0]**o+(-0.0463119371121)*x[0]+(-0.810272498493)*x[1]**o+(0.052842476247)*x[1]+(-0.632091659537)*x[2]**o+(0.0477272308506)*x[2]
        s[3,0,1,1]=(-0.15375761581)*x[0]**o+(0.840485309457)*x[0]+(-0.183510151479)*x[1]**o+(0.423252205076)*x[1]+(0.0972125869507)*x[2]**o+(-0.873325211398)*x[2]
        s[3,0,2,0]=(-0.230628763369)*x[0]**o+(-0.446642785223)*x[0]+(0.172403317403)*x[1]**o+(0.6666203719)*x[1]+(0.758132421761)*x[2]**o+(-0.0802337093298)*x[2]
        s[3,0,2,1]=(-0.375928720447)*x[0]**o+(0.390180617554)*x[0]+(0.532916128738)*x[1]**o+(-0.438049708768)*x[1]+(-0.969242415622)*x[2]**o+(-0.979491904432)*x[2]
        s[3,1,0,0]=(0.243017072038)*x[0]**o+(-0.314649526706)*x[0]+(-0.64964134438)*x[1]**o+(-0.319482380304)*x[1]+(0.969793978414)*x[2]**o+(0.235845670735)*x[2]
        s[3,1,0,1]=(0.5372323492)*x[0]**o+(-0.297603522377)*x[0]+(0.718422772931)*x[1]**o+(0.591124970588)*x[1]+(0.148470013869)*x[2]**o+(-0.906959786864)*x[2]
        s[3,1,1,0]=(-0.41004677863)*x[0]**o+(0.519928695266)*x[0]+(-0.41056500013)*x[1]**o+(0.545730013165)*x[1]+(0.0316754455631)*x[2]**o+(0.0735333716599)*x[2]
        s[3,1,1,1]=(-0.413084334125)*x[0]**o+(-0.188907203544)*x[0]+(0.333210666705)*x[1]**o+(0.795876759492)*x[1]+(-0.879028457556)*x[2]**o+(0.597499547791)*x[2]
        s[3,1,2,0]=(0.572164028218)*x[0]**o+(0.561153490096)*x[0]+(-0.277218859151)*x[1]**o+(-0.784951308131)*x[1]+(-0.54076329511)*x[2]**o+(0.232589967523)*x[2]
        s[3,1,2,1]=(0.183000187474)*x[0]**o+(-0.0315492936828)*x[0]+(0.145425750124)*x[1]**o+(0.570531080762)*x[1]+(0.321679325968)*x[2]**o+(0.768693312757)*x[2]
        s[3,2,0,0]=(0.0572073598209)*x[0]**o+(-0.473877874718)*x[0]+(0.19030371495)*x[1]**o+(0.950458284849)*x[1]+(0.520875156632)*x[2]**o+(0.746025413415)*x[2]
        s[3,2,0,1]=(-0.670180903965)*x[0]**o+(0.792714072874)*x[0]+(-0.830626382455)*x[1]**o+(-0.694487379592)*x[1]+(0.708769579296)*x[2]**o+(0.874781581547)*x[2]
        s[3,2,1,0]=(-0.635101696551)*x[0]**o+(0.683413284169)*x[0]+(-0.580556747733)*x[1]**o+(0.228587157705)*x[1]+(0.283498698937)*x[2]**o+(-0.661341563969)*x[2]
        s[3,2,1,1]=(-0.938857602123)*x[0]**o+(-0.855150853757)*x[0]+(0.313962358596)*x[1]**o+(-0.137683481729)*x[1]+(-0.543347522619)*x[2]**o+(0.520234742546)*x[2]
        s[3,2,2,0]=(0.00237595749469)*x[0]**o+(0.151777614372)*x[0]+(-0.207526210221)*x[1]**o+(-0.593427746692)*x[1]+(-0.273081745725)*x[2]**o+(-0.103365939558)*x[2]
        s[3,2,2,1]=(-0.836487016235)*x[0]**o+(-0.499416194189)*x[0]+(0.944785244284)*x[1]**o+(0.316171200523)*x[1]+(0.882197908567)*x[2]**o+(-0.756125841104)*x[2]
        s[3,3,0,0]=(-0.331819442381)*x[0]**o+(0.0868286143286)*x[0]+(-0.0214955303831)*x[1]**o+(-0.802588129882)*x[1]+(-0.79665760605)*x[2]**o+(0.733766062704)*x[2]
        s[3,3,0,1]=(0.0832038861206)*x[0]**o+(-0.229342320163)*x[0]+(0.411514025627)*x[1]**o+(-0.278316368324)*x[1]+(0.158512271865)*x[2]**o+(-0.176346585884)*x[2]
        s[3,3,1,0]=(0.813577309153)*x[0]**o+(0.183181445534)*x[0]+(-0.625433189537)*x[1]**o+(-0.296559044989)*x[1]+(0.735593889495)*x[2]**o+(-0.84760854319)*x[2]
        s[3,3,1,1]=(0.129952300256)*x[0]**o+(-0.900793812246)*x[0]+(0.723956240897)*x[1]**o+(0.906884554981)*x[1]+(-0.828597157505)*x[2]**o+(-0.0453629922512)*x[2]
        s[3,3,2,0]=(0.618506925918)*x[0]**o+(0.537560191905)*x[0]+(0.274041602538)*x[1]**o+(0.128748880801)*x[1]+(-0.0421945967926)*x[2]**o+(-0.402512195673)*x[2]
        s[3,3,2,1]=(-0.882194818723)*x[0]**o+(-0.554059181227)*x[0]+(-0.519424591535)*x[1]**o+(0.0254864032182)*x[1]+(-0.163939472982)*x[2]**o+(-0.0494335206145)*x[2]
        s[3,4,0,0]=(-0.583301433479)*x[0]**o+(0.155758796662)*x[0]+(-0.814066320026)*x[1]**o+(0.152299298845)*x[1]+(0.988818040849)*x[2]**o+(-0.538805205144)*x[2]
        s[3,4,0,1]=(0.83112196296)*x[0]**o+(-0.719967217592)*x[0]+(-0.283369672135)*x[1]**o+(-0.995074593345)*x[1]+(0.129890006169)*x[2]**o+(-0.565650038645)*x[2]
        s[3,4,1,0]=(0.290242298945)*x[0]**o+(0.106236639888)*x[0]+(0.881353634263)*x[1]**o+(0.578003018941)*x[1]+(0.337748119883)*x[2]**o+(0.0495137765079)*x[2]
        s[3,4,1,1]=(-0.392371956935)*x[0]**o+(-0.403685094924)*x[0]+(0.953131101032)*x[1]**o+(0.144162998481)*x[1]+(0.13946212185)*x[2]**o+(-0.951124223008)*x[2]
        s[3,4,2,0]=(0.997965631913)*x[0]**o+(-0.494892241571)*x[0]+(0.887313590406)*x[1]**o+(-0.947323203129)*x[1]+(0.150412298394)*x[2]**o+(-0.0541618066578)*x[2]
        s[3,4,2,1]=(-0.177392402935)*x[0]**o+(0.338956222402)*x[0]+(0.746432610869)*x[1]**o+(-0.4930192355)*x[1]+(-0.210191759258)*x[2]**o+(0.501879127576)*x[2]
        ref[0,0,0,0]=(-0.0155247832423)*(1+2.*(dim-1.)/(o+1.))+(-0.430291051587)*dim
        ref[0,0,0,1]=(0.106727527157)*(1+2.*(dim-1.)/(o+1.))+(-0.651341788175)*dim
        ref[0,0,1,0]=(-0.859508213698)*(1+2.*(dim-1.)/(o+1.))+(1.73876967515)*dim
        ref[0,0,1,1]=(0.361322484688)*(1+2.*(dim-1.)/(o+1.))+(0.43166904701)*dim
        ref[0,0,2,0]=(-1.45264359807)*(1+2.*(dim-1.)/(o+1.))+(0.501916314636)*dim
        ref[0,0,2,1]=(-0.668900247351)*(1+2.*(dim-1.)/(o+1.))+(-1.65623984537)*dim
        ref[0,1,0,0]=(-0.443343570079)*(1+2.*(dim-1.)/(o+1.))+(0.871168888686)*dim
        ref[0,1,0,1]=(0.118415498213)*(1+2.*(dim-1.)/(o+1.))+(0.74798799462)*dim
        ref[0,1,1,0]=(0.920954236468)*(1+2.*(dim-1.)/(o+1.))+(-1.17034075437)*dim
        ref[0,1,1,1]=(0.54354015742)*(1+2.*(dim-1.)/(o+1.))+(0.0278374436795)*dim
        ref[0,1,2,0]=(-0.170343899948)*(1+2.*(dim-1.)/(o+1.))+(-0.871171846531)*dim
        ref[0,1,2,1]=(0.505172256825)*(1+2.*(dim-1.)/(o+1.))+(0.470437054524)*dim
        ref[0,2,0,0]=(1.08615296794)*(1+2.*(dim-1.)/(o+1.))+(1.06343890503)*dim
        ref[0,2,0,1]=(0.734996986295)*(1+2.*(dim-1.)/(o+1.))+(0.570979059821)*dim
        ref[0,2,1,0]=(-0.1518829769)*(1+2.*(dim-1.)/(o+1.))+(0.62649842867)*dim
        ref[0,2,1,1]=(1.08910114223)*(1+2.*(dim-1.)/(o+1.))+(-0.684346728672)*dim
        ref[0,2,2,0]=(0.0508734531183)*(1+2.*(dim-1.)/(o+1.))+(-0.933688106304)*dim
        ref[0,2,2,1]=(-0.228940443279)*(1+2.*(dim-1.)/(o+1.))+(-1.49944102508)*dim
        ref[0,3,0,0]=(0.64391320994)*(1+2.*(dim-1.)/(o+1.))+(0.674107408326)*dim
        ref[0,3,0,1]=(0.913115225162)*(1+2.*(dim-1.)/(o+1.))+(0.278946015231)*dim
        ref[0,3,1,0]=(-1.40820486136)*(1+2.*(dim-1.)/(o+1.))+(-0.0639222838911)*dim
        ref[0,3,1,1]=(0.417949210295)*(1+2.*(dim-1.)/(o+1.))+(-0.216455781248)*dim
        ref[0,3,2,0]=(1.50508891676)*(1+2.*(dim-1.)/(o+1.))+(-1.14330659887)*dim
        ref[0,3,2,1]=(0.210534574687)*(1+2.*(dim-1.)/(o+1.))+(-2.73880222559)*dim
        ref[0,4,0,0]=(-0.25601010593)*(1+2.*(dim-1.)/(o+1.))+(0.351583383554)*dim
        ref[0,4,0,1]=(0.245707023671)*(1+2.*(dim-1.)/(o+1.))+(-0.838661819338)*dim
        ref[0,4,1,0]=(-0.323575664024)*(1+2.*(dim-1.)/(o+1.))+(0.696332954903)*dim
        ref[0,4,1,1]=(0.917573574254)*(1+2.*(dim-1.)/(o+1.))+(-0.415089944263)*dim
        ref[0,4,2,0]=(-0.269972900999)*(1+2.*(dim-1.)/(o+1.))+(0.188919275167)*dim
        ref[0,4,2,1]=(0.702270558486)*(1+2.*(dim-1.)/(o+1.))+(0.330137393094)*dim
        ref[1,0,0,0]=(-0.869406884331)*(1+2.*(dim-1.)/(o+1.))+(2.05181576606)*dim
        ref[1,0,0,1]=(-0.336592568333)*(1+2.*(dim-1.)/(o+1.))+(-1.18221116668)*dim
        ref[1,0,1,0]=(0.119696422835)*(1+2.*(dim-1.)/(o+1.))+(-0.599288997881)*dim
        ref[1,0,1,1]=(1.71238132571)*(1+2.*(dim-1.)/(o+1.))+(-0.7893226229)*dim
        ref[1,0,2,0]=(0.301341811148)*(1+2.*(dim-1.)/(o+1.))+(-0.0125740667408)*dim
        ref[1,0,2,1]=(1.9246495335)*(1+2.*(dim-1.)/(o+1.))+(1.08856204899)*dim
        ref[1,1,0,0]=(1.40118798134)*(1+2.*(dim-1.)/(o+1.))+(0.0356919110082)*dim
        ref[1,1,0,1]=(0.270938821125)*(1+2.*(dim-1.)/(o+1.))+(1.42092614839)*dim
        ref[1,1,1,0]=(0.353375130983)*(1+2.*(dim-1.)/(o+1.))+(0.187158730917)*dim
        ref[1,1,1,1]=(0.333323765378)*(1+2.*(dim-1.)/(o+1.))+(-0.28376450019)*dim
        ref[1,1,2,0]=(-0.248745338987)*(1+2.*(dim-1.)/(o+1.))+(0.643976386833)*dim
        ref[1,1,2,1]=(0.112193420576)*(1+2.*(dim-1.)/(o+1.))+(0.931183771431)*dim
        ref[1,2,0,0]=(0.397534448472)*(1+2.*(dim-1.)/(o+1.))+(0.593499731827)*dim
        ref[1,2,0,1]=(0.199179244034)*(1+2.*(dim-1.)/(o+1.))+(-0.43545049124)*dim
        ref[1,2,1,0]=(1.18684774341)*(1+2.*(dim-1.)/(o+1.))+(-1.70814809742)*dim
        ref[1,2,1,1]=(0.534069235122)*(1+2.*(dim-1.)/(o+1.))+(-1.88969610849)*dim
        ref[1,2,2,0]=(0.912252247246)*(1+2.*(dim-1.)/(o+1.))+(-0.470932635203)*dim
        ref[1,2,2,1]=(-0.32508464376)*(1+2.*(dim-1.)/(o+1.))+(0.0983389069861)*dim
        ref[1,3,0,0]=(-0.171633539573)*(1+2.*(dim-1.)/(o+1.))+(0.348598914967)*dim
        ref[1,3,0,1]=(-0.957440569258)*(1+2.*(dim-1.)/(o+1.))+(-0.864938333196)*dim
        ref[1,3,1,0]=(0.589562599742)*(1+2.*(dim-1.)/(o+1.))+(0.793057481326)*dim
        ref[1,3,1,1]=(-0.0482452897207)*(1+2.*(dim-1.)/(o+1.))+(0.508869499554)*dim
        ref[1,3,2,0]=(-0.0784270268847)*(1+2.*(dim-1.)/(o+1.))+(1.25932568262)*dim
        ref[1,3,2,1]=(0.0167051424243)*(1+2.*(dim-1.)/(o+1.))+(-0.065290003598)*dim
        ref[1,4,0,0]=(1.91601318124)*(1+2.*(dim-1.)/(o+1.))+(1.98036186445)*dim
        ref[1,4,0,1]=(0.713480574424)*(1+2.*(dim-1.)/(o+1.))+(-0.707403424152)*dim
        ref[1,4,1,0]=(-0.857512054213)*(1+2.*(dim-1.)/(o+1.))+(-2.31655215244)*dim
        ref[1,4,1,1]=(-1.99759443728)*(1+2.*(dim-1.)/(o+1.))+(-1.40000792329)*dim
        ref[1,4,2,0]=(1.41438153297)*(1+2.*(dim-1.)/(o+1.))+(-0.345347994805)*dim
        ref[1,4,2,1]=(0.530414504493)*(1+2.*(dim-1.)/(o+1.))+(-0.826236442424)*dim
        ref[2,0,0,0]=(-0.256926617626)*(1+2.*(dim-1.)/(o+1.))+(0.322647489466)*dim
        ref[2,0,0,1]=(-0.64244416796)*(1+2.*(dim-1.)/(o+1.))+(0.176808507901)*dim
        ref[2,0,1,0]=(0.997098314441)*(1+2.*(dim-1.)/(o+1.))+(-1.24222192012)*dim
        ref[2,0,1,1]=(-0.0509223069533)*(1+2.*(dim-1.)/(o+1.))+(0.481061725309)*dim
        ref[2,0,2,0]=(0.561704567066)*(1+2.*(dim-1.)/(o+1.))+(1.30764517127)*dim
        ref[2,0,2,1]=(-1.88199995254)*(1+2.*(dim-1.)/(o+1.))+(-0.0226276389294)*dim
        ref[2,1,0,0]=(0.287070498014)*(1+2.*(dim-1.)/(o+1.))+(0.947932436577)*dim
        ref[2,1,0,1]=(-0.157324065109)*(1+2.*(dim-1.)/(o+1.))+(-0.56558633484)*dim
        ref[2,1,1,0]=(2.41484335441)*(1+2.*(dim-1.)/(o+1.))+(1.62154300036)*dim
        ref[2,1,1,1]=(0.515090798015)*(1+2.*(dim-1.)/(o+1.))+(-0.106267639566)*dim
        ref[2,1,2,0]=(0.339977301998)*(1+2.*(dim-1.)/(o+1.))+(0.650055768373)*dim
        ref[2,1,2,1]=(0.00732834638585)*(1+2.*(dim-1.)/(o+1.))+(-0.107666349465)*dim
        ref[2,2,0,0]=(-0.189246218757)*(1+2.*(dim-1.)/(o+1.))+(0.454522751637)*dim
        ref[2,2,0,1]=(-0.543402392433)*(1+2.*(dim-1.)/(o+1.))+(0.502458137788)*dim
        ref[2,2,1,0]=(-1.23702751248)*(1+2.*(dim-1.)/(o+1.))+(0.76331128837)*dim
        ref[2,2,1,1]=(0.429799353598)*(1+2.*(dim-1.)/(o+1.))+(0.611761995459)*dim
        ref[2,2,2,0]=(0.24797246329)*(1+2.*(dim-1.)/(o+1.))+(1.06577726308)*dim
        ref[2,2,2,1]=(-0.131413059009)*(1+2.*(dim-1.)/(o+1.))+(-1.61304020977)*dim
        ref[2,3,0,0]=(1.00700472927)*(1+2.*(dim-1.)/(o+1.))+(-0.796179800777)*dim
        ref[2,3,0,1]=(-1.01976922156)*(1+2.*(dim-1.)/(o+1.))+(0.240681506689)*dim
        ref[2,3,1,0]=(0.692581080055)*(1+2.*(dim-1.)/(o+1.))+(0.312340411844)*dim
        ref[2,3,1,1]=(0.636830781395)*(1+2.*(dim-1.)/(o+1.))+(-1.44693056666)*dim
        ref[2,3,2,0]=(-0.0127223987779)*(1+2.*(dim-1.)/(o+1.))+(0.666007093324)*dim
        ref[2,3,2,1]=(-0.584073475747)*(1+2.*(dim-1.)/(o+1.))+(0.481993256882)*dim
        ref[2,4,0,0]=(-0.646793665194)*(1+2.*(dim-1.)/(o+1.))+(1.9384432463)*dim
        ref[2,4,0,1]=(-0.0885586272376)*(1+2.*(dim-1.)/(o+1.))+(0.400934724632)*dim
        ref[2,4,1,0]=(-0.328509394762)*(1+2.*(dim-1.)/(o+1.))+(0.507594228357)*dim
        ref[2,4,1,1]=(-0.342847923103)*(1+2.*(dim-1.)/(o+1.))+(-0.513314735952)*dim
        ref[2,4,2,0]=(-1.07277247765)*(1+2.*(dim-1.)/(o+1.))+(1.49917881787)*dim
        ref[2,4,2,1]=(-0.638370915912)*(1+2.*(dim-1.)/(o+1.))+(-0.379793103357)*dim
        ref[3,0,0,0]=(1.05383393774)*(1+2.*(dim-1.)/(o+1.))+(-0.80869553937)*dim
        ref[3,0,0,1]=(-1.1180868754)*(1+2.*(dim-1.)/(o+1.))+(0.778458250286)*dim
        ref[3,0,1,0]=(-1.04690118432)*(1+2.*(dim-1.)/(o+1.))+(0.0542577699855)*dim
        ref[3,0,1,1]=(-0.240055180339)*(1+2.*(dim-1.)/(o+1.))+(0.390412303135)*dim
        ref[3,0,2,0]=(0.699906975796)*(1+2.*(dim-1.)/(o+1.))+(0.139743877347)*dim
        ref[3,0,2,1]=(-0.812255007331)*(1+2.*(dim-1.)/(o+1.))+(-1.02736099565)*dim
        ref[3,1,0,0]=(0.563169706071)*(1+2.*(dim-1.)/(o+1.))+(-0.398286236275)*dim
        ref[3,1,0,1]=(1.404125136)*(1+2.*(dim-1.)/(o+1.))+(-0.613438338653)*dim
        ref[3,1,1,0]=(-0.788936333197)*(1+2.*(dim-1.)/(o+1.))+(1.13919208009)*dim
        ref[3,1,1,1]=(-0.958902124976)*(1+2.*(dim-1.)/(o+1.))+(1.20446910374)*dim
        ref[3,1,2,0]=(-0.245818126043)*(1+2.*(dim-1.)/(o+1.))+(0.00879214948826)*dim
        ref[3,1,2,1]=(0.650105263567)*(1+2.*(dim-1.)/(o+1.))+(1.30767509984)*dim
        ref[3,2,0,0]=(0.768386231403)*(1+2.*(dim-1.)/(o+1.))+(1.22260582355)*dim
        ref[3,2,0,1]=(-0.792037707123)*(1+2.*(dim-1.)/(o+1.))+(0.973008274829)*dim
        ref[3,2,1,0]=(-0.932159745347)*(1+2.*(dim-1.)/(o+1.))+(0.250658877904)*dim
        ref[3,2,1,1]=(-1.16824276615)*(1+2.*(dim-1.)/(o+1.))+(-0.47259959294)*dim
        ref[3,2,2,0]=(-0.478231998451)*(1+2.*(dim-1.)/(o+1.))+(-0.545016071879)*dim
        ref[3,2,2,1]=(0.990496136616)*(1+2.*(dim-1.)/(o+1.))+(-0.939370834771)*dim
        ref[3,3,0,0]=(-1.14997257881)*(1+2.*(dim-1.)/(o+1.))+(0.0180065471512)*dim
        ref[3,3,0,1]=(0.653230183613)*(1+2.*(dim-1.)/(o+1.))+(-0.684005274372)*dim
        ref[3,3,1,0]=(0.923738009112)*(1+2.*(dim-1.)/(o+1.))+(-0.960986142644)*dim
        ref[3,3,1,1]=(0.0253113836472)*(1+2.*(dim-1.)/(o+1.))+(-0.0392722495157)*dim
        ref[3,3,2,0]=(0.850353931663)*(1+2.*(dim-1.)/(o+1.))+(0.263796877033)*dim
        ref[3,3,2,1]=(-1.56555888324)*(1+2.*(dim-1.)/(o+1.))+(-0.578006298623)*dim
        ref[3,4,0,0]=(-0.408549712656)*(1+2.*(dim-1.)/(o+1.))+(-0.230747109637)*dim
        ref[3,4,0,1]=(0.677642296994)*(1+2.*(dim-1.)/(o+1.))+(-2.28069184958)*dim
        ref[3,4,1,0]=(1.50934405309)*(1+2.*(dim-1.)/(o+1.))+(0.733753435337)*dim
        ref[3,4,1,1]=(0.700221265947)*(1+2.*(dim-1.)/(o+1.))+(-1.21064631945)*dim
        ref[3,4,2,0]=(2.03569152071)*(1+2.*(dim-1.)/(o+1.))+(-1.49637725136)*dim
        ref[3,4,2,1]=(0.358848448676)*(1+2.*(dim-1.)/(o+1.))+(0.347816114478)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-1.08871335955)*x[0]+(0.247972631031)*x[1]
        ref=(-0.156403544195)*(1+2.*(dim-1.)/(o+1.))+(-0.684337184327)*dim
      else:
        s=(-0.324052151044)*x[0]+(0.441305482424)*x[1]+(-0.315030176112)*x[2]
        ref=(0.603955649036)*(1+2.*(dim-1.)/(o+1.))+(-0.801732493769)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.260677248137)*x[0]+(0.0211318398374)*x[1]
        s[1]=(-0.815879139039)*x[0]+(-0.918304389572)*x[1]
        ref[0]=(0.843100081089)*(1+2.*(dim-1.)/(o+1.))+(-1.08264548939)*dim
        ref[1]=(-1.3080191481)*(1+2.*(dim-1.)/(o+1.))+(-0.426164380506)*dim
      else:
        s[0]=(1.37908771986)*x[0]+(1.36518233103)*x[1]+(1.013246401)*x[2]
        s[1]=(0.556318683467)*x[0]+(1.45737568352)*x[1]+(0.0165078724907)*x[2]
        ref[0]=(2.05950634594)*(1+2.*(dim-1.)/(o+1.))+(1.69801010595)*dim
        ref[1]=(0.655472308826)*(1+2.*(dim-1.)/(o+1.))+(1.37472993065)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(1.44204352077)*x[0]+(-0.626836867163)*x[1]
        s[0,1]=(-0.295593397487)*x[0]+(-0.309954518607)*x[1]
        s[0,2]=(-0.546882380107)*x[0]+(-0.0925530562931)*x[1]
        s[0,3]=(-0.623335335636)*x[0]+(0.798887138514)*x[1]
        s[0,4]=(0.202234634868)*x[0]+(1.44014401659)*x[1]
        s[1,0]=(-0.772178934874)*x[0]+(-0.962339450381)*x[1]
        s[1,1]=(-0.136928685359)*x[0]+(0.385217139725)*x[1]
        s[1,2]=(-0.00807747505852)*x[0]+(1.08230267787)*x[1]
        s[1,3]=(-1.28422033803)*x[0]+(0.011228260616)*x[1]
        s[1,4]=(0.766746911823)*x[0]+(-0.145254490276)*x[1]
        s[2,0]=(1.65171936301)*x[0]+(1.68030971997)*x[1]
        s[2,1]=(-0.465968023499)*x[0]+(-0.594634053719)*x[1]
        s[2,2]=(-0.140916975546)*x[0]+(0.230405132955)*x[1]
        s[2,3]=(-0.0185338227586)*x[0]+(0.298041051546)*x[1]
        s[2,4]=(-0.024340230778)*x[0]+(-0.791873643457)*x[1]
        s[3,0]=(0.555336313403)*x[0]+(0.606898490822)*x[1]
        s[3,1]=(1.05785941408)*x[0]+(-0.672561947115)*x[1]
        s[3,2]=(1.36138187068)*x[0]+(0.259592704164)*x[1]
        s[3,3]=(0.66211210256)*x[0]+(-1.38753456619)*x[1]
        s[3,4]=(0.0789301309156)*x[0]+(1.24015676345)*x[1]
        ref[0,0]=(0.863657572901)*(1+2.*(dim-1.)/(o+1.))+(-0.0484509192919)*dim
        ref[0,1]=(-0.0608826851336)*(1+2.*(dim-1.)/(o+1.))+(-0.54466523096)*dim
        ref[0,2]=(-1.25630630361)*(1+2.*(dim-1.)/(o+1.))+(0.616870867215)*dim
        ref[0,3]=(-0.618026054387)*(1+2.*(dim-1.)/(o+1.))+(0.793577857265)*dim
        ref[0,4]=(1.55309725329)*(1+2.*(dim-1.)/(o+1.))+(0.0892813981594)*dim
        ref[1,0]=(-0.707427946889)*(1+2.*(dim-1.)/(o+1.))+(-1.02709043837)*dim
        ref[1,1]=(1.0516700664)*(1+2.*(dim-1.)/(o+1.))+(-0.803381612038)*dim
        ref[1,2]=(-0.251691185365)*(1+2.*(dim-1.)/(o+1.))+(1.32591638818)*dim
        ref[1,3]=(0.227444315739)*(1+2.*(dim-1.)/(o+1.))+(-1.50043639316)*dim
        ref[1,4]=(0.636926531504)*(1+2.*(dim-1.)/(o+1.))+(-0.0154341099568)*dim
        ref[2,0]=(1.58333782129)*(1+2.*(dim-1.)/(o+1.))+(1.7486912617)*dim
        ref[2,1]=(0.376537776448)*(1+2.*(dim-1.)/(o+1.))+(-1.43713985367)*dim
        ref[2,2]=(1.33315471883)*(1+2.*(dim-1.)/(o+1.))+(-1.24366656142)*dim
        ref[2,3]=(-0.893476349046)*(1+2.*(dim-1.)/(o+1.))+(1.17298357783)*dim
        ref[2,4]=(-0.556720283569)*(1+2.*(dim-1.)/(o+1.))+(-0.259493590666)*dim
        ref[3,0]=(-0.0344322176845)*(1+2.*(dim-1.)/(o+1.))+(1.19666702191)*dim
        ref[3,1]=(0.356058306775)*(1+2.*(dim-1.)/(o+1.))+(0.0292391601866)*dim
        ref[3,2]=(1.18926653697)*(1+2.*(dim-1.)/(o+1.))+(0.431708037874)*dim
        ref[3,3]=(-0.0855874137907)*(1+2.*(dim-1.)/(o+1.))+(-0.639835049842)*dim
        ref[3,4]=(0.485696084789)*(1+2.*(dim-1.)/(o+1.))+(0.833390809579)*dim
      else:
        s[0,0]=(1.48740802799)*x[0]+(-0.5231718635)*x[1]+(0.621553689326)*x[2]
        s[0,1]=(-0.816432702835)*x[0]+(-1.02472113234)*x[1]+(-0.498250552797)*x[2]
        s[0,2]=(-0.0547881618906)*x[0]+(0.903306651062)*x[1]+(0.471428097681)*x[2]
        s[0,3]=(-0.910642152807)*x[0]+(-0.958224215021)*x[1]+(-1.4403271378)*x[2]
        s[0,4]=(0.116198234381)*x[0]+(-0.636378388418)*x[1]+(0.1270635999)*x[2]
        s[1,0]=(-0.659576291097)*x[0]+(-0.446587669482)*x[1]+(1.38617928144)*x[2]
        s[1,1]=(0.442922554555)*x[0]+(0.2841566742)*x[1]+(-0.384854418521)*x[2]
        s[1,2]=(-0.883255151971)*x[0]+(-1.3015449692)*x[1]+(-1.49785758846)*x[2]
        s[1,3]=(-1.43150392129)*x[0]+(1.13296295364)*x[1]+(0.393410729481)*x[2]
        s[1,4]=(-0.423254486419)*x[0]+(1.58675432746)*x[1]+(1.46179069555)*x[2]
        s[2,0]=(0.467182623429)*x[0]+(-1.23530058455)*x[1]+(0.546258172921)*x[2]
        s[2,1]=(-1.2468563949)*x[0]+(1.05285375014)*x[1]+(1.00605876886)*x[2]
        s[2,2]=(-0.1261124635)*x[0]+(-0.855000687125)*x[1]+(-0.252904511506)*x[2]
        s[2,3]=(1.1950830615)*x[0]+(0.699000137772)*x[1]+(1.33793802349)*x[2]
        s[2,4]=(-1.26581081559)*x[0]+(-0.0366783527385)*x[1]+(-0.736592212733)*x[2]
        s[3,0]=(1.84878865394)*x[0]+(0.504454193662)*x[1]+(-1.15690555199)*x[2]
        s[3,1]=(-0.249497283612)*x[0]+(-0.635940805715)*x[1]+(0.168382197376)*x[2]
        s[3,2]=(-0.167328351962)*x[0]+(0.523012476804)*x[1]+(1.19870547556)*x[2]
        s[3,3]=(-0.499150198998)*x[0]+(0.448461159266)*x[1]+(0.554069089559)*x[2]
        s[3,4]=(-0.520146860421)*x[0]+(1.43515582204)*x[1]+(1.31685474485)*x[2]
        ref[0,0]=(1.56352587364)*(1+2.*(dim-1.)/(o+1.))+(0.0222639801801)*dim
        ref[0,1]=(-1.88354672396)*(1+2.*(dim-1.)/(o+1.))+(-0.455857664013)*dim
        ref[0,2]=(0.631897841337)*(1+2.*(dim-1.)/(o+1.))+(0.688048745515)*dim
        ref[0,3]=(-2.49358987828)*(1+2.*(dim-1.)/(o+1.))+(-0.815603627346)*dim
        ref[0,4]=(-1.43782849721)*(1+2.*(dim-1.)/(o+1.))+(1.04471194307)*dim
        ref[1,0]=(-0.257186244728)*(1+2.*(dim-1.)/(o+1.))+(0.537201565586)*dim
        ref[1,1]=(-1.21753131847)*(1+2.*(dim-1.)/(o+1.))+(1.55975612871)*dim
        ref[1,2]=(-1.83391505519)*(1+2.*(dim-1.)/(o+1.))+(-1.84874265444)*dim
        ref[1,3]=(0.790398824851)*(1+2.*(dim-1.)/(o+1.))+(-0.69552906302)*dim
        ref[1,4]=(1.96838334672)*(1+2.*(dim-1.)/(o+1.))+(0.656907189867)*dim
        ref[2,0]=(-0.486341534759)*(1+2.*(dim-1.)/(o+1.))+(0.264481746559)*dim
        ref[2,1]=(-0.417272431595)*(1+2.*(dim-1.)/(o+1.))+(1.22932855569)*dim
        ref[2,2]=(-0.881184195775)*(1+2.*(dim-1.)/(o+1.))+(-0.352833466355)*dim
        ref[2,3]=(1.01420597285)*(1+2.*(dim-1.)/(o+1.))+(2.21781524991)*dim
        ref[2,4]=(-0.580092347401)*(1+2.*(dim-1.)/(o+1.))+(-1.45898903366)*dim
        ref[3,0]=(0.865857995406)*(1+2.*(dim-1.)/(o+1.))+(0.330479300213)*dim
        ref[3,1]=(0.632704550785)*(1+2.*(dim-1.)/(o+1.))+(-1.34976044274)*dim
        ref[3,2]=(-0.259081469822)*(1+2.*(dim-1.)/(o+1.))+(1.81347107022)*dim
        ref[3,3]=(0.533963525526)*(1+2.*(dim-1.)/(o+1.))+(-0.0305834756989)*dim
        ref[3,4]=(1.19847134659)*(1+2.*(dim-1.)/(o+1.))+(1.03339235988)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.536617774033)*x[0]+(-1.31191068914)*x[1]
        s[0,0,1]=(1.45706261992)*x[0]+(0.33760400949)*x[1]
        s[0,1,0]=(-0.453569968232)*x[0]+(0.798108537393)*x[1]
        s[0,1,1]=(-1.26956398588)*x[0]+(-1.35096551318)*x[1]
        s[1,0,0]=(0.104407588284)*x[0]+(-0.649935519811)*x[1]
        s[1,0,1]=(-1.64047091856)*x[0]+(0.654330987243)*x[1]
        s[1,1,0]=(-0.161010086142)*x[0]+(-0.644341383353)*x[1]
        s[1,1,1]=(1.42345151896)*x[0]+(-0.963960533124)*x[1]
        s[2,0,0]=(0.069463733935)*x[0]+(-0.764246138958)*x[1]
        s[2,0,1]=(0.516672615671)*x[0]+(0.32129769972)*x[1]
        s[2,1,0]=(0.399513997078)*x[0]+(-1.76803609001)*x[1]
        s[2,1,1]=(0.0570653989294)*x[0]+(-0.191869561254)*x[1]
        s[3,0,0]=(-0.261019396242)*x[0]+(0.429544509966)*x[1]
        s[3,0,1]=(-1.40560961029)*x[0]+(-0.739182555238)*x[1]
        s[3,1,0]=(0.314850928569)*x[0]+(1.49030138742)*x[1]
        s[3,1,1]=(-1.27327662424)*x[0]+(-0.0287977839083)*x[1]
        s[4,0,0]=(-0.840541224777)*x[0]+(-0.805224659169)*x[1]
        s[4,0,1]=(0.303904176581)*x[0]+(0.353767617246)*x[1]
        s[4,1,0]=(1.65813306507)*x[0]+(1.12299575058)*x[1]
        s[4,1,1]=(-1.19199290034)*x[0]+(1.6581285511)*x[1]
        s[5,0,0]=(0.120283505072)*x[0]+(1.68044908685)*x[1]
        s[5,0,1]=(0.382489278089)*x[0]+(0.129887092126)*x[1]
        s[5,1,0]=(-1.01890077156)*x[0]+(-0.111140290699)*x[1]
        s[5,1,1]=(-0.0392100253378)*x[0]+(0.579951319719)*x[1]
        ref[0,0,0]=(-0.686284158891)*(1+2.*(dim-1.)/(o+1.))+(-0.089008756216)*dim
        ref[0,0,1]=(1.76417819838)*(1+2.*(dim-1.)/(o+1.))+(0.030488431025)*dim
        ref[0,1,0]=(0.453381498643)*(1+2.*(dim-1.)/(o+1.))+(-0.108842929482)*dim
        ref[0,1,1]=(-1.03607416678)*(1+2.*(dim-1.)/(o+1.))+(-1.58445533227)*dim
        ref[1,0,0]=(0.638386446298)*(1+2.*(dim-1.)/(o+1.))+(-1.18391437783)*dim
        ref[1,0,1]=(0.275023590147)*(1+2.*(dim-1.)/(o+1.))+(-1.26116352146)*dim
        ref[1,1,0]=(-0.869379328882)*(1+2.*(dim-1.)/(o+1.))+(0.0640278593865)*dim
        ref[1,1,1]=(0.597799121533)*(1+2.*(dim-1.)/(o+1.))+(-0.138308135699)*dim
        ref[2,0,0]=(-1.45715684308)*(1+2.*(dim-1.)/(o+1.))+(0.762374438053)*dim
        ref[2,0,1]=(0.929718948925)*(1+2.*(dim-1.)/(o+1.))+(-0.0917486335329)*dim
        ref[2,1,0]=(-0.78092454297)*(1+2.*(dim-1.)/(o+1.))+(-0.587597549963)*dim
        ref[2,1,1]=(-1.21253063514)*(1+2.*(dim-1.)/(o+1.))+(1.07772647282)*dim
        ref[3,0,0]=(1.07007881303)*(1+2.*(dim-1.)/(o+1.))+(-0.901553699308)*dim
        ref[3,0,1]=(-1.77159657093)*(1+2.*(dim-1.)/(o+1.))+(-0.373195594594)*dim
        ref[3,1,0]=(1.10443227539)*(1+2.*(dim-1.)/(o+1.))+(0.700720040595)*dim
        ref[3,1,1]=(0.315983219905)*(1+2.*(dim-1.)/(o+1.))+(-1.61805762805)*dim
        ref[4,0,0]=(-0.602218266612)*(1+2.*(dim-1.)/(o+1.))+(-1.04354761733)*dim
        ref[4,0,1]=(0.297276459441)*(1+2.*(dim-1.)/(o+1.))+(0.360395334386)*dim
        ref[4,1,0]=(1.5584687424)*(1+2.*(dim-1.)/(o+1.))+(1.22266007325)*dim
        ref[4,1,1]=(0.504270780151)*(1+2.*(dim-1.)/(o+1.))+(-0.038135129389)*dim
        ref[5,0,0]=(1.35289487036)*(1+2.*(dim-1.)/(o+1.))+(0.44783772157)*dim
        ref[5,0,1]=(1.57660464714)*(1+2.*(dim-1.)/(o+1.))+(-1.06422827692)*dim
        ref[5,1,0]=(0.1360111664)*(1+2.*(dim-1.)/(o+1.))+(-1.26605222866)*dim
        ref[5,1,1]=(0.024986479373)*(1+2.*(dim-1.)/(o+1.))+(0.515754815008)*dim
      else:
        s[0,0,0]=(-0.491953157793)*x[0]+(0.808487399764)*x[1]+(0.87783526238)*x[2]
        s[0,0,1]=(-0.470158989175)*x[0]+(-0.492379274826)*x[1]+(-0.191290328078)*x[2]
        s[0,1,0]=(-0.356351922052)*x[0]+(0.823887078075)*x[1]+(-0.177422034195)*x[2]
        s[0,1,1]=(-0.378759483085)*x[0]+(0.116067213963)*x[1]+(0.0288265220551)*x[2]
        s[1,0,0]=(-0.325670782382)*x[0]+(-1.01289817775)*x[1]+(0.672608800327)*x[2]
        s[1,0,1]=(-0.296979811719)*x[0]+(0.46777334672)*x[1]+(1.61350930522)*x[2]
        s[1,1,0]=(-0.0574537817174)*x[0]+(1.10617918343)*x[1]+(0.172222519609)*x[2]
        s[1,1,1]=(-0.978413596402)*x[0]+(-1.20699880678)*x[1]+(-0.0600246637942)*x[2]
        s[2,0,0]=(0.637900823637)*x[0]+(1.29751687672)*x[1]+(-0.390955179963)*x[2]
        s[2,0,1]=(-1.15596339731)*x[0]+(-1.04131524409)*x[1]+(0.111161978383)*x[2]
        s[2,1,0]=(-1.33713877493)*x[0]+(0.0677540624633)*x[1]+(0.0662976219802)*x[2]
        s[2,1,1]=(0.0636656461261)*x[0]+(-1.32776475079)*x[1]+(0.365594993394)*x[2]
        s[3,0,0]=(0.454007484649)*x[0]+(-1.56273676656)*x[1]+(-0.783612553822)*x[2]
        s[3,0,1]=(-0.908388718727)*x[0]+(0.496552922533)*x[1]+(1.0802957835)*x[2]
        s[3,1,0]=(0.46784249418)*x[0]+(1.627686011)*x[1]+(1.12464788868)*x[2]
        s[3,1,1]=(1.47169416804)*x[0]+(-0.541043548439)*x[1]+(-0.0203908370923)*x[2]
        s[4,0,0]=(0.153593270409)*x[0]+(0.991271922294)*x[1]+(0.910688732568)*x[2]
        s[4,0,1]=(1.26666528018)*x[0]+(-0.0415946389155)*x[1]+(-0.702890723051)*x[2]
        s[4,1,0]=(0.401000008974)*x[0]+(0.270202736778)*x[1]+(-1.52334516556)*x[2]
        s[4,1,1]=(-0.567247526123)*x[0]+(0.0638484526058)*x[1]+(-0.942447437378)*x[2]
        s[5,0,0]=(1.3141482761)*x[0]+(0.602038495282)*x[1]+(-0.162794144191)*x[2]
        s[5,0,1]=(1.49343941166)*x[0]+(0.340106070028)*x[1]+(0.222963641278)*x[2]
        s[5,1,0]=(1.29779085951)*x[0]+(0.44436851782)*x[1]+(-0.414930735066)*x[2]
        s[5,1,1]=(0.445071462828)*x[0]+(0.0113100435192)*x[1]+(-0.304892738875)*x[2]
        ref[0,0,0]=(0.807154905774)*(1+2.*(dim-1.)/(o+1.))+(0.387214598576)*dim
        ref[0,0,1]=(-0.168668456531)*(1+2.*(dim-1.)/(o+1.))+(-0.985160135549)*dim
        ref[0,1,0]=(-0.405021627391)*(1+2.*(dim-1.)/(o+1.))+(0.69513474922)*dim
        ref[0,1,1]=(0.481047411067)*(1+2.*(dim-1.)/(o+1.))+(-0.714913158134)*dim
        ref[1,0,0]=(-0.241963228819)*(1+2.*(dim-1.)/(o+1.))+(-0.423996930987)*dim
        ref[1,0,1]=(-0.222173232945)*(1+2.*(dim-1.)/(o+1.))+(2.00647607317)*dim
        ref[1,1,0]=(2.08927091112)*(1+2.*(dim-1.)/(o+1.))+(-0.868322989801)*dim
        ref[1,1,1]=(-1.2199872069)*(1+2.*(dim-1.)/(o+1.))+(-1.02544986008)*dim
        ref[2,0,0]=(1.51358492234)*(1+2.*(dim-1.)/(o+1.))+(0.0308775980534)*dim
        ref[2,0,1]=(-1.17419262019)*(1+2.*(dim-1.)/(o+1.))+(-0.911924042825)*dim
        ref[2,1,0]=(-0.808827279389)*(1+2.*(dim-1.)/(o+1.))+(-0.394259811094)*dim
        ref[2,1,1]=(-0.39434462087)*(1+2.*(dim-1.)/(o+1.))+(-0.504159490404)*dim
        ref[3,0,0]=(-0.420509147061)*(1+2.*(dim-1.)/(o+1.))+(-1.47183268867)*dim
        ref[3,0,1]=(-0.509702954626)*(1+2.*(dim-1.)/(o+1.))+(1.17816294193)*dim
        ref[3,1,0]=(2.45580213911)*(1+2.*(dim-1.)/(o+1.))+(0.764374254754)*dim
        ref[3,1,1]=(0.36148972446)*(1+2.*(dim-1.)/(o+1.))+(0.548770058051)*dim
        ref[4,0,0]=(0.723463115757)*(1+2.*(dim-1.)/(o+1.))+(1.33209080951)*dim
        ref[4,0,1]=(-0.584660571656)*(1+2.*(dim-1.)/(o+1.))+(1.10684048987)*dim
        ref[4,1,0]=(0.558877069737)*(1+2.*(dim-1.)/(o+1.))+(-1.41101948955)*dim
        ref[4,1,1]=(-1.46224923696)*(1+2.*(dim-1.)/(o+1.))+(0.016402726067)*dim
        ref[5,0,0]=(0.375824940974)*(1+2.*(dim-1.)/(o+1.))+(1.37756768621)*dim
        ref[5,0,1]=(0.0790629051458)*(1+2.*(dim-1.)/(o+1.))+(1.97744621782)*dim
        ref[5,1,0]=(-0.429416156192)*(1+2.*(dim-1.)/(o+1.))+(1.75664479845)*dim
        ref[5,1,1]=(-0.227051313962)*(1+2.*(dim-1.)/(o+1.))+(0.378540081434)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-1.24466004429)*x[0]+(0.249656583863)*x[1]
        s[0,0,0,1]=(-1.31303014286)*x[0]+(-0.188187818679)*x[1]
        s[0,0,1,0]=(-1.19686759063)*x[0]+(0.202998667098)*x[1]
        s[0,0,1,1]=(-0.240139422625)*x[0]+(1.12145727417)*x[1]
        s[0,0,2,0]=(-0.779228056931)*x[0]+(-0.256394958159)*x[1]
        s[0,0,2,1]=(0.511346899235)*x[0]+(-1.17117401759)*x[1]
        s[0,1,0,0]=(1.20931773874)*x[0]+(0.703848713877)*x[1]
        s[0,1,0,1]=(1.05396707864)*x[0]+(0.561081392967)*x[1]
        s[0,1,1,0]=(-0.940092412899)*x[0]+(0.197879835766)*x[1]
        s[0,1,1,1]=(0.031033640344)*x[0]+(1.47668227837)*x[1]
        s[0,1,2,0]=(-0.973745458182)*x[0]+(-0.699999591381)*x[1]
        s[0,1,2,1]=(0.0637513252131)*x[0]+(0.223369875142)*x[1]
        s[0,2,0,0]=(-0.179817828717)*x[0]+(-1.0618817379)*x[1]
        s[0,2,0,1]=(-1.31848741633)*x[0]+(0.562871230704)*x[1]
        s[0,2,1,0]=(0.20660993199)*x[0]+(-0.260401741099)*x[1]
        s[0,2,1,1]=(-0.119752579601)*x[0]+(1.03659426931)*x[1]
        s[0,2,2,0]=(-1.05257053872)*x[0]+(-0.410999368732)*x[1]
        s[0,2,2,1]=(0.142472752971)*x[0]+(0.687099054848)*x[1]
        s[0,3,0,0]=(-0.735958436285)*x[0]+(0.576103117069)*x[1]
        s[0,3,0,1]=(0.820759477791)*x[0]+(1.40201775771)*x[1]
        s[0,3,1,0]=(-1.43663163172)*x[0]+(-0.928562287497)*x[1]
        s[0,3,1,1]=(-0.640592604343)*x[0]+(-1.37951764035)*x[1]
        s[0,3,2,0]=(0.923170161037)*x[0]+(-1.29865735065)*x[1]
        s[0,3,2,1]=(-1.49185366667)*x[0]+(1.26235954659)*x[1]
        s[0,4,0,0]=(-1.54260726706)*x[0]+(0.386401532954)*x[1]
        s[0,4,0,1]=(0.938275027884)*x[0]+(-0.325978711858)*x[1]
        s[0,4,1,0]=(-0.741422170549)*x[0]+(0.360529257608)*x[1]
        s[0,4,1,1]=(-1.38867328824)*x[0]+(0.368979718783)*x[1]
        s[0,4,2,0]=(-1.19633228454)*x[0]+(0.143128822342)*x[1]
        s[0,4,2,1]=(0.365590220489)*x[0]+(0.702852400998)*x[1]
        s[1,0,0,0]=(0.590708718523)*x[0]+(-1.74588023915)*x[1]
        s[1,0,0,1]=(-0.411269052638)*x[0]+(0.677504850422)*x[1]
        s[1,0,1,0]=(1.54641105105)*x[0]+(-0.227798671895)*x[1]
        s[1,0,1,1]=(0.206986074762)*x[0]+(0.431911634342)*x[1]
        s[1,0,2,0]=(0.180245950747)*x[0]+(-0.766496827464)*x[1]
        s[1,0,2,1]=(0.920490611623)*x[0]+(0.146274601957)*x[1]
        s[1,1,0,0]=(-1.47489897228)*x[0]+(-1.0428187509)*x[1]
        s[1,1,0,1]=(-1.17774302127)*x[0]+(0.44418244557)*x[1]
        s[1,1,1,0]=(-0.340268939926)*x[0]+(-0.362308449805)*x[1]
        s[1,1,1,1]=(1.1122568876)*x[0]+(0.807887213986)*x[1]
        s[1,1,2,0]=(-1.1580670758)*x[0]+(0.61015974696)*x[1]
        s[1,1,2,1]=(-0.21738296838)*x[0]+(-1.15287881926)*x[1]
        s[1,2,0,0]=(-1.63285965164)*x[0]+(0.546571504115)*x[1]
        s[1,2,0,1]=(1.34627844359)*x[0]+(0.0153020013782)*x[1]
        s[1,2,1,0]=(-0.459380401764)*x[0]+(0.653971151372)*x[1]
        s[1,2,1,1]=(0.0918961369392)*x[0]+(0.631274394662)*x[1]
        s[1,2,2,0]=(-0.461548096839)*x[0]+(0.432322561401)*x[1]
        s[1,2,2,1]=(-0.741897062249)*x[0]+(-0.0397725689655)*x[1]
        s[1,3,0,0]=(-0.166826966339)*x[0]+(0.76157630088)*x[1]
        s[1,3,0,1]=(-1.43001526663)*x[0]+(0.0200445726731)*x[1]
        s[1,3,1,0]=(0.776640170933)*x[0]+(1.77522529504)*x[1]
        s[1,3,1,1]=(0.132999332599)*x[0]+(0.91396296202)*x[1]
        s[1,3,2,0]=(-0.435447499973)*x[0]+(-0.714956349315)*x[1]
        s[1,3,2,1]=(1.54444404505)*x[0]+(0.0419015202674)*x[1]
        s[1,4,0,0]=(-1.14197604256)*x[0]+(0.140549307511)*x[1]
        s[1,4,0,1]=(1.11080451267)*x[0]+(0.140105909725)*x[1]
        s[1,4,1,0]=(0.361572095315)*x[0]+(1.73141141151)*x[1]
        s[1,4,1,1]=(1.2968959883)*x[0]+(0.459397526479)*x[1]
        s[1,4,2,0]=(-1.04477229488)*x[0]+(-0.432251933613)*x[1]
        s[1,4,2,1]=(0.166352074158)*x[0]+(0.240538931271)*x[1]
        s[2,0,0,0]=(-0.302792258664)*x[0]+(0.014159412453)*x[1]
        s[2,0,0,1]=(0.161287860507)*x[0]+(-1.66699057701)*x[1]
        s[2,0,1,0]=(0.793079282708)*x[0]+(0.999374748613)*x[1]
        s[2,0,1,1]=(-0.0860624573943)*x[0]+(0.438101549788)*x[1]
        s[2,0,2,0]=(-0.832685279306)*x[0]+(1.20735467656)*x[1]
        s[2,0,2,1]=(-0.0628631179915)*x[0]+(0.720123606355)*x[1]
        s[2,1,0,0]=(0.275852566161)*x[0]+(-0.259595395227)*x[1]
        s[2,1,0,1]=(0.862309966294)*x[0]+(-0.45114296596)*x[1]
        s[2,1,1,0]=(0.14823103051)*x[0]+(-1.16121025546)*x[1]
        s[2,1,1,1]=(-1.34419311122)*x[0]+(1.63903760286)*x[1]
        s[2,1,2,0]=(1.18830622559)*x[0]+(0.985255273279)*x[1]
        s[2,1,2,1]=(-0.0208912272649)*x[0]+(0.543921272375)*x[1]
        s[2,2,0,0]=(0.510821411306)*x[0]+(-1.88592356399)*x[1]
        s[2,2,0,1]=(0.353203575328)*x[0]+(0.328922615441)*x[1]
        s[2,2,1,0]=(1.1536669592)*x[0]+(-1.05621607534)*x[1]
        s[2,2,1,1]=(-0.581456156893)*x[0]+(-0.20275776476)*x[1]
        s[2,2,2,0]=(1.23883996503)*x[0]+(0.577857478009)*x[1]
        s[2,2,2,1]=(0.938162394147)*x[0]+(1.74792706902)*x[1]
        s[2,3,0,0]=(-0.0610369156925)*x[0]+(0.316929103344)*x[1]
        s[2,3,0,1]=(0.115575825651)*x[0]+(0.196603816526)*x[1]
        s[2,3,1,0]=(-0.137564893251)*x[0]+(0.732741603189)*x[1]
        s[2,3,1,1]=(-0.659475613725)*x[0]+(0.126037736276)*x[1]
        s[2,3,2,0]=(1.1911196497)*x[0]+(0.86409088069)*x[1]
        s[2,3,2,1]=(-0.161576876539)*x[0]+(-0.519953247817)*x[1]
        s[2,4,0,0]=(0.653018736743)*x[0]+(-0.141460723253)*x[1]
        s[2,4,0,1]=(0.548072342723)*x[0]+(0.79847118191)*x[1]
        s[2,4,1,0]=(-0.894497169389)*x[0]+(0.358296451187)*x[1]
        s[2,4,1,1]=(0.104304124331)*x[0]+(0.229557340588)*x[1]
        s[2,4,2,0]=(-0.775504740819)*x[0]+(-0.914276983707)*x[1]
        s[2,4,2,1]=(-0.997444443952)*x[0]+(-0.550036262287)*x[1]
        s[3,0,0,0]=(-0.912968382437)*x[0]+(1.34668077004)*x[1]
        s[3,0,0,1]=(0.279466090703)*x[0]+(1.28107040706)*x[1]
        s[3,0,1,0]=(0.282808913079)*x[0]+(0.740167690692)*x[1]
        s[3,0,1,1]=(-1.39563519985)*x[0]+(-0.567913880569)*x[1]
        s[3,0,2,0]=(1.27572544936)*x[0]+(-0.733366778512)*x[1]
        s[3,0,2,1]=(-0.33162427954)*x[0]+(1.35270158006)*x[1]
        s[3,1,0,0]=(0.519174606536)*x[0]+(-0.372514377255)*x[1]
        s[3,1,0,1]=(-1.58036427028)*x[0]+(-0.235983616334)*x[1]
        s[3,1,1,0]=(-0.472835600722)*x[0]+(0.721357411442)*x[1]
        s[3,1,1,1]=(0.448313914421)*x[0]+(-0.138520459243)*x[1]
        s[3,1,2,0]=(-1.51018963552)*x[0]+(1.34139211207)*x[1]
        s[3,1,2,1]=(-0.212789438989)*x[0]+(-1.06575114519)*x[1]
        s[3,2,0,0]=(0.0592065335067)*x[0]+(0.359601543991)*x[1]
        s[3,2,0,1]=(-0.594769346579)*x[0]+(1.5491276729)*x[1]
        s[3,2,1,0]=(0.28455993713)*x[0]+(0.600972748948)*x[1]
        s[3,2,1,1]=(0.398577473206)*x[0]+(0.0479286078109)*x[1]
        s[3,2,2,0]=(-1.76127884396)*x[0]+(-0.538814316335)*x[1]
        s[3,2,2,1]=(-0.390841519342)*x[0]+(0.191259339024)*x[1]
        s[3,3,0,0]=(-0.877110189074)*x[0]+(0.301682318677)*x[1]
        s[3,3,0,1]=(0.112669606669)*x[0]+(1.0395312515)*x[1]
        s[3,3,1,0]=(1.04370247351)*x[0]+(0.581250871082)*x[1]
        s[3,3,1,1]=(-0.143233022608)*x[0]+(0.593143844478)*x[1]
        s[3,3,2,0]=(-0.304532308332)*x[0]+(-0.232727140662)*x[1]
        s[3,3,2,1]=(0.767141825929)*x[0]+(0.0401997820135)*x[1]
        s[3,4,0,0]=(-0.226100649415)*x[0]+(-0.656022574403)*x[1]
        s[3,4,0,1]=(0.679160670663)*x[0]+(0.507720591962)*x[1]
        s[3,4,1,0]=(-1.30886998647)*x[0]+(-1.3539695469)*x[1]
        s[3,4,1,1]=(-1.39638819903)*x[0]+(0.650428829094)*x[1]
        s[3,4,2,0]=(-0.346486286718)*x[0]+(-0.869112300588)*x[1]
        s[3,4,2,1]=(-1.27650086562)*x[0]+(0.660506644039)*x[1]
        ref[0,0,0,0]=(-0.625690911818)*(1+2.*(dim-1.)/(o+1.))+(-0.369312548605)*dim
        ref[0,0,0,1]=(-0.0186378038077)*(1+2.*(dim-1.)/(o+1.))+(-1.48258015773)*dim
        ref[0,0,1,0]=(-1.04194152975)*(1+2.*(dim-1.)/(o+1.))+(0.0480726062254)*dim
        ref[0,0,1,1]=(0.00120841586244)*(1+2.*(dim-1.)/(o+1.))+(0.880109435685)*dim
        ref[0,0,2,0]=(-0.65182866689)*(1+2.*(dim-1.)/(o+1.))+(-0.3837943482)*dim
        ref[0,0,2,1]=(-0.729868010003)*(1+2.*(dim-1.)/(o+1.))+(0.0700408916461)*dim
        ref[0,1,0,0]=(1.26484534964)*(1+2.*(dim-1.)/(o+1.))+(0.648321102977)*dim
        ref[0,1,0,1]=(0.334654674402)*(1+2.*(dim-1.)/(o+1.))+(1.28039379721)*dim
        ref[0,1,1,0]=(0.338629227563)*(1+2.*(dim-1.)/(o+1.))+(-1.0808418047)*dim
        ref[0,1,1,1]=(0.0969508871625)*(1+2.*(dim-1.)/(o+1.))+(1.41076503155)*dim
        ref[0,1,2,0]=(-0.462969154119)*(1+2.*(dim-1.)/(o+1.))+(-1.21077589544)*dim
        ref[0,1,2,1]=(0.46756493995)*(1+2.*(dim-1.)/(o+1.))+(-0.180443739595)*dim
        ref[0,2,0,0]=(-0.0576220389279)*(1+2.*(dim-1.)/(o+1.))+(-1.18407752769)*dim
        ref[0,2,0,1]=(-0.650282644944)*(1+2.*(dim-1.)/(o+1.))+(-0.105333540684)*dim
        ref[0,2,1,0]=(0.136853100987)*(1+2.*(dim-1.)/(o+1.))+(-0.190644910096)*dim
        ref[0,2,1,1]=(-0.637797927534)*(1+2.*(dim-1.)/(o+1.))+(1.55463961724)*dim
        ref[0,2,2,0]=(-0.455136385489)*(1+2.*(dim-1.)/(o+1.))+(-1.00843352196)*dim
        ref[0,2,2,1]=(-0.35303452486)*(1+2.*(dim-1.)/(o+1.))+(1.18260633268)*dim
        ref[0,3,0,0]=(-0.315687014208)*(1+2.*(dim-1.)/(o+1.))+(0.155831694992)*dim
        ref[0,3,0,1]=(1.52158435346)*(1+2.*(dim-1.)/(o+1.))+(0.701192882048)*dim
        ref[0,3,1,0]=(-0.836739848177)*(1+2.*(dim-1.)/(o+1.))+(-1.52845407104)*dim
        ref[0,3,1,1]=(-0.983041539851)*(1+2.*(dim-1.)/(o+1.))+(-1.03706870484)*dim
        ref[0,3,2,0]=(-0.497690471912)*(1+2.*(dim-1.)/(o+1.))+(0.122203282296)*dim
        ref[0,3,2,1]=(0.394951943207)*(1+2.*(dim-1.)/(o+1.))+(-0.624446063287)*dim
        ref[0,4,0,0]=(-0.63974792726)*(1+2.*(dim-1.)/(o+1.))+(-0.516457806843)*dim
        ref[0,4,0,1]=(0.62556865655)*(1+2.*(dim-1.)/(o+1.))+(-0.0132723405234)*dim
        ref[0,4,1,0]=(-1.10166644693)*(1+2.*(dim-1.)/(o+1.))+(0.720773533984)*dim
        ref[0,4,1,1]=(-1.09945957099)*(1+2.*(dim-1.)/(o+1.))+(0.0797660015265)*dim
        ref[0,4,2,0]=(-0.359198665738)*(1+2.*(dim-1.)/(o+1.))+(-0.694004796462)*dim
        ref[0,4,2,1]=(1.60203342245)*(1+2.*(dim-1.)/(o+1.))+(-0.533590800966)*dim
        ref[1,0,0,0]=(0.0630998548187)*(1+2.*(dim-1.)/(o+1.))+(-1.21827137545)*dim
        ref[1,0,0,1]=(-0.362786036469)*(1+2.*(dim-1.)/(o+1.))+(0.629021834252)*dim
        ref[1,0,1,0]=(1.30840533269)*(1+2.*(dim-1.)/(o+1.))+(0.01020704647)*dim
        ref[1,0,1,1]=(0.581668517056)*(1+2.*(dim-1.)/(o+1.))+(0.0572291920482)*dim
        ref[1,0,2,0]=(-1.1596262045)*(1+2.*(dim-1.)/(o+1.))+(0.573375327782)*dim
        ref[1,0,2,1]=(-0.025337463973)*(1+2.*(dim-1.)/(o+1.))+(1.09210267755)*dim
        ref[1,1,0,0]=(-1.46016674214)*(1+2.*(dim-1.)/(o+1.))+(-1.05755098104)*dim
        ref[1,1,0,1]=(-0.410079206814)*(1+2.*(dim-1.)/(o+1.))+(-0.323481368888)*dim
        ref[1,1,1,0]=(0.497609154803)*(1+2.*(dim-1.)/(o+1.))+(-1.20018654453)*dim
        ref[1,1,1,1]=(0.446563754938)*(1+2.*(dim-1.)/(o+1.))+(1.47358034665)*dim
        ref[1,1,2,0]=(0.124142572295)*(1+2.*(dim-1.)/(o+1.))+(-0.672049901132)*dim
        ref[1,1,2,1]=(-1.27946259076)*(1+2.*(dim-1.)/(o+1.))+(-0.09079919688)*dim
        ref[1,2,0,0]=(0.0167916382593)*(1+2.*(dim-1.)/(o+1.))+(-1.10307978578)*dim
        ref[1,2,0,1]=(0.310300272224)*(1+2.*(dim-1.)/(o+1.))+(1.05128017274)*dim
        ref[1,2,1,0]=(-0.384485455128)*(1+2.*(dim-1.)/(o+1.))+(0.579076204736)*dim
        ref[1,2,1,1]=(0.133076827561)*(1+2.*(dim-1.)/(o+1.))+(0.59009370404)*dim
        ref[1,2,2,0]=(1.4126992054)*(1+2.*(dim-1.)/(o+1.))+(-1.44192474084)*dim
        ref[1,2,2,1]=(0.235736468845)*(1+2.*(dim-1.)/(o+1.))+(-1.01740610006)*dim
        ref[1,3,0,0]=(-0.323242689323)*(1+2.*(dim-1.)/(o+1.))+(0.917992023864)*dim
        ref[1,3,0,1]=(-1.56677140485)*(1+2.*(dim-1.)/(o+1.))+(0.156800710897)*dim
        ref[1,3,1,0]=(1.39852204704)*(1+2.*(dim-1.)/(o+1.))+(1.15334341893)*dim
        ref[1,3,1,1]=(1.10144038868)*(1+2.*(dim-1.)/(o+1.))+(-0.0544780940565)*dim
        ref[1,3,2,0]=(-0.619896071163)*(1+2.*(dim-1.)/(o+1.))+(-0.530507778126)*dim
        ref[1,3,2,1]=(0.665968335878)*(1+2.*(dim-1.)/(o+1.))+(0.920377229442)*dim
        ref[1,4,0,0]=(0.24940249757)*(1+2.*(dim-1.)/(o+1.))+(-1.25082923262)*dim
        ref[1,4,0,1]=(1.26616311307)*(1+2.*(dim-1.)/(o+1.))+(-0.0152526906804)*dim
        ref[1,4,1,0]=(1.37246903375)*(1+2.*(dim-1.)/(o+1.))+(0.720514473076)*dim
        ref[1,4,1,1]=(1.20885120083)*(1+2.*(dim-1.)/(o+1.))+(0.547442313947)*dim
        ref[1,4,2,0]=(-0.929784649867)*(1+2.*(dim-1.)/(o+1.))+(-0.547239578625)*dim
        ref[1,4,2,1]=(1.40793646749)*(1+2.*(dim-1.)/(o+1.))+(-1.00104546206)*dim
        ref[2,0,0,0]=(-0.865664592293)*(1+2.*(dim-1.)/(o+1.))+(0.577031746082)*dim
        ref[2,0,0,1]=(-0.383744932135)*(1+2.*(dim-1.)/(o+1.))+(-1.12195778437)*dim
        ref[2,0,1,0]=(0.899513902212)*(1+2.*(dim-1.)/(o+1.))+(0.892940129109)*dim
        ref[2,0,1,1]=(0.422487727431)*(1+2.*(dim-1.)/(o+1.))+(-0.070448635037)*dim
        ref[2,0,2,0]=(-0.0542314325807)*(1+2.*(dim-1.)/(o+1.))+(0.428900829837)*dim
        ref[2,0,2,1]=(-0.333651152721)*(1+2.*(dim-1.)/(o+1.))+(0.990911641084)*dim
        ref[2,1,0,0]=(0.743812676627)*(1+2.*(dim-1.)/(o+1.))+(-0.727555505694)*dim
        ref[2,1,0,1]=(0.487164931518)*(1+2.*(dim-1.)/(o+1.))+(-0.0759979311835)*dim
        ref[2,1,1,0]=(0.146918316537)*(1+2.*(dim-1.)/(o+1.))+(-1.15989754148)*dim
        ref[2,1,1,1]=(-0.239925787022)*(1+2.*(dim-1.)/(o+1.))+(0.534770278668)*dim
        ref[2,1,2,0]=(1.79635305588)*(1+2.*(dim-1.)/(o+1.))+(0.377208442988)*dim
        ref[2,1,2,1]=(-0.275396782095)*(1+2.*(dim-1.)/(o+1.))+(0.798426827206)*dim
        ref[2,2,0,0]=(-0.732792630073)*(1+2.*(dim-1.)/(o+1.))+(-0.642309522614)*dim
        ref[2,2,0,1]=(0.691994610633)*(1+2.*(dim-1.)/(o+1.))+(-0.0098684198643)*dim
        ref[2,2,1,0]=(0.571059981052)*(1+2.*(dim-1.)/(o+1.))+(-0.473609097192)*dim
        ref[2,2,1,1]=(-0.935084534142)*(1+2.*(dim-1.)/(o+1.))+(0.15087061249)*dim
        ref[2,2,2,0]=(0.0826567188857)*(1+2.*(dim-1.)/(o+1.))+(1.73404072415)*dim
        ref[2,2,2,1]=(1.26427004187)*(1+2.*(dim-1.)/(o+1.))+(1.4218194213)*dim
        ref[2,3,0,0]=(-0.398591309648)*(1+2.*(dim-1.)/(o+1.))+(0.6544834973)*dim
        ref[2,3,0,1]=(-0.568822853648)*(1+2.*(dim-1.)/(o+1.))+(0.881002495825)*dim
        ref[2,3,1,0]=(1.18000532793)*(1+2.*(dim-1.)/(o+1.))+(-0.584828617992)*dim
        ref[2,3,1,1]=(-1.60821457294)*(1+2.*(dim-1.)/(o+1.))+(1.07477669549)*dim
        ref[2,3,2,0]=(1.48063830505)*(1+2.*(dim-1.)/(o+1.))+(0.574572225346)*dim
        ref[2,3,2,1]=(0.229132618257)*(1+2.*(dim-1.)/(o+1.))+(-0.910662742613)*dim
        ref[2,4,0,0]=(0.426313638958)*(1+2.*(dim-1.)/(o+1.))+(0.0852443745317)*dim
        ref[2,4,0,1]=(-0.0761298452145)*(1+2.*(dim-1.)/(o+1.))+(1.42267336985)*dim
        ref[2,4,1,0]=(-0.537516881228)*(1+2.*(dim-1.)/(o+1.))+(0.00131616302647)*dim
        ref[2,4,1,1]=(-1.00615029385)*(1+2.*(dim-1.)/(o+1.))+(1.34001175877)*dim
        ref[2,4,2,0]=(-0.250744474716)*(1+2.*(dim-1.)/(o+1.))+(-1.43903724981)*dim
        ref[2,4,2,1]=(0.273616829308)*(1+2.*(dim-1.)/(o+1.))+(-1.82109753555)*dim
        ref[3,0,0,0]=(0.773912240208)*(1+2.*(dim-1.)/(o+1.))+(-0.340199852604)*dim
        ref[3,0,0,1]=(0.00495773386215)*(1+2.*(dim-1.)/(o+1.))+(1.5555787639)*dim
        ref[3,0,1,0]=(-0.586757469166)*(1+2.*(dim-1.)/(o+1.))+(1.60973407294)*dim
        ref[3,0,1,1]=(-0.577120453982)*(1+2.*(dim-1.)/(o+1.))+(-1.38642862644)*dim
        ref[3,0,2,0]=(0.288712056159)*(1+2.*(dim-1.)/(o+1.))+(0.253646614684)*dim
        ref[3,0,2,1]=(-0.248042635081)*(1+2.*(dim-1.)/(o+1.))+(1.2691199356)*dim
        ref[3,1,0,0]=(0.995572341947)*(1+2.*(dim-1.)/(o+1.))+(-0.848912112665)*dim
        ref[3,1,0,1]=(-1.37225234108)*(1+2.*(dim-1.)/(o+1.))+(-0.444095545534)*dim
        ref[3,1,1,0]=(0.441843238326)*(1+2.*(dim-1.)/(o+1.))+(-0.193321427606)*dim
        ref[3,1,1,1]=(0.408346053376)*(1+2.*(dim-1.)/(o+1.))+(-0.098552598199)*dim
        ref[3,1,2,0]=(-0.311970472748)*(1+2.*(dim-1.)/(o+1.))+(0.143172949307)*dim
        ref[3,1,2,1]=(-0.434499269883)*(1+2.*(dim-1.)/(o+1.))+(-0.844041314296)*dim
        ref[3,2,0,0]=(0.480046851902)*(1+2.*(dim-1.)/(o+1.))+(-0.0612387744048)*dim
        ref[3,2,0,1]=(1.12223817367)*(1+2.*(dim-1.)/(o+1.))+(-0.167879847351)*dim
        ref[3,2,1,0]=(-0.345095098378)*(1+2.*(dim-1.)/(o+1.))+(1.23062778446)*dim
        ref[3,2,1,1]=(1.37605147183)*(1+2.*(dim-1.)/(o+1.))+(-0.92954539081)*dim
        ref[3,2,2,0]=(-1.0202068094)*(1+2.*(dim-1.)/(o+1.))+(-1.2798863509)*dim
        ref[3,2,2,1]=(-0.302591270785)*(1+2.*(dim-1.)/(o+1.))+(0.103009090467)*dim
        ref[3,3,0,0]=(0.857177782444)*(1+2.*(dim-1.)/(o+1.))+(-1.43260565284)*dim
        ref[3,3,0,1]=(0.0906238774103)*(1+2.*(dim-1.)/(o+1.))+(1.06157698076)*dim
        ref[3,3,1,0]=(0.42136870665)*(1+2.*(dim-1.)/(o+1.))+(1.20358463794)*dim
        ref[3,3,1,1]=(-0.88620181924)*(1+2.*(dim-1.)/(o+1.))+(1.33611264111)*dim
        ref[3,3,2,0]=(0.444491342755)*(1+2.*(dim-1.)/(o+1.))+(-0.981750791749)*dim
        ref[3,3,2,1]=(-1.06075000108)*(1+2.*(dim-1.)/(o+1.))+(1.86809160902)*dim
        ref[3,4,0,0]=(-0.517172055625)*(1+2.*(dim-1.)/(o+1.))+(-0.364951168193)*dim
        ref[3,4,0,1]=(0.683410864606)*(1+2.*(dim-1.)/(o+1.))+(0.503470398019)*dim
        ref[3,4,1,0]=(-1.49890766435)*(1+2.*(dim-1.)/(o+1.))+(-1.16393186901)*dim
        ref[3,4,1,1]=(0.25999658315)*(1+2.*(dim-1.)/(o+1.))+(-1.00595595308)*dim
        ref[3,4,2,0]=(-0.296406951133)*(1+2.*(dim-1.)/(o+1.))+(-0.919191636173)*dim
        ref[3,4,2,1]=(-0.562797436325)*(1+2.*(dim-1.)/(o+1.))+(-0.0531967852595)*dim
      else:
        s[0,0,0,0]=(0.28520634077)*x[0]+(-0.126741433974)*x[1]+(1.28370871197)*x[2]
        s[0,0,0,1]=(-0.0731693108841)*x[0]+(0.342123624879)*x[1]+(0.302260810729)*x[2]
        s[0,0,1,0]=(-0.933375161617)*x[0]+(0.714257115938)*x[1]+(0.0355044702732)*x[2]
        s[0,0,1,1]=(0.273422423495)*x[0]+(-1.43381666098)*x[1]+(-0.3924531625)*x[2]
        s[0,0,2,0]=(-1.24504380748)*x[0]+(1.36389469156)*x[1]+(1.0146102387)*x[2]
        s[0,0,2,1]=(-0.12931890066)*x[0]+(0.00848180915183)*x[1]+(0.230392813094)*x[2]
        s[0,1,0,0]=(0.390247630566)*x[0]+(0.116544846708)*x[1]+(-0.94552924973)*x[2]
        s[0,1,0,1]=(1.53653205813)*x[0]+(0.984195773879)*x[1]+(0.767182801059)*x[2]
        s[0,1,1,0]=(0.433068815739)*x[0]+(0.196964560742)*x[1]+(0.00150259046749)*x[2]
        s[0,1,1,1]=(0.620083290721)*x[0]+(-0.981816668862)*x[1]+(-0.0602017060991)*x[2]
        s[0,1,2,0]=(0.266920335934)*x[0]+(-1.01077201758)*x[1]+(-1.66555517355)*x[2]
        s[0,1,2,1]=(-0.463794455357)*x[0]+(1.02905222514)*x[1]+(-0.524965351287)*x[2]
        s[0,2,0,0]=(-1.02890742598)*x[0]+(0.10277767711)*x[1]+(-0.709831378433)*x[2]
        s[0,2,0,1]=(0.942130530664)*x[0]+(-0.498478792456)*x[1]+(-0.321634750428)*x[2]
        s[0,2,1,0]=(-1.09979499064)*x[0]+(-0.552242175008)*x[1]+(1.47155591555)*x[2]
        s[0,2,1,1]=(0.038643175545)*x[0]+(-0.367877010362)*x[1]+(-0.422403338025)*x[2]
        s[0,2,2,0]=(0.915798473155)*x[0]+(0.627559693912)*x[1]+(-0.146957763577)*x[2]
        s[0,2,2,1]=(0.35609430038)*x[0]+(0.627155969018)*x[1]+(-0.0538976009369)*x[2]
        s[0,3,0,0]=(0.753367589685)*x[0]+(-1.56174987227)*x[1]+(0.0317386362973)*x[2]
        s[0,3,0,1]=(-1.0814768856)*x[0]+(-0.000317117094536)*x[1]+(0.160394230281)*x[2]
        s[0,3,1,0]=(0.539343002581)*x[0]+(0.600975350875)*x[1]+(-0.579108274756)*x[2]
        s[0,3,1,1]=(1.93822764773)*x[0]+(1.19115168218)*x[1]+(-0.345303177833)*x[2]
        s[0,3,2,0]=(-0.396284929409)*x[0]+(-0.0620671301539)*x[1]+(0.405978876833)*x[2]
        s[0,3,2,1]=(-0.806591193034)*x[0]+(-0.869878106357)*x[1]+(-0.352772882375)*x[2]
        s[0,4,0,0]=(-1.01176424875)*x[0]+(-1.57589661925)*x[1]+(-0.313904557434)*x[2]
        s[0,4,0,1]=(0.277176183617)*x[0]+(0.548456592065)*x[1]+(1.21233269169)*x[2]
        s[0,4,1,0]=(0.916512281025)*x[0]+(-1.53600125673)*x[1]+(-0.486397251593)*x[2]
        s[0,4,1,1]=(1.12553562564)*x[0]+(0.0569780615281)*x[1]+(-0.275491563277)*x[2]
        s[0,4,2,0]=(0.0701240897706)*x[0]+(-0.109284348724)*x[1]+(0.920255378883)*x[2]
        s[0,4,2,1]=(-0.286723671632)*x[0]+(0.521149269283)*x[1]+(0.880566081072)*x[2]
        s[1,0,0,0]=(-0.161092153994)*x[0]+(1.60646814731)*x[1]+(-0.293423133436)*x[2]
        s[1,0,0,1]=(-0.62705410926)*x[0]+(-0.133468132127)*x[1]+(0.435110047414)*x[2]
        s[1,0,1,0]=(0.963863560937)*x[0]+(0.358847992997)*x[1]+(0.847184531597)*x[2]
        s[1,0,1,1]=(0.2445787465)*x[0]+(-0.161812641928)*x[1]+(-0.679720454567)*x[2]
        s[1,0,2,0]=(1.05646386542)*x[0]+(1.0631242639)*x[1]+(-0.762052372247)*x[2]
        s[1,0,2,1]=(-0.950180341823)*x[0]+(1.00890659836)*x[1]+(1.54399946028)*x[2]
        s[1,1,0,0]=(0.290340455371)*x[0]+(-1.13919380812)*x[1]+(-0.659408495899)*x[2]
        s[1,1,0,1]=(1.4258405346)*x[0]+(1.53809682182)*x[1]+(0.0675302762314)*x[2]
        s[1,1,1,0]=(1.21278717612)*x[0]+(0.220266219454)*x[1]+(1.66873955725)*x[2]
        s[1,1,1,1]=(0.771526101684)*x[0]+(-0.067360487854)*x[1]+(1.21982979968)*x[2]
        s[1,1,2,0]=(-0.77604682892)*x[0]+(0.3133384598)*x[1]+(0.645828815985)*x[2]
        s[1,1,2,1]=(-0.107715380402)*x[0]+(-0.0772190829216)*x[1]+(-1.14700080403)*x[2]
        s[1,2,0,0]=(0.324137135934)*x[0]+(1.29562077427)*x[1]+(0.455108897284)*x[2]
        s[1,2,0,1]=(-1.43262429921)*x[0]+(0.773443491708)*x[1]+(0.277297920728)*x[2]
        s[1,2,1,0]=(0.304810473045)*x[0]+(-0.0168967979423)*x[1]+(0.131774697941)*x[2]
        s[1,2,1,1]=(0.387736648788)*x[0]+(0.666220386408)*x[1]+(1.07576988895)*x[2]
        s[1,2,2,0]=(-0.254693787451)*x[0]+(-0.3384585134)*x[1]+(-0.64060329677)*x[2]
        s[1,2,2,1]=(-0.672597816893)*x[0]+(0.145646769601)*x[1]+(-0.994938729226)*x[2]
        s[1,3,0,0]=(-1.1030634788)*x[0]+(-1.80762204727)*x[1]+(1.6309434404)*x[2]
        s[1,3,0,1]=(0.276318339362)*x[0]+(0.385250530079)*x[1]+(-0.758561170758)*x[2]
        s[1,3,1,0]=(0.179910601577)*x[0]+(-0.11818800924)*x[1]+(-0.743123335945)*x[2]
        s[1,3,1,1]=(0.782295683197)*x[0]+(0.749420799157)*x[1]+(-0.656475021802)*x[2]
        s[1,3,2,0]=(0.574829069465)*x[0]+(-0.493394135291)*x[1]+(1.29795947888)*x[2]
        s[1,3,2,1]=(-1.46888017959)*x[0]+(-1.08679474255)*x[1]+(0.156158770501)*x[2]
        s[1,4,0,0]=(-0.860789510784)*x[0]+(0.652130849161)*x[1]+(-0.0894965081242)*x[2]
        s[1,4,0,1]=(0.997352754709)*x[0]+(-0.112776085202)*x[1]+(-0.469141207634)*x[2]
        s[1,4,1,0]=(-0.401561591069)*x[0]+(-0.362165453433)*x[1]+(1.42046539935)*x[2]
        s[1,4,1,1]=(-0.668331880273)*x[0]+(-1.28337116108)*x[1]+(0.368963183759)*x[2]
        s[1,4,2,0]=(-1.15039637411)*x[0]+(0.121579045201)*x[1]+(-0.104055094935)*x[2]
        s[1,4,2,1]=(-0.923080753122)*x[0]+(0.322395936762)*x[1]+(0.233695594483)*x[2]
        s[2,0,0,0]=(-0.206424413737)*x[0]+(0.761779799677)*x[1]+(-0.301048388352)*x[2]
        s[2,0,0,1]=(1.55990080913)*x[0]+(-0.162113046152)*x[1]+(-0.310428209804)*x[2]
        s[2,0,1,0]=(-0.433285639024)*x[0]+(1.36777883595)*x[1]+(-1.17795591805)*x[2]
        s[2,0,1,1]=(1.34284608147)*x[0]+(-0.222861276203)*x[1]+(0.855486771517)*x[2]
        s[2,0,2,0]=(-0.16635189023)*x[0]+(-0.823533654953)*x[1]+(0.797079690281)*x[2]
        s[2,0,2,1]=(0.752310816499)*x[0]+(0.764018784752)*x[1]+(0.056117413692)*x[2]
        s[2,1,0,0]=(0.00166988723156)*x[0]+(0.766304091963)*x[1]+(0.275940662737)*x[2]
        s[2,1,0,1]=(-0.0855732564349)*x[0]+(-1.02664418473)*x[1]+(0.662522947755)*x[2]
        s[2,1,1,0]=(-0.658811588292)*x[0]+(-1.04635899154)*x[1]+(1.05470344529)*x[2]
        s[2,1,1,1]=(-0.119299788842)*x[0]+(-0.782372280168)*x[1]+(-1.79380761901)*x[2]
        s[2,1,2,0]=(1.71887176677)*x[0]+(-0.226946752041)*x[1]+(0.799181606184)*x[2]
        s[2,1,2,1]=(-0.9189461833)*x[0]+(0.916498349691)*x[1]+(0.734617496542)*x[2]
        s[2,2,0,0]=(-0.790364198949)*x[0]+(0.0131553082942)*x[1]+(-0.978651161192)*x[2]
        s[2,2,0,1]=(0.32388442717)*x[0]+(-0.593416422259)*x[1]+(1.10510332946)*x[2]
        s[2,2,1,0]=(0.452042167919)*x[0]+(-0.641462816719)*x[1]+(-0.356784432003)*x[2]
        s[2,2,1,1]=(0.0725380542114)*x[0]+(0.255256127518)*x[1]+(0.979834678019)*x[2]
        s[2,2,2,0]=(1.39372044596)*x[0]+(0.938441851122)*x[1]+(-0.983490819141)*x[2]
        s[2,2,2,1]=(1.2364973033)*x[0]+(-1.2815807633)*x[1]+(-0.360311591593)*x[2]
        s[2,3,0,0]=(-0.0597199849648)*x[0]+(0.376596450311)*x[1]+(-0.494756059286)*x[2]
        s[2,3,0,1]=(-0.1287394847)*x[0]+(0.0455819025025)*x[1]+(1.57146607969)*x[2]
        s[2,3,1,0]=(-1.4907853501)*x[0]+(0.0388186733561)*x[1]+(0.13920185582)*x[2]
        s[2,3,1,1]=(0.0439467610482)*x[0]+(1.43515095249)*x[1]+(-0.205189829549)*x[2]
        s[2,3,2,0]=(0.773581921294)*x[0]+(1.41482523023)*x[1]+(1.02435393168)*x[2]
        s[2,3,2,1]=(0.347805074163)*x[0]+(1.52992663335)*x[1]+(-0.487058346391)*x[2]
        s[2,4,0,0]=(-0.107692405269)*x[0]+(0.147562810855)*x[1]+(1.38077195652)*x[2]
        s[2,4,0,1]=(-0.0410323036269)*x[0]+(0.269432309711)*x[1]+(-0.693128417186)*x[2]
        s[2,4,1,0]=(-0.33861862665)*x[0]+(-0.419772907291)*x[1]+(-1.07238876285)*x[2]
        s[2,4,1,1]=(0.143346805317)*x[0]+(-0.419444960688)*x[1]+(1.59692612607)*x[2]
        s[2,4,2,0]=(0.654582963584)*x[0]+(-0.44163597128)*x[1]+(-0.694330043907)*x[2]
        s[2,4,2,1]=(0.627421193857)*x[0]+(0.597177617998)*x[1]+(-0.451180510793)*x[2]
        s[3,0,0,0]=(-0.101412872135)*x[0]+(-0.396884673414)*x[1]+(0.896841368992)*x[2]
        s[3,0,0,1]=(0.139595535793)*x[0]+(0.624607944421)*x[1]+(0.574170381258)*x[2]
        s[3,0,1,0]=(0.316717544294)*x[0]+(-0.621261709901)*x[1]+(1.31441803912)*x[2]
        s[3,0,1,1]=(0.254418231071)*x[0]+(0.228843906675)*x[1]+(0.25896007767)*x[2]
        s[3,0,2,0]=(-0.247274104613)*x[0]+(1.20694307591)*x[1]+(-0.407808429936)*x[2]
        s[3,0,2,1]=(-1.40605558298)*x[0]+(0.168721449606)*x[1]+(-0.972867940483)*x[2]
        s[3,1,0,0]=(0.245845223266)*x[0]+(-1.51779122633)*x[1]+(-0.779293963961)*x[2]
        s[3,1,0,1]=(0.0325495798223)*x[0]+(-0.12100728517)*x[1]+(1.31848044222)*x[2]
        s[3,1,1,0]=(0.789118948962)*x[0]+(0.589652419254)*x[1]+(-0.08688557206)*x[2]
        s[3,1,1,1]=(-1.83518748403)*x[0]+(-0.500646680661)*x[1]+(0.233750065377)*x[2]
        s[3,1,2,0]=(-0.0771120817018)*x[0]+(0.0904104042813)*x[1]+(0.0933370539969)*x[2]
        s[3,1,2,1]=(-1.19249513127)*x[0]+(0.447348983457)*x[1]+(-0.298916535972)*x[2]
        s[3,2,0,0]=(1.22266670435)*x[0]+(-1.62277644197)*x[1]+(-0.0190709988254)*x[2]
        s[3,2,0,1]=(-0.194952675382)*x[0]+(0.554694000692)*x[1]+(-0.151982113386)*x[2]
        s[3,2,1,0]=(0.511265692083)*x[0]+(-0.802622720144)*x[1]+(-0.242270723374)*x[2]
        s[3,2,1,1]=(0.476021603798)*x[0]+(-0.463494861878)*x[1]+(-0.532143290096)*x[2]
        s[3,2,2,0]=(-0.530708374495)*x[0]+(1.10856138272)*x[1]+(0.409512895954)*x[2]
        s[3,2,2,1]=(0.0214256235243)*x[0]+(0.836046354994)*x[1]+(-0.263352555948)*x[2]
        s[3,3,0,0]=(-0.437181323979)*x[0]+(-0.413716617562)*x[1]+(-0.432122540243)*x[2]
        s[3,3,0,1]=(1.08881737048)*x[0]+(-0.0166529943951)*x[1]+(-0.236235303435)*x[2]
        s[3,3,1,0]=(-0.220528005238)*x[0]+(-0.0637133108381)*x[1]+(-0.722670710646)*x[2]
        s[3,3,1,1]=(0.0267596690177)*x[0]+(0.277583150215)*x[1]+(-1.19820417967)*x[2]
        s[3,3,2,0]=(-0.134456240167)*x[0]+(0.207594364333)*x[1]+(-1.58153388102)*x[2]
        s[3,3,2,1]=(-0.484174332477)*x[0]+(1.24683115653)*x[1]+(0.0960608606087)*x[2]
        s[3,4,0,0]=(-1.06280143452)*x[0]+(0.0909193631754)*x[1]+(0.735785607027)*x[2]
        s[3,4,0,1]=(-0.39199782699)*x[0]+(-0.547457599272)*x[1]+(-0.990008593852)*x[2]
        s[3,4,1,0]=(-0.301784264736)*x[0]+(-0.219227445543)*x[1]+(-0.979494077205)*x[2]
        s[3,4,1,1]=(-0.898860901012)*x[0]+(-0.103378912588)*x[1]+(-0.66619898802)*x[2]
        s[3,4,2,0]=(1.10051932868)*x[0]+(0.407341781092)*x[1]+(-0.680512930996)*x[2]
        s[3,4,2,1]=(-0.0733544592857)*x[0]+(1.18707229675)*x[1]+(-0.777693466919)*x[2]
        ref[0,0,0,0]=(0.438851859071)*(1+2.*(dim-1.)/(o+1.))+(1.0033217597)*dim
        ref[0,0,0,1]=(-0.891607994637)*(1+2.*(dim-1.)/(o+1.))+(1.46282311936)*dim
        ref[0,0,1,0]=(0.817888583209)*(1+2.*(dim-1.)/(o+1.))+(-1.00150215862)*dim
        ref[0,0,1,1]=(-1.639070793)*(1+2.*(dim-1.)/(o+1.))+(0.0862233930162)*dim
        ref[0,0,2,0]=(-0.348875799642)*(1+2.*(dim-1.)/(o+1.))+(1.48233692242)*dim
        ref[0,0,2,1]=(-0.589821443428)*(1+2.*(dim-1.)/(o+1.))+(0.699377165015)*dim
        ref[0,1,0,0]=(-0.832218783182)*(1+2.*(dim-1.)/(o+1.))+(0.393482010727)*dim
        ref[0,1,0,1]=(2.07094909251)*(1+2.*(dim-1.)/(o+1.))+(1.21696154056)*dim
        ref[0,1,1,0]=(0.1125989301)*(1+2.*(dim-1.)/(o+1.))+(0.518937036848)*dim
        ref[0,1,1,1]=(-1.36685685946)*(1+2.*(dim-1.)/(o+1.))+(0.944921775217)*dim
        ref[0,1,2,0]=(-1.47817293944)*(1+2.*(dim-1.)/(o+1.))+(-0.931233915749)*dim
        ref[0,1,2,1]=(-0.213405460956)*(1+2.*(dim-1.)/(o+1.))+(0.253697879455)*dim
        ref[0,2,0,0]=(-0.0805522984701)*(1+2.*(dim-1.)/(o+1.))+(-1.55540882883)*dim
        ref[0,2,0,1]=(0.156888902683)*(1+2.*(dim-1.)/(o+1.))+(-0.034871914902)*dim
        ref[0,2,1,0]=(-0.15684567608)*(1+2.*(dim-1.)/(o+1.))+(-0.0236355740175)*dim
        ref[0,2,1,1]=(-1.39067500442)*(1+2.*(dim-1.)/(o+1.))+(0.639037831581)*dim
        ref[0,2,2,0]=(1.81399897277)*(1+2.*(dim-1.)/(o+1.))+(-0.417598569281)*dim
        ref[0,2,2,1]=(-0.764514507478)*(1+2.*(dim-1.)/(o+1.))+(1.69386717594)*dim
        ref[0,3,0,0]=(-0.392055498198)*(1+2.*(dim-1.)/(o+1.))+(-0.384588148087)*dim
        ref[0,3,0,1]=(-1.62777049183)*(1+2.*(dim-1.)/(o+1.))+(0.706370719421)*dim
        ref[0,3,1,0]=(0.619522807034)*(1+2.*(dim-1.)/(o+1.))+(-0.0583127283348)*dim
        ref[0,3,1,1]=(1.39660007067)*(1+2.*(dim-1.)/(o+1.))+(1.3874760814)*dim
        ref[0,3,2,0]=(0.396663683156)*(1+2.*(dim-1.)/(o+1.))+(-0.449036865886)*dim
        ref[0,3,2,1]=(-1.08765510225)*(1+2.*(dim-1.)/(o+1.))+(-0.941587079516)*dim
        ref[0,4,0,0]=(-1.51265971093)*(1+2.*(dim-1.)/(o+1.))+(-1.3889057145)*dim
        ref[0,4,0,1]=(0.901518176509)*(1+2.*(dim-1.)/(o+1.))+(1.13644729087)*dim
        ref[0,4,1,0]=(-0.58127466259)*(1+2.*(dim-1.)/(o+1.))+(-0.524611564706)*dim
        ref[0,4,1,1]=(1.59425336176)*(1+2.*(dim-1.)/(o+1.))+(-0.687231237871)*dim
        ref[0,4,2,0]=(1.07708364012)*(1+2.*(dim-1.)/(o+1.))+(-0.195988520187)*dim
        ref[0,4,2,1]=(0.108644035622)*(1+2.*(dim-1.)/(o+1.))+(1.0063476431)*dim
        ref[1,0,0,0]=(-0.153352577193)*(1+2.*(dim-1.)/(o+1.))+(1.30530543707)*dim
        ref[1,0,0,1]=(-0.518263005278)*(1+2.*(dim-1.)/(o+1.))+(0.192850811305)*dim
        ref[1,0,1,0]=(0.0968185470945)*(1+2.*(dim-1.)/(o+1.))+(2.07307753844)*dim
        ref[1,0,1,1]=(-0.572562275019)*(1+2.*(dim-1.)/(o+1.))+(-0.0243920749758)*dim
        ref[1,0,2,0]=(1.40149079544)*(1+2.*(dim-1.)/(o+1.))+(-0.043955038372)*dim
        ref[1,0,2,1]=(0.613246507575)*(1+2.*(dim-1.)/(o+1.))+(0.989479209244)*dim
        ref[1,1,0,0]=(-0.444118917423)*(1+2.*(dim-1.)/(o+1.))+(-1.06414293122)*dim
        ref[1,1,0,1]=(2.18067335546)*(1+2.*(dim-1.)/(o+1.))+(0.850794277187)*dim
        ref[1,1,1,0]=(0.976948683131)*(1+2.*(dim-1.)/(o+1.))+(2.1248442697)*dim
        ref[1,1,1,1]=(1.02658988987)*(1+2.*(dim-1.)/(o+1.))+(0.897405523639)*dim
        ref[1,1,2,0]=(-0.442692736232)*(1+2.*(dim-1.)/(o+1.))+(0.625813183096)*dim
        ref[1,1,2,1]=(-0.43212274342)*(1+2.*(dim-1.)/(o+1.))+(-0.899812523933)*dim
        ref[1,2,0,0]=(0.457022725817)*(1+2.*(dim-1.)/(o+1.))+(1.61784408168)*dim
        ref[1,2,0,1]=(0.643173594534)*(1+2.*(dim-1.)/(o+1.))+(-1.02505648131)*dim
        ref[1,2,1,0]=(-0.807339832268)*(1+2.*(dim-1.)/(o+1.))+(1.22702820531)*dim
        ref[1,2,1,1]=(1.42307806941)*(1+2.*(dim-1.)/(o+1.))+(0.706648854736)*dim
        ref[1,2,2,0]=(-1.02472620332)*(1+2.*(dim-1.)/(o+1.))+(-0.209029394299)*dim
        ref[1,2,2,1]=(-0.735490314485)*(1+2.*(dim-1.)/(o+1.))+(-0.786399462032)*dim
        ref[1,3,0,0]=(-0.193471598403)*(1+2.*(dim-1.)/(o+1.))+(-1.08627048726)*dim
        ref[1,3,0,1]=(0.385356410185)*(1+2.*(dim-1.)/(o+1.))+(-0.482348711502)*dim
        ref[1,3,1,0]=(0.387298963898)*(1+2.*(dim-1.)/(o+1.))+(-1.06869970751)*dim
        ref[1,3,1,1]=(0.423963900797)*(1+2.*(dim-1.)/(o+1.))+(0.451277559755)*dim
        ref[1,3,2,0]=(2.23728483025)*(1+2.*(dim-1.)/(o+1.))+(-0.857890417195)*dim
        ref[1,3,2,1]=(-0.537279589749)*(1+2.*(dim-1.)/(o+1.))+(-1.86223656189)*dim
        ref[1,4,0,0]=(0.0728532816595)*(1+2.*(dim-1.)/(o+1.))+(-0.371008451407)*dim
        ref[1,4,0,1]=(-0.159731100663)*(1+2.*(dim-1.)/(o+1.))+(0.575166562536)*dim
        ref[1,4,1,0]=(-1.07464731238)*(1+2.*(dim-1.)/(o+1.))+(1.73138566723)*dim
        ref[1,4,1,1]=(0.0871788096124)*(1+2.*(dim-1.)/(o+1.))+(-1.66991866721)*dim
        ref[1,4,2,0]=(-0.561546011624)*(1+2.*(dim-1.)/(o+1.))+(-0.571326412224)*dim
        ref[1,4,2,1]=(0.00625030418185)*(1+2.*(dim-1.)/(o+1.))+(-0.373239526059)*dim
        ref[2,0,0,0]=(-0.081748991935)*(1+2.*(dim-1.)/(o+1.))+(0.336055989523)*dim
        ref[2,0,0,1]=(-0.324440284217)*(1+2.*(dim-1.)/(o+1.))+(1.41179983739)*dim
        ref[2,0,1,0]=(-1.01122720324)*(1+2.*(dim-1.)/(o+1.))+(0.767764482116)*dim
        ref[2,0,1,1]=(1.90139553236)*(1+2.*(dim-1.)/(o+1.))+(0.0740760444209)*dim
        ref[2,0,2,0]=(1.07285550495)*(1+2.*(dim-1.)/(o+1.))+(-1.26566135985)*dim
        ref[2,0,2,1]=(1.4632067138)*(1+2.*(dim-1.)/(o+1.))+(0.109240301143)*dim
        ref[2,1,0,0]=(0.284420138548)*(1+2.*(dim-1.)/(o+1.))+(0.759494503384)*dim
        ref[2,1,0,1]=(-0.260549938527)*(1+2.*(dim-1.)/(o+1.))+(-0.189144554883)*dim
        ref[2,1,1,0]=(0.442311731675)*(1+2.*(dim-1.)/(o+1.))+(-1.09277886622)*dim
        ref[2,1,1,1]=(-0.10302967331)*(1+2.*(dim-1.)/(o+1.))+(-2.59245001471)*dim
        ref[2,1,2,0]=(0.739203737903)*(1+2.*(dim-1.)/(o+1.))+(1.55190288301)*dim
        ref[2,1,2,1]=(0.079851368615)*(1+2.*(dim-1.)/(o+1.))+(0.652318294318)*dim
        ref[2,2,0,0]=(-1.06662747958)*(1+2.*(dim-1.)/(o+1.))+(-0.689232572268)*dim
        ref[2,2,0,1]=(1.99822376512)*(1+2.*(dim-1.)/(o+1.))+(-1.16265243075)*dim
        ref[2,2,1,0]=(-1.22458303021)*(1+2.*(dim-1.)/(o+1.))+(0.678377949405)*dim
        ref[2,2,1,1]=(1.08782595263)*(1+2.*(dim-1.)/(o+1.))+(0.219802907121)*dim
        ref[2,2,2,0]=(0.905623047084)*(1+2.*(dim-1.)/(o+1.))+(0.44304843086)*dim
        ref[2,2,2,1]=(0.0286572039953)*(1+2.*(dim-1.)/(o+1.))+(-0.434052255584)*dim
        ref[2,3,0,0]=(0.498368738287)*(1+2.*(dim-1.)/(o+1.))+(-0.676248332227)*dim
        ref[2,3,0,1]=(0.0199276642636)*(1+2.*(dim-1.)/(o+1.))+(1.46838083323)*dim
        ref[2,3,1,0]=(-0.948945787905)*(1+2.*(dim-1.)/(o+1.))+(-0.363819033015)*dim
        ref[2,3,1,1]=(1.64627388129)*(1+2.*(dim-1.)/(o+1.))+(-0.372365997305)*dim
        ref[2,3,2,0]=(2.13784190571)*(1+2.*(dim-1.)/(o+1.))+(1.07491917749)*dim
        ref[2,3,2,1]=(-0.233611389691)*(1+2.*(dim-1.)/(o+1.))+(1.62428475081)*dim
        ref[2,4,0,0]=(0.739702054679)*(1+2.*(dim-1.)/(o+1.))+(0.680940307431)*dim
        ref[2,4,0,1]=(0.784529457615)*(1+2.*(dim-1.)/(o+1.))+(-1.24925786872)*dim
        ref[2,4,1,0]=(-0.583682264824)*(1+2.*(dim-1.)/(o+1.))+(-1.24709803197)*dim
        ref[2,4,1,1]=(2.09646981494)*(1+2.*(dim-1.)/(o+1.))+(-0.775641844239)*dim
        ref[2,4,2,0]=(0.259700462448)*(1+2.*(dim-1.)/(o+1.))+(-0.741083514052)*dim
        ref[2,4,2,1]=(0.997073171465)*(1+2.*(dim-1.)/(o+1.))+(-0.223654870403)*dim
        ref[3,0,0,0]=(0.444883466114)*(1+2.*(dim-1.)/(o+1.))+(-0.0463396426708)*dim
        ref[3,0,0,1]=(1.26485847247)*(1+2.*(dim-1.)/(o+1.))+(0.0735153889988)*dim
        ref[3,0,1,0]=(-0.0375651517431)*(1+2.*(dim-1.)/(o+1.))+(1.04743902526)*dim
        ref[3,0,1,1]=(0.5358978799)*(1+2.*(dim-1.)/(o+1.))+(0.206324335516)*dim
        ref[3,0,2,0]=(0.256485361704)*(1+2.*(dim-1.)/(o+1.))+(0.295375179654)*dim
        ref[3,0,2,1]=(-0.592012973207)*(1+2.*(dim-1.)/(o+1.))+(-1.61818910065)*dim
        ref[3,1,0,0]=(-0.526710008267)*(1+2.*(dim-1.)/(o+1.))+(-1.52452995876)*dim
        ref[3,1,0,1]=(1.25161847815)*(1+2.*(dim-1.)/(o+1.))+(-0.0215957412846)*dim
        ref[3,1,1,0]=(0.0535402130696)*(1+2.*(dim-1.)/(o+1.))+(1.23834558309)*dim
        ref[3,1,1,1]=(-0.642702769482)*(1+2.*(dim-1.)/(o+1.))+(-1.45938132983)*dim
        ref[3,1,2,0]=(0.0084187441016)*(1+2.*(dim-1.)/(o+1.))+(0.0982166324748)*dim
        ref[3,1,2,1]=(-0.0835608510497)*(1+2.*(dim-1.)/(o+1.))+(-0.960501832737)*dim
        ref[3,2,0,0]=(-0.233638393296)*(1+2.*(dim-1.)/(o+1.))+(-0.185542343145)*dim
        ref[3,2,0,1]=(1.83727235646)*(1+2.*(dim-1.)/(o+1.))+(-1.62951314453)*dim
        ref[3,2,1,0]=(0.141920587064)*(1+2.*(dim-1.)/(o+1.))+(-0.675548338499)*dim
        ref[3,2,1,1]=(-0.546837220172)*(1+2.*(dim-1.)/(o+1.))+(0.027220671997)*dim
        ref[3,2,2,0]=(1.08956280993)*(1+2.*(dim-1.)/(o+1.))+(-0.102196905755)*dim
        ref[3,2,2,1]=(1.37182911507)*(1+2.*(dim-1.)/(o+1.))+(-0.7777096925)*dim
        ref[3,3,0,0]=(-1.71451575877)*(1+2.*(dim-1.)/(o+1.))+(0.43149527699)*dim
        ref[3,3,0,1]=(0.125482430607)*(1+2.*(dim-1.)/(o+1.))+(0.710446642044)*dim
        ref[3,3,1,0]=(0.731418690422)*(1+2.*(dim-1.)/(o+1.))+(-1.73833071714)*dim
        ref[3,3,1,1]=(0.0925145394024)*(1+2.*(dim-1.)/(o+1.))+(-0.986375899836)*dim
        ref[3,3,2,0]=(-1.07231086612)*(1+2.*(dim-1.)/(o+1.))+(-0.436084890732)*dim
        ref[3,3,2,1]=(0.332375487809)*(1+2.*(dim-1.)/(o+1.))+(0.526342196849)*dim
        ref[3,4,0,0]=(0.730251131978)*(1+2.*(dim-1.)/(o+1.))+(-0.966347596298)*dim
        ref[3,4,0,1]=(0.235975729317)*(1+2.*(dim-1.)/(o+1.))+(-2.16543974943)*dim
        ref[3,4,1,0]=(-2.13209908673)*(1+2.*(dim-1.)/(o+1.))+(0.631593299244)*dim
        ref[3,4,1,1]=(-0.257512397822)*(1+2.*(dim-1.)/(o+1.))+(-1.4109264038)*dim
        ref[3,4,2,0]=(0.201086569751)*(1+2.*(dim-1.)/(o+1.))+(0.626261609021)*dim
        ref[3,4,2,1]=(0.819600430724)*(1+2.*(dim-1.)/(o+1.))+(-0.483576060183)*dim
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_FunctionOnBoundary_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.652580656299)*x[0]**o+(-0.90619447815)*x[0]+(-0.0960652458634)*x[1]**o+(-0.921815212982)*x[1]
        ref=(0.556515410435)*(1+2.*(dim-1.)/(o+1.))+(-1.82800969113)*dim
      else:
        s=(0.992239317892)*x[0]**o+(0.527946493658)*x[0]+(-0.517852623269)*x[1]**o+(-0.85996207711)*x[1]+(-0.351819025215)*x[2]**o+(0.780874062499)*x[2]
        ref=(0.122567669408)*(1+2.*(dim-1.)/(o+1.))+(0.448858479047)*dim
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_FunctionOnBoundary_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(0.493219509026)*x[0]**o+(-0.987257686105)*x[0]+(0.593292619761)*x[1]**o+(0.404393943308)*x[1]
        s[1]=(-0.00503309013251)*x[0]**o+(0.383977250975)*x[0]+(-0.98427148677)*x[1]**o+(-0.980898646673)*x[1]
        ref[0]=(1.08651212879)*(1+2.*(dim-1.)/(o+1.))+(-0.582863742798)*dim
        ref[1]=(-0.989304576902)*(1+2.*(dim-1.)/(o+1.))+(-0.596921395698)*dim
      else:
        s[0]=(-0.807414180514)*x[0]**o+(-0.887552057443)*x[0]+(0.419062942657)*x[1]**o+(-0.0780307657804)*x[1]+(-0.57375161239)*x[2]**o+(-0.672079552789)*x[2]
        s[1]=(0.0341328802311)*x[0]**o+(0.8952312571)*x[0]+(0.769555352247)*x[1]**o+(-0.974043749526)*x[1]+(0.532943429154)*x[2]**o+(0.265140756994)*x[2]
        ref[0]=(-0.962102850247)*(1+2.*(dim-1.)/(o+1.))+(-1.63766237601)*dim
        ref[1]=(1.33663166163)*(1+2.*(dim-1.)/(o+1.))+(0.186328264568)*dim
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_FunctionOnBoundary_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(-0.874129654878)*x[0]**o+(0.769078079549)*x[0]+(0.169490655493)*x[1]**o+(-0.414105577874)*x[1]
        s[0,1]=(-0.573932038812)*x[0]**o+(0.940575833423)*x[0]+(0.146726598392)*x[1]**o+(-0.709516681116)*x[1]
        s[0,2]=(0.958570693102)*x[0]**o+(0.345205321881)*x[0]+(-0.418462504081)*x[1]**o+(-0.391658885585)*x[1]
        s[0,3]=(0.964572209001)*x[0]**o+(-0.989029471645)*x[0]+(-0.783477665675)*x[1]**o+(-0.730975054597)*x[1]
        s[0,4]=(-0.401820155821)*x[0]**o+(0.937487436813)*x[0]+(-0.436388767817)*x[1]**o+(0.41944569363)*x[1]
        s[1,0]=(-0.218435283434)*x[0]**o+(0.449489023616)*x[0]+(0.835180453816)*x[1]**o+(0.330814802055)*x[1]
        s[1,1]=(0.997378308339)*x[0]**o+(-0.0536851038818)*x[0]+(0.415472188324)*x[1]**o+(-0.541543315513)*x[1]
        s[1,2]=(0.531080153329)*x[0]**o+(0.597962435163)*x[0]+(0.196717837822)*x[1]**o+(-0.847336564598)*x[1]
        s[1,3]=(-0.601657809776)*x[0]**o+(0.143169415905)*x[0]+(0.572624366522)*x[1]**o+(-0.126109854968)*x[1]
        s[1,4]=(-0.0923887797789)*x[0]**o+(0.743510972973)*x[0]+(-0.906380069241)*x[1]**o+(0.857368771305)*x[1]
        s[2,0]=(0.671976577482)*x[0]**o+(0.940982995212)*x[0]+(0.0235322881083)*x[1]**o+(0.551932901955)*x[1]
        s[2,1]=(-0.482943532169)*x[0]**o+(0.4285433846)*x[0]+(-0.118244007829)*x[1]**o+(0.674663307952)*x[1]
        s[2,2]=(-0.191762280668)*x[0]**o+(0.0989844222111)*x[0]+(0.322777346991)*x[1]**o+(0.0282258368072)*x[1]
        s[2,3]=(0.927688375343)*x[0]**o+(-0.616381391004)*x[0]+(0.328443474996)*x[1]**o+(0.0269050191942)*x[1]
        s[2,4]=(-0.441359800454)*x[0]**o+(-0.840582337813)*x[0]+(-0.0889373588313)*x[1]**o+(-0.973572053183)*x[1]
        s[3,0]=(0.346613552119)*x[0]**o+(0.191330676816)*x[0]+(-0.632874511488)*x[1]**o+(0.987141598)*x[1]
        s[3,1]=(-0.871079285785)*x[0]**o+(0.0595183425049)*x[0]+(-0.406377080612)*x[1]**o+(0.584095659381)*x[1]
        s[3,2]=(0.959606634672)*x[0]**o+(-0.00872257186186)*x[0]+(0.123701429421)*x[1]**o+(-0.701522275891)*x[1]
        s[3,3]=(0.791212386918)*x[0]**o+(-0.0420426671732)*x[0]+(-0.149789950006)*x[1]**o+(-0.218645658506)*x[1]
        s[3,4]=(0.784561541275)*x[0]**o+(0.615978682934)*x[0]+(0.918442985828)*x[1]**o+(0.063134842611)*x[1]
        ref[0,0]=(-0.704638999385)*(1+2.*(dim-1.)/(o+1.))+(0.354972501675)*dim
        ref[0,1]=(-0.42720544042)*(1+2.*(dim-1.)/(o+1.))+(0.231059152307)*dim
        ref[0,2]=(0.540108189021)*(1+2.*(dim-1.)/(o+1.))+(-0.046453563704)*dim
        ref[0,3]=(0.181094543326)*(1+2.*(dim-1.)/(o+1.))+(-1.72000452624)*dim
        ref[0,4]=(-0.838208923637)*(1+2.*(dim-1.)/(o+1.))+(1.35693313044)*dim
        ref[1,0]=(0.616745170381)*(1+2.*(dim-1.)/(o+1.))+(0.780303825672)*dim
        ref[1,1]=(1.41285049666)*(1+2.*(dim-1.)/(o+1.))+(-0.595228419395)*dim
        ref[1,2]=(0.727797991151)*(1+2.*(dim-1.)/(o+1.))+(-0.249374129435)*dim
        ref[1,3]=(-0.0290334432542)*(1+2.*(dim-1.)/(o+1.))+(0.017059560937)*dim
        ref[1,4]=(-0.99876884902)*(1+2.*(dim-1.)/(o+1.))+(1.60087974428)*dim
        ref[2,0]=(0.69550886559)*(1+2.*(dim-1.)/(o+1.))+(1.49291589717)*dim
        ref[2,1]=(-0.601187539998)*(1+2.*(dim-1.)/(o+1.))+(1.10320669255)*dim
        ref[2,2]=(0.131015066323)*(1+2.*(dim-1.)/(o+1.))+(0.127210259018)*dim
        ref[2,3]=(1.25613185034)*(1+2.*(dim-1.)/(o+1.))+(-0.58947637181)*dim
        ref[2,4]=(-0.530297159285)*(1+2.*(dim-1.)/(o+1.))+(-1.814154391)*dim
        ref[3,0]=(-0.28626095937)*(1+2.*(dim-1.)/(o+1.))+(1.17847227482)*dim
        ref[3,1]=(-1.2774563664)*(1+2.*(dim-1.)/(o+1.))+(0.643614001886)*dim
        ref[3,2]=(1.08330806409)*(1+2.*(dim-1.)/(o+1.))+(-0.710244847753)*dim
        ref[3,3]=(0.641422436913)*(1+2.*(dim-1.)/(o+1.))+(-0.260688325679)*dim
        ref[3,4]=(1.7030045271)*(1+2.*(dim-1.)/(o+1.))+(0.679113525545)*dim
      else:
        s[0,0]=(-0.890021592515)*x[0]**o+(0.869008439528)*x[0]+(0.0393578211875)*x[1]**o+(-0.898838314128)*x[1]+(0.120962394264)*x[2]**o+(0.820232165098)*x[2]
        s[0,1]=(0.200360087495)*x[0]**o+(-0.510360711019)*x[0]+(0.289719656756)*x[1]**o+(-0.544337956881)*x[1]+(-0.137565893265)*x[2]**o+(0.0780003071465)*x[2]
        s[0,2]=(-0.611390021035)*x[0]**o+(-0.257678585283)*x[0]+(-0.432064087215)*x[1]**o+(0.580503927543)*x[1]+(0.599605038707)*x[2]**o+(-0.116243951128)*x[2]
        s[0,3]=(0.533063923783)*x[0]**o+(0.346854667765)*x[0]+(-0.0316617652896)*x[1]**o+(-0.387870493997)*x[1]+(-0.959091675716)*x[2]**o+(-0.632504268888)*x[2]
        s[0,4]=(0.105421436346)*x[0]**o+(0.0672025049394)*x[0]+(0.295674168162)*x[1]**o+(-0.599191260911)*x[1]+(0.106390236596)*x[2]**o+(0.273159012521)*x[2]
        s[1,0]=(-0.179866026516)*x[0]**o+(-0.474318032618)*x[0]+(-0.0917700558723)*x[1]**o+(-0.957849615453)*x[1]+(0.405593449997)*x[2]**o+(-0.0879542737797)*x[2]
        s[1,1]=(0.263341986971)*x[0]**o+(0.0843810614392)*x[0]+(-0.532163327984)*x[1]**o+(0.0695511301898)*x[1]+(0.425849191612)*x[2]**o+(0.891975316063)*x[2]
        s[1,2]=(0.529944898182)*x[0]**o+(0.3446605434)*x[0]+(0.94881991666)*x[1]**o+(0.60846893826)*x[1]+(0.384682108067)*x[2]**o+(0.484190212271)*x[2]
        s[1,3]=(-0.773280762221)*x[0]**o+(-0.694374711369)*x[0]+(0.595597400746)*x[1]**o+(-0.317729831568)*x[1]+(0.436671059979)*x[2]**o+(0.862685012466)*x[2]
        s[1,4]=(0.901990663611)*x[0]**o+(-0.185951360192)*x[0]+(0.880727230793)*x[1]**o+(-0.696829887245)*x[1]+(-0.871619618845)*x[2]**o+(-0.785915181957)*x[2]
        s[2,0]=(-0.598559485292)*x[0]**o+(0.378821777768)*x[0]+(0.262525874825)*x[1]**o+(-0.633890863472)*x[1]+(0.436882086359)*x[2]**o+(0.152137062224)*x[2]
        s[2,1]=(-0.120094887119)*x[0]**o+(0.774082951002)*x[0]+(0.0910918956038)*x[1]**o+(0.914069932683)*x[1]+(-0.200132987477)*x[2]**o+(0.268683863782)*x[2]
        s[2,2]=(0.769128791381)*x[0]**o+(-0.972503532786)*x[0]+(0.898341628893)*x[1]**o+(-0.804588468967)*x[1]+(0.959444830467)*x[2]**o+(0.729116746427)*x[2]
        s[2,3]=(0.460426389529)*x[0]**o+(-0.631593304662)*x[0]+(-0.197985888231)*x[1]**o+(0.994315324532)*x[1]+(0.143730574254)*x[2]**o+(-0.635611067664)*x[2]
        s[2,4]=(-0.212297893625)*x[0]**o+(0.631051506826)*x[0]+(-0.906149638803)*x[1]**o+(0.95431164216)*x[1]+(0.506425952055)*x[2]**o+(0.476198095725)*x[2]
        s[3,0]=(-0.572583486627)*x[0]**o+(-0.615297124684)*x[0]+(0.344317617297)*x[1]**o+(0.798009040785)*x[1]+(0.646565073237)*x[2]**o+(-0.119267772639)*x[2]
        s[3,1]=(-0.275482328004)*x[0]**o+(-0.225018438903)*x[0]+(0.648843558509)*x[1]**o+(0.971983956502)*x[1]+(0.890972764481)*x[2]**o+(-0.0457638811275)*x[2]
        s[3,2]=(0.625004124231)*x[0]**o+(-0.691087681301)*x[0]+(0.823334046124)*x[1]**o+(0.174931553897)*x[1]+(-0.783435157951)*x[2]**o+(-0.183737298781)*x[2]
        s[3,3]=(0.359619581557)*x[0]**o+(0.360159573822)*x[0]+(0.395267272408)*x[1]**o+(-0.412837344771)*x[1]+(-0.015119491493)*x[2]**o+(-0.0468017493027)*x[2]
        s[3,4]=(0.0939051154145)*x[0]**o+(-0.35421304768)*x[0]+(-0.388406902403)*x[1]**o+(-0.17940478311)*x[1]+(0.247049129844)*x[2]**o+(0.208156547444)*x[2]
        ref[0,0]=(-0.729701377063)*(1+2.*(dim-1.)/(o+1.))+(0.790402290499)*dim
        ref[0,1]=(0.352513850987)*(1+2.*(dim-1.)/(o+1.))+(-0.976698360754)*dim
        ref[0,2]=(-0.443849069543)*(1+2.*(dim-1.)/(o+1.))+(0.206581391132)*dim
        ref[0,3]=(-0.457689517223)*(1+2.*(dim-1.)/(o+1.))+(-0.673520095121)*dim
        ref[0,4]=(0.507485841104)*(1+2.*(dim-1.)/(o+1.))+(-0.258829743451)*dim
        ref[1,0]=(0.13395736761)*(1+2.*(dim-1.)/(o+1.))+(-1.52012192185)*dim
        ref[1,1]=(0.157027850598)*(1+2.*(dim-1.)/(o+1.))+(1.04590750769)*dim
        ref[1,2]=(1.86344692291)*(1+2.*(dim-1.)/(o+1.))+(1.43731969393)*dim
        ref[1,3]=(0.258987698503)*(1+2.*(dim-1.)/(o+1.))+(-0.149419530472)*dim
        ref[1,4]=(0.911098275559)*(1+2.*(dim-1.)/(o+1.))+(-1.66869642939)*dim
        ref[2,0]=(0.100848475893)*(1+2.*(dim-1.)/(o+1.))+(-0.10293202348)*dim
        ref[2,1]=(-0.229135978992)*(1+2.*(dim-1.)/(o+1.))+(1.95683674747)*dim
        ref[2,2]=(2.62691525074)*(1+2.*(dim-1.)/(o+1.))+(-1.04797525533)*dim
        ref[2,3]=(0.406171075551)*(1+2.*(dim-1.)/(o+1.))+(-0.272889047794)*dim
        ref[2,4]=(-0.612021580374)*(1+2.*(dim-1.)/(o+1.))+(2.06156124471)*dim
        ref[3,0]=(0.418299203908)*(1+2.*(dim-1.)/(o+1.))+(0.0634441434621)*dim
        ref[3,1]=(1.26433399499)*(1+2.*(dim-1.)/(o+1.))+(0.701201636471)*dim
        ref[3,2]=(0.664903012404)*(1+2.*(dim-1.)/(o+1.))+(-0.699893426186)*dim
        ref[3,3]=(0.739767362472)*(1+2.*(dim-1.)/(o+1.))+(-0.0994795202511)*dim
        ref[3,4]=(-0.0474526571443)*(1+2.*(dim-1.)/(o+1.))+(-0.325461283346)*dim
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_FunctionOnBoundary_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.589365534484)*x[0]**o+(-0.562703733563)*x[0]+(-0.374217229188)*x[1]**o+(-0.39259467848)*x[1]
        s[0,0,1]=(-0.530861865638)*x[0]**o+(-0.452189463083)*x[0]+(0.130627913931)*x[1]**o+(0.401827715746)*x[1]
        s[0,1,0]=(-0.698034316811)*x[0]**o+(0.95858318685)*x[0]+(0.818020760864)*x[1]**o+(-0.842035209691)*x[1]
        s[0,1,1]=(0.784763132752)*x[0]**o+(-0.345161441944)*x[0]+(-0.0915389865806)*x[1]**o+(0.0413615155914)*x[1]
        s[1,0,0]=(0.844613455277)*x[0]**o+(-0.0227629508737)*x[0]+(0.435622185761)*x[1]**o+(-0.0215311374618)*x[1]
        s[1,0,1]=(-0.0669862120561)*x[0]**o+(-0.846007346441)*x[0]+(-0.413495349659)*x[1]**o+(0.535169065488)*x[1]
        s[1,1,0]=(-0.685697856883)*x[0]**o+(0.958953550286)*x[0]+(0.154980083392)*x[1]**o+(0.0800899796196)*x[1]
        s[1,1,1]=(0.912269483572)*x[0]**o+(0.94047005728)*x[0]+(-0.304144591655)*x[1]**o+(-0.953778202636)*x[1]
        s[2,0,0]=(-0.743960822491)*x[0]**o+(-0.550611814396)*x[0]+(-0.725685162705)*x[1]**o+(-0.339527538083)*x[1]
        s[2,0,1]=(-0.889607185943)*x[0]**o+(0.539329041411)*x[0]+(-0.161095005544)*x[1]**o+(0.0793331043418)*x[1]
        s[2,1,0]=(-0.468621581571)*x[0]**o+(-0.686831337537)*x[0]+(0.097676174696)*x[1]**o+(-0.661357348914)*x[1]
        s[2,1,1]=(0.272669628304)*x[0]**o+(-0.0973814107905)*x[0]+(0.934138436983)*x[1]**o+(0.886285785082)*x[1]
        s[3,0,0]=(0.732970432548)*x[0]**o+(0.867739265413)*x[0]+(-0.868701163584)*x[1]**o+(-0.845146120935)*x[1]
        s[3,0,1]=(0.655147591399)*x[0]**o+(-0.604461769582)*x[0]+(-0.855962338468)*x[1]**o+(-0.256146581175)*x[1]
        s[3,1,0]=(0.818629391238)*x[0]**o+(-0.949077886388)*x[0]+(0.620697264485)*x[1]**o+(0.161138363607)*x[1]
        s[3,1,1]=(0.388279443227)*x[0]**o+(-0.905781758355)*x[0]+(0.224661220296)*x[1]**o+(-0.160247355785)*x[1]
        s[4,0,0]=(0.933160401571)*x[0]**o+(0.238977604536)*x[0]+(-0.819630167281)*x[1]**o+(-0.787572050579)*x[1]
        s[4,0,1]=(-0.998710300262)*x[0]**o+(-0.311299346807)*x[0]+(0.01512022099)*x[1]**o+(0.987659405648)*x[1]
        s[4,1,0]=(-0.394579388382)*x[0]**o+(0.368576283401)*x[0]+(0.523842693559)*x[1]**o+(0.053237259039)*x[1]
        s[4,1,1]=(-0.899554766025)*x[0]**o+(0.0846648733918)*x[0]+(0.0384854956872)*x[1]**o+(0.499251840272)*x[1]
        s[5,0,0]=(0.969036476632)*x[0]**o+(0.555078576958)*x[0]+(0.358154612858)*x[1]**o+(0.988304896709)*x[1]
        s[5,0,1]=(-0.915157232317)*x[0]**o+(0.174863566989)*x[0]+(-0.929161107163)*x[1]**o+(-0.656086746151)*x[1]
        s[5,1,0]=(0.10810079771)*x[0]**o+(-0.929385584784)*x[0]+(-0.390809106715)*x[1]**o+(-0.573678217593)*x[1]
        s[5,1,1]=(0.871461803834)*x[0]**o+(-0.13090668343)*x[0]+(0.479502930134)*x[1]**o+(-0.143336447632)*x[1]
        ref[0,0,0]=(0.215148305297)*(1+2.*(dim-1.)/(o+1.))+(-0.955298412042)*dim
        ref[0,0,1]=(-0.400233951707)*(1+2.*(dim-1.)/(o+1.))+(-0.050361747337)*dim
        ref[0,1,0]=(0.119986444053)*(1+2.*(dim-1.)/(o+1.))+(0.116547977158)*dim
        ref[0,1,1]=(0.693224146172)*(1+2.*(dim-1.)/(o+1.))+(-0.303799926353)*dim
        ref[1,0,0]=(1.28023564104)*(1+2.*(dim-1.)/(o+1.))+(-0.0442940883355)*dim
        ref[1,0,1]=(-0.480481561715)*(1+2.*(dim-1.)/(o+1.))+(-0.310838280953)*dim
        ref[1,1,0]=(-0.530717773491)*(1+2.*(dim-1.)/(o+1.))+(1.03904352991)*dim
        ref[1,1,1]=(0.608124891917)*(1+2.*(dim-1.)/(o+1.))+(-0.0133081453554)*dim
        ref[2,0,0]=(-1.4696459852)*(1+2.*(dim-1.)/(o+1.))+(-0.890139352479)*dim
        ref[2,0,1]=(-1.05070219149)*(1+2.*(dim-1.)/(o+1.))+(0.618662145753)*dim
        ref[2,1,0]=(-0.370945406875)*(1+2.*(dim-1.)/(o+1.))+(-1.34818868645)*dim
        ref[2,1,1]=(1.20680806529)*(1+2.*(dim-1.)/(o+1.))+(0.788904374291)*dim
        ref[3,0,0]=(-0.135730731035)*(1+2.*(dim-1.)/(o+1.))+(0.0225931444774)*dim
        ref[3,0,1]=(-0.200814747068)*(1+2.*(dim-1.)/(o+1.))+(-0.860608350757)*dim
        ref[3,1,0]=(1.43932665572)*(1+2.*(dim-1.)/(o+1.))+(-0.787939522781)*dim
        ref[3,1,1]=(0.612940663523)*(1+2.*(dim-1.)/(o+1.))+(-1.06602911414)*dim
        ref[4,0,0]=(0.113530234291)*(1+2.*(dim-1.)/(o+1.))+(-0.548594446042)*dim
        ref[4,0,1]=(-0.983590079272)*(1+2.*(dim-1.)/(o+1.))+(0.676360058841)*dim
        ref[4,1,0]=(0.129263305177)*(1+2.*(dim-1.)/(o+1.))+(0.42181354244)*dim
        ref[4,1,1]=(-0.861069270338)*(1+2.*(dim-1.)/(o+1.))+(0.583916713663)*dim
        ref[5,0,0]=(1.32719108949)*(1+2.*(dim-1.)/(o+1.))+(1.54338347367)*dim
        ref[5,0,1]=(-1.84431833948)*(1+2.*(dim-1.)/(o+1.))+(-0.481223179161)*dim
        ref[5,1,0]=(-0.282708309005)*(1+2.*(dim-1.)/(o+1.))+(-1.50306380238)*dim
        ref[5,1,1]=(1.35096473397)*(1+2.*(dim-1.)/(o+1.))+(-0.274243131062)*dim
      else:
        s[0,0,0]=(0.107513098422)*x[0]**o+(0.630914018595)*x[0]+(0.223228652263)*x[1]**o+(-0.817313865632)*x[1]+(-0.131761985412)*x[2]**o+(0.765852452518)*x[2]
        s[0,0,1]=(0.677582669653)*x[0]**o+(-0.180457590671)*x[0]+(-0.623782106139)*x[1]**o+(-0.525225679629)*x[1]+(-0.506475447696)*x[2]**o+(0.426953870606)*x[2]
        s[0,1,0]=(0.638676595716)*x[0]**o+(0.401321387041)*x[0]+(0.326953813244)*x[1]**o+(0.376976149503)*x[1]+(0.37300668271)*x[2]**o+(-0.220329878781)*x[2]
        s[0,1,1]=(0.801707476852)*x[0]**o+(0.279766359037)*x[0]+(-0.119071566643)*x[1]**o+(0.842943055619)*x[1]+(-0.186390184701)*x[2]**o+(-0.174806078851)*x[2]
        s[1,0,0]=(0.636253830592)*x[0]**o+(0.0451704175721)*x[0]+(0.160762650006)*x[1]**o+(-0.520550899101)*x[1]+(0.104281196353)*x[2]**o+(-0.158693150263)*x[2]
        s[1,0,1]=(-0.529589537208)*x[0]**o+(0.883520631827)*x[0]+(-0.945287489028)*x[1]**o+(-0.402371494207)*x[1]+(-0.347776652964)*x[2]**o+(-0.801910128228)*x[2]
        s[1,1,0]=(-0.0695656121071)*x[0]**o+(0.318785505529)*x[0]+(-0.755792368009)*x[1]**o+(0.965500773902)*x[1]+(-0.963131216861)*x[2]**o+(-0.470019270105)*x[2]
        s[1,1,1]=(0.0313155860155)*x[0]**o+(-0.745224876276)*x[0]+(0.941969004994)*x[1]**o+(0.0868580544081)*x[1]+(0.814837112058)*x[2]**o+(0.6031495013)*x[2]
        s[2,0,0]=(0.326069961839)*x[0]**o+(-0.226878245433)*x[0]+(0.181649890734)*x[1]**o+(0.124231468404)*x[1]+(-0.607776937521)*x[2]**o+(-0.42430990239)*x[2]
        s[2,0,1]=(-0.0362788731491)*x[0]**o+(0.405545167692)*x[0]+(0.234108391034)*x[1]**o+(0.0613492588911)*x[1]+(0.375991408638)*x[2]**o+(-0.08364867034)*x[2]
        s[2,1,0]=(-0.739151142745)*x[0]**o+(0.895090860344)*x[0]+(-0.892542071223)*x[1]**o+(-0.925594662939)*x[1]+(0.527652868204)*x[2]**o+(-0.291230735869)*x[2]
        s[2,1,1]=(-0.569990909361)*x[0]**o+(0.135614304968)*x[0]+(0.644435688812)*x[1]**o+(0.607772804184)*x[1]+(-0.671154751626)*x[2]**o+(0.908859370499)*x[2]
        s[3,0,0]=(0.678101574906)*x[0]**o+(0.393260837804)*x[0]+(-0.364076766107)*x[1]**o+(0.221403168918)*x[1]+(-0.0881262519405)*x[2]**o+(0.243571413051)*x[2]
        s[3,0,1]=(-0.889370605049)*x[0]**o+(-0.751122823303)*x[0]+(-0.23702556553)*x[1]**o+(0.758207050746)*x[1]+(-0.653730045583)*x[2]**o+(-0.881328128574)*x[2]
        s[3,1,0]=(0.99850080224)*x[0]**o+(-0.13489113732)*x[0]+(-0.593980699882)*x[1]**o+(0.972643960626)*x[1]+(-0.0329293151824)*x[2]**o+(-0.432361021975)*x[2]
        s[3,1,1]=(-0.104833428698)*x[0]**o+(-0.937873960299)*x[0]+(-0.328611446648)*x[1]**o+(0.182782391112)*x[1]+(-0.565312252294)*x[2]**o+(0.0785805823337)*x[2]
        s[4,0,0]=(-0.833754760965)*x[0]**o+(-0.942110442063)*x[0]+(-0.544558564212)*x[1]**o+(-0.496169424902)*x[1]+(-0.805940323103)*x[2]**o+(0.355543043698)*x[2]
        s[4,0,1]=(0.1228603677)*x[0]**o+(0.27927470376)*x[0]+(0.790110425171)*x[1]**o+(0.345056958981)*x[1]+(-0.681665552406)*x[2]**o+(-0.263090945447)*x[2]
        s[4,1,0]=(0.845338153049)*x[0]**o+(0.00877377111324)*x[0]+(0.0538302301089)*x[1]**o+(-0.881754421435)*x[1]+(0.432818307915)*x[2]**o+(0.381735394491)*x[2]
        s[4,1,1]=(-0.679482650754)*x[0]**o+(0.111691609594)*x[0]+(-0.984942957975)*x[1]**o+(0.638763928487)*x[1]+(-0.146178908969)*x[2]**o+(0.752462675681)*x[2]
        s[5,0,0]=(-0.698554091901)*x[0]**o+(0.603862483307)*x[0]+(-0.627044519178)*x[1]**o+(-0.173483224843)*x[1]+(-0.794733618981)*x[2]**o+(0.148563520039)*x[2]
        s[5,0,1]=(-0.0422516673963)*x[0]**o+(0.551902135908)*x[0]+(-0.0620401959854)*x[1]**o+(-0.462654965568)*x[1]+(-0.853501426111)*x[2]**o+(-0.168566246091)*x[2]
        s[5,1,0]=(-0.482405425466)*x[0]**o+(0.215434393331)*x[0]+(0.0597508965493)*x[1]**o+(0.163372916375)*x[1]+(-0.0782540165278)*x[2]**o+(-0.29216681971)*x[2]
        s[5,1,1]=(-0.849963259001)*x[0]**o+(0.0653198724433)*x[0]+(0.673346071067)*x[1]**o+(-0.98400726868)*x[1]+(-0.545894674138)*x[2]**o+(-0.128229571203)*x[2]
        ref[0,0,0]=(0.198979765273)*(1+2.*(dim-1.)/(o+1.))+(0.579452605481)*dim
        ref[0,0,1]=(-0.452674884183)*(1+2.*(dim-1.)/(o+1.))+(-0.278729399693)*dim
        ref[0,1,0]=(1.33863709167)*(1+2.*(dim-1.)/(o+1.))+(0.557967657763)*dim
        ref[0,1,1]=(0.496245725508)*(1+2.*(dim-1.)/(o+1.))+(0.947903335805)*dim
        ref[1,0,0]=(0.901297676951)*(1+2.*(dim-1.)/(o+1.))+(-0.634073631792)*dim
        ref[1,0,1]=(-1.8226536792)*(1+2.*(dim-1.)/(o+1.))+(-0.320760990609)*dim
        ref[1,1,0]=(-1.78848919698)*(1+2.*(dim-1.)/(o+1.))+(0.814267009326)*dim
        ref[1,1,1]=(1.78812170307)*(1+2.*(dim-1.)/(o+1.))+(-0.0552173205681)*dim
        ref[2,0,0]=(-0.100057084948)*(1+2.*(dim-1.)/(o+1.))+(-0.526956679419)*dim
        ref[2,0,1]=(0.573820926522)*(1+2.*(dim-1.)/(o+1.))+(0.383245756243)*dim
        ref[2,1,0]=(-1.10404034576)*(1+2.*(dim-1.)/(o+1.))+(-0.321734538465)*dim
        ref[2,1,1]=(-0.596709972174)*(1+2.*(dim-1.)/(o+1.))+(1.65224647965)*dim
        ref[3,0,0]=(0.225898556859)*(1+2.*(dim-1.)/(o+1.))+(0.858235419772)*dim
        ref[3,0,1]=(-1.78012621616)*(1+2.*(dim-1.)/(o+1.))+(-0.874243901131)*dim
        ref[3,1,0]=(0.371590787175)*(1+2.*(dim-1.)/(o+1.))+(0.405391801331)*dim
        ref[3,1,1]=(-0.99875712764)*(1+2.*(dim-1.)/(o+1.))+(-0.676510986853)*dim
        ref[4,0,0]=(-2.18425364828)*(1+2.*(dim-1.)/(o+1.))+(-1.08273682327)*dim
        ref[4,0,1]=(0.231305240466)*(1+2.*(dim-1.)/(o+1.))+(0.361240717293)*dim
        ref[4,1,0]=(1.33198669107)*(1+2.*(dim-1.)/(o+1.))+(-0.49124525583)*dim
        ref[4,1,1]=(-1.8106045177)*(1+2.*(dim-1.)/(o+1.))+(1.50291821376)*dim
        ref[5,0,0]=(-2.12033223006)*(1+2.*(dim-1.)/(o+1.))+(0.578942778503)*dim
        ref[5,0,1]=(-0.957793289493)*(1+2.*(dim-1.)/(o+1.))+(-0.0793190757515)*dim
        ref[5,1,0]=(-0.500908545444)*(1+2.*(dim-1.)/(o+1.))+(0.0866404899966)*dim
        ref[5,1,1]=(-0.722511862072)*(1+2.*(dim-1.)/(o+1.))+(-1.04691696744)*dim
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnBoundary_fromSymbol_FunctionOnBoundary_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnBoundary

      assumptions: FunctionOnBoundary(self.domain) exists
                   self.domain supports integral on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      w=FunctionOnBoundary(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.938527612719)*x[0]**o+(0.18109071498)*x[0]+(0.33583450429)*x[1]**o+(0.875633806815)*x[1]
        s[0,0,0,1]=(0.235264331576)*x[0]**o+(-0.916078537073)*x[0]+(-0.564923840072)*x[1]**o+(0.241815090592)*x[1]
        s[0,0,1,0]=(0.465988219999)*x[0]**o+(-0.234861997786)*x[0]+(-0.826589503087)*x[1]**o+(-0.912695921201)*x[1]
        s[0,0,1,1]=(0.683584251749)*x[0]**o+(-0.445524319089)*x[0]+(-0.794091275716)*x[1]**o+(0.960124513284)*x[1]
        s[0,0,2,0]=(0.864832412476)*x[0]**o+(0.545257658859)*x[0]+(-0.0523175406047)*x[1]**o+(0.637801499066)*x[1]
        s[0,0,2,1]=(-0.345749442294)*x[0]**o+(-0.62275362184)*x[0]+(-0.445774008922)*x[1]**o+(-0.883708969162)*x[1]
        s[0,1,0,0]=(0.495428396131)*x[0]**o+(-0.688537966744)*x[0]+(0.974975943301)*x[1]**o+(0.812712252674)*x[1]
        s[0,1,0,1]=(0.288058971992)*x[0]**o+(0.108248232119)*x[0]+(0.717277962001)*x[1]**o+(-0.27243719684)*x[1]
        s[0,1,1,0]=(0.0359145438363)*x[0]**o+(0.536166090023)*x[0]+(-0.00355608454499)*x[1]**o+(-0.806427949542)*x[1]
        s[0,1,1,1]=(0.166147370504)*x[0]**o+(-0.627148508537)*x[0]+(-0.786840545498)*x[1]**o+(0.281613120233)*x[1]
        s[0,1,2,0]=(-0.133612757005)*x[0]**o+(0.392265237404)*x[0]+(0.453687302779)*x[1]**o+(-0.773645262693)*x[1]
        s[0,1,2,1]=(-0.716222674195)*x[0]**o+(0.670906647893)*x[0]+(-0.462562888282)*x[1]**o+(-0.624961145925)*x[1]
        s[0,2,0,0]=(0.0194565885353)*x[0]**o+(0.182692282753)*x[0]+(-0.638358622688)*x[1]**o+(0.335689393108)*x[1]
        s[0,2,0,1]=(-0.860405914558)*x[0]**o+(0.632285612174)*x[0]+(0.0656792325224)*x[1]**o+(-0.156015955877)*x[1]
        s[0,2,1,0]=(-0.152134223629)*x[0]**o+(-0.862936330258)*x[0]+(0.417270798339)*x[1]**o+(0.963136816902)*x[1]
        s[0,2,1,1]=(-0.258242824318)*x[0]**o+(0.971045381488)*x[0]+(-0.241220971892)*x[1]**o+(0.856378952246)*x[1]
        s[0,2,2,0]=(0.32072997937)*x[0]**o+(0.704100826786)*x[0]+(-0.33756098405)*x[1]**o+(-0.664910217598)*x[1]
        s[0,2,2,1]=(-0.61313065356)*x[0]**o+(0.508087982157)*x[0]+(-0.84053545881)*x[1]**o+(0.160765183388)*x[1]
        s[0,3,0,0]=(-0.75820426921)*x[0]**o+(-0.90659534133)*x[0]+(0.29703074695)*x[1]**o+(-0.0460927434434)*x[1]
        s[0,3,0,1]=(-0.168059238195)*x[0]**o+(0.444168839682)*x[0]+(-0.199109031605)*x[1]**o+(-0.0951683017552)*x[1]
        s[0,3,1,0]=(0.134237505423)*x[0]**o+(-0.793789958021)*x[0]+(-0.806546707234)*x[1]**o+(0.841229990055)*x[1]
        s[0,3,1,1]=(0.0190198296544)*x[0]**o+(-0.535272381244)*x[0]+(0.961010454009)*x[1]**o+(0.00558376325046)*x[1]
        s[0,3,2,0]=(0.363866563396)*x[0]**o+(-0.479776283958)*x[0]+(-0.189244785869)*x[1]**o+(0.807338961992)*x[1]
        s[0,3,2,1]=(0.160239702851)*x[0]**o+(-0.629633641475)*x[0]+(-0.116962193936)*x[1]**o+(-0.0779960566649)*x[1]
        s[0,4,0,0]=(-0.778019803229)*x[0]**o+(0.800046035892)*x[0]+(-0.164619354127)*x[1]**o+(-0.785540965821)*x[1]
        s[0,4,0,1]=(-0.302058711888)*x[0]**o+(0.560865269822)*x[0]+(-0.473079568526)*x[1]**o+(0.995387605735)*x[1]
        s[0,4,1,0]=(-0.411379127233)*x[0]**o+(-0.55185696669)*x[0]+(0.306097815722)*x[1]**o+(0.336660861462)*x[1]
        s[0,4,1,1]=(0.449818597104)*x[0]**o+(0.102791276029)*x[0]+(0.795639210789)*x[1]**o+(0.061474861224)*x[1]
        s[0,4,2,0]=(-0.0490155784051)*x[0]**o+(-0.429224063812)*x[0]+(-0.0368599977199)*x[1]**o+(0.718948163937)*x[1]
        s[0,4,2,1]=(-0.0195621009238)*x[0]**o+(0.162744359327)*x[0]+(0.156319239232)*x[1]**o+(-0.840307263668)*x[1]
        s[1,0,0,0]=(0.818322838345)*x[0]**o+(0.75605127429)*x[0]+(0.0160223113114)*x[1]**o+(0.733116071572)*x[1]
        s[1,0,0,1]=(-0.516143096482)*x[0]**o+(-0.607491330321)*x[0]+(-0.71990703998)*x[1]**o+(0.74041801157)*x[1]
        s[1,0,1,0]=(0.087735317248)*x[0]**o+(0.811033616338)*x[0]+(-0.596466275725)*x[1]**o+(-0.632928705475)*x[1]
        s[1,0,1,1]=(0.574370862223)*x[0]**o+(-0.666343550396)*x[0]+(0.955788950863)*x[1]**o+(-0.901731521626)*x[1]
        s[1,0,2,0]=(-0.0749607390632)*x[0]**o+(-0.431912603732)*x[0]+(-0.292096378559)*x[1]**o+(0.184727807798)*x[1]
        s[1,0,2,1]=(-0.680339079773)*x[0]**o+(-0.751178966013)*x[0]+(0.417442581996)*x[1]**o+(0.173275667315)*x[1]
        s[1,1,0,0]=(0.549976167744)*x[0]**o+(-0.542891673039)*x[0]+(0.780157563665)*x[1]**o+(-0.500193881521)*x[1]
        s[1,1,0,1]=(0.741392053681)*x[0]**o+(0.464245280846)*x[0]+(0.893822624677)*x[1]**o+(-0.726733112592)*x[1]
        s[1,1,1,0]=(0.0669632365681)*x[0]**o+(-0.19242503062)*x[0]+(-0.016747330039)*x[1]**o+(0.565528468045)*x[1]
        s[1,1,1,1]=(0.0478230922838)*x[0]**o+(-0.490882982306)*x[0]+(0.71464197649)*x[1]**o+(0.647758969096)*x[1]
        s[1,1,2,0]=(0.0459694337421)*x[0]**o+(0.22219598918)*x[0]+(0.278878633519)*x[1]**o+(0.0964919048896)*x[1]
        s[1,1,2,1]=(0.951517313537)*x[0]**o+(0.776873672124)*x[0]+(0.276827457342)*x[1]**o+(0.97564662187)*x[1]
        s[1,2,0,0]=(-0.756103809082)*x[0]**o+(-0.776671770692)*x[0]+(0.305546356471)*x[1]**o+(0.61267739505)*x[1]
        s[1,2,0,1]=(-0.00486328528121)*x[0]**o+(0.969855303757)*x[0]+(-0.803341508101)*x[1]**o+(-0.973192859371)*x[1]
        s[1,2,1,0]=(-0.233307547886)*x[0]**o+(0.480312206288)*x[0]+(-0.775060924028)*x[1]**o+(0.371008519793)*x[1]
        s[1,2,1,1]=(-0.548323703436)*x[0]**o+(-0.648506076259)*x[0]+(-0.175775778303)*x[1]**o+(0.860353396366)*x[1]
        s[1,2,2,0]=(-0.631591638879)*x[0]**o+(0.64118025586)*x[0]+(0.791112489411)*x[1]**o+(-0.503438016129)*x[1]
        s[1,2,2,1]=(-0.322064055084)*x[0]**o+(0.513203966068)*x[0]+(-0.123194392107)*x[1]**o+(-0.0530322384215)*x[1]
        s[1,3,0,0]=(0.690957542061)*x[0]**o+(0.582367141789)*x[0]+(0.0548888588807)*x[1]**o+(-0.396676526096)*x[1]
        s[1,3,0,1]=(-0.887786079331)*x[0]**o+(-0.595071924485)*x[0]+(-0.585573810513)*x[1]**o+(0.966304199567)*x[1]
        s[1,3,1,0]=(0.0813018143573)*x[0]**o+(-0.97460530802)*x[0]+(0.157284332761)*x[1]**o+(-0.282617607243)*x[1]
        s[1,3,1,1]=(0.876197676377)*x[0]**o+(-0.151980499847)*x[0]+(-0.605310496113)*x[1]**o+(-0.444245831277)*x[1]
        s[1,3,2,0]=(0.342314316145)*x[0]**o+(-0.448750580332)*x[0]+(0.42604855142)*x[1]**o+(0.646516588045)*x[1]
        s[1,3,2,1]=(0.740620038411)*x[0]**o+(-0.519019257788)*x[0]+(-0.625195631671)*x[1]**o+(0.0692954637811)*x[1]
        s[1,4,0,0]=(-0.444071318016)*x[0]**o+(-0.471544009206)*x[0]+(-0.696279794002)*x[1]**o+(-0.902974292958)*x[1]
        s[1,4,0,1]=(0.542533721359)*x[0]**o+(-0.0736449480756)*x[0]+(-0.408131697388)*x[1]**o+(0.364714013702)*x[1]
        s[1,4,1,0]=(-0.152939586181)*x[0]**o+(0.77896231429)*x[0]+(-0.815480658966)*x[1]**o+(0.154938953512)*x[1]
        s[1,4,1,1]=(-0.29007531171)*x[0]**o+(-0.352728646039)*x[0]+(0.811434496017)*x[1]**o+(0.738596503811)*x[1]
        s[1,4,2,0]=(0.219126056868)*x[0]**o+(-0.888054898232)*x[0]+(0.832367086102)*x[1]**o+(0.423282741614)*x[1]
        s[1,4,2,1]=(-0.0215001265455)*x[0]**o+(-0.267591836227)*x[0]+(0.16855162109)*x[1]**o+(0.450976714016)*x[1]
        s[2,0,0,0]=(0.55451395254)*x[0]**o+(-0.569774836527)*x[0]+(-0.950939837183)*x[1]**o+(0.963606409995)*x[1]
        s[2,0,0,1]=(0.768925257395)*x[0]**o+(-0.271693392598)*x[0]+(0.85042078878)*x[1]**o+(0.854821782113)*x[1]
        s[2,0,1,0]=(-0.0681124804964)*x[0]**o+(0.346262969724)*x[0]+(-0.224031702809)*x[1]**o+(0.184665191293)*x[1]
        s[2,0,1,1]=(0.215579225437)*x[0]**o+(0.650089014616)*x[0]+(-0.632072599272)*x[1]**o+(0.974448958372)*x[1]
        s[2,0,2,0]=(0.943481715059)*x[0]**o+(-0.91197962542)*x[0]+(-0.552378744981)*x[1]**o+(0.958940554729)*x[1]
        s[2,0,2,1]=(0.467266364031)*x[0]**o+(-0.253321061857)*x[0]+(0.935529481271)*x[1]**o+(-0.203578102406)*x[1]
        s[2,1,0,0]=(0.0885012656958)*x[0]**o+(-0.0568114758907)*x[0]+(-0.94244176099)*x[1]**o+(-0.151572915453)*x[1]
        s[2,1,0,1]=(-0.583513164141)*x[0]**o+(0.299189697674)*x[0]+(0.129798849695)*x[1]**o+(0.0486488675811)*x[1]
        s[2,1,1,0]=(-0.230047392884)*x[0]**o+(-0.215141703649)*x[0]+(0.597873677289)*x[1]**o+(-0.104893786277)*x[1]
        s[2,1,1,1]=(-0.193340204287)*x[0]**o+(0.172114988052)*x[0]+(-0.912123490435)*x[1]**o+(0.386237743741)*x[1]
        s[2,1,2,0]=(-0.355870799626)*x[0]**o+(-0.636394104532)*x[0]+(0.14161953364)*x[1]**o+(0.793881407217)*x[1]
        s[2,1,2,1]=(0.623415964738)*x[0]**o+(-0.441080834978)*x[0]+(-0.669760052979)*x[1]**o+(0.504915334197)*x[1]
        s[2,2,0,0]=(0.843403522019)*x[0]**o+(0.497098510545)*x[0]+(0.668852088742)*x[1]**o+(-0.469226675749)*x[1]
        s[2,2,0,1]=(-0.924635841352)*x[0]**o+(0.200500164001)*x[0]+(-0.230616017277)*x[1]**o+(0.758688672394)*x[1]
        s[2,2,1,0]=(-0.180287456852)*x[0]**o+(-0.189123451964)*x[0]+(-0.359118343342)*x[1]**o+(-0.856215073416)*x[1]
        s[2,2,1,1]=(-0.270882735947)*x[0]**o+(0.958913592886)*x[0]+(-0.694010263633)*x[1]**o+(0.860782778563)*x[1]
        s[2,2,2,0]=(-0.808819032861)*x[0]**o+(-0.733697428319)*x[0]+(-0.460941216629)*x[1]**o+(-0.617344596558)*x[1]
        s[2,2,2,1]=(0.451979026099)*x[0]**o+(-0.0858303927258)*x[0]+(0.163184369333)*x[1]**o+(0.801763368843)*x[1]
        s[2,3,0,0]=(-0.367005493485)*x[0]**o+(0.854411289003)*x[0]+(0.733528289773)*x[1]**o+(0.791392876143)*x[1]
        s[2,3,0,1]=(0.911579456326)*x[0]**o+(-0.690061379515)*x[0]+(-0.0831450710122)*x[1]**o+(-0.815038630875)*x[1]
        s[2,3,1,0]=(-0.179108077134)*x[0]**o+(0.609583032751)*x[0]+(-0.16765650892)*x[1]**o+(0.861847300762)*x[1]
        s[2,3,1,1]=(0.384373942853)*x[0]**o+(0.517209389691)*x[0]+(0.841154335433)*x[1]**o+(0.579356331563)*x[1]
        s[2,3,2,0]=(-0.683926277829)*x[0]**o+(0.315128536718)*x[0]+(0.394946403402)*x[1]**o+(0.679738641838)*x[1]
        s[2,3,2,1]=(0.466676304045)*x[0]**o+(-0.0400354010415)*x[0]+(-0.760865349977)*x[1]**o+(0.928180066121)*x[1]
        s[2,4,0,0]=(-0.497221654148)*x[0]**o+(-0.921245715417)*x[0]+(0.908610543692)*x[1]**o+(-0.662743777314)*x[1]
        s[2,4,0,1]=(-0.218025628376)*x[0]**o+(0.981616175697)*x[0]+(-0.300066300268)*x[1]**o+(-0.145065054659)*x[1]
        s[2,4,1,0]=(0.822321927296)*x[0]**o+(0.697029639265)*x[0]+(0.21672820186)*x[1]**o+(-0.136979319447)*x[1]
        s[2,4,1,1]=(-0.33254584204)*x[0]**o+(0.0804948126216)*x[0]+(0.931652185323)*x[1]**o+(-0.206973479206)*x[1]
        s[2,4,2,0]=(-0.20645245153)*x[0]**o+(0.183027858308)*x[0]+(-0.889749226799)*x[1]**o+(0.177254293812)*x[1]
        s[2,4,2,1]=(0.67936145385)*x[0]**o+(0.0269414327289)*x[0]+(-0.892654968646)*x[1]**o+(-0.211494218552)*x[1]
        s[3,0,0,0]=(-0.221318514547)*x[0]**o+(0.282480830569)*x[0]+(0.428045462357)*x[1]**o+(0.6335381978)*x[1]
        s[3,0,0,1]=(-0.052602851764)*x[0]**o+(-0.208342592426)*x[0]+(-0.518314637297)*x[1]**o+(0.0538977682478)*x[1]
        s[3,0,1,0]=(-0.879184433575)*x[0]**o+(-0.413590155319)*x[0]+(-0.973398939671)*x[1]**o+(0.880259070216)*x[1]
        s[3,0,1,1]=(-0.160095692245)*x[0]**o+(-0.215405690187)*x[0]+(0.049417328483)*x[1]**o+(0.755528105808)*x[1]
        s[3,0,2,0]=(0.0775811014995)*x[0]**o+(0.574331743034)*x[0]+(0.656316191524)*x[1]**o+(-0.485245137216)*x[1]
        s[3,0,2,1]=(0.235819746353)*x[0]**o+(-0.0212642690609)*x[0]+(0.519388187993)*x[1]**o+(-0.73686111506)*x[1]
        s[3,1,0,0]=(0.895857350075)*x[0]**o+(0.993441070954)*x[0]+(0.423289404334)*x[1]**o+(0.648503660982)*x[1]
        s[3,1,0,1]=(-0.508341685048)*x[0]**o+(0.132799887315)*x[0]+(-0.615279575964)*x[1]**o+(0.00296513970359)*x[1]
        s[3,1,1,0]=(0.691638662949)*x[0]**o+(-0.432982022284)*x[0]+(-0.724535941079)*x[1]**o+(0.0336147554659)*x[1]
        s[3,1,1,1]=(-0.431062234755)*x[0]**o+(-0.795503344318)*x[0]+(0.302222798071)*x[1]**o+(-0.0813627256685)*x[1]
        s[3,1,2,0]=(-0.695560929102)*x[0]**o+(0.328886265482)*x[0]+(-0.187761431398)*x[1]**o+(-0.997772947746)*x[1]
        s[3,1,2,1]=(0.551492819689)*x[0]**o+(0.00738597993558)*x[0]+(-0.920251030964)*x[1]**o+(-0.209623547453)*x[1]
        s[3,2,0,0]=(-0.945715173023)*x[0]**o+(-0.413860607376)*x[0]+(-0.0065717404946)*x[1]**o+(-0.340070315229)*x[1]
        s[3,2,0,1]=(-0.866814974957)*x[0]**o+(0.190612129778)*x[0]+(-0.323173980343)*x[1]**o+(-0.221048196515)*x[1]
        s[3,2,1,0]=(0.19860994374)*x[0]**o+(-0.521137863979)*x[0]+(-0.347340372612)*x[1]**o+(0.85944792998)*x[1]
        s[3,2,1,1]=(-0.128916019272)*x[0]**o+(-0.850906742746)*x[0]+(0.258631463969)*x[1]**o+(-0.201200252475)*x[1]
        s[3,2,2,0]=(-0.330614479011)*x[0]**o+(-0.489889065789)*x[0]+(-0.244206440351)*x[1]**o+(-0.322097122215)*x[1]
        s[3,2,2,1]=(0.711726054557)*x[0]**o+(0.63375724563)*x[0]+(-0.564782988704)*x[1]**o+(-0.110402977102)*x[1]
        s[3,3,0,0]=(0.994364369344)*x[0]**o+(-0.112814477225)*x[0]+(-0.277853585926)*x[1]**o+(0.952622614986)*x[1]
        s[3,3,0,1]=(-0.4170514524)*x[0]**o+(0.890841357027)*x[0]+(-0.821412916413)*x[1]**o+(0.795074763635)*x[1]
        s[3,3,1,0]=(-0.0247320805051)*x[0]**o+(-0.204605869304)*x[0]+(0.24262118978)*x[1]**o+(0.546548720614)*x[1]
        s[3,3,1,1]=(-0.474740509006)*x[0]**o+(-0.350277551474)*x[0]+(0.596007930161)*x[1]**o+(0.310969198868)*x[1]
        s[3,3,2,0]=(0.132049782738)*x[0]**o+(-0.913784955142)*x[0]+(-0.189796554115)*x[1]**o+(-0.0703212084825)*x[1]
        s[3,3,2,1]=(-0.831318298996)*x[0]**o+(0.759034430202)*x[0]+(-0.642082491468)*x[1]**o+(-0.0998337089515)*x[1]
        s[3,4,0,0]=(-0.947142357256)*x[0]**o+(-0.358864598356)*x[0]+(0.451923869609)*x[1]**o+(0.46347113305)*x[1]
        s[3,4,0,1]=(-0.935820217362)*x[0]**o+(-0.896350370731)*x[0]+(0.939373432056)*x[1]**o+(-0.367350815379)*x[1]
        s[3,4,1,0]=(0.217367733064)*x[0]**o+(-0.348603185172)*x[0]+(-0.846422979973)*x[1]**o+(0.466060007646)*x[1]
        s[3,4,1,1]=(-0.0861518225018)*x[0]**o+(0.129106551242)*x[0]+(-0.563717320923)*x[1]**o+(0.488814871115)*x[1]
        s[3,4,2,0]=(0.864238935579)*x[0]**o+(0.451518233825)*x[0]+(0.515184766232)*x[1]**o+(0.791632366311)*x[1]
        s[3,4,2,1]=(0.226031804126)*x[0]**o+(0.703010170609)*x[0]+(-0.694425471794)*x[1]**o+(-0.398984702926)*x[1]
        ref[0,0,0,0]=(-0.602693108429)*(1+2.*(dim-1.)/(o+1.))+(1.05672452179)*dim
        ref[0,0,0,1]=(-0.329659508496)*(1+2.*(dim-1.)/(o+1.))+(-0.674263446481)*dim
        ref[0,0,1,0]=(-0.360601283088)*(1+2.*(dim-1.)/(o+1.))+(-1.14755791899)*dim
        ref[0,0,1,1]=(-0.110507023967)*(1+2.*(dim-1.)/(o+1.))+(0.514600194196)*dim
        ref[0,0,2,0]=(0.812514871871)*(1+2.*(dim-1.)/(o+1.))+(1.18305915792)*dim
        ref[0,0,2,1]=(-0.791523451216)*(1+2.*(dim-1.)/(o+1.))+(-1.506462591)*dim
        ref[0,1,0,0]=(1.47040433943)*(1+2.*(dim-1.)/(o+1.))+(0.12417428593)*dim
        ref[0,1,0,1]=(1.00533693399)*(1+2.*(dim-1.)/(o+1.))+(-0.164188964721)*dim
        ref[0,1,1,0]=(0.0323584592913)*(1+2.*(dim-1.)/(o+1.))+(-0.270261859519)*dim
        ref[0,1,1,1]=(-0.620693174994)*(1+2.*(dim-1.)/(o+1.))+(-0.345535388304)*dim
        ref[0,1,2,0]=(0.320074545773)*(1+2.*(dim-1.)/(o+1.))+(-0.381380025289)*dim
        ref[0,1,2,1]=(-1.17878556248)*(1+2.*(dim-1.)/(o+1.))+(0.0459455019681)*dim
        ref[0,2,0,0]=(-0.618902034153)*(1+2.*(dim-1.)/(o+1.))+(0.518381675861)*dim
        ref[0,2,0,1]=(-0.794726682036)*(1+2.*(dim-1.)/(o+1.))+(0.476269656297)*dim
        ref[0,2,1,0]=(0.26513657471)*(1+2.*(dim-1.)/(o+1.))+(0.100200486644)*dim
        ref[0,2,1,1]=(-0.49946379621)*(1+2.*(dim-1.)/(o+1.))+(1.82742433373)*dim
        ref[0,2,2,0]=(-0.01683100468)*(1+2.*(dim-1.)/(o+1.))+(0.0391906091876)*dim
        ref[0,2,2,1]=(-1.45366611237)*(1+2.*(dim-1.)/(o+1.))+(0.668853165545)*dim
        ref[0,3,0,0]=(-0.46117352226)*(1+2.*(dim-1.)/(o+1.))+(-0.952688084773)*dim
        ref[0,3,0,1]=(-0.3671682698)*(1+2.*(dim-1.)/(o+1.))+(0.349000537927)*dim
        ref[0,3,1,0]=(-0.672309201811)*(1+2.*(dim-1.)/(o+1.))+(0.0474400320344)*dim
        ref[0,3,1,1]=(0.980030283663)*(1+2.*(dim-1.)/(o+1.))+(-0.529688617993)*dim
        ref[0,3,2,0]=(0.174621777527)*(1+2.*(dim-1.)/(o+1.))+(0.327562678035)*dim
        ref[0,3,2,1]=(0.0432775089146)*(1+2.*(dim-1.)/(o+1.))+(-0.707629698139)*dim
        ref[0,4,0,0]=(-0.942639157356)*(1+2.*(dim-1.)/(o+1.))+(0.0145050700714)*dim
        ref[0,4,0,1]=(-0.775138280415)*(1+2.*(dim-1.)/(o+1.))+(1.55625287556)*dim
        ref[0,4,1,0]=(-0.105281311512)*(1+2.*(dim-1.)/(o+1.))+(-0.215196105228)*dim
        ref[0,4,1,1]=(1.24545780789)*(1+2.*(dim-1.)/(o+1.))+(0.164266137253)*dim
        ref[0,4,2,0]=(-0.0858755761251)*(1+2.*(dim-1.)/(o+1.))+(0.289724100124)*dim
        ref[0,4,2,1]=(0.136757138309)*(1+2.*(dim-1.)/(o+1.))+(-0.677562904341)*dim
        ref[1,0,0,0]=(0.834345149656)*(1+2.*(dim-1.)/(o+1.))+(1.48916734586)*dim
        ref[1,0,0,1]=(-1.23605013646)*(1+2.*(dim-1.)/(o+1.))+(0.132926681249)*dim
        ref[1,0,1,0]=(-0.508730958477)*(1+2.*(dim-1.)/(o+1.))+(0.178104910863)*dim
        ref[1,0,1,1]=(1.53015981309)*(1+2.*(dim-1.)/(o+1.))+(-1.56807507202)*dim
        ref[1,0,2,0]=(-0.367057117622)*(1+2.*(dim-1.)/(o+1.))+(-0.247184795934)*dim
        ref[1,0,2,1]=(-0.262896497777)*(1+2.*(dim-1.)/(o+1.))+(-0.577903298697)*dim
        ref[1,1,0,0]=(1.33013373141)*(1+2.*(dim-1.)/(o+1.))+(-1.04308555456)*dim
        ref[1,1,0,1]=(1.63521467836)*(1+2.*(dim-1.)/(o+1.))+(-0.262487831746)*dim
        ref[1,1,1,0]=(0.0502159065291)*(1+2.*(dim-1.)/(o+1.))+(0.373103437426)*dim
        ref[1,1,1,1]=(0.762465068774)*(1+2.*(dim-1.)/(o+1.))+(0.15687598679)*dim
        ref[1,1,2,0]=(0.324848067261)*(1+2.*(dim-1.)/(o+1.))+(0.318687894069)*dim
        ref[1,1,2,1]=(1.22834477088)*(1+2.*(dim-1.)/(o+1.))+(1.75252029399)*dim
        ref[1,2,0,0]=(-0.450557452611)*(1+2.*(dim-1.)/(o+1.))+(-0.163994375642)*dim
        ref[1,2,0,1]=(-0.808204793382)*(1+2.*(dim-1.)/(o+1.))+(-0.00333755561452)*dim
        ref[1,2,1,0]=(-1.00836847191)*(1+2.*(dim-1.)/(o+1.))+(0.85132072608)*dim
        ref[1,2,1,1]=(-0.724099481739)*(1+2.*(dim-1.)/(o+1.))+(0.211847320106)*dim
        ref[1,2,2,0]=(0.159520850532)*(1+2.*(dim-1.)/(o+1.))+(0.137742239731)*dim
        ref[1,2,2,1]=(-0.44525844719)*(1+2.*(dim-1.)/(o+1.))+(0.460171727646)*dim
        ref[1,3,0,0]=(0.745846400942)*(1+2.*(dim-1.)/(o+1.))+(0.185690615693)*dim
        ref[1,3,0,1]=(-1.47335988984)*(1+2.*(dim-1.)/(o+1.))+(0.371232275082)*dim
        ref[1,3,1,0]=(0.238586147118)*(1+2.*(dim-1.)/(o+1.))+(-1.25722291526)*dim
        ref[1,3,1,1]=(0.270887180264)*(1+2.*(dim-1.)/(o+1.))+(-0.596226331125)*dim
        ref[1,3,2,0]=(0.768362867564)*(1+2.*(dim-1.)/(o+1.))+(0.197766007713)*dim
        ref[1,3,2,1]=(0.11542440674)*(1+2.*(dim-1.)/(o+1.))+(-0.449723794007)*dim
        ref[1,4,0,0]=(-1.14035111202)*(1+2.*(dim-1.)/(o+1.))+(-1.37451830216)*dim
        ref[1,4,0,1]=(0.134402023971)*(1+2.*(dim-1.)/(o+1.))+(0.291069065626)*dim
        ref[1,4,1,0]=(-0.968420245147)*(1+2.*(dim-1.)/(o+1.))+(0.933901267802)*dim
        ref[1,4,1,1]=(0.521359184306)*(1+2.*(dim-1.)/(o+1.))+(0.385867857771)*dim
        ref[1,4,2,0]=(1.05149314297)*(1+2.*(dim-1.)/(o+1.))+(-0.464772156618)*dim
        ref[1,4,2,1]=(0.147051494544)*(1+2.*(dim-1.)/(o+1.))+(0.183384877789)*dim
        ref[2,0,0,0]=(-0.396425884642)*(1+2.*(dim-1.)/(o+1.))+(0.393831573468)*dim
        ref[2,0,0,1]=(1.61934604618)*(1+2.*(dim-1.)/(o+1.))+(0.583128389514)*dim
        ref[2,0,1,0]=(-0.292144183305)*(1+2.*(dim-1.)/(o+1.))+(0.530928161018)*dim
        ref[2,0,1,1]=(-0.416493373835)*(1+2.*(dim-1.)/(o+1.))+(1.62453797299)*dim
        ref[2,0,2,0]=(0.391102970078)*(1+2.*(dim-1.)/(o+1.))+(0.0469609293089)*dim
        ref[2,0,2,1]=(1.4027958453)*(1+2.*(dim-1.)/(o+1.))+(-0.456899164263)*dim
        ref[2,1,0,0]=(-0.853940495294)*(1+2.*(dim-1.)/(o+1.))+(-0.208384391343)*dim
        ref[2,1,0,1]=(-0.453714314446)*(1+2.*(dim-1.)/(o+1.))+(0.347838565255)*dim
        ref[2,1,1,0]=(0.367826284405)*(1+2.*(dim-1.)/(o+1.))+(-0.320035489926)*dim
        ref[2,1,1,1]=(-1.10546369472)*(1+2.*(dim-1.)/(o+1.))+(0.558352731793)*dim
        ref[2,1,2,0]=(-0.214251265986)*(1+2.*(dim-1.)/(o+1.))+(0.157487302684)*dim
        ref[2,1,2,1]=(-0.046344088241)*(1+2.*(dim-1.)/(o+1.))+(0.0638344992189)*dim
        ref[2,2,0,0]=(1.51225561076)*(1+2.*(dim-1.)/(o+1.))+(0.0278718347964)*dim
        ref[2,2,0,1]=(-1.15525185863)*(1+2.*(dim-1.)/(o+1.))+(0.959188836395)*dim
        ref[2,2,1,0]=(-0.539405800194)*(1+2.*(dim-1.)/(o+1.))+(-1.04533852538)*dim
        ref[2,2,1,1]=(-0.96489299958)*(1+2.*(dim-1.)/(o+1.))+(1.81969637145)*dim
        ref[2,2,2,0]=(-1.26976024949)*(1+2.*(dim-1.)/(o+1.))+(-1.35104202488)*dim
        ref[2,2,2,1]=(0.615163395432)*(1+2.*(dim-1.)/(o+1.))+(0.715932976118)*dim
        ref[2,3,0,0]=(0.366522796287)*(1+2.*(dim-1.)/(o+1.))+(1.64580416515)*dim
        ref[2,3,0,1]=(0.828434385314)*(1+2.*(dim-1.)/(o+1.))+(-1.50510001039)*dim
        ref[2,3,1,0]=(-0.346764586054)*(1+2.*(dim-1.)/(o+1.))+(1.47143033351)*dim
        ref[2,3,1,1]=(1.22552827829)*(1+2.*(dim-1.)/(o+1.))+(1.09656572125)*dim
        ref[2,3,2,0]=(-0.288979874427)*(1+2.*(dim-1.)/(o+1.))+(0.994867178556)*dim
        ref[2,3,2,1]=(-0.294189045932)*(1+2.*(dim-1.)/(o+1.))+(0.88814466508)*dim
        ref[2,4,0,0]=(0.411388889544)*(1+2.*(dim-1.)/(o+1.))+(-1.58398949273)*dim
        ref[2,4,0,1]=(-0.518091928645)*(1+2.*(dim-1.)/(o+1.))+(0.836551121038)*dim
        ref[2,4,1,0]=(1.03905012916)*(1+2.*(dim-1.)/(o+1.))+(0.560050319818)*dim
        ref[2,4,1,1]=(0.599106343283)*(1+2.*(dim-1.)/(o+1.))+(-0.126478666584)*dim
        ref[2,4,2,0]=(-1.09620167833)*(1+2.*(dim-1.)/(o+1.))+(0.36028215212)*dim
        ref[2,4,2,1]=(-0.213293514797)*(1+2.*(dim-1.)/(o+1.))+(-0.184552785823)*dim
        ref[3,0,0,0]=(0.20672694781)*(1+2.*(dim-1.)/(o+1.))+(0.91601902837)*dim
        ref[3,0,0,1]=(-0.570917489061)*(1+2.*(dim-1.)/(o+1.))+(-0.154444824179)*dim
        ref[3,0,1,0]=(-1.85258337325)*(1+2.*(dim-1.)/(o+1.))+(0.466668914897)*dim
        ref[3,0,1,1]=(-0.110678363762)*(1+2.*(dim-1.)/(o+1.))+(0.540122415621)*dim
        ref[3,0,2,0]=(0.733897293024)*(1+2.*(dim-1.)/(o+1.))+(0.0890866058179)*dim
        ref[3,0,2,1]=(0.755207934346)*(1+2.*(dim-1.)/(o+1.))+(-0.758125384121)*dim
        ref[3,1,0,0]=(1.31914675441)*(1+2.*(dim-1.)/(o+1.))+(1.64194473194)*dim
        ref[3,1,0,1]=(-1.12362126101)*(1+2.*(dim-1.)/(o+1.))+(0.135765027019)*dim
        ref[3,1,1,0]=(-0.0328972781304)*(1+2.*(dim-1.)/(o+1.))+(-0.399367266818)*dim
        ref[3,1,1,1]=(-0.128839436684)*(1+2.*(dim-1.)/(o+1.))+(-0.876866069986)*dim
        ref[3,1,2,0]=(-0.8833223605)*(1+2.*(dim-1.)/(o+1.))+(-0.668886682264)*dim
        ref[3,1,2,1]=(-0.368758211275)*(1+2.*(dim-1.)/(o+1.))+(-0.202237567517)*dim
        ref[3,2,0,0]=(-0.952286913517)*(1+2.*(dim-1.)/(o+1.))+(-0.753930922605)*dim
        ref[3,2,0,1]=(-1.1899889553)*(1+2.*(dim-1.)/(o+1.))+(-0.030436066737)*dim
        ref[3,2,1,0]=(-0.148730428873)*(1+2.*(dim-1.)/(o+1.))+(0.338310066001)*dim
        ref[3,2,1,1]=(0.129715444697)*(1+2.*(dim-1.)/(o+1.))+(-1.05210699522)*dim
        ref[3,2,2,0]=(-0.574820919362)*(1+2.*(dim-1.)/(o+1.))+(-0.811986188004)*dim
        ref[3,2,2,1]=(0.146943065853)*(1+2.*(dim-1.)/(o+1.))+(0.523354268528)*dim
        ref[3,3,0,0]=(0.716510783419)*(1+2.*(dim-1.)/(o+1.))+(0.839808137761)*dim
        ref[3,3,0,1]=(-1.23846436881)*(1+2.*(dim-1.)/(o+1.))+(1.68591612066)*dim
        ref[3,3,1,0]=(0.217889109275)*(1+2.*(dim-1.)/(o+1.))+(0.34194285131)*dim
        ref[3,3,1,1]=(0.121267421155)*(1+2.*(dim-1.)/(o+1.))+(-0.0393083526063)*dim
        ref[3,3,2,0]=(-0.0577467713773)*(1+2.*(dim-1.)/(o+1.))+(-0.984106163624)*dim
        ref[3,3,2,1]=(-1.47340079046)*(1+2.*(dim-1.)/(o+1.))+(0.65920072125)*dim
        ref[3,4,0,0]=(-0.495218487647)*(1+2.*(dim-1.)/(o+1.))+(0.104606534694)*dim
        ref[3,4,0,1]=(0.00355321469463)*(1+2.*(dim-1.)/(o+1.))+(-1.26370118611)*dim
        ref[3,4,1,0]=(-0.629055246908)*(1+2.*(dim-1.)/(o+1.))+(0.117456822474)*dim
        ref[3,4,1,1]=(-0.649869143425)*(1+2.*(dim-1.)/(o+1.))+(0.617921422357)*dim
        ref[3,4,2,0]=(1.37942370181)*(1+2.*(dim-1.)/(o+1.))+(1.24315060014)*dim
        ref[3,4,2,1]=(-0.468393667668)*(1+2.*(dim-1.)/(o+1.))+(0.304025467684)*dim
      else:
        s[0,0,0,0]=(0.265353968453)*x[0]**o+(-0.988400050542)*x[0]+(0.915581496138)*x[1]**o+(-0.532717689852)*x[1]+(-0.326369232123)*x[2]**o+(-0.751181530498)*x[2]
        s[0,0,0,1]=(-0.700652623793)*x[0]**o+(0.385185933969)*x[0]+(0.213605768081)*x[1]**o+(-0.626286949699)*x[1]+(-0.502285730612)*x[2]**o+(-0.510666455487)*x[2]
        s[0,0,1,0]=(0.662622398823)*x[0]**o+(0.682570980418)*x[0]+(-0.888940566008)*x[1]**o+(0.917775368899)*x[1]+(0.397316182924)*x[2]**o+(0.470957649176)*x[2]
        s[0,0,1,1]=(0.506440820988)*x[0]**o+(0.548696583948)*x[0]+(-0.343755749097)*x[1]**o+(0.635493528274)*x[1]+(0.96169367604)*x[2]**o+(-0.814595321216)*x[2]
        s[0,0,2,0]=(0.0897565668909)*x[0]**o+(-0.707489384492)*x[0]+(0.852406382045)*x[1]**o+(0.264605905284)*x[1]+(-0.76680872637)*x[2]**o+(-0.607486929359)*x[2]
        s[0,0,2,1]=(-0.491708830409)*x[0]**o+(-0.917156620819)*x[0]+(0.138490412136)*x[1]**o+(0.445788359479)*x[1]+(0.660215675311)*x[2]**o+(-0.124958885809)*x[2]
        s[0,1,0,0]=(0.252227873704)*x[0]**o+(-0.268708653921)*x[0]+(-0.735320913237)*x[1]**o+(0.832659354382)*x[1]+(-0.503570989065)*x[2]**o+(-0.416695426775)*x[2]
        s[0,1,0,1]=(0.992266568089)*x[0]**o+(-0.553995410037)*x[0]+(-0.94305015981)*x[1]**o+(-0.277660590986)*x[1]+(-0.106619424885)*x[2]**o+(-0.641996454178)*x[2]
        s[0,1,1,0]=(0.346537921137)*x[0]**o+(-0.752921521456)*x[0]+(0.697296847348)*x[1]**o+(0.127827995978)*x[1]+(-0.024787761696)*x[2]**o+(-0.132279656336)*x[2]
        s[0,1,1,1]=(0.838216254144)*x[0]**o+(-0.0488544208848)*x[0]+(0.618848880659)*x[1]**o+(-0.962908419156)*x[1]+(-0.67378264273)*x[2]**o+(-0.206991847936)*x[2]
        s[0,1,2,0]=(0.41676085558)*x[0]**o+(-0.214807189212)*x[0]+(0.291507151171)*x[1]**o+(0.668437674897)*x[1]+(0.244072891194)*x[2]**o+(0.259834097546)*x[2]
        s[0,1,2,1]=(-0.181271253302)*x[0]**o+(-0.120474808334)*x[0]+(0.996200217415)*x[1]**o+(0.964447373929)*x[1]+(0.642033792194)*x[2]**o+(0.737708747193)*x[2]
        s[0,2,0,0]=(-0.792103621996)*x[0]**o+(-0.688217283375)*x[0]+(0.672498785205)*x[1]**o+(-0.653725451669)*x[1]+(0.184442483292)*x[2]**o+(-0.532250028625)*x[2]
        s[0,2,0,1]=(-0.535900645063)*x[0]**o+(0.910701730932)*x[0]+(-0.942492793063)*x[1]**o+(0.840681049537)*x[1]+(0.717504040832)*x[2]**o+(0.325490269912)*x[2]
        s[0,2,1,0]=(-0.337864688224)*x[0]**o+(0.746375970396)*x[0]+(0.747732580426)*x[1]**o+(-0.282770683276)*x[1]+(-0.790443829627)*x[2]**o+(0.719617282434)*x[2]
        s[0,2,1,1]=(0.288927362375)*x[0]**o+(-0.11015159228)*x[0]+(-0.840599795558)*x[1]**o+(0.400589417352)*x[1]+(0.651562852697)*x[2]**o+(0.472103872054)*x[2]
        s[0,2,2,0]=(0.759453740866)*x[0]**o+(0.764211886443)*x[0]+(-0.596686471329)*x[1]**o+(-0.305500139463)*x[1]+(0.644132204372)*x[2]**o+(0.409169518907)*x[2]
        s[0,2,2,1]=(0.310393680205)*x[0]**o+(-0.55096306264)*x[0]+(-0.0418723645688)*x[1]**o+(0.146737303429)*x[1]+(-0.221068515058)*x[2]**o+(0.347847681074)*x[2]
        s[0,3,0,0]=(-0.121018382943)*x[0]**o+(-0.828966827969)*x[0]+(-0.579574647427)*x[1]**o+(0.505540315546)*x[1]+(0.846008555599)*x[2]**o+(0.722616724538)*x[2]
        s[0,3,0,1]=(0.764966634503)*x[0]**o+(0.0406308216785)*x[0]+(0.627462444709)*x[1]**o+(-0.458074562731)*x[1]+(0.868715029031)*x[2]**o+(-0.326046950875)*x[2]
        s[0,3,1,0]=(0.88733222894)*x[0]**o+(0.199875300475)*x[0]+(0.929525862041)*x[1]**o+(0.280705926018)*x[1]+(-0.85604411697)*x[2]**o+(-0.509002674462)*x[2]
        s[0,3,1,1]=(0.178137426708)*x[0]**o+(0.0040475349026)*x[0]+(0.606739420029)*x[1]**o+(-0.399120462352)*x[1]+(0.688376909613)*x[2]**o+(-0.204172031563)*x[2]
        s[0,3,2,0]=(-0.55097942154)*x[0]**o+(0.518240585643)*x[0]+(0.809100524171)*x[1]**o+(0.309535824824)*x[1]+(0.824892877333)*x[2]**o+(-0.580350157914)*x[2]
        s[0,3,2,1]=(-0.429643456007)*x[0]**o+(0.683690075983)*x[0]+(-0.474187287962)*x[1]**o+(-0.641084362835)*x[1]+(-0.514804055536)*x[2]**o+(0.653494101426)*x[2]
        s[0,4,0,0]=(0.759632202933)*x[0]**o+(-0.953554006806)*x[0]+(-0.564086866677)*x[1]**o+(-0.78087231593)*x[1]+(-0.589063170649)*x[2]**o+(-0.569522356624)*x[2]
        s[0,4,0,1]=(-0.440639409356)*x[0]**o+(-0.887245582242)*x[0]+(-0.731777330438)*x[1]**o+(0.678481115368)*x[1]+(-0.234694289692)*x[2]**o+(-0.481669499353)*x[2]
        s[0,4,1,0]=(0.421338590919)*x[0]**o+(-0.710549762367)*x[0]+(-0.831562216016)*x[1]**o+(0.526145415136)*x[1]+(-0.228391513851)*x[2]**o+(-0.287603858419)*x[2]
        s[0,4,1,1]=(-0.394922177529)*x[0]**o+(-0.749933015384)*x[0]+(0.501851406608)*x[1]**o+(0.414942993798)*x[1]+(0.882492276774)*x[2]**o+(-0.417451715702)*x[2]
        s[0,4,2,0]=(-0.708380417114)*x[0]**o+(0.272117639041)*x[0]+(-0.914251681965)*x[1]**o+(-0.692698068557)*x[1]+(0.740875968835)*x[2]**o+(0.0816142773216)*x[2]
        s[0,4,2,1]=(-0.781489599785)*x[0]**o+(-0.688587387866)*x[0]+(-0.8249818093)*x[1]**o+(0.479876441134)*x[1]+(-0.726425081108)*x[2]**o+(0.467932761023)*x[2]
        s[1,0,0,0]=(0.342121912006)*x[0]**o+(0.136682990021)*x[0]+(0.181997624536)*x[1]**o+(0.168026470492)*x[1]+(0.0115668517645)*x[2]**o+(-0.0377932582246)*x[2]
        s[1,0,0,1]=(-0.377080344591)*x[0]**o+(0.874997839577)*x[0]+(0.998952980553)*x[1]**o+(-0.511330536046)*x[1]+(0.845159267663)*x[2]**o+(0.0349344413329)*x[2]
        s[1,0,1,0]=(0.376824814933)*x[0]**o+(-0.58697348357)*x[0]+(0.764173288619)*x[1]**o+(0.288509758241)*x[1]+(-0.818987335991)*x[2]**o+(0.433785438733)*x[2]
        s[1,0,1,1]=(-0.923417677759)*x[0]**o+(0.703237676923)*x[0]+(-0.0963613139466)*x[1]**o+(0.648863487662)*x[1]+(0.121038690293)*x[2]**o+(-0.428707341383)*x[2]
        s[1,0,2,0]=(-0.192698196902)*x[0]**o+(-0.45684016542)*x[0]+(-0.157529151044)*x[1]**o+(0.665508784857)*x[1]+(-0.0263995814254)*x[2]**o+(-0.711087191185)*x[2]
        s[1,0,2,1]=(-0.262702009507)*x[0]**o+(0.612242386787)*x[0]+(-0.0527177865241)*x[1]**o+(-0.946597487364)*x[1]+(0.683034847912)*x[2]**o+(0.447810652774)*x[2]
        s[1,1,0,0]=(0.0954675694985)*x[0]**o+(-0.692307292788)*x[0]+(0.682808081853)*x[1]**o+(-0.602155379721)*x[1]+(-0.804568326115)*x[2]**o+(0.6383976993)*x[2]
        s[1,1,0,1]=(-0.776359536583)*x[0]**o+(0.593053796057)*x[0]+(-0.560010245091)*x[1]**o+(-0.0167025681078)*x[1]+(0.189236205132)*x[2]**o+(0.625263059129)*x[2]
        s[1,1,1,0]=(-0.294839786045)*x[0]**o+(0.318602896219)*x[0]+(0.790859996391)*x[1]**o+(-0.100239676238)*x[1]+(-0.752119733912)*x[2]**o+(0.909827281572)*x[2]
        s[1,1,1,1]=(0.427920987151)*x[0]**o+(0.0579828435662)*x[0]+(-0.805648184456)*x[1]**o+(0.545638930222)*x[1]+(-0.333821427396)*x[2]**o+(0.489029035079)*x[2]
        s[1,1,2,0]=(-0.102211826161)*x[0]**o+(-0.23589775753)*x[0]+(0.194344132247)*x[1]**o+(0.216623239742)*x[1]+(-0.328848234996)*x[2]**o+(-0.35246467614)*x[2]
        s[1,1,2,1]=(-0.597326323585)*x[0]**o+(-0.727893394493)*x[0]+(-0.219786140301)*x[1]**o+(-0.261271587677)*x[1]+(0.433015479844)*x[2]**o+(0.480572847641)*x[2]
        s[1,2,0,0]=(0.978638976517)*x[0]**o+(0.252195213856)*x[0]+(-0.534544050017)*x[1]**o+(-0.0719497516536)*x[1]+(0.0756026756135)*x[2]**o+(-0.376095264735)*x[2]
        s[1,2,0,1]=(-0.592591339778)*x[0]**o+(-0.87353085535)*x[0]+(0.226804211947)*x[1]**o+(0.257318409091)*x[1]+(0.820507252476)*x[2]**o+(0.490297079988)*x[2]
        s[1,2,1,0]=(0.157573169077)*x[0]**o+(0.128029582112)*x[0]+(-0.954106083921)*x[1]**o+(0.509373015197)*x[1]+(0.788827839704)*x[2]**o+(0.717054840575)*x[2]
        s[1,2,1,1]=(-0.47425212595)*x[0]**o+(-0.608889999781)*x[0]+(-0.334194651773)*x[1]**o+(-0.439282037399)*x[1]+(-0.169103982018)*x[2]**o+(-0.569343903254)*x[2]
        s[1,2,2,0]=(0.686390790562)*x[0]**o+(0.670565132214)*x[0]+(-0.491526583908)*x[1]**o+(-0.887969445154)*x[1]+(0.666707124541)*x[2]**o+(-0.643899609236)*x[2]
        s[1,2,2,1]=(0.158400774071)*x[0]**o+(0.672487819329)*x[0]+(-0.397304779942)*x[1]**o+(0.454998380713)*x[1]+(-0.571811342108)*x[2]**o+(0.294069278512)*x[2]
        s[1,3,0,0]=(-0.652264634829)*x[0]**o+(-0.676541910532)*x[0]+(-0.455722985275)*x[1]**o+(-0.25957175602)*x[1]+(0.619181596074)*x[2]**o+(0.305382546067)*x[2]
        s[1,3,0,1]=(0.958823451851)*x[0]**o+(-0.978084662344)*x[0]+(-0.276737082098)*x[1]**o+(-0.117588783747)*x[1]+(0.61233901794)*x[2]**o+(-0.430645122164)*x[2]
        s[1,3,1,0]=(0.17639490062)*x[0]**o+(-0.072015890916)*x[0]+(-0.0776296985656)*x[1]**o+(0.92506693456)*x[1]+(-0.228890114078)*x[2]**o+(-0.817012691208)*x[2]
        s[1,3,1,1]=(-0.0124492438715)*x[0]**o+(-0.291955568984)*x[0]+(-0.701102657404)*x[1]**o+(0.149273972357)*x[1]+(-0.521101405472)*x[2]**o+(0.183603155794)*x[2]
        s[1,3,2,0]=(0.12397369853)*x[0]**o+(0.436139768082)*x[0]+(0.523613099442)*x[1]**o+(0.0273767825371)*x[1]+(0.4825934187)*x[2]**o+(-0.261047164188)*x[2]
        s[1,3,2,1]=(-0.253163229158)*x[0]**o+(-0.190716207327)*x[0]+(0.104639827693)*x[1]**o+(-0.868381858703)*x[1]+(-0.439763792231)*x[2]**o+(-0.799113479705)*x[2]
        s[1,4,0,0]=(-0.304838319461)*x[0]**o+(0.701590180772)*x[0]+(-0.110558497315)*x[1]**o+(-0.893822894679)*x[1]+(-0.787583691318)*x[2]**o+(-0.89265767325)*x[2]
        s[1,4,0,1]=(0.184781667393)*x[0]**o+(0.00115077722427)*x[0]+(-0.301829747192)*x[1]**o+(0.492639963911)*x[1]+(-0.828978825155)*x[2]**o+(0.528275593254)*x[2]
        s[1,4,1,0]=(0.42616420927)*x[0]**o+(-0.473452048931)*x[0]+(0.756413372908)*x[1]**o+(-0.875430941202)*x[1]+(-0.440394982498)*x[2]**o+(0.387473346762)*x[2]
        s[1,4,1,1]=(-0.974545673815)*x[0]**o+(-0.583230191948)*x[0]+(-0.8604375003)*x[1]**o+(0.792666394984)*x[1]+(0.712418702968)*x[2]**o+(-0.635993401114)*x[2]
        s[1,4,2,0]=(0.898921012186)*x[0]**o+(0.31154532209)*x[0]+(0.100106723409)*x[1]**o+(0.510220124566)*x[1]+(-0.694976306736)*x[2]**o+(0.744462320672)*x[2]
        s[1,4,2,1]=(0.208678468389)*x[0]**o+(-0.029704981412)*x[0]+(-0.709792226721)*x[1]**o+(0.978207622687)*x[1]+(-0.94268835481)*x[2]**o+(0.983998190279)*x[2]
        s[2,0,0,0]=(-0.117454131321)*x[0]**o+(0.325178166996)*x[0]+(-0.955591553442)*x[1]**o+(-0.893511287203)*x[1]+(-0.992448477236)*x[2]**o+(-0.314767960841)*x[2]
        s[2,0,0,1]=(-0.215442066237)*x[0]**o+(0.199095086203)*x[0]+(-0.948101787926)*x[1]**o+(0.833921396167)*x[1]+(-0.945489620081)*x[2]**o+(-0.836168838947)*x[2]
        s[2,0,1,0]=(-0.0147045046721)*x[0]**o+(0.910556812541)*x[0]+(-0.854656661853)*x[1]**o+(0.603960686575)*x[1]+(-0.110464227264)*x[2]**o+(-0.654514120746)*x[2]
        s[2,0,1,1]=(0.12588483106)*x[0]**o+(0.741103813876)*x[0]+(0.273343918839)*x[1]**o+(-0.0496068521746)*x[1]+(0.851852637841)*x[2]**o+(0.513176454441)*x[2]
        s[2,0,2,0]=(-0.949030805361)*x[0]**o+(-0.186923222351)*x[0]+(-0.469739120295)*x[1]**o+(-0.667688306186)*x[1]+(0.561259377808)*x[2]**o+(-0.455307474368)*x[2]
        s[2,0,2,1]=(0.50289454022)*x[0]**o+(0.601455959785)*x[0]+(-0.359319458876)*x[1]**o+(-0.252866723971)*x[1]+(-0.232113717554)*x[2]**o+(-0.923251891682)*x[2]
        s[2,1,0,0]=(0.087617991436)*x[0]**o+(0.825668089054)*x[0]+(-0.246279274065)*x[1]**o+(0.427961138603)*x[1]+(0.134574297189)*x[2]**o+(0.126692670762)*x[2]
        s[2,1,0,1]=(0.618759834233)*x[0]**o+(-0.986840591193)*x[0]+(-0.356764253448)*x[1]**o+(0.861294268808)*x[1]+(0.329156660561)*x[2]**o+(0.454768559063)*x[2]
        s[2,1,1,0]=(0.0592587565219)*x[0]**o+(0.658218480064)*x[0]+(-0.605532183319)*x[1]**o+(0.628709371911)*x[1]+(-0.755778976293)*x[2]**o+(0.200067133647)*x[2]
        s[2,1,1,1]=(0.60715871142)*x[0]**o+(0.119152257078)*x[0]+(-0.456685613073)*x[1]**o+(-0.431830986012)*x[1]+(-0.239978100497)*x[2]**o+(-0.272134038408)*x[2]
        s[2,1,2,0]=(0.313930291609)*x[0]**o+(-0.0335423445806)*x[0]+(0.329631545985)*x[1]**o+(0.578422305734)*x[1]+(0.428275935457)*x[2]**o+(0.0754231472821)*x[2]
        s[2,1,2,1]=(0.95215367321)*x[0]**o+(-0.395110969421)*x[0]+(0.186889413454)*x[1]**o+(-0.211320210609)*x[1]+(-0.950278722072)*x[2]**o+(-0.111767520683)*x[2]
        s[2,2,0,0]=(-0.928704839938)*x[0]**o+(0.856077241772)*x[0]+(-0.0417301431511)*x[1]**o+(-0.76181987359)*x[1]+(-0.992155226136)*x[2]**o+(-0.776267895931)*x[2]
        s[2,2,0,1]=(-0.969248181097)*x[0]**o+(0.245775588093)*x[0]+(-0.505906920175)*x[1]**o+(0.146641331232)*x[1]+(-0.262102422862)*x[2]**o+(-0.561207377079)*x[2]
        s[2,2,1,0]=(-0.718472022429)*x[0]**o+(0.439297055455)*x[0]+(-0.852005557298)*x[1]**o+(0.504211693582)*x[1]+(-0.126256957345)*x[2]**o+(0.20236075339)*x[2]
        s[2,2,1,1]=(-0.547818793062)*x[0]**o+(-0.550864012953)*x[0]+(-0.87720186351)*x[1]**o+(0.962779562428)*x[1]+(-0.663892241535)*x[2]**o+(0.826235643802)*x[2]
        s[2,2,2,0]=(0.619652835608)*x[0]**o+(-0.418942285364)*x[0]+(0.407390229096)*x[1]**o+(0.999750598891)*x[1]+(0.826445107816)*x[2]**o+(-0.827613183804)*x[2]
        s[2,2,2,1]=(0.742447797718)*x[0]**o+(-0.135700593818)*x[0]+(0.691148074885)*x[1]**o+(-0.457826189496)*x[1]+(0.256017777404)*x[2]**o+(-0.165702500648)*x[2]
        s[2,3,0,0]=(-0.43784392872)*x[0]**o+(0.16925005364)*x[0]+(-0.659181589908)*x[1]**o+(0.675362824639)*x[1]+(-0.577126041428)*x[2]**o+(-0.506716255511)*x[2]
        s[2,3,0,1]=(-0.216143074446)*x[0]**o+(0.437507580615)*x[0]+(0.401331581783)*x[1]**o+(0.689412723355)*x[1]+(0.8762344674)*x[2]**o+(-0.582543733655)*x[2]
        s[2,3,1,0]=(0.0788197892383)*x[0]**o+(0.417141756193)*x[0]+(-0.253190931158)*x[1]**o+(0.409575699654)*x[1]+(0.514494619825)*x[2]**o+(0.399143793546)*x[2]
        s[2,3,1,1]=(-0.719766785708)*x[0]**o+(-0.620867182386)*x[0]+(-0.0490130572844)*x[1]**o+(0.5158062442)*x[1]+(0.871371891386)*x[2]**o+(0.568994700919)*x[2]
        s[2,3,2,0]=(0.076389643296)*x[0]**o+(0.508512060622)*x[0]+(-0.78737605411)*x[1]**o+(-0.00342872062952)*x[1]+(-0.659245059343)*x[2]**o+(-0.265456383349)*x[2]
        s[2,3,2,1]=(0.5875893363)*x[0]**o+(-0.718091321577)*x[0]+(-0.801865283024)*x[1]**o+(-0.908030358815)*x[1]+(0.431675901356)*x[2]**o+(-0.819466399747)*x[2]
        s[2,4,0,0]=(0.67994234014)*x[0]**o+(0.0421294866201)*x[0]+(0.914156657838)*x[1]**o+(0.631988857673)*x[1]+(-0.731815343643)*x[2]**o+(-0.226439431169)*x[2]
        s[2,4,0,1]=(0.382719860981)*x[0]**o+(0.0998281702684)*x[0]+(-0.191692152755)*x[1]**o+(-0.632487629935)*x[1]+(-0.47197856624)*x[2]**o+(0.743041964659)*x[2]
        s[2,4,1,0]=(-0.766894309495)*x[0]**o+(0.66365148919)*x[0]+(-0.985125550604)*x[1]**o+(0.977558230989)*x[1]+(-0.786405168576)*x[2]**o+(-0.586888601056)*x[2]
        s[2,4,1,1]=(-0.408491721685)*x[0]**o+(-0.485042299377)*x[0]+(0.0342771405689)*x[1]**o+(-0.0281888804188)*x[1]+(-0.100567975294)*x[2]**o+(0.16781221998)*x[2]
        s[2,4,2,0]=(0.655177009817)*x[0]**o+(0.599751578479)*x[0]+(-0.69519370742)*x[1]**o+(0.765111933279)*x[1]+(-0.600152872818)*x[2]**o+(0.933762224073)*x[2]
        s[2,4,2,1]=(-0.783402080781)*x[0]**o+(0.497892410534)*x[0]+(-0.896301612142)*x[1]**o+(-0.624692866087)*x[1]+(0.384092901066)*x[2]**o+(0.103876065891)*x[2]
        s[3,0,0,0]=(0.727781520125)*x[0]**o+(0.516411031951)*x[0]+(0.520409588798)*x[1]**o+(0.203314941059)*x[1]+(-0.72359147418)*x[2]**o+(0.766852866118)*x[2]
        s[3,0,0,1]=(-0.0843842205054)*x[0]**o+(-0.270711183223)*x[0]+(-0.235601047175)*x[1]**o+(-0.820277497036)*x[1]+(-0.466133585852)*x[2]**o+(0.155997468178)*x[2]
        s[3,0,1,0]=(-0.951270599262)*x[0]**o+(-0.313463217212)*x[0]+(-0.166446810677)*x[1]**o+(0.0311582608036)*x[1]+(-0.143475616634)*x[2]**o+(-0.174089420721)*x[2]
        s[3,0,1,1]=(0.31005632514)*x[0]**o+(-0.473374219519)*x[0]+(0.922718547121)*x[1]**o+(0.354849506312)*x[1]+(0.466885594274)*x[2]**o+(-0.0545966611475)*x[2]
        s[3,0,2,0]=(0.0930631890409)*x[0]**o+(0.238199576739)*x[0]+(0.785659372495)*x[1]**o+(-0.381418540402)*x[1]+(-0.372849688379)*x[2]**o+(-0.550096690451)*x[2]
        s[3,0,2,1]=(-0.0488046933792)*x[0]**o+(-0.85673228641)*x[0]+(-0.888414982245)*x[1]**o+(-0.733480030742)*x[1]+(-0.138791373365)*x[2]**o+(-0.0428634394828)*x[2]
        s[3,1,0,0]=(0.431582682868)*x[0]**o+(0.997952021577)*x[0]+(-0.586523128595)*x[1]**o+(-0.38366122568)*x[1]+(-0.966801100136)*x[2]**o+(-0.814601474666)*x[2]
        s[3,1,0,1]=(0.51469888558)*x[0]**o+(0.852630560538)*x[0]+(-0.431644582882)*x[1]**o+(0.612002981263)*x[1]+(-0.824898907932)*x[2]**o+(0.740125311337)*x[2]
        s[3,1,1,0]=(-0.998816511903)*x[0]**o+(0.501436620365)*x[0]+(-0.876369817412)*x[1]**o+(-0.751901171932)*x[1]+(-0.127524412151)*x[2]**o+(0.556578788174)*x[2]
        s[3,1,1,1]=(0.494572326989)*x[0]**o+(-0.4109962303)*x[0]+(0.332604369701)*x[1]**o+(0.144741772456)*x[1]+(-0.356738712921)*x[2]**o+(-0.930461094693)*x[2]
        s[3,1,2,0]=(0.298299420769)*x[0]**o+(0.465301670992)*x[0]+(-0.625366287818)*x[1]**o+(0.617300960428)*x[1]+(-0.0218635106247)*x[2]**o+(-0.400465814843)*x[2]
        s[3,1,2,1]=(-0.269730676738)*x[0]**o+(0.385672666629)*x[0]+(0.0768574834461)*x[1]**o+(-0.946466342247)*x[1]+(-0.46039524704)*x[2]**o+(-0.092664263096)*x[2]
        s[3,2,0,0]=(0.461319900449)*x[0]**o+(0.894479535569)*x[0]+(-0.331082415608)*x[1]**o+(0.40219970326)*x[1]+(-0.45348751543)*x[2]**o+(0.344838434995)*x[2]
        s[3,2,0,1]=(0.555684742117)*x[0]**o+(0.140415098553)*x[0]+(-0.53477167757)*x[1]**o+(-0.365761904777)*x[1]+(0.96328384437)*x[2]**o+(0.619810575276)*x[2]
        s[3,2,1,0]=(-0.14916965531)*x[0]**o+(0.889806300338)*x[0]+(-0.456091691059)*x[1]**o+(0.532621704874)*x[1]+(0.329988274366)*x[2]**o+(0.800234733169)*x[2]
        s[3,2,1,1]=(0.380606552573)*x[0]**o+(-0.541127952834)*x[0]+(-0.851396276663)*x[1]**o+(0.166128704099)*x[1]+(-0.575246273865)*x[2]**o+(-0.438073609497)*x[2]
        s[3,2,2,0]=(0.845014379056)*x[0]**o+(-0.812352254049)*x[0]+(0.0324309664699)*x[1]**o+(0.558811307761)*x[1]+(-0.865143597202)*x[2]**o+(-0.755672880303)*x[2]
        s[3,2,2,1]=(0.5343293465)*x[0]**o+(-0.840117005289)*x[0]+(-0.30550028433)*x[1]**o+(0.951726967137)*x[1]+(0.469519945822)*x[2]**o+(0.748837114445)*x[2]
        s[3,3,0,0]=(-0.885008843023)*x[0]**o+(-0.170701893945)*x[0]+(-0.374063979126)*x[1]**o+(-0.30389599708)*x[1]+(-0.661322095381)*x[2]**o+(0.838294065739)*x[2]
        s[3,3,0,1]=(0.854428192443)*x[0]**o+(0.2166993324)*x[0]+(0.43944583933)*x[1]**o+(-0.858798284298)*x[1]+(-0.84436470857)*x[2]**o+(-0.567545786739)*x[2]
        s[3,3,1,0]=(0.66702962158)*x[0]**o+(0.720100651321)*x[0]+(0.0956882490639)*x[1]**o+(0.0372232762552)*x[1]+(-0.67009655948)*x[2]**o+(-0.569854055098)*x[2]
        s[3,3,1,1]=(0.146466946465)*x[0]**o+(0.164924499496)*x[0]+(-0.2972769793)*x[1]**o+(0.865363847078)*x[1]+(-0.180431004392)*x[2]**o+(0.265225273207)*x[2]
        s[3,3,2,0]=(-0.830402000378)*x[0]**o+(-0.00161430224161)*x[0]+(-0.863095020073)*x[1]**o+(0.922102273263)*x[1]+(0.385860222623)*x[2]**o+(0.981756782753)*x[2]
        s[3,3,2,1]=(0.567277892172)*x[0]**o+(0.78766223915)*x[0]+(0.412870235103)*x[1]**o+(0.46588554159)*x[1]+(0.716230666858)*x[2]**o+(0.425979074273)*x[2]
        s[3,4,0,0]=(0.679938424982)*x[0]**o+(0.508093418021)*x[0]+(-0.73945776378)*x[1]**o+(-0.178938904098)*x[1]+(0.996547500259)*x[2]**o+(-0.689147793037)*x[2]
        s[3,4,0,1]=(-0.181577713519)*x[0]**o+(-0.413066527133)*x[0]+(0.83941283649)*x[1]**o+(-0.664951450375)*x[1]+(0.993705498629)*x[2]**o+(-0.483417137243)*x[2]
        s[3,4,1,0]=(0.328862164768)*x[0]**o+(0.869116819138)*x[0]+(-0.8079517423)*x[1]**o+(-0.692894104885)*x[1]+(-0.407582178576)*x[2]**o+(0.437242243866)*x[2]
        s[3,4,1,1]=(0.512281196984)*x[0]**o+(-0.155819537445)*x[0]+(0.693970927236)*x[1]**o+(0.785297186585)*x[1]+(-0.514686313027)*x[2]**o+(-0.474084873678)*x[2]
        s[3,4,2,0]=(0.225627329646)*x[0]**o+(0.247722481758)*x[0]+(0.88743622494)*x[1]**o+(-0.953008640988)*x[1]+(-0.428243081608)*x[2]**o+(0.88759395083)*x[2]
        s[3,4,2,1]=(-0.942620080756)*x[0]**o+(-0.794499826777)*x[0]+(-0.191327255697)*x[1]**o+(-0.185051303598)*x[1]+(0.681543419098)*x[2]**o+(-0.142256046241)*x[2]
        ref[0,0,0,0]=(0.854566232468)*(1+2.*(dim-1.)/(o+1.))+(-2.27229927089)*dim
        ref[0,0,0,1]=(-0.989332586323)*(1+2.*(dim-1.)/(o+1.))+(-0.751767471217)*dim
        ref[0,0,1,0]=(0.170998015739)*(1+2.*(dim-1.)/(o+1.))+(2.07130399849)*dim
        ref[0,0,1,1]=(1.12437874793)*(1+2.*(dim-1.)/(o+1.))+(0.369594791005)*dim
        ref[0,0,2,0]=(0.175354222567)*(1+2.*(dim-1.)/(o+1.))+(-1.05037040857)*dim
        ref[0,0,2,1]=(0.306997257038)*(1+2.*(dim-1.)/(o+1.))+(-0.596327147149)*dim
        ref[0,1,0,0]=(-0.986664028597)*(1+2.*(dim-1.)/(o+1.))+(0.147255273686)*dim
        ref[0,1,0,1]=(-0.057403016606)*(1+2.*(dim-1.)/(o+1.))+(-1.4736524552)*dim
        ref[0,1,1,0]=(1.01904700679)*(1+2.*(dim-1.)/(o+1.))+(-0.757373181813)*dim
        ref[0,1,1,1]=(0.783282492073)*(1+2.*(dim-1.)/(o+1.))+(-1.21875468798)*dim
        ref[0,1,2,0]=(0.952340897946)*(1+2.*(dim-1.)/(o+1.))+(0.713464583232)*dim
        ref[0,1,2,1]=(1.45696275631)*(1+2.*(dim-1.)/(o+1.))+(1.58168131279)*dim
        ref[0,2,0,0]=(0.064837646501)*(1+2.*(dim-1.)/(o+1.))+(-1.87419276367)*dim
        ref[0,2,0,1]=(-0.760889397294)*(1+2.*(dim-1.)/(o+1.))+(2.07687305038)*dim
        ref[0,2,1,0]=(-0.380575937425)*(1+2.*(dim-1.)/(o+1.))+(1.18322256955)*dim
        ref[0,2,1,1]=(0.0998904195137)*(1+2.*(dim-1.)/(o+1.))+(0.762541697126)*dim
        ref[0,2,2,0]=(0.806899473909)*(1+2.*(dim-1.)/(o+1.))+(0.867881265887)*dim
        ref[0,2,2,1]=(0.0474528005784)*(1+2.*(dim-1.)/(o+1.))+(-0.0563780781365)*dim
        ref[0,3,0,0]=(0.145415525229)*(1+2.*(dim-1.)/(o+1.))+(0.399190212115)*dim
        ref[0,3,0,1]=(2.26114410824)*(1+2.*(dim-1.)/(o+1.))+(-0.743490691928)*dim
        ref[0,3,1,0]=(0.960813974011)*(1+2.*(dim-1.)/(o+1.))+(-0.0284214479695)*dim
        ref[0,3,1,1]=(1.47325375635)*(1+2.*(dim-1.)/(o+1.))+(-0.599244959013)*dim
        ref[0,3,2,0]=(1.08301397996)*(1+2.*(dim-1.)/(o+1.))+(0.247426252553)*dim
        ref[0,3,2,1]=(-1.4186347995)*(1+2.*(dim-1.)/(o+1.))+(0.696099814573)*dim
        ref[0,4,0,0]=(-0.393517834393)*(1+2.*(dim-1.)/(o+1.))+(-2.30394867936)*dim
        ref[0,4,0,1]=(-1.40711102949)*(1+2.*(dim-1.)/(o+1.))+(-0.690433966228)*dim
        ref[0,4,1,0]=(-0.638615138949)*(1+2.*(dim-1.)/(o+1.))+(-0.47200820565)*dim
        ref[0,4,1,1]=(0.989421505854)*(1+2.*(dim-1.)/(o+1.))+(-0.752441737288)*dim
        ref[0,4,2,0]=(-0.881756130244)*(1+2.*(dim-1.)/(o+1.))+(-0.338966152194)*dim
        ref[0,4,2,1]=(-2.33289649019)*(1+2.*(dim-1.)/(o+1.))+(0.259221814291)*dim
        ref[1,0,0,0]=(0.535686388307)*(1+2.*(dim-1.)/(o+1.))+(0.266916202289)*dim
        ref[1,0,0,1]=(1.46703190363)*(1+2.*(dim-1.)/(o+1.))+(0.398601744865)*dim
        ref[1,0,1,0]=(0.32201076756)*(1+2.*(dim-1.)/(o+1.))+(0.135321713403)*dim
        ref[1,0,1,1]=(-0.898740301412)*(1+2.*(dim-1.)/(o+1.))+(0.923393823202)*dim
        ref[1,0,2,0]=(-0.376626929371)*(1+2.*(dim-1.)/(o+1.))+(-0.502418571748)*dim
        ref[1,0,2,1]=(0.367615051881)*(1+2.*(dim-1.)/(o+1.))+(0.113455552197)*dim
        ref[1,1,0,0]=(-0.0262926747634)*(1+2.*(dim-1.)/(o+1.))+(-0.656064973208)*dim
        ref[1,1,0,1]=(-1.14713357654)*(1+2.*(dim-1.)/(o+1.))+(1.20161428708)*dim
        ref[1,1,1,0]=(-0.256099523566)*(1+2.*(dim-1.)/(o+1.))+(1.12819050155)*dim
        ref[1,1,1,1]=(-0.711548624701)*(1+2.*(dim-1.)/(o+1.))+(1.09265080887)*dim
        ref[1,1,2,0]=(-0.23671592891)*(1+2.*(dim-1.)/(o+1.))+(-0.371739193929)*dim
        ref[1,1,2,1]=(-0.384096984041)*(1+2.*(dim-1.)/(o+1.))+(-0.508592134529)*dim
        ref[1,2,0,0]=(0.519697602114)*(1+2.*(dim-1.)/(o+1.))+(-0.195849802533)*dim
        ref[1,2,0,1]=(0.454720124645)*(1+2.*(dim-1.)/(o+1.))+(-0.125915366271)*dim
        ref[1,2,1,0]=(-0.00770507513982)*(1+2.*(dim-1.)/(o+1.))+(1.35445743788)*dim
        ref[1,2,1,1]=(-0.977550759742)*(1+2.*(dim-1.)/(o+1.))+(-1.61751594043)*dim
        ref[1,2,2,0]=(0.861571331194)*(1+2.*(dim-1.)/(o+1.))+(-0.861303922176)*dim
        ref[1,2,2,1]=(-0.810715347979)*(1+2.*(dim-1.)/(o+1.))+(1.42155547855)*dim
        ref[1,3,0,0]=(-0.48880602403)*(1+2.*(dim-1.)/(o+1.))+(-0.630731120484)*dim
        ref[1,3,0,1]=(1.29442538769)*(1+2.*(dim-1.)/(o+1.))+(-1.52631856825)*dim
        ref[1,3,1,0]=(-0.130124912024)*(1+2.*(dim-1.)/(o+1.))+(0.0360383524367)*dim
        ref[1,3,1,1]=(-1.23465330675)*(1+2.*(dim-1.)/(o+1.))+(0.0409215591672)*dim
        ref[1,3,2,0]=(1.13018021667)*(1+2.*(dim-1.)/(o+1.))+(0.202469386431)*dim
        ref[1,3,2,1]=(-0.588287193696)*(1+2.*(dim-1.)/(o+1.))+(-1.85821154573)*dim
        ref[1,4,0,0]=(-1.20298050809)*(1+2.*(dim-1.)/(o+1.))+(-1.08489038716)*dim
        ref[1,4,0,1]=(-0.946026904954)*(1+2.*(dim-1.)/(o+1.))+(1.02206633439)*dim
        ref[1,4,1,0]=(0.74218259968)*(1+2.*(dim-1.)/(o+1.))+(-0.961409643371)*dim
        ref[1,4,1,1]=(-1.12256447115)*(1+2.*(dim-1.)/(o+1.))+(-0.426557198078)*dim
        ref[1,4,2,0]=(0.304051428859)*(1+2.*(dim-1.)/(o+1.))+(1.56622776733)*dim
        ref[1,4,2,1]=(-1.44380211314)*(1+2.*(dim-1.)/(o+1.))+(1.93250083155)*dim
        ref[2,0,0,0]=(-2.065494162)*(1+2.*(dim-1.)/(o+1.))+(-0.883101081048)*dim
        ref[2,0,0,1]=(-2.10903347424)*(1+2.*(dim-1.)/(o+1.))+(0.196847643424)*dim
        ref[2,0,1,0]=(-0.979825393789)*(1+2.*(dim-1.)/(o+1.))+(0.86000337837)*dim
        ref[2,0,1,1]=(1.25108138774)*(1+2.*(dim-1.)/(o+1.))+(1.20467341614)*dim
        ref[2,0,2,0]=(-0.857510547847)*(1+2.*(dim-1.)/(o+1.))+(-1.30991900291)*dim
        ref[2,0,2,1]=(-0.0885386362105)*(1+2.*(dim-1.)/(o+1.))+(-0.574662655868)*dim
        ref[2,1,0,0]=(-0.0240869854401)*(1+2.*(dim-1.)/(o+1.))+(1.38032189842)*dim
        ref[2,1,0,1]=(0.591152241347)*(1+2.*(dim-1.)/(o+1.))+(0.329222236678)*dim
        ref[2,1,1,0]=(-1.30205240309)*(1+2.*(dim-1.)/(o+1.))+(1.48699498562)*dim
        ref[2,1,1,1]=(-0.0895050021498)*(1+2.*(dim-1.)/(o+1.))+(-0.584812767342)*dim
        ref[2,1,2,0]=(1.07183777305)*(1+2.*(dim-1.)/(o+1.))+(0.620303108435)*dim
        ref[2,1,2,1]=(0.188764364592)*(1+2.*(dim-1.)/(o+1.))+(-0.718198700712)*dim
        ref[2,2,0,0]=(-1.96259020923)*(1+2.*(dim-1.)/(o+1.))+(-0.682010527749)*dim
        ref[2,2,0,1]=(-1.73725752413)*(1+2.*(dim-1.)/(o+1.))+(-0.168790457754)*dim
        ref[2,2,1,0]=(-1.69673453707)*(1+2.*(dim-1.)/(o+1.))+(1.14586950243)*dim
        ref[2,2,1,1]=(-2.08891289811)*(1+2.*(dim-1.)/(o+1.))+(1.23815119328)*dim
        ref[2,2,2,0]=(1.85348817252)*(1+2.*(dim-1.)/(o+1.))+(-0.246804870276)*dim
        ref[2,2,2,1]=(1.68961365001)*(1+2.*(dim-1.)/(o+1.))+(-0.759229283962)*dim
        ref[2,3,0,0]=(-1.67415156006)*(1+2.*(dim-1.)/(o+1.))+(0.337896622768)*dim
        ref[2,3,0,1]=(1.06142297474)*(1+2.*(dim-1.)/(o+1.))+(0.544376570315)*dim
        ref[2,3,1,0]=(0.340123477905)*(1+2.*(dim-1.)/(o+1.))+(1.22586124939)*dim
        ref[2,3,1,1]=(0.102592048393)*(1+2.*(dim-1.)/(o+1.))+(0.463933762733)*dim
        ref[2,3,2,0]=(-1.37023147016)*(1+2.*(dim-1.)/(o+1.))+(0.239626956644)*dim
        ref[2,3,2,1]=(0.217399954632)*(1+2.*(dim-1.)/(o+1.))+(-2.44558808014)*dim
        ref[2,4,0,0]=(0.862283654334)*(1+2.*(dim-1.)/(o+1.))+(0.447678913125)*dim
        ref[2,4,0,1]=(-0.280950858013)*(1+2.*(dim-1.)/(o+1.))+(0.210382504993)*dim
        ref[2,4,1,0]=(-2.53842502868)*(1+2.*(dim-1.)/(o+1.))+(1.05432111912)*dim
        ref[2,4,1,1]=(-0.474782556409)*(1+2.*(dim-1.)/(o+1.))+(-0.345418959816)*dim
        ref[2,4,2,0]=(-0.640169570421)*(1+2.*(dim-1.)/(o+1.))+(2.29862573583)*dim
        ref[2,4,2,1]=(-1.29561079186)*(1+2.*(dim-1.)/(o+1.))+(-0.0229243896616)*dim
        ref[3,0,0,0]=(0.524599634743)*(1+2.*(dim-1.)/(o+1.))+(1.48657883913)*dim
        ref[3,0,0,1]=(-0.786118853533)*(1+2.*(dim-1.)/(o+1.))+(-0.934991212081)*dim
        ref[3,0,1,0]=(-1.26119302657)*(1+2.*(dim-1.)/(o+1.))+(-0.45639437713)*dim
        ref[3,0,1,1]=(1.69966046653)*(1+2.*(dim-1.)/(o+1.))+(-0.173121374354)*dim
        ref[3,0,2,0]=(0.505872873156)*(1+2.*(dim-1.)/(o+1.))+(-0.693315654114)*dim
        ref[3,0,2,1]=(-1.07601104899)*(1+2.*(dim-1.)/(o+1.))+(-1.63307575663)*dim
        ref[3,1,0,0]=(-1.12174154586)*(1+2.*(dim-1.)/(o+1.))+(-0.200310678769)*dim
        ref[3,1,0,1]=(-0.741844605234)*(1+2.*(dim-1.)/(o+1.))+(2.20475885314)*dim
        ref[3,1,1,0]=(-2.00271074147)*(1+2.*(dim-1.)/(o+1.))+(0.306114236606)*dim
        ref[3,1,1,1]=(0.470437983768)*(1+2.*(dim-1.)/(o+1.))+(-1.19671555254)*dim
        ref[3,1,2,0]=(-0.348930377674)*(1+2.*(dim-1.)/(o+1.))+(0.682136816577)*dim
        ref[3,1,2,1]=(-0.653268440332)*(1+2.*(dim-1.)/(o+1.))+(-0.653457938714)*dim
        ref[3,2,0,0]=(-0.323250030589)*(1+2.*(dim-1.)/(o+1.))+(1.64151767382)*dim
        ref[3,2,0,1]=(0.984196908917)*(1+2.*(dim-1.)/(o+1.))+(0.394463769052)*dim
        ref[3,2,1,0]=(-0.275273072003)*(1+2.*(dim-1.)/(o+1.))+(2.22266273838)*dim
        ref[3,2,1,1]=(-1.04603599796)*(1+2.*(dim-1.)/(o+1.))+(-0.813072858233)*dim
        ref[3,2,2,0]=(0.0123017483236)*(1+2.*(dim-1.)/(o+1.))+(-1.00921382659)*dim
        ref[3,2,2,1]=(0.698349007993)*(1+2.*(dim-1.)/(o+1.))+(0.860447076293)*dim
        ref[3,3,0,0]=(-1.92039491753)*(1+2.*(dim-1.)/(o+1.))+(0.363696174714)*dim
        ref[3,3,0,1]=(0.449509323203)*(1+2.*(dim-1.)/(o+1.))+(-1.20964473864)*dim
        ref[3,3,1,0]=(0.0926213111634)*(1+2.*(dim-1.)/(o+1.))+(0.187469872479)*dim
        ref[3,3,1,1]=(-0.331241037228)*(1+2.*(dim-1.)/(o+1.))+(1.29551361978)*dim
        ref[3,3,2,0]=(-1.30763679783)*(1+2.*(dim-1.)/(o+1.))+(1.90224475377)*dim
        ref[3,3,2,1]=(1.69637879413)*(1+2.*(dim-1.)/(o+1.))+(1.67952685501)*dim
        ref[3,4,0,0]=(0.937028161461)*(1+2.*(dim-1.)/(o+1.))+(-0.359993279113)*dim
        ref[3,4,0,1]=(1.6515406216)*(1+2.*(dim-1.)/(o+1.))+(-1.56143511475)*dim
        ref[3,4,1,0]=(-0.886671756108)*(1+2.*(dim-1.)/(o+1.))+(0.613464958119)*dim
        ref[3,4,1,1]=(0.691565811192)*(1+2.*(dim-1.)/(o+1.))+(0.155392775462)*dim
        ref[3,4,2,0]=(0.684820472977)*(1+2.*(dim-1.)/(o+1.))+(0.1823077916)*dim
        ref[3,4,2,1]=(-0.452403917355)*(1+2.*(dim-1.)/(o+1.))+(-1.12180717662)*dim
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.311774053155)*x[0]**o+(0.52292841627)*x[0]+(-0.518467126196)*x[1]**o+(-0.11329290159)*x[1]
        ref=(-0.518467126196)/(o+1.)+(0.20481775734)+(0.311774053155)*0.5**o
      else:
        arg=(0.233765319091)*x[0]**o+(-0.453551209762)*x[0]+(0.920140231713)*x[1]**o+(0.741695479084)*x[1]+(-0.255834461065)*x[2]**o+(-0.102580899053)*x[2]
        ref=(0.664305770648)/(o+1.)+(0.0927816851348)+(0.233765319091)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(-0.651678780872)*x[0]**o+(-0.749709447394)*x[0]+(0.311088209082)*x[1]**o+(0.553081401193)*x[1]
        arg[1]=(0.657887728987)*x[0]**o+(0.052270143604)*x[0]+(-0.15507994277)*x[1]**o+(-0.30302150082)*x[1]
        ref[0]=(0.311088209082)/(o+1.)+(-0.0983140231004)+(-0.651678780872)*0.5**o
        ref[1]=(-0.15507994277)/(o+1.)+(-0.125375678608)+(0.657887728987)*0.5**o
      else:
        arg[0]=(0.844909347644)*x[0]**o+(-0.342697697483)*x[0]+(0.126242548186)*x[1]**o+(-0.854010732849)*x[1]+(-0.307627587461)*x[2]**o+(-0.998566290754)*x[2]
        arg[1]=(0.900073726701)*x[0]**o+(-0.703841701859)*x[0]+(-0.651690896499)*x[1]**o+(0.828362322181)*x[1]+(0.284410420895)*x[2]**o+(-0.394606348974)*x[2]
        ref[0]=(-0.181385039275)/(o+1.)+(-1.09763736054)+(0.844909347644)*0.5**o
        ref[1]=(-0.367280475604)/(o+1.)+(-0.135042864326)+(0.900073726701)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.263642681371)*x[0]**o+(0.668992571787)*x[0]+(0.873939846194)*x[1]**o+(0.784820355998)*x[1]
        arg[0,1]=(-0.389306088628)*x[0]**o+(-0.0549482389907)*x[0]+(-0.787101008457)*x[1]**o+(0.860345123812)*x[1]
        arg[0,2]=(-0.995721191961)*x[0]**o+(-0.587928136153)*x[0]+(-0.378312614832)*x[1]**o+(0.199765674281)*x[1]
        arg[0,3]=(-0.374679425145)*x[0]**o+(-0.503606183146)*x[0]+(0.23995738992)*x[1]**o+(-0.525359181744)*x[1]
        arg[0,4]=(-0.69923255665)*x[0]**o+(0.547634979941)*x[0]+(0.728792702739)*x[1]**o+(0.949888533828)*x[1]
        arg[1,0]=(-0.61856415528)*x[0]**o+(-0.0516239651093)*x[0]+(0.158516649979)*x[1]**o+(-0.0522288881011)*x[1]
        arg[1,1]=(0.0285524133857)*x[0]**o+(0.741357758307)*x[0]+(-0.0714860903847)*x[1]**o+(-0.539632750385)*x[1]
        arg[1,2]=(-0.291101401382)*x[0]**o+(-0.114900246437)*x[0]+(-0.982305031665)*x[1]**o+(0.0823478844055)*x[1]
        arg[1,3]=(-0.931305732525)*x[0]**o+(0.077332436417)*x[0]+(-0.880626154921)*x[1]**o+(-0.321222234507)*x[1]
        arg[1,4]=(-0.00778033208815)*x[0]**o+(-0.536626847957)*x[0]+(-0.599742714546)*x[1]**o+(0.454108299336)*x[1]
        arg[2,0]=(-0.575243090445)*x[0]**o+(-0.920247228564)*x[0]+(0.4569784462)*x[1]**o+(-0.105175798804)*x[1]
        arg[2,1]=(0.333985911748)*x[0]**o+(-0.017876213076)*x[0]+(0.475164778165)*x[1]**o+(0.561072178015)*x[1]
        arg[2,2]=(-0.559587786773)*x[0]**o+(-0.917134128672)*x[0]+(0.316654889327)*x[1]**o+(-0.640569595027)*x[1]
        arg[2,3]=(-0.140461324817)*x[0]**o+(0.259052969883)*x[0]+(0.397898509159)*x[1]**o+(0.932233331785)*x[1]
        arg[2,4]=(0.368626304985)*x[0]**o+(0.616310502384)*x[0]+(-0.756845293566)*x[1]**o+(-0.920088968132)*x[1]
        arg[3,0]=(-0.824398741087)*x[0]**o+(0.0498115894252)*x[0]+(-0.5256621655)*x[1]**o+(0.114806237108)*x[1]
        arg[3,1]=(-0.77671057316)*x[0]**o+(0.569249443162)*x[0]+(0.416628465801)*x[1]**o+(0.0603627487913)*x[1]
        arg[3,2]=(-0.247875220913)*x[0]**o+(0.19548828878)*x[0]+(0.643226101838)*x[1]**o+(-0.154558826499)*x[1]
        arg[3,3]=(-0.918937118963)*x[0]**o+(0.193777174417)*x[0]+(-0.906042347107)*x[1]**o+(0.872033230033)*x[1]
        arg[3,4]=(-0.628918336086)*x[0]**o+(0.823242191714)*x[0]+(-0.593691166712)*x[1]**o+(-0.661715840814)*x[1]
        ref[0,0]=(0.873939846194)/(o+1.)+(0.726906463892)+(-0.263642681371)*0.5**o
        ref[0,1]=(-0.787101008457)/(o+1.)+(0.402698442411)+(-0.389306088628)*0.5**o
        ref[0,2]=(-0.378312614832)/(o+1.)+(-0.194081230936)+(-0.995721191961)*0.5**o
        ref[0,3]=(0.23995738992)/(o+1.)+(-0.514482682445)+(-0.374679425145)*0.5**o
        ref[0,4]=(0.728792702739)/(o+1.)+(0.748761756885)+(-0.69923255665)*0.5**o
        ref[1,0]=(0.158516649979)/(o+1.)+(-0.0519264266052)+(-0.61856415528)*0.5**o
        ref[1,1]=(-0.0714860903847)/(o+1.)+(0.100862503961)+(0.0285524133857)*0.5**o
        ref[1,2]=(-0.982305031665)/(o+1.)+(-0.0162761810159)+(-0.291101401382)*0.5**o
        ref[1,3]=(-0.880626154921)/(o+1.)+(-0.121944899045)+(-0.931305732525)*0.5**o
        ref[1,4]=(-0.599742714546)/(o+1.)+(-0.0412592743102)+(-0.00778033208815)*0.5**o
        ref[2,0]=(0.4569784462)/(o+1.)+(-0.512711513684)+(-0.575243090445)*0.5**o
        ref[2,1]=(0.475164778165)/(o+1.)+(0.27159798247)+(0.333985911748)*0.5**o
        ref[2,2]=(0.316654889327)/(o+1.)+(-0.778851861849)+(-0.559587786773)*0.5**o
        ref[2,3]=(0.397898509159)/(o+1.)+(0.595643150834)+(-0.140461324817)*0.5**o
        ref[2,4]=(-0.756845293566)/(o+1.)+(-0.151889232874)+(0.368626304985)*0.5**o
        ref[3,0]=(-0.5256621655)/(o+1.)+(0.0823089132668)+(-0.824398741087)*0.5**o
        ref[3,1]=(0.416628465801)/(o+1.)+(0.314806095977)+(-0.77671057316)*0.5**o
        ref[3,2]=(0.643226101838)/(o+1.)+(0.0204647311405)+(-0.247875220913)*0.5**o
        ref[3,3]=(-0.906042347107)/(o+1.)+(0.532905202225)+(-0.918937118963)*0.5**o
        ref[3,4]=(-0.593691166712)/(o+1.)+(0.0807631754499)+(-0.628918336086)*0.5**o
      else:
        arg[0,0]=(0.748857269399)*x[0]**o+(-0.21982973469)*x[0]+(-0.765987921295)*x[1]**o+(0.556577019909)*x[1]+(-0.0438548079278)*x[2]**o+(0.543610874817)*x[2]
        arg[0,1]=(-0.784526004748)*x[0]**o+(-0.949423172035)*x[0]+(-0.29888188317)*x[1]**o+(-0.850638766848)*x[1]+(-0.853027558387)*x[2]**o+(-0.846378486588)*x[2]
        arg[0,2]=(0.53445882525)*x[0]**o+(-0.653655652989)*x[0]+(-0.968129875689)*x[1]**o+(-0.603598808323)*x[1]+(0.545841014272)*x[2]**o+(0.126131861082)*x[2]
        arg[0,3]=(0.181662498503)*x[0]**o+(-0.769571080865)*x[0]+(0.771109181078)*x[1]**o+(0.980677373303)*x[1]+(-0.625057940268)*x[2]**o+(0.0585672357346)*x[2]
        arg[0,4]=(-0.0320907540755)*x[0]**o+(-0.519517369917)*x[0]+(-0.365190231996)*x[1]**o+(-0.192392652661)*x[1]+(-0.693267159516)*x[2]**o+(0.106458640425)*x[2]
        arg[1,0]=(0.414286358161)*x[0]**o+(0.0223282279507)*x[0]+(0.215881279469)*x[1]**o+(0.68990977849)*x[1]+(-0.532075885581)*x[2]**o+(-0.269164904232)*x[2]
        arg[1,1]=(-0.0445879250589)*x[0]**o+(0.889985400599)*x[0]+(0.842050582947)*x[1]**o+(-0.0275307884642)*x[1]+(0.774650107671)*x[2]**o+(0.19446514971)*x[2]
        arg[1,2]=(0.913032880034)*x[0]**o+(-0.286537470008)*x[0]+(0.0902778267032)*x[1]**o+(0.548596933564)*x[1]+(-0.996100405074)*x[2]**o+(-0.509554019549)*x[2]
        arg[1,3]=(0.44308812765)*x[0]**o+(-0.0641227726924)*x[0]+(0.484249008075)*x[1]**o+(0.581496384894)*x[1]+(0.592538533183)*x[2]**o+(-0.821638541512)*x[2]
        arg[1,4]=(-0.898304735153)*x[0]**o+(0.333217967121)*x[0]+(-0.788218899371)*x[1]**o+(0.579723459039)*x[1]+(0.467006473159)*x[2]**o+(-0.277113860535)*x[2]
        arg[2,0]=(0.515308716564)*x[0]**o+(0.255947750577)*x[0]+(0.232578337945)*x[1]**o+(0.900611887592)*x[1]+(-0.247710965611)*x[2]**o+(-0.985523228221)*x[2]
        arg[2,1]=(0.611196756618)*x[0]**o+(0.146822999187)*x[0]+(-0.318793147278)*x[1]**o+(0.790772432028)*x[1]+(0.138036152668)*x[2]**o+(-0.800234207543)*x[2]
        arg[2,2]=(-0.293576196546)*x[0]**o+(-0.521059592737)*x[0]+(0.301178293957)*x[1]**o+(-0.141430900198)*x[1]+(-0.782381874467)*x[2]**o+(0.92221179729)*x[2]
        arg[2,3]=(0.673951778483)*x[0]**o+(-0.335068772752)*x[0]+(0.408793200723)*x[1]**o+(0.36906212176)*x[1]+(0.246292093855)*x[2]**o+(0.356147233675)*x[2]
        arg[2,4]=(-0.218899302236)*x[0]**o+(0.271285962886)*x[0]+(-0.16364707283)*x[1]**o+(0.177195607727)*x[1]+(-0.287331396699)*x[2]**o+(-0.465391460497)*x[2]
        arg[3,0]=(-0.369727856735)*x[0]**o+(-0.44351931666)*x[0]+(0.0375097686939)*x[1]**o+(0.276779121402)*x[1]+(0.662505672881)*x[2]**o+(-0.642709866174)*x[2]
        arg[3,1]=(0.444940917816)*x[0]**o+(-0.178926126454)*x[0]+(0.824660645994)*x[1]**o+(0.825996820355)*x[1]+(0.798260651848)*x[2]**o+(0.331744022239)*x[2]
        arg[3,2]=(-0.82489261483)*x[0]**o+(-0.340862079766)*x[0]+(-0.998375587383)*x[1]**o+(0.880222106116)*x[1]+(0.656096580473)*x[2]**o+(0.530854486127)*x[2]
        arg[3,3]=(0.732863411435)*x[0]**o+(-0.324252004147)*x[0]+(0.789472654884)*x[1]**o+(-0.207794796011)*x[1]+(0.50903180567)*x[2]**o+(0.724319112504)*x[2]
        arg[3,4]=(-0.980748139471)*x[0]**o+(0.0974331161906)*x[0]+(0.196275528452)*x[1]**o+(0.305231910003)*x[1]+(-0.0417825350947)*x[2]**o+(-0.2916834261)*x[2]
        ref[0,0]=(-0.809842729223)/(o+1.)+(0.440179080018)+(0.748857269399)*0.5**o
        ref[0,1]=(-1.15190944156)/(o+1.)+(-1.32322021274)+(-0.784526004748)*0.5**o
        ref[0,2]=(-0.422288861417)/(o+1.)+(-0.565561300115)+(0.53445882525)*0.5**o
        ref[0,3]=(0.146051240811)/(o+1.)+(0.134836764087)+(0.181662498503)*0.5**o
        ref[0,4]=(-1.05845739151)/(o+1.)+(-0.302725691077)+(-0.0320907540755)*0.5**o
        ref[1,0]=(-0.316194606113)/(o+1.)+(0.221536551104)+(0.414286358161)*0.5**o
        ref[1,1]=(1.61670069062)/(o+1.)+(0.528459880922)+(-0.0445879250589)*0.5**o
        ref[1,2]=(-0.905822578371)/(o+1.)+(-0.123747277996)+(0.913032880034)*0.5**o
        ref[1,3]=(1.07678754126)/(o+1.)+(-0.152132464655)+(0.44308812765)*0.5**o
        ref[1,4]=(-0.321212426212)/(o+1.)+(0.317913782812)+(-0.898304735153)*0.5**o
        ref[2,0]=(-0.015132627666)/(o+1.)+(0.085518204974)+(0.515308716564)*0.5**o
        ref[2,1]=(-0.18075699461)/(o+1.)+(0.0686806118359)+(0.611196756618)*0.5**o
        ref[2,2]=(-0.481203580509)/(o+1.)+(0.129860652178)+(-0.293576196546)*0.5**o
        ref[2,3]=(0.655085294578)/(o+1.)+(0.195070291341)+(0.673951778483)*0.5**o
        ref[2,4]=(-0.450978469529)/(o+1.)+(-0.00845494494169)+(-0.218899302236)*0.5**o
        ref[3,0]=(0.700015441575)/(o+1.)+(-0.404725030716)+(-0.369727856735)*0.5**o
        ref[3,1]=(1.62292129784)/(o+1.)+(0.48940735807)+(0.444940917816)*0.5**o
        ref[3,2]=(-0.342279006911)/(o+1.)+(0.535107256239)+(-0.82489261483)*0.5**o
        ref[3,3]=(1.29850446055)/(o+1.)+(0.0961361561734)+(0.732863411435)*0.5**o
        ref[3,4]=(0.154492993358)/(o+1.)+(0.055490800047)+(-0.980748139471)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.33788666753)*x[0]**o+(0.0147671449643)*x[0]+(0.14066054662)*x[1]**o+(-0.675231899756)*x[1]
        arg[0,0,1]=(0.0100961441611)*x[0]**o+(0.401304171984)*x[0]+(-0.594786282119)*x[1]**o+(-0.561543495067)*x[1]
        arg[0,1,0]=(-0.118311175162)*x[0]**o+(0.62454992688)*x[0]+(-0.8163725079)*x[1]**o+(-0.756355655277)*x[1]
        arg[0,1,1]=(0.586991709411)*x[0]**o+(-0.600757941586)*x[0]+(0.0953383109011)*x[1]**o+(0.317827629801)*x[1]
        arg[1,0,0]=(-0.251125236294)*x[0]**o+(0.166603616954)*x[0]+(0.978704943828)*x[1]**o+(0.589215389731)*x[1]
        arg[1,0,1]=(0.0543182786738)*x[0]**o+(-0.334756305272)*x[0]+(-0.919571042987)*x[1]**o+(-0.0425734727213)*x[1]
        arg[1,1,0]=(-0.867177621518)*x[0]**o+(-0.0750659593232)*x[0]+(-0.227277029921)*x[1]**o+(0.361120763296)*x[1]
        arg[1,1,1]=(0.85129514889)*x[0]**o+(-0.441962000795)*x[0]+(0.425335668395)*x[1]**o+(0.204091109081)*x[1]
        arg[2,0,0]=(-0.537930401585)*x[0]**o+(-0.206510941636)*x[0]+(-0.247374421196)*x[1]**o+(0.67043841725)*x[1]
        arg[2,0,1]=(-0.101273864474)*x[0]**o+(0.283769727506)*x[0]+(-0.0850059833654)*x[1]**o+(-0.71291661379)*x[1]
        arg[2,1,0]=(0.684430088582)*x[0]**o+(0.107733116086)*x[0]+(0.40398578341)*x[1]**o+(-0.525004991854)*x[1]
        arg[2,1,1]=(-0.00801759014554)*x[0]**o+(-0.214858014851)*x[0]+(-0.427822011518)*x[1]**o+(0.0168962506945)*x[1]
        arg[3,0,0]=(0.528563052182)*x[0]**o+(-0.630485796029)*x[0]+(0.0525765317703)*x[1]**o+(-0.469639006097)*x[1]
        arg[3,0,1]=(0.178622695427)*x[0]**o+(0.0952996500383)*x[0]+(-0.785851578496)*x[1]**o+(0.856665398338)*x[1]
        arg[3,1,0]=(0.547391926072)*x[0]**o+(-0.0179195091852)*x[0]+(-0.831368961862)*x[1]**o+(-0.437229107453)*x[1]
        arg[3,1,1]=(-0.657011566453)*x[0]**o+(0.530176142378)*x[0]+(0.649145894746)*x[1]**o+(-0.755185337598)*x[1]
        arg[4,0,0]=(-0.188305872652)*x[0]**o+(0.0207245930982)*x[0]+(-0.590757998421)*x[1]**o+(-0.793662033952)*x[1]
        arg[4,0,1]=(0.417712824349)*x[0]**o+(-0.138327612527)*x[0]+(-0.381595921766)*x[1]**o+(0.0287368364725)*x[1]
        arg[4,1,0]=(-0.83750540403)*x[0]**o+(0.247261273008)*x[0]+(-0.0769629479034)*x[1]**o+(0.0693501875686)*x[1]
        arg[4,1,1]=(0.697434044074)*x[0]**o+(0.396582403702)*x[0]+(0.736132107034)*x[1]**o+(0.482245183242)*x[1]
        arg[5,0,0]=(0.769936158184)*x[0]**o+(0.808871896459)*x[0]+(-0.559205314785)*x[1]**o+(-0.258014827146)*x[1]
        arg[5,0,1]=(0.667132553969)*x[0]**o+(0.618184492083)*x[0]+(0.475852440157)*x[1]**o+(0.084499293443)*x[1]
        arg[5,1,0]=(0.910882712823)*x[0]**o+(0.153897139268)*x[0]+(-0.61197280039)*x[1]**o+(0.441331985295)*x[1]
        arg[5,1,1]=(-0.290188623857)*x[0]**o+(0.318266320131)*x[0]+(0.9587856247)*x[1]**o+(0.311981486508)*x[1]
        ref[0,0,0]=(0.14066054662)/(o+1.)+(-0.330232377396)+(-0.33788666753)*0.5**o
        ref[0,0,1]=(-0.594786282119)/(o+1.)+(-0.0801196615418)+(0.0100961441611)*0.5**o
        ref[0,1,0]=(-0.8163725079)/(o+1.)+(-0.0659028641985)+(-0.118311175162)*0.5**o
        ref[0,1,1]=(0.0953383109011)/(o+1.)+(-0.141465155893)+(0.586991709411)*0.5**o
        ref[1,0,0]=(0.978704943828)/(o+1.)+(0.377909503343)+(-0.251125236294)*0.5**o
        ref[1,0,1]=(-0.919571042987)/(o+1.)+(-0.188664888997)+(0.0543182786738)*0.5**o
        ref[1,1,0]=(-0.227277029921)/(o+1.)+(0.143027401987)+(-0.867177621518)*0.5**o
        ref[1,1,1]=(0.425335668395)/(o+1.)+(-0.118935445857)+(0.85129514889)*0.5**o
        ref[2,0,0]=(-0.247374421196)/(o+1.)+(0.231963737807)+(-0.537930401585)*0.5**o
        ref[2,0,1]=(-0.0850059833654)/(o+1.)+(-0.214573443142)+(-0.101273864474)*0.5**o
        ref[2,1,0]=(0.40398578341)/(o+1.)+(-0.208635937884)+(0.684430088582)*0.5**o
        ref[2,1,1]=(-0.427822011518)/(o+1.)+(-0.0989808820785)+(-0.00801759014554)*0.5**o
        ref[3,0,0]=(0.0525765317703)/(o+1.)+(-0.550062401063)+(0.528563052182)*0.5**o
        ref[3,0,1]=(-0.785851578496)/(o+1.)+(0.475982524188)+(0.178622695427)*0.5**o
        ref[3,1,0]=(-0.831368961862)/(o+1.)+(-0.227574308319)+(0.547391926072)*0.5**o
        ref[3,1,1]=(0.649145894746)/(o+1.)+(-0.11250459761)+(-0.657011566453)*0.5**o
        ref[4,0,0]=(-0.590757998421)/(o+1.)+(-0.386468720427)+(-0.188305872652)*0.5**o
        ref[4,0,1]=(-0.381595921766)/(o+1.)+(-0.0547953880271)+(0.417712824349)*0.5**o
        ref[4,1,0]=(-0.0769629479034)/(o+1.)+(0.158305730288)+(-0.83750540403)*0.5**o
        ref[4,1,1]=(0.736132107034)/(o+1.)+(0.439413793472)+(0.697434044074)*0.5**o
        ref[5,0,0]=(-0.559205314785)/(o+1.)+(0.275428534657)+(0.769936158184)*0.5**o
        ref[5,0,1]=(0.475852440157)/(o+1.)+(0.351341892763)+(0.667132553969)*0.5**o
        ref[5,1,0]=(-0.61197280039)/(o+1.)+(0.297614562282)+(0.910882712823)*0.5**o
        ref[5,1,1]=(0.9587856247)/(o+1.)+(0.315123903319)+(-0.290188623857)*0.5**o
      else:
        arg[0,0,0]=(0.292346424086)*x[0]**o+(0.105058465241)*x[0]+(-0.281467283372)*x[1]**o+(0.828345267021)*x[1]+(0.741242558638)*x[2]**o+(0.0858780765977)*x[2]
        arg[0,0,1]=(-0.460556250835)*x[0]**o+(-0.845199338719)*x[0]+(-0.547000154821)*x[1]**o+(-0.972236450512)*x[1]+(0.823031420765)*x[2]**o+(0.278285294464)*x[2]
        arg[0,1,0]=(0.380027894487)*x[0]**o+(-0.579359210385)*x[0]+(-0.760849798908)*x[1]**o+(0.0065870459398)*x[1]+(-0.869735580799)*x[2]**o+(-0.937378284335)*x[2]
        arg[0,1,1]=(0.948682597897)*x[0]**o+(-0.882044080711)*x[0]+(-0.694398833899)*x[1]**o+(0.883635235205)*x[1]+(-0.473761903609)*x[2]**o+(0.961453193379)*x[2]
        arg[1,0,0]=(0.357218603696)*x[0]**o+(-0.694504294144)*x[0]+(-0.187119222895)*x[1]**o+(0.727463485088)*x[1]+(0.150410254875)*x[2]**o+(-0.373430202907)*x[2]
        arg[1,0,1]=(-0.776893233002)*x[0]**o+(0.565238637388)*x[0]+(-0.155674628662)*x[1]**o+(-0.938226259914)*x[1]+(0.575183633137)*x[2]**o+(0.319871583783)*x[2]
        arg[1,1,0]=(0.593512911569)*x[0]**o+(-0.0578762085927)*x[0]+(-0.913450847289)*x[1]**o+(0.7074653217)*x[1]+(0.991175636143)*x[2]**o+(-0.535632452281)*x[2]
        arg[1,1,1]=(-0.154542349616)*x[0]**o+(-0.841642050346)*x[0]+(0.878833704431)*x[1]**o+(0.85568524402)*x[1]+(-0.710374336281)*x[2]**o+(0.346540187252)*x[2]
        arg[2,0,0]=(-0.765160864305)*x[0]**o+(0.608017010487)*x[0]+(0.841265469171)*x[1]**o+(-0.409854579584)*x[1]+(0.728931324538)*x[2]**o+(0.121315209213)*x[2]
        arg[2,0,1]=(0.0397067301375)*x[0]**o+(-0.0451925117802)*x[0]+(-0.412724345414)*x[1]**o+(-0.447675002107)*x[1]+(0.141728105561)*x[2]**o+(0.923970189305)*x[2]
        arg[2,1,0]=(-0.237044096923)*x[0]**o+(-0.826168294669)*x[0]+(0.19833520121)*x[1]**o+(-0.796076984382)*x[1]+(0.367399642334)*x[2]**o+(0.71172848801)*x[2]
        arg[2,1,1]=(-0.3881830464)*x[0]**o+(0.988354722657)*x[0]+(0.762756805728)*x[1]**o+(0.551778683619)*x[1]+(0.975932105591)*x[2]**o+(-0.173192098292)*x[2]
        arg[3,0,0]=(-0.226163777371)*x[0]**o+(-0.301094659695)*x[0]+(0.0682567814743)*x[1]**o+(-0.154914902824)*x[1]+(0.984669238436)*x[2]**o+(-0.431011897738)*x[2]
        arg[3,0,1]=(-0.47230847571)*x[0]**o+(-0.579315893476)*x[0]+(-0.989289806396)*x[1]**o+(-0.673951334134)*x[1]+(0.98143767614)*x[2]**o+(-0.311074531383)*x[2]
        arg[3,1,0]=(-0.276309910109)*x[0]**o+(-0.70244304164)*x[0]+(-0.963669800079)*x[1]**o+(-0.947723474952)*x[1]+(0.513451083144)*x[2]**o+(-0.0651803692263)*x[2]
        arg[3,1,1]=(0.65175527234)*x[0]**o+(-0.294569414615)*x[0]+(-0.32846386125)*x[1]**o+(-0.868822318527)*x[1]+(0.268414480892)*x[2]**o+(-0.866835042217)*x[2]
        arg[4,0,0]=(0.304002845434)*x[0]**o+(0.938467246002)*x[0]+(-0.106648262772)*x[1]**o+(0.227863374571)*x[1]+(-0.789305204045)*x[2]**o+(-0.171526142133)*x[2]
        arg[4,0,1]=(0.70982305774)*x[0]**o+(0.404228697442)*x[0]+(0.190029230022)*x[1]**o+(-0.825276083634)*x[1]+(-0.739774636921)*x[2]**o+(-0.726529211281)*x[2]
        arg[4,1,0]=(-0.238487290076)*x[0]**o+(-0.4901234628)*x[0]+(-0.836670757945)*x[1]**o+(0.0841493712661)*x[1]+(-0.685144435198)*x[2]**o+(-0.304978244786)*x[2]
        arg[4,1,1]=(0.264176905985)*x[0]**o+(-0.410582158319)*x[0]+(-0.271915471538)*x[1]**o+(-0.996082427599)*x[1]+(-0.466654446945)*x[2]**o+(-0.723243781429)*x[2]
        arg[5,0,0]=(0.379390860481)*x[0]**o+(-0.78556086955)*x[0]+(0.189126836375)*x[1]**o+(0.235947881164)*x[1]+(0.149142076852)*x[2]**o+(-0.944419890441)*x[2]
        arg[5,0,1]=(0.768867280189)*x[0]**o+(-0.728364777249)*x[0]+(0.60414049451)*x[1]**o+(-0.538876171991)*x[1]+(-0.0947560131508)*x[2]**o+(0.474986163327)*x[2]
        arg[5,1,0]=(-0.228069986734)*x[0]**o+(-0.680841588894)*x[0]+(-0.663806510587)*x[1]**o+(-0.852775021416)*x[1]+(-0.59539582999)*x[2]**o+(0.52369159839)*x[2]
        arg[5,1,1]=(0.177872029425)*x[0]**o+(0.93423742256)*x[0]+(-0.0369475988192)*x[1]**o+(0.242202072343)*x[1]+(0.526144455402)*x[2]**o+(0.0217547142691)*x[2]
        ref[0,0,0]=(0.459775275267)/(o+1.)+(0.50964090443)+(0.292346424086)*0.5**o
        ref[0,0,1]=(0.276031265944)/(o+1.)+(-0.769575247383)+(-0.460556250835)*0.5**o
        ref[0,1,0]=(-1.63058537971)/(o+1.)+(-0.75507522439)+(0.380027894487)*0.5**o
        ref[0,1,1]=(-1.16816073751)/(o+1.)+(0.481522173937)+(0.948682597897)*0.5**o
        ref[1,0,0]=(-0.0367089680209)/(o+1.)+(-0.170235505982)+(0.357218603696)*0.5**o
        ref[1,0,1]=(0.419509004475)/(o+1.)+(-0.0265580193719)+(-0.776893233002)*0.5**o
        ref[1,1,0]=(0.0777247888533)/(o+1.)+(0.0569783304129)+(0.593512911569)*0.5**o
        ref[1,1,1]=(0.168459368149)/(o+1.)+(0.180291690463)+(-0.154542349616)*0.5**o
        ref[2,0,0]=(1.57019679371)/(o+1.)+(0.159738820058)+(-0.765160864305)*0.5**o
        ref[2,0,1]=(-0.270996239853)/(o+1.)+(0.215551337709)+(0.0397067301375)*0.5**o
        ref[2,1,0]=(0.565734843545)/(o+1.)+(-0.455258395521)+(-0.237044096923)*0.5**o
        ref[2,1,1]=(1.73868891132)/(o+1.)+(0.683470653992)+(-0.3881830464)*0.5**o
        ref[3,0,0]=(1.05292601991)/(o+1.)+(-0.443510730129)+(-0.226163777371)*0.5**o
        ref[3,0,1]=(-0.00785213025503)/(o+1.)+(-0.782170879496)+(-0.47230847571)*0.5**o
        ref[3,1,0]=(-0.450218716935)/(o+1.)+(-0.857673442909)+(-0.276309910109)*0.5**o
        ref[3,1,1]=(-0.0600493803575)/(o+1.)+(-1.01511338768)+(0.65175527234)*0.5**o
        ref[4,0,0]=(-0.895953466817)/(o+1.)+(0.49740223922)+(0.304002845434)*0.5**o
        ref[4,0,1]=(-0.549745406899)/(o+1.)+(-0.573788298736)+(0.70982305774)*0.5**o
        ref[4,1,0]=(-1.52181519314)/(o+1.)+(-0.35547616816)+(-0.238487290076)*0.5**o
        ref[4,1,1]=(-0.738569918483)/(o+1.)+(-1.06495418367)+(0.264176905985)*0.5**o
        ref[5,0,0]=(0.338268913228)/(o+1.)+(-0.747016439414)+(0.379390860481)*0.5**o
        ref[5,0,1]=(0.50938448136)/(o+1.)+(-0.396127392956)+(0.768867280189)*0.5**o
        ref[5,1,0]=(-1.25920234058)/(o+1.)+(-0.50496250596)+(-0.228069986734)*0.5**o
        ref[5,1,1]=(0.489196856583)/(o+1.)+(0.599097104586)+(0.177872029425)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.423100205741)*x[0]**o+(-0.681307394941)*x[0]+(-0.848175950825)*x[1]**o+(0.559338235783)*x[1]
        arg[0,0,0,1]=(-0.739687474039)*x[0]**o+(-0.202202358237)*x[0]+(-0.838397517739)*x[1]**o+(-0.377580621185)*x[1]
        arg[0,0,1,0]=(-0.423462958438)*x[0]**o+(-0.335929684088)*x[0]+(-0.616976579504)*x[1]**o+(-0.77803694581)*x[1]
        arg[0,0,1,1]=(-0.432533121428)*x[0]**o+(0.0723865130937)*x[0]+(-0.953014661461)*x[1]**o+(0.92761707252)*x[1]
        arg[0,0,2,0]=(-0.891613775753)*x[0]**o+(0.780592229933)*x[0]+(-0.156191993934)*x[1]**o+(0.985464289737)*x[1]
        arg[0,0,2,1]=(0.909573147888)*x[0]**o+(-0.225603851475)*x[0]+(-0.68287286477)*x[1]**o+(0.330105905794)*x[1]
        arg[0,1,0,0]=(-0.39808363424)*x[0]**o+(-0.290872560992)*x[0]+(-0.631624427826)*x[1]**o+(-0.389239289826)*x[1]
        arg[0,1,0,1]=(-0.748658247224)*x[0]**o+(0.22314629362)*x[0]+(-0.0750972377036)*x[1]**o+(0.908914722147)*x[1]
        arg[0,1,1,0]=(0.877627912148)*x[0]**o+(-0.988434656301)*x[0]+(-0.163646238293)*x[1]**o+(-0.169410711361)*x[1]
        arg[0,1,1,1]=(-0.592580581615)*x[0]**o+(0.997989912544)*x[0]+(0.0667564973731)*x[1]**o+(-0.121580259121)*x[1]
        arg[0,1,2,0]=(-0.505569292541)*x[0]**o+(-0.534428841308)*x[0]+(-0.899276958155)*x[1]**o+(-0.833972415825)*x[1]
        arg[0,1,2,1]=(-0.215752366701)*x[0]**o+(-0.249993262232)*x[0]+(0.912452712698)*x[1]**o+(0.0601524115958)*x[1]
        arg[0,2,0,0]=(0.684112319204)*x[0]**o+(0.343018234122)*x[0]+(0.267409202785)*x[1]**o+(0.7781133929)*x[1]
        arg[0,2,0,1]=(0.552438501301)*x[0]**o+(-0.101558113559)*x[0]+(-0.152472725029)*x[1]**o+(-0.8771654517)*x[1]
        arg[0,2,1,0]=(-0.31213422297)*x[0]**o+(0.597042319279)*x[0]+(-0.873134889407)*x[1]**o+(-0.68920786345)*x[1]
        arg[0,2,1,1]=(0.883048532408)*x[0]**o+(-0.653997880306)*x[0]+(-0.761310589424)*x[1]**o+(-0.698342623962)*x[1]
        arg[0,2,2,0]=(-0.324489237508)*x[0]**o+(-0.717724692716)*x[0]+(-0.936381308418)*x[1]**o+(0.712416971077)*x[1]
        arg[0,2,2,1]=(-0.971735193469)*x[0]**o+(0.0943629094751)*x[0]+(0.419811305063)*x[1]**o+(0.125623316569)*x[1]
        arg[0,3,0,0]=(-0.305553454905)*x[0]**o+(-0.936112994503)*x[0]+(0.707279059071)*x[1]**o+(-0.794754809337)*x[1]
        arg[0,3,0,1]=(0.803934620926)*x[0]**o+(-0.632020033455)*x[0]+(0.819264129099)*x[1]**o+(0.770744069672)*x[1]
        arg[0,3,1,0]=(0.996632326055)*x[0]**o+(-0.537850178404)*x[0]+(-0.60262522048)*x[1]**o+(-0.431667704232)*x[1]
        arg[0,3,1,1]=(0.402799911553)*x[0]**o+(0.155798565063)*x[0]+(0.722837842981)*x[1]**o+(0.462463978227)*x[1]
        arg[0,3,2,0]=(0.937966588808)*x[0]**o+(-0.797151899551)*x[0]+(0.62363567076)*x[1]**o+(-0.60458214868)*x[1]
        arg[0,3,2,1]=(-0.0389713032301)*x[0]**o+(0.497820326557)*x[0]+(-0.950660964237)*x[1]**o+(0.0247372614337)*x[1]
        arg[0,4,0,0]=(-0.589529640529)*x[0]**o+(-0.71761078076)*x[0]+(-0.872148906918)*x[1]**o+(-0.666618835503)*x[1]
        arg[0,4,0,1]=(0.78615039967)*x[0]**o+(0.99287672137)*x[0]+(0.329194160571)*x[1]**o+(0.309370990805)*x[1]
        arg[0,4,1,0]=(-0.801187683466)*x[0]**o+(0.476957978386)*x[0]+(0.107007555422)*x[1]**o+(-0.211909676249)*x[1]
        arg[0,4,1,1]=(0.817551079419)*x[0]**o+(0.958544826763)*x[0]+(-0.720479146591)*x[1]**o+(0.0769824586505)*x[1]
        arg[0,4,2,0]=(-0.245391293539)*x[0]**o+(0.240588876322)*x[0]+(0.766214937295)*x[1]**o+(0.625282150348)*x[1]
        arg[0,4,2,1]=(-0.780163545255)*x[0]**o+(-0.84424180556)*x[0]+(-0.993826355778)*x[1]**o+(-0.708432857746)*x[1]
        arg[1,0,0,0]=(0.0998104654851)*x[0]**o+(-0.933870759023)*x[0]+(-0.00667060999489)*x[1]**o+(-0.304328472241)*x[1]
        arg[1,0,0,1]=(0.716858223574)*x[0]**o+(0.0907083966301)*x[0]+(0.118004968786)*x[1]**o+(-0.989434356769)*x[1]
        arg[1,0,1,0]=(0.433505460082)*x[0]**o+(0.927792393402)*x[0]+(0.10117572965)*x[1]**o+(-0.719175235748)*x[1]
        arg[1,0,1,1]=(0.93394463477)*x[0]**o+(0.30554551436)*x[0]+(-0.221528653572)*x[1]**o+(-0.965153365935)*x[1]
        arg[1,0,2,0]=(0.217926136552)*x[0]**o+(0.75089182057)*x[0]+(0.798438119547)*x[1]**o+(-0.131885152617)*x[1]
        arg[1,0,2,1]=(0.489885370386)*x[0]**o+(-0.958785443386)*x[0]+(-0.934023631551)*x[1]**o+(-0.120727978484)*x[1]
        arg[1,1,0,0]=(-0.104659311537)*x[0]**o+(0.323817119133)*x[0]+(0.207178629335)*x[1]**o+(0.132677138305)*x[1]
        arg[1,1,0,1]=(0.855593354128)*x[0]**o+(-0.319099268106)*x[0]+(-0.75522659926)*x[1]**o+(0.398648791668)*x[1]
        arg[1,1,1,0]=(0.165499959353)*x[0]**o+(0.025416591231)*x[0]+(-0.454711374202)*x[1]**o+(-0.149643847094)*x[1]
        arg[1,1,1,1]=(0.668195333828)*x[0]**o+(-0.954315351102)*x[0]+(-0.15549992542)*x[1]**o+(0.960203842246)*x[1]
        arg[1,1,2,0]=(-0.0830862028828)*x[0]**o+(0.104413343709)*x[0]+(0.0666836881524)*x[1]**o+(-0.909918510114)*x[1]
        arg[1,1,2,1]=(-0.614061685098)*x[0]**o+(-0.696536572273)*x[0]+(0.674867602585)*x[1]**o+(0.742233774001)*x[1]
        arg[1,2,0,0]=(-0.271025278576)*x[0]**o+(0.194146585691)*x[0]+(0.369545867263)*x[1]**o+(-0.444209773003)*x[1]
        arg[1,2,0,1]=(-0.646570016511)*x[0]**o+(-0.1181935343)*x[0]+(-0.473468176784)*x[1]**o+(0.980639666617)*x[1]
        arg[1,2,1,0]=(-0.274558546949)*x[0]**o+(-0.994564294804)*x[0]+(-0.710677848448)*x[1]**o+(-0.471981673909)*x[1]
        arg[1,2,1,1]=(0.920326662139)*x[0]**o+(-0.503477706392)*x[0]+(-0.488075258363)*x[1]**o+(-0.390701293427)*x[1]
        arg[1,2,2,0]=(-0.734779609501)*x[0]**o+(-0.211522964885)*x[0]+(-0.209704158218)*x[1]**o+(0.602143419316)*x[1]
        arg[1,2,2,1]=(-0.71042927509)*x[0]**o+(-0.320801535296)*x[0]+(-0.307645214006)*x[1]**o+(0.902857741355)*x[1]
        arg[1,3,0,0]=(0.430044544461)*x[0]**o+(-0.321809854969)*x[0]+(-0.202705286059)*x[1]**o+(-0.136245903236)*x[1]
        arg[1,3,0,1]=(-0.0215232394148)*x[0]**o+(0.560515199075)*x[0]+(0.183422356152)*x[1]**o+(0.0500950744933)*x[1]
        arg[1,3,1,0]=(0.956072319541)*x[0]**o+(-0.910407504398)*x[0]+(0.710351406673)*x[1]**o+(-0.673149941902)*x[1]
        arg[1,3,1,1]=(0.512105745894)*x[0]**o+(0.617656019287)*x[0]+(0.178878380134)*x[1]**o+(-0.304972517759)*x[1]
        arg[1,3,2,0]=(0.505194196756)*x[0]**o+(-0.588278604691)*x[0]+(0.657312673212)*x[1]**o+(-0.198666173753)*x[1]
        arg[1,3,2,1]=(0.562199962955)*x[0]**o+(-0.855080919048)*x[0]+(0.798106457622)*x[1]**o+(-0.462368594285)*x[1]
        arg[1,4,0,0]=(-0.95103819151)*x[0]**o+(0.996179304819)*x[0]+(0.720809353558)*x[1]**o+(-0.357882371835)*x[1]
        arg[1,4,0,1]=(-0.337212448334)*x[0]**o+(-0.647939092937)*x[0]+(0.432152553594)*x[1]**o+(0.284393585377)*x[1]
        arg[1,4,1,0]=(0.286170290079)*x[0]**o+(0.813168170391)*x[0]+(-0.178814496497)*x[1]**o+(0.414687546663)*x[1]
        arg[1,4,1,1]=(0.00961378883254)*x[0]**o+(-0.946718643529)*x[0]+(0.828780485661)*x[1]**o+(0.54461217692)*x[1]
        arg[1,4,2,0]=(0.784403348421)*x[0]**o+(0.430078584466)*x[0]+(-0.542741131881)*x[1]**o+(0.0290828265624)*x[1]
        arg[1,4,2,1]=(-0.246343667616)*x[0]**o+(-0.27406067089)*x[0]+(-0.938704878102)*x[1]**o+(0.907921504301)*x[1]
        arg[2,0,0,0]=(-0.551056874357)*x[0]**o+(-0.697006980356)*x[0]+(-0.733447125487)*x[1]**o+(-0.241902075189)*x[1]
        arg[2,0,0,1]=(-0.75556701159)*x[0]**o+(0.155303331948)*x[0]+(0.480546881289)*x[1]**o+(-0.420954472057)*x[1]
        arg[2,0,1,0]=(0.12990139506)*x[0]**o+(-0.0990388974263)*x[0]+(-0.913089275462)*x[1]**o+(-0.766316334455)*x[1]
        arg[2,0,1,1]=(-0.96760564527)*x[0]**o+(0.94596820894)*x[0]+(-0.208507053422)*x[1]**o+(0.82642580152)*x[1]
        arg[2,0,2,0]=(-0.801660576339)*x[0]**o+(0.724091208253)*x[0]+(-0.416451086696)*x[1]**o+(-0.255959329575)*x[1]
        arg[2,0,2,1]=(0.380233654687)*x[0]**o+(-0.27467061721)*x[0]+(-0.626861863133)*x[1]**o+(0.498725464891)*x[1]
        arg[2,1,0,0]=(0.733227197081)*x[0]**o+(-0.111622822078)*x[0]+(-0.199363221943)*x[1]**o+(-0.449664634046)*x[1]
        arg[2,1,0,1]=(0.381774304841)*x[0]**o+(0.914208421879)*x[0]+(-0.545958908798)*x[1]**o+(-0.344721917598)*x[1]
        arg[2,1,1,0]=(-0.861412661903)*x[0]**o+(-0.202264578976)*x[0]+(-0.225404313047)*x[1]**o+(0.716189374265)*x[1]
        arg[2,1,1,1]=(-0.180088205315)*x[0]**o+(0.133136657032)*x[0]+(-0.341650807958)*x[1]**o+(-0.570348715256)*x[1]
        arg[2,1,2,0]=(-0.626863150737)*x[0]**o+(-0.236854925766)*x[0]+(-0.271186155613)*x[1]**o+(-0.750500826476)*x[1]
        arg[2,1,2,1]=(-0.138580929054)*x[0]**o+(-0.925057205334)*x[0]+(0.404961686669)*x[1]**o+(0.542298342705)*x[1]
        arg[2,2,0,0]=(0.453186536783)*x[0]**o+(0.368065177204)*x[0]+(0.545211472015)*x[1]**o+(0.334551805933)*x[1]
        arg[2,2,0,1]=(0.0639699038803)*x[0]**o+(0.154192875522)*x[0]+(0.101347900441)*x[1]**o+(-0.668313576443)*x[1]
        arg[2,2,1,0]=(0.465173445732)*x[0]**o+(-0.475009875122)*x[0]+(-0.748444748361)*x[1]**o+(0.620845514745)*x[1]
        arg[2,2,1,1]=(0.720975965615)*x[0]**o+(-0.266631032721)*x[0]+(0.0996389916136)*x[1]**o+(-0.96886977517)*x[1]
        arg[2,2,2,0]=(-0.396391719953)*x[0]**o+(-0.240091626001)*x[0]+(-0.42411685734)*x[1]**o+(-0.458446010754)*x[1]
        arg[2,2,2,1]=(-0.662584035264)*x[0]**o+(0.23813614536)*x[0]+(0.810893160816)*x[1]**o+(-0.130143663026)*x[1]
        arg[2,3,0,0]=(-0.651550480594)*x[0]**o+(0.370844612999)*x[0]+(-0.808002027275)*x[1]**o+(0.531083477622)*x[1]
        arg[2,3,0,1]=(-0.287184182382)*x[0]**o+(0.928877646221)*x[0]+(-0.271563784371)*x[1]**o+(-0.46908309398)*x[1]
        arg[2,3,1,0]=(0.342080138259)*x[0]**o+(0.458994887529)*x[0]+(-0.544475387926)*x[1]**o+(-0.203224249914)*x[1]
        arg[2,3,1,1]=(-0.0791009979206)*x[0]**o+(0.536480501773)*x[0]+(-0.624008015173)*x[1]**o+(-0.380504135174)*x[1]
        arg[2,3,2,0]=(-0.707089360149)*x[0]**o+(0.217716900812)*x[0]+(0.020441009853)*x[1]**o+(0.680214150153)*x[1]
        arg[2,3,2,1]=(0.0368635610611)*x[0]**o+(0.646697307691)*x[0]+(0.36118713723)*x[1]**o+(-0.535295583008)*x[1]
        arg[2,4,0,0]=(0.806938680905)*x[0]**o+(0.449096825134)*x[0]+(-0.43507826254)*x[1]**o+(-0.300956286252)*x[1]
        arg[2,4,0,1]=(-0.268005914326)*x[0]**o+(0.583132947291)*x[0]+(-0.344067495236)*x[1]**o+(-0.526011968282)*x[1]
        arg[2,4,1,0]=(-0.0953663458348)*x[0]**o+(0.834765967023)*x[0]+(-0.0410345097335)*x[1]**o+(0.493198054713)*x[1]
        arg[2,4,1,1]=(0.964777812988)*x[0]**o+(-0.791397009733)*x[0]+(-0.962108127047)*x[1]**o+(0.378083818799)*x[1]
        arg[2,4,2,0]=(0.0977715857241)*x[0]**o+(-0.118265910205)*x[0]+(-0.0181736456148)*x[1]**o+(-0.480499109439)*x[1]
        arg[2,4,2,1]=(0.396936262802)*x[0]**o+(0.979807961416)*x[0]+(0.383251286227)*x[1]**o+(-0.921599329372)*x[1]
        arg[3,0,0,0]=(-0.193869568904)*x[0]**o+(0.335533150532)*x[0]+(-0.542087879921)*x[1]**o+(0.916531699685)*x[1]
        arg[3,0,0,1]=(0.732192438113)*x[0]**o+(0.610866210623)*x[0]+(0.232455584069)*x[1]**o+(0.109577342902)*x[1]
        arg[3,0,1,0]=(0.0487640958479)*x[0]**o+(-0.250229114846)*x[0]+(-0.539343546695)*x[1]**o+(-0.456485153733)*x[1]
        arg[3,0,1,1]=(0.951844805407)*x[0]**o+(-0.811442383281)*x[0]+(-0.537581471096)*x[1]**o+(0.350217063609)*x[1]
        arg[3,0,2,0]=(0.495490307938)*x[0]**o+(0.529667417659)*x[0]+(-0.853447043865)*x[1]**o+(0.97002519322)*x[1]
        arg[3,0,2,1]=(0.38188303469)*x[0]**o+(-0.75911672537)*x[0]+(-0.67563531103)*x[1]**o+(0.384002769031)*x[1]
        arg[3,1,0,0]=(0.44471228922)*x[0]**o+(-0.958995287488)*x[0]+(-0.356730659314)*x[1]**o+(0.853749081247)*x[1]
        arg[3,1,0,1]=(-0.674677862576)*x[0]**o+(-0.651945231545)*x[0]+(-0.869871613483)*x[1]**o+(0.518493292422)*x[1]
        arg[3,1,1,0]=(-0.803923033456)*x[0]**o+(0.916638584514)*x[0]+(-0.410056071233)*x[1]**o+(-0.313811798732)*x[1]
        arg[3,1,1,1]=(-0.677586574312)*x[0]**o+(0.101317771211)*x[0]+(-0.848629733526)*x[1]**o+(0.956935407827)*x[1]
        arg[3,1,2,0]=(0.723956969878)*x[0]**o+(-0.677929268987)*x[0]+(0.168694427833)*x[1]**o+(0.675664564011)*x[1]
        arg[3,1,2,1]=(-0.0961257584415)*x[0]**o+(0.870273004118)*x[0]+(0.0979731186867)*x[1]**o+(-0.561786099655)*x[1]
        arg[3,2,0,0]=(-0.506857925404)*x[0]**o+(0.950429186893)*x[0]+(-0.765686972231)*x[1]**o+(0.300787357163)*x[1]
        arg[3,2,0,1]=(-0.479464705052)*x[0]**o+(-0.814881390688)*x[0]+(-0.549033177495)*x[1]**o+(0.875164713771)*x[1]
        arg[3,2,1,0]=(0.984579775952)*x[0]**o+(0.822464384935)*x[0]+(-0.352937841183)*x[1]**o+(-0.389516730371)*x[1]
        arg[3,2,1,1]=(-0.75230207503)*x[0]**o+(0.921759892886)*x[0]+(0.683120790039)*x[1]**o+(0.470250085193)*x[1]
        arg[3,2,2,0]=(-0.257935272452)*x[0]**o+(-0.437370511818)*x[0]+(-0.350363036315)*x[1]**o+(-0.232415372202)*x[1]
        arg[3,2,2,1]=(0.0784702766009)*x[0]**o+(0.460959683819)*x[0]+(0.758201028024)*x[1]**o+(0.101597092257)*x[1]
        arg[3,3,0,0]=(0.292597181224)*x[0]**o+(-0.322992033991)*x[0]+(-0.536413055541)*x[1]**o+(-0.95609054732)*x[1]
        arg[3,3,0,1]=(0.174134715952)*x[0]**o+(0.811729326606)*x[0]+(0.89040777319)*x[1]**o+(0.893572419966)*x[1]
        arg[3,3,1,0]=(0.768234215847)*x[0]**o+(0.36391719033)*x[0]+(0.598889528719)*x[1]**o+(0.152035960251)*x[1]
        arg[3,3,1,1]=(-0.77938361663)*x[0]**o+(-0.448945619013)*x[0]+(0.471242869055)*x[1]**o+(0.112888214554)*x[1]
        arg[3,3,2,0]=(-0.00617753872016)*x[0]**o+(0.0155218100192)*x[0]+(0.674100983537)*x[1]**o+(0.211406831421)*x[1]
        arg[3,3,2,1]=(0.124470359441)*x[0]**o+(0.117393617733)*x[0]+(-0.297791856337)*x[1]**o+(-0.210405798241)*x[1]
        arg[3,4,0,0]=(0.139920132608)*x[0]**o+(-0.0073381380034)*x[0]+(-0.77267392403)*x[1]**o+(0.792299687107)*x[1]
        arg[3,4,0,1]=(0.328592839797)*x[0]**o+(-0.758899359217)*x[0]+(0.730856047416)*x[1]**o+(-0.389548922357)*x[1]
        arg[3,4,1,0]=(-0.239362896774)*x[0]**o+(0.513205289336)*x[0]+(-0.393781550386)*x[1]**o+(0.229968513732)*x[1]
        arg[3,4,1,1]=(0.777985150139)*x[0]**o+(0.273278793895)*x[0]+(0.17782134987)*x[1]**o+(0.491127331923)*x[1]
        arg[3,4,2,0]=(0.348482781008)*x[0]**o+(0.458696185739)*x[0]+(-0.77882422986)*x[1]**o+(0.455739446004)*x[1]
        arg[3,4,2,1]=(-0.396751338134)*x[0]**o+(0.449026376364)*x[0]+(0.308553967581)*x[1]**o+(-0.777653415416)*x[1]
        ref[0,0,0,0]=(-0.848175950825)/(o+1.)+(-0.060984579579)+(0.423100205741)*0.5**o
        ref[0,0,0,1]=(-0.838397517739)/(o+1.)+(-0.289891489711)+(-0.739687474039)*0.5**o
        ref[0,0,1,0]=(-0.616976579504)/(o+1.)+(-0.556983314949)+(-0.423462958438)*0.5**o
        ref[0,0,1,1]=(-0.953014661461)/(o+1.)+(0.500001792807)+(-0.432533121428)*0.5**o
        ref[0,0,2,0]=(-0.156191993934)/(o+1.)+(0.883028259835)+(-0.891613775753)*0.5**o
        ref[0,0,2,1]=(-0.68287286477)/(o+1.)+(0.0522510271596)+(0.909573147888)*0.5**o
        ref[0,1,0,0]=(-0.631624427826)/(o+1.)+(-0.340055925409)+(-0.39808363424)*0.5**o
        ref[0,1,0,1]=(-0.0750972377036)/(o+1.)+(0.566030507884)+(-0.748658247224)*0.5**o
        ref[0,1,1,0]=(-0.163646238293)/(o+1.)+(-0.578922683831)+(0.877627912148)*0.5**o
        ref[0,1,1,1]=(0.0667564973731)/(o+1.)+(0.438204826712)+(-0.592580581615)*0.5**o
        ref[0,1,2,0]=(-0.899276958155)/(o+1.)+(-0.684200628566)+(-0.505569292541)*0.5**o
        ref[0,1,2,1]=(0.912452712698)/(o+1.)+(-0.0949204253183)+(-0.215752366701)*0.5**o
        ref[0,2,0,0]=(0.267409202785)/(o+1.)+(0.560565813511)+(0.684112319204)*0.5**o
        ref[0,2,0,1]=(-0.152472725029)/(o+1.)+(-0.48936178263)+(0.552438501301)*0.5**o
        ref[0,2,1,0]=(-0.873134889407)/(o+1.)+(-0.0460827720855)+(-0.31213422297)*0.5**o
        ref[0,2,1,1]=(-0.761310589424)/(o+1.)+(-0.676170252134)+(0.883048532408)*0.5**o
        ref[0,2,2,0]=(-0.936381308418)/(o+1.)+(-0.00265386081956)+(-0.324489237508)*0.5**o
        ref[0,2,2,1]=(0.419811305063)/(o+1.)+(0.109993113022)+(-0.971735193469)*0.5**o
        ref[0,3,0,0]=(0.707279059071)/(o+1.)+(-0.86543390192)+(-0.305553454905)*0.5**o
        ref[0,3,0,1]=(0.819264129099)/(o+1.)+(0.0693620181083)+(0.803934620926)*0.5**o
        ref[0,3,1,0]=(-0.60262522048)/(o+1.)+(-0.484758941318)+(0.996632326055)*0.5**o
        ref[0,3,1,1]=(0.722837842981)/(o+1.)+(0.309131271645)+(0.402799911553)*0.5**o
        ref[0,3,2,0]=(0.62363567076)/(o+1.)+(-0.700867024115)+(0.937966588808)*0.5**o
        ref[0,3,2,1]=(-0.950660964237)/(o+1.)+(0.261278793995)+(-0.0389713032301)*0.5**o
        ref[0,4,0,0]=(-0.872148906918)/(o+1.)+(-0.692114808131)+(-0.589529640529)*0.5**o
        ref[0,4,0,1]=(0.329194160571)/(o+1.)+(0.651123856087)+(0.78615039967)*0.5**o
        ref[0,4,1,0]=(0.107007555422)/(o+1.)+(0.132524151069)+(-0.801187683466)*0.5**o
        ref[0,4,1,1]=(-0.720479146591)/(o+1.)+(0.517763642707)+(0.817551079419)*0.5**o
        ref[0,4,2,0]=(0.766214937295)/(o+1.)+(0.432935513335)+(-0.245391293539)*0.5**o
        ref[0,4,2,1]=(-0.993826355778)/(o+1.)+(-0.776337331653)+(-0.780163545255)*0.5**o
        ref[1,0,0,0]=(-0.00667060999489)/(o+1.)+(-0.619099615632)+(0.0998104654851)*0.5**o
        ref[1,0,0,1]=(0.118004968786)/(o+1.)+(-0.449362980069)+(0.716858223574)*0.5**o
        ref[1,0,1,0]=(0.10117572965)/(o+1.)+(0.104308578827)+(0.433505460082)*0.5**o
        ref[1,0,1,1]=(-0.221528653572)/(o+1.)+(-0.329803925788)+(0.93394463477)*0.5**o
        ref[1,0,2,0]=(0.798438119547)/(o+1.)+(0.309503333977)+(0.217926136552)*0.5**o
        ref[1,0,2,1]=(-0.934023631551)/(o+1.)+(-0.539756710935)+(0.489885370386)*0.5**o
        ref[1,1,0,0]=(0.207178629335)/(o+1.)+(0.228247128719)+(-0.104659311537)*0.5**o
        ref[1,1,0,1]=(-0.75522659926)/(o+1.)+(0.0397747617809)+(0.855593354128)*0.5**o
        ref[1,1,1,0]=(-0.454711374202)/(o+1.)+(-0.0621136279316)+(0.165499959353)*0.5**o
        ref[1,1,1,1]=(-0.15549992542)/(o+1.)+(0.00294424557217)+(0.668195333828)*0.5**o
        ref[1,1,2,0]=(0.0666836881524)/(o+1.)+(-0.402752583203)+(-0.0830862028828)*0.5**o
        ref[1,1,2,1]=(0.674867602585)/(o+1.)+(0.0228486008642)+(-0.614061685098)*0.5**o
        ref[1,2,0,0]=(0.369545867263)/(o+1.)+(-0.125031593656)+(-0.271025278576)*0.5**o
        ref[1,2,0,1]=(-0.473468176784)/(o+1.)+(0.431223066159)+(-0.646570016511)*0.5**o
        ref[1,2,1,0]=(-0.710677848448)/(o+1.)+(-0.733272984356)+(-0.274558546949)*0.5**o
        ref[1,2,1,1]=(-0.488075258363)/(o+1.)+(-0.44708949991)+(0.920326662139)*0.5**o
        ref[1,2,2,0]=(-0.209704158218)/(o+1.)+(0.195310227215)+(-0.734779609501)*0.5**o
        ref[1,2,2,1]=(-0.307645214006)/(o+1.)+(0.29102810303)+(-0.71042927509)*0.5**o
        ref[1,3,0,0]=(-0.202705286059)/(o+1.)+(-0.229027879102)+(0.430044544461)*0.5**o
        ref[1,3,0,1]=(0.183422356152)/(o+1.)+(0.305305136784)+(-0.0215232394148)*0.5**o
        ref[1,3,1,0]=(0.710351406673)/(o+1.)+(-0.79177872315)+(0.956072319541)*0.5**o
        ref[1,3,1,1]=(0.178878380134)/(o+1.)+(0.156341750764)+(0.512105745894)*0.5**o
        ref[1,3,2,0]=(0.657312673212)/(o+1.)+(-0.393472389222)+(0.505194196756)*0.5**o
        ref[1,3,2,1]=(0.798106457622)/(o+1.)+(-0.658724756667)+(0.562199962955)*0.5**o
        ref[1,4,0,0]=(0.720809353558)/(o+1.)+(0.319148466492)+(-0.95103819151)*0.5**o
        ref[1,4,0,1]=(0.432152553594)/(o+1.)+(-0.18177275378)+(-0.337212448334)*0.5**o
        ref[1,4,1,0]=(-0.178814496497)/(o+1.)+(0.613927858527)+(0.286170290079)*0.5**o
        ref[1,4,1,1]=(0.828780485661)/(o+1.)+(-0.201053233304)+(0.00961378883254)*0.5**o
        ref[1,4,2,0]=(-0.542741131881)/(o+1.)+(0.229580705514)+(0.784403348421)*0.5**o
        ref[1,4,2,1]=(-0.938704878102)/(o+1.)+(0.316930416706)+(-0.246343667616)*0.5**o
        ref[2,0,0,0]=(-0.733447125487)/(o+1.)+(-0.469454527772)+(-0.551056874357)*0.5**o
        ref[2,0,0,1]=(0.480546881289)/(o+1.)+(-0.132825570055)+(-0.75556701159)*0.5**o
        ref[2,0,1,0]=(-0.913089275462)/(o+1.)+(-0.432677615941)+(0.12990139506)*0.5**o
        ref[2,0,1,1]=(-0.208507053422)/(o+1.)+(0.88619700523)+(-0.96760564527)*0.5**o
        ref[2,0,2,0]=(-0.416451086696)/(o+1.)+(0.234065939339)+(-0.801660576339)*0.5**o
        ref[2,0,2,1]=(-0.626861863133)/(o+1.)+(0.112027423841)+(0.380233654687)*0.5**o
        ref[2,1,0,0]=(-0.199363221943)/(o+1.)+(-0.280643728062)+(0.733227197081)*0.5**o
        ref[2,1,0,1]=(-0.545958908798)/(o+1.)+(0.284743252141)+(0.381774304841)*0.5**o
        ref[2,1,1,0]=(-0.225404313047)/(o+1.)+(0.256962397644)+(-0.861412661903)*0.5**o
        ref[2,1,1,1]=(-0.341650807958)/(o+1.)+(-0.218606029112)+(-0.180088205315)*0.5**o
        ref[2,1,2,0]=(-0.271186155613)/(o+1.)+(-0.493677876121)+(-0.626863150737)*0.5**o
        ref[2,1,2,1]=(0.404961686669)/(o+1.)+(-0.191379431315)+(-0.138580929054)*0.5**o
        ref[2,2,0,0]=(0.545211472015)/(o+1.)+(0.351308491569)+(0.453186536783)*0.5**o
        ref[2,2,0,1]=(0.101347900441)/(o+1.)+(-0.257060350461)+(0.0639699038803)*0.5**o
        ref[2,2,1,0]=(-0.748444748361)/(o+1.)+(0.0729178198114)+(0.465173445732)*0.5**o
        ref[2,2,1,1]=(0.0996389916136)/(o+1.)+(-0.617750403946)+(0.720975965615)*0.5**o
        ref[2,2,2,0]=(-0.42411685734)/(o+1.)+(-0.349268818378)+(-0.396391719953)*0.5**o
        ref[2,2,2,1]=(0.810893160816)/(o+1.)+(0.053996241167)+(-0.662584035264)*0.5**o
        ref[2,3,0,0]=(-0.808002027275)/(o+1.)+(0.45096404531)+(-0.651550480594)*0.5**o
        ref[2,3,0,1]=(-0.271563784371)/(o+1.)+(0.22989727612)+(-0.287184182382)*0.5**o
        ref[2,3,1,0]=(-0.544475387926)/(o+1.)+(0.127885318807)+(0.342080138259)*0.5**o
        ref[2,3,1,1]=(-0.624008015173)/(o+1.)+(0.0779881832997)+(-0.0791009979206)*0.5**o
        ref[2,3,2,0]=(0.020441009853)/(o+1.)+(0.448965525483)+(-0.707089360149)*0.5**o
        ref[2,3,2,1]=(0.36118713723)/(o+1.)+(0.0557008623413)+(0.0368635610611)*0.5**o
        ref[2,4,0,0]=(-0.43507826254)/(o+1.)+(0.0740702694408)+(0.806938680905)*0.5**o
        ref[2,4,0,1]=(-0.344067495236)/(o+1.)+(0.0285604895043)+(-0.268005914326)*0.5**o
        ref[2,4,1,0]=(-0.0410345097335)/(o+1.)+(0.663982010868)+(-0.0953663458348)*0.5**o
        ref[2,4,1,1]=(-0.962108127047)/(o+1.)+(-0.206656595467)+(0.964777812988)*0.5**o
        ref[2,4,2,0]=(-0.0181736456148)/(o+1.)+(-0.299382509822)+(0.0977715857241)*0.5**o
        ref[2,4,2,1]=(0.383251286227)/(o+1.)+(0.0291043160221)+(0.396936262802)*0.5**o
        ref[3,0,0,0]=(-0.542087879921)/(o+1.)+(0.626032425109)+(-0.193869568904)*0.5**o
        ref[3,0,0,1]=(0.232455584069)/(o+1.)+(0.360221776762)+(0.732192438113)*0.5**o
        ref[3,0,1,0]=(-0.539343546695)/(o+1.)+(-0.353357134289)+(0.0487640958479)*0.5**o
        ref[3,0,1,1]=(-0.537581471096)/(o+1.)+(-0.230612659836)+(0.951844805407)*0.5**o
        ref[3,0,2,0]=(-0.853447043865)/(o+1.)+(0.74984630544)+(0.495490307938)*0.5**o
        ref[3,0,2,1]=(-0.67563531103)/(o+1.)+(-0.187556978169)+(0.38188303469)*0.5**o
        ref[3,1,0,0]=(-0.356730659314)/(o+1.)+(-0.0526231031206)+(0.44471228922)*0.5**o
        ref[3,1,0,1]=(-0.869871613483)/(o+1.)+(-0.0667259695618)+(-0.674677862576)*0.5**o
        ref[3,1,1,0]=(-0.410056071233)/(o+1.)+(0.301413392891)+(-0.803923033456)*0.5**o
        ref[3,1,1,1]=(-0.848629733526)/(o+1.)+(0.529126589519)+(-0.677586574312)*0.5**o
        ref[3,1,2,0]=(0.168694427833)/(o+1.)+(-0.00113235248793)+(0.723956969878)*0.5**o
        ref[3,1,2,1]=(0.0979731186867)/(o+1.)+(0.154243452232)+(-0.0961257584415)*0.5**o
        ref[3,2,0,0]=(-0.765686972231)/(o+1.)+(0.625608272028)+(-0.506857925404)*0.5**o
        ref[3,2,0,1]=(-0.549033177495)/(o+1.)+(0.0301416615418)+(-0.479464705052)*0.5**o
        ref[3,2,1,0]=(-0.352937841183)/(o+1.)+(0.216473827282)+(0.984579775952)*0.5**o
        ref[3,2,1,1]=(0.683120790039)/(o+1.)+(0.696004989039)+(-0.75230207503)*0.5**o
        ref[3,2,2,0]=(-0.350363036315)/(o+1.)+(-0.33489294201)+(-0.257935272452)*0.5**o
        ref[3,2,2,1]=(0.758201028024)/(o+1.)+(0.281278388038)+(0.0784702766009)*0.5**o
        ref[3,3,0,0]=(-0.536413055541)/(o+1.)+(-0.639541290655)+(0.292597181224)*0.5**o
        ref[3,3,0,1]=(0.89040777319)/(o+1.)+(0.852650873286)+(0.174134715952)*0.5**o
        ref[3,3,1,0]=(0.598889528719)/(o+1.)+(0.257976575291)+(0.768234215847)*0.5**o
        ref[3,3,1,1]=(0.471242869055)/(o+1.)+(-0.168028702229)+(-0.77938361663)*0.5**o
        ref[3,3,2,0]=(0.674100983537)/(o+1.)+(0.11346432072)+(-0.00617753872016)*0.5**o
        ref[3,3,2,1]=(-0.297791856337)/(o+1.)+(-0.0465060902539)+(0.124470359441)*0.5**o
        ref[3,4,0,0]=(-0.77267392403)/(o+1.)+(0.392480774552)+(0.139920132608)*0.5**o
        ref[3,4,0,1]=(0.730856047416)/(o+1.)+(-0.574224140787)+(0.328592839797)*0.5**o
        ref[3,4,1,0]=(-0.393781550386)/(o+1.)+(0.371586901534)+(-0.239362896774)*0.5**o
        ref[3,4,1,1]=(0.17782134987)/(o+1.)+(0.382203062909)+(0.777985150139)*0.5**o
        ref[3,4,2,0]=(-0.77882422986)/(o+1.)+(0.457217815872)+(0.348482781008)*0.5**o
        ref[3,4,2,1]=(0.308553967581)/(o+1.)+(-0.164313519526)+(-0.396751338134)*0.5**o
      else:
        arg[0,0,0,0]=(0.663998508168)*x[0]**o+(0.797340164931)*x[0]+(0.285182001599)*x[1]**o+(0.99720606542)*x[1]+(0.127610260108)*x[2]**o+(0.0141819362674)*x[2]
        arg[0,0,0,1]=(-0.010130464476)*x[0]**o+(-0.694140348803)*x[0]+(-0.554528445238)*x[1]**o+(0.192639775817)*x[1]+(-0.520164891934)*x[2]**o+(0.316830081989)*x[2]
        arg[0,0,1,0]=(-0.176542289385)*x[0]**o+(-0.312451025451)*x[0]+(0.33951668081)*x[1]**o+(-0.66674551066)*x[1]+(-0.0515929546862)*x[2]**o+(0.688180995863)*x[2]
        arg[0,0,1,1]=(-0.98152572229)*x[0]**o+(0.156411605196)*x[0]+(0.588065240125)*x[1]**o+(0.665830732172)*x[1]+(-0.834625744106)*x[2]**o+(-0.138276534671)*x[2]
        arg[0,0,2,0]=(0.555897422173)*x[0]**o+(0.0269431977874)*x[0]+(0.671161746561)*x[1]**o+(0.0857445285374)*x[1]+(0.578027911522)*x[2]**o+(0.217805007393)*x[2]
        arg[0,0,2,1]=(0.23127040923)*x[0]**o+(0.624353504617)*x[0]+(-0.433915231286)*x[1]**o+(-0.860173971996)*x[1]+(-0.801472434932)*x[2]**o+(-0.779575445432)*x[2]
        arg[0,1,0,0]=(0.0202445177842)*x[0]**o+(-0.0654289514039)*x[0]+(-0.877581892208)*x[1]**o+(-0.231833216639)*x[1]+(0.609752401432)*x[2]**o+(-0.802673983603)*x[2]
        arg[0,1,0,1]=(0.99935098551)*x[0]**o+(0.665639246142)*x[0]+(0.593510187831)*x[1]**o+(0.213336090684)*x[1]+(0.232667772738)*x[2]**o+(-0.651386262633)*x[2]
        arg[0,1,1,0]=(0.151799117419)*x[0]**o+(-0.34631043288)*x[0]+(-0.264898731671)*x[1]**o+(0.697527693137)*x[1]+(0.389030412719)*x[2]**o+(0.613338381577)*x[2]
        arg[0,1,1,1]=(-0.51422532626)*x[0]**o+(0.228040429268)*x[0]+(-0.276760984751)*x[1]**o+(0.379484010198)*x[1]+(0.896837565192)*x[2]**o+(0.195866552401)*x[2]
        arg[0,1,2,0]=(0.908244888839)*x[0]**o+(0.217098236162)*x[0]+(0.798725721675)*x[1]**o+(0.216635630826)*x[1]+(0.960227216319)*x[2]**o+(-0.885381182879)*x[2]
        arg[0,1,2,1]=(-0.872307766634)*x[0]**o+(0.843197737136)*x[0]+(-0.895220198791)*x[1]**o+(0.866433237518)*x[1]+(0.560344834226)*x[2]**o+(0.895797915384)*x[2]
        arg[0,2,0,0]=(0.00173619592035)*x[0]**o+(-0.209651858019)*x[0]+(0.323249367733)*x[1]**o+(-0.848445788048)*x[1]+(-0.747443572813)*x[2]**o+(0.342929929066)*x[2]
        arg[0,2,0,1]=(0.998184336552)*x[0]**o+(-0.669882578313)*x[0]+(-0.632794054696)*x[1]**o+(-0.779832061924)*x[1]+(0.0588815237456)*x[2]**o+(0.419538634163)*x[2]
        arg[0,2,1,0]=(-0.921234331968)*x[0]**o+(0.319724478943)*x[0]+(0.867192523265)*x[1]**o+(-0.183047755109)*x[1]+(-0.753047661507)*x[2]**o+(-0.797179040607)*x[2]
        arg[0,2,1,1]=(0.153578015941)*x[0]**o+(0.887820807812)*x[0]+(-0.607944647299)*x[1]**o+(-0.0487413965527)*x[1]+(-0.812369692315)*x[2]**o+(0.323102876844)*x[2]
        arg[0,2,2,0]=(0.29601674794)*x[0]**o+(-0.108738759628)*x[0]+(0.242837345895)*x[1]**o+(-0.324487554664)*x[1]+(0.584399369463)*x[2]**o+(0.683877139789)*x[2]
        arg[0,2,2,1]=(0.0580007647099)*x[0]**o+(0.214488016057)*x[0]+(0.669087265419)*x[1]**o+(-0.311999860513)*x[1]+(0.678940598195)*x[2]**o+(0.658847203441)*x[2]
        arg[0,3,0,0]=(-0.337999890505)*x[0]**o+(-0.842479530409)*x[0]+(0.786376708623)*x[1]**o+(0.597298234359)*x[1]+(0.495442668997)*x[2]**o+(-0.183828960943)*x[2]
        arg[0,3,0,1]=(-0.825813329629)*x[0]**o+(0.197040670392)*x[0]+(0.997784261354)*x[1]**o+(-0.355290279278)*x[1]+(0.657909516664)*x[2]**o+(-0.568281670001)*x[2]
        arg[0,3,1,0]=(0.699313512079)*x[0]**o+(-0.916350147519)*x[0]+(-0.311605808179)*x[1]**o+(0.222618888987)*x[1]+(0.872150798976)*x[2]**o+(0.139773150125)*x[2]
        arg[0,3,1,1]=(0.140764124286)*x[0]**o+(0.994013777309)*x[0]+(-0.0792107151558)*x[1]**o+(-0.285357856751)*x[1]+(-0.800285107223)*x[2]**o+(0.413029089978)*x[2]
        arg[0,3,2,0]=(-0.68177752688)*x[0]**o+(0.0339522871939)*x[0]+(-0.641399841911)*x[1]**o+(0.263279621719)*x[1]+(-0.406115766497)*x[2]**o+(-0.774639092638)*x[2]
        arg[0,3,2,1]=(0.655685968811)*x[0]**o+(0.20085918281)*x[0]+(-0.753491228829)*x[1]**o+(0.393669658887)*x[1]+(0.339469131428)*x[2]**o+(0.424803724709)*x[2]
        arg[0,4,0,0]=(-0.18027010068)*x[0]**o+(-0.773007683353)*x[0]+(0.767133020895)*x[1]**o+(-0.810449138606)*x[1]+(0.295421955604)*x[2]**o+(-0.955926880008)*x[2]
        arg[0,4,0,1]=(-0.914768182433)*x[0]**o+(-0.67024319498)*x[0]+(0.533244666277)*x[1]**o+(-0.705719628704)*x[1]+(-0.963633923897)*x[2]**o+(-0.0818895784023)*x[2]
        arg[0,4,1,0]=(0.274727423835)*x[0]**o+(0.838218676826)*x[0]+(0.269989900726)*x[1]**o+(0.650600179293)*x[1]+(-0.855210211935)*x[2]**o+(-0.800261683904)*x[2]
        arg[0,4,1,1]=(0.257574026756)*x[0]**o+(-0.787643878696)*x[0]+(-0.619136916008)*x[1]**o+(-0.242580269843)*x[1]+(0.0229959873555)*x[2]**o+(-0.685725009107)*x[2]
        arg[0,4,2,0]=(0.703185665611)*x[0]**o+(0.37686548395)*x[0]+(-0.414901304236)*x[1]**o+(0.310335568741)*x[1]+(-0.740764649572)*x[2]**o+(-0.389356987349)*x[2]
        arg[0,4,2,1]=(-0.153792811673)*x[0]**o+(-0.179777301012)*x[0]+(0.694402537357)*x[1]**o+(-0.928918851291)*x[1]+(-0.439307255129)*x[2]**o+(0.148671231214)*x[2]
        arg[1,0,0,0]=(0.298044833507)*x[0]**o+(0.538000859279)*x[0]+(-0.405432041063)*x[1]**o+(-0.8912548734)*x[1]+(0.929554154255)*x[2]**o+(-0.515905504512)*x[2]
        arg[1,0,0,1]=(-0.575485929806)*x[0]**o+(0.757951009672)*x[0]+(-0.815024122535)*x[1]**o+(0.846519632117)*x[1]+(0.594901198403)*x[2]**o+(-0.672034020351)*x[2]
        arg[1,0,1,0]=(0.998358005707)*x[0]**o+(-0.144729504804)*x[0]+(0.463445062889)*x[1]**o+(0.428918148475)*x[1]+(-0.172684103233)*x[2]**o+(-0.394742387769)*x[2]
        arg[1,0,1,1]=(0.783593367143)*x[0]**o+(-0.269882783638)*x[0]+(-0.880336283806)*x[1]**o+(0.337087191943)*x[1]+(-0.819512478233)*x[2]**o+(0.582924902797)*x[2]
        arg[1,0,2,0]=(-0.42345692756)*x[0]**o+(-0.251910598711)*x[0]+(-0.882193473121)*x[1]**o+(0.535405977525)*x[1]+(-0.117109433242)*x[2]**o+(0.99565775159)*x[2]
        arg[1,0,2,1]=(-0.790917746681)*x[0]**o+(-0.291814540513)*x[0]+(-0.0828604085821)*x[1]**o+(-0.0715382319561)*x[1]+(-0.188453557262)*x[2]**o+(0.297596604241)*x[2]
        arg[1,1,0,0]=(0.944343622558)*x[0]**o+(0.537893843235)*x[0]+(-0.370697218599)*x[1]**o+(-0.043709074747)*x[1]+(-0.803318845377)*x[2]**o+(0.814392946479)*x[2]
        arg[1,1,0,1]=(-0.246711023019)*x[0]**o+(-0.847902406307)*x[0]+(0.062135604814)*x[1]**o+(0.581341495124)*x[1]+(0.561484848132)*x[2]**o+(0.06820017559)*x[2]
        arg[1,1,1,0]=(-0.530782063061)*x[0]**o+(-0.951246029994)*x[0]+(-0.809647094351)*x[1]**o+(0.198165508669)*x[1]+(0.591475451485)*x[2]**o+(-0.0567469904903)*x[2]
        arg[1,1,1,1]=(-0.710844761085)*x[0]**o+(0.742146961382)*x[0]+(0.482950602277)*x[1]**o+(-0.701576649521)*x[1]+(0.752305355358)*x[2]**o+(0.658478074845)*x[2]
        arg[1,1,2,0]=(0.574657505707)*x[0]**o+(-0.268094098242)*x[0]+(-0.79745549318)*x[1]**o+(0.994732385826)*x[1]+(0.36752110393)*x[2]**o+(0.0733521344978)*x[2]
        arg[1,1,2,1]=(-0.365373199615)*x[0]**o+(0.295532428151)*x[0]+(-0.916049089517)*x[1]**o+(0.562876895658)*x[1]+(0.698818392781)*x[2]**o+(0.413166153315)*x[2]
        arg[1,2,0,0]=(0.544776615353)*x[0]**o+(-0.647889580869)*x[0]+(-0.0569263298125)*x[1]**o+(0.145083519829)*x[1]+(-0.0456368749942)*x[2]**o+(0.125915481669)*x[2]
        arg[1,2,0,1]=(0.11684721915)*x[0]**o+(-0.793592672443)*x[0]+(-0.428585283805)*x[1]**o+(0.280358391066)*x[1]+(0.72731741847)*x[2]**o+(-0.320459136831)*x[2]
        arg[1,2,1,0]=(0.561736948232)*x[0]**o+(0.833411538285)*x[0]+(0.361519222525)*x[1]**o+(-0.785948355356)*x[1]+(-0.595938528895)*x[2]**o+(0.720247127573)*x[2]
        arg[1,2,1,1]=(0.578630452142)*x[0]**o+(0.218238639275)*x[0]+(0.792496779641)*x[1]**o+(-0.818431209813)*x[1]+(-0.252522807953)*x[2]**o+(0.648505893606)*x[2]
        arg[1,2,2,0]=(-0.0269203575755)*x[0]**o+(-0.586454813205)*x[0]+(-0.239885637578)*x[1]**o+(0.186263805313)*x[1]+(0.585909451795)*x[2]**o+(-0.630731036615)*x[2]
        arg[1,2,2,1]=(-0.534642633404)*x[0]**o+(0.921034930282)*x[0]+(-0.326672365556)*x[1]**o+(0.690509146367)*x[1]+(-0.802567575176)*x[2]**o+(-0.235903818924)*x[2]
        arg[1,3,0,0]=(0.892302802156)*x[0]**o+(-0.528836075071)*x[0]+(-0.806520835766)*x[1]**o+(0.771321197577)*x[1]+(-0.545545197249)*x[2]**o+(-0.633185919719)*x[2]
        arg[1,3,0,1]=(0.883702447985)*x[0]**o+(0.698176356191)*x[0]+(-0.348189466787)*x[1]**o+(-0.390058291315)*x[1]+(0.805736008481)*x[2]**o+(0.861787745203)*x[2]
        arg[1,3,1,0]=(0.492527250981)*x[0]**o+(0.635712008949)*x[0]+(-0.464397346193)*x[1]**o+(-0.820952575379)*x[1]+(0.235015001164)*x[2]**o+(-0.846160845231)*x[2]
        arg[1,3,1,1]=(0.372499842901)*x[0]**o+(-0.524824414377)*x[0]+(0.553450359486)*x[1]**o+(-0.187372498756)*x[1]+(-0.389983195918)*x[2]**o+(-0.310421627605)*x[2]
        arg[1,3,2,0]=(0.533098362924)*x[0]**o+(0.917820078197)*x[0]+(-0.557683070597)*x[1]**o+(-0.388498248383)*x[1]+(-0.551866333066)*x[2]**o+(0.696873468511)*x[2]
        arg[1,3,2,1]=(-0.909038123273)*x[0]**o+(0.19323884412)*x[0]+(-0.00134861813725)*x[1]**o+(-0.858193032021)*x[1]+(0.0436856504635)*x[2]**o+(-0.646994265986)*x[2]
        arg[1,4,0,0]=(-0.974474210185)*x[0]**o+(-0.39786371112)*x[0]+(-0.829024534519)*x[1]**o+(0.836151642189)*x[1]+(0.679654655991)*x[2]**o+(0.750995377779)*x[2]
        arg[1,4,0,1]=(0.964745405431)*x[0]**o+(0.269189443297)*x[0]+(0.531636623506)*x[1]**o+(-0.522687387383)*x[1]+(0.463500385567)*x[2]**o+(0.160556224359)*x[2]
        arg[1,4,1,0]=(-0.714725894011)*x[0]**o+(0.0478807291181)*x[0]+(0.591494552904)*x[1]**o+(-0.240293119817)*x[1]+(-0.0463360360003)*x[2]**o+(-0.932835908096)*x[2]
        arg[1,4,1,1]=(-0.809072545597)*x[0]**o+(-0.963335650229)*x[0]+(-0.781885522838)*x[1]**o+(0.822395174213)*x[1]+(-0.42590899181)*x[2]**o+(-0.237357227214)*x[2]
        arg[1,4,2,0]=(-0.21281876112)*x[0]**o+(-0.131640536998)*x[0]+(-0.648680371617)*x[1]**o+(0.555759774031)*x[1]+(-0.911030244394)*x[2]**o+(0.962859403252)*x[2]
        arg[1,4,2,1]=(-0.247930702516)*x[0]**o+(0.509829884687)*x[0]+(0.0387816417333)*x[1]**o+(-0.605945140743)*x[1]+(0.187880415018)*x[2]**o+(-0.813242364046)*x[2]
        arg[2,0,0,0]=(0.616352869937)*x[0]**o+(-0.930708209966)*x[0]+(-0.874778661809)*x[1]**o+(-0.330225154904)*x[1]+(0.632020336392)*x[2]**o+(0.205631598228)*x[2]
        arg[2,0,0,1]=(-0.85704374519)*x[0]**o+(0.99958496465)*x[0]+(0.807095767473)*x[1]**o+(0.63097388144)*x[1]+(0.000665614692828)*x[2]**o+(0.418070858864)*x[2]
        arg[2,0,1,0]=(0.326870102902)*x[0]**o+(0.565855791221)*x[0]+(-0.39418644908)*x[1]**o+(-0.96081735968)*x[1]+(0.937255293725)*x[2]**o+(0.533015538451)*x[2]
        arg[2,0,1,1]=(-0.699939842176)*x[0]**o+(0.808055402204)*x[0]+(0.448948790025)*x[1]**o+(-0.720122241439)*x[1]+(0.0532200858319)*x[2]**o+(-0.204851171261)*x[2]
        arg[2,0,2,0]=(-0.985996827188)*x[0]**o+(-0.604602591167)*x[0]+(0.445903925662)*x[1]**o+(-0.163135114049)*x[1]+(-0.264281316158)*x[2]**o+(-0.381814212863)*x[2]
        arg[2,0,2,1]=(-0.195357773436)*x[0]**o+(0.73285122682)*x[0]+(-0.914846292757)*x[1]**o+(-0.190524885095)*x[1]+(-0.103440307801)*x[2]**o+(-0.0309647945217)*x[2]
        arg[2,1,0,0]=(0.601652939329)*x[0]**o+(-0.757171386065)*x[0]+(-0.91147090556)*x[1]**o+(-0.665258414941)*x[1]+(-0.0504245123191)*x[2]**o+(-0.274928427711)*x[2]
        arg[2,1,0,1]=(0.534038022604)*x[0]**o+(-0.977365399298)*x[0]+(0.884656682614)*x[1]**o+(0.0866421048629)*x[1]+(-0.70687555879)*x[2]**o+(-0.99928465036)*x[2]
        arg[2,1,1,0]=(-0.361196978257)*x[0]**o+(0.192559020092)*x[0]+(-0.0767715201942)*x[1]**o+(0.222254953069)*x[1]+(-0.128362555436)*x[2]**o+(-0.667485829139)*x[2]
        arg[2,1,1,1]=(0.00930987921229)*x[0]**o+(0.269207633273)*x[0]+(0.943798095916)*x[1]**o+(0.483123564952)*x[1]+(-0.231669365037)*x[2]**o+(-0.877005245489)*x[2]
        arg[2,1,2,0]=(-0.181479246679)*x[0]**o+(0.619551810132)*x[0]+(0.499400298722)*x[1]**o+(-0.307864349855)*x[1]+(0.19303040809)*x[2]**o+(0.523640816928)*x[2]
        arg[2,1,2,1]=(-0.99665050175)*x[0]**o+(-0.647775674514)*x[0]+(-0.0015481673821)*x[1]**o+(-0.749198451256)*x[1]+(0.652528193579)*x[2]**o+(-0.0194127861341)*x[2]
        arg[2,2,0,0]=(0.870069083779)*x[0]**o+(0.179747121592)*x[0]+(0.387523112512)*x[1]**o+(0.625711925024)*x[1]+(0.840141938096)*x[2]**o+(0.629709976556)*x[2]
        arg[2,2,0,1]=(-0.841259995642)*x[0]**o+(0.220858862445)*x[0]+(0.397334296484)*x[1]**o+(-0.036654179636)*x[1]+(0.235704322138)*x[2]**o+(-0.6299228864)*x[2]
        arg[2,2,1,0]=(-0.561184923307)*x[0]**o+(-0.643644162376)*x[0]+(0.728784994685)*x[1]**o+(-0.697418070844)*x[1]+(-0.56166463788)*x[2]**o+(-0.668760084534)*x[2]
        arg[2,2,1,1]=(0.92243000401)*x[0]**o+(0.96165833182)*x[0]+(0.540379002453)*x[1]**o+(0.630245078647)*x[1]+(-0.375873656541)*x[2]**o+(0.71424898756)*x[2]
        arg[2,2,2,0]=(0.331131296272)*x[0]**o+(-0.136167378345)*x[0]+(-0.375407637025)*x[1]**o+(-0.0890691004072)*x[1]+(-0.787306129385)*x[2]**o+(-0.447474749986)*x[2]
        arg[2,2,2,1]=(-0.47892171854)*x[0]**o+(0.341448171328)*x[0]+(0.662403724393)*x[1]**o+(0.581128263913)*x[1]+(0.00987835902932)*x[2]**o+(-0.884847129103)*x[2]
        arg[2,3,0,0]=(0.0219406022052)*x[0]**o+(-0.370001982912)*x[0]+(0.948162807268)*x[1]**o+(-0.870857624404)*x[1]+(0.580053532448)*x[2]**o+(-0.488657040041)*x[2]
        arg[2,3,0,1]=(-0.114799511617)*x[0]**o+(0.547853919356)*x[0]+(-0.224367707174)*x[1]**o+(0.551491902831)*x[1]+(-0.101845907889)*x[2]**o+(-0.793527438395)*x[2]
        arg[2,3,1,0]=(-0.103518223905)*x[0]**o+(-0.319840011093)*x[0]+(-0.856612861717)*x[1]**o+(0.0208578084364)*x[1]+(0.132248308449)*x[2]**o+(-0.580663554499)*x[2]
        arg[2,3,1,1]=(-0.958142224242)*x[0]**o+(-0.401299403423)*x[0]+(-0.289034019185)*x[1]**o+(-0.0913958572584)*x[1]+(-0.818515945817)*x[2]**o+(-0.918366425737)*x[2]
        arg[2,3,2,0]=(0.730554594734)*x[0]**o+(0.209964841318)*x[0]+(-0.4157212696)*x[1]**o+(-0.673375403124)*x[1]+(-0.409899056244)*x[2]**o+(0.124418003637)*x[2]
        arg[2,3,2,1]=(-0.930974589897)*x[0]**o+(0.256452400333)*x[0]+(0.778606258675)*x[1]**o+(0.23173182074)*x[1]+(-0.846439682798)*x[2]**o+(-0.408860675089)*x[2]
        arg[2,4,0,0]=(-0.246046780287)*x[0]**o+(-0.653766430943)*x[0]+(0.725379461155)*x[1]**o+(-0.305490823497)*x[1]+(0.0837637468427)*x[2]**o+(-0.458770631133)*x[2]
        arg[2,4,0,1]=(-0.612751147889)*x[0]**o+(0.504418327803)*x[0]+(-0.835051783805)*x[1]**o+(-0.86410559166)*x[1]+(0.928919612861)*x[2]**o+(0.303164594248)*x[2]
        arg[2,4,1,0]=(-0.26092972064)*x[0]**o+(-0.990592356395)*x[0]+(-0.48716443965)*x[1]**o+(0.659447608304)*x[1]+(0.429865593656)*x[2]**o+(-0.661470437053)*x[2]
        arg[2,4,1,1]=(0.325840618456)*x[0]**o+(-0.261974904995)*x[0]+(0.476982730267)*x[1]**o+(-0.738119182885)*x[1]+(0.903618858571)*x[2]**o+(-0.287442022624)*x[2]
        arg[2,4,2,0]=(0.655590135983)*x[0]**o+(-0.135505327297)*x[0]+(-0.38079131346)*x[1]**o+(0.663850751769)*x[1]+(-0.658568109867)*x[2]**o+(-0.267875066063)*x[2]
        arg[2,4,2,1]=(0.570712162768)*x[0]**o+(0.390833274898)*x[0]+(-0.97326103687)*x[1]**o+(-0.419300688467)*x[1]+(0.55695479018)*x[2]**o+(0.547271407555)*x[2]
        arg[3,0,0,0]=(-0.486023722572)*x[0]**o+(-0.790544923201)*x[0]+(0.101237181961)*x[1]**o+(0.23267779263)*x[1]+(-0.458580701132)*x[2]**o+(-0.479449733139)*x[2]
        arg[3,0,0,1]=(-0.705291625776)*x[0]**o+(0.144166702405)*x[0]+(-0.210596631253)*x[1]**o+(0.843721258425)*x[1]+(-0.716420627484)*x[2]**o+(0.145427688875)*x[2]
        arg[3,0,1,0]=(-0.838974120992)*x[0]**o+(0.824423674933)*x[0]+(-0.211643366873)*x[1]**o+(0.603255736693)*x[1]+(-0.119484817371)*x[2]**o+(-0.357272543813)*x[2]
        arg[3,0,1,1]=(0.140027541071)*x[0]**o+(0.373598174368)*x[0]+(-0.661831753147)*x[1]**o+(-0.973724961653)*x[1]+(-0.0738899100301)*x[2]**o+(0.0128579666074)*x[2]
        arg[3,0,2,0]=(-0.39083471939)*x[0]**o+(-0.00821070494132)*x[0]+(-0.315936839906)*x[1]**o+(-0.967556350778)*x[1]+(0.136991762476)*x[2]**o+(0.374041520875)*x[2]
        arg[3,0,2,1]=(0.0734743009776)*x[0]**o+(-0.103186084491)*x[0]+(0.426933353985)*x[1]**o+(-0.631917740007)*x[1]+(0.755296770294)*x[2]**o+(0.492171872216)*x[2]
        arg[3,1,0,0]=(-0.414502599055)*x[0]**o+(0.512031410722)*x[0]+(0.610677049483)*x[1]**o+(-0.075275839509)*x[1]+(0.853407100545)*x[2]**o+(-0.569731924126)*x[2]
        arg[3,1,0,1]=(0.886115095396)*x[0]**o+(0.811807969433)*x[0]+(0.550623354147)*x[1]**o+(-0.703728894875)*x[1]+(0.784318903356)*x[2]**o+(0.45891829089)*x[2]
        arg[3,1,1,0]=(0.312577129879)*x[0]**o+(0.0127110992422)*x[0]+(-0.174614340667)*x[1]**o+(0.744535847679)*x[1]+(0.991125452344)*x[2]**o+(-0.405595301834)*x[2]
        arg[3,1,1,1]=(0.784369258288)*x[0]**o+(-0.709503832235)*x[0]+(0.032963558933)*x[1]**o+(-0.471036543959)*x[1]+(-0.138022967476)*x[2]**o+(-0.38452297541)*x[2]
        arg[3,1,2,0]=(-0.337332295082)*x[0]**o+(-0.460457867002)*x[0]+(-0.102806204559)*x[1]**o+(-0.502889108364)*x[1]+(-0.641488011668)*x[2]**o+(0.359501036527)*x[2]
        arg[3,1,2,1]=(0.791575892417)*x[0]**o+(0.126853712619)*x[0]+(-0.408911942637)*x[1]**o+(0.557039825987)*x[1]+(-0.260719710621)*x[2]**o+(-0.648326395935)*x[2]
        arg[3,2,0,0]=(-0.0909007497318)*x[0]**o+(-0.337085519884)*x[0]+(-0.651987922715)*x[1]**o+(-0.130225558042)*x[1]+(0.926567188664)*x[2]**o+(0.764369275478)*x[2]
        arg[3,2,0,1]=(-0.764137934896)*x[0]**o+(0.443892891832)*x[0]+(0.688197384487)*x[1]**o+(0.485210058592)*x[1]+(0.267932741224)*x[2]**o+(0.0366064885582)*x[2]
        arg[3,2,1,0]=(0.49435832562)*x[0]**o+(0.860649583676)*x[0]+(0.667415091305)*x[1]**o+(0.144069385904)*x[1]+(-0.933847080974)*x[2]**o+(-0.378123304101)*x[2]
        arg[3,2,1,1]=(-0.460752644946)*x[0]**o+(0.491079753273)*x[0]+(-0.536055633506)*x[1]**o+(0.786378615881)*x[1]+(-0.190647453518)*x[2]**o+(-0.192868019034)*x[2]
        arg[3,2,2,0]=(0.0946687985697)*x[0]**o+(0.978197346579)*x[0]+(0.972747948856)*x[1]**o+(-0.575670550665)*x[1]+(-0.096229657916)*x[2]**o+(-0.772567430449)*x[2]
        arg[3,2,2,1]=(0.177521713734)*x[0]**o+(0.0683685252148)*x[0]+(0.423995112682)*x[1]**o+(-0.489247981968)*x[1]+(-0.537130434099)*x[2]**o+(-0.0228879131449)*x[2]
        arg[3,3,0,0]=(0.592201472175)*x[0]**o+(0.674304504132)*x[0]+(0.428414872879)*x[1]**o+(0.956414209094)*x[1]+(-0.272853242491)*x[2]**o+(-0.639858910901)*x[2]
        arg[3,3,0,1]=(0.572972211447)*x[0]**o+(0.943096858489)*x[0]+(-0.990948797302)*x[1]**o+(-0.475383526007)*x[1]+(0.542076985363)*x[2]**o+(-0.884809421862)*x[2]
        arg[3,3,1,0]=(0.775163727164)*x[0]**o+(0.101808074039)*x[0]+(0.575490330857)*x[1]**o+(0.199751068512)*x[1]+(0.538742155685)*x[2]**o+(-0.725822956214)*x[2]
        arg[3,3,1,1]=(-0.244586606882)*x[0]**o+(0.983712254807)*x[0]+(0.187370538052)*x[1]**o+(0.332611385073)*x[1]+(0.536377667373)*x[2]**o+(0.255272558489)*x[2]
        arg[3,3,2,0]=(-0.676040282048)*x[0]**o+(-0.172059284021)*x[0]+(0.25100451419)*x[1]**o+(0.303226061816)*x[1]+(0.138976177556)*x[2]**o+(-0.330104849626)*x[2]
        arg[3,3,2,1]=(-0.136437682299)*x[0]**o+(0.938786085213)*x[0]+(0.853018944962)*x[1]**o+(-0.628078903025)*x[1]+(-0.903567849919)*x[2]**o+(0.837621994591)*x[2]
        arg[3,4,0,0]=(0.28632587806)*x[0]**o+(-0.480626263522)*x[0]+(-0.0537965100699)*x[1]**o+(0.423252432505)*x[1]+(0.200777153039)*x[2]**o+(0.629713098071)*x[2]
        arg[3,4,0,1]=(0.326448964148)*x[0]**o+(0.809991245673)*x[0]+(-0.527362539073)*x[1]**o+(-0.0727890632651)*x[1]+(0.210806278508)*x[2]**o+(0.736535063786)*x[2]
        arg[3,4,1,0]=(0.760474271531)*x[0]**o+(0.378083396435)*x[0]+(-0.991296179693)*x[1]**o+(0.431965391269)*x[1]+(-0.12597704605)*x[2]**o+(-0.128017966575)*x[2]
        arg[3,4,1,1]=(-0.21508452109)*x[0]**o+(-0.583147117492)*x[0]+(0.779535489322)*x[1]**o+(0.601144982341)*x[1]+(-0.870362610456)*x[2]**o+(-0.318535391517)*x[2]
        arg[3,4,2,0]=(-0.195181632154)*x[0]**o+(0.237570596161)*x[0]+(-0.794725125363)*x[1]**o+(0.862030507166)*x[1]+(-0.612206533195)*x[2]**o+(0.494078406766)*x[2]
        arg[3,4,2,1]=(0.270278273932)*x[0]**o+(-0.115833233113)*x[0]+(0.754464364285)*x[1]**o+(-0.186069521903)*x[1]+(-0.864426716229)*x[2]**o+(-0.425054438064)*x[2]
        ref[0,0,0,0]=(0.412792261707)/(o+1.)+(0.904364083309)+(0.663998508168)*0.5**o
        ref[0,0,0,1]=(-1.07469333717)/(o+1.)+(-0.0923352454984)+(-0.010130464476)*0.5**o
        ref[0,0,1,0]=(0.287923726124)/(o+1.)+(-0.145507770124)+(-0.176542289385)*0.5**o
        ref[0,0,1,1]=(-0.24656050398)/(o+1.)+(0.341982901349)+(-0.98152572229)*0.5**o
        ref[0,0,2,0]=(1.24918965808)/(o+1.)+(0.165246366859)+(0.555897422173)*0.5**o
        ref[0,0,2,1]=(-1.23538766622)/(o+1.)+(-0.507697956406)+(0.23127040923)*0.5**o
        ref[0,1,0,0]=(-0.267829490776)/(o+1.)+(-0.549968075823)+(0.0202445177842)*0.5**o
        ref[0,1,0,1]=(0.826177960569)/(o+1.)+(0.113794537096)+(0.99935098551)*0.5**o
        ref[0,1,1,0]=(0.124131681048)/(o+1.)+(0.482277820918)+(0.151799117419)*0.5**o
        ref[0,1,1,1]=(0.620076580442)/(o+1.)+(0.401695495934)+(-0.51422532626)*0.5**o
        ref[0,1,2,0]=(1.75895293799)/(o+1.)+(-0.225823657945)+(0.908244888839)*0.5**o
        ref[0,1,2,1]=(-0.334875364565)/(o+1.)+(1.30271444502)+(-0.872307766634)*0.5**o
        ref[0,2,0,0]=(-0.42419420508)/(o+1.)+(-0.3575838585)+(0.00173619592035)*0.5**o
        ref[0,2,0,1]=(-0.57391253095)/(o+1.)+(-0.515088003037)+(0.998184336552)*0.5**o
        ref[0,2,1,0]=(0.114144861758)/(o+1.)+(-0.330251158386)+(-0.921234331968)*0.5**o
        ref[0,2,1,1]=(-1.42031433961)/(o+1.)+(0.581091144051)+(0.153578015941)*0.5**o
        ref[0,2,2,0]=(0.827236715358)/(o+1.)+(0.125325412749)+(0.29601674794)*0.5**o
        ref[0,2,2,1]=(1.34802786361)/(o+1.)+(0.280667679493)+(0.0580007647099)*0.5**o
        ref[0,3,0,0]=(1.28181937762)/(o+1.)+(-0.214505128496)+(-0.337999890505)*0.5**o
        ref[0,3,0,1]=(1.65569377802)/(o+1.)+(-0.363265639443)+(-0.825813329629)*0.5**o
        ref[0,3,1,0]=(0.560544990797)/(o+1.)+(-0.276979054204)+(0.699313512079)*0.5**o
        ref[0,3,1,1]=(-0.879495822379)/(o+1.)+(0.560842505268)+(0.140764124286)*0.5**o
        ref[0,3,2,0]=(-1.04751560841)/(o+1.)+(-0.238703591863)+(-0.68177752688)*0.5**o
        ref[0,3,2,1]=(-0.414022097401)/(o+1.)+(0.509666283203)+(0.655685968811)*0.5**o
        ref[0,4,0,0]=(1.0625549765)/(o+1.)+(-1.26969185098)+(-0.18027010068)*0.5**o
        ref[0,4,0,1]=(-0.430389257621)/(o+1.)+(-0.728926201043)+(-0.914768182433)*0.5**o
        ref[0,4,1,0]=(-0.585220311209)/(o+1.)+(0.344278586108)+(0.274727423835)*0.5**o
        ref[0,4,1,1]=(-0.596140928652)/(o+1.)+(-0.857974578823)+(0.257574026756)*0.5**o
        ref[0,4,2,0]=(-1.15566595381)/(o+1.)+(0.148922032671)+(0.703185665611)*0.5**o
        ref[0,4,2,1]=(0.255095282229)/(o+1.)+(-0.480012460544)+(-0.153792811673)*0.5**o
        ref[1,0,0,0]=(0.524122113192)/(o+1.)+(-0.434579759316)+(0.298044833507)*0.5**o
        ref[1,0,0,1]=(-0.220122924131)/(o+1.)+(0.466218310719)+(-0.575485929806)*0.5**o
        ref[1,0,1,0]=(0.290760959656)/(o+1.)+(-0.0552768720487)+(0.998358005707)*0.5**o
        ref[1,0,1,1]=(-1.69984876204)/(o+1.)+(0.325064655551)+(0.783593367143)*0.5**o
        ref[1,0,2,0]=(-0.999302906363)/(o+1.)+(0.639576565202)+(-0.42345692756)*0.5**o
        ref[1,0,2,1]=(-0.271313965844)/(o+1.)+(-0.0328780841139)+(-0.790917746681)*0.5**o
        ref[1,1,0,0]=(-1.17401606398)/(o+1.)+(0.654288857484)+(0.944343622558)*0.5**o
        ref[1,1,0,1]=(0.623620452946)/(o+1.)+(-0.0991803677964)+(-0.246711023019)*0.5**o
        ref[1,1,1,0]=(-0.218171642866)/(o+1.)+(-0.404913755908)+(-0.530782063061)*0.5**o
        ref[1,1,1,1]=(1.23525595763)/(o+1.)+(0.349524193353)+(-0.710844761085)*0.5**o
        ref[1,1,2,0]=(-0.42993438925)/(o+1.)+(0.399995211041)+(0.574657505707)*0.5**o
        ref[1,1,2,1]=(-0.217230696736)/(o+1.)+(0.635787738562)+(-0.365373199615)*0.5**o
        ref[1,2,0,0]=(-0.102563204807)/(o+1.)+(-0.188445289686)+(0.544776615353)*0.5**o
        ref[1,2,0,1]=(0.298732134665)/(o+1.)+(-0.416846709104)+(0.11684721915)*0.5**o
        ref[1,2,1,0]=(-0.234419306371)/(o+1.)+(0.383855155251)+(0.561736948232)*0.5**o
        ref[1,2,1,1]=(0.539973971687)/(o+1.)+(0.0241566615339)+(0.578630452142)*0.5**o
        ref[1,2,2,0]=(0.346023814217)/(o+1.)+(-0.515461022254)+(-0.0269203575755)*0.5**o
        ref[1,2,2,1]=(-1.12923994073)/(o+1.)+(0.687820128862)+(-0.534642633404)*0.5**o
        ref[1,3,0,0]=(-1.35206603301)/(o+1.)+(-0.195350398606)+(0.892302802156)*0.5**o
        ref[1,3,0,1]=(0.457546541694)/(o+1.)+(0.584952905039)+(0.883702447985)*0.5**o
        ref[1,3,1,0]=(-0.229382345029)/(o+1.)+(-0.51570070583)+(0.492527250981)*0.5**o
        ref[1,3,1,1]=(0.163467163568)/(o+1.)+(-0.511309270369)+(0.372499842901)*0.5**o
        ref[1,3,2,0]=(-1.10954940366)/(o+1.)+(0.613097649163)+(0.533098362924)*0.5**o
        ref[1,3,2,1]=(0.0423370323263)/(o+1.)+(-0.655974226943)+(-0.909038123273)*0.5**o
        ref[1,4,0,0]=(-0.149369878527)/(o+1.)+(0.594641654424)+(-0.974474210185)*0.5**o
        ref[1,4,0,1]=(0.995137009073)/(o+1.)+(-0.0464708598635)+(0.964745405431)*0.5**o
        ref[1,4,1,0]=(0.545158516903)/(o+1.)+(-0.562624149397)+(-0.714725894011)*0.5**o
        ref[1,4,1,1]=(-1.20779451465)/(o+1.)+(-0.189148851615)+(-0.809072545597)*0.5**o
        ref[1,4,2,0]=(-1.55971061601)/(o+1.)+(0.693489320143)+(-0.21281876112)*0.5**o
        ref[1,4,2,1]=(0.226662056752)/(o+1.)+(-0.454678810051)+(-0.247930702516)*0.5**o
        ref[2,0,0,0]=(-0.242758325417)/(o+1.)+(-0.527650883321)+(0.616352869937)*0.5**o
        ref[2,0,0,1]=(0.807761382166)/(o+1.)+(1.02431485248)+(-0.85704374519)*0.5**o
        ref[2,0,1,0]=(0.543068844645)/(o+1.)+(0.0690269849966)+(0.326870102902)*0.5**o
        ref[2,0,1,1]=(0.502168875857)/(o+1.)+(-0.0584590052478)+(-0.699939842176)*0.5**o
        ref[2,0,2,0]=(0.181622609504)/(o+1.)+(-0.57477595904)+(-0.985996827188)*0.5**o
        ref[2,0,2,1]=(-1.01828660056)/(o+1.)+(0.255680773601)+(-0.195357773436)*0.5**o
        ref[2,1,0,0]=(-0.961895417879)/(o+1.)+(-0.848679114358)+(0.601652939329)*0.5**o
        ref[2,1,0,1]=(0.177781123824)/(o+1.)+(-0.945003972397)+(0.534038022604)*0.5**o
        ref[2,1,1,0]=(-0.20513407563)/(o+1.)+(-0.126335927989)+(-0.361196978257)*0.5**o
        ref[2,1,1,1]=(0.712128730879)/(o+1.)+(-0.0623370236322)+(0.00930987921229)*0.5**o
        ref[2,1,2,0]=(0.692430706812)/(o+1.)+(0.417664138602)+(-0.181479246679)*0.5**o
        ref[2,1,2,1]=(0.650980026197)/(o+1.)+(-0.708193455952)+(-0.99665050175)*0.5**o
        ref[2,2,0,0]=(1.22766505061)/(o+1.)+(0.717584511586)+(0.870069083779)*0.5**o
        ref[2,2,0,1]=(0.633038618622)/(o+1.)+(-0.222859101796)+(-0.841259995642)*0.5**o
        ref[2,2,1,0]=(0.167120356805)/(o+1.)+(-1.00491115888)+(-0.561184923307)*0.5**o
        ref[2,2,1,1]=(0.164505345911)/(o+1.)+(1.15307619901)+(0.92243000401)*0.5**o
        ref[2,2,2,0]=(-1.16271376641)/(o+1.)+(-0.336355614369)+(0.331131296272)*0.5**o
        ref[2,2,2,1]=(0.672282083422)/(o+1.)+(0.018864653069)+(-0.47892171854)*0.5**o
        ref[2,3,0,0]=(1.52821633972)/(o+1.)+(-0.864758323678)+(0.0219406022052)*0.5**o
        ref[2,3,0,1]=(-0.326213615062)/(o+1.)+(0.152909191896)+(-0.114799511617)*0.5**o
        ref[2,3,1,0]=(-0.724364553267)/(o+1.)+(-0.439822878578)+(-0.103518223905)*0.5**o
        ref[2,3,1,1]=(-1.107549965)/(o+1.)+(-0.705530843209)+(-0.958142224242)*0.5**o
        ref[2,3,2,0]=(-0.825620325844)/(o+1.)+(-0.169496279085)+(0.730554594734)*0.5**o
        ref[2,3,2,1]=(-0.0678334241233)/(o+1.)+(0.0396617729923)+(-0.930974589897)*0.5**o
        ref[2,4,0,0]=(0.809143207998)/(o+1.)+(-0.709013942786)+(-0.246046780287)*0.5**o
        ref[2,4,0,1]=(0.0938678290563)/(o+1.)+(-0.0282613348041)+(-0.612751147889)*0.5**o
        ref[2,4,1,0]=(-0.0572988459938)/(o+1.)+(-0.496307592572)+(-0.26092972064)*0.5**o
        ref[2,4,1,1]=(1.38060158884)/(o+1.)+(-0.643768055252)+(0.325840618456)*0.5**o
        ref[2,4,2,0]=(-1.03935942333)/(o+1.)+(0.130235179204)+(0.655590135983)*0.5**o
        ref[2,4,2,1]=(-0.41630624669)/(o+1.)+(0.259401996992)+(0.570712162768)*0.5**o
        ref[3,0,0,0]=(-0.357343519171)/(o+1.)+(-0.518658431855)+(-0.486023722572)*0.5**o
        ref[3,0,0,1]=(-0.927017258737)/(o+1.)+(0.566657824853)+(-0.705291625776)*0.5**o
        ref[3,0,1,0]=(-0.331128184244)/(o+1.)+(0.535203433907)+(-0.838974120992)*0.5**o
        ref[3,0,1,1]=(-0.735721663177)/(o+1.)+(-0.293634410339)+(0.140027541071)*0.5**o
        ref[3,0,2,0]=(-0.178945077431)/(o+1.)+(-0.300862767422)+(-0.39083471939)*0.5**o
        ref[3,0,2,1]=(1.18223012428)/(o+1.)+(-0.121465976141)+(0.0734743009776)*0.5**o
        ref[3,1,0,0]=(1.46408415003)/(o+1.)+(-0.0664881764563)+(-0.414502599055)*0.5**o
        ref[3,1,0,1]=(1.3349422575)/(o+1.)+(0.283498682724)+(0.886115095396)*0.5**o
        ref[3,1,1,0]=(0.816511111677)/(o+1.)+(0.175825822544)+(0.312577129879)*0.5**o
        ref[3,1,1,1]=(-0.105059408543)/(o+1.)+(-0.782531675802)+(0.784369258288)*0.5**o
        ref[3,1,2,0]=(-0.744294216228)/(o+1.)+(-0.301922969419)+(-0.337332295082)*0.5**o
        ref[3,1,2,1]=(-0.669631653258)/(o+1.)+(0.0177835713351)+(0.791575892417)*0.5**o
        ref[3,2,0,0]=(0.274579265949)/(o+1.)+(0.148529098776)+(-0.0909007497318)*0.5**o
        ref[3,2,0,1]=(0.956130125711)/(o+1.)+(0.482854719491)+(-0.764137934896)*0.5**o
        ref[3,2,1,0]=(-0.266431989669)/(o+1.)+(0.313297832739)+(0.49435832562)*0.5**o
        ref[3,2,1,1]=(-0.726703087024)/(o+1.)+(0.542295175061)+(-0.460752644946)*0.5**o
        ref[3,2,2,0]=(0.87651829094)/(o+1.)+(-0.185020317268)+(0.0946687985697)*0.5**o
        ref[3,2,2,1]=(-0.113135321417)/(o+1.)+(-0.221883684949)+(0.177521713734)*0.5**o
        ref[3,3,0,0]=(0.155561630388)/(o+1.)+(0.495429901163)+(0.592201472175)*0.5**o
        ref[3,3,0,1]=(-0.44887181194)/(o+1.)+(-0.20854804469)+(0.572972211447)*0.5**o
        ref[3,3,1,0]=(1.11423248654)/(o+1.)+(-0.212131906831)+(0.775163727164)*0.5**o
        ref[3,3,1,1]=(0.723748205425)/(o+1.)+(0.785798099184)+(-0.244586606882)*0.5**o
        ref[3,3,2,0]=(0.389980691746)/(o+1.)+(-0.0994690359155)+(-0.676040282048)*0.5**o
        ref[3,3,2,1]=(-0.0505489049572)/(o+1.)+(0.57416458839)+(-0.136437682299)*0.5**o
        ref[3,4,0,0]=(0.14698064297)/(o+1.)+(0.286169633527)+(0.28632587806)*0.5**o
        ref[3,4,0,1]=(-0.316556260565)/(o+1.)+(0.736868623097)+(0.326448964148)*0.5**o
        ref[3,4,1,0]=(-1.11727322574)/(o+1.)+(0.341015410564)+(0.760474271531)*0.5**o
        ref[3,4,1,1]=(-0.0908271211344)/(o+1.)+(-0.150268763334)+(-0.21508452109)*0.5**o
        ref[3,4,2,0]=(-1.40693165856)/(o+1.)+(0.796839755046)+(-0.195181632154)*0.5**o
        ref[3,4,2,1]=(-0.109962351944)/(o+1.)+(-0.36347859654)+(0.270278273932)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_Solution_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.0433006726989)*x[0]**o+(0.819109331838)*x[0]+(0.150292245587)*x[1]**o+(0.949397165008)*x[1]
        ref=(0.150292245587)/(o+1.)+(0.884253248423)+(0.0433006726989)*0.5**o
      else:
        arg=(-0.765858486678)*x[0]**o+(-0.829061249978)*x[0]+(-0.0255273602735)*x[1]**o+(-0.93097352763)*x[1]+(-0.775974817954)*x[2]**o+(0.0414580763278)*x[2]
        ref=(-0.801502178228)/(o+1.)+(-0.85928835064)+(-0.765858486678)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_Solution_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.708418284738)*x[0]**o+(-0.265416249865)*x[0]+(0.0412873279676)*x[1]**o+(0.18827690539)*x[1]
        arg[1]=(-0.0639578348425)*x[0]**o+(-0.435408788697)*x[0]+(0.429134354603)*x[1]**o+(0.0391558318157)*x[1]
        ref[0]=(0.0412873279676)/(o+1.)+(-0.0385696722374)+(0.708418284738)*0.5**o
        ref[1]=(0.429134354603)/(o+1.)+(-0.198126478441)+(-0.0639578348425)*0.5**o
      else:
        arg[0]=(-0.516066856372)*x[0]**o+(-0.509677909948)*x[0]+(0.189594948337)*x[1]**o+(0.743432553688)*x[1]+(0.687864109046)*x[2]**o+(0.257280277379)*x[2]
        arg[1]=(0.948762785699)*x[0]**o+(0.372861763607)*x[0]+(-0.166460043702)*x[1]**o+(0.0474018901531)*x[1]+(-0.485380626595)*x[2]**o+(-0.341701937267)*x[2]
        ref[0]=(0.877459057383)/(o+1.)+(0.245517460559)+(-0.516066856372)*0.5**o
        ref[1]=(-0.651840670298)/(o+1.)+(0.0392808582465)+(0.948762785699)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_Solution_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.0540280486222)*x[0]**o+(-0.936629447756)*x[0]+(0.530867101627)*x[1]**o+(-0.404522355122)*x[1]
        arg[0,1]=(0.585051034599)*x[0]**o+(-0.899683342239)*x[0]+(0.61865830472)*x[1]**o+(0.491768251743)*x[1]
        arg[0,2]=(0.924131379905)*x[0]**o+(-0.394367734246)*x[0]+(0.432122525065)*x[1]**o+(0.79923634141)*x[1]
        arg[0,3]=(-0.41435196904)*x[0]**o+(-0.22039395628)*x[0]+(-0.866551833459)*x[1]**o+(-0.0966534238435)*x[1]
        arg[0,4]=(0.855785701017)*x[0]**o+(0.0879754354535)*x[0]+(-0.0727782016239)*x[1]**o+(0.746878225435)*x[1]
        arg[1,0]=(-0.868450306659)*x[0]**o+(-0.00845792225901)*x[0]+(0.227399876353)*x[1]**o+(-0.522196483799)*x[1]
        arg[1,1]=(0.53076931297)*x[0]**o+(0.165744140226)*x[0]+(0.14586398181)*x[1]**o+(-0.694169551043)*x[1]
        arg[1,2]=(-0.936146144862)*x[0]**o+(-0.198367580291)*x[0]+(0.848822682163)*x[1]**o+(0.360521711263)*x[1]
        arg[1,3]=(-0.395889451325)*x[0]**o+(0.510713345487)*x[0]+(-0.62440033386)*x[1]**o+(0.29695714683)*x[1]
        arg[1,4]=(0.847685553395)*x[0]**o+(-0.291266469606)*x[0]+(-0.517114839541)*x[1]**o+(-0.279948585383)*x[1]
        arg[2,0]=(-0.622481093435)*x[0]**o+(0.0911922519622)*x[0]+(0.216648336495)*x[1]**o+(0.663562516802)*x[1]
        arg[2,1]=(0.567833843918)*x[0]**o+(0.18116887359)*x[0]+(-0.0433012798352)*x[1]**o+(0.998332142285)*x[1]
        arg[2,2]=(-0.81729786652)*x[0]**o+(-0.634680104287)*x[0]+(0.991513806139)*x[1]**o+(-0.0721700196003)*x[1]
        arg[2,3]=(0.121181286827)*x[0]**o+(-0.677803464822)*x[0]+(0.870139639102)*x[1]**o+(-0.134662002755)*x[1]
        arg[2,4]=(-0.167376807346)*x[0]**o+(-0.500556007898)*x[0]+(-0.839256017197)*x[1]**o+(-0.82147890878)*x[1]
        arg[3,0]=(0.576521064132)*x[0]**o+(-0.510276372588)*x[0]+(0.92888227487)*x[1]**o+(-0.88293512036)*x[1]
        arg[3,1]=(-0.159048471862)*x[0]**o+(-0.0479500210678)*x[0]+(-0.0216438779517)*x[1]**o+(-0.108252189548)*x[1]
        arg[3,2]=(-0.483779576334)*x[0]**o+(-0.871829147209)*x[0]+(-0.22556218283)*x[1]**o+(0.451007116911)*x[1]
        arg[3,3]=(-0.358888369902)*x[0]**o+(0.436554685191)*x[0]+(-0.0359187908139)*x[1]**o+(-0.0148930474244)*x[1]
        arg[3,4]=(-0.995411478882)*x[0]**o+(-0.457206328785)*x[0]+(-0.833823947273)*x[1]**o+(-0.0517068976093)*x[1]
        ref[0,0]=(0.530867101627)/(o+1.)+(-0.670575901439)+(-0.0540280486222)*0.5**o
        ref[0,1]=(0.61865830472)/(o+1.)+(-0.203957545248)+(0.585051034599)*0.5**o
        ref[0,2]=(0.432122525065)/(o+1.)+(0.202434303582)+(0.924131379905)*0.5**o
        ref[0,3]=(-0.866551833459)/(o+1.)+(-0.158523690062)+(-0.41435196904)*0.5**o
        ref[0,4]=(-0.0727782016239)/(o+1.)+(0.417426830444)+(0.855785701017)*0.5**o
        ref[1,0]=(0.227399876353)/(o+1.)+(-0.265327203029)+(-0.868450306659)*0.5**o
        ref[1,1]=(0.14586398181)/(o+1.)+(-0.264212705408)+(0.53076931297)*0.5**o
        ref[1,2]=(0.848822682163)/(o+1.)+(0.0810770654864)+(-0.936146144862)*0.5**o
        ref[1,3]=(-0.62440033386)/(o+1.)+(0.403835246159)+(-0.395889451325)*0.5**o
        ref[1,4]=(-0.517114839541)/(o+1.)+(-0.285607527495)+(0.847685553395)*0.5**o
        ref[2,0]=(0.216648336495)/(o+1.)+(0.377377384382)+(-0.622481093435)*0.5**o
        ref[2,1]=(-0.0433012798352)/(o+1.)+(0.589750507938)+(0.567833843918)*0.5**o
        ref[2,2]=(0.991513806139)/(o+1.)+(-0.353425061944)+(-0.81729786652)*0.5**o
        ref[2,3]=(0.870139639102)/(o+1.)+(-0.406232733789)+(0.121181286827)*0.5**o
        ref[2,4]=(-0.839256017197)/(o+1.)+(-0.661017458339)+(-0.167376807346)*0.5**o
        ref[3,0]=(0.92888227487)/(o+1.)+(-0.696605746474)+(0.576521064132)*0.5**o
        ref[3,1]=(-0.0216438779517)/(o+1.)+(-0.078101105308)+(-0.159048471862)*0.5**o
        ref[3,2]=(-0.22556218283)/(o+1.)+(-0.210411015149)+(-0.483779576334)*0.5**o
        ref[3,3]=(-0.0359187908139)/(o+1.)+(0.210830818883)+(-0.358888369902)*0.5**o
        ref[3,4]=(-0.833823947273)/(o+1.)+(-0.254456613197)+(-0.995411478882)*0.5**o
      else:
        arg[0,0]=(-0.937858877179)*x[0]**o+(-0.41590845461)*x[0]+(0.317385444442)*x[1]**o+(-0.166284606371)*x[1]+(-0.846106994172)*x[2]**o+(0.227876218054)*x[2]
        arg[0,1]=(0.497785867084)*x[0]**o+(0.883557362705)*x[0]+(-0.846602726567)*x[1]**o+(-0.859091910548)*x[1]+(-0.295742503292)*x[2]**o+(-0.853931233266)*x[2]
        arg[0,2]=(0.744501879094)*x[0]**o+(-0.0181115125382)*x[0]+(-0.856099357899)*x[1]**o+(0.767449074734)*x[1]+(-0.858552187616)*x[2]**o+(-0.580142057156)*x[2]
        arg[0,3]=(0.210031467359)*x[0]**o+(-0.994426053833)*x[0]+(0.648522478175)*x[1]**o+(0.0355805603417)*x[1]+(-0.274347447112)*x[2]**o+(-0.280165537012)*x[2]
        arg[0,4]=(-0.323650660168)*x[0]**o+(-0.279592941595)*x[0]+(-0.478811425713)*x[1]**o+(0.19753271141)*x[1]+(0.476202875551)*x[2]**o+(0.657358100659)*x[2]
        arg[1,0]=(0.890659868437)*x[0]**o+(0.100235405989)*x[0]+(0.325177871418)*x[1]**o+(0.675379114656)*x[1]+(0.458473828724)*x[2]**o+(-0.449822467434)*x[2]
        arg[1,1]=(-0.467895039242)*x[0]**o+(-0.551300000422)*x[0]+(0.976111922801)*x[1]**o+(0.809389941274)*x[1]+(-0.693066235685)*x[2]**o+(0.595719115505)*x[2]
        arg[1,2]=(-0.727304617172)*x[0]**o+(-0.270682330445)*x[0]+(-0.32926621635)*x[1]**o+(0.0389068111165)*x[1]+(0.300096425532)*x[2]**o+(-0.964910767632)*x[2]
        arg[1,3]=(0.195012106644)*x[0]**o+(0.18137839607)*x[0]+(-0.823129279257)*x[1]**o+(-0.0440106889304)*x[1]+(-0.298898659898)*x[2]**o+(0.801623925974)*x[2]
        arg[1,4]=(0.590200326369)*x[0]**o+(-0.800085209049)*x[0]+(-0.323836133834)*x[1]**o+(-0.953413527643)*x[1]+(0.0257128844735)*x[2]**o+(0.652469516082)*x[2]
        arg[2,0]=(-0.467537281458)*x[0]**o+(-0.05673369912)*x[0]+(-0.813542619659)*x[1]**o+(-0.778596374878)*x[1]+(0.752073310476)*x[2]**o+(0.187824163254)*x[2]
        arg[2,1]=(-0.75708112983)*x[0]**o+(0.866111788737)*x[0]+(0.715424327432)*x[1]**o+(-0.297967739435)*x[1]+(0.420241611178)*x[2]**o+(-0.616867390634)*x[2]
        arg[2,2]=(0.00628628803839)*x[0]**o+(0.700962301988)*x[0]+(0.712979263919)*x[1]**o+(-0.414401132518)*x[1]+(-0.975498928756)*x[2]**o+(0.858116391039)*x[2]
        arg[2,3]=(0.948164399923)*x[0]**o+(-0.88227825142)*x[0]+(0.30703295864)*x[1]**o+(0.510607674984)*x[1]+(0.362361719392)*x[2]**o+(-0.208696380629)*x[2]
        arg[2,4]=(0.661545494115)*x[0]**o+(-0.122960355184)*x[0]+(-0.801367604574)*x[1]**o+(0.395708459987)*x[1]+(0.0197225340457)*x[2]**o+(-0.377005073637)*x[2]
        arg[3,0]=(0.733597350529)*x[0]**o+(0.339318978843)*x[0]+(0.317608635437)*x[1]**o+(0.147746051469)*x[1]+(-0.33413935488)*x[2]**o+(-0.793337674933)*x[2]
        arg[3,1]=(0.0918904281646)*x[0]**o+(-0.530786152204)*x[0]+(-0.587542750401)*x[1]**o+(-0.810331029621)*x[1]+(-0.40221065987)*x[2]**o+(-0.250472092093)*x[2]
        arg[3,2]=(0.966442952042)*x[0]**o+(-0.756649866552)*x[0]+(-0.36466223222)*x[1]**o+(-0.48639005055)*x[1]+(-0.831374462742)*x[2]**o+(0.503451143644)*x[2]
        arg[3,3]=(-0.322275644664)*x[0]**o+(-0.254067149982)*x[0]+(-0.440264794128)*x[1]**o+(0.226546045529)*x[1]+(-0.761870916789)*x[2]**o+(0.70024066379)*x[2]
        arg[3,4]=(0.595459342613)*x[0]**o+(-0.439436200258)*x[0]+(0.0932538180176)*x[1]**o+(-0.975450806707)*x[1]+(0.0461423323623)*x[2]**o+(0.0294352472154)*x[2]
        ref[0,0]=(-0.52872154973)/(o+1.)+(-0.177158421464)+(-0.937858877179)*0.5**o
        ref[0,1]=(-1.14234522986)/(o+1.)+(-0.414732890554)+(0.497785867084)*0.5**o
        ref[0,2]=(-1.71465154551)/(o+1.)+(0.0845977525197)+(0.744501879094)*0.5**o
        ref[0,3]=(0.374175031062)/(o+1.)+(-0.619505515252)+(0.210031467359)*0.5**o
        ref[0,4]=(-0.00260855016132)/(o+1.)+(0.287648935237)+(-0.323650660168)*0.5**o
        ref[1,0]=(0.783651700142)/(o+1.)+(0.162896026605)+(0.890659868437)*0.5**o
        ref[1,1]=(0.283045687117)/(o+1.)+(0.426904528178)+(-0.467895039242)*0.5**o
        ref[1,2]=(-0.0291697908188)/(o+1.)+(-0.59834314348)+(-0.727304617172)*0.5**o
        ref[1,3]=(-1.12202793916)/(o+1.)+(0.469495816557)+(0.195012106644)*0.5**o
        ref[1,4]=(-0.29812324936)/(o+1.)+(-0.550514610305)+(0.590200326369)*0.5**o
        ref[2,0]=(-0.0614693091826)/(o+1.)+(-0.323752955372)+(-0.467537281458)*0.5**o
        ref[2,1]=(1.13566593861)/(o+1.)+(-0.024361670666)+(-0.75708112983)*0.5**o
        ref[2,2]=(-0.262519664837)/(o+1.)+(0.572338780255)+(0.00628628803839)*0.5**o
        ref[2,3]=(0.669394678032)/(o+1.)+(-0.290183478532)+(0.948164399923)*0.5**o
        ref[2,4]=(-0.781645070528)/(o+1.)+(-0.0521284844165)+(0.661545494115)*0.5**o
        ref[3,0]=(-0.0165307194439)/(o+1.)+(-0.15313632231)+(0.733597350529)*0.5**o
        ref[3,1]=(-0.989753410271)/(o+1.)+(-0.795794636959)+(0.0918904281646)*0.5**o
        ref[3,2]=(-1.19603669496)/(o+1.)+(-0.369794386729)+(0.966442952042)*0.5**o
        ref[3,3]=(-1.20213571092)/(o+1.)+(0.336359779668)+(-0.322275644664)*0.5**o
        ref[3,4]=(0.13939615038)/(o+1.)+(-0.692725879875)+(0.595459342613)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_Solution_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.12237588236)*x[0]**o+(-0.671341785528)*x[0]+(0.998910161099)*x[1]**o+(-0.552290246966)*x[1]
        arg[0,0,1]=(-0.90821257221)*x[0]**o+(-0.413391927764)*x[0]+(-0.428904099491)*x[1]**o+(-0.226766222189)*x[1]
        arg[0,1,0]=(-0.333819313127)*x[0]**o+(-0.458569899029)*x[0]+(-0.83776177332)*x[1]**o+(0.22951184631)*x[1]
        arg[0,1,1]=(-0.0571879315489)*x[0]**o+(-0.38056227895)*x[0]+(0.0784628125977)*x[1]**o+(-0.659353613638)*x[1]
        arg[1,0,0]=(0.645871468353)*x[0]**o+(-0.986005542006)*x[0]+(0.395704509276)*x[1]**o+(0.980666918726)*x[1]
        arg[1,0,1]=(0.337293036597)*x[0]**o+(-0.520809490378)*x[0]+(0.543657498632)*x[1]**o+(0.632777244118)*x[1]
        arg[1,1,0]=(-0.432349538121)*x[0]**o+(-0.579685247099)*x[0]+(0.331943072726)*x[1]**o+(0.25042188644)*x[1]
        arg[1,1,1]=(0.329861800715)*x[0]**o+(-0.48725090895)*x[0]+(-0.149357998414)*x[1]**o+(-0.580650134153)*x[1]
        arg[2,0,0]=(-0.75424658357)*x[0]**o+(-0.696352517414)*x[0]+(-0.00272313166917)*x[1]**o+(-0.488581343546)*x[1]
        arg[2,0,1]=(-0.136489901339)*x[0]**o+(-0.752587775699)*x[0]+(0.986413392791)*x[1]**o+(0.759344728162)*x[1]
        arg[2,1,0]=(-0.0832674877963)*x[0]**o+(0.765419402778)*x[0]+(0.958533611564)*x[1]**o+(-0.315461136294)*x[1]
        arg[2,1,1]=(0.362764663642)*x[0]**o+(-0.351519282456)*x[0]+(-0.115554433923)*x[1]**o+(-0.789365036398)*x[1]
        arg[3,0,0]=(0.0977752933224)*x[0]**o+(-0.838881001576)*x[0]+(0.275578737811)*x[1]**o+(-0.971208155806)*x[1]
        arg[3,0,1]=(0.0588243034654)*x[0]**o+(-0.141302234145)*x[0]+(-0.460044396206)*x[1]**o+(-0.776793718354)*x[1]
        arg[3,1,0]=(0.786922930047)*x[0]**o+(-0.187797924361)*x[0]+(0.971516347812)*x[1]**o+(-0.250547377602)*x[1]
        arg[3,1,1]=(-0.69240453335)*x[0]**o+(0.439425578473)*x[0]+(0.00864940781276)*x[1]**o+(-0.458898387231)*x[1]
        arg[4,0,0]=(0.0700104829681)*x[0]**o+(0.905031121846)*x[0]+(0.37676750477)*x[1]**o+(0.411190149331)*x[1]
        arg[4,0,1]=(-0.615737714754)*x[0]**o+(0.1945204765)*x[0]+(0.0889014902938)*x[1]**o+(0.650020022597)*x[1]
        arg[4,1,0]=(-0.883448519911)*x[0]**o+(0.00124188371434)*x[0]+(-0.501662684156)*x[1]**o+(0.290235036398)*x[1]
        arg[4,1,1]=(-0.723885968554)*x[0]**o+(-0.0112308623755)*x[0]+(0.679499427805)*x[1]**o+(-0.00261690404287)*x[1]
        arg[5,0,0]=(0.0834731365594)*x[0]**o+(-0.873857991293)*x[0]+(0.831158842487)*x[1]**o+(-0.585808323324)*x[1]
        arg[5,0,1]=(0.250830078938)*x[0]**o+(0.310347394372)*x[0]+(-0.412138455827)*x[1]**o+(0.974823718029)*x[1]
        arg[5,1,0]=(-0.865155065381)*x[0]**o+(0.72190541012)*x[0]+(0.72020941875)*x[1]**o+(-0.604997858133)*x[1]
        arg[5,1,1]=(0.57252234131)*x[0]**o+(-0.366230226771)*x[0]+(0.115400105646)*x[1]**o+(0.0485229323141)*x[1]
        ref[0,0,0]=(0.998910161099)/(o+1.)+(-0.611816016247)+(-0.12237588236)*0.5**o
        ref[0,0,1]=(-0.428904099491)/(o+1.)+(-0.320079074977)+(-0.90821257221)*0.5**o
        ref[0,1,0]=(-0.83776177332)/(o+1.)+(-0.11452902636)+(-0.333819313127)*0.5**o
        ref[0,1,1]=(0.0784628125977)/(o+1.)+(-0.519957946294)+(-0.0571879315489)*0.5**o
        ref[1,0,0]=(0.395704509276)/(o+1.)+(-0.00266931163989)+(0.645871468353)*0.5**o
        ref[1,0,1]=(0.543657498632)/(o+1.)+(0.0559838768697)+(0.337293036597)*0.5**o
        ref[1,1,0]=(0.331943072726)/(o+1.)+(-0.16463168033)+(-0.432349538121)*0.5**o
        ref[1,1,1]=(-0.149357998414)/(o+1.)+(-0.533950521552)+(0.329861800715)*0.5**o
        ref[2,0,0]=(-0.00272313166917)/(o+1.)+(-0.59246693048)+(-0.75424658357)*0.5**o
        ref[2,0,1]=(0.986413392791)/(o+1.)+(0.00337847623164)+(-0.136489901339)*0.5**o
        ref[2,1,0]=(0.958533611564)/(o+1.)+(0.224979133242)+(-0.0832674877963)*0.5**o
        ref[2,1,1]=(-0.115554433923)/(o+1.)+(-0.570442159427)+(0.362764663642)*0.5**o
        ref[3,0,0]=(0.275578737811)/(o+1.)+(-0.905044578691)+(0.0977752933224)*0.5**o
        ref[3,0,1]=(-0.460044396206)/(o+1.)+(-0.45904797625)+(0.0588243034654)*0.5**o
        ref[3,1,0]=(0.971516347812)/(o+1.)+(-0.219172650981)+(0.786922930047)*0.5**o
        ref[3,1,1]=(0.00864940781276)/(o+1.)+(-0.00973640437899)+(-0.69240453335)*0.5**o
        ref[4,0,0]=(0.37676750477)/(o+1.)+(0.658110635589)+(0.0700104829681)*0.5**o
        ref[4,0,1]=(0.0889014902938)/(o+1.)+(0.422270249549)+(-0.615737714754)*0.5**o
        ref[4,1,0]=(-0.501662684156)/(o+1.)+(0.145738460056)+(-0.883448519911)*0.5**o
        ref[4,1,1]=(0.679499427805)/(o+1.)+(-0.00692388320921)+(-0.723885968554)*0.5**o
        ref[5,0,0]=(0.831158842487)/(o+1.)+(-0.729833157309)+(0.0834731365594)*0.5**o
        ref[5,0,1]=(-0.412138455827)/(o+1.)+(0.642585556201)+(0.250830078938)*0.5**o
        ref[5,1,0]=(0.72020941875)/(o+1.)+(0.0584537759935)+(-0.865155065381)*0.5**o
        ref[5,1,1]=(0.115400105646)/(o+1.)+(-0.158853647228)+(0.57252234131)*0.5**o
      else:
        arg[0,0,0]=(0.962792187023)*x[0]**o+(0.799861778652)*x[0]+(-0.811367630134)*x[1]**o+(-0.553496861095)*x[1]+(-0.810089307714)*x[2]**o+(0.135449765364)*x[2]
        arg[0,0,1]=(0.644573004654)*x[0]**o+(-0.565823623798)*x[0]+(0.337026645127)*x[1]**o+(0.413612857799)*x[1]+(0.604366347987)*x[2]**o+(0.0867373815054)*x[2]
        arg[0,1,0]=(0.829914553754)*x[0]**o+(-0.462419132852)*x[0]+(0.889464473044)*x[1]**o+(-0.425594549042)*x[1]+(0.679251542389)*x[2]**o+(-0.501090535615)*x[2]
        arg[0,1,1]=(0.874166303558)*x[0]**o+(0.437595762221)*x[0]+(-0.836229998654)*x[1]**o+(-0.704020633222)*x[1]+(-0.279878325513)*x[2]**o+(0.697289463565)*x[2]
        arg[1,0,0]=(-0.963425479949)*x[0]**o+(0.399090631945)*x[0]+(-0.80371987894)*x[1]**o+(0.614102223184)*x[1]+(-0.821741166107)*x[2]**o+(-0.245209306654)*x[2]
        arg[1,0,1]=(-0.288791346674)*x[0]**o+(0.0125896799209)*x[0]+(0.0536290891541)*x[1]**o+(-0.127968165901)*x[1]+(-0.635591402779)*x[2]**o+(-0.723850350215)*x[2]
        arg[1,1,0]=(-0.554196270608)*x[0]**o+(-0.409293351346)*x[0]+(-0.759821124187)*x[1]**o+(-0.828913354317)*x[1]+(0.66900958614)*x[2]**o+(0.412403847239)*x[2]
        arg[1,1,1]=(-0.862735330269)*x[0]**o+(-0.406644646366)*x[0]+(-0.375399872184)*x[1]**o+(-0.10762837777)*x[1]+(0.540886844249)*x[2]**o+(0.97487281528)*x[2]
        arg[2,0,0]=(0.388899900771)*x[0]**o+(-0.692092360652)*x[0]+(0.794415524913)*x[1]**o+(0.369239170999)*x[1]+(0.482269641926)*x[2]**o+(0.58717167121)*x[2]
        arg[2,0,1]=(0.324795219208)*x[0]**o+(0.508631698719)*x[0]+(0.128456415737)*x[1]**o+(0.73678163559)*x[1]+(0.0527520660005)*x[2]**o+(-0.180289299372)*x[2]
        arg[2,1,0]=(-0.901972287405)*x[0]**o+(-0.635701120264)*x[0]+(0.298343193246)*x[1]**o+(-0.870902858159)*x[1]+(-0.979619200422)*x[2]**o+(0.708567755329)*x[2]
        arg[2,1,1]=(0.391663724321)*x[0]**o+(0.69891810611)*x[0]+(0.717069638885)*x[1]**o+(0.493487853359)*x[1]+(0.270536570073)*x[2]**o+(0.679115502666)*x[2]
        arg[3,0,0]=(0.830590943609)*x[0]**o+(-0.000320739222143)*x[0]+(-0.659146599349)*x[1]**o+(-0.858428982679)*x[1]+(-0.158070494634)*x[2]**o+(-0.364394913197)*x[2]
        arg[3,0,1]=(0.903615175916)*x[0]**o+(0.186562406505)*x[0]+(0.463860110418)*x[1]**o+(0.0382550628307)*x[1]+(0.835148180357)*x[2]**o+(-0.117637969912)*x[2]
        arg[3,1,0]=(-0.901874408714)*x[0]**o+(0.00493918499294)*x[0]+(0.180179475909)*x[1]**o+(-0.549428619271)*x[1]+(-0.392536708051)*x[2]**o+(0.68054148024)*x[2]
        arg[3,1,1]=(0.807693382033)*x[0]**o+(-0.47532617097)*x[0]+(-0.52499678021)*x[1]**o+(-0.0365395713918)*x[1]+(0.654881606829)*x[2]**o+(-0.63350736651)*x[2]
        arg[4,0,0]=(0.440830144989)*x[0]**o+(-0.454694325046)*x[0]+(0.403509667018)*x[1]**o+(0.360080283937)*x[1]+(0.164208775222)*x[2]**o+(0.203945755083)*x[2]
        arg[4,0,1]=(-0.836804887763)*x[0]**o+(-0.910979763109)*x[0]+(-0.629411293881)*x[1]**o+(0.0546020113997)*x[1]+(0.63435754491)*x[2]**o+(-0.323224122475)*x[2]
        arg[4,1,0]=(0.204216251019)*x[0]**o+(-0.372349067194)*x[0]+(-0.320768886225)*x[1]**o+(-0.139715856072)*x[1]+(0.62329130659)*x[2]**o+(0.626784461235)*x[2]
        arg[4,1,1]=(0.275074685897)*x[0]**o+(0.0664691742991)*x[0]+(0.949175504221)*x[1]**o+(-0.438858093561)*x[1]+(0.330489174462)*x[2]**o+(0.361586647545)*x[2]
        arg[5,0,0]=(0.370194889673)*x[0]**o+(-0.0549428893157)*x[0]+(0.0219932528442)*x[1]**o+(-0.699553487775)*x[1]+(0.0161212665659)*x[2]**o+(-0.268426682266)*x[2]
        arg[5,0,1]=(-0.527801267225)*x[0]**o+(0.151774276637)*x[0]+(-0.0623666836223)*x[1]**o+(-0.953572390482)*x[1]+(0.778912307756)*x[2]**o+(-0.851760269136)*x[2]
        arg[5,1,0]=(0.11418535486)*x[0]**o+(-0.299719975234)*x[0]+(-0.508303365848)*x[1]**o+(-0.856367302992)*x[1]+(0.311609370032)*x[2]**o+(0.4731881155)*x[2]
        arg[5,1,1]=(0.455947680647)*x[0]**o+(0.856811965126)*x[0]+(-0.176215162097)*x[1]**o+(0.581325693162)*x[1]+(-0.306514780798)*x[2]**o+(-0.005241787834)*x[2]
        ref[0,0,0]=(-1.62145693785)/(o+1.)+(0.19090734146)+(0.962792187023)*0.5**o
        ref[0,0,1]=(0.941392993115)/(o+1.)+(-0.0327366922471)+(0.644573004654)*0.5**o
        ref[0,1,0]=(1.56871601543)/(o+1.)+(-0.694552108754)+(0.829914553754)*0.5**o
        ref[0,1,1]=(-1.11610832417)/(o+1.)+(0.215432296282)+(0.874166303558)*0.5**o
        ref[1,0,0]=(-1.62546104505)/(o+1.)+(0.383991774237)+(-0.963425479949)*0.5**o
        ref[1,0,1]=(-0.581962313625)/(o+1.)+(-0.419614418097)+(-0.288791346674)*0.5**o
        ref[1,1,0]=(-0.0908115380472)/(o+1.)+(-0.412901429212)+(-0.554196270608)*0.5**o
        ref[1,1,1]=(0.165486972066)/(o+1.)+(0.230299895572)+(-0.862735330269)*0.5**o
        ref[2,0,0]=(1.27668516684)/(o+1.)+(0.132159240779)+(0.388899900771)*0.5**o
        ref[2,0,1]=(0.181208481738)/(o+1.)+(0.532562017469)+(0.324795219208)*0.5**o
        ref[2,1,0]=(-0.681276007176)/(o+1.)+(-0.399018111547)+(-0.901972287405)*0.5**o
        ref[2,1,1]=(0.987606208958)/(o+1.)+(0.935760731067)+(0.391663724321)*0.5**o
        ref[3,0,0]=(-0.817217093983)/(o+1.)+(-0.611572317549)+(0.830590943609)*0.5**o
        ref[3,0,1]=(1.29900829077)/(o+1.)+(0.0535897497116)+(0.903615175916)*0.5**o
        ref[3,1,0]=(-0.212357232141)/(o+1.)+(0.0680260229807)+(-0.901874408714)*0.5**o
        ref[3,1,1]=(0.12988482662)/(o+1.)+(-0.572686554436)+(0.807693382033)*0.5**o
        ref[4,0,0]=(0.567718442239)/(o+1.)+(0.0546658569873)+(0.440830144989)*0.5**o
        ref[4,0,1]=(0.00494625102884)/(o+1.)+(-0.589800937092)+(-0.836804887763)*0.5**o
        ref[4,1,0]=(0.302522420366)/(o+1.)+(0.0573597689848)+(0.204216251019)*0.5**o
        ref[4,1,1]=(1.27966467868)/(o+1.)+(-0.0054011358584)+(0.275074685897)*0.5**o
        ref[5,0,0]=(0.0381145194101)/(o+1.)+(-0.511461529678)+(0.370194889673)*0.5**o
        ref[5,0,1]=(0.716545624134)/(o+1.)+(-0.826779191491)+(-0.527801267225)*0.5**o
        ref[5,1,0]=(-0.196693995816)/(o+1.)+(-0.341449581363)+(0.11418535486)*0.5**o
        ref[5,1,1]=(-0.482729942895)/(o+1.)+(0.716447935227)+(0.455947680647)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_Solution_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.415003066171)*x[0]**o+(-0.47441250281)*x[0]+(0.765391656872)*x[1]**o+(-0.170257448926)*x[1]
        arg[0,0,0,1]=(-0.928539602254)*x[0]**o+(0.792240012243)*x[0]+(-0.152730990885)*x[1]**o+(-0.667500454847)*x[1]
        arg[0,0,1,0]=(-0.937831078575)*x[0]**o+(0.963649346531)*x[0]+(0.505558859525)*x[1]**o+(-0.921354612243)*x[1]
        arg[0,0,1,1]=(0.909415074451)*x[0]**o+(0.199360871726)*x[0]+(0.194087349442)*x[1]**o+(0.875065381425)*x[1]
        arg[0,0,2,0]=(0.935190448625)*x[0]**o+(-0.109984767478)*x[0]+(0.518460161897)*x[1]**o+(-0.597684157349)*x[1]
        arg[0,0,2,1]=(-0.94062714999)*x[0]**o+(-0.308960574286)*x[0]+(0.578391007321)*x[1]**o+(0.864501040998)*x[1]
        arg[0,1,0,0]=(-0.197219678026)*x[0]**o+(-0.982899373778)*x[0]+(-0.603956105825)*x[1]**o+(-0.242717148913)*x[1]
        arg[0,1,0,1]=(-0.590715606611)*x[0]**o+(0.461185487788)*x[0]+(-0.270612249495)*x[1]**o+(-0.644742980654)*x[1]
        arg[0,1,1,0]=(-0.365516638755)*x[0]**o+(-0.255307471195)*x[0]+(0.0875989587033)*x[1]**o+(0.923189427818)*x[1]
        arg[0,1,1,1]=(0.315218558548)*x[0]**o+(-0.373070897551)*x[0]+(0.625272530385)*x[1]**o+(-0.174054543645)*x[1]
        arg[0,1,2,0]=(-0.502497884169)*x[0]**o+(-0.933785405889)*x[0]+(0.115500534905)*x[1]**o+(-0.864454092408)*x[1]
        arg[0,1,2,1]=(0.615837581258)*x[0]**o+(0.832538142367)*x[0]+(-0.0715650027129)*x[1]**o+(-0.775173801322)*x[1]
        arg[0,2,0,0]=(-0.898904577889)*x[0]**o+(-0.430072579352)*x[0]+(-0.532213103734)*x[1]**o+(0.970885652167)*x[1]
        arg[0,2,0,1]=(-0.0056483770747)*x[0]**o+(-0.566550554106)*x[0]+(0.751663691868)*x[1]**o+(0.677878661708)*x[1]
        arg[0,2,1,0]=(0.271196923039)*x[0]**o+(-0.291608730386)*x[0]+(-0.932579716748)*x[1]**o+(-0.437823650176)*x[1]
        arg[0,2,1,1]=(-0.788206773125)*x[0]**o+(0.18675055747)*x[0]+(0.747625244884)*x[1]**o+(0.654933611758)*x[1]
        arg[0,2,2,0]=(-0.787603701957)*x[0]**o+(-0.789784850865)*x[0]+(0.197684766271)*x[1]**o+(-0.988404958072)*x[1]
        arg[0,2,2,1]=(0.417538087399)*x[0]**o+(0.745832250585)*x[0]+(-0.525306115268)*x[1]**o+(0.134086803871)*x[1]
        arg[0,3,0,0]=(-0.230658480436)*x[0]**o+(-0.072983085881)*x[0]+(-0.149386157207)*x[1]**o+(-0.506870604002)*x[1]
        arg[0,3,0,1]=(-0.815859549425)*x[0]**o+(-0.962632495033)*x[0]+(-0.542257139282)*x[1]**o+(0.93598141472)*x[1]
        arg[0,3,1,0]=(0.0508974791413)*x[0]**o+(-0.722669867743)*x[0]+(0.714019527678)*x[1]**o+(0.710015283752)*x[1]
        arg[0,3,1,1]=(0.119419200166)*x[0]**o+(0.365663074152)*x[0]+(0.352455072404)*x[1]**o+(-0.0788953701144)*x[1]
        arg[0,3,2,0]=(-0.82075904747)*x[0]**o+(-0.224534176808)*x[0]+(-0.585094684368)*x[1]**o+(0.242958171035)*x[1]
        arg[0,3,2,1]=(-0.748061395205)*x[0]**o+(0.676995891547)*x[0]+(0.686644239408)*x[1]**o+(0.260350484065)*x[1]
        arg[0,4,0,0]=(0.128293903485)*x[0]**o+(0.226748407809)*x[0]+(0.129373873322)*x[1]**o+(0.988775321025)*x[1]
        arg[0,4,0,1]=(0.639638672694)*x[0]**o+(-0.817791454136)*x[0]+(-0.170677596319)*x[1]**o+(0.404161643274)*x[1]
        arg[0,4,1,0]=(0.43743097727)*x[0]**o+(-0.408230274495)*x[0]+(0.282544628333)*x[1]**o+(-0.542352697967)*x[1]
        arg[0,4,1,1]=(-0.995599965283)*x[0]**o+(-0.0512373236039)*x[0]+(0.218383977926)*x[1]**o+(0.929355335423)*x[1]
        arg[0,4,2,0]=(0.922609534479)*x[0]**o+(-0.166291574079)*x[0]+(-0.449331655188)*x[1]**o+(-0.0279347569009)*x[1]
        arg[0,4,2,1]=(0.950186933361)*x[0]**o+(-0.426615341822)*x[0]+(-0.167639663907)*x[1]**o+(0.219020502174)*x[1]
        arg[1,0,0,0]=(0.0573632292788)*x[0]**o+(0.543681035865)*x[0]+(-0.622510875807)*x[1]**o+(-0.171567467655)*x[1]
        arg[1,0,0,1]=(0.368975600444)*x[0]**o+(-0.754217532725)*x[0]+(0.469744047929)*x[1]**o+(-0.922445394777)*x[1]
        arg[1,0,1,0]=(-0.810194964715)*x[0]**o+(0.0861796117934)*x[0]+(0.625367069433)*x[1]**o+(-0.950906871025)*x[1]
        arg[1,0,1,1]=(0.744923275143)*x[0]**o+(0.465744045178)*x[0]+(0.359324627118)*x[1]**o+(0.273934205663)*x[1]
        arg[1,0,2,0]=(0.891959004941)*x[0]**o+(-0.498241249484)*x[0]+(0.318198109895)*x[1]**o+(0.0674564169104)*x[1]
        arg[1,0,2,1]=(0.842125439023)*x[0]**o+(0.731884782944)*x[0]+(-0.674805144805)*x[1]**o+(0.431782566319)*x[1]
        arg[1,1,0,0]=(-0.786719774805)*x[0]**o+(-0.55929144961)*x[0]+(-0.740263211102)*x[1]**o+(0.777914467998)*x[1]
        arg[1,1,0,1]=(0.831245977993)*x[0]**o+(-0.758991188073)*x[0]+(0.714032957488)*x[1]**o+(-0.879935556766)*x[1]
        arg[1,1,1,0]=(0.862796574462)*x[0]**o+(0.746875042565)*x[0]+(0.455949140326)*x[1]**o+(0.585491946591)*x[1]
        arg[1,1,1,1]=(-0.500409398892)*x[0]**o+(0.292753163538)*x[0]+(-0.62474682088)*x[1]**o+(0.583368504524)*x[1]
        arg[1,1,2,0]=(-0.402886961189)*x[0]**o+(-0.288733078165)*x[0]+(-0.770315341866)*x[1]**o+(-0.462764773299)*x[1]
        arg[1,1,2,1]=(0.358161520677)*x[0]**o+(-0.524052652951)*x[0]+(0.654162491323)*x[1]**o+(0.902382016998)*x[1]
        arg[1,2,0,0]=(-0.15539934232)*x[0]**o+(0.693162750731)*x[0]+(-0.0538737948754)*x[1]**o+(-0.025534990068)*x[1]
        arg[1,2,0,1]=(0.371159212282)*x[0]**o+(-0.751292369171)*x[0]+(-0.377617770006)*x[1]**o+(0.707647483842)*x[1]
        arg[1,2,1,0]=(0.117790556271)*x[0]**o+(0.848017682445)*x[0]+(-0.360936107893)*x[1]**o+(-0.564060873236)*x[1]
        arg[1,2,1,1]=(-0.524828128971)*x[0]**o+(0.737876348154)*x[0]+(0.183316445987)*x[1]**o+(-0.821207746237)*x[1]
        arg[1,2,2,0]=(0.300516177535)*x[0]**o+(-0.204187510383)*x[0]+(0.126601242737)*x[1]**o+(0.0794834423875)*x[1]
        arg[1,2,2,1]=(-0.29046926624)*x[0]**o+(-0.310057692431)*x[0]+(-0.810227948574)*x[1]**o+(-0.464128160277)*x[1]
        arg[1,3,0,0]=(-0.134275834453)*x[0]**o+(0.448577162559)*x[0]+(0.757723452446)*x[1]**o+(0.139202834725)*x[1]
        arg[1,3,0,1]=(0.882915728842)*x[0]**o+(-0.0750591947315)*x[0]+(0.503482692135)*x[1]**o+(-0.176350465386)*x[1]
        arg[1,3,1,0]=(-0.954792910945)*x[0]**o+(0.772215353622)*x[0]+(-0.861747803918)*x[1]**o+(-0.932727438775)*x[1]
        arg[1,3,1,1]=(0.747255393187)*x[0]**o+(0.0392661297355)*x[0]+(-0.322274864209)*x[1]**o+(-0.491462177972)*x[1]
        arg[1,3,2,0]=(0.139287057836)*x[0]**o+(0.312258185231)*x[0]+(-0.488288412308)*x[1]**o+(-0.185131700928)*x[1]
        arg[1,3,2,1]=(-0.861625516304)*x[0]**o+(0.681454010645)*x[0]+(0.206644380777)*x[1]**o+(-0.0344138929268)*x[1]
        arg[1,4,0,0]=(-0.714198122614)*x[0]**o+(-0.413113909739)*x[0]+(-0.971680855409)*x[1]**o+(0.602598611545)*x[1]
        arg[1,4,0,1]=(0.293578109913)*x[0]**o+(-0.495635685351)*x[0]+(0.347408878778)*x[1]**o+(-0.923814185786)*x[1]
        arg[1,4,1,0]=(0.843760126513)*x[0]**o+(-0.671075074679)*x[0]+(-0.284086603407)*x[1]**o+(0.437492233496)*x[1]
        arg[1,4,1,1]=(-0.342911357374)*x[0]**o+(-0.440232224635)*x[0]+(0.537701123084)*x[1]**o+(-0.525203729082)*x[1]
        arg[1,4,2,0]=(-0.71201360314)*x[0]**o+(-0.706332525171)*x[0]+(0.831438049852)*x[1]**o+(0.819141670055)*x[1]
        arg[1,4,2,1]=(-0.616403541928)*x[0]**o+(0.635973739636)*x[0]+(-0.0369972206543)*x[1]**o+(-0.08595692743)*x[1]
        arg[2,0,0,0]=(-0.959754423491)*x[0]**o+(-0.332473557912)*x[0]+(-0.464334304695)*x[1]**o+(0.597214020843)*x[1]
        arg[2,0,0,1]=(0.231051530608)*x[0]**o+(0.368524293555)*x[0]+(0.173044245392)*x[1]**o+(0.505867390994)*x[1]
        arg[2,0,1,0]=(0.376577055194)*x[0]**o+(-0.739990982509)*x[0]+(-0.816201949845)*x[1]**o+(-0.71233193641)*x[1]
        arg[2,0,1,1]=(-0.4891837531)*x[0]**o+(-0.121562226208)*x[0]+(-0.876294548464)*x[1]**o+(0.377763924093)*x[1]
        arg[2,0,2,0]=(-0.759548081841)*x[0]**o+(-0.118749434442)*x[0]+(0.602375475355)*x[1]**o+(-0.877213577079)*x[1]
        arg[2,0,2,1]=(0.114018259802)*x[0]**o+(-0.627149204501)*x[0]+(0.813648191424)*x[1]**o+(-0.612548616323)*x[1]
        arg[2,1,0,0]=(-0.572699800518)*x[0]**o+(0.507715829662)*x[0]+(-0.12122456959)*x[1]**o+(0.75522878228)*x[1]
        arg[2,1,0,1]=(0.0655268452799)*x[0]**o+(0.211191572823)*x[0]+(0.539760655497)*x[1]**o+(0.657397992057)*x[1]
        arg[2,1,1,0]=(0.358281119336)*x[0]**o+(0.119364032507)*x[0]+(-0.0242249415295)*x[1]**o+(-0.645986730609)*x[1]
        arg[2,1,1,1]=(0.523751704889)*x[0]**o+(-0.237670103222)*x[0]+(-0.995787126907)*x[1]**o+(-0.504129088442)*x[1]
        arg[2,1,2,0]=(-0.185380508646)*x[0]**o+(-0.218341933583)*x[0]+(0.149400154478)*x[1]**o+(0.00252616040715)*x[1]
        arg[2,1,2,1]=(0.81086932122)*x[0]**o+(0.387271527481)*x[0]+(0.908525646396)*x[1]**o+(-0.75383394204)*x[1]
        arg[2,2,0,0]=(-0.463416100256)*x[0]**o+(-0.891654021409)*x[0]+(-0.0495088159461)*x[1]**o+(0.398915277911)*x[1]
        arg[2,2,0,1]=(-0.200698149193)*x[0]**o+(0.127899540753)*x[0]+(-0.895280577411)*x[1]**o+(-0.197025422242)*x[1]
        arg[2,2,1,0]=(0.888683772867)*x[0]**o+(-0.84436563509)*x[0]+(-0.375709672588)*x[1]**o+(0.591336312818)*x[1]
        arg[2,2,1,1]=(-0.0167949020901)*x[0]**o+(0.145017501865)*x[0]+(0.868194479789)*x[1]**o+(-0.62439676328)*x[1]
        arg[2,2,2,0]=(0.441981698578)*x[0]**o+(-0.481156166596)*x[0]+(0.267937553127)*x[1]**o+(-0.37032246733)*x[1]
        arg[2,2,2,1]=(0.876701424579)*x[0]**o+(0.473798212378)*x[0]+(0.697645775876)*x[1]**o+(-0.798143376838)*x[1]
        arg[2,3,0,0]=(0.111231509217)*x[0]**o+(0.188121806171)*x[0]+(-0.0706155476337)*x[1]**o+(0.779423336221)*x[1]
        arg[2,3,0,1]=(-0.858913402812)*x[0]**o+(0.655459361097)*x[0]+(0.326282512878)*x[1]**o+(0.863386952614)*x[1]
        arg[2,3,1,0]=(-0.524551221953)*x[0]**o+(-0.807242415277)*x[0]+(0.575866251831)*x[1]**o+(-0.74503615846)*x[1]
        arg[2,3,1,1]=(0.391514075129)*x[0]**o+(0.477257809825)*x[0]+(-0.488263373008)*x[1]**o+(-0.29101442481)*x[1]
        arg[2,3,2,0]=(0.26532129161)*x[0]**o+(0.22794872765)*x[0]+(0.85094548724)*x[1]**o+(-0.369690624817)*x[1]
        arg[2,3,2,1]=(0.2339994493)*x[0]**o+(-0.901432708956)*x[0]+(0.309349741876)*x[1]**o+(0.132010344317)*x[1]
        arg[2,4,0,0]=(-0.713553783036)*x[0]**o+(0.791484993301)*x[0]+(0.339247480459)*x[1]**o+(0.158842307171)*x[1]
        arg[2,4,0,1]=(-0.733490022564)*x[0]**o+(0.631284830844)*x[0]+(0.340009298488)*x[1]**o+(-0.483162310574)*x[1]
        arg[2,4,1,0]=(0.709413437683)*x[0]**o+(0.896590124659)*x[0]+(0.680862759763)*x[1]**o+(-0.23579845663)*x[1]
        arg[2,4,1,1]=(-0.130761551034)*x[0]**o+(0.269095282394)*x[0]+(0.687201138134)*x[1]**o+(0.905183436376)*x[1]
        arg[2,4,2,0]=(0.256894911335)*x[0]**o+(0.706744915172)*x[0]+(0.910504833397)*x[1]**o+(-0.285088297895)*x[1]
        arg[2,4,2,1]=(0.95137247728)*x[0]**o+(-0.924669436646)*x[0]+(-0.146356272875)*x[1]**o+(-0.673326194162)*x[1]
        arg[3,0,0,0]=(0.663180444534)*x[0]**o+(0.894728781279)*x[0]+(0.894383747285)*x[1]**o+(0.969779862148)*x[1]
        arg[3,0,0,1]=(0.424556283891)*x[0]**o+(-0.97849198275)*x[0]+(0.367908872519)*x[1]**o+(0.624098355956)*x[1]
        arg[3,0,1,0]=(0.908698580251)*x[0]**o+(-0.899102004477)*x[0]+(0.509310001763)*x[1]**o+(-0.8399697646)*x[1]
        arg[3,0,1,1]=(0.523444225814)*x[0]**o+(0.410650511976)*x[0]+(-0.986699126405)*x[1]**o+(0.081494682537)*x[1]
        arg[3,0,2,0]=(-0.163604985314)*x[0]**o+(0.959338619715)*x[0]+(-0.843900271478)*x[1]**o+(-0.0218386544947)*x[1]
        arg[3,0,2,1]=(-0.490804271432)*x[0]**o+(0.123332672938)*x[0]+(0.902072835174)*x[1]**o+(-0.202340709957)*x[1]
        arg[3,1,0,0]=(-0.949731382685)*x[0]**o+(0.533695608969)*x[0]+(0.430512336347)*x[1]**o+(0.977434372776)*x[1]
        arg[3,1,0,1]=(0.945102298088)*x[0]**o+(-0.117807763531)*x[0]+(-0.203921504027)*x[1]**o+(-0.261266079346)*x[1]
        arg[3,1,1,0]=(0.762442770795)*x[0]**o+(-0.318456087863)*x[0]+(-0.365021977395)*x[1]**o+(0.0516932816311)*x[1]
        arg[3,1,1,1]=(-0.829061607399)*x[0]**o+(0.854900781365)*x[0]+(-0.397139314214)*x[1]**o+(-0.549679351555)*x[1]
        arg[3,1,2,0]=(-0.780040060687)*x[0]**o+(0.719393460042)*x[0]+(-0.435377419129)*x[1]**o+(0.655962063649)*x[1]
        arg[3,1,2,1]=(-0.853144390228)*x[0]**o+(0.0940222442927)*x[0]+(-0.642258121264)*x[1]**o+(-0.615386923437)*x[1]
        arg[3,2,0,0]=(0.377161814597)*x[0]**o+(0.349238572634)*x[0]+(0.361300611554)*x[1]**o+(0.554382639639)*x[1]
        arg[3,2,0,1]=(-0.51174671413)*x[0]**o+(-0.0586248632463)*x[0]+(0.083224329707)*x[1]**o+(0.506614699443)*x[1]
        arg[3,2,1,0]=(0.612695079311)*x[0]**o+(0.82053876378)*x[0]+(-0.132608876197)*x[1]**o+(0.701720563108)*x[1]
        arg[3,2,1,1]=(0.0928734170244)*x[0]**o+(-0.127564289866)*x[0]+(0.68468196965)*x[1]**o+(0.0168958305852)*x[1]
        arg[3,2,2,0]=(-0.863542893122)*x[0]**o+(0.0533007397457)*x[0]+(-0.0602194449612)*x[1]**o+(0.391122261927)*x[1]
        arg[3,2,2,1]=(-0.0942537498633)*x[0]**o+(-0.421741120475)*x[0]+(-0.0746938765947)*x[1]**o+(0.988111802567)*x[1]
        arg[3,3,0,0]=(-0.0588913579205)*x[0]**o+(0.439330145374)*x[0]+(-0.541714868844)*x[1]**o+(0.845344272279)*x[1]
        arg[3,3,0,1]=(0.221784155922)*x[0]**o+(0.983539923382)*x[0]+(-0.32332836636)*x[1]**o+(-0.892579743718)*x[1]
        arg[3,3,1,0]=(0.804097639203)*x[0]**o+(-0.342072604164)*x[0]+(0.755681096012)*x[1]**o+(0.432897246925)*x[1]
        arg[3,3,1,1]=(0.825696602707)*x[0]**o+(0.536999112965)*x[0]+(0.745033643035)*x[1]**o+(0.156806358776)*x[1]
        arg[3,3,2,0]=(-0.372114391352)*x[0]**o+(0.670417556114)*x[0]+(-0.569395510546)*x[1]**o+(-0.523784408534)*x[1]
        arg[3,3,2,1]=(0.439723359721)*x[0]**o+(0.809733189174)*x[0]+(0.781753556415)*x[1]**o+(0.375991547044)*x[1]
        arg[3,4,0,0]=(-0.429896412297)*x[0]**o+(-0.908820042346)*x[0]+(0.328787484151)*x[1]**o+(-0.610488251755)*x[1]
        arg[3,4,0,1]=(0.803567111353)*x[0]**o+(-0.487219379817)*x[0]+(-0.541538468561)*x[1]**o+(-0.692964506777)*x[1]
        arg[3,4,1,0]=(-0.963266835039)*x[0]**o+(0.667510333677)*x[0]+(0.308312799035)*x[1]**o+(0.686605377458)*x[1]
        arg[3,4,1,1]=(0.651198604373)*x[0]**o+(0.306465142929)*x[0]+(-0.923691546947)*x[1]**o+(-0.376240035765)*x[1]
        arg[3,4,2,0]=(-0.339406539705)*x[0]**o+(0.524709759622)*x[0]+(-0.0326564953763)*x[1]**o+(-0.658296780229)*x[1]
        arg[3,4,2,1]=(0.471355209305)*x[0]**o+(-0.473756698531)*x[0]+(0.193890658409)*x[1]**o+(-0.266632530307)*x[1]
        ref[0,0,0,0]=(0.765391656872)/(o+1.)+(-0.322334975868)+(0.415003066171)*0.5**o
        ref[0,0,0,1]=(-0.152730990885)/(o+1.)+(0.0623697786981)+(-0.928539602254)*0.5**o
        ref[0,0,1,0]=(0.505558859525)/(o+1.)+(0.0211473671443)+(-0.937831078575)*0.5**o
        ref[0,0,1,1]=(0.194087349442)/(o+1.)+(0.537213126576)+(0.909415074451)*0.5**o
        ref[0,0,2,0]=(0.518460161897)/(o+1.)+(-0.353834462413)+(0.935190448625)*0.5**o
        ref[0,0,2,1]=(0.578391007321)/(o+1.)+(0.277770233356)+(-0.94062714999)*0.5**o
        ref[0,1,0,0]=(-0.603956105825)/(o+1.)+(-0.612808261345)+(-0.197219678026)*0.5**o
        ref[0,1,0,1]=(-0.270612249495)/(o+1.)+(-0.0917787464331)+(-0.590715606611)*0.5**o
        ref[0,1,1,0]=(0.0875989587033)/(o+1.)+(0.333940978312)+(-0.365516638755)*0.5**o
        ref[0,1,1,1]=(0.625272530385)/(o+1.)+(-0.273562720598)+(0.315218558548)*0.5**o
        ref[0,1,2,0]=(0.115500534905)/(o+1.)+(-0.899119749149)+(-0.502497884169)*0.5**o
        ref[0,1,2,1]=(-0.0715650027129)/(o+1.)+(0.0286821705227)+(0.615837581258)*0.5**o
        ref[0,2,0,0]=(-0.532213103734)/(o+1.)+(0.270406536408)+(-0.898904577889)*0.5**o
        ref[0,2,0,1]=(0.751663691868)/(o+1.)+(0.0556640538013)+(-0.0056483770747)*0.5**o
        ref[0,2,1,0]=(-0.932579716748)/(o+1.)+(-0.364716190281)+(0.271196923039)*0.5**o
        ref[0,2,1,1]=(0.747625244884)/(o+1.)+(0.420842084614)+(-0.788206773125)*0.5**o
        ref[0,2,2,0]=(0.197684766271)/(o+1.)+(-0.889094904468)+(-0.787603701957)*0.5**o
        ref[0,2,2,1]=(-0.525306115268)/(o+1.)+(0.439959527228)+(0.417538087399)*0.5**o
        ref[0,3,0,0]=(-0.149386157207)/(o+1.)+(-0.289926844941)+(-0.230658480436)*0.5**o
        ref[0,3,0,1]=(-0.542257139282)/(o+1.)+(-0.0133255401565)+(-0.815859549425)*0.5**o
        ref[0,3,1,0]=(0.714019527678)/(o+1.)+(-0.00632729199566)+(0.0508974791413)*0.5**o
        ref[0,3,1,1]=(0.352455072404)/(o+1.)+(0.143383852019)+(0.119419200166)*0.5**o
        ref[0,3,2,0]=(-0.585094684368)/(o+1.)+(0.00921199711359)+(-0.82075904747)*0.5**o
        ref[0,3,2,1]=(0.686644239408)/(o+1.)+(0.468673187806)+(-0.748061395205)*0.5**o
        ref[0,4,0,0]=(0.129373873322)/(o+1.)+(0.607761864417)+(0.128293903485)*0.5**o
        ref[0,4,0,1]=(-0.170677596319)/(o+1.)+(-0.206814905431)+(0.639638672694)*0.5**o
        ref[0,4,1,0]=(0.282544628333)/(o+1.)+(-0.475291486231)+(0.43743097727)*0.5**o
        ref[0,4,1,1]=(0.218383977926)/(o+1.)+(0.43905900591)+(-0.995599965283)*0.5**o
        ref[0,4,2,0]=(-0.449331655188)/(o+1.)+(-0.0971131654902)+(0.922609534479)*0.5**o
        ref[0,4,2,1]=(-0.167639663907)/(o+1.)+(-0.103797419824)+(0.950186933361)*0.5**o
        ref[1,0,0,0]=(-0.622510875807)/(o+1.)+(0.186056784105)+(0.0573632292788)*0.5**o
        ref[1,0,0,1]=(0.469744047929)/(o+1.)+(-0.838331463751)+(0.368975600444)*0.5**o
        ref[1,0,1,0]=(0.625367069433)/(o+1.)+(-0.432363629616)+(-0.810194964715)*0.5**o
        ref[1,0,1,1]=(0.359324627118)/(o+1.)+(0.36983912542)+(0.744923275143)*0.5**o
        ref[1,0,2,0]=(0.318198109895)/(o+1.)+(-0.215392416287)+(0.891959004941)*0.5**o
        ref[1,0,2,1]=(-0.674805144805)/(o+1.)+(0.581833674632)+(0.842125439023)*0.5**o
        ref[1,1,0,0]=(-0.740263211102)/(o+1.)+(0.109311509194)+(-0.786719774805)*0.5**o
        ref[1,1,0,1]=(0.714032957488)/(o+1.)+(-0.81946337242)+(0.831245977993)*0.5**o
        ref[1,1,1,0]=(0.455949140326)/(o+1.)+(0.666183494578)+(0.862796574462)*0.5**o
        ref[1,1,1,1]=(-0.62474682088)/(o+1.)+(0.438060834031)+(-0.500409398892)*0.5**o
        ref[1,1,2,0]=(-0.770315341866)/(o+1.)+(-0.375748925732)+(-0.402886961189)*0.5**o
        ref[1,1,2,1]=(0.654162491323)/(o+1.)+(0.189164682023)+(0.358161520677)*0.5**o
        ref[1,2,0,0]=(-0.0538737948754)/(o+1.)+(0.333813880332)+(-0.15539934232)*0.5**o
        ref[1,2,0,1]=(-0.377617770006)/(o+1.)+(-0.0218224426646)+(0.371159212282)*0.5**o
        ref[1,2,1,0]=(-0.360936107893)/(o+1.)+(0.141978404604)+(0.117790556271)*0.5**o
        ref[1,2,1,1]=(0.183316445987)/(o+1.)+(-0.0416656990415)+(-0.524828128971)*0.5**o
        ref[1,2,2,0]=(0.126601242737)/(o+1.)+(-0.0623520339976)+(0.300516177535)*0.5**o
        ref[1,2,2,1]=(-0.810227948574)/(o+1.)+(-0.387092926354)+(-0.29046926624)*0.5**o
        ref[1,3,0,0]=(0.757723452446)/(o+1.)+(0.293889998642)+(-0.134275834453)*0.5**o
        ref[1,3,0,1]=(0.503482692135)/(o+1.)+(-0.125704830059)+(0.882915728842)*0.5**o
        ref[1,3,1,0]=(-0.861747803918)/(o+1.)+(-0.0802560425765)+(-0.954792910945)*0.5**o
        ref[1,3,1,1]=(-0.322274864209)/(o+1.)+(-0.226098024118)+(0.747255393187)*0.5**o
        ref[1,3,2,0]=(-0.488288412308)/(o+1.)+(0.0635632421511)+(0.139287057836)*0.5**o
        ref[1,3,2,1]=(0.206644380777)/(o+1.)+(0.323520058859)+(-0.861625516304)*0.5**o
        ref[1,4,0,0]=(-0.971680855409)/(o+1.)+(0.0947423509032)+(-0.714198122614)*0.5**o
        ref[1,4,0,1]=(0.347408878778)/(o+1.)+(-0.709724935569)+(0.293578109913)*0.5**o
        ref[1,4,1,0]=(-0.284086603407)/(o+1.)+(-0.116791420591)+(0.843760126513)*0.5**o
        ref[1,4,1,1]=(0.537701123084)/(o+1.)+(-0.482717976859)+(-0.342911357374)*0.5**o
        ref[1,4,2,0]=(0.831438049852)/(o+1.)+(0.056404572442)+(-0.71201360314)*0.5**o
        ref[1,4,2,1]=(-0.0369972206543)/(o+1.)+(0.275008406103)+(-0.616403541928)*0.5**o
        ref[2,0,0,0]=(-0.464334304695)/(o+1.)+(0.132370231466)+(-0.959754423491)*0.5**o
        ref[2,0,0,1]=(0.173044245392)/(o+1.)+(0.437195842274)+(0.231051530608)*0.5**o
        ref[2,0,1,0]=(-0.816201949845)/(o+1.)+(-0.72616145946)+(0.376577055194)*0.5**o
        ref[2,0,1,1]=(-0.876294548464)/(o+1.)+(0.128100848943)+(-0.4891837531)*0.5**o
        ref[2,0,2,0]=(0.602375475355)/(o+1.)+(-0.497981505761)+(-0.759548081841)*0.5**o
        ref[2,0,2,1]=(0.813648191424)/(o+1.)+(-0.619848910412)+(0.114018259802)*0.5**o
        ref[2,1,0,0]=(-0.12122456959)/(o+1.)+(0.631472305971)+(-0.572699800518)*0.5**o
        ref[2,1,0,1]=(0.539760655497)/(o+1.)+(0.43429478244)+(0.0655268452799)*0.5**o
        ref[2,1,1,0]=(-0.0242249415295)/(o+1.)+(-0.263311349051)+(0.358281119336)*0.5**o
        ref[2,1,1,1]=(-0.995787126907)/(o+1.)+(-0.370899595832)+(0.523751704889)*0.5**o
        ref[2,1,2,0]=(0.149400154478)/(o+1.)+(-0.107907886588)+(-0.185380508646)*0.5**o
        ref[2,1,2,1]=(0.908525646396)/(o+1.)+(-0.18328120728)+(0.81086932122)*0.5**o
        ref[2,2,0,0]=(-0.0495088159461)/(o+1.)+(-0.246369371749)+(-0.463416100256)*0.5**o
        ref[2,2,0,1]=(-0.895280577411)/(o+1.)+(-0.0345629407446)+(-0.200698149193)*0.5**o
        ref[2,2,1,0]=(-0.375709672588)/(o+1.)+(-0.126514661136)+(0.888683772867)*0.5**o
        ref[2,2,1,1]=(0.868194479789)/(o+1.)+(-0.239689630708)+(-0.0167949020901)*0.5**o
        ref[2,2,2,0]=(0.267937553127)/(o+1.)+(-0.425739316963)+(0.441981698578)*0.5**o
        ref[2,2,2,1]=(0.697645775876)/(o+1.)+(-0.16217258223)+(0.876701424579)*0.5**o
        ref[2,3,0,0]=(-0.0706155476337)/(o+1.)+(0.483772571196)+(0.111231509217)*0.5**o
        ref[2,3,0,1]=(0.326282512878)/(o+1.)+(0.759423156855)+(-0.858913402812)*0.5**o
        ref[2,3,1,0]=(0.575866251831)/(o+1.)+(-0.776139286869)+(-0.524551221953)*0.5**o
        ref[2,3,1,1]=(-0.488263373008)/(o+1.)+(0.0931216925076)+(0.391514075129)*0.5**o
        ref[2,3,2,0]=(0.85094548724)/(o+1.)+(-0.0708709485834)+(0.26532129161)*0.5**o
        ref[2,3,2,1]=(0.309349741876)/(o+1.)+(-0.384711182319)+(0.2339994493)*0.5**o
        ref[2,4,0,0]=(0.339247480459)/(o+1.)+(0.475163650236)+(-0.713553783036)*0.5**o
        ref[2,4,0,1]=(0.340009298488)/(o+1.)+(0.0740612601349)+(-0.733490022564)*0.5**o
        ref[2,4,1,0]=(0.680862759763)/(o+1.)+(0.330395834014)+(0.709413437683)*0.5**o
        ref[2,4,1,1]=(0.687201138134)/(o+1.)+(0.587139359385)+(-0.130761551034)*0.5**o
        ref[2,4,2,0]=(0.910504833397)/(o+1.)+(0.210828308638)+(0.256894911335)*0.5**o
        ref[2,4,2,1]=(-0.146356272875)/(o+1.)+(-0.798997815404)+(0.95137247728)*0.5**o
        ref[3,0,0,0]=(0.894383747285)/(o+1.)+(0.932254321713)+(0.663180444534)*0.5**o
        ref[3,0,0,1]=(0.367908872519)/(o+1.)+(-0.177196813397)+(0.424556283891)*0.5**o
        ref[3,0,1,0]=(0.509310001763)/(o+1.)+(-0.869535884539)+(0.908698580251)*0.5**o
        ref[3,0,1,1]=(-0.986699126405)/(o+1.)+(0.246072597257)+(0.523444225814)*0.5**o
        ref[3,0,2,0]=(-0.843900271478)/(o+1.)+(0.46874998261)+(-0.163604985314)*0.5**o
        ref[3,0,2,1]=(0.902072835174)/(o+1.)+(-0.0395040185096)+(-0.490804271432)*0.5**o
        ref[3,1,0,0]=(0.430512336347)/(o+1.)+(0.755564990872)+(-0.949731382685)*0.5**o
        ref[3,1,0,1]=(-0.203921504027)/(o+1.)+(-0.189536921439)+(0.945102298088)*0.5**o
        ref[3,1,1,0]=(-0.365021977395)/(o+1.)+(-0.133381403116)+(0.762442770795)*0.5**o
        ref[3,1,1,1]=(-0.397139314214)/(o+1.)+(0.152610714905)+(-0.829061607399)*0.5**o
        ref[3,1,2,0]=(-0.435377419129)/(o+1.)+(0.687677761846)+(-0.780040060687)*0.5**o
        ref[3,1,2,1]=(-0.642258121264)/(o+1.)+(-0.260682339572)+(-0.853144390228)*0.5**o
        ref[3,2,0,0]=(0.361300611554)/(o+1.)+(0.451810606136)+(0.377161814597)*0.5**o
        ref[3,2,0,1]=(0.083224329707)/(o+1.)+(0.223994918098)+(-0.51174671413)*0.5**o
        ref[3,2,1,0]=(-0.132608876197)/(o+1.)+(0.761129663444)+(0.612695079311)*0.5**o
        ref[3,2,1,1]=(0.68468196965)/(o+1.)+(-0.0553342296404)+(0.0928734170244)*0.5**o
        ref[3,2,2,0]=(-0.0602194449612)/(o+1.)+(0.222211500837)+(-0.863542893122)*0.5**o
        ref[3,2,2,1]=(-0.0746938765947)/(o+1.)+(0.283185341046)+(-0.0942537498633)*0.5**o
        ref[3,3,0,0]=(-0.541714868844)/(o+1.)+(0.642337208826)+(-0.0588913579205)*0.5**o
        ref[3,3,0,1]=(-0.32332836636)/(o+1.)+(0.0454800898319)+(0.221784155922)*0.5**o
        ref[3,3,1,0]=(0.755681096012)/(o+1.)+(0.0454123213802)+(0.804097639203)*0.5**o
        ref[3,3,1,1]=(0.745033643035)/(o+1.)+(0.34690273587)+(0.825696602707)*0.5**o
        ref[3,3,2,0]=(-0.569395510546)/(o+1.)+(0.0733165737898)+(-0.372114391352)*0.5**o
        ref[3,3,2,1]=(0.781753556415)/(o+1.)+(0.592862368109)+(0.439723359721)*0.5**o
        ref[3,4,0,0]=(0.328787484151)/(o+1.)+(-0.75965414705)+(-0.429896412297)*0.5**o
        ref[3,4,0,1]=(-0.541538468561)/(o+1.)+(-0.590091943297)+(0.803567111353)*0.5**o
        ref[3,4,1,0]=(0.308312799035)/(o+1.)+(0.677057855567)+(-0.963266835039)*0.5**o
        ref[3,4,1,1]=(-0.923691546947)/(o+1.)+(-0.0348874464182)+(0.651198604373)*0.5**o
        ref[3,4,2,0]=(-0.0326564953763)/(o+1.)+(-0.0667935103036)+(-0.339406539705)*0.5**o
        ref[3,4,2,1]=(0.193890658409)/(o+1.)+(-0.370194614419)+(0.471355209305)*0.5**o
      else:
        arg[0,0,0,0]=(0.0737627367843)*x[0]**o+(-0.897508234376)*x[0]+(0.499361502035)*x[1]**o+(-0.830793706142)*x[1]+(0.967672023686)*x[2]**o+(-0.94209897356)*x[2]
        arg[0,0,0,1]=(0.353968533247)*x[0]**o+(-0.828575104081)*x[0]+(0.111197799977)*x[1]**o+(0.475627052455)*x[1]+(0.10233739786)*x[2]**o+(-0.297090205985)*x[2]
        arg[0,0,1,0]=(0.315704665816)*x[0]**o+(0.450577419574)*x[0]+(-0.0225047225996)*x[1]**o+(0.221436098936)*x[1]+(-0.210708820992)*x[2]**o+(0.22813686037)*x[2]
        arg[0,0,1,1]=(-0.453912049362)*x[0]**o+(0.443266972459)*x[0]+(-0.166003491301)*x[1]**o+(0.325157034345)*x[1]+(0.975435329063)*x[2]**o+(0.516477372955)*x[2]
        arg[0,0,2,0]=(0.705225432895)*x[0]**o+(0.406870556161)*x[0]+(0.967131048725)*x[1]**o+(-0.31111693058)*x[1]+(0.915125425876)*x[2]**o+(-0.417407852906)*x[2]
        arg[0,0,2,1]=(-0.397162258761)*x[0]**o+(-0.49079016751)*x[0]+(-0.444905720899)*x[1]**o+(0.258998080457)*x[1]+(-0.406172174923)*x[2]**o+(0.166620074269)*x[2]
        arg[0,1,0,0]=(0.00444300957662)*x[0]**o+(0.59448685984)*x[0]+(-0.755596203939)*x[1]**o+(-0.587866578467)*x[1]+(-0.994620629569)*x[2]**o+(0.558539124849)*x[2]
        arg[0,1,0,1]=(0.726535641072)*x[0]**o+(-0.515254556008)*x[0]+(-0.737095044797)*x[1]**o+(0.396218854768)*x[1]+(-0.873340093434)*x[2]**o+(0.538194586759)*x[2]
        arg[0,1,1,0]=(-0.554579794515)*x[0]**o+(-0.754117891877)*x[0]+(0.242579027102)*x[1]**o+(0.368307663104)*x[1]+(0.308372932825)*x[2]**o+(-0.521440130826)*x[2]
        arg[0,1,1,1]=(0.294744137189)*x[0]**o+(0.44996935134)*x[0]+(0.118263237453)*x[1]**o+(-0.143566244715)*x[1]+(-0.927385432821)*x[2]**o+(0.912735237305)*x[2]
        arg[0,1,2,0]=(-0.30261020867)*x[0]**o+(-0.994883662031)*x[0]+(0.514662053738)*x[1]**o+(0.327770859964)*x[1]+(0.862452368458)*x[2]**o+(-0.739026842429)*x[2]
        arg[0,1,2,1]=(0.494855964972)*x[0]**o+(-0.358461686787)*x[0]+(0.406489619959)*x[1]**o+(0.417722618206)*x[1]+(0.679808195501)*x[2]**o+(-0.00502769522311)*x[2]
        arg[0,2,0,0]=(-0.914585215232)*x[0]**o+(0.305890296017)*x[0]+(-0.867826544668)*x[1]**o+(0.304580882671)*x[1]+(-0.401401956053)*x[2]**o+(0.842276423411)*x[2]
        arg[0,2,0,1]=(-0.260590397572)*x[0]**o+(0.541867335986)*x[0]+(0.0279475511153)*x[1]**o+(0.0255320376447)*x[1]+(-0.584584718877)*x[2]**o+(-0.640388032783)*x[2]
        arg[0,2,1,0]=(0.0455797513404)*x[0]**o+(-0.764984318339)*x[0]+(-0.257174640639)*x[1]**o+(0.745888292962)*x[1]+(0.964524202534)*x[2]**o+(0.435680191282)*x[2]
        arg[0,2,1,1]=(-0.300900136798)*x[0]**o+(-0.899164082043)*x[0]+(-0.63273853331)*x[1]**o+(0.56522562781)*x[1]+(-0.846482371222)*x[2]**o+(-0.909985752269)*x[2]
        arg[0,2,2,0]=(0.745711773093)*x[0]**o+(0.0627291150681)*x[0]+(-0.090340386706)*x[1]**o+(-0.0912293084958)*x[1]+(0.108613205226)*x[2]**o+(-0.28985444593)*x[2]
        arg[0,2,2,1]=(0.291340077334)*x[0]**o+(0.592856577974)*x[0]+(0.141857446535)*x[1]**o+(0.830526360843)*x[1]+(0.956840406828)*x[2]**o+(-0.717465405888)*x[2]
        arg[0,3,0,0]=(0.89242099254)*x[0]**o+(0.529348654364)*x[0]+(-0.074382350183)*x[1]**o+(0.874670648345)*x[1]+(-0.728104560168)*x[2]**o+(0.0781153963606)*x[2]
        arg[0,3,0,1]=(0.095390666498)*x[0]**o+(0.0124610436496)*x[0]+(0.278014506594)*x[1]**o+(0.923928359216)*x[1]+(-0.0905667357972)*x[2]**o+(-0.894031439498)*x[2]
        arg[0,3,1,0]=(-0.317750910722)*x[0]**o+(0.677406387747)*x[0]+(0.550094997541)*x[1]**o+(-0.30098732949)*x[1]+(0.501753868155)*x[2]**o+(-0.42859127752)*x[2]
        arg[0,3,1,1]=(-0.204455448392)*x[0]**o+(0.445237113438)*x[0]+(0.853596204887)*x[1]**o+(0.315701645178)*x[1]+(0.307192864939)*x[2]**o+(-0.708325809173)*x[2]
        arg[0,3,2,0]=(0.38581656579)*x[0]**o+(-0.79289714243)*x[0]+(-0.412226202311)*x[1]**o+(0.655534112291)*x[1]+(0.31352728014)*x[2]**o+(0.502089385396)*x[2]
        arg[0,3,2,1]=(-0.225571343976)*x[0]**o+(0.687765563016)*x[0]+(0.0421378888728)*x[1]**o+(0.54466301835)*x[1]+(-0.430288255786)*x[2]**o+(-0.117571440224)*x[2]
        arg[0,4,0,0]=(0.834083057621)*x[0]**o+(0.0292441566815)*x[0]+(-0.947154369416)*x[1]**o+(0.597153808995)*x[1]+(0.323706009194)*x[2]**o+(0.664093182644)*x[2]
        arg[0,4,0,1]=(-0.613152578007)*x[0]**o+(0.253155875339)*x[0]+(0.297138228345)*x[1]**o+(-0.604393247773)*x[1]+(-0.936718722281)*x[2]**o+(-0.410140848312)*x[2]
        arg[0,4,1,0]=(-0.373668614153)*x[0]**o+(-0.401240526097)*x[0]+(-0.417458139032)*x[1]**o+(0.456033864594)*x[1]+(-0.158434012225)*x[2]**o+(-0.33938136039)*x[2]
        arg[0,4,1,1]=(0.00943802199128)*x[0]**o+(-0.800756064115)*x[0]+(0.899199671858)*x[1]**o+(0.376830611387)*x[1]+(-0.930822199046)*x[2]**o+(0.192235807799)*x[2]
        arg[0,4,2,0]=(0.157099024354)*x[0]**o+(0.195942080381)*x[0]+(-0.554519054021)*x[1]**o+(0.871823312361)*x[1]+(-0.34803033039)*x[2]**o+(-0.646933331859)*x[2]
        arg[0,4,2,1]=(0.933762543076)*x[0]**o+(-0.169843985744)*x[0]+(0.971089176971)*x[1]**o+(-0.605176382286)*x[1]+(0.254369209427)*x[2]**o+(0.0314820745541)*x[2]
        arg[1,0,0,0]=(0.0417476479889)*x[0]**o+(-0.144293810851)*x[0]+(-0.677039420744)*x[1]**o+(-0.137097132377)*x[1]+(0.721082639859)*x[2]**o+(-0.32510577691)*x[2]
        arg[1,0,0,1]=(0.450986977446)*x[0]**o+(-0.921371106219)*x[0]+(0.536898979198)*x[1]**o+(-0.814951108186)*x[1]+(-0.733774506956)*x[2]**o+(0.938941747764)*x[2]
        arg[1,0,1,0]=(-0.23712795738)*x[0]**o+(0.450883240541)*x[0]+(0.101102533189)*x[1]**o+(-0.998253664232)*x[1]+(-0.843977488601)*x[2]**o+(-0.807025450448)*x[2]
        arg[1,0,1,1]=(-0.308721170682)*x[0]**o+(-0.546268734305)*x[0]+(0.643628083343)*x[1]**o+(0.206934468523)*x[1]+(-0.257667927436)*x[2]**o+(0.468860780891)*x[2]
        arg[1,0,2,0]=(-0.267232319593)*x[0]**o+(0.221737693042)*x[0]+(0.202218228468)*x[1]**o+(-0.560941556406)*x[1]+(0.910244160614)*x[2]**o+(0.361584784536)*x[2]
        arg[1,0,2,1]=(0.405254374432)*x[0]**o+(-0.102574362257)*x[0]+(0.527874164745)*x[1]**o+(0.0318395137256)*x[1]+(-0.448050293943)*x[2]**o+(-0.6401160036)*x[2]
        arg[1,1,0,0]=(-0.877224972777)*x[0]**o+(-0.544175806369)*x[0]+(0.528037913494)*x[1]**o+(-0.477854554671)*x[1]+(-0.394875438861)*x[2]**o+(-0.704656012962)*x[2]
        arg[1,1,0,1]=(-0.873928172379)*x[0]**o+(0.273455449944)*x[0]+(0.681090480547)*x[1]**o+(0.883243766093)*x[1]+(0.557357114631)*x[2]**o+(0.586148966774)*x[2]
        arg[1,1,1,0]=(0.552826305913)*x[0]**o+(-0.277269605193)*x[0]+(-0.681872908424)*x[1]**o+(-0.84578699459)*x[1]+(0.6543624385)*x[2]**o+(-0.355051513153)*x[2]
        arg[1,1,1,1]=(-0.71233607947)*x[0]**o+(-0.779861555179)*x[0]+(0.11496674995)*x[1]**o+(0.634901982779)*x[1]+(0.833044137166)*x[2]**o+(0.0443514408009)*x[2]
        arg[1,1,2,0]=(-0.411667274338)*x[0]**o+(0.218709061898)*x[0]+(0.132573928273)*x[1]**o+(-0.450677430962)*x[1]+(0.88420873514)*x[2]**o+(-0.618513305411)*x[2]
        arg[1,1,2,1]=(0.533005373575)*x[0]**o+(0.846343252936)*x[0]+(0.697076801609)*x[1]**o+(0.342260840742)*x[1]+(0.923380136498)*x[2]**o+(-0.727450493778)*x[2]
        arg[1,2,0,0]=(-0.637366803484)*x[0]**o+(-0.654649539562)*x[0]+(-0.443035194144)*x[1]**o+(0.4928304386)*x[1]+(0.889290653473)*x[2]**o+(0.208513517091)*x[2]
        arg[1,2,0,1]=(-0.404870452835)*x[0]**o+(-0.556431486625)*x[0]+(-0.428885935216)*x[1]**o+(0.208771213187)*x[1]+(0.706109349268)*x[2]**o+(0.726168991522)*x[2]
        arg[1,2,1,0]=(0.85574176569)*x[0]**o+(-0.371989246254)*x[0]+(0.0376283091444)*x[1]**o+(-0.164811219077)*x[1]+(0.842513532253)*x[2]**o+(-0.963454790343)*x[2]
        arg[1,2,1,1]=(0.576825533647)*x[0]**o+(0.866570909412)*x[0]+(-0.286228055595)*x[1]**o+(-0.509258889664)*x[1]+(0.358087406384)*x[2]**o+(0.2558870556)*x[2]
        arg[1,2,2,0]=(0.741411326194)*x[0]**o+(0.887444210472)*x[0]+(0.176659455323)*x[1]**o+(-0.292731470152)*x[1]+(0.179836617557)*x[2]**o+(-0.10894424483)*x[2]
        arg[1,2,2,1]=(0.386515069261)*x[0]**o+(-0.423389396097)*x[0]+(0.300384913804)*x[1]**o+(-0.569308908813)*x[1]+(0.845849686169)*x[2]**o+(-0.802483942058)*x[2]
        arg[1,3,0,0]=(0.848952965744)*x[0]**o+(0.113555873929)*x[0]+(0.132168122705)*x[1]**o+(0.464116031047)*x[1]+(-0.928746352905)*x[2]**o+(-0.176374657603)*x[2]
        arg[1,3,0,1]=(0.357870838328)*x[0]**o+(-0.294290586373)*x[0]+(0.395859596543)*x[1]**o+(-0.265635871788)*x[1]+(0.283887401402)*x[2]**o+(0.500378090749)*x[2]
        arg[1,3,1,0]=(-0.509333127149)*x[0]**o+(0.328856435768)*x[0]+(-0.377387784476)*x[1]**o+(-0.878505533565)*x[1]+(0.448760304667)*x[2]**o+(0.996692047048)*x[2]
        arg[1,3,1,1]=(-0.837885550386)*x[0]**o+(0.0608579436757)*x[0]+(-0.627132023609)*x[1]**o+(0.902538475491)*x[1]+(-0.449596037062)*x[2]**o+(-0.158786724549)*x[2]
        arg[1,3,2,0]=(0.205889276236)*x[0]**o+(0.576561726109)*x[0]+(-0.00281354319689)*x[1]**o+(0.214968600999)*x[1]+(0.811758703832)*x[2]**o+(0.260164242506)*x[2]
        arg[1,3,2,1]=(-0.331660060588)*x[0]**o+(0.713879758554)*x[0]+(0.804549392751)*x[1]**o+(-0.346397636822)*x[1]+(-0.364073503513)*x[2]**o+(0.338612348994)*x[2]
        arg[1,4,0,0]=(0.394201404247)*x[0]**o+(-0.416853395415)*x[0]+(-0.0581465874206)*x[1]**o+(0.105267182588)*x[1]+(0.791799718009)*x[2]**o+(0.0840172853234)*x[2]
        arg[1,4,0,1]=(-0.346144268453)*x[0]**o+(-0.661228785728)*x[0]+(0.326588395606)*x[1]**o+(0.766137046896)*x[1]+(0.566377202267)*x[2]**o+(0.613565461425)*x[2]
        arg[1,4,1,0]=(-0.907566140749)*x[0]**o+(-0.391612881392)*x[0]+(0.263322351365)*x[1]**o+(-0.4373853914)*x[1]+(0.248855925063)*x[2]**o+(0.973515668505)*x[2]
        arg[1,4,1,1]=(0.726194147182)*x[0]**o+(0.497593423927)*x[0]+(-0.951344923018)*x[1]**o+(0.55327321528)*x[1]+(-0.266195110749)*x[2]**o+(-0.310893832826)*x[2]
        arg[1,4,2,0]=(-0.940824546553)*x[0]**o+(-0.47838524024)*x[0]+(0.408728941942)*x[1]**o+(0.627300786998)*x[1]+(-0.0547545650101)*x[2]**o+(0.433290388525)*x[2]
        arg[1,4,2,1]=(0.728499572603)*x[0]**o+(-0.232088507059)*x[0]+(0.0550057703801)*x[1]**o+(0.159356057226)*x[1]+(0.111191390097)*x[2]**o+(-0.64498018454)*x[2]
        arg[2,0,0,0]=(0.467025642879)*x[0]**o+(-0.695379603222)*x[0]+(0.591732172092)*x[1]**o+(0.84325648142)*x[1]+(0.965696472916)*x[2]**o+(0.626196181241)*x[2]
        arg[2,0,0,1]=(-0.211129222294)*x[0]**o+(-0.501208172412)*x[0]+(-0.0162146409175)*x[1]**o+(-0.672364205306)*x[1]+(-0.851073479662)*x[2]**o+(-0.817568385627)*x[2]
        arg[2,0,1,0]=(-0.668065295797)*x[0]**o+(-0.90359857855)*x[0]+(0.040519772083)*x[1]**o+(-0.295766307198)*x[1]+(0.0491234828524)*x[2]**o+(-0.589557178985)*x[2]
        arg[2,0,1,1]=(0.928751918298)*x[0]**o+(-0.773787731767)*x[0]+(-0.744325160449)*x[1]**o+(-0.426987905682)*x[1]+(0.503339956851)*x[2]**o+(0.386756648382)*x[2]
        arg[2,0,2,0]=(-0.531818105049)*x[0]**o+(-0.586811490681)*x[0]+(0.780379352762)*x[1]**o+(-0.5575328003)*x[1]+(0.0354867101462)*x[2]**o+(0.581226069105)*x[2]
        arg[2,0,2,1]=(0.0150988200159)*x[0]**o+(0.56415563975)*x[0]+(0.540723773613)*x[1]**o+(0.0653377679637)*x[1]+(-0.52633696371)*x[2]**o+(-0.122811009405)*x[2]
        arg[2,1,0,0]=(-0.0829154151121)*x[0]**o+(-0.416192198737)*x[0]+(0.944232067474)*x[1]**o+(-0.159852455491)*x[1]+(-0.198397797188)*x[2]**o+(-0.684211447305)*x[2]
        arg[2,1,0,1]=(-0.834502772339)*x[0]**o+(-0.856817328109)*x[0]+(0.213303574315)*x[1]**o+(-0.283140791695)*x[1]+(-0.727061494352)*x[2]**o+(0.12871372765)*x[2]
        arg[2,1,1,0]=(0.247439924718)*x[0]**o+(-0.912464825903)*x[0]+(0.791177764168)*x[1]**o+(0.160047921728)*x[1]+(0.591086305304)*x[2]**o+(-0.774025941232)*x[2]
        arg[2,1,1,1]=(-0.120169534728)*x[0]**o+(-0.747254680906)*x[0]+(-0.394003570933)*x[1]**o+(-0.938198960695)*x[1]+(-0.0142776288517)*x[2]**o+(0.0627959740849)*x[2]
        arg[2,1,2,0]=(0.703841647274)*x[0]**o+(-0.946039767174)*x[0]+(-0.836717609846)*x[1]**o+(0.776573515772)*x[1]+(0.250502751027)*x[2]**o+(0.403896552902)*x[2]
        arg[2,1,2,1]=(-0.19760048131)*x[0]**o+(-0.250991189554)*x[0]+(0.278810924634)*x[1]**o+(-0.580148097047)*x[1]+(-0.197518781697)*x[2]**o+(0.116835806412)*x[2]
        arg[2,2,0,0]=(-0.507872937196)*x[0]**o+(-0.771841217512)*x[0]+(0.852666314762)*x[1]**o+(-0.482947444136)*x[1]+(0.805824662389)*x[2]**o+(-0.299255374349)*x[2]
        arg[2,2,0,1]=(-0.481403986338)*x[0]**o+(0.904322169038)*x[0]+(0.937553651477)*x[1]**o+(0.727763542606)*x[1]+(-0.69485539356)*x[2]**o+(0.547755372933)*x[2]
        arg[2,2,1,0]=(0.241675645258)*x[0]**o+(0.957681326492)*x[0]+(-0.305747218513)*x[1]**o+(-0.0393749799535)*x[1]+(-0.448892234759)*x[2]**o+(0.707429367761)*x[2]
        arg[2,2,1,1]=(0.114772627763)*x[0]**o+(-0.411147710203)*x[0]+(0.13389320737)*x[1]**o+(0.806309117051)*x[1]+(-0.572620769665)*x[2]**o+(0.0389925355751)*x[2]
        arg[2,2,2,0]=(0.887023209688)*x[0]**o+(0.158261816385)*x[0]+(0.687399231822)*x[1]**o+(-0.858491519094)*x[1]+(-0.00348150506922)*x[2]**o+(-0.863496570874)*x[2]
        arg[2,2,2,1]=(0.836731324893)*x[0]**o+(0.975472534225)*x[0]+(0.407275572226)*x[1]**o+(0.565132026147)*x[1]+(0.79110912675)*x[2]**o+(-0.0816802575667)*x[2]
        arg[2,3,0,0]=(0.196161020545)*x[0]**o+(0.254301467318)*x[0]+(0.759363127106)*x[1]**o+(0.536320544038)*x[1]+(0.522705219849)*x[2]**o+(0.376531450811)*x[2]
        arg[2,3,0,1]=(-0.862326385376)*x[0]**o+(0.766714365146)*x[0]+(0.279327620722)*x[1]**o+(-0.44416461578)*x[1]+(0.115982232563)*x[2]**o+(0.824064889151)*x[2]
        arg[2,3,1,0]=(0.571263839862)*x[0]**o+(-0.679998793927)*x[0]+(0.63548515376)*x[1]**o+(0.464171242163)*x[1]+(0.712124752567)*x[2]**o+(0.913131755622)*x[2]
        arg[2,3,1,1]=(0.272559456412)*x[0]**o+(0.0577748172306)*x[0]+(-0.610464803438)*x[1]**o+(0.233987628538)*x[1]+(0.904147555826)*x[2]**o+(-0.131245442847)*x[2]
        arg[2,3,2,0]=(0.3409363126)*x[0]**o+(0.40060221588)*x[0]+(-0.603551487822)*x[1]**o+(-0.697430353793)*x[1]+(-0.867009193249)*x[2]**o+(-0.178991284979)*x[2]
        arg[2,3,2,1]=(0.949170673623)*x[0]**o+(-0.0217541208215)*x[0]+(-0.775307373317)*x[1]**o+(0.421565612874)*x[1]+(0.419254478365)*x[2]**o+(-0.732203964657)*x[2]
        arg[2,4,0,0]=(0.876774885889)*x[0]**o+(0.441155536177)*x[0]+(-0.292113312365)*x[1]**o+(0.880590008772)*x[1]+(0.0732363738743)*x[2]**o+(-0.590855067487)*x[2]
        arg[2,4,0,1]=(0.347441329383)*x[0]**o+(-0.96566344519)*x[0]+(-0.0870932691958)*x[1]**o+(-0.793898415692)*x[1]+(0.911757004621)*x[2]**o+(0.623070769788)*x[2]
        arg[2,4,1,0]=(0.732123350436)*x[0]**o+(-0.707615856771)*x[0]+(-0.57969408421)*x[1]**o+(0.0643464469617)*x[1]+(-0.648380091597)*x[2]**o+(0.567100447405)*x[2]
        arg[2,4,1,1]=(-0.128872747083)*x[0]**o+(-0.463336399393)*x[0]+(-0.1679086419)*x[1]**o+(0.602218708561)*x[1]+(0.62788576637)*x[2]**o+(0.223548351914)*x[2]
        arg[2,4,2,0]=(0.619034818105)*x[0]**o+(0.167994824318)*x[0]+(-0.244892750219)*x[1]**o+(0.471338499791)*x[1]+(0.526950200066)*x[2]**o+(0.345611623572)*x[2]
        arg[2,4,2,1]=(0.645979236759)*x[0]**o+(0.79896884484)*x[0]+(-0.587486435644)*x[1]**o+(-0.467838428827)*x[1]+(0.672707985612)*x[2]**o+(-0.169680966884)*x[2]
        arg[3,0,0,0]=(-0.265836015694)*x[0]**o+(-0.383762854285)*x[0]+(0.420375720992)*x[1]**o+(0.739662661302)*x[1]+(-0.593559713248)*x[2]**o+(0.0743208592009)*x[2]
        arg[3,0,0,1]=(0.306246512933)*x[0]**o+(0.0357065903179)*x[0]+(0.213209244461)*x[1]**o+(-0.069836605971)*x[1]+(0.668535341179)*x[2]**o+(0.59870885392)*x[2]
        arg[3,0,1,0]=(0.509420593773)*x[0]**o+(0.995859415429)*x[0]+(-0.07734119959)*x[1]**o+(0.269006992126)*x[1]+(-0.465576902019)*x[2]**o+(0.318766487761)*x[2]
        arg[3,0,1,1]=(-0.609626065482)*x[0]**o+(0.970976299205)*x[0]+(-0.314734168176)*x[1]**o+(-0.536438958228)*x[1]+(0.900096595598)*x[2]**o+(-0.893816431641)*x[2]
        arg[3,0,2,0]=(0.269212290711)*x[0]**o+(-0.119897130167)*x[0]+(-0.937350065698)*x[1]**o+(0.913313769348)*x[1]+(0.311695335026)*x[2]**o+(0.58822688023)*x[2]
        arg[3,0,2,1]=(-0.445116541697)*x[0]**o+(-0.64630078598)*x[0]+(0.811173945666)*x[1]**o+(-0.910503175962)*x[1]+(0.160819266078)*x[2]**o+(-0.807050548571)*x[2]
        arg[3,1,0,0]=(0.25585673506)*x[0]**o+(-0.174293490388)*x[0]+(-0.510750951271)*x[1]**o+(-0.215780338673)*x[1]+(-0.531739311594)*x[2]**o+(0.479569840128)*x[2]
        arg[3,1,0,1]=(-0.159301665223)*x[0]**o+(0.88558738006)*x[0]+(-0.933255168276)*x[1]**o+(0.739621529924)*x[1]+(-0.371501556668)*x[2]**o+(-0.224043643673)*x[2]
        arg[3,1,1,0]=(0.673375237931)*x[0]**o+(0.29315421593)*x[0]+(0.378983835599)*x[1]**o+(-0.187220470447)*x[1]+(-0.122366431969)*x[2]**o+(-0.178182488821)*x[2]
        arg[3,1,1,1]=(0.273992606955)*x[0]**o+(-0.42302685869)*x[0]+(0.490650718142)*x[1]**o+(0.067822229282)*x[1]+(0.758676637186)*x[2]**o+(-0.840062442278)*x[2]
        arg[3,1,2,0]=(-0.533129977534)*x[0]**o+(0.743362501638)*x[0]+(0.0397932337285)*x[1]**o+(0.134261172942)*x[1]+(0.076467475088)*x[2]**o+(0.750124646154)*x[2]
        arg[3,1,2,1]=(0.977824314677)*x[0]**o+(0.322104772509)*x[0]+(0.478366489119)*x[1]**o+(0.139966919282)*x[1]+(0.823631645543)*x[2]**o+(0.29259439301)*x[2]
        arg[3,2,0,0]=(0.969349250234)*x[0]**o+(0.158604629065)*x[0]+(0.517280925739)*x[1]**o+(-0.32151445591)*x[1]+(0.516829269337)*x[2]**o+(0.935139450142)*x[2]
        arg[3,2,0,1]=(-0.673721580725)*x[0]**o+(0.1932869215)*x[0]+(0.47375679317)*x[1]**o+(0.377941367578)*x[1]+(-0.359306451576)*x[2]**o+(0.00498822119998)*x[2]
        arg[3,2,1,0]=(-0.432873699676)*x[0]**o+(0.191782167044)*x[0]+(0.191395777927)*x[1]**o+(-0.540088847941)*x[1]+(0.608451872364)*x[2]**o+(0.151589512705)*x[2]
        arg[3,2,1,1]=(0.633726614581)*x[0]**o+(-0.824133266602)*x[0]+(-0.380289061608)*x[1]**o+(-0.722136850408)*x[1]+(-0.807853184729)*x[2]**o+(0.152552828168)*x[2]
        arg[3,2,2,0]=(-0.182700878265)*x[0]**o+(0.105776705469)*x[0]+(0.837527799957)*x[1]**o+(0.120438395343)*x[1]+(-0.211142277471)*x[2]**o+(-0.0499206664041)*x[2]
        arg[3,2,2,1]=(0.999790796581)*x[0]**o+(0.523238189614)*x[0]+(0.108118557801)*x[1]**o+(-0.899694790145)*x[1]+(0.165089392648)*x[2]**o+(0.38599870475)*x[2]
        arg[3,3,0,0]=(-0.959143897162)*x[0]**o+(-0.968197835338)*x[0]+(-0.521866033091)*x[1]**o+(-0.560799919169)*x[1]+(0.604562365858)*x[2]**o+(0.195593261393)*x[2]
        arg[3,3,0,1]=(0.385513188376)*x[0]**o+(0.918485762628)*x[0]+(0.581126961809)*x[1]**o+(-0.365882492483)*x[1]+(-0.260563773993)*x[2]**o+(0.997016165521)*x[2]
        arg[3,3,1,0]=(0.809269330969)*x[0]**o+(0.472424328796)*x[0]+(-0.920680159926)*x[1]**o+(0.756205962059)*x[1]+(-0.886275742364)*x[2]**o+(-0.800132407145)*x[2]
        arg[3,3,1,1]=(-0.983474390608)*x[0]**o+(-0.436192301851)*x[0]+(0.653210945793)*x[1]**o+(-0.465357783291)*x[1]+(-0.799261076035)*x[2]**o+(-0.349990963152)*x[2]
        arg[3,3,2,0]=(0.710820041642)*x[0]**o+(-0.973768204693)*x[0]+(0.0408403957292)*x[1]**o+(0.61546181161)*x[1]+(0.915939389579)*x[2]**o+(0.634659938301)*x[2]
        arg[3,3,2,1]=(0.633364771689)*x[0]**o+(0.887553239682)*x[0]+(-0.64913373177)*x[1]**o+(0.557465560353)*x[1]+(-0.744072153243)*x[2]**o+(-0.301528624747)*x[2]
        arg[3,4,0,0]=(0.44039719913)*x[0]**o+(-0.0339525806656)*x[0]+(0.574166395893)*x[1]**o+(-0.810441051899)*x[1]+(0.254523432152)*x[2]**o+(-0.798403721953)*x[2]
        arg[3,4,0,1]=(0.253149910502)*x[0]**o+(-0.909846068796)*x[0]+(0.855107984234)*x[1]**o+(-0.973196168972)*x[1]+(0.646832394105)*x[2]**o+(0.811892995874)*x[2]
        arg[3,4,1,0]=(0.13027869782)*x[0]**o+(-0.424094152568)*x[0]+(-0.197473699021)*x[1]**o+(0.0795845331856)*x[1]+(-0.511301398362)*x[2]**o+(-0.331330168767)*x[2]
        arg[3,4,1,1]=(0.476554240918)*x[0]**o+(0.18800431479)*x[0]+(0.259031626216)*x[1]**o+(-0.0532533771273)*x[1]+(0.914847196458)*x[2]**o+(0.333851370508)*x[2]
        arg[3,4,2,0]=(0.800058524963)*x[0]**o+(-0.402028928896)*x[0]+(0.913881556051)*x[1]**o+(0.895516442873)*x[1]+(-0.0227700921994)*x[2]**o+(-0.0502319834692)*x[2]
        arg[3,4,2,1]=(-0.533834741079)*x[0]**o+(0.557954226232)*x[0]+(-0.121676666641)*x[1]**o+(0.781782385789)*x[1]+(0.0682870158781)*x[2]**o+(-0.236432552686)*x[2]
        ref[0,0,0,0]=(1.46703352572)/(o+1.)+(-1.33520045704)+(0.0737627367843)*0.5**o
        ref[0,0,0,1]=(0.213535197837)/(o+1.)+(-0.325019128805)+(0.353968533247)*0.5**o
        ref[0,0,1,0]=(-0.233213543591)/(o+1.)+(0.450075189439)+(0.315704665816)*0.5**o
        ref[0,0,1,1]=(0.809431837761)/(o+1.)+(0.642450689879)+(-0.453912049362)*0.5**o
        ref[0,0,2,0]=(1.8822564746)/(o+1.)+(-0.160827113662)+(0.705225432895)*0.5**o
        ref[0,0,2,1]=(-0.851077895823)/(o+1.)+(-0.032586006392)+(-0.397162258761)*0.5**o
        ref[0,1,0,0]=(-1.75021683351)/(o+1.)+(0.282579703111)+(0.00444300957662)*0.5**o
        ref[0,1,0,1]=(-1.61043513823)/(o+1.)+(0.209579442759)+(0.726535641072)*0.5**o
        ref[0,1,1,0]=(0.550951959927)/(o+1.)+(-0.453625179799)+(-0.554579794515)*0.5**o
        ref[0,1,1,1]=(-0.809122195368)/(o+1.)+(0.609569171964)+(0.294744137189)*0.5**o
        ref[0,1,2,0]=(1.3771144222)/(o+1.)+(-0.703069822248)+(-0.30261020867)*0.5**o
        ref[0,1,2,1]=(1.08629781546)/(o+1.)+(0.0271166180983)+(0.494855964972)*0.5**o
        ref[0,2,0,0]=(-1.26922850072)/(o+1.)+(0.72637380105)+(-0.914585215232)*0.5**o
        ref[0,2,0,1]=(-0.556637167762)/(o+1.)+(-0.036494329576)+(-0.260590397572)*0.5**o
        ref[0,2,1,0]=(0.707349561895)/(o+1.)+(0.208292082952)+(0.0455797513404)*0.5**o
        ref[0,2,1,1]=(-1.47922090453)/(o+1.)+(-0.621962103251)+(-0.300900136798)*0.5**o
        ref[0,2,2,0]=(0.01827281852)/(o+1.)+(-0.159177319679)+(0.745711773093)*0.5**o
        ref[0,2,2,1]=(1.09869785336)/(o+1.)+(0.352958766464)+(0.291340077334)*0.5**o
        ref[0,3,0,0]=(-0.802486910351)/(o+1.)+(0.741067349535)+(0.89242099254)*0.5**o
        ref[0,3,0,1]=(0.187447770797)/(o+1.)+(0.0211789816838)+(0.095390666498)*0.5**o
        ref[0,3,1,0]=(1.0518488657)/(o+1.)+(-0.0260861096315)+(-0.317750910722)*0.5**o
        ref[0,3,1,1]=(1.16078906983)/(o+1.)+(0.0263064747213)+(-0.204455448392)*0.5**o
        ref[0,3,2,0]=(-0.0986989221708)/(o+1.)+(0.182363177629)+(0.38581656579)*0.5**o
        ref[0,3,2,1]=(-0.388150366913)/(o+1.)+(0.557428570571)+(-0.225571343976)*0.5**o
        ref[0,4,0,0]=(-0.623448360222)/(o+1.)+(0.64524557416)+(0.834083057621)*0.5**o
        ref[0,4,0,1]=(-0.639580493935)/(o+1.)+(-0.380689110373)+(-0.613152578007)*0.5**o
        ref[0,4,1,0]=(-0.575892151257)/(o+1.)+(-0.142294010946)+(-0.373668614153)*0.5**o
        ref[0,4,1,1]=(-0.0316225271882)/(o+1.)+(-0.115844822465)+(0.00943802199128)*0.5**o
        ref[0,4,2,0]=(-0.902549384411)/(o+1.)+(0.210416030442)+(0.157099024354)*0.5**o
        ref[0,4,2,1]=(1.2254583864)/(o+1.)+(-0.371769146738)+(0.933762543076)*0.5**o
        ref[1,0,0,0]=(0.0440432191149)/(o+1.)+(-0.303248360069)+(0.0417476479889)*0.5**o
        ref[1,0,0,1]=(-0.196875527758)/(o+1.)+(-0.39869023332)+(0.450986977446)*0.5**o
        ref[1,0,1,0]=(-0.742874955412)/(o+1.)+(-0.677197937069)+(-0.23712795738)*0.5**o
        ref[1,0,1,1]=(0.385960155907)/(o+1.)+(0.0647632575546)+(-0.308721170682)*0.5**o
        ref[1,0,2,0]=(1.11246238908)/(o+1.)+(0.0111904605859)+(-0.267232319593)*0.5**o
        ref[1,0,2,1]=(0.0798238708014)/(o+1.)+(-0.355425426066)+(0.405254374432)*0.5**o
        ref[1,1,0,0]=(0.133162474633)/(o+1.)+(-0.863343187001)+(-0.877224972777)*0.5**o
        ref[1,1,0,1]=(1.23844759518)/(o+1.)+(0.871424091405)+(-0.873928172379)*0.5**o
        ref[1,1,1,0]=(-0.0275104699246)/(o+1.)+(-0.739054056468)+(0.552826305913)*0.5**o
        ref[1,1,1,1]=(0.948010887116)/(o+1.)+(-0.0503040657995)+(-0.71233607947)*0.5**o
        ref[1,1,2,0]=(1.01678266341)/(o+1.)+(-0.425240837237)+(-0.411667274338)*0.5**o
        ref[1,1,2,1]=(1.62045693811)/(o+1.)+(0.23057679995)+(0.533005373575)*0.5**o
        ref[1,2,0,0]=(0.44625545933)/(o+1.)+(0.0233472080645)+(-0.637366803484)*0.5**o
        ref[1,2,0,1]=(0.277223414052)/(o+1.)+(0.189254359042)+(-0.404870452835)*0.5**o
        ref[1,2,1,0]=(0.880141841398)/(o+1.)+(-0.750127627837)+(0.85574176569)*0.5**o
        ref[1,2,1,1]=(0.0718593507895)/(o+1.)+(0.306599537674)+(0.576825533647)*0.5**o
        ref[1,2,2,0]=(0.35649607288)/(o+1.)+(0.242884247745)+(0.741411326194)*0.5**o
        ref[1,2,2,1]=(1.14623459997)/(o+1.)+(-0.897591123484)+(0.386515069261)*0.5**o
        ref[1,3,0,0]=(-0.796578230199)/(o+1.)+(0.200648623687)+(0.848952965744)*0.5**o
        ref[1,3,0,1]=(0.679746997945)/(o+1.)+(-0.0297741837061)+(0.357870838328)*0.5**o
        ref[1,3,1,0]=(0.0713725201916)/(o+1.)+(0.223521474626)+(-0.509333127149)*0.5**o
        ref[1,3,1,1]=(-1.07672806067)/(o+1.)+(0.402304847309)+(-0.837885550386)*0.5**o
        ref[1,3,2,0]=(0.808945160636)/(o+1.)+(0.525847284807)+(0.205889276236)*0.5**o
        ref[1,3,2,1]=(0.440475889238)/(o+1.)+(0.353047235363)+(-0.331660060588)*0.5**o
        ref[1,4,0,0]=(0.733653130588)/(o+1.)+(-0.113784463751)+(0.394201404247)*0.5**o
        ref[1,4,0,1]=(0.892965597874)/(o+1.)+(0.359236861297)+(-0.346144268453)*0.5**o
        ref[1,4,1,0]=(0.512178276429)/(o+1.)+(0.0722586978563)+(-0.907566140749)*0.5**o
        ref[1,4,1,1]=(-1.21754003377)/(o+1.)+(0.369986403191)+(0.726194147182)*0.5**o
        ref[1,4,2,0]=(0.353974376932)/(o+1.)+(0.291102967642)+(-0.940824546553)*0.5**o
        ref[1,4,2,1]=(0.166197160477)/(o+1.)+(-0.358856317187)+(0.728499572603)*0.5**o
        ref[2,0,0,0]=(1.55742864501)/(o+1.)+(0.38703652972)+(0.467025642879)*0.5**o
        ref[2,0,0,1]=(-0.867288120579)/(o+1.)+(-0.995570381672)+(-0.211129222294)*0.5**o
        ref[2,0,1,0]=(0.0896432549354)/(o+1.)+(-0.894461032367)+(-0.668065295797)*0.5**o
        ref[2,0,1,1]=(-0.240985203598)/(o+1.)+(-0.407009494534)+(0.928751918298)*0.5**o
        ref[2,0,2,0]=(0.815866062908)/(o+1.)+(-0.281559110938)+(-0.531818105049)*0.5**o
        ref[2,0,2,1]=(0.0143868099026)/(o+1.)+(0.253341199154)+(0.0150988200159)*0.5**o
        ref[2,1,0,0]=(0.745834270286)/(o+1.)+(-0.630128050767)+(-0.0829154151121)*0.5**o
        ref[2,1,0,1]=(-0.513757920038)/(o+1.)+(-0.505622196077)+(-0.834502772339)*0.5**o
        ref[2,1,1,0]=(1.38226406947)/(o+1.)+(-0.763221422703)+(0.247439924718)*0.5**o
        ref[2,1,1,1]=(-0.408281199784)/(o+1.)+(-0.811328833758)+(-0.120169534728)*0.5**o
        ref[2,1,2,0]=(-0.586214858819)/(o+1.)+(0.11721515075)+(0.703841647274)*0.5**o
        ref[2,1,2,1]=(0.0812921429368)/(o+1.)+(-0.357151740094)+(-0.19760048131)*0.5**o
        ref[2,2,0,0]=(1.65849097715)/(o+1.)+(-0.777022017999)+(-0.507872937196)*0.5**o
        ref[2,2,0,1]=(0.242698257917)/(o+1.)+(1.08992054229)+(-0.481403986338)*0.5**o
        ref[2,2,1,0]=(-0.754639453272)/(o+1.)+(0.81286785715)+(0.241675645258)*0.5**o
        ref[2,2,1,1]=(-0.438727562295)/(o+1.)+(0.217076971211)+(0.114772627763)*0.5**o
        ref[2,2,2,0]=(0.683917726753)/(o+1.)+(-0.781863136791)+(0.887023209688)*0.5**o
        ref[2,2,2,1]=(1.19838469898)/(o+1.)+(0.729462151403)+(0.836731324893)*0.5**o
        ref[2,3,0,0]=(1.28206834695)/(o+1.)+(0.583576731084)+(0.196161020545)*0.5**o
        ref[2,3,0,1]=(0.395309853285)/(o+1.)+(0.573307319258)+(-0.862326385376)*0.5**o
        ref[2,3,1,0]=(1.34760990633)/(o+1.)+(0.348652101929)+(0.571263839862)*0.5**o
        ref[2,3,1,1]=(0.293682752388)/(o+1.)+(0.080258501461)+(0.272559456412)*0.5**o
        ref[2,3,2,0]=(-1.47056068107)/(o+1.)+(-0.237909711446)+(0.3409363126)*0.5**o
        ref[2,3,2,1]=(-0.356052894952)/(o+1.)+(-0.166196236302)+(0.949170673623)*0.5**o
        ref[2,4,0,0]=(-0.21887693849)/(o+1.)+(0.365445238731)+(0.876774885889)*0.5**o
        ref[2,4,0,1]=(0.824663735425)/(o+1.)+(-0.568245545547)+(0.347441329383)*0.5**o
        ref[2,4,1,0]=(-1.22807417581)/(o+1.)+(-0.0380844812022)+(0.732123350436)*0.5**o
        ref[2,4,1,1]=(0.45997712447)/(o+1.)+(0.181215330541)+(-0.128872747083)*0.5**o
        ref[2,4,2,0]=(0.282057449847)/(o+1.)+(0.49247247384)+(0.619034818105)*0.5**o
        ref[2,4,2,1]=(0.0852215499679)/(o+1.)+(0.0807247245641)+(0.645979236759)*0.5**o
        ref[3,0,0,0]=(-0.173183992256)/(o+1.)+(0.215110333109)+(-0.265836015694)*0.5**o
        ref[3,0,0,1]=(0.88174458564)/(o+1.)+(0.282289419133)+(0.306246512933)*0.5**o
        ref[3,0,1,0]=(-0.542918101609)/(o+1.)+(0.791816447658)+(0.509420593773)*0.5**o
        ref[3,0,1,1]=(0.585362427423)/(o+1.)+(-0.229639545331)+(-0.609626065482)*0.5**o
        ref[3,0,2,0]=(-0.625654730672)/(o+1.)+(0.690821759706)+(0.269212290711)*0.5**o
        ref[3,0,2,1]=(0.971993211744)/(o+1.)+(-1.18192725526)+(-0.445116541697)*0.5**o
        ref[3,1,0,0]=(-1.04249026287)/(o+1.)+(0.0447480055334)+(0.25585673506)*0.5**o
        ref[3,1,0,1]=(-1.30475672494)/(o+1.)+(0.700582633156)+(-0.159301665223)*0.5**o
        ref[3,1,1,0]=(0.25661740363)/(o+1.)+(-0.036124371669)+(0.673375237931)*0.5**o
        ref[3,1,1,1]=(1.24932735533)/(o+1.)+(-0.597633535843)+(0.273992606955)*0.5**o
        ref[3,1,2,0]=(0.116260708817)/(o+1.)+(0.813874160367)+(-0.533129977534)*0.5**o
        ref[3,1,2,1]=(1.30199813466)/(o+1.)+(0.377333042401)+(0.977824314677)*0.5**o
        ref[3,2,0,0]=(1.03411019508)/(o+1.)+(0.386114811649)+(0.969349250234)*0.5**o
        ref[3,2,0,1]=(0.114450341594)/(o+1.)+(0.288108255139)+(-0.673721580725)*0.5**o
        ref[3,2,1,0]=(0.799847650292)/(o+1.)+(-0.0983585840958)+(-0.432873699676)*0.5**o
        ref[3,2,1,1]=(-1.18814224634)/(o+1.)+(-0.696858644421)+(0.633726614581)*0.5**o
        ref[3,2,2,0]=(0.626385522485)/(o+1.)+(0.0881472172038)+(-0.182700878265)*0.5**o
        ref[3,2,2,1]=(0.27320795045)/(o+1.)+(0.0047710521094)+(0.999790796581)*0.5**o
        ref[3,3,0,0]=(0.0826963327674)/(o+1.)+(-0.666702246557)+(-0.959143897162)*0.5**o
        ref[3,3,0,1]=(0.320563187816)/(o+1.)+(0.774809717833)+(0.385513188376)*0.5**o
        ref[3,3,1,0]=(-1.80695590229)/(o+1.)+(0.214248941855)+(0.809269330969)*0.5**o
        ref[3,3,1,1]=(-0.146050130242)/(o+1.)+(-0.625770524147)+(-0.983474390608)*0.5**o
        ref[3,3,2,0]=(0.956779785308)/(o+1.)+(0.138176772609)+(0.710820041642)*0.5**o
        ref[3,3,2,1]=(-1.39320588501)/(o+1.)+(0.571745087644)+(0.633364771689)*0.5**o
        ref[3,4,0,0]=(0.828689828045)/(o+1.)+(-0.821398677259)+(0.44039719913)*0.5**o
        ref[3,4,0,1]=(1.50194037834)/(o+1.)+(-0.535574620947)+(0.253149910502)*0.5**o
        ref[3,4,1,0]=(-0.708775097383)/(o+1.)+(-0.337919894074)+(0.13027869782)*0.5**o
        ref[3,4,1,1]=(1.17387882267)/(o+1.)+(0.234301154085)+(0.476554240918)*0.5**o
        ref[3,4,2,0]=(0.891111463851)/(o+1.)+(0.221627765254)+(0.800058524963)*0.5**o
        ref[3,4,2,1]=(-0.0533896507631)/(o+1.)+(0.551652029667)+(-0.533834741079)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.570707549273)*x[0]+(-0.726264032186)*x[1]
        ref=(-0.0423765208873)/(o+1.)+(-0.791542656673)+(0.328490252775)*0.5**o
      else:
        arg=(1.28222892931)*x[0]+(-0.798170675576)*x[1]+(1.5701208405)*x[2]
        ref=(0.721975372868)/(o+1.)+(0.344720905832)+(0.642761909705)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.575166906798)*x[0]+(-1.63698773418)*x[1]
        arg[1]=(-0.0535946584636)*x[0]+(0.105969101775)*x[1]
        ref[0]=(-0.751926426344)/(o+1.)+(-0.395800138888)+(0.481705876734)*0.5**o
        ref[1]=(0.698496252242)/(o+1.)+(-0.265927161866)+(-0.114267485199)*0.5**o
      else:
        arg[0]=(-0.17879254138)*x[0]+(-1.12752123792)*x[1]+(0.921297311605)*x[2]
        arg[1]=(1.33131824618)*x[0]+(-0.392175059176)*x[1]+(0.545754281465)*x[2]
        ref[0]=(-0.494870303061)/(o+1.)+(0.0697636237654)+(-0.0296734121631)*0.5**o
        ref[1]=(-0.394300983704)/(o+1.)+(0.722261312754)+(0.434675826665)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.338658191734)*x[0]+(1.46127609683)*x[1]
        arg[0,1]=(-0.629116867491)*x[0]+(1.40141569066)*x[1]
        arg[0,2]=(0.105569779347)*x[0]+(0.239936324967)*x[1]
        arg[0,3]=(-0.281718331718)*x[0]+(0.280323404866)*x[1]
        arg[0,4]=(0.467341113661)*x[0]+(-0.50452062075)*x[1]
        arg[1,0]=(-0.841295219186)*x[0]+(0.524038163723)*x[1]
        arg[1,1]=(1.40143704236)*x[0]+(-1.50467961637)*x[1]
        arg[1,2]=(1.21078790505)*x[0]+(-0.731453470292)*x[1]
        arg[1,3]=(0.469556922076)*x[0]+(0.0686293204391)*x[1]
        arg[1,4]=(-1.26394637585)*x[0]+(-0.0361395276585)*x[1]
        arg[2,0]=(-1.12850883148)*x[0]+(0.284296673326)*x[1]
        arg[2,1]=(-0.626362828813)*x[0]+(1.19459827573)*x[1]
        arg[2,2]=(-0.545457293083)*x[0]+(1.547337019)*x[1]
        arg[2,3]=(0.664461986629)*x[0]+(-1.69082198266)*x[1]
        arg[2,4]=(-0.100004763305)*x[0]+(0.152159044423)*x[1]
        arg[3,0]=(0.307574843061)*x[0]+(1.20209181301)*x[1]
        arg[3,1]=(-0.0663203356627)*x[0]+(-1.26669863527)*x[1]
        arg[3,2]=(-1.20436798894)*x[0]+(-0.0375693379661)*x[1]
        arg[3,3]=(0.753649087747)*x[0]+(0.69376223486)*x[1]
        arg[3,4]=(-0.0512732264834)*x[0]+(-0.658097606436)*x[1]
        ref[0,0]=(0.996821439952)/(o+1.)+(0.015088160779)+(0.0956201435879)*0.5**o
        ref[0,1]=(0.643092963726)/(o+1.)+(0.239390724844)+(-0.349575590244)*0.5**o
        ref[0,2]=(-0.198468008977)/(o+1.)+(0.00411201743342)+(0.535750078425)*0.5**o
        ref[0,3]=(0.642491201137)/(o+1.)+(-0.623413199652)+(0.602940271315)*0.5**o
        ref[0,4]=(-0.105706120549)/(o+1.)+(-0.353560054939)+(0.775646723338)*0.5**o
        ref[1,0]=(0.144540669221)/(o+1.)+(0.0228268215803)+(-0.507451367845)*0.5**o
        ref[1,1]=(-0.820379339897)/(o+1.)+(0.0951825678509)+(0.526771630185)*0.5**o
        ref[1,2]=(-0.21214585824)/(o+1.)+(-0.0889183062985)+(0.869316905591)*0.5**o
        ref[1,3]=(0.291228940674)/(o+1.)+(0.192623928703)+(-0.138290555565)*0.5**o
        ref[1,4]=(-0.0663718956434)/(o+1.)+(-0.309484335614)+(-0.614745336642)*0.5**o
        ref[2,0]=(0.484892962201)/(o+1.)+(-0.367129859793)+(-0.594845400763)*0.5**o
        ref[2,1]=(0.768457634672)/(o+1.)+(0.154447657562)+(-0.509117502876)*0.5**o
        ref[2,2]=(0.707320338363)/(o+1.)+(-0.0592149232183)+(0.412989233992)*0.5**o
        ref[2,3]=(-0.983684339171)/(o+1.)+(-0.495377645598)+(0.948079634337)*0.5**o
        ref[2,4]=(-0.0315947220465)/(o+1.)+(0.506833986759)+(-0.929918970353)*0.5**o
        ref[3,0]=(0.54141067098)/(o+1.)+(0.489049131493)+(-0.00984227789859)*0.5**o
        ref[3,1]=(-0.552335053051)/(o+1.)+(-0.383325638803)+(-0.0140326402734)*0.5**o
        ref[3,2]=(0.0821472412575)/(o+1.)+(-0.335827719718)+(-0.652429128733)*0.5**o
        ref[3,3]=(0.112917208924)/(o+1.)+(0.667772807338)+(-0.00105150099312)*0.5**o
        ref[3,4]=(-0.19331508157)/(o+1.)+(-0.102296385708)+(-0.311462979932)*0.5**o
      else:
        arg[0,0]=(0.069245963142)*x[0]+(-0.185727379494)*x[1]+(-0.887410889699)*x[2]
        arg[0,1]=(-0.816745668949)*x[0]+(-0.250435680662)*x[1]+(0.701607830582)*x[2]
        arg[0,2]=(-0.862433954308)*x[0]+(0.731874372527)*x[1]+(-0.115384982779)*x[2]
        arg[0,3]=(-0.265247631604)*x[0]+(-0.157059741958)*x[1]+(-0.368419335078)*x[2]
        arg[0,4]=(1.66720203567)*x[0]+(-0.759393708719)*x[1]+(1.36360850704)*x[2]
        arg[1,0]=(-0.192822813795)*x[0]+(0.0358776152527)*x[1]+(-0.722864520788)*x[2]
        arg[1,1]=(-0.480606215471)*x[0]+(1.13682774573)*x[1]+(0.17900467623)*x[2]
        arg[1,2]=(0.346760852584)*x[0]+(0.994833030281)*x[1]+(0.507055933913)*x[2]
        arg[1,3]=(-0.509961853478)*x[0]+(-0.852997575505)*x[1]+(0.586527030253)*x[2]
        arg[1,4]=(0.93957975846)*x[0]+(0.28878335152)*x[1]+(0.128070931738)*x[2]
        arg[2,0]=(0.338283306313)*x[0]+(0.0244500761608)*x[1]+(-0.606875554888)*x[2]
        arg[2,1]=(0.850782624552)*x[0]+(-0.836382038189)*x[1]+(-1.41808459947)*x[2]
        arg[2,2]=(-1.06176229613)*x[0]+(-0.259247046061)*x[1]+(-0.583455484089)*x[2]
        arg[2,3]=(1.17437923282)*x[0]+(1.31485601495)*x[1]+(1.3139743231)*x[2]
        arg[2,4]=(0.362851636275)*x[0]+(0.804049783156)*x[1]+(1.09205000214)*x[2]
        arg[3,0]=(0.343603837195)*x[0]+(-1.49082257981)*x[1]+(-0.628668674545)*x[2]
        arg[3,1]=(-0.676847711765)*x[0]+(1.32350560453)*x[1]+(1.07275185686)*x[2]
        arg[3,2]=(0.570784985469)*x[0]+(-1.01212360602)*x[1]+(-0.0808776667606)*x[2]
        arg[3,3]=(0.506392444236)*x[0]+(-1.00848318041)*x[1]+(0.558777901541)*x[2]
        arg[3,4]=(-0.60925738291)*x[0]+(-0.386755957809)*x[1]+(0.60930115434)*x[2]
        ref[0,0]=(-0.695230136419)/(o+1.)+(-0.388400729083)+(0.468139288533)*0.5**o
        ref[0,1]=(0.462098132187)/(o+1.)+(-0.215041893287)+(-0.397587864642)*0.5**o
        ref[0,2]=(-0.262411385363)/(o+1.)+(0.275729226874)+(-0.534991632946)*0.5**o
        ref[0,3]=(0.117822633378)/(o+1.)+(0.0286827897592)+(-0.965914921536)*0.5**o
        ref[0,4]=(0.293575681039)/(o+1.)+(0.584039692827)+(0.809761767299)*0.5**o
        ref[1,0]=(0.627951922463)/(o+1.)+(-0.994889162557)+(0.482016683321)*0.5**o
        ref[1,1]=(1.83482238662)/(o+1.)+(-0.205719558739)+(-0.588157062647)*0.5**o
        ref[1,2]=(1.13612020398)/(o+1.)+(0.0262824938134)+(0.659964625174)*0.5**o
        ref[1,3]=(0.325264487741)/(o+1.)+(-0.0752154813413)+(-0.951265923787)*0.5**o
        ref[1,4]=(-0.149919283302)/(o+1.)+(0.77701502585)+(-0.0476767266789)*0.5**o
        ref[2,0]=(0.491504686171)/(o+1.)+(-0.562534706926)+(0.389422555265)*0.5**o
        ref[2,1]=(-1.52704217417)/(o+1.)+(0.120525042098)+(-0.117691923134)*0.5**o
        ref[2,2]=(-0.779796772543)/(o+1.)+(-0.318864997267)+(-0.486938059201)*0.5**o
        ref[2,3]=(1.53343318682)/(o+1.)+(0.731149467308)+(0.807477449443)*0.5**o
        ref[2,4]=(1.15919207694)/(o+1.)+(0.113921448815)+(0.871916446996)*0.5**o
        ref[3,0]=(-1.75312920944)/(o+1.)+(-0.153798982308)+(0.284839756895)*0.5**o
        ref[3,1]=(1.30985814569)/(o+1.)+(0.438430874237)+(-0.467310144534)*0.5**o
        ref[3,2]=(-0.737480320972)/(o+1.)+(0.0604403094397)+(0.094383414777)*0.5**o
        ref[3,3]=(-0.688723266524)/(o+1.)+(0.43486027018)+(-0.124310108473)*0.5**o
        ref[3,4]=(0.128399262674)/(o+1.)+(-0.372445844122)+(0.229780239192)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.993339371954)*x[0]+(-1.35308128985)*x[1]
        arg[0,0,1]=(-1.07886149134)*x[0]+(-1.38999283206)*x[1]
        arg[0,1,0]=(0.246468026972)*x[0]+(-1.37217464882)*x[1]
        arg[0,1,1]=(0.645672648599)*x[0]+(1.8070624103)*x[1]
        arg[1,0,0]=(-1.02278989388)*x[0]+(0.151634023103)*x[1]
        arg[1,0,1]=(-0.667332860541)*x[0]+(0.312742149193)*x[1]
        arg[1,1,0]=(-0.848647385832)*x[0]+(0.466438038516)*x[1]
        arg[1,1,1]=(-0.185495911372)*x[0]+(-0.137118786891)*x[1]
        arg[2,0,0]=(-0.0250555870731)*x[0]+(0.905553573283)*x[1]
        arg[2,0,1]=(-1.03940852939)*x[0]+(-1.57326016394)*x[1]
        arg[2,1,0]=(1.48834718811)*x[0]+(-0.340889253246)*x[1]
        arg[2,1,1]=(0.875721514739)*x[0]+(-0.310857412212)*x[1]
        arg[3,0,0]=(1.25129508831)*x[0]+(-1.69312043525)*x[1]
        arg[3,0,1]=(1.50124675312)*x[0]+(0.244195748654)*x[1]
        arg[3,1,0]=(0.292060478909)*x[0]+(-0.660005422696)*x[1]
        arg[3,1,1]=(0.791335231308)*x[0]+(0.466481573591)*x[1]
        arg[4,0,0]=(-0.361241947236)*x[0]+(-1.43591648587)*x[1]
        arg[4,0,1]=(-1.10385456695)*x[0]+(-0.325314195825)*x[1]
        arg[4,1,0]=(1.01004173033)*x[0]+(0.426824552857)*x[1]
        arg[4,1,1]=(-0.631382479612)*x[0]+(0.0603792190966)*x[1]
        arg[5,0,0]=(-0.30404368786)*x[0]+(-0.0102498522932)*x[1]
        arg[5,0,1]=(0.109188848746)*x[0]+(-1.16846160105)*x[1]
        arg[5,1,0]=(-0.351916879547)*x[0]+(-0.320714795448)*x[1]
        arg[5,1,1]=(-0.534138562652)*x[0]+(-0.256013589844)*x[1]
        ref[0,0,0]=(-0.506159375456)/(o+1.)+(-0.522895228783)+(-0.794470828783)*0.5**o
        ref[0,0,1]=(-0.930984367068)/(o+1.)+(-0.636851258685)+(-0.264167438968)*0.5**o
        ref[0,1,0]=(-0.674222792172)/(o+1.)+(-0.52131379048)+(0.591143751282)*0.5**o
        ref[0,1,1]=(0.953370751283)/(o+1.)+(0.377773224645)+(0.743817858326)*0.5**o
        ref[1,0,0]=(0.700508215428)/(o+1.)+(-0.303343530867)+(-0.964977024471)*0.5**o
        ref[1,0,1]=(-0.408185116452)/(o+1.)+(0.0668983569743)+(-0.0802023088445)*0.5**o
        ref[1,1,0]=(0.80742345527)/(o+1.)+(-0.405780705683)+(-0.37807139122)*0.5**o
        ref[1,1,1]=(0.0184615568095)/(o+1.)+(0.221921562266)+(-0.784919379605)*0.5**o
        ref[2,0,0]=(0.571906256883)/(o+1.)+(-0.0415588382133)+(0.391709405753)*0.5**o
        ref[2,0,1]=(-0.778176009451)/(o+1.)+(-0.761680990566)+(-0.311130702752)*0.5**o
        ref[2,1,0]=(0.498214686321)/(o+1.)+(-0.146173705483)+(0.941590659509)*0.5**o
        ref[2,1,1]=(-0.273747071818)/(o+1.)+(-0.0319184747153)+(0.902448123776)*0.5**o
        ref[3,0,0]=(-0.730029471178)/(o+1.)+(-0.288672747933)+(0.865549620109)*0.5**o
        ref[3,0,1]=(-0.371409186475)/(o+1.)+(0.623169375401)+(0.870512937445)*0.5**o
        ref[3,1,0]=(0.0611454391867)/(o+1.)+(-0.627723874214)+(0.826357365454)*0.5**o
        ref[3,1,1]=(0.785553447935)/(o+1.)+(0.246940213405)+(-0.021617069845)*0.5**o
        ref[4,0,0]=(-0.936201955907)/(o+1.)+(-0.484823720021)+(0.108690962842)*0.5**o
        ref[4,0,1]=(-0.277830390815)/(o+1.)+(-0.151786547071)+(-0.847765277819)*0.5**o
        ref[4,1,0]=(0.12293099533)/(o+1.)+(0.295620382054)+(0.722694523749)*0.5**o
        ref[4,1,1]=(-0.5517019185)/(o+1.)+(0.0850748937088)+(-0.189451129433)*0.5**o
        ref[5,0,0]=(-0.942533148805)/(o+1.)+(0.425680504872)+(-0.223121401092)*0.5**o
        ref[5,0,1]=(-0.377134228332)/(o+1.)+(-0.721019409569)+(0.759900295162)*0.5**o
        ref[5,1,0]=(-0.643828391942)/(o+1.)+(0.399974456311)+(-0.828752195674)*0.5**o
        ref[5,1,1]=(-0.118293731439)/(o+1.)+(-0.355568544431)+(0.0392786678054)*0.5**o
      else:
        arg[0,0,0]=(0.205446621454)*x[0]+(0.10254878667)*x[1]+(1.27673728979)*x[2]
        arg[0,0,1]=(0.758846313193)*x[0]+(0.63320336713)*x[1]+(-0.42638505807)*x[2]
        arg[0,1,0]=(-0.0127116561603)*x[0]+(-0.360359420027)*x[1]+(0.540508591493)*x[2]
        arg[0,1,1]=(-0.278918629538)*x[0]+(-0.0291534835772)*x[1]+(0.708655731565)*x[2]
        arg[1,0,0]=(-0.612965210483)*x[0]+(0.787787556912)*x[1]+(0.222384448462)*x[2]
        arg[1,0,1]=(1.07409083742)*x[0]+(1.19429173706)*x[1]+(-0.484979976779)*x[2]
        arg[1,1,0]=(-1.25714999157)*x[0]+(-0.321346019622)*x[1]+(0.278329320837)*x[2]
        arg[1,1,1]=(-0.512262689707)*x[0]+(1.6891992053)*x[1]+(-1.02351830068)*x[2]
        arg[2,0,0]=(-1.57911907773)*x[0]+(0.096124258122)*x[1]+(0.336619253521)*x[2]
        arg[2,0,1]=(0.0901144254199)*x[0]+(-1.36818186255)*x[1]+(1.2969609239)*x[2]
        arg[2,1,0]=(0.158329511499)*x[0]+(0.696997185217)*x[1]+(-0.400535235927)*x[2]
        arg[2,1,1]=(-1.44570853201)*x[0]+(0.237359587195)*x[1]+(-1.17323024801)*x[2]
        arg[3,0,0]=(-1.4325812824)*x[0]+(-0.733085265902)*x[1]+(0.125883186484)*x[2]
        arg[3,0,1]=(-0.0529889021435)*x[0]+(0.335154600942)*x[1]+(0.839337375209)*x[2]
        arg[3,1,0]=(-0.423552182963)*x[0]+(1.31813289315)*x[1]+(0.13235854915)*x[2]
        arg[3,1,1]=(0.53278572217)*x[0]+(0.159434073071)*x[1]+(-0.313621199136)*x[2]
        arg[4,0,0]=(0.747779887673)*x[0]+(0.30977483911)*x[1]+(-0.0760295896739)*x[2]
        arg[4,0,1]=(0.00295118909194)*x[0]+(-0.687914867842)*x[1]+(0.0386268422915)*x[2]
        arg[4,1,0]=(-0.276363532754)*x[0]+(0.52102466785)*x[1]+(-0.684840191917)*x[2]
        arg[4,1,1]=(0.0283138898538)*x[0]+(0.116042458294)*x[1]+(0.485578401528)*x[2]
        arg[5,0,0]=(-0.118402060192)*x[0]+(-1.18409809944)*x[1]+(-0.304048852342)*x[2]
        arg[5,0,1]=(0.174393790186)*x[0]+(-0.524912689263)*x[1]+(-0.648708392355)*x[2]
        arg[5,1,0]=(-0.254958756344)*x[0]+(-0.772071348728)*x[1]+(-0.0572494064027)*x[2]
        arg[5,1,1]=(-0.74777072018)*x[0]+(0.19109939364)*x[1]+(0.498973987814)*x[2]
        ref[0,0,0]=(0.986457444152)/(o+1.)+(0.258994989412)+(0.0802852749346)*0.5**o
        ref[0,0,1]=(-0.0286717143415)/(o+1.)+(0.554867138611)+(-0.115397940627)*0.5**o
        ref[0,1,0]=(-0.886482131138)/(o+1.)+(0.464293129749)+(0.125333386946)*0.5**o
        ref[0,1,1]=(0.199214164457)/(o+1.)+(0.336882900218)+(-0.472396346443)*0.5**o
        ref[1,0,0]=(0.36021680954)/(o+1.)+(0.408903924703)+(-0.780817864055)*0.5**o
        ref[1,0,1]=(0.44795581074)/(o+1.)+(0.472159267742)+(0.391128251477)*0.5**o
        ref[1,1,0]=(1.02665734893)/(o+1.)+(-0.71418625728)+(-0.898451524719)*0.5**o
        ref[1,1,1]=(0.0322676607777)/(o+1.)+(0.105378958385)+(-0.0896073626306)*0.5**o
        ref[2,0,0]=(1.15723247637)/(o+1.)+(-0.719604538702)+(-0.86439896505)*0.5**o
        ref[2,0,1]=(-0.254100181576)/(o+1.)+(-0.0387997401585)+(0.35059314866)*0.5**o
        ref[2,1,0]=(-0.636439167982)/(o+1.)+(0.563390681981)+(-0.0355507351918)*0.5**o
        ref[2,1,1]=(-0.265265225142)/(o+1.)+(-0.635620798949)+(-0.845072369786)*0.5**o
        ref[3,0,0]=(-0.062162800164)/(o+1.)+(-0.554499928282)+(-0.868620705087)*0.5**o
        ref[3,0,1]=(0.784681961813)/(o+1.)+(0.355202655131)+(-0.373584198067)*0.5**o
        ref[3,1,0]=(1.20272043429)/(o+1.)+(0.352677694103)+(-0.881136563162)*0.5**o
        ref[3,1,1]=(-0.311152797156)/(o+1.)+(0.313736563953)+(0.0622782653549)*0.5**o
        ref[4,0,0]=(-0.365517620238)/(o+1.)+(0.733502174253)+(-0.119961591158)*0.5**o
        ref[4,0,1]=(0.0155845896619)/(o+1.)+(-0.654963543839)+(0.648005661558)*0.5**o
        ref[4,1,0]=(0.405697975915)/(o+1.)+(-0.637805133954)+(0.429733235172)*0.5**o
        ref[4,1,1]=(-0.0469738326054)/(o+1.)+(0.0590721074184)+(0.558764367445)*0.5**o
        ref[5,0,0]=(-0.333825007954)/(o+1.)+(-0.46448520882)+(-0.343753586377)*0.5**o
        ref[5,0,1]=(-0.469125954795)/(o+1.)+(-0.147192309255)+(-0.235716718127)*0.5**o
        ref[5,1,0]=(-0.573275891777)/(o+1.)+(-0.478328163121)+(0.445652706545)*0.5**o
        ref[5,1,1]=(0.0545515234726)/(o+1.)+(-0.153919681346)+(0.195590500493)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.226142137728)*x[0]+(0.85681895183)*x[1]
        arg[0,0,0,1]=(-0.824407181762)*x[0]+(-0.290023144892)*x[1]
        arg[0,0,1,0]=(-1.25987816017)*x[0]+(0.824340990595)*x[1]
        arg[0,0,1,1]=(-0.0917811606765)*x[0]+(0.660211932964)*x[1]
        arg[0,0,2,0]=(-1.31073149178)*x[0]+(0.482324984918)*x[1]
        arg[0,0,2,1]=(0.256995458227)*x[0]+(0.79244254852)*x[1]
        arg[0,1,0,0]=(-0.0682147475407)*x[0]+(0.243620052061)*x[1]
        arg[0,1,0,1]=(0.071099982687)*x[0]+(-0.62986754897)*x[1]
        arg[0,1,1,0]=(-0.0716793733131)*x[0]+(-1.15235525814)*x[1]
        arg[0,1,1,1]=(0.193107575216)*x[0]+(-0.596149957543)*x[1]
        arg[0,1,2,0]=(-0.160142629886)*x[0]+(1.36581707067)*x[1]
        arg[0,1,2,1]=(-1.21477648376)*x[0]+(-0.732000298369)*x[1]
        arg[0,2,0,0]=(-1.02468971059)*x[0]+(0.330721595217)*x[1]
        arg[0,2,0,1]=(1.11414907391)*x[0]+(1.29386127812)*x[1]
        arg[0,2,1,0]=(1.1485850154)*x[0]+(0.387585977495)*x[1]
        arg[0,2,1,1]=(0.237382583072)*x[0]+(1.56248221279)*x[1]
        arg[0,2,2,0]=(-0.949129049229)*x[0]+(0.578823379063)*x[1]
        arg[0,2,2,1]=(-1.0667182537)*x[0]+(0.462227485959)*x[1]
        arg[0,3,0,0]=(1.37954377554)*x[0]+(0.541856880139)*x[1]
        arg[0,3,0,1]=(0.401584700319)*x[0]+(0.577102327147)*x[1]
        arg[0,3,1,0]=(-0.289796408108)*x[0]+(0.807853785325)*x[1]
        arg[0,3,1,1]=(0.0038467861822)*x[0]+(-0.931311510771)*x[1]
        arg[0,3,2,0]=(0.859036254821)*x[0]+(0.198884218516)*x[1]
        arg[0,3,2,1]=(-0.00310256070968)*x[0]+(0.511838475968)*x[1]
        arg[0,4,0,0]=(0.539686886802)*x[0]+(-0.324612924267)*x[1]
        arg[0,4,0,1]=(-0.0458655898565)*x[0]+(0.211810380966)*x[1]
        arg[0,4,1,0]=(0.302333533003)*x[0]+(0.0663033316831)*x[1]
        arg[0,4,1,1]=(-0.981519161639)*x[0]+(-0.00207756909914)*x[1]
        arg[0,4,2,0]=(0.283659447004)*x[0]+(-0.231526592979)*x[1]
        arg[0,4,2,1]=(-1.17679167875)*x[0]+(0.285698985756)*x[1]
        arg[1,0,0,0]=(-0.162900059582)*x[0]+(-0.877164340783)*x[1]
        arg[1,0,0,1]=(-0.50468605065)*x[0]+(-0.160440073709)*x[1]
        arg[1,0,1,0]=(-0.100901676644)*x[0]+(-0.296111526029)*x[1]
        arg[1,0,1,1]=(0.176107421869)*x[0]+(1.74393708745)*x[1]
        arg[1,0,2,0]=(-0.979807721703)*x[0]+(-0.229400841067)*x[1]
        arg[1,0,2,1]=(0.217472795645)*x[0]+(0.0881503243323)*x[1]
        arg[1,1,0,0]=(-0.127980123625)*x[0]+(0.0932095456541)*x[1]
        arg[1,1,0,1]=(0.829674410931)*x[0]+(-0.796196041601)*x[1]
        arg[1,1,1,0]=(1.28656110233)*x[0]+(-1.27850471392)*x[1]
        arg[1,1,1,1]=(1.159269884)*x[0]+(-0.973135433631)*x[1]
        arg[1,1,2,0]=(1.46274837856)*x[0]+(-1.81554270863)*x[1]
        arg[1,1,2,1]=(0.0973472511688)*x[0]+(0.551451261495)*x[1]
        arg[1,2,0,0]=(0.510667671293)*x[0]+(-0.51075982099)*x[1]
        arg[1,2,0,1]=(-1.41612093451)*x[0]+(0.614417669629)*x[1]
        arg[1,2,1,0]=(1.46595125796)*x[0]+(0.60374279122)*x[1]
        arg[1,2,1,1]=(-0.317185218187)*x[0]+(-0.0785532882696)*x[1]
        arg[1,2,2,0]=(-0.388504041993)*x[0]+(-0.838003398775)*x[1]
        arg[1,2,2,1]=(0.0497207129012)*x[0]+(-0.622155692247)*x[1]
        arg[1,3,0,0]=(-0.0471400179563)*x[0]+(1.3378948207)*x[1]
        arg[1,3,0,1]=(-1.22250822195)*x[0]+(0.629714783138)*x[1]
        arg[1,3,1,0]=(-1.28801080408)*x[0]+(-1.54079710038)*x[1]
        arg[1,3,1,1]=(-0.426412448469)*x[0]+(-1.09410474021)*x[1]
        arg[1,3,2,0]=(0.022834167351)*x[0]+(-0.497423389788)*x[1]
        arg[1,3,2,1]=(-0.787492124301)*x[0]+(-0.245621168419)*x[1]
        arg[1,4,0,0]=(-1.37814880919)*x[0]+(-0.704805848451)*x[1]
        arg[1,4,0,1]=(-1.12494770055)*x[0]+(1.44920024305)*x[1]
        arg[1,4,1,0]=(-0.809532572761)*x[0]+(1.16638587657)*x[1]
        arg[1,4,1,1]=(0.931784486816)*x[0]+(1.34629889453)*x[1]
        arg[1,4,2,0]=(-0.172430942793)*x[0]+(-0.584736998321)*x[1]
        arg[1,4,2,1]=(0.00542948736389)*x[0]+(0.43917597284)*x[1]
        arg[2,0,0,0]=(-0.946122337406)*x[0]+(-0.161940168137)*x[1]
        arg[2,0,0,1]=(-0.7856653779)*x[0]+(-0.75287701788)*x[1]
        arg[2,0,1,0]=(-1.08858367592)*x[0]+(-0.530380818694)*x[1]
        arg[2,0,1,1]=(-1.0573555095)*x[0]+(-0.854148765785)*x[1]
        arg[2,0,2,0]=(0.723412825328)*x[0]+(0.326761950437)*x[1]
        arg[2,0,2,1]=(-0.0143142161225)*x[0]+(-0.752724311876)*x[1]
        arg[2,1,0,0]=(-0.942548092355)*x[0]+(0.700861094897)*x[1]
        arg[2,1,0,1]=(-0.712286567957)*x[0]+(0.230406545738)*x[1]
        arg[2,1,1,0]=(1.27414839774)*x[0]+(0.724784649037)*x[1]
        arg[2,1,1,1]=(0.637494163002)*x[0]+(0.442489599192)*x[1]
        arg[2,1,2,0]=(1.81617631726)*x[0]+(1.56870218809)*x[1]
        arg[2,1,2,1]=(1.16419900666)*x[0]+(-0.044314729141)*x[1]
        arg[2,2,0,0]=(0.880267125196)*x[0]+(0.77124406259)*x[1]
        arg[2,2,0,1]=(0.482402867542)*x[0]+(0.0746924305017)*x[1]
        arg[2,2,1,0]=(0.105861259696)*x[0]+(0.484292207267)*x[1]
        arg[2,2,1,1]=(-0.107785838196)*x[0]+(0.701132243209)*x[1]
        arg[2,2,2,0]=(0.559717405844)*x[0]+(-1.5585942717)*x[1]
        arg[2,2,2,1]=(-0.989130712605)*x[0]+(0.221361137556)*x[1]
        arg[2,3,0,0]=(-0.045471818095)*x[0]+(-0.437941959792)*x[1]
        arg[2,3,0,1]=(1.25840468379)*x[0]+(-1.18872011057)*x[1]
        arg[2,3,1,0]=(1.70665829408)*x[0]+(0.705273921003)*x[1]
        arg[2,3,1,1]=(-0.0928709253845)*x[0]+(0.785115449756)*x[1]
        arg[2,3,2,0]=(-0.887243418838)*x[0]+(1.06790660642)*x[1]
        arg[2,3,2,1]=(-0.572644686872)*x[0]+(-0.672831948394)*x[1]
        arg[2,4,0,0]=(1.28282566801)*x[0]+(0.651985199447)*x[1]
        arg[2,4,0,1]=(0.0965663229335)*x[0]+(1.33819998052)*x[1]
        arg[2,4,1,0]=(0.205569041098)*x[0]+(-0.873095358733)*x[1]
        arg[2,4,1,1]=(-1.04452025745)*x[0]+(-0.204917033907)*x[1]
        arg[2,4,2,0]=(-0.181163938972)*x[0]+(0.0341993409272)*x[1]
        arg[2,4,2,1]=(1.68327027059)*x[0]+(-0.289436355642)*x[1]
        arg[3,0,0,0]=(1.05712810731)*x[0]+(0.915711819735)*x[1]
        arg[3,0,0,1]=(-0.171072039482)*x[0]+(-0.160656943623)*x[1]
        arg[3,0,1,0]=(-1.27063799869)*x[0]+(-0.605131642813)*x[1]
        arg[3,0,1,1]=(0.940512990835)*x[0]+(-0.116675577531)*x[1]
        arg[3,0,2,0]=(-0.194213869952)*x[0]+(0.364066752025)*x[1]
        arg[3,0,2,1]=(-0.328780465397)*x[0]+(-0.114689413673)*x[1]
        arg[3,1,0,0]=(-0.825914305895)*x[0]+(-0.167010056731)*x[1]
        arg[3,1,0,1]=(0.657779056207)*x[0]+(0.0666252451638)*x[1]
        arg[3,1,1,0]=(-0.464004426036)*x[0]+(-0.340932918409)*x[1]
        arg[3,1,1,1]=(-1.6698652667)*x[0]+(0.731870373141)*x[1]
        arg[3,1,2,0]=(1.39626250779)*x[0]+(-0.879152855557)*x[1]
        arg[3,1,2,1]=(1.34973919508)*x[0]+(-0.129753332761)*x[1]
        arg[3,2,0,0]=(1.03443450706)*x[0]+(0.807333477811)*x[1]
        arg[3,2,0,1]=(0.366011302596)*x[0]+(0.543804800926)*x[1]
        arg[3,2,1,0]=(0.262446846036)*x[0]+(-0.247786850991)*x[1]
        arg[3,2,1,1]=(-1.04657091196)*x[0]+(-0.485443426155)*x[1]
        arg[3,2,2,0]=(0.342434327538)*x[0]+(-0.148503585588)*x[1]
        arg[3,2,2,1]=(-0.189833429716)*x[0]+(0.424391874819)*x[1]
        arg[3,3,0,0]=(-0.118348838118)*x[0]+(0.397628264341)*x[1]
        arg[3,3,0,1]=(0.481440510084)*x[0]+(-0.393576221424)*x[1]
        arg[3,3,1,0]=(0.907533552208)*x[0]+(-0.668646549376)*x[1]
        arg[3,3,1,1]=(-1.49731714213)*x[0]+(-1.18710678264)*x[1]
        arg[3,3,2,0]=(-0.460660079207)*x[0]+(1.48078266444)*x[1]
        arg[3,3,2,1]=(-0.161073556988)*x[0]+(-0.486827042754)*x[1]
        arg[3,4,0,0]=(-0.668755455623)*x[0]+(0.345804059434)*x[1]
        arg[3,4,0,1]=(1.00528889193)*x[0]+(0.978507928191)*x[1]
        arg[3,4,1,0]=(0.98955856331)*x[0]+(1.0421852144)*x[1]
        arg[3,4,1,1]=(0.711688260873)*x[0]+(1.39962222322)*x[1]
        arg[3,4,2,0]=(1.08512429209)*x[0]+(-0.555249097743)*x[1]
        arg[3,4,2,1]=(-1.10443784007)*x[0]+(-0.782274429169)*x[1]
        ref[0,0,0,0]=(0.151153165564)/(o+1.)+(0.112609656739)+(0.254304335059)*0.5**o
        ref[0,0,0,1]=(-0.530602583511)/(o+1.)+(0.1817855378)+(-0.947398818743)*0.5**o
        ref[0,0,1,0]=(0.308747437738)/(o+1.)+(-0.0338129255643)+(-0.676658756184)*0.5**o
        ref[0,0,1,1]=(0.321026553427)/(o+1.)+(0.0692705367618)+(0.108863145337)*0.5**o
        ref[0,0,2,0]=(-0.0908034666655)/(o+1.)+(-0.1100205155)+(-0.517562009199)*0.5**o
        ref[0,0,2,1]=(0.303456040903)/(o+1.)+(0.500090875336)+(-0.254199784829)*0.5**o
        ref[0,1,0,0]=(-0.440641221831)/(o+1.)+(0.456218946873)+(-0.296391367396)*0.5**o
        ref[0,1,0,1]=(0.222628561762)/(o+1.)+(-0.162064412854)+(-0.457267302337)*0.5**o
        ref[0,1,1,0]=(-0.913361887408)/(o+1.)+(-0.356168674239)+(0.401664604431)*0.5**o
        ref[0,1,1,1]=(-0.543116639248)/(o+1.)+(-0.120902439422)+(0.381879135767)*0.5**o
        ref[0,1,2,0]=(0.993649262831)/(o+1.)+(0.384695858206)+(-0.55736653846)*0.5**o
        ref[0,1,2,1]=(-0.968077797451)/(o+1.)+(-0.187765942637)+(-0.603167099406)*0.5**o
        ref[0,2,0,0]=(0.873662019918)/(o+1.)+(-0.710635360033)+(-0.146359415223)*0.5**o
        ref[0,2,0,1]=(0.466408230693)/(o+1.)+(0.77626565285)+(0.389070815631)*0.5**o
        ref[0,2,1,0]=(-0.475010813579)/(o+1.)+(0.525435880006)+(0.960310046461)*0.5**o
        ref[0,2,1,1]=(0.697127520484)/(o+1.)+(0.357204276552)+(0.388328722275)*0.5**o
        ref[0,2,2,0]=(-0.108434738487)/(o+1.)+(0.356443300466)+(-0.97475753261)*0.5**o
        ref[0,2,2,1]=(0.952274964304)/(o+1.)+(-0.497379508976)+(-0.562006714089)*0.5**o
        ref[0,3,0,0]=(-0.0368012761671)/(o+1.)+(0.594000625518)+(0.770200680808)*0.5**o
        ref[0,3,0,1]=(0.450361861836)/(o+1.)+(0.182031052848)+(0.164263059934)*0.5**o
        ref[0,3,1,0]=(0.500714741956)/(o+1.)+(0.0479711343168)+(-0.0785996333735)*0.5**o
        ref[0,3,1,1]=(-0.949280938645)/(o+1.)+(0.452441874504)+(-0.88306753495)*0.5**o
        ref[0,3,2,0]=(0.186931712837)/(o+1.)+(0.222335175903)+(0.426318408694)*0.5**o
        ref[0,3,2,1]=(-0.288015428918)/(o+1.)+(0.80948657963)+(-0.822221815085)*0.5**o
        ref[0,4,0,0]=(0.670151184695)/(o+1.)+(-0.415883847013)+(0.376690471866)*0.5**o
        ref[0,4,0,1]=(-0.107106843992)/(o+1.)+(0.555375298435)+(-0.837698961768)*0.5**o
        ref[0,4,1,0]=(-0.299999096802)/(o+1.)+(0.668996782774)+(-0.669357604061)*0.5**o
        ref[0,4,1,1]=(0.778006183401)/(o+1.)+(-0.614473529032)+(-0.532655856076)*0.5**o
        ref[0,4,2,0]=(-0.250068389818)/(o+1.)+(0.156274314197)+(-0.0103473845504)*0.5**o
        ref[0,4,2,1]=(0.902125322216)/(o+1.)+(-0.616424567683)+(-0.560368879846)*0.5**o
        ref[1,0,0,0]=(-0.133690258295)/(o+1.)+(-0.715949360249)+(0.525524578427)*0.5**o
        ref[1,0,0,1]=(-0.788097689216)/(o+1.)+(0.0998405659256)+(-0.076709566994)*0.5**o
        ref[1,0,1,0]=(0.144280886187)/(o+1.)+(0.0775377290314)+(-0.696369546924)*0.5**o
        ref[1,0,1,1]=(0.824172196605)/(o+1.)+(0.561804029444)+(-0.0277357461773)*0.5**o
        ref[1,0,2,0]=(0.422564421802)/(o+1.)+(-0.60719307099)+(-0.417386842591)*0.5**o
        ref[1,0,2,1]=(0.778908672762)/(o+1.)+(0.0163446340765)+(-0.505974820938)*0.5**o
        ref[1,1,0,0]=(0.0574071047387)/(o+1.)+(-0.350514214742)+(0.608850746775)*0.5**o
        ref[1,1,0,1]=(-0.991660961792)/(o+1.)+(0.322084279455)+(0.380970772212)*0.5**o
        ref[1,1,1,0]=(-0.823761120268)/(o+1.)+(-0.0495419092898)+(0.930901327253)*0.5**o
        ref[1,1,1,1]=(-0.384729980569)/(o+1.)+(-0.0392583789163)+(0.649381188769)*0.5**o
        ref[1,1,2,0]=(-0.840365304069)/(o+1.)+(-0.0150512662777)+(0.517673506558)*0.5**o
        ref[1,1,2,1]=(0.555976660846)/(o+1.)+(-0.307265886898)+(0.707353625614)*0.5**o
        ref[1,2,0,0]=(-0.423056705491)/(o+1.)+(0.0559404393793)+(0.311083677036)*0.5**o
        ref[1,2,0,1]=(0.15409797664)/(o+1.)+(-0.0906637067519)+(-0.774473828018)*0.5**o
        ref[1,2,1,0]=(0.796718644088)/(o+1.)+(0.248012077098)+(0.776951250898)*0.5**o
        ref[1,2,1,1]=(-0.342830889263)/(o+1.)+(-0.282162737841)+(0.511417858487)*0.5**o
        ref[1,2,2,0]=(-0.722403016671)/(o+1.)+(-0.367059457954)+(0.230014491812)*0.5**o
        ref[1,2,2,1]=(-0.773685058881)/(o+1.)+(0.412807900451)+(-0.624365721366)*0.5**o
        ref[1,3,0,0]=(0.527481434758)/(o+1.)+(0.36602961117)+(0.031214145649)*0.5**o
        ref[1,3,0,1]=(0.0630927531585)/(o+1.)+(-0.164989701995)+(-0.325906787975)*0.5**o
        ref[1,3,1,0]=(-0.612390590593)/(o+1.)+(-0.78855996274)+(-0.63929738839)*0.5**o
        ref[1,3,1,1]=(-0.962656044265)/(o+1.)+(-0.00576535037253)+(-0.546330443673)*0.5**o
        ref[1,3,2,0]=(-0.947280922008)/(o+1.)+(-0.137449579996)+(0.747590859563)*0.5**o
        ref[1,3,2,1]=(-0.946623026202)/(o+1.)+(0.0787536550213)+(-0.24399757656)*0.5**o
        ref[1,4,0,0]=(-0.174471016943)/(o+1.)+(-0.636500556039)+(-0.635482528623)*0.5**o
        ref[1,4,0,1]=(0.806379391595)/(o+1.)+(-0.00304106577093)+(-0.476044717545)*0.5**o
        ref[1,4,1,0]=(0.729649125134)/(o+1.)+(0.0151477051616)+(-0.403091231646)*0.5**o
        ref[1,4,1,1]=(0.559976454745)/(o+1.)+(0.479295896421)+(0.75951513376)*0.5**o
        ref[1,4,2,0]=(0.272199270818)/(o+1.)+(-0.0929072274332)+(-0.843552757065)*0.5**o
        ref[1,4,2,1]=(-0.552663678377)/(o+1.)+(0.613784745778)+(-0.230300352975)*0.5**o
        ref[2,0,0,0]=(-0.174247908098)/(o+1.)+(-0.108873783282)+(-0.716067030882)*0.5**o
        ref[2,0,0,1]=(-0.300584841532)/(o+1.)+(-0.485363665493)+(-0.267230223262)*0.5**o
        ref[2,0,1,0]=(0.316261805154)/(o+1.)+(-0.523474106451)+(-0.888278086869)*0.5**o
        ref[2,0,1,1]=(-0.699622562861)/(o+1.)+(-0.151089538248)+(-0.909702635929)*0.5**o
        ref[2,0,2,0]=(0.728545639829)/(o+1.)+(0.192083148877)+(-0.0625371618174)*0.5**o
        ref[2,0,2,1]=(-0.22042267239)/(o+1.)+(-0.611974599324)+(0.677333343041)*0.5**o
        ref[2,1,0,0]=(-0.0734883811113)/(o+1.)+(0.36100831022)+(-0.890215236787)*0.5**o
        ref[2,1,0,1]=(0.121656829057)/(o+1.)+(-0.130801635799)+(-0.341933579678)*0.5**o
        ref[2,1,1,0]=(0.221353168629)/(o+1.)+(0.618635673483)+(0.540308531179)*0.5**o
        ref[2,1,1,1]=(0.0152580531273)/(o+1.)+(0.252173415542)+(0.560378877984)*0.5**o
        ref[2,1,2,0]=(0.580319777731)/(o+1.)+(0.90566612137)+(0.993226484879)*0.5**o
        ref[2,1,2,1]=(-0.710250320949)/(o+1.)+(0.742177021871)+(0.345780554724)*0.5**o
        ref[2,2,0,0]=(0.770701563507)/(o+1.)+(0.240823471881)+(0.399162680517)*0.5**o
        ref[2,2,0,1]=(0.76121761761)/(o+1.)+(0.128382656738)+(-0.460887633042)*0.5**o
        ref[2,2,1,0]=(-0.269854962057)/(o+1.)+(0.690854898294)+(-0.521701367567)*0.5**o
        ref[2,2,1,1]=(0.719518595712)/(o+1.)+(0.029596430244)+(-0.185365051187)*0.5**o
        ref[2,2,2,0]=(-0.671157761165)/(o+1.)+(-0.142688285012)+(-0.0423425346644)*0.5**o
        ref[2,2,2,1]=(-0.541156097112)/(o+1.)+(0.0765180918929)+(-0.379649661722)*0.5**o
        ref[2,3,0,0]=(-0.0604347109212)/(o+1.)+(-0.19403702073)+(-0.034905025507)*0.5**o
        ref[2,3,0,1]=(-0.793398507071)/(o+1.)+(0.255681280626)+(0.351720519037)*0.5**o
        ref[2,3,1,0]=(-0.267058413731)/(o+1.)+(0.852211426049)+(0.974567776717)*0.5**o
        ref[2,3,1,1]=(0.228396641207)/(o+1.)+(0.322922896735)+(-0.181997910305)*0.5**o
        ref[2,3,2,0]=(0.480987773937)/(o+1.)+(-0.197709028569)+(0.0950934707835)*0.5**o
        ref[2,3,2,1]=(-0.648934475027)/(o+1.)+(-0.418383297875)+(0.240224435511)*0.5**o
        ref[2,4,0,0]=(0.430020261528)/(o+1.)+(0.53421018733)+(0.436370231269)*0.5**o
        ref[2,4,0,1]=(0.906390660223)/(o+1.)+(-0.056057545856)+(0.640490734948)*0.5**o
        ref[2,4,1,0]=(-0.732099770943)/(o+1.)+(-0.0485027617732)+(0.161578976854)*0.5**o
        ref[2,4,1,1]=(-0.827495680848)/(o+1.)+(0.285044728936)+(-0.992031068384)*0.5**o
        ref[2,4,2,0]=(-0.919905471787)/(o+1.)+(0.656971386264)+(-0.541001898785)*0.5**o
        ref[2,4,2,1]=(0.161975875302)/(o+1.)+(0.272665206557)+(0.686527626533)*0.5**o
        ref[3,0,0,0]=(0.584120963259)/(o+1.)+(0.207930729804)+(0.972857504177)*0.5**o
        ref[3,0,0,1]=(0.315823141491)/(o+1.)+(-0.217561208386)+(-0.212429707823)*0.5**o
        ref[3,0,1,0]=(-0.732294996139)/(o+1.)+(-0.278653143596)+(-0.586168358175)*0.5**o
        ref[3,0,1,1]=(0.481321847225)/(o+1.)+(-0.070080648792)+(0.482676863662)*0.5**o
        ref[3,0,2,0]=(0.616679859076)/(o+1.)+(-0.418784546677)+(0.390742116352)*0.5**o
        ref[3,0,2,1]=(0.866778417448)/(o+1.)+(-0.686585656643)+(0.0629230167692)*0.5**o
        ref[3,1,0,0]=(0.531890054167)/(o+1.)+(-0.516187607633)+(-0.492439201527)*0.5**o
        ref[3,1,0,1]=(-0.512361639413)/(o+1.)+(0.499557182545)+(0.237651575694)*0.5**o
        ref[3,1,1,0]=(-0.67542965405)/(o+1.)+(0.274414249559)+(-0.678336189514)*0.5**o
        ref[3,1,1,1]=(0.371936242507)/(o+1.)+(-0.1636482466)+(-0.982634642862)*0.5**o
        ref[3,1,2,0]=(-0.799408831501)/(o+1.)+(0.458633399549)+(0.399251684639)*0.5**o
        ref[3,1,2,1]=(-0.0145253903686)/(o+1.)+(0.238472345905)+(0.757566560882)*0.5**o
        ref[3,2,0,0]=(-0.130519473112)/(o+1.)+(0.695277604837)+(0.581732248306)*0.5**o
        ref[3,2,0,1]=(0.632010536438)/(o+1.)+(0.123066205529)+(0.0316731560259)*0.5**o
        ref[3,2,1,0]=(-0.709926210356)/(o+1.)+(0.0926699972302)+(0.53924621094)*0.5**o
        ref[3,2,1,1]=(0.428094002247)/(o+1.)+(-0.841997926131)+(-0.276112488096)*0.5**o
        ref[3,2,2,0]=(0.708481148086)/(o+1.)+(-0.50498161534)+(0.495412824545)*0.5**o
        ref[3,2,2,1]=(0.782824622703)/(o+1.)+(-0.151509698687)+(-0.245246780227)*0.5**o
        ref[3,3,0,0]=(0.848460868418)/(o+1.)+(-0.104639248461)+(-0.359902945273)*0.5**o
        ref[3,3,0,1]=(0.0569151307298)/(o+1.)+(-0.0674224535469)+(0.165794065024)*0.5**o
        ref[3,3,1,0]=(-0.165683739908)/(o+1.)+(-0.183388699236)+(0.771348141212)*0.5**o
        ref[3,3,1,1]=(-0.932550058069)/(o+1.)+(-0.47828109001)+(-0.795311686688)*0.5**o
        ref[3,3,2,0]=(0.821542940923)/(o+1.)+(0.166853194487)+(-0.13512674466)*0.5**o
        ref[3,3,2,1]=(-0.46375871628)/(o+1.)+(0.132701267732)+(-0.449544418926)*0.5**o
        ref[3,4,0,0]=(-0.074530542168)/(o+1.)+(-0.0567877963797)+(-0.134845261261)*0.5**o
        ref[3,4,0,1]=(0.238671520479)/(o+1.)+(0.50689253572)+(0.731340228204)*0.5**o
        ref[3,4,1,0]=(0.981601513335)/(o+1.)+(0.400717209822)+(0.248707844726)*0.5**o
        ref[3,4,1,1]=(0.592304390107)/(o+1.)+(0.342408637328)+(0.834188819333)*0.5**o
        ref[3,4,2,0]=(-0.339991330909)/(o+1.)+(-0.0145922376156)+(0.899051000485)*0.5**o
        ref[3,4,2,1]=(-0.626610688164)/(o+1.)+(-0.417008165115)+(-0.426085250846)*0.5**o
      else:
        arg[0,0,0,0]=(0.697666818785)*x[0]+(1.00202295791)*x[1]+(0.617700157184)*x[2]
        arg[0,0,0,1]=(-0.465577819457)*x[0]+(-1.40054693355)*x[1]+(1.16912653295)*x[2]
        arg[0,0,1,0]=(-1.26696500634)*x[0]+(-0.0469756169975)*x[1]+(-0.445591738991)*x[2]
        arg[0,0,1,1]=(-1.61654321709)*x[0]+(-1.69522962467)*x[1]+(-1.06089094851)*x[2]
        arg[0,0,2,0]=(0.229468378506)*x[0]+(0.716813596991)*x[1]+(-0.237703937029)*x[2]
        arg[0,0,2,1]=(-1.12052051905)*x[0]+(0.835000004618)*x[1]+(-0.853004812404)*x[2]
        arg[0,1,0,0]=(-1.75500745705)*x[0]+(0.655055836882)*x[1]+(1.05207750735)*x[2]
        arg[0,1,0,1]=(-0.0746024824253)*x[0]+(-0.421596816958)*x[1]+(-0.375715855989)*x[2]
        arg[0,1,1,0]=(-0.963269684396)*x[0]+(0.431993248836)*x[1]+(-1.63061928649)*x[2]
        arg[0,1,1,1]=(-0.418757265018)*x[0]+(-0.665626168583)*x[1]+(-0.335734432507)*x[2]
        arg[0,1,2,0]=(0.980346404307)*x[0]+(1.45442049802)*x[1]+(-0.833420308612)*x[2]
        arg[0,1,2,1]=(-1.52536017847)*x[0]+(0.99484028681)*x[1]+(0.109754321663)*x[2]
        arg[0,2,0,0]=(1.697179262)*x[0]+(-0.928732802147)*x[1]+(-0.653379513626)*x[2]
        arg[0,2,0,1]=(0.682698902948)*x[0]+(0.829307959583)*x[1]+(-1.0300112276)*x[2]
        arg[0,2,1,0]=(0.026084323266)*x[0]+(1.28865784608)*x[1]+(0.830446580645)*x[2]
        arg[0,2,1,1]=(0.486291506032)*x[0]+(-0.519637742913)*x[1]+(0.81671330629)*x[2]
        arg[0,2,2,0]=(-0.761591624634)*x[0]+(0.370951131011)*x[1]+(-0.256748479312)*x[2]
        arg[0,2,2,1]=(-0.249974326513)*x[0]+(0.267323484635)*x[1]+(-1.09642130905)*x[2]
        arg[0,3,0,0]=(0.752057563255)*x[0]+(-1.2772262175)*x[1]+(-0.264569668983)*x[2]
        arg[0,3,0,1]=(-0.173167796447)*x[0]+(0.31873208356)*x[1]+(-0.599780701112)*x[2]
        arg[0,3,1,0]=(-0.912464014941)*x[0]+(-1.56452517166)*x[1]+(1.37651660499)*x[2]
        arg[0,3,1,1]=(0.302009667854)*x[0]+(0.524213064769)*x[1]+(0.316301522683)*x[2]
        arg[0,3,2,0]=(-1.2940154673)*x[0]+(-0.900061396992)*x[1]+(0.3860029847)*x[2]
        arg[0,3,2,1]=(-0.97354131341)*x[0]+(1.08221883964)*x[1]+(-0.739323076416)*x[2]
        arg[0,4,0,0]=(1.86535317192)*x[0]+(-0.478359589546)*x[1]+(-0.798014592302)*x[2]
        arg[0,4,0,1]=(-1.08518693851)*x[0]+(-0.186048654536)*x[1]+(1.04915573267)*x[2]
        arg[0,4,1,0]=(-1.09692811055)*x[0]+(1.01042920935)*x[1]+(-0.73978089555)*x[2]
        arg[0,4,1,1]=(0.654656964663)*x[0]+(0.279204596126)*x[1]+(0.886217781361)*x[2]
        arg[0,4,2,0]=(-0.54009886291)*x[0]+(0.378037248739)*x[1]+(1.09785568886)*x[2]
        arg[0,4,2,1]=(-1.43995958913)*x[0]+(-0.720157090994)*x[1]+(0.0676362028136)*x[2]
        arg[1,0,0,0]=(1.47735412608)*x[0]+(0.342355546228)*x[1]+(-0.0134502415508)*x[2]
        arg[1,0,0,1]=(-0.419536590369)*x[0]+(-1.61108470511)*x[1]+(1.51281979355)*x[2]
        arg[1,0,1,0]=(1.31765698245)*x[0]+(-0.7499566294)*x[1]+(0.934537503478)*x[2]
        arg[1,0,1,1]=(0.688467914883)*x[0]+(-1.32681280673)*x[1]+(-0.387405705058)*x[2]
        arg[1,0,2,0]=(1.37069587556)*x[0]+(0.540830111773)*x[1]+(0.477311068263)*x[2]
        arg[1,0,2,1]=(-0.572066213761)*x[0]+(-1.11950925494)*x[1]+(1.07939217872)*x[2]
        arg[1,1,0,0]=(0.564997105326)*x[0]+(-0.73130546389)*x[1]+(0.435910937304)*x[2]
        arg[1,1,0,1]=(0.513931739674)*x[0]+(-0.944043404826)*x[1]+(0.014114227468)*x[2]
        arg[1,1,1,0]=(-0.77850597256)*x[0]+(-0.445835136484)*x[1]+(0.157478357479)*x[2]
        arg[1,1,1,1]=(0.752431176866)*x[0]+(0.659759664199)*x[1]+(-0.859515433521)*x[2]
        arg[1,1,2,0]=(0.0693158730911)*x[0]+(-0.820997827204)*x[1]+(-0.714694436829)*x[2]
        arg[1,1,2,1]=(0.604674152847)*x[0]+(0.647261183132)*x[1]+(-1.21981352028)*x[2]
        arg[1,2,0,0]=(0.0997504695984)*x[0]+(-0.271549839083)*x[1]+(-0.573467835942)*x[2]
        arg[1,2,0,1]=(0.01861845581)*x[0]+(0.157410502406)*x[1]+(0.939257868776)*x[2]
        arg[1,2,1,0]=(1.44909894631)*x[0]+(0.116038517547)*x[1]+(-0.851940489233)*x[2]
        arg[1,2,1,1]=(1.34598841007)*x[0]+(1.79163125841)*x[1]+(0.719171044245)*x[2]
        arg[1,2,2,0]=(-0.214737791448)*x[0]+(-1.85810839095)*x[1]+(-0.240776599927)*x[2]
        arg[1,2,2,1]=(-0.574707645928)*x[0]+(-0.664173831956)*x[1]+(0.310262106696)*x[2]
        arg[1,3,0,0]=(0.296213453592)*x[0]+(-0.831112482555)*x[1]+(0.130075739128)*x[2]
        arg[1,3,0,1]=(-0.369510604457)*x[0]+(0.0373909697998)*x[1]+(1.6689129783)*x[2]
        arg[1,3,1,0]=(0.0922435881419)*x[0]+(-0.280519827004)*x[1]+(0.285933839232)*x[2]
        arg[1,3,1,1]=(-0.649253282272)*x[0]+(-0.460065044123)*x[1]+(-0.0711164948063)*x[2]
        arg[1,3,2,0]=(0.793313307581)*x[0]+(-0.0587956351149)*x[1]+(0.810487259739)*x[2]
        arg[1,3,2,1]=(-1.38668597055)*x[0]+(1.51396934198)*x[1]+(-1.13918550255)*x[2]
        arg[1,4,0,0]=(1.40078167737)*x[0]+(-1.61915436345)*x[1]+(0.421710091214)*x[2]
        arg[1,4,0,1]=(-1.37982015877)*x[0]+(1.30607371738)*x[1]+(-0.608888848419)*x[2]
        arg[1,4,1,0]=(-0.558087802805)*x[0]+(-0.214169499512)*x[1]+(-0.766242546503)*x[2]
        arg[1,4,1,1]=(-1.75503436584)*x[0]+(0.183604705451)*x[1]+(-0.148071484576)*x[2]
        arg[1,4,2,0]=(0.537942069142)*x[0]+(-0.00640749928252)*x[1]+(-0.277544629657)*x[2]
        arg[1,4,2,1]=(-0.652645833371)*x[0]+(-1.33439077026)*x[1]+(-0.226308197201)*x[2]
        arg[2,0,0,0]=(1.45646289279)*x[0]+(1.40842127675)*x[1]+(1.75078281495)*x[2]
        arg[2,0,0,1]=(0.867988651995)*x[0]+(1.35061812241)*x[1]+(-1.56520776323)*x[2]
        arg[2,0,1,0]=(0.549686523522)*x[0]+(-0.528085465813)*x[1]+(-0.994978820267)*x[2]
        arg[2,0,1,1]=(0.383595996552)*x[0]+(0.612989859087)*x[1]+(-0.560401247231)*x[2]
        arg[2,0,2,0]=(-0.341259919499)*x[0]+(-0.125491675042)*x[1]+(0.545572340757)*x[2]
        arg[2,0,2,1]=(-0.414269395434)*x[0]+(-0.433969881898)*x[1]+(-1.01820199328)*x[2]
        arg[2,1,0,0]=(-0.113575280389)*x[0]+(0.326916039942)*x[1]+(-0.576072890249)*x[2]
        arg[2,1,0,1]=(-0.296473969661)*x[0]+(0.195675099431)*x[1]+(-1.72378150831)*x[2]
        arg[2,1,1,0]=(-1.31575932758)*x[0]+(-0.122557423522)*x[1]+(0.53435027695)*x[2]
        arg[2,1,1,1]=(0.299435754608)*x[0]+(0.727140413706)*x[1]+(0.848931358475)*x[2]
        arg[2,1,2,0]=(0.2618965198)*x[0]+(-0.461672573339)*x[1]+(0.923592803172)*x[2]
        arg[2,1,2,1]=(-0.326817258523)*x[0]+(-0.0363300805442)*x[1]+(1.82049875918)*x[2]
        arg[2,2,0,0]=(-0.435113320888)*x[0]+(0.0257984353786)*x[1]+(0.287846577657)*x[2]
        arg[2,2,0,1]=(1.39178068279)*x[0]+(0.136781967539)*x[1]+(-1.38161590351)*x[2]
        arg[2,2,1,0]=(-0.887874199356)*x[0]+(-0.476769153654)*x[1]+(-0.618760485829)*x[2]
        arg[2,2,1,1]=(1.58883355098)*x[0]+(-0.889469047555)*x[1]+(-0.678486755843)*x[2]
        arg[2,2,2,0]=(0.237147029365)*x[0]+(-0.509883462401)*x[1]+(0.533163151551)*x[2]
        arg[2,2,2,1]=(0.66513913749)*x[0]+(1.30317030657)*x[1]+(0.804083365617)*x[2]
        arg[2,3,0,0]=(1.01531518403)*x[0]+(1.3753053143)*x[1]+(0.000877284235964)*x[2]
        arg[2,3,0,1]=(-0.40853642543)*x[0]+(0.154794268783)*x[1]+(-1.34306671117)*x[2]
        arg[2,3,1,0]=(0.43065284359)*x[0]+(-0.28965146009)*x[1]+(0.660248828789)*x[2]
        arg[2,3,1,1]=(-1.4334922681)*x[0]+(-0.0348802858609)*x[1]+(0.502051304974)*x[2]
        arg[2,3,2,0]=(-1.17399537487)*x[0]+(0.865787043946)*x[1]+(-0.0105949677478)*x[2]
        arg[2,3,2,1]=(0.63104158794)*x[0]+(0.436196079951)*x[1]+(0.498606623061)*x[2]
        arg[2,4,0,0]=(-1.44410177354)*x[0]+(0.513406326011)*x[1]+(0.699127199447)*x[2]
        arg[2,4,0,1]=(-0.981727023077)*x[0]+(0.484182120695)*x[1]+(0.667175832045)*x[2]
        arg[2,4,1,0]=(-1.3352602588)*x[0]+(0.626269023364)*x[1]+(0.813537646695)*x[2]
        arg[2,4,1,1]=(-0.932486930114)*x[0]+(0.299448807849)*x[1]+(0.195862014797)*x[2]
        arg[2,4,2,0]=(-0.0621489644806)*x[0]+(0.131979664158)*x[1]+(0.442029269778)*x[2]
        arg[2,4,2,1]=(-0.507508608633)*x[0]+(-1.28613226533)*x[1]+(-0.697920444023)*x[2]
        arg[3,0,0,0]=(-0.984942677585)*x[0]+(-1.58913299616)*x[1]+(-0.373026784822)*x[2]
        arg[3,0,0,1]=(0.616666427113)*x[0]+(-0.625162800471)*x[1]+(-0.796307290839)*x[2]
        arg[3,0,1,0]=(-0.48469203683)*x[0]+(-0.0572105166553)*x[1]+(0.809572383581)*x[2]
        arg[3,0,1,1]=(-0.487160309892)*x[0]+(0.77646454341)*x[1]+(-0.41947544573)*x[2]
        arg[3,0,2,0]=(-1.17902121554)*x[0]+(-0.244939532033)*x[1]+(-0.282994359476)*x[2]
        arg[3,0,2,1]=(0.33515909881)*x[0]+(0.146866561705)*x[1]+(1.81486098364)*x[2]
        arg[3,1,0,0]=(0.379977901341)*x[0]+(0.834531701517)*x[1]+(-0.0242027062166)*x[2]
        arg[3,1,0,1]=(0.184318292766)*x[0]+(1.08367911805)*x[1]+(-0.164531741594)*x[2]
        arg[3,1,1,0]=(-1.00967115996)*x[0]+(0.542699640149)*x[1]+(0.707616701259)*x[2]
        arg[3,1,1,1]=(0.856948233811)*x[0]+(-1.2186550297)*x[1]+(-0.034268798159)*x[2]
        arg[3,1,2,0]=(0.259470684477)*x[0]+(-1.03586983732)*x[1]+(-0.157275979341)*x[2]
        arg[3,1,2,1]=(-0.161954890658)*x[0]+(1.65853209885)*x[1]+(0.381113456719)*x[2]
        arg[3,2,0,0]=(-0.437413004681)*x[0]+(-0.730340273929)*x[1]+(-0.687689272494)*x[2]
        arg[3,2,0,1]=(-0.336618164118)*x[0]+(-1.24388666895)*x[1]+(-0.2198689254)*x[2]
        arg[3,2,1,0]=(0.0872793087887)*x[0]+(-0.336554573215)*x[1]+(-0.0597803523262)*x[2]
        arg[3,2,1,1]=(0.192805432018)*x[0]+(0.0540495582064)*x[1]+(0.846658042071)*x[2]
        arg[3,2,2,0]=(0.00794192604414)*x[0]+(-0.33504559053)*x[1]+(0.615701149787)*x[2]
        arg[3,2,2,1]=(0.210870961503)*x[0]+(1.14164095846)*x[1]+(-0.192785742791)*x[2]
        arg[3,3,0,0]=(-0.25895162041)*x[0]+(-0.225800436488)*x[1]+(-0.198007079838)*x[2]
        arg[3,3,0,1]=(-0.150363703231)*x[0]+(1.23870429535)*x[1]+(0.28635881247)*x[2]
        arg[3,3,1,0]=(-0.865980718216)*x[0]+(-0.0849853244335)*x[1]+(-0.292164217189)*x[2]
        arg[3,3,1,1]=(-0.350465968722)*x[0]+(0.09853736936)*x[1]+(-0.476711524665)*x[2]
        arg[3,3,2,0]=(0.311396300263)*x[0]+(-0.92437612034)*x[1]+(-0.757139962928)*x[2]
        arg[3,3,2,1]=(-0.912311919837)*x[0]+(0.267793631099)*x[1]+(0.4917345401)*x[2]
        arg[3,4,0,0]=(0.613662541753)*x[0]+(0.782757341361)*x[1]+(1.04209808158)*x[2]
        arg[3,4,0,1]=(0.492828613997)*x[0]+(1.11979095664)*x[1]+(-0.843545072354)*x[2]
        arg[3,4,1,0]=(-0.51939120556)*x[0]+(0.476004484286)*x[1]+(-0.516311785432)*x[2]
        arg[3,4,1,1]=(1.00423313567)*x[0]+(0.90776890388)*x[1]+(1.34423309497)*x[2]
        arg[3,4,2,0]=(-1.44069600826)*x[0]+(-1.39515290909)*x[1]+(1.19851590247)*x[2]
        arg[3,4,2,1]=(0.391851619877)*x[0]+(0.265529120553)*x[1]+(0.996610410913)*x[2]
        ref[0,0,0,0]=(1.19330263935)/(o+1.)+(0.55394275251)+(0.0162017895041)*0.5**o
        ref[0,0,0,1]=(-0.672351783684)/(o+1.)+(-0.187889622039)+(0.351132807711)*0.5**o
        ref[0,0,1,0]=(-1.27021996264)/(o+1.)+(0.236286530101)+(-0.961885459894)*0.5**o
        ref[0,0,1,1]=(-1.43442517107)/(o+1.)+(-1.00113374859)+(-0.935971122022)*0.5**o
        ref[0,0,2,0]=(-0.434813695127)/(o+1.)+(0.606673209583)+(-0.0699546855712)*0.5**o
        ref[0,0,2,1]=(-0.0434901247948)/(o+1.)+(-0.180911877983)+(-0.733211446073)*0.5**o
        ref[0,1,0,0]=(1.41514302182)/(o+1.)+(-0.247977413325)+(-0.967062307989)*0.5**o
        ref[0,1,0,1]=(0.69128100142)/(o+1.)+(-0.621609882923)+(-0.319976390946)*0.5**o
        ref[0,1,1,0]=(-0.881870429191)/(o+1.)+(-0.654075774082)+(0.0281262553057)*0.5**o
        ref[0,1,1,1]=(-1.27239116086)/(o+1.)+(-0.0854066429492)+(0.0230865806541)*0.5**o
        ref[0,1,2,0]=(-0.222663945351)/(o+1.)+(0.685312598747)+(0.453385341573)*0.5**o
        ref[0,1,2,1]=(0.101409038706)/(o+1.)+(0.151367946744)+(-0.824910502191)*0.5**o
        ref[0,2,0,0]=(-1.19509443892)/(o+1.)+(0.225437856866)+(0.85928567141)*0.5**o
        ref[0,2,0,1]=(0.285764347754)/(o+1.)+(-0.383432127133)+(0.963095541446)*0.5**o
        ref[0,2,1,0]=(0.728010227911)/(o+1.)+(0.983790919896)+(-0.550403317717)*0.5**o
        ref[0,2,1,1]=(0.563748259036)/(o+1.)+(0.165164845927)+(-0.110710881481)*0.5**o
        ref[0,2,2,0]=(-0.361502606429)/(o+1.)+(0.0276145482611)+(-0.341115463028)*0.5**o
        ref[0,2,2,1]=(-0.293320207933)/(o+1.)+(0.0336757304385)+(-0.853103403872)*0.5**o
        ref[0,3,0,0]=(-0.410233956527)/(o+1.)+(-0.474281126245)+(0.569057885785)*0.5**o
        ref[0,3,0,1]=(-0.835861970115)/(o+1.)+(0.0173715483175)+(0.346902459481)*0.5**o
        ref[0,3,1,0]=(0.0830466456187)/(o+1.)+(-0.288204681495)+(-0.607109864241)*0.5**o
        ref[0,3,1,1]=(1.07074130823)/(o+1.)+(-0.0437983012867)+(0.159379549652)*0.5**o
        ref[0,3,2,0]=(0.172301049609)/(o+1.)+(-0.491724874152)+(-0.996925180895)*0.5**o
        ref[0,3,2,1]=(-0.24891941221)/(o+1.)+(-0.03935856269)+(-0.3030090126)*0.5**o
        ref[0,4,0,0]=(-0.778575122429)/(o+1.)+(0.213085222078)+(0.941383668349)*0.5**o
        ref[0,4,0,1]=(0.880801627174)/(o+1.)+(-0.454451723401)+(-0.193978040747)*0.5**o
        ref[0,4,1,0]=(-0.835604724882)/(o+1.)+(0.127240834083)+(-0.245156740036)*0.5**o
        ref[0,4,1,1]=(1.62336716324)/(o+1.)+(-0.101085918464)+(0.398884015839)*0.5**o
        ref[0,4,2,0]=(1.16805827702)/(o+1.)+(0.211232591688)+(-0.654729385702)*0.5**o
        ref[0,4,2,1]=(-0.305424138957)/(o+1.)+(-0.431076572693)+(-0.924903192969)*0.5**o
        ref[1,0,0,0]=(-0.481596247529)/(o+1.)+(0.769902632559)+(0.748050413171)*0.5**o
        ref[1,0,0,1]=(0.177388661252)/(o+1.)+(-0.118766442613)+(-0.457657277952)*0.5**o
        ref[1,0,1,0]=(0.709890860372)/(o+1.)+(0.0668010230727)+(0.658744950012)*0.5**o
        ref[1,0,1,1]=(-1.45685781381)/(o+1.)+(-0.178674426089)+(0.788456069079)*0.5**o
        ref[1,0,2,0]=(0.194388185612)/(o+1.)+(0.649177543063)+(0.896093783855)*0.5**o
        ref[1,0,2,1]=(0.181561279507)/(o+1.)+(-0.200618291902)+(-0.392507985678)*0.5**o
        ref[1,1,0,0]=(-0.884376814027)/(o+1.)+(0.280382736159)+(0.593213920451)*0.5**o
        ref[1,1,0,1]=(-0.250709602218)/(o+1.)+(-0.492104211211)+(0.818920586956)*0.5**o
        ref[1,1,1,0]=(0.0529723694625)/(o+1.)+(-0.502047650638)+(-0.115739819752)*0.5**o
        ref[1,1,1,1]=(0.215812202957)/(o+1.)+(-0.308796450292)+(0.954456105171)*0.5**o
        ref[1,1,2,0]=(-0.991481050902)/(o+1.)+(0.162626252838)+(-0.800147845717)*0.5**o
        ref[1,1,2,1]=(-0.433989756951)/(o+1.)+(0.362776336712)+(-0.259441100777)*0.5**o
        ref[1,2,0,0]=(-0.930287052624)/(o+1.)+(-0.347752763108)+(0.880525373413)*0.5**o
        ref[1,2,0,1]=(0.698674852861)/(o+1.)+(-0.15119613196)+(0.719004238051)*0.5**o
        ref[1,2,1,0]=(-0.777216821365)/(o+1.)+(0.436336076297)+(0.617741643399)*0.5**o
        ref[1,2,1,1]=(1.09595223135)/(o+1.)+(0.978251130983)+(0.804336219412)*0.5**o
        ref[1,2,2,0]=(-0.651012630849)/(o+1.)+(-1.04894606664)+(0.43528198181)*0.5**o
        ref[1,2,2,1]=(-1.5227353883)/(o+1.)+(0.670019307557)+(-0.745922598001)*0.5**o
        ref[1,3,0,0]=(-0.750195637997)/(o+1.)+(0.231864245348)+(-0.118356142533)*0.5**o
        ref[1,3,0,1]=(1.17136226596)/(o+1.)+(-0.114976421389)+(0.395383920468)*0.5**o
        ref[1,3,1,0]=(-0.108070636769)/(o+1.)+(0.279145429234)+(-0.352562621327)*0.5**o
        ref[1,3,1,1]=(-0.144223481714)/(o+1.)+(-0.472954352493)+(-0.0903026345013)*0.5**o
        ref[1,3,2,0]=(-0.487564307786)/(o+1.)+(0.636973351449)+(0.758622537094)*0.5**o
        ref[1,3,2,1]=(0.390860965954)/(o+1.)+(-0.36647678165)+(-0.66980953377)*0.5**o
        ref[1,4,0,0]=(-1.04824984837)/(o+1.)+(0.213932231728)+(0.823722790054)*0.5**o
        ref[1,4,0,1]=(-0.0984653601336)/(o+1.)+(0.07867877705)+(-0.741527483773)*0.5**o
        ref[1,4,1,0]=(-0.146287867383)/(o+1.)+(-0.908951868158)+(0.425691754878)*0.5**o
        ref[1,4,1,1]=(-0.94160416554)/(o+1.)+(0.0459877010016)+(-0.869872381431)*0.5**o
        ref[1,4,2,0]=(0.0115742858952)/(o+1.)+(-0.222488399041)+(0.687392452389)*0.5**o
        ref[1,4,2,1]=(-0.956561936575)/(o+1.)+(-0.59770879042)+(-0.0613652834159)*0.5**o
        ref[2,0,0,0]=(1.83987381729)/(o+1.)+(0.956579317963)+(0.862634531274)*0.5**o
        ref[2,0,0,1]=(0.105446127421)/(o+1.)+(0.180661881191)+(0.186629121375)*0.5**o
        ref[2,0,1,0]=(0.0212167440766)/(o+1.)+(-0.337825588888)+(-0.318943328859)*0.5**o
        ref[2,0,1,1]=(0.744834715631)/(o+1.)+(-0.350058416663)+(0.391466726104)*0.5**o
        ref[2,0,2,0]=(-0.788776613856)/(o+1.)+(0.233776806014)+(0.400043748043)*0.5**o
        ref[2,0,2,1]=(-0.95346976307)/(o+1.)+(0.0274998652324)+(-0.967971238003)*0.5**o
        ref[2,1,0,0]=(-0.536051408942)/(o+1.)+(-0.208498016994)+(0.590315312233)*0.5**o
        ref[2,1,0,1]=(-1.04158508788)/(o+1.)+(-0.397885793101)+(0.0127762955396)*0.5**o
        ref[2,1,1,0]=(0.529914207253)/(o+1.)+(-0.547503443987)+(-0.338873793431)*0.5**o
        ref[2,1,1,1]=(0.62298670274)/(o+1.)+(0.449860048786)+(0.352800726478)*0.5**o
        ref[2,1,2,0]=(0.965292650595)/(o+1.)+(0.00980498639)+(-0.261085873742)*0.5**o
        ref[2,1,2,1]=(0.403285360803)/(o+1.)+(0.369160592269)+(0.315744874774)*0.5**o
        ref[2,2,0,0]=(-0.457764884724)/(o+1.)+(0.563657776706)+(-0.791018976541)*0.5**o
        ref[2,2,0,1]=(0.188151274044)/(o+1.)+(-0.476470545911)+(0.911736564588)*0.5**o
        ref[2,2,1,0]=(-0.558515085739)/(o+1.)+(-0.445583796553)+(-0.533721159994)*0.5**o
        ref[2,2,1,1]=(-0.431992337265)/(o+1.)+(-0.0957726221961)+(0.64441532924)*0.5**o
        ref[2,2,2,0]=(-0.159056461947)/(o+1.)+(-0.0326864536156)+(0.484856087693)*0.5**o
        ref[2,2,2,1]=(0.533116456037)/(o+1.)+(1.10197257725)+(0.0353311991352)*0.5**o
        ref[2,3,0,0]=(0.0570625147023)/(o+1.)+(0.74170779854)+(0.851019670777)*0.5**o
        ref[2,3,0,1]=(-0.495059904832)/(o+1.)+(-0.169954912181)+(-0.761839138623)*0.5**o
        ref[2,3,1,0]=(0.482375173314)/(o+1.)+(-0.19374838651)+(0.706371811996)*0.5**o
        ref[2,3,1,1]=(0.12928100721)/(o+1.)+(-0.317327862062)+(-0.460946532077)*0.5**o
        ref[2,3,2,0]=(-0.234362084763)/(o+1.)+(0.423486279181)+(-0.93141377227)*0.5**o
        ref[2,3,2,1]=(1.25586693002)/(o+1.)+(-0.127551329993)+(0.56508002092)*0.5**o
        ref[2,4,0,0]=(0.45235297749)/(o+1.)+(-0.0217537364788)+(-0.640413752615)*0.5**o
        ref[2,4,0,1]=(0.936809207384)/(o+1.)+(-0.151519610695)+(-0.464139056331)*0.5**o
        ref[2,4,1,0]=(0.867693208863)/(o+1.)+(0.105683574314)+(-0.974513946233)*0.5**o
        ref[2,4,1,1]=(-1.27821575101)/(o+1.)+(0.463163847311)+(-0.0852880510814)*0.5**o
        ref[2,4,2,0]=(-0.846224501366)/(o+1.)+(0.432619461409)+(0.492845548002)*0.5**o
        ref[2,4,2,1]=(-1.48923229995)/(o+1.)+(-0.505747396375)+(0.00916577472118)*0.5**o
        ref[3,0,0,0]=(-0.959215731121)/(o+1.)+(-0.904609108587)+(-0.178668510268)*0.5**o
        ref[3,0,0,1]=(-1.53181231865)/(o+1.)+(-0.0758543610408)+(0.878717376536)*0.5**o
        ref[3,0,1,0]=(1.18643238831)/(o+1.)+(-0.288825159097)+(-0.341112240015)*0.5**o
        ref[3,0,1,1]=(-0.0675694917031)/(o+1.)+(-0.168955703616)+(0.275309686724)*0.5**o
        ref[3,0,2,0]=(-0.663269860133)/(o+1.)+(-0.235102421885)+(-0.573480403148)*0.5**o
        ref[3,0,2,1]=(1.0969289778)/(o+1.)+(0.46603172821)+(0.267894209932)*0.5**o
        ref[3,1,0,0]=(-0.716870513559)/(o+1.)+(0.712039409283)+(0.483098591635)*0.5**o
        ref[3,1,0,1]=(0.0328531999411)/(o+1.)+(0.379319450988)+(0.311973567308)*0.5**o
        ref[3,1,1,0]=(1.08648208064)/(o+1.)+(-0.196831959338)+(-0.452172980519)*0.5**o
        ref[3,1,1,1]=(0.0813181502612)/(o+1.)+(-0.227364064527)+(-0.0225656152548)*0.5**o
        ref[3,1,2,0]=(-0.271000454408)/(o+1.)+(-0.765711687155)+(0.868748696531)*0.5**o
        ref[3,1,2,1]=(1.60569646253)/(o+1.)+(0.137437739736)+(-0.00288127709197)*0.5**o
        ref[3,2,0,0]=(-1.25887089059)/(o+1.)+(-0.525842290945)+(0.455112921376)*0.5**o
        ref[3,2,0,1]=(-1.63787880725)/(o+1.)+(0.00214706725405)+(-0.166789085722)*0.5**o
        ref[3,2,1,0]=(-1.82111307894)/(o+1.)+(0.561806270366)+(0.388444921454)*0.5**o
        ref[3,2,1,1]=(-0.489259906414)/(o+1.)+(0.582548398381)+(0.417676141947)*0.5**o
        ref[3,2,2,0]=(-0.0674375340391)/(o+1.)+(-0.00345549227349)+(0.362946003887)*0.5**o
        ref[3,2,2,1]=(0.662780682001)/(o+1.)+(-0.15453848218)+(0.806022459534)*0.5**o
        ref[3,3,0,0]=(-1.15795406515)/(o+1.)+(0.0926725746467)+(0.289849779118)*0.5**o
        ref[3,3,0,1]=(1.27520269547)/(o+1.)+(-0.286529818361)+(0.672556345847)*0.5**o
        ref[3,3,1,0]=(-0.343290651469)/(o+1.)+(-0.0269962100904)+(-0.845847188189)*0.5**o
        ref[3,3,1,1]=(0.497715053371)/(o+1.)+(-0.158577177766)+(-0.909200821866)*0.5**o
        ref[3,3,2,0]=(-0.952431538662)/(o+1.)+(0.0816482063045)+(-0.580984656952)*0.5**o
        ref[3,3,2,1]=(-0.176227469799)/(o+1.)+(0.0456157853688)+(-0.0677878495767)*0.5**o
        ref[3,4,0,0]=(0.976460483802)/(o+1.)+(0.347595506011)+(0.766866468871)*0.5**o
        ref[3,4,0,1]=(0.0358170327662)/(o+1.)+(-0.0991456259778)+(0.931548717473)*0.5**o
        ref[3,4,1,0]=(0.114544318514)/(o+1.)+(-0.201014865792)+(-0.272213093635)*0.5**o
        ref[3,4,1,1]=(0.554509925385)/(o+1.)+(1.23219332557)+(0.237338557994)*0.5**o
        ref[3,4,2,0]=(0.0803465444931)/(o+1.)+(-0.518257569997)+(-0.681164419371)*0.5**o
        ref[3,4,2,1]=(-0.0443609570522)/(o+1.)+(0.572813368096)+(0.552725372202)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_FunctionOnContactZero_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.114918917602)*x[0]**o+(0.304834778607)*x[0]+(0.704057176139)*x[1]**o+(-0.0664624375434)*x[1]
        ref=(0.704057176139)/(o+1.)+(0.119186170532)+(-0.114918917602)*0.5**o
      else:
        arg=(-0.134961573162)*x[0]**o+(0.585433861814)*x[0]+(0.209596676649)*x[1]**o+(0.870867416311)*x[1]+(-0.902854033973)*x[2]**o+(-0.812135783993)*x[2]
        ref=(-0.693257357324)/(o+1.)+(0.322082747066)+(-0.134961573162)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_FunctionOnContactZero_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.441677901994)*x[0]**o+(0.0234076994082)*x[0]+(-0.520465368981)*x[1]**o+(-0.668717137452)*x[1]
        arg[1]=(0.0637451453664)*x[0]**o+(0.610543665309)*x[0]+(0.639008465664)*x[1]**o+(-0.460500756968)*x[1]
        ref[0]=(-0.520465368981)/(o+1.)+(-0.322654719022)+(0.441677901994)*0.5**o
        ref[1]=(0.639008465664)/(o+1.)+(0.0750214541708)+(0.0637451453664)*0.5**o
      else:
        arg[0]=(0.207042421638)*x[0]**o+(0.586067682859)*x[0]+(-0.731189752251)*x[1]**o+(0.439755444977)*x[1]+(-0.215027146515)*x[2]**o+(-0.22109699198)*x[2]
        arg[1]=(-0.482897746923)*x[0]**o+(-0.262848758384)*x[0]+(-0.130231246709)*x[1]**o+(0.494143899685)*x[1]+(0.871226664446)*x[2]**o+(-0.45136577521)*x[2]
        ref[0]=(-0.946216898767)/(o+1.)+(0.402363067928)+(0.207042421638)*0.5**o
        ref[1]=(0.740995417737)/(o+1.)+(-0.110035316955)+(-0.482897746923)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_FunctionOnContactZero_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(0.418217706031)*x[0]**o+(0.817101274679)*x[0]+(0.359227724634)*x[1]**o+(0.106952446872)*x[1]
        arg[0,1]=(0.735477258623)*x[0]**o+(-0.181692404492)*x[0]+(0.118248218763)*x[1]**o+(0.910033225874)*x[1]
        arg[0,2]=(-0.370301174151)*x[0]**o+(0.421589410528)*x[0]+(-0.91974297037)*x[1]**o+(0.676441845707)*x[1]
        arg[0,3]=(0.170535646217)*x[0]**o+(0.650458506701)*x[0]+(-0.431898202846)*x[1]**o+(-0.89133664224)*x[1]
        arg[0,4]=(-0.288793192482)*x[0]**o+(-0.752066662422)*x[0]+(0.279565184651)*x[1]**o+(-0.20569858505)*x[1]
        arg[1,0]=(-0.831478902729)*x[0]**o+(-0.545347589281)*x[0]+(-0.315738709444)*x[1]**o+(-0.407156023524)*x[1]
        arg[1,1]=(0.119396512736)*x[0]**o+(0.56655186098)*x[0]+(0.798206239231)*x[1]**o+(0.0342467197178)*x[1]
        arg[1,2]=(-0.264721761214)*x[0]**o+(-0.7583989175)*x[0]+(-0.350411882147)*x[1]**o+(-0.556879396863)*x[1]
        arg[1,3]=(0.976029513102)*x[0]**o+(-0.117830794452)*x[0]+(0.318067419468)*x[1]**o+(-0.496129688948)*x[1]
        arg[1,4]=(0.462797018845)*x[0]**o+(-0.214502973992)*x[0]+(0.155052684044)*x[1]**o+(0.264794267973)*x[1]
        arg[2,0]=(0.193892132778)*x[0]**o+(-0.440406597181)*x[0]+(0.527330868842)*x[1]**o+(0.856602716155)*x[1]
        arg[2,1]=(0.0418968976051)*x[0]**o+(0.944283628708)*x[0]+(0.923548919008)*x[1]**o+(0.958011594347)*x[1]
        arg[2,2]=(0.744026460715)*x[0]**o+(0.238896690247)*x[0]+(0.968891312128)*x[1]**o+(0.0636831438113)*x[1]
        arg[2,3]=(-0.289048983574)*x[0]**o+(0.897469203226)*x[0]+(0.948131139828)*x[1]**o+(0.821749060686)*x[1]
        arg[2,4]=(-0.903766144138)*x[0]**o+(-0.453139974489)*x[0]+(-0.715818671181)*x[1]**o+(-0.712367492971)*x[1]
        arg[3,0]=(0.315277263598)*x[0]**o+(-0.676815102073)*x[0]+(0.428704415911)*x[1]**o+(0.54703485039)*x[1]
        arg[3,1]=(-0.301882901745)*x[0]**o+(0.888822293672)*x[0]+(-0.496204235393)*x[1]**o+(0.210598259748)*x[1]
        arg[3,2]=(0.568071178492)*x[0]**o+(-0.552863936415)*x[0]+(0.758619958752)*x[1]**o+(0.520428540448)*x[1]
        arg[3,3]=(0.477425351692)*x[0]**o+(-0.427405588029)*x[0]+(0.197959279245)*x[1]**o+(0.328047998649)*x[1]
        arg[3,4]=(-0.869704203328)*x[0]**o+(-0.0825164966999)*x[0]+(0.779325592334)*x[1]**o+(0.419916607608)*x[1]
        ref[0,0]=(0.359227724634)/(o+1.)+(0.462026860776)+(0.418217706031)*0.5**o
        ref[0,1]=(0.118248218763)/(o+1.)+(0.364170410691)+(0.735477258623)*0.5**o
        ref[0,2]=(-0.91974297037)/(o+1.)+(0.549015628118)+(-0.370301174151)*0.5**o
        ref[0,3]=(-0.431898202846)/(o+1.)+(-0.120439067769)+(0.170535646217)*0.5**o
        ref[0,4]=(0.279565184651)/(o+1.)+(-0.478882623736)+(-0.288793192482)*0.5**o
        ref[1,0]=(-0.315738709444)/(o+1.)+(-0.476251806402)+(-0.831478902729)*0.5**o
        ref[1,1]=(0.798206239231)/(o+1.)+(0.300399290349)+(0.119396512736)*0.5**o
        ref[1,2]=(-0.350411882147)/(o+1.)+(-0.657639157182)+(-0.264721761214)*0.5**o
        ref[1,3]=(0.318067419468)/(o+1.)+(-0.3069802417)+(0.976029513102)*0.5**o
        ref[1,4]=(0.155052684044)/(o+1.)+(0.02514564699)+(0.462797018845)*0.5**o
        ref[2,0]=(0.527330868842)/(o+1.)+(0.208098059487)+(0.193892132778)*0.5**o
        ref[2,1]=(0.923548919008)/(o+1.)+(0.951147611528)+(0.0418968976051)*0.5**o
        ref[2,2]=(0.968891312128)/(o+1.)+(0.151289917029)+(0.744026460715)*0.5**o
        ref[2,3]=(0.948131139828)/(o+1.)+(0.859609131956)+(-0.289048983574)*0.5**o
        ref[2,4]=(-0.715818671181)/(o+1.)+(-0.58275373373)+(-0.903766144138)*0.5**o
        ref[3,0]=(0.428704415911)/(o+1.)+(-0.0648901258416)+(0.315277263598)*0.5**o
        ref[3,1]=(-0.496204235393)/(o+1.)+(0.54971027671)+(-0.301882901745)*0.5**o
        ref[3,2]=(0.758619958752)/(o+1.)+(-0.0162176979831)+(0.568071178492)*0.5**o
        ref[3,3]=(0.197959279245)/(o+1.)+(-0.0496787946897)+(0.477425351692)*0.5**o
        ref[3,4]=(0.779325592334)/(o+1.)+(0.168700055454)+(-0.869704203328)*0.5**o
      else:
        arg[0,0]=(0.204452789147)*x[0]**o+(0.411843111144)*x[0]+(-0.0502866367412)*x[1]**o+(0.957356261522)*x[1]+(0.173522462943)*x[2]**o+(-0.0194908382525)*x[2]
        arg[0,1]=(-0.49641528149)*x[0]**o+(0.158625922243)*x[0]+(0.670932733725)*x[1]**o+(-0.611829064862)*x[1]+(0.758373881782)*x[2]**o+(0.151236368375)*x[2]
        arg[0,2]=(0.577504765611)*x[0]**o+(0.872996499874)*x[0]+(-0.734000014722)*x[1]**o+(-0.890824538872)*x[1]+(-0.796786080271)*x[2]**o+(-0.389005562901)*x[2]
        arg[0,3]=(-0.933166619447)*x[0]**o+(-0.528627639194)*x[0]+(-0.828111326322)*x[1]**o+(0.528345547301)*x[1]+(0.99894455165)*x[2]**o+(0.472982583662)*x[2]
        arg[0,4]=(-0.495503045054)*x[0]**o+(0.629909217292)*x[0]+(0.901515784751)*x[1]**o+(-0.863668288904)*x[1]+(0.76892679355)*x[2]**o+(0.34730747389)*x[2]
        arg[1,0]=(0.303189803506)*x[0]**o+(-0.17543401741)*x[0]+(-0.283157585975)*x[1]**o+(0.950171529024)*x[1]+(0.0483247572497)*x[2]**o+(-0.604332298954)*x[2]
        arg[1,1]=(-0.225480407643)*x[0]**o+(-0.0521067696425)*x[0]+(-0.10259234894)*x[1]**o+(0.373551917005)*x[1]+(0.89047195372)*x[2]**o+(-0.292740890417)*x[2]
        arg[1,2]=(-0.476041156832)*x[0]**o+(0.916078681628)*x[0]+(-0.393887610676)*x[1]**o+(-0.651852504525)*x[1]+(0.611404175606)*x[2]**o+(0.336594647903)*x[2]
        arg[1,3]=(-0.415178048882)*x[0]**o+(0.145394549559)*x[0]+(0.680115054186)*x[1]**o+(0.261517386893)*x[1]+(0.781566117396)*x[2]**o+(-0.659634539391)*x[2]
        arg[1,4]=(0.874821341857)*x[0]**o+(0.317418381126)*x[0]+(0.051455923305)*x[1]**o+(0.670170143071)*x[1]+(-0.211902435336)*x[2]**o+(-0.175299130233)*x[2]
        arg[2,0]=(-0.372961546517)*x[0]**o+(0.199493150648)*x[0]+(-0.630239499285)*x[1]**o+(0.657412283442)*x[1]+(-0.82211915324)*x[2]**o+(-0.468612977158)*x[2]
        arg[2,1]=(-0.503168527887)*x[0]**o+(0.904406483201)*x[0]+(-0.206179628633)*x[1]**o+(0.0787026584997)*x[1]+(0.899590466467)*x[2]**o+(-0.893401768413)*x[2]
        arg[2,2]=(-0.860556408954)*x[0]**o+(0.39021140432)*x[0]+(-0.66425383352)*x[1]**o+(0.287711780417)*x[1]+(0.776884760126)*x[2]**o+(-0.115905192334)*x[2]
        arg[2,3]=(0.461359695993)*x[0]**o+(0.997877835019)*x[0]+(0.0513514112685)*x[1]**o+(-0.904812988908)*x[1]+(-0.903222331838)*x[2]**o+(-0.470185679041)*x[2]
        arg[2,4]=(-0.646560730528)*x[0]**o+(0.10038324067)*x[0]+(0.426753245517)*x[1]**o+(-0.109889624344)*x[1]+(-0.20158193753)*x[2]**o+(0.014258531224)*x[2]
        arg[3,0]=(0.364407704271)*x[0]**o+(0.840519040103)*x[0]+(0.528721642544)*x[1]**o+(-0.853679853614)*x[1]+(0.079836122575)*x[2]**o+(-0.439039178308)*x[2]
        arg[3,1]=(-0.0726491927955)*x[0]**o+(0.217804431494)*x[0]+(-0.454354285545)*x[1]**o+(0.390539936003)*x[1]+(-0.989667912688)*x[2]**o+(-0.0674079606774)*x[2]
        arg[3,2]=(0.62239422825)*x[0]**o+(0.998733716844)*x[0]+(0.796258161536)*x[1]**o+(0.618545466026)*x[1]+(-0.243188896911)*x[2]**o+(-0.677687584224)*x[2]
        arg[3,3]=(0.444073180258)*x[0]**o+(-0.764729326792)*x[0]+(-0.823491453567)*x[1]**o+(0.985393963131)*x[1]+(0.623800470977)*x[2]**o+(0.947328422513)*x[2]
        arg[3,4]=(0.686438920325)*x[0]**o+(0.789760134176)*x[0]+(-0.26011082782)*x[1]**o+(0.0692377043339)*x[1]+(-0.3712894236)*x[2]**o+(-0.542974191103)*x[2]
        ref[0,0]=(0.123235826202)/(o+1.)+(0.674854267207)+(0.204452789147)*0.5**o
        ref[0,1]=(1.42930661551)/(o+1.)+(-0.150983387122)+(-0.49641528149)*0.5**o
        ref[0,2]=(-1.53078609499)/(o+1.)+(-0.203416800949)+(0.577504765611)*0.5**o
        ref[0,3]=(0.170833225328)/(o+1.)+(0.236350245885)+(-0.933166619447)*0.5**o
        ref[0,4]=(1.6704425783)/(o+1.)+(0.0567742011389)+(-0.495503045054)*0.5**o
        ref[1,0]=(-0.234832828725)/(o+1.)+(0.0852026063299)+(0.303189803506)*0.5**o
        ref[1,1]=(0.787879604779)/(o+1.)+(0.0143521284725)+(-0.225480407643)*0.5**o
        ref[1,2]=(0.21751656493)/(o+1.)+(0.300410412503)+(-0.476041156832)*0.5**o
        ref[1,3]=(1.46168117158)/(o+1.)+(-0.126361301469)+(-0.415178048882)*0.5**o
        ref[1,4]=(-0.160446512031)/(o+1.)+(0.406144696982)+(0.874821341857)*0.5**o
        ref[2,0]=(-1.45235865253)/(o+1.)+(0.194146228466)+(-0.372961546517)*0.5**o
        ref[2,1]=(0.693410837835)/(o+1.)+(0.0448536866438)+(-0.503168527887)*0.5**o
        ref[2,2]=(0.112630926606)/(o+1.)+(0.281008996202)+(-0.860556408954)*0.5**o
        ref[2,3]=(-0.85187092057)/(o+1.)+(-0.188560416464)+(0.461359695993)*0.5**o
        ref[2,4]=(0.225171307987)/(o+1.)+(0.00237607377473)+(-0.646560730528)*0.5**o
        ref[3,0]=(0.608557765119)/(o+1.)+(-0.22609999591)+(0.364407704271)*0.5**o
        ref[3,1]=(-1.44402219823)/(o+1.)+(0.27046820341)+(-0.0726491927955)*0.5**o
        ref[3,2]=(0.553069264625)/(o+1.)+(0.469795799323)+(0.62239422825)*0.5**o
        ref[3,3]=(-0.19969098259)/(o+1.)+(0.583996529426)+(0.444073180258)*0.5**o
        ref[3,4]=(-0.631400251421)/(o+1.)+(0.158011823704)+(0.686438920325)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_FunctionOnContactZero_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.963014866001)*x[0]**o+(-0.592091539519)*x[0]+(0.397897510985)*x[1]**o+(0.485612885034)*x[1]
        arg[0,0,1]=(-0.764849027936)*x[0]**o+(0.936217923087)*x[0]+(-0.6256860991)*x[1]**o+(0.162359755936)*x[1]
        arg[0,1,0]=(-0.269607090458)*x[0]**o+(0.197100067821)*x[0]+(-0.216513043667)*x[1]**o+(0.143038940436)*x[1]
        arg[0,1,1]=(-0.432206914977)*x[0]**o+(0.177851208963)*x[0]+(0.0477652910843)*x[1]**o+(0.278333389583)*x[1]
        arg[1,0,0]=(-0.123940629628)*x[0]**o+(0.818553665062)*x[0]+(-0.168322144522)*x[1]**o+(0.485324994762)*x[1]
        arg[1,0,1]=(0.593609516922)*x[0]**o+(0.530508390905)*x[0]+(-0.938421636915)*x[1]**o+(-0.686459217917)*x[1]
        arg[1,1,0]=(-0.874022523162)*x[0]**o+(0.694500749056)*x[0]+(-0.650951516798)*x[1]**o+(0.45826621855)*x[1]
        arg[1,1,1]=(-0.259058106634)*x[0]**o+(0.0837282545694)*x[0]+(0.465734884341)*x[1]**o+(0.185558060279)*x[1]
        arg[2,0,0]=(0.346292866419)*x[0]**o+(0.982902010078)*x[0]+(0.0297606445334)*x[1]**o+(0.339043518987)*x[1]
        arg[2,0,1]=(0.749684718966)*x[0]**o+(-0.855799436867)*x[0]+(-0.186333913876)*x[1]**o+(-0.548968316245)*x[1]
        arg[2,1,0]=(-0.255759466052)*x[0]**o+(0.441882703647)*x[0]+(-0.0239807362322)*x[1]**o+(-0.236417762222)*x[1]
        arg[2,1,1]=(-0.0586694299212)*x[0]**o+(-0.912208422332)*x[0]+(-0.11610871626)*x[1]**o+(-0.512805786403)*x[1]
        arg[3,0,0]=(0.826027179564)*x[0]**o+(-0.589876767386)*x[0]+(-0.654858828463)*x[1]**o+(0.601656609023)*x[1]
        arg[3,0,1]=(-0.148714999203)*x[0]**o+(-0.409138795316)*x[0]+(0.290726299307)*x[1]**o+(-0.94009130345)*x[1]
        arg[3,1,0]=(0.63431415979)*x[0]**o+(-0.184553980231)*x[0]+(0.4087395755)*x[1]**o+(-0.694376406449)*x[1]
        arg[3,1,1]=(-0.000928514830108)*x[0]**o+(-0.782814501236)*x[0]+(0.177390244103)*x[1]**o+(0.698562703841)*x[1]
        arg[4,0,0]=(-0.939264907756)*x[0]**o+(0.191360117367)*x[0]+(-0.318750748728)*x[1]**o+(0.910713477162)*x[1]
        arg[4,0,1]=(-0.105186863713)*x[0]**o+(0.0319652211881)*x[0]+(0.118896230389)*x[1]**o+(-0.212677289177)*x[1]
        arg[4,1,0]=(-0.702838100428)*x[0]**o+(0.881695294345)*x[0]+(0.728231539571)*x[1]**o+(-0.192311604244)*x[1]
        arg[4,1,1]=(0.25197450886)*x[0]**o+(0.464857988125)*x[0]+(0.851996888259)*x[1]**o+(-0.408525083481)*x[1]
        arg[5,0,0]=(0.665627182446)*x[0]**o+(0.5367740452)*x[0]+(0.295800616406)*x[1]**o+(0.0620589956995)*x[1]
        arg[5,0,1]=(-0.37320168697)*x[0]**o+(0.072855481498)*x[0]+(0.539806161326)*x[1]**o+(-0.999091813027)*x[1]
        arg[5,1,0]=(-0.060845772709)*x[0]**o+(-0.931869215952)*x[0]+(-0.393477853475)*x[1]**o+(0.968288081996)*x[1]
        arg[5,1,1]=(-0.0768045781739)*x[0]**o+(-0.257318730887)*x[0]+(0.781473167319)*x[1]**o+(-0.458870794544)*x[1]
        ref[0,0,0]=(0.397897510985)/(o+1.)+(-0.0532393272425)+(-0.963014866001)*0.5**o
        ref[0,0,1]=(-0.6256860991)/(o+1.)+(0.549288839511)+(-0.764849027936)*0.5**o
        ref[0,1,0]=(-0.216513043667)/(o+1.)+(0.170069504128)+(-0.269607090458)*0.5**o
        ref[0,1,1]=(0.0477652910843)/(o+1.)+(0.228092299273)+(-0.432206914977)*0.5**o
        ref[1,0,0]=(-0.168322144522)/(o+1.)+(0.651939329912)+(-0.123940629628)*0.5**o
        ref[1,0,1]=(-0.938421636915)/(o+1.)+(-0.0779754135063)+(0.593609516922)*0.5**o
        ref[1,1,0]=(-0.650951516798)/(o+1.)+(0.576383483803)+(-0.874022523162)*0.5**o
        ref[1,1,1]=(0.465734884341)/(o+1.)+(0.134643157424)+(-0.259058106634)*0.5**o
        ref[2,0,0]=(0.0297606445334)/(o+1.)+(0.660972764533)+(0.346292866419)*0.5**o
        ref[2,0,1]=(-0.186333913876)/(o+1.)+(-0.702383876556)+(0.749684718966)*0.5**o
        ref[2,1,0]=(-0.0239807362322)/(o+1.)+(0.102732470713)+(-0.255759466052)*0.5**o
        ref[2,1,1]=(-0.11610871626)/(o+1.)+(-0.712507104367)+(-0.0586694299212)*0.5**o
        ref[3,0,0]=(-0.654858828463)/(o+1.)+(0.0058899208184)+(0.826027179564)*0.5**o
        ref[3,0,1]=(0.290726299307)/(o+1.)+(-0.674615049383)+(-0.148714999203)*0.5**o
        ref[3,1,0]=(0.4087395755)/(o+1.)+(-0.43946519334)+(0.63431415979)*0.5**o
        ref[3,1,1]=(0.177390244103)/(o+1.)+(-0.0421258986973)+(-0.000928514830108)*0.5**o
        ref[4,0,0]=(-0.318750748728)/(o+1.)+(0.551036797264)+(-0.939264907756)*0.5**o
        ref[4,0,1]=(0.118896230389)/(o+1.)+(-0.0903560339946)+(-0.105186863713)*0.5**o
        ref[4,1,0]=(0.728231539571)/(o+1.)+(0.344691845051)+(-0.702838100428)*0.5**o
        ref[4,1,1]=(0.851996888259)/(o+1.)+(0.0281664523221)+(0.25197450886)*0.5**o
        ref[5,0,0]=(0.295800616406)/(o+1.)+(0.29941652045)+(0.665627182446)*0.5**o
        ref[5,0,1]=(0.539806161326)/(o+1.)+(-0.463118165764)+(-0.37320168697)*0.5**o
        ref[5,1,0]=(-0.393477853475)/(o+1.)+(0.0182094330217)+(-0.060845772709)*0.5**o
        ref[5,1,1]=(0.781473167319)/(o+1.)+(-0.358094762716)+(-0.0768045781739)*0.5**o
      else:
        arg[0,0,0]=(0.638389367885)*x[0]**o+(-0.77703387527)*x[0]+(0.951496212227)*x[1]**o+(-0.484305156823)*x[1]+(-0.582437996275)*x[2]**o+(-0.460130065965)*x[2]
        arg[0,0,1]=(0.859011160063)*x[0]**o+(0.999372374168)*x[0]+(-0.946049724069)*x[1]**o+(0.522184535496)*x[1]+(0.00820405492191)*x[2]**o+(0.769305042211)*x[2]
        arg[0,1,0]=(-0.998681640062)*x[0]**o+(0.916063974594)*x[0]+(0.0801858148899)*x[1]**o+(0.475476401258)*x[1]+(-0.805247247843)*x[2]**o+(-0.809331278141)*x[2]
        arg[0,1,1]=(0.1340261052)*x[0]**o+(0.843204972218)*x[0]+(-0.809433597166)*x[1]**o+(-0.947798215446)*x[1]+(0.268796347717)*x[2]**o+(-0.896620567629)*x[2]
        arg[1,0,0]=(0.251201824008)*x[0]**o+(0.762438451805)*x[0]+(0.892722429031)*x[1]**o+(0.146944927124)*x[1]+(0.00953973207152)*x[2]**o+(0.423262196414)*x[2]
        arg[1,0,1]=(-0.258843593921)*x[0]**o+(-0.950574260099)*x[0]+(-0.49096256134)*x[1]**o+(0.446238902975)*x[1]+(-0.880706204083)*x[2]**o+(-0.400075002454)*x[2]
        arg[1,1,0]=(-0.854529145157)*x[0]**o+(0.118165533114)*x[0]+(-0.913218271084)*x[1]**o+(0.991977570414)*x[1]+(0.626241160161)*x[2]**o+(0.667843914102)*x[2]
        arg[1,1,1]=(0.636818650335)*x[0]**o+(-0.174996100829)*x[0]+(0.77317621688)*x[1]**o+(0.369280208456)*x[1]+(-0.0130124322187)*x[2]**o+(0.857098751007)*x[2]
        arg[2,0,0]=(-0.415847479141)*x[0]**o+(0.675986357495)*x[0]+(0.704926614111)*x[1]**o+(-0.166544295134)*x[1]+(-0.00917226654826)*x[2]**o+(-0.896432190739)*x[2]
        arg[2,0,1]=(-0.882383192316)*x[0]**o+(0.11122730635)*x[0]+(-0.693587089789)*x[1]**o+(-0.0905457091132)*x[1]+(-0.610526000157)*x[2]**o+(-0.992542379681)*x[2]
        arg[2,1,0]=(-0.476987072283)*x[0]**o+(-0.450296923812)*x[0]+(0.905270434608)*x[1]**o+(0.976270820516)*x[1]+(-0.233422717373)*x[2]**o+(-0.641253735386)*x[2]
        arg[2,1,1]=(0.873832514958)*x[0]**o+(-0.478059419217)*x[0]+(-0.941650455606)*x[1]**o+(0.307250152442)*x[1]+(0.865160620819)*x[2]**o+(0.961340749451)*x[2]
        arg[3,0,0]=(-0.443837945036)*x[0]**o+(-0.688773058425)*x[0]+(-0.654988618952)*x[1]**o+(-0.259511611372)*x[1]+(-0.931332326494)*x[2]**o+(0.939379631125)*x[2]
        arg[3,0,1]=(-0.181860312567)*x[0]**o+(-0.229066064127)*x[0]+(-0.359408642857)*x[1]**o+(-0.47945907585)*x[1]+(0.312345402782)*x[2]**o+(0.559298232285)*x[2]
        arg[3,1,0]=(-0.372379819015)*x[0]**o+(0.308179383085)*x[0]+(0.123613160006)*x[1]**o+(0.191944822984)*x[1]+(0.950869988808)*x[2]**o+(0.229360419984)*x[2]
        arg[3,1,1]=(-0.803126271269)*x[0]**o+(0.833324260042)*x[0]+(-0.917001746509)*x[1]**o+(-0.649776906898)*x[1]+(0.49624769362)*x[2]**o+(0.414080802594)*x[2]
        arg[4,0,0]=(-0.951747333891)*x[0]**o+(0.5919442178)*x[0]+(0.121310623341)*x[1]**o+(-0.321939845724)*x[1]+(0.358051737083)*x[2]**o+(-0.222801347833)*x[2]
        arg[4,0,1]=(-0.59462534105)*x[0]**o+(0.943860617698)*x[0]+(0.787822231831)*x[1]**o+(-0.0913435772425)*x[1]+(0.831651946729)*x[2]**o+(-0.903604465879)*x[2]
        arg[4,1,0]=(0.68655463207)*x[0]**o+(-0.98918689213)*x[0]+(0.251300089098)*x[1]**o+(-0.317828131349)*x[1]+(-0.105934216764)*x[2]**o+(-0.874506361945)*x[2]
        arg[4,1,1]=(-0.80544616293)*x[0]**o+(-0.321523684723)*x[0]+(0.874455533992)*x[1]**o+(0.200912811442)*x[1]+(-0.646776981862)*x[2]**o+(-0.988728118812)*x[2]
        arg[5,0,0]=(0.413387141328)*x[0]**o+(0.349210032211)*x[0]+(0.80870689028)*x[1]**o+(-0.633296311752)*x[1]+(0.24621029112)*x[2]**o+(0.853398479355)*x[2]
        arg[5,0,1]=(0.398787817372)*x[0]**o+(0.662875239272)*x[0]+(-0.719962467558)*x[1]**o+(0.49562860294)*x[1]+(-0.694859272211)*x[2]**o+(-0.792616661463)*x[2]
        arg[5,1,0]=(-0.298838035128)*x[0]**o+(0.121578680468)*x[0]+(-0.931062588633)*x[1]**o+(-0.0575832984853)*x[1]+(-0.696140085453)*x[2]**o+(0.836738246058)*x[2]
        arg[5,1,1]=(-0.949626960081)*x[0]**o+(-0.449843145228)*x[0]+(-0.304260073311)*x[1]**o+(-0.258880519466)*x[1]+(0.880466679751)*x[2]**o+(0.97505579364)*x[2]
        ref[0,0,0]=(0.369058215952)/(o+1.)+(-0.860734549029)+(0.638389367885)*0.5**o
        ref[0,0,1]=(-0.937845669147)/(o+1.)+(1.14543097594)+(0.859011160063)*0.5**o
        ref[0,1,0]=(-0.725061432954)/(o+1.)+(0.291104548855)+(-0.998681640062)*0.5**o
        ref[0,1,1]=(-0.540637249448)/(o+1.)+(-0.500606905428)+(0.1340261052)*0.5**o
        ref[1,0,0]=(0.902262161102)/(o+1.)+(0.666322787672)+(0.251201824008)*0.5**o
        ref[1,0,1]=(-1.37166876542)/(o+1.)+(-0.452205179789)+(-0.258843593921)*0.5**o
        ref[1,1,0]=(-0.286977110923)/(o+1.)+(0.888993508815)+(-0.854529145157)*0.5**o
        ref[1,1,1]=(0.760163784662)/(o+1.)+(0.525691429317)+(0.636818650335)*0.5**o
        ref[2,0,0]=(0.695754347563)/(o+1.)+(-0.193495064189)+(-0.415847479141)*0.5**o
        ref[2,0,1]=(-1.30411308995)/(o+1.)+(-0.485930391222)+(-0.882383192316)*0.5**o
        ref[2,1,0]=(0.671847717235)/(o+1.)+(-0.0576399193408)+(-0.476987072283)*0.5**o
        ref[2,1,1]=(-0.0764898347868)/(o+1.)+(0.395265741338)+(0.873832514958)*0.5**o
        ref[3,0,0]=(-1.58632094545)/(o+1.)+(-0.00445251933618)+(-0.443837945036)*0.5**o
        ref[3,0,1]=(-0.0470632400747)/(o+1.)+(-0.0746134538458)+(-0.181860312567)*0.5**o
        ref[3,1,0]=(1.07448314881)/(o+1.)+(0.364742313027)+(-0.372379819015)*0.5**o
        ref[3,1,1]=(-0.420754052889)/(o+1.)+(0.298814077869)+(-0.803126271269)*0.5**o
        ref[4,0,0]=(0.479362360424)/(o+1.)+(0.0236015121217)+(-0.951747333891)*0.5**o
        ref[4,0,1]=(1.61947417856)/(o+1.)+(-0.0255437127116)+(-0.59462534105)*0.5**o
        ref[4,1,0]=(0.145365872334)/(o+1.)+(-1.09076069271)+(0.68655463207)*0.5**o
        ref[4,1,1]=(0.22767855213)/(o+1.)+(-0.554669496046)+(-0.80544616293)*0.5**o
        ref[5,0,0]=(1.0549171814)/(o+1.)+(0.284656099907)+(0.413387141328)*0.5**o
        ref[5,0,1]=(-1.41482173977)/(o+1.)+(0.182943590374)+(0.398787817372)*0.5**o
        ref[5,1,0]=(-1.62720267409)/(o+1.)+(0.450366814021)+(-0.298838035128)*0.5**o
        ref[5,1,1]=(0.576206606439)/(o+1.)+(0.133166064473)+(-0.949626960081)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromData_FunctionOnContactZero_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.392628958003)*x[0]**o+(0.186084293395)*x[0]+(0.965300679335)*x[1]**o+(0.0986282244747)*x[1]
        arg[0,0,0,1]=(-0.503312425492)*x[0]**o+(-0.205791466802)*x[0]+(0.384782163488)*x[1]**o+(-0.608371097114)*x[1]
        arg[0,0,1,0]=(0.660162511699)*x[0]**o+(-0.263141686561)*x[0]+(-0.765235012795)*x[1]**o+(-0.371233144611)*x[1]
        arg[0,0,1,1]=(-0.986935412732)*x[0]**o+(0.645433351743)*x[0]+(-0.451665346257)*x[1]**o+(-0.713815759872)*x[1]
        arg[0,0,2,0]=(0.632875178502)*x[0]**o+(-0.257542208821)*x[0]+(-0.695553902133)*x[1]**o+(-0.677920876645)*x[1]
        arg[0,0,2,1]=(0.102625648731)*x[0]**o+(0.511896902175)*x[0]+(0.345909088853)*x[1]**o+(-0.0609413722414)*x[1]
        arg[0,1,0,0]=(-0.0108106931425)*x[0]**o+(-0.595497517075)*x[0]+(0.332480141972)*x[1]**o+(-0.18131109924)*x[1]
        arg[0,1,0,1]=(0.220826593491)*x[0]**o+(-0.202422451222)*x[0]+(0.328480565578)*x[1]**o+(0.851432750557)*x[1]
        arg[0,1,1,0]=(0.22735402466)*x[0]**o+(0.51437836535)*x[0]+(0.292927451477)*x[1]**o+(-0.148121856023)*x[1]
        arg[0,1,1,1]=(0.495079875966)*x[0]**o+(0.582755117761)*x[0]+(-0.322061131008)*x[1]**o+(0.953437449986)*x[1]
        arg[0,1,2,0]=(0.968583889554)*x[0]**o+(-0.593253483731)*x[0]+(0.286037351205)*x[1]**o+(0.997314411263)*x[1]
        arg[0,1,2,1]=(0.361498191707)*x[0]**o+(0.633275777697)*x[0]+(0.891305263219)*x[1]**o+(-0.194468605638)*x[1]
        arg[0,2,0,0]=(0.185647566516)*x[0]**o+(0.101448861247)*x[0]+(0.0870608077911)*x[1]**o+(-0.86477908948)*x[1]
        arg[0,2,0,1]=(0.227262327826)*x[0]**o+(0.812586702875)*x[0]+(-0.0229924234496)*x[1]**o+(-0.323581477982)*x[1]
        arg[0,2,1,0]=(0.0405753322301)*x[0]**o+(0.891289727227)*x[0]+(0.957377329048)*x[1]**o+(-0.982119724379)*x[1]
        arg[0,2,1,1]=(-0.546046301701)*x[0]**o+(0.628511534929)*x[0]+(-0.628262263897)*x[1]**o+(-0.454315708999)*x[1]
        arg[0,2,2,0]=(-0.828455793175)*x[0]**o+(0.190147126828)*x[0]+(0.499595322279)*x[1]**o+(-0.0882297087937)*x[1]
        arg[0,2,2,1]=(0.926138085222)*x[0]**o+(0.402659001583)*x[0]+(-0.678432418122)*x[1]**o+(0.236054704896)*x[1]
        arg[0,3,0,0]=(-0.473066058658)*x[0]**o+(0.57622727181)*x[0]+(0.62665109546)*x[1]**o+(0.948409659533)*x[1]
        arg[0,3,0,1]=(0.776790978673)*x[0]**o+(-0.0244752180934)*x[0]+(-0.459252843816)*x[1]**o+(0.616203849528)*x[1]
        arg[0,3,1,0]=(0.34783214571)*x[0]**o+(0.806528120142)*x[0]+(0.445864469556)*x[1]**o+(-0.221961922099)*x[1]
        arg[0,3,1,1]=(0.0717966037463)*x[0]**o+(-0.434117388366)*x[0]+(0.577708844669)*x[1]**o+(-0.548519157145)*x[1]
        arg[0,3,2,0]=(-0.548573971799)*x[0]**o+(-0.926704595492)*x[0]+(-0.33936340707)*x[1]**o+(0.0687290934591)*x[1]
        arg[0,3,2,1]=(-0.28309240461)*x[0]**o+(0.12914675768)*x[0]+(-0.833323497891)*x[1]**o+(-0.577727985559)*x[1]
        arg[0,4,0,0]=(-0.105416428922)*x[0]**o+(0.41564239907)*x[0]+(0.146657173319)*x[1]**o+(-0.0141417271845)*x[1]
        arg[0,4,0,1]=(-0.876111094069)*x[0]**o+(0.491957669628)*x[0]+(0.534941970665)*x[1]**o+(-0.995507289274)*x[1]
        arg[0,4,1,0]=(-0.678996394303)*x[0]**o+(0.183159947613)*x[0]+(-0.739368558349)*x[1]**o+(0.274319401135)*x[1]
        arg[0,4,1,1]=(0.0472145581152)*x[0]**o+(-0.669737608207)*x[0]+(-0.651647023142)*x[1]**o+(0.351208329111)*x[1]
        arg[0,4,2,0]=(0.114936857967)*x[0]**o+(0.564688790898)*x[0]+(-0.524234284672)*x[1]**o+(-0.127615425724)*x[1]
        arg[0,4,2,1]=(0.568834117773)*x[0]**o+(-0.936513147599)*x[0]+(0.133122220811)*x[1]**o+(0.31510090512)*x[1]
        arg[1,0,0,0]=(-0.821241886235)*x[0]**o+(0.779734235239)*x[0]+(-0.132449009841)*x[1]**o+(-0.0179700618848)*x[1]
        arg[1,0,0,1]=(0.624372422235)*x[0]**o+(-0.752831611955)*x[0]+(-0.573597121344)*x[1]**o+(0.376463665377)*x[1]
        arg[1,0,1,0]=(-0.568749808355)*x[0]**o+(-0.697521100346)*x[0]+(-0.249786553024)*x[1]**o+(-0.624593568423)*x[1]
        arg[1,0,1,1]=(0.0765557360835)*x[0]**o+(-0.744005823966)*x[0]+(0.59246455477)*x[1]**o+(0.231310687774)*x[1]
        arg[1,0,2,0]=(0.909614864187)*x[0]**o+(0.350543076144)*x[0]+(0.0689432766231)*x[1]**o+(-0.88465698758)*x[1]
        arg[1,0,2,1]=(0.0610206203468)*x[0]**o+(0.620401328094)*x[0]+(0.378273922837)*x[1]**o+(0.91988744934)*x[1]
        arg[1,1,0,0]=(0.917249169051)*x[0]**o+(0.756656473206)*x[0]+(0.728786835113)*x[1]**o+(0.116994159781)*x[1]
        arg[1,1,0,1]=(0.331129708654)*x[0]**o+(-0.14342302905)*x[0]+(-0.418402258918)*x[1]**o+(-0.808676850609)*x[1]
        arg[1,1,1,0]=(-0.527408405279)*x[0]**o+(-0.671440239997)*x[0]+(0.989603613532)*x[1]**o+(0.364280392731)*x[1]
        arg[1,1,1,1]=(-0.189543145217)*x[0]**o+(0.14762392216)*x[0]+(0.11459047938)*x[1]**o+(-0.760477267267)*x[1]
        arg[1,1,2,0]=(0.385274935809)*x[0]**o+(0.527744200995)*x[0]+(-0.862654310338)*x[1]**o+(0.904005467598)*x[1]
        arg[1,1,2,1]=(-0.380421555378)*x[0]**o+(0.598300323394)*x[0]+(-0.541819816686)*x[1]**o+(0.446934572528)*x[1]
        arg[1,2,0,0]=(0.446781075767)*x[0]**o+(0.906830344178)*x[0]+(0.158734254777)*x[1]**o+(-0.722982586936)*x[1]
        arg[1,2,0,1]=(0.927811104869)*x[0]**o+(-0.446795135388)*x[0]+(-0.90301726295)*x[1]**o+(0.289530807979)*x[1]
        arg[1,2,1,0]=(0.741527109588)*x[0]**o+(-0.370029728344)*x[0]+(0.157695458386)*x[1]**o+(-0.620804465293)*x[1]
        arg[1,2,1,1]=(0.193242816889)*x[0]**o+(0.455789913444)*x[0]+(0.0491001091271)*x[1]**o+(-0.942127264151)*x[1]
        arg[1,2,2,0]=(0.220709813709)*x[0]**o+(-0.713472965425)*x[0]+(-0.736262418061)*x[1]**o+(0.341347605023)*x[1]
        arg[1,2,2,1]=(0.0034506429721)*x[0]**o+(0.397289753453)*x[0]+(-0.167013881353)*x[1]**o+(0.390364445974)*x[1]
        arg[1,3,0,0]=(0.321471168172)*x[0]**o+(-0.237896433618)*x[0]+(-0.199843421009)*x[1]**o+(0.811319091471)*x[1]
        arg[1,3,0,1]=(-0.0799622908037)*x[0]**o+(-0.66155883346)*x[0]+(0.0303112997369)*x[1]**o+(-0.199256497975)*x[1]
        arg[1,3,1,0]=(-0.12051943489)*x[0]**o+(0.674374603779)*x[0]+(0.335933608833)*x[1]**o+(0.366671959553)*x[1]
        arg[1,3,1,1]=(-0.587242845986)*x[0]**o+(-0.495652656487)*x[0]+(0.10609614346)*x[1]**o+(0.177210588935)*x[1]
        arg[1,3,2,0]=(0.947782336638)*x[0]**o+(-0.327283099142)*x[0]+(-0.0280648836948)*x[1]**o+(0.133334543825)*x[1]
        arg[1,3,2,1]=(-0.0887414134508)*x[0]**o+(0.640694455701)*x[0]+(0.266916366237)*x[1]**o+(0.345886606493)*x[1]
        arg[1,4,0,0]=(-0.138184872938)*x[0]**o+(0.658635897645)*x[0]+(-0.00526240442626)*x[1]**o+(0.800443113371)*x[1]
        arg[1,4,0,1]=(-0.549831917928)*x[0]**o+(-0.666733703837)*x[0]+(0.400982699808)*x[1]**o+(0.739099662817)*x[1]
        arg[1,4,1,0]=(-0.137046722563)*x[0]**o+(-0.818450480933)*x[0]+(-0.827665726293)*x[1]**o+(-0.286585607624)*x[1]
        arg[1,4,1,1]=(-0.474156202572)*x[0]**o+(-0.855381707793)*x[0]+(0.113318564035)*x[1]**o+(0.218410511108)*x[1]
        arg[1,4,2,0]=(0.18476112439)*x[0]**o+(-0.964533442641)*x[0]+(-0.968611931598)*x[1]**o+(0.0973026144203)*x[1]
        arg[1,4,2,1]=(-0.372995418552)*x[0]**o+(0.998322146553)*x[0]+(-0.384672070744)*x[1]**o+(0.47536977268)*x[1]
        arg[2,0,0,0]=(0.882400857222)*x[0]**o+(0.455324640128)*x[0]+(0.764297272234)*x[1]**o+(0.498669000791)*x[1]
        arg[2,0,0,1]=(0.894017590794)*x[0]**o+(0.217984119634)*x[0]+(-0.0934000967188)*x[1]**o+(-0.886960376026)*x[1]
        arg[2,0,1,0]=(-0.382158057826)*x[0]**o+(-0.897639065996)*x[0]+(0.819002513335)*x[1]**o+(-0.0739374877518)*x[1]
        arg[2,0,1,1]=(-0.259771272131)*x[0]**o+(-0.533540086977)*x[0]+(0.366917477923)*x[1]**o+(-0.751904525722)*x[1]
        arg[2,0,2,0]=(-0.33946164111)*x[0]**o+(-0.317441178182)*x[0]+(-0.857625945147)*x[1]**o+(-0.84647892719)*x[1]
        arg[2,0,2,1]=(0.153353093148)*x[0]**o+(0.832883645984)*x[0]+(-0.359476461654)*x[1]**o+(0.332390899654)*x[1]
        arg[2,1,0,0]=(0.780980225775)*x[0]**o+(0.619330950566)*x[0]+(0.194312746335)*x[1]**o+(0.595311976655)*x[1]
        arg[2,1,0,1]=(-0.334149973283)*x[0]**o+(-0.670178805858)*x[0]+(-0.313038325156)*x[1]**o+(0.793149618246)*x[1]
        arg[2,1,1,0]=(-0.832852528577)*x[0]**o+(-0.606634692926)*x[0]+(-0.0643816133251)*x[1]**o+(-0.663765987285)*x[1]
        arg[2,1,1,1]=(0.300975732963)*x[0]**o+(0.965431406497)*x[0]+(-0.618456119184)*x[1]**o+(0.459530421885)*x[1]
        arg[2,1,2,0]=(0.122326105776)*x[0]**o+(0.0940802696378)*x[0]+(-0.986852501828)*x[1]**o+(0.370428043236)*x[1]
        arg[2,1,2,1]=(0.447916985436)*x[0]**o+(-0.161926311978)*x[0]+(-0.0933563424166)*x[1]**o+(0.836290263421)*x[1]
        arg[2,2,0,0]=(0.032076347277)*x[0]**o+(-0.447517143643)*x[0]+(-0.053769157756)*x[1]**o+(-0.0242981207801)*x[1]
        arg[2,2,0,1]=(-0.403935703163)*x[0]**o+(-0.960750093184)*x[0]+(-0.287956277998)*x[1]**o+(-0.168614701082)*x[1]
        arg[2,2,1,0]=(-0.205077009492)*x[0]**o+(-0.409536289697)*x[0]+(0.359071620541)*x[1]**o+(-0.466455759025)*x[1]
        arg[2,2,1,1]=(0.443658057141)*x[0]**o+(-0.748681939527)*x[0]+(0.2153167916)*x[1]**o+(-0.475899799738)*x[1]
        arg[2,2,2,0]=(-0.463879681251)*x[0]**o+(0.758317222041)*x[0]+(0.608221916958)*x[1]**o+(-0.237798399085)*x[1]
        arg[2,2,2,1]=(0.533981754168)*x[0]**o+(0.590125912931)*x[0]+(0.8957267808)*x[1]**o+(0.294612478767)*x[1]
        arg[2,3,0,0]=(0.499387701403)*x[0]**o+(0.0379132293822)*x[0]+(0.717384215206)*x[1]**o+(0.754497698503)*x[1]
        arg[2,3,0,1]=(0.866500398882)*x[0]**o+(0.23678788012)*x[0]+(0.395132533716)*x[1]**o+(-0.451619930593)*x[1]
        arg[2,3,1,0]=(-0.879663354176)*x[0]**o+(-0.328937922978)*x[0]+(0.688771917581)*x[1]**o+(-0.87392051489)*x[1]
        arg[2,3,1,1]=(0.291214284356)*x[0]**o+(-0.783159133488)*x[0]+(0.240960084233)*x[1]**o+(0.339043900275)*x[1]
        arg[2,3,2,0]=(0.47064755192)*x[0]**o+(-0.42618815064)*x[0]+(-0.505342655776)*x[1]**o+(0.408218280069)*x[1]
        arg[2,3,2,1]=(0.775731405735)*x[0]**o+(-0.768750178591)*x[0]+(-0.896333275063)*x[1]**o+(0.286558848957)*x[1]
        arg[2,4,0,0]=(-0.7221248688)*x[0]**o+(0.612509823967)*x[0]+(0.436744528143)*x[1]**o+(-0.761502758764)*x[1]
        arg[2,4,0,1]=(-0.742652222385)*x[0]**o+(0.214811997988)*x[0]+(-0.031320962337)*x[1]**o+(-0.320134664789)*x[1]
        arg[2,4,1,0]=(-0.529575527815)*x[0]**o+(0.623770482091)*x[0]+(-0.50790148262)*x[1]**o+(0.629874274271)*x[1]
        arg[2,4,1,1]=(0.535631957883)*x[0]**o+(0.439578618993)*x[0]+(-0.770747718564)*x[1]**o+(0.0798696116058)*x[1]
        arg[2,4,2,0]=(0.81688202721)*x[0]**o+(-0.0301054197201)*x[0]+(0.613495031968)*x[1]**o+(-0.153619455295)*x[1]
        arg[2,4,2,1]=(0.493471708612)*x[0]**o+(0.423626757568)*x[0]+(0.093174141001)*x[1]**o+(0.307452108722)*x[1]
        arg[3,0,0,0]=(-0.0668630243284)*x[0]**o+(-0.577709692979)*x[0]+(0.984307685082)*x[1]**o+(-0.171487030152)*x[1]
        arg[3,0,0,1]=(-0.210452484293)*x[0]**o+(-0.130476372055)*x[0]+(-0.693596086089)*x[1]**o+(-0.692143724329)*x[1]
        arg[3,0,1,0]=(-0.34853285523)*x[0]**o+(-0.369649709966)*x[0]+(0.824648362105)*x[1]**o+(0.733046240399)*x[1]
        arg[3,0,1,1]=(0.861903045965)*x[0]**o+(0.609535692452)*x[0]+(0.681514895836)*x[1]**o+(0.66773275418)*x[1]
        arg[3,0,2,0]=(0.0197670342844)*x[0]**o+(-0.251645539228)*x[0]+(-0.0390293468405)*x[1]**o+(-0.00955605638373)*x[1]
        arg[3,0,2,1]=(-0.499093940395)*x[0]**o+(0.660356623112)*x[0]+(0.969057635866)*x[1]**o+(-0.821377317197)*x[1]
        arg[3,1,0,0]=(-0.955568800095)*x[0]**o+(0.557877698917)*x[0]+(0.829599262959)*x[1]**o+(0.933736802562)*x[1]
        arg[3,1,0,1]=(-0.910307638058)*x[0]**o+(-0.3287646946)*x[0]+(-0.777548579252)*x[1]**o+(-0.971744353969)*x[1]
        arg[3,1,1,0]=(0.22353820834)*x[0]**o+(0.904479243377)*x[0]+(-0.108768166204)*x[1]**o+(0.823767232517)*x[1]
        arg[3,1,1,1]=(0.371995768061)*x[0]**o+(0.747630377273)*x[0]+(0.931152588498)*x[1]**o+(-0.0154330268188)*x[1]
        arg[3,1,2,0]=(0.4567417369)*x[0]**o+(0.424951293892)*x[0]+(-0.14032259215)*x[1]**o+(0.603329614924)*x[1]
        arg[3,1,2,1]=(-0.855100213731)*x[0]**o+(-0.667832882495)*x[0]+(0.942530922378)*x[1]**o+(0.55861156259)*x[1]
        arg[3,2,0,0]=(0.17190936572)*x[0]**o+(-0.904098615762)*x[0]+(0.991497679624)*x[1]**o+(0.373020358381)*x[1]
        arg[3,2,0,1]=(-0.683587206983)*x[0]**o+(0.718257814718)*x[0]+(-0.730243933765)*x[1]**o+(-0.583892189979)*x[1]
        arg[3,2,1,0]=(0.051672736629)*x[0]**o+(-0.991172563807)*x[0]+(0.36605487466)*x[1]**o+(0.680719877794)*x[1]
        arg[3,2,1,1]=(0.438014662973)*x[0]**o+(0.172969450125)*x[0]+(-0.424515284177)*x[1]**o+(0.615315132547)*x[1]
        arg[3,2,2,0]=(-0.709499532674)*x[0]**o+(0.985097212621)*x[0]+(0.326610298255)*x[1]**o+(0.994701669258)*x[1]
        arg[3,2,2,1]=(-0.657647707844)*x[0]**o+(-0.683954483768)*x[0]+(-0.846657945161)*x[1]**o+(0.852308904063)*x[1]
        arg[3,3,0,0]=(0.21346320453)*x[0]**o+(-0.181665119768)*x[0]+(0.549866100727)*x[1]**o+(-0.0858045316871)*x[1]
        arg[3,3,0,1]=(0.249957470685)*x[0]**o+(0.537464773638)*x[0]+(0.0224330511636)*x[1]**o+(0.114623595638)*x[1]
        arg[3,3,1,0]=(0.166507029533)*x[0]**o+(0.232150195873)*x[0]+(0.119453667263)*x[1]**o+(-0.261110960642)*x[1]
        arg[3,3,1,1]=(0.358248720077)*x[0]**o+(-0.871911261059)*x[0]+(0.57743453064)*x[1]**o+(0.950322066335)*x[1]
        arg[3,3,2,0]=(-0.896899724447)*x[0]**o+(-0.898884767716)*x[0]+(0.63832012742)*x[1]**o+(-0.833800375634)*x[1]
        arg[3,3,2,1]=(0.425194254583)*x[0]**o+(0.161328467295)*x[0]+(0.496219405916)*x[1]**o+(0.380935896093)*x[1]
        arg[3,4,0,0]=(0.793902581592)*x[0]**o+(-0.33428511164)*x[0]+(-0.283510438468)*x[1]**o+(0.228913046074)*x[1]
        arg[3,4,0,1]=(0.372028980539)*x[0]**o+(-0.388909011671)*x[0]+(-0.259885631206)*x[1]**o+(-0.950910172897)*x[1]
        arg[3,4,1,0]=(-0.80489673786)*x[0]**o+(-0.828175420038)*x[0]+(0.895070489116)*x[1]**o+(-0.742272132103)*x[1]
        arg[3,4,1,1]=(0.272535126101)*x[0]**o+(0.902668974891)*x[0]+(0.399816667015)*x[1]**o+(-0.953186908789)*x[1]
        arg[3,4,2,0]=(0.0341775288582)*x[0]**o+(0.962241492639)*x[0]+(0.906020184876)*x[1]**o+(-0.400536255726)*x[1]
        arg[3,4,2,1]=(-0.745016464485)*x[0]**o+(-0.85241829747)*x[0]+(-0.648936544722)*x[1]**o+(-0.997030074218)*x[1]
        ref[0,0,0,0]=(0.965300679335)/(o+1.)+(0.142356258935)+(0.392628958003)*0.5**o
        ref[0,0,0,1]=(0.384782163488)/(o+1.)+(-0.407081281958)+(-0.503312425492)*0.5**o
        ref[0,0,1,0]=(-0.765235012795)/(o+1.)+(-0.317187415586)+(0.660162511699)*0.5**o
        ref[0,0,1,1]=(-0.451665346257)/(o+1.)+(-0.0341912040643)+(-0.986935412732)*0.5**o
        ref[0,0,2,0]=(-0.695553902133)/(o+1.)+(-0.467731542733)+(0.632875178502)*0.5**o
        ref[0,0,2,1]=(0.345909088853)/(o+1.)+(0.225477764967)+(0.102625648731)*0.5**o
        ref[0,1,0,0]=(0.332480141972)/(o+1.)+(-0.388404308158)+(-0.0108106931425)*0.5**o
        ref[0,1,0,1]=(0.328480565578)/(o+1.)+(0.324505149668)+(0.220826593491)*0.5**o
        ref[0,1,1,0]=(0.292927451477)/(o+1.)+(0.183128254664)+(0.22735402466)*0.5**o
        ref[0,1,1,1]=(-0.322061131008)/(o+1.)+(0.768096283874)+(0.495079875966)*0.5**o
        ref[0,1,2,0]=(0.286037351205)/(o+1.)+(0.202030463766)+(0.968583889554)*0.5**o
        ref[0,1,2,1]=(0.891305263219)/(o+1.)+(0.219403586029)+(0.361498191707)*0.5**o
        ref[0,2,0,0]=(0.0870608077911)/(o+1.)+(-0.381665114117)+(0.185647566516)*0.5**o
        ref[0,2,0,1]=(-0.0229924234496)/(o+1.)+(0.244502612446)+(0.227262327826)*0.5**o
        ref[0,2,1,0]=(0.957377329048)/(o+1.)+(-0.0454149985758)+(0.0405753322301)*0.5**o
        ref[0,2,1,1]=(-0.628262263897)/(o+1.)+(0.0870979129647)+(-0.546046301701)*0.5**o
        ref[0,2,2,0]=(0.499595322279)/(o+1.)+(0.0509587090171)+(-0.828455793175)*0.5**o
        ref[0,2,2,1]=(-0.678432418122)/(o+1.)+(0.319356853239)+(0.926138085222)*0.5**o
        ref[0,3,0,0]=(0.62665109546)/(o+1.)+(0.762318465671)+(-0.473066058658)*0.5**o
        ref[0,3,0,1]=(-0.459252843816)/(o+1.)+(0.295864315717)+(0.776790978673)*0.5**o
        ref[0,3,1,0]=(0.445864469556)/(o+1.)+(0.292283099022)+(0.34783214571)*0.5**o
        ref[0,3,1,1]=(0.577708844669)/(o+1.)+(-0.491318272755)+(0.0717966037463)*0.5**o
        ref[0,3,2,0]=(-0.33936340707)/(o+1.)+(-0.428987751016)+(-0.548573971799)*0.5**o
        ref[0,3,2,1]=(-0.833323497891)/(o+1.)+(-0.224290613939)+(-0.28309240461)*0.5**o
        ref[0,4,0,0]=(0.146657173319)/(o+1.)+(0.200750335943)+(-0.105416428922)*0.5**o
        ref[0,4,0,1]=(0.534941970665)/(o+1.)+(-0.251774809823)+(-0.876111094069)*0.5**o
        ref[0,4,1,0]=(-0.739368558349)/(o+1.)+(0.228739674374)+(-0.678996394303)*0.5**o
        ref[0,4,1,1]=(-0.651647023142)/(o+1.)+(-0.159264639548)+(0.0472145581152)*0.5**o
        ref[0,4,2,0]=(-0.524234284672)/(o+1.)+(0.218536682587)+(0.114936857967)*0.5**o
        ref[0,4,2,1]=(0.133122220811)/(o+1.)+(-0.31070612124)+(0.568834117773)*0.5**o
        ref[1,0,0,0]=(-0.132449009841)/(o+1.)+(0.380882086677)+(-0.821241886235)*0.5**o
        ref[1,0,0,1]=(-0.573597121344)/(o+1.)+(-0.188183973289)+(0.624372422235)*0.5**o
        ref[1,0,1,0]=(-0.249786553024)/(o+1.)+(-0.661057334385)+(-0.568749808355)*0.5**o
        ref[1,0,1,1]=(0.59246455477)/(o+1.)+(-0.256347568096)+(0.0765557360835)*0.5**o
        ref[1,0,2,0]=(0.0689432766231)/(o+1.)+(-0.267056955718)+(0.909614864187)*0.5**o
        ref[1,0,2,1]=(0.378273922837)/(o+1.)+(0.770144388717)+(0.0610206203468)*0.5**o
        ref[1,1,0,0]=(0.728786835113)/(o+1.)+(0.436825316493)+(0.917249169051)*0.5**o
        ref[1,1,0,1]=(-0.418402258918)/(o+1.)+(-0.47604993983)+(0.331129708654)*0.5**o
        ref[1,1,1,0]=(0.989603613532)/(o+1.)+(-0.153579923633)+(-0.527408405279)*0.5**o
        ref[1,1,1,1]=(0.11459047938)/(o+1.)+(-0.306426672553)+(-0.189543145217)*0.5**o
        ref[1,1,2,0]=(-0.862654310338)/(o+1.)+(0.715874834296)+(0.385274935809)*0.5**o
        ref[1,1,2,1]=(-0.541819816686)/(o+1.)+(0.522617447961)+(-0.380421555378)*0.5**o
        ref[1,2,0,0]=(0.158734254777)/(o+1.)+(0.0919238786215)+(0.446781075767)*0.5**o
        ref[1,2,0,1]=(-0.90301726295)/(o+1.)+(-0.0786321637044)+(0.927811104869)*0.5**o
        ref[1,2,1,0]=(0.157695458386)/(o+1.)+(-0.495417096819)+(0.741527109588)*0.5**o
        ref[1,2,1,1]=(0.0491001091271)/(o+1.)+(-0.243168675353)+(0.193242816889)*0.5**o
        ref[1,2,2,0]=(-0.736262418061)/(o+1.)+(-0.186062680201)+(0.220709813709)*0.5**o
        ref[1,2,2,1]=(-0.167013881353)/(o+1.)+(0.393827099713)+(0.0034506429721)*0.5**o
        ref[1,3,0,0]=(-0.199843421009)/(o+1.)+(0.286711328927)+(0.321471168172)*0.5**o
        ref[1,3,0,1]=(0.0303112997369)/(o+1.)+(-0.430407665717)+(-0.0799622908037)*0.5**o
        ref[1,3,1,0]=(0.335933608833)/(o+1.)+(0.520523281666)+(-0.12051943489)*0.5**o
        ref[1,3,1,1]=(0.10609614346)/(o+1.)+(-0.159221033776)+(-0.587242845986)*0.5**o
        ref[1,3,2,0]=(-0.0280648836948)/(o+1.)+(-0.0969742776586)+(0.947782336638)*0.5**o
        ref[1,3,2,1]=(0.266916366237)/(o+1.)+(0.493290531097)+(-0.0887414134508)*0.5**o
        ref[1,4,0,0]=(-0.00526240442626)/(o+1.)+(0.729539505508)+(-0.138184872938)*0.5**o
        ref[1,4,0,1]=(0.400982699808)/(o+1.)+(0.0361829794896)+(-0.549831917928)*0.5**o
        ref[1,4,1,0]=(-0.827665726293)/(o+1.)+(-0.552518044279)+(-0.137046722563)*0.5**o
        ref[1,4,1,1]=(0.113318564035)/(o+1.)+(-0.318485598343)+(-0.474156202572)*0.5**o
        ref[1,4,2,0]=(-0.968611931598)/(o+1.)+(-0.433615414111)+(0.18476112439)*0.5**o
        ref[1,4,2,1]=(-0.384672070744)/(o+1.)+(0.736845959617)+(-0.372995418552)*0.5**o
        ref[2,0,0,0]=(0.764297272234)/(o+1.)+(0.476996820459)+(0.882400857222)*0.5**o
        ref[2,0,0,1]=(-0.0934000967188)/(o+1.)+(-0.334488128196)+(0.894017590794)*0.5**o
        ref[2,0,1,0]=(0.819002513335)/(o+1.)+(-0.485788276874)+(-0.382158057826)*0.5**o
        ref[2,0,1,1]=(0.366917477923)/(o+1.)+(-0.64272230635)+(-0.259771272131)*0.5**o
        ref[2,0,2,0]=(-0.857625945147)/(o+1.)+(-0.581960052686)+(-0.33946164111)*0.5**o
        ref[2,0,2,1]=(-0.359476461654)/(o+1.)+(0.582637272819)+(0.153353093148)*0.5**o
        ref[2,1,0,0]=(0.194312746335)/(o+1.)+(0.607321463611)+(0.780980225775)*0.5**o
        ref[2,1,0,1]=(-0.313038325156)/(o+1.)+(0.0614854061938)+(-0.334149973283)*0.5**o
        ref[2,1,1,0]=(-0.0643816133251)/(o+1.)+(-0.635200340106)+(-0.832852528577)*0.5**o
        ref[2,1,1,1]=(-0.618456119184)/(o+1.)+(0.712480914191)+(0.300975732963)*0.5**o
        ref[2,1,2,0]=(-0.986852501828)/(o+1.)+(0.232254156437)+(0.122326105776)*0.5**o
        ref[2,1,2,1]=(-0.0933563424166)/(o+1.)+(0.337181975722)+(0.447916985436)*0.5**o
        ref[2,2,0,0]=(-0.053769157756)/(o+1.)+(-0.235907632211)+(0.032076347277)*0.5**o
        ref[2,2,0,1]=(-0.287956277998)/(o+1.)+(-0.564682397133)+(-0.403935703163)*0.5**o
        ref[2,2,1,0]=(0.359071620541)/(o+1.)+(-0.437996024361)+(-0.205077009492)*0.5**o
        ref[2,2,1,1]=(0.2153167916)/(o+1.)+(-0.612290869632)+(0.443658057141)*0.5**o
        ref[2,2,2,0]=(0.608221916958)/(o+1.)+(0.260259411478)+(-0.463879681251)*0.5**o
        ref[2,2,2,1]=(0.8957267808)/(o+1.)+(0.442369195849)+(0.533981754168)*0.5**o
        ref[2,3,0,0]=(0.717384215206)/(o+1.)+(0.396205463942)+(0.499387701403)*0.5**o
        ref[2,3,0,1]=(0.395132533716)/(o+1.)+(-0.107416025237)+(0.866500398882)*0.5**o
        ref[2,3,1,0]=(0.688771917581)/(o+1.)+(-0.601429218934)+(-0.879663354176)*0.5**o
        ref[2,3,1,1]=(0.240960084233)/(o+1.)+(-0.222057616607)+(0.291214284356)*0.5**o
        ref[2,3,2,0]=(-0.505342655776)/(o+1.)+(-0.00898493528542)+(0.47064755192)*0.5**o
        ref[2,3,2,1]=(-0.896333275063)/(o+1.)+(-0.241095664817)+(0.775731405735)*0.5**o
        ref[2,4,0,0]=(0.436744528143)/(o+1.)+(-0.0744964673986)+(-0.7221248688)*0.5**o
        ref[2,4,0,1]=(-0.031320962337)/(o+1.)+(-0.0526613334003)+(-0.742652222385)*0.5**o
        ref[2,4,1,0]=(-0.50790148262)/(o+1.)+(0.626822378181)+(-0.529575527815)*0.5**o
        ref[2,4,1,1]=(-0.770747718564)/(o+1.)+(0.2597241153)+(0.535631957883)*0.5**o
        ref[2,4,2,0]=(0.613495031968)/(o+1.)+(-0.0918624375077)+(0.81688202721)*0.5**o
        ref[2,4,2,1]=(0.093174141001)/(o+1.)+(0.365539433145)+(0.493471708612)*0.5**o
        ref[3,0,0,0]=(0.984307685082)/(o+1.)+(-0.374598361566)+(-0.0668630243284)*0.5**o
        ref[3,0,0,1]=(-0.693596086089)/(o+1.)+(-0.411310048192)+(-0.210452484293)*0.5**o
        ref[3,0,1,0]=(0.824648362105)/(o+1.)+(0.181698265217)+(-0.34853285523)*0.5**o
        ref[3,0,1,1]=(0.681514895836)/(o+1.)+(0.638634223316)+(0.861903045965)*0.5**o
        ref[3,0,2,0]=(-0.0390293468405)/(o+1.)+(-0.130600797806)+(0.0197670342844)*0.5**o
        ref[3,0,2,1]=(0.969057635866)/(o+1.)+(-0.0805103470423)+(-0.499093940395)*0.5**o
        ref[3,1,0,0]=(0.829599262959)/(o+1.)+(0.745807250739)+(-0.955568800095)*0.5**o
        ref[3,1,0,1]=(-0.777548579252)/(o+1.)+(-0.650254524284)+(-0.910307638058)*0.5**o
        ref[3,1,1,0]=(-0.108768166204)/(o+1.)+(0.864123237947)+(0.22353820834)*0.5**o
        ref[3,1,1,1]=(0.931152588498)/(o+1.)+(0.366098675227)+(0.371995768061)*0.5**o
        ref[3,1,2,0]=(-0.14032259215)/(o+1.)+(0.514140454408)+(0.4567417369)*0.5**o
        ref[3,1,2,1]=(0.942530922378)/(o+1.)+(-0.0546106599524)+(-0.855100213731)*0.5**o
        ref[3,2,0,0]=(0.991497679624)/(o+1.)+(-0.26553912869)+(0.17190936572)*0.5**o
        ref[3,2,0,1]=(-0.730243933765)/(o+1.)+(0.0671828123695)+(-0.683587206983)*0.5**o
        ref[3,2,1,0]=(0.36605487466)/(o+1.)+(-0.155226343006)+(0.051672736629)*0.5**o
        ref[3,2,1,1]=(-0.424515284177)/(o+1.)+(0.394142291336)+(0.438014662973)*0.5**o
        ref[3,2,2,0]=(0.326610298255)/(o+1.)+(0.98989944094)+(-0.709499532674)*0.5**o
        ref[3,2,2,1]=(-0.846657945161)/(o+1.)+(0.0841772101477)+(-0.657647707844)*0.5**o
        ref[3,3,0,0]=(0.549866100727)/(o+1.)+(-0.133734825728)+(0.21346320453)*0.5**o
        ref[3,3,0,1]=(0.0224330511636)/(o+1.)+(0.326044184638)+(0.249957470685)*0.5**o
        ref[3,3,1,0]=(0.119453667263)/(o+1.)+(-0.0144803823844)+(0.166507029533)*0.5**o
        ref[3,3,1,1]=(0.57743453064)/(o+1.)+(0.0392054026384)+(0.358248720077)*0.5**o
        ref[3,3,2,0]=(0.63832012742)/(o+1.)+(-0.866342571675)+(-0.896899724447)*0.5**o
        ref[3,3,2,1]=(0.496219405916)/(o+1.)+(0.271132181694)+(0.425194254583)*0.5**o
        ref[3,4,0,0]=(-0.283510438468)/(o+1.)+(-0.0526860327828)+(0.793902581592)*0.5**o
        ref[3,4,0,1]=(-0.259885631206)/(o+1.)+(-0.669909592284)+(0.372028980539)*0.5**o
        ref[3,4,1,0]=(0.895070489116)/(o+1.)+(-0.78522377607)+(-0.80489673786)*0.5**o
        ref[3,4,1,1]=(0.399816667015)/(o+1.)+(-0.0252589669489)+(0.272535126101)*0.5**o
        ref[3,4,2,0]=(0.906020184876)/(o+1.)+(0.280852618457)+(0.0341775288582)*0.5**o
        ref[3,4,2,1]=(-0.648936544722)/(o+1.)+(-0.924724185844)+(-0.745016464485)*0.5**o
      else:
        arg[0,0,0,0]=(-0.891975745754)*x[0]**o+(0.678331209591)*x[0]+(-0.450022305538)*x[1]**o+(0.521272586024)*x[1]+(-0.28868708769)*x[2]**o+(-0.631617544339)*x[2]
        arg[0,0,0,1]=(0.428698930349)*x[0]**o+(-0.856251438077)*x[0]+(0.915766367729)*x[1]**o+(-0.35019463199)*x[1]+(-0.0029340113102)*x[2]**o+(-0.394458505835)*x[2]
        arg[0,0,1,0]=(0.974069118653)*x[0]**o+(-0.674028781962)*x[0]+(0.489718068973)*x[1]**o+(-0.471323892144)*x[1]+(0.11469271678)*x[2]**o+(-0.264584383354)*x[2]
        arg[0,0,1,1]=(0.813412823502)*x[0]**o+(0.739276532652)*x[0]+(-0.863216628203)*x[1]**o+(0.486539683681)*x[1]+(-0.771448803712)*x[2]**o+(-0.621526889056)*x[2]
        arg[0,0,2,0]=(-0.874502916672)*x[0]**o+(0.0708047915752)*x[0]+(0.917576817333)*x[1]**o+(-0.257626031306)*x[1]+(-0.161822453369)*x[2]**o+(0.488866912786)*x[2]
        arg[0,0,2,1]=(-0.258524075807)*x[0]**o+(0.206589504672)*x[0]+(0.232971263871)*x[1]**o+(-0.917991566808)*x[1]+(0.725943193794)*x[2]**o+(-0.170341108992)*x[2]
        arg[0,1,0,0]=(0.489505903018)*x[0]**o+(0.386376068728)*x[0]+(0.510797276159)*x[1]**o+(0.45356046467)*x[1]+(-0.664963144251)*x[2]**o+(0.128579947316)*x[2]
        arg[0,1,0,1]=(0.441567332096)*x[0]**o+(0.658686083904)*x[0]+(0.46601056348)*x[1]**o+(-0.130759928108)*x[1]+(0.324576589)*x[2]**o+(0.844700852997)*x[2]
        arg[0,1,1,0]=(0.388576628492)*x[0]**o+(0.41731399682)*x[0]+(-0.37037879729)*x[1]**o+(-0.00306376860454)*x[1]+(-0.464420131682)*x[2]**o+(0.570470055678)*x[2]
        arg[0,1,1,1]=(-0.0537780037583)*x[0]**o+(0.641854502644)*x[0]+(-0.475355608842)*x[1]**o+(-0.155501886306)*x[1]+(0.159833591997)*x[2]**o+(0.889951997355)*x[2]
        arg[0,1,2,0]=(0.58262140787)*x[0]**o+(0.487380368384)*x[0]+(-0.783228845976)*x[1]**o+(-0.683221249176)*x[1]+(0.98628901689)*x[2]**o+(0.591884616904)*x[2]
        arg[0,1,2,1]=(0.438472233911)*x[0]**o+(0.989088416794)*x[0]+(0.221688966923)*x[1]**o+(-0.119266918098)*x[1]+(-0.887421255415)*x[2]**o+(0.728082459156)*x[2]
        arg[0,2,0,0]=(-0.334110476968)*x[0]**o+(-0.877094545216)*x[0]+(-0.293135209996)*x[1]**o+(0.578110480224)*x[1]+(-0.898686340104)*x[2]**o+(0.528072783107)*x[2]
        arg[0,2,0,1]=(0.33041258354)*x[0]**o+(-0.70349630629)*x[0]+(0.349551161792)*x[1]**o+(-0.296687014146)*x[1]+(-0.272377440466)*x[2]**o+(-0.42221458274)*x[2]
        arg[0,2,1,0]=(-0.80021736912)*x[0]**o+(0.271727608951)*x[0]+(0.689351606243)*x[1]**o+(-0.95063104158)*x[1]+(0.447293221661)*x[2]**o+(0.962435109303)*x[2]
        arg[0,2,1,1]=(-0.773331228218)*x[0]**o+(0.569225340051)*x[0]+(-0.0330042729183)*x[1]**o+(-0.732867386826)*x[1]+(-0.399631128084)*x[2]**o+(0.235907094874)*x[2]
        arg[0,2,2,0]=(-0.943072868965)*x[0]**o+(-0.959364749946)*x[0]+(0.922934300445)*x[1]**o+(0.27257203243)*x[1]+(0.450453864748)*x[2]**o+(0.521284310775)*x[2]
        arg[0,2,2,1]=(-0.821201079286)*x[0]**o+(-0.801011107627)*x[0]+(0.554575277011)*x[1]**o+(-0.411361733513)*x[1]+(-0.858195570474)*x[2]**o+(0.420660103079)*x[2]
        arg[0,3,0,0]=(-0.0564164524098)*x[0]**o+(-0.865516143298)*x[0]+(-0.85754022189)*x[1]**o+(-0.0159800361584)*x[1]+(-0.891158469429)*x[2]**o+(-0.809909518115)*x[2]
        arg[0,3,0,1]=(-0.553858251068)*x[0]**o+(0.827558838148)*x[0]+(0.690081127613)*x[1]**o+(0.3475090336)*x[1]+(-0.190426828891)*x[2]**o+(-0.99589316535)*x[2]
        arg[0,3,1,0]=(-0.992317453163)*x[0]**o+(-0.992812531491)*x[0]+(-0.859683310869)*x[1]**o+(0.441779587739)*x[1]+(0.582457020078)*x[2]**o+(-0.959111461424)*x[2]
        arg[0,3,1,1]=(-0.713753922213)*x[0]**o+(0.504885148776)*x[0]+(-0.076988545634)*x[1]**o+(0.530828889101)*x[1]+(-0.335616242708)*x[2]**o+(-0.0421293420747)*x[2]
        arg[0,3,2,0]=(0.536024118289)*x[0]**o+(-0.527038052847)*x[0]+(-0.558392588656)*x[1]**o+(0.928618057856)*x[1]+(0.427507510033)*x[2]**o+(0.223570914141)*x[2]
        arg[0,3,2,1]=(-0.197968756117)*x[0]**o+(-0.58157606173)*x[0]+(-0.878630012825)*x[1]**o+(-0.380635552726)*x[1]+(-0.477570149125)*x[2]**o+(-0.642904015434)*x[2]
        arg[0,4,0,0]=(0.688763655127)*x[0]**o+(0.286011523933)*x[0]+(0.0933014250929)*x[1]**o+(0.355550563233)*x[1]+(0.121445291305)*x[2]**o+(-0.814538082974)*x[2]
        arg[0,4,0,1]=(-0.402717742839)*x[0]**o+(0.403946649835)*x[0]+(0.286978800579)*x[1]**o+(-0.363358056216)*x[1]+(-0.185233594102)*x[2]**o+(-0.902660250807)*x[2]
        arg[0,4,1,0]=(0.39352838659)*x[0]**o+(-0.430755011337)*x[0]+(-0.912518631162)*x[1]**o+(-0.634118795867)*x[1]+(-0.802445843416)*x[2]**o+(0.643395158048)*x[2]
        arg[0,4,1,1]=(-0.375507250175)*x[0]**o+(-0.609576942939)*x[0]+(0.35060243693)*x[1]**o+(0.384630130603)*x[1]+(0.165576820334)*x[2]**o+(-0.319012357341)*x[2]
        arg[0,4,2,0]=(0.0603590263818)*x[0]**o+(-0.435954775883)*x[0]+(-0.895329092913)*x[1]**o+(0.364809539103)*x[1]+(0.912864788565)*x[2]**o+(0.582044419963)*x[2]
        arg[0,4,2,1]=(-0.111089454685)*x[0]**o+(-0.247527778755)*x[0]+(0.897263901657)*x[1]**o+(0.168097655548)*x[1]+(-0.532273075067)*x[2]**o+(-0.158529268933)*x[2]
        arg[1,0,0,0]=(-0.940865155622)*x[0]**o+(0.639652431549)*x[0]+(0.204433172026)*x[1]**o+(-0.333435100662)*x[1]+(0.922286591304)*x[2]**o+(0.245091036189)*x[2]
        arg[1,0,0,1]=(-0.843207880309)*x[0]**o+(0.496567621809)*x[0]+(-0.747925907677)*x[1]**o+(-0.666195656311)*x[1]+(-0.836848401917)*x[2]**o+(-0.77301298659)*x[2]
        arg[1,0,1,0]=(-0.484987528212)*x[0]**o+(-0.208798022576)*x[0]+(-0.516295195217)*x[1]**o+(0.273733676249)*x[1]+(0.642865886081)*x[2]**o+(0.94556566928)*x[2]
        arg[1,0,1,1]=(0.285548625366)*x[0]**o+(-0.316870037241)*x[0]+(0.166055429845)*x[1]**o+(-0.907240066063)*x[1]+(-0.973602611383)*x[2]**o+(-0.232655535454)*x[2]
        arg[1,0,2,0]=(0.96797757731)*x[0]**o+(-0.0920831342923)*x[0]+(0.0367163548581)*x[1]**o+(0.372503137376)*x[1]+(0.114902128151)*x[2]**o+(0.147390259838)*x[2]
        arg[1,0,2,1]=(-0.486190283922)*x[0]**o+(-0.713417720041)*x[0]+(0.0212905465522)*x[1]**o+(-0.358636168795)*x[1]+(0.719370965272)*x[2]**o+(-0.506502687359)*x[2]
        arg[1,1,0,0]=(-0.216544472879)*x[0]**o+(-0.690540499698)*x[0]+(0.190155427044)*x[1]**o+(0.832206912182)*x[1]+(-0.108713936252)*x[2]**o+(-0.221373087337)*x[2]
        arg[1,1,0,1]=(0.982934604971)*x[0]**o+(0.604369826835)*x[0]+(-0.34365978148)*x[1]**o+(-0.167486779981)*x[1]+(-0.753609370582)*x[2]**o+(-0.220160888977)*x[2]
        arg[1,1,1,0]=(0.516177509446)*x[0]**o+(-0.474445723273)*x[0]+(0.813647087566)*x[1]**o+(-0.281201093802)*x[1]+(0.941465944108)*x[2]**o+(0.352728360059)*x[2]
        arg[1,1,1,1]=(-0.914732890633)*x[0]**o+(0.214962090901)*x[0]+(-0.710485058274)*x[1]**o+(-0.070756754056)*x[1]+(-0.449571590211)*x[2]**o+(0.353655711451)*x[2]
        arg[1,1,2,0]=(-0.96655555619)*x[0]**o+(-0.47460534732)*x[0]+(0.0610695053327)*x[1]**o+(0.815390116709)*x[1]+(-0.844916163552)*x[2]**o+(-0.433015304307)*x[2]
        arg[1,1,2,1]=(-0.611879453709)*x[0]**o+(0.849092848509)*x[0]+(0.0181322361566)*x[1]**o+(0.264173017827)*x[1]+(0.0452154806937)*x[2]**o+(0.0395300648465)*x[2]
        arg[1,2,0,0]=(0.558820946357)*x[0]**o+(-0.471519705598)*x[0]+(-0.200404864145)*x[1]**o+(0.452044160691)*x[1]+(-0.507559485963)*x[2]**o+(-0.993437841726)*x[2]
        arg[1,2,0,1]=(-0.944738664192)*x[0]**o+(-0.497536772117)*x[0]+(0.111399525675)*x[1]**o+(-0.93450294271)*x[1]+(-0.463702615737)*x[2]**o+(-0.330112672884)*x[2]
        arg[1,2,1,0]=(0.238225961058)*x[0]**o+(-0.471520173419)*x[0]+(0.483767084892)*x[1]**o+(-0.0359407284537)*x[1]+(-0.767379409753)*x[2]**o+(-0.283596371915)*x[2]
        arg[1,2,1,1]=(0.188699181238)*x[0]**o+(0.829593121989)*x[0]+(0.603377767593)*x[1]**o+(0.163334775468)*x[1]+(-0.695141594131)*x[2]**o+(-0.335208640181)*x[2]
        arg[1,2,2,0]=(-0.0953160757881)*x[0]**o+(0.179594592176)*x[0]+(0.95983902191)*x[1]**o+(-0.689622683527)*x[1]+(0.418442085936)*x[2]**o+(-0.271399861129)*x[2]
        arg[1,2,2,1]=(0.598691886555)*x[0]**o+(0.334120340646)*x[0]+(0.580763872443)*x[1]**o+(0.769016736836)*x[1]+(-0.442121483951)*x[2]**o+(0.0685264980499)*x[2]
        arg[1,3,0,0]=(-0.482944276372)*x[0]**o+(-0.0518057205519)*x[0]+(-0.878100108766)*x[1]**o+(-0.130957239599)*x[1]+(0.71270341547)*x[2]**o+(-0.313822116756)*x[2]
        arg[1,3,0,1]=(0.565128725562)*x[0]**o+(0.706149004661)*x[0]+(0.837747652328)*x[1]**o+(-0.429417376176)*x[1]+(0.179437627997)*x[2]**o+(-0.841831183522)*x[2]
        arg[1,3,1,0]=(0.608648887224)*x[0]**o+(0.118220851451)*x[0]+(0.492890967377)*x[1]**o+(-0.162344084552)*x[1]+(0.141203210671)*x[2]**o+(0.883457779687)*x[2]
        arg[1,3,1,1]=(0.0322521291544)*x[0]**o+(0.839748977403)*x[0]+(0.75094786544)*x[1]**o+(0.954833145672)*x[1]+(0.461457599013)*x[2]**o+(-0.761973385747)*x[2]
        arg[1,3,2,0]=(-0.757022609619)*x[0]**o+(-0.250893790099)*x[0]+(-0.973631035961)*x[1]**o+(0.506574565217)*x[1]+(0.103557430896)*x[2]**o+(0.881026337134)*x[2]
        arg[1,3,2,1]=(-0.395945302352)*x[0]**o+(-0.125428842065)*x[0]+(-0.339663004568)*x[1]**o+(-0.0272044592179)*x[1]+(0.75200506467)*x[2]**o+(-0.632922582454)*x[2]
        arg[1,4,0,0]=(0.0462127928202)*x[0]**o+(-0.745613488751)*x[0]+(0.357338297422)*x[1]**o+(0.739034094804)*x[1]+(-0.451247272253)*x[2]**o+(0.418030110847)*x[2]
        arg[1,4,0,1]=(0.914131238526)*x[0]**o+(-0.0280436066624)*x[0]+(0.861048515118)*x[1]**o+(0.148206807819)*x[1]+(-0.990856990354)*x[2]**o+(0.903615279172)*x[2]
        arg[1,4,1,0]=(0.189809824038)*x[0]**o+(-0.749477832258)*x[0]+(-0.802713794942)*x[1]**o+(0.0610727255572)*x[1]+(0.292940815327)*x[2]**o+(0.213443422205)*x[2]
        arg[1,4,1,1]=(0.792313292544)*x[0]**o+(0.321344675677)*x[0]+(-0.417516596097)*x[1]**o+(-0.63797359819)*x[1]+(-0.426112319872)*x[2]**o+(0.69281310288)*x[2]
        arg[1,4,2,0]=(-0.11017764073)*x[0]**o+(0.703037562344)*x[0]+(0.739591950873)*x[1]**o+(0.445612268331)*x[1]+(-0.071251825024)*x[2]**o+(0.00577350654185)*x[2]
        arg[1,4,2,1]=(-0.793584849832)*x[0]**o+(-0.546439256231)*x[0]+(-0.947194030803)*x[1]**o+(-0.0455700937677)*x[1]+(0.535368301918)*x[2]**o+(0.814435535521)*x[2]
        arg[2,0,0,0]=(0.249661949438)*x[0]**o+(-0.581533619092)*x[0]+(-0.674373505747)*x[1]**o+(0.464175602196)*x[1]+(-0.528086662834)*x[2]**o+(-0.212416176351)*x[2]
        arg[2,0,0,1]=(-0.588282108798)*x[0]**o+(0.761293399494)*x[0]+(0.99918874903)*x[1]**o+(0.542499992928)*x[1]+(0.433925746483)*x[2]**o+(0.972864491889)*x[2]
        arg[2,0,1,0]=(0.0572335623442)*x[0]**o+(0.444906443533)*x[0]+(-0.305538151235)*x[1]**o+(0.244530068532)*x[1]+(-0.20198975858)*x[2]**o+(-0.00490928477351)*x[2]
        arg[2,0,1,1]=(0.832496085695)*x[0]**o+(-0.797246004595)*x[0]+(0.873816520001)*x[1]**o+(0.628293733929)*x[1]+(-0.110922710624)*x[2]**o+(-0.0718221914062)*x[2]
        arg[2,0,2,0]=(0.140970192196)*x[0]**o+(0.582230323368)*x[0]+(-0.757764751267)*x[1]**o+(0.206061262231)*x[1]+(0.657237474788)*x[2]**o+(0.598632779121)*x[2]
        arg[2,0,2,1]=(-0.686218790734)*x[0]**o+(-0.157012470162)*x[0]+(0.448565721848)*x[1]**o+(0.0539087954076)*x[1]+(0.619821805007)*x[2]**o+(0.289144379283)*x[2]
        arg[2,1,0,0]=(0.787423884494)*x[0]**o+(-0.985959420171)*x[0]+(0.155584360983)*x[1]**o+(0.223292293778)*x[1]+(-0.437349719833)*x[2]**o+(0.989077189275)*x[2]
        arg[2,1,0,1]=(-0.597301631508)*x[0]**o+(-0.0414813766671)*x[0]+(-0.64883048443)*x[1]**o+(-0.18731615522)*x[1]+(0.735189823623)*x[2]**o+(-0.746633725819)*x[2]
        arg[2,1,1,0]=(-0.393486075452)*x[0]**o+(-0.480110060647)*x[0]+(0.559811870081)*x[1]**o+(0.0814282056993)*x[1]+(0.244899906416)*x[2]**o+(-0.884478480652)*x[2]
        arg[2,1,1,1]=(0.547747813175)*x[0]**o+(0.317890585903)*x[0]+(-0.70925099068)*x[1]**o+(-0.543227445702)*x[1]+(0.749693240223)*x[2]**o+(0.79984501038)*x[2]
        arg[2,1,2,0]=(-0.289583636666)*x[0]**o+(0.513926622265)*x[0]+(-0.00283544918865)*x[1]**o+(0.530724065811)*x[1]+(0.900479623243)*x[2]**o+(-0.146332301083)*x[2]
        arg[2,1,2,1]=(-0.487223003118)*x[0]**o+(0.161546483594)*x[0]+(-0.685211654772)*x[1]**o+(0.4803179816)*x[1]+(0.676120396917)*x[2]**o+(-0.174953085068)*x[2]
        arg[2,2,0,0]=(0.31746495834)*x[0]**o+(-0.513225182059)*x[0]+(0.33220677322)*x[1]**o+(-0.302371334854)*x[1]+(0.0964988251907)*x[2]**o+(-0.259532745762)*x[2]
        arg[2,2,0,1]=(0.313462846078)*x[0]**o+(0.079720902627)*x[0]+(-0.487932457563)*x[1]**o+(-0.786522786773)*x[1]+(0.357868214554)*x[2]**o+(0.251856050362)*x[2]
        arg[2,2,1,0]=(-0.180472378556)*x[0]**o+(0.345084802362)*x[0]+(0.641108557953)*x[1]**o+(0.198717742483)*x[1]+(0.0374114682326)*x[2]**o+(-0.915249907773)*x[2]
        arg[2,2,1,1]=(0.303787742688)*x[0]**o+(-0.941822487745)*x[0]+(-0.262567025842)*x[1]**o+(-0.197051445307)*x[1]+(0.381561965565)*x[2]**o+(-0.198549777232)*x[2]
        arg[2,2,2,0]=(-0.850284190461)*x[0]**o+(0.985224868544)*x[0]+(0.633868153422)*x[1]**o+(-0.57559927346)*x[1]+(0.68753726951)*x[2]**o+(-0.923696997656)*x[2]
        arg[2,2,2,1]=(0.559527478503)*x[0]**o+(-0.619764636475)*x[0]+(-0.0352163693945)*x[1]**o+(-0.37351931995)*x[1]+(0.0772333960938)*x[2]**o+(-0.353057755509)*x[2]
        arg[2,3,0,0]=(-0.274260374984)*x[0]**o+(0.365180349506)*x[0]+(-0.879564869545)*x[1]**o+(-0.0908162765131)*x[1]+(0.813491263836)*x[2]**o+(-0.396739585204)*x[2]
        arg[2,3,0,1]=(-0.793218219979)*x[0]**o+(0.227474218201)*x[0]+(0.97716610661)*x[1]**o+(0.317074032722)*x[1]+(0.076776446926)*x[2]**o+(0.069448617786)*x[2]
        arg[2,3,1,0]=(0.411400569812)*x[0]**o+(0.517743454926)*x[0]+(0.646697523033)*x[1]**o+(-0.973369313024)*x[1]+(-0.599741793926)*x[2]**o+(-0.743687020283)*x[2]
        arg[2,3,1,1]=(-0.491445354697)*x[0]**o+(-0.549840110396)*x[0]+(-0.260012915614)*x[1]**o+(0.671054626537)*x[1]+(0.0394966796969)*x[2]**o+(-0.701243931411)*x[2]
        arg[2,3,2,0]=(-0.806859723517)*x[0]**o+(-0.753940066715)*x[0]+(-0.664229274865)*x[1]**o+(0.0595484609931)*x[1]+(-0.921892262667)*x[2]**o+(-0.701770672395)*x[2]
        arg[2,3,2,1]=(-0.313979805844)*x[0]**o+(-0.542583864222)*x[0]+(-0.985990886553)*x[1]**o+(0.664926443979)*x[1]+(-0.99778334615)*x[2]**o+(0.268046810979)*x[2]
        arg[2,4,0,0]=(-0.41348240167)*x[0]**o+(0.473517720534)*x[0]+(-0.290880345559)*x[1]**o+(-0.607611624107)*x[1]+(-0.25537697471)*x[2]**o+(-0.472402477362)*x[2]
        arg[2,4,0,1]=(0.0222534371058)*x[0]**o+(-0.0739354104963)*x[0]+(-0.960057765718)*x[1]**o+(-0.772161403037)*x[1]+(-0.0356127352146)*x[2]**o+(-0.623605628308)*x[2]
        arg[2,4,1,0]=(-0.750995516053)*x[0]**o+(-0.289601799215)*x[0]+(0.294370180152)*x[1]**o+(0.956012147239)*x[1]+(-0.27958662106)*x[2]**o+(-0.370609593537)*x[2]
        arg[2,4,1,1]=(0.321767371741)*x[0]**o+(0.999223434136)*x[0]+(0.665865428241)*x[1]**o+(0.427942082269)*x[1]+(-0.135020552387)*x[2]**o+(0.692025479514)*x[2]
        arg[2,4,2,0]=(-0.519508249649)*x[0]**o+(0.0779688946471)*x[0]+(0.493489242872)*x[1]**o+(-0.0961136530093)*x[1]+(-0.0750243559261)*x[2]**o+(0.860970740104)*x[2]
        arg[2,4,2,1]=(0.807909049346)*x[0]**o+(0.388180877227)*x[0]+(-0.9044578433)*x[1]**o+(0.86765389355)*x[1]+(-0.196105779343)*x[2]**o+(0.448661151455)*x[2]
        arg[3,0,0,0]=(-0.780895567041)*x[0]**o+(-0.571253266808)*x[0]+(-0.904183399932)*x[1]**o+(-0.883296586722)*x[1]+(0.855945559487)*x[2]**o+(0.618533553098)*x[2]
        arg[3,0,0,1]=(-0.831076704037)*x[0]**o+(0.898347446798)*x[0]+(-0.716442620396)*x[1]**o+(0.761028369421)*x[1]+(-0.486505604444)*x[2]**o+(0.25474220145)*x[2]
        arg[3,0,1,0]=(-0.0127541044953)*x[0]**o+(0.759482315308)*x[0]+(-0.725655006866)*x[1]**o+(0.667310781285)*x[1]+(0.266075927439)*x[2]**o+(0.423300182252)*x[2]
        arg[3,0,1,1]=(-0.594972266882)*x[0]**o+(-0.842501149639)*x[0]+(-0.347686790781)*x[1]**o+(0.686403640474)*x[1]+(0.3452971966)*x[2]**o+(0.722258585706)*x[2]
        arg[3,0,2,0]=(-0.715711146058)*x[0]**o+(-0.835739963371)*x[0]+(0.966177361301)*x[1]**o+(-0.909111754995)*x[1]+(-0.175184576557)*x[2]**o+(0.695058239921)*x[2]
        arg[3,0,2,1]=(0.306251544915)*x[0]**o+(0.944775715803)*x[0]+(-0.740601754617)*x[1]**o+(0.434394890125)*x[1]+(-0.876527474971)*x[2]**o+(0.209321129689)*x[2]
        arg[3,1,0,0]=(-0.86788221871)*x[0]**o+(-0.833030657309)*x[0]+(0.84576621947)*x[1]**o+(-0.469186887277)*x[1]+(-0.527611740694)*x[2]**o+(-0.312054431001)*x[2]
        arg[3,1,0,1]=(-0.353678394652)*x[0]**o+(0.591287444611)*x[0]+(-0.213012375931)*x[1]**o+(-0.917259099251)*x[1]+(0.739016360622)*x[2]**o+(0.718754459378)*x[2]
        arg[3,1,1,0]=(-0.92646825221)*x[0]**o+(-0.870564973175)*x[0]+(-0.781805219404)*x[1]**o+(0.078530434642)*x[1]+(0.386018501087)*x[2]**o+(-0.120490492288)*x[2]
        arg[3,1,1,1]=(-0.824273737615)*x[0]**o+(0.401211543421)*x[0]+(0.360077381624)*x[1]**o+(-0.0599234883152)*x[1]+(0.246820480884)*x[2]**o+(-0.175313542134)*x[2]
        arg[3,1,2,0]=(0.807756928769)*x[0]**o+(0.889534807508)*x[0]+(0.633296189954)*x[1]**o+(-0.471821951252)*x[1]+(0.396011249874)*x[2]**o+(0.386800809575)*x[2]
        arg[3,1,2,1]=(-0.494145142543)*x[0]**o+(-0.514793985721)*x[0]+(0.825379848403)*x[1]**o+(-0.457860259786)*x[1]+(-0.599557868275)*x[2]**o+(-0.952704784672)*x[2]
        arg[3,2,0,0]=(0.970345295013)*x[0]**o+(-0.838468036663)*x[0]+(0.265634348738)*x[1]**o+(-0.873847124748)*x[1]+(0.416242648913)*x[2]**o+(0.59908438222)*x[2]
        arg[3,2,0,1]=(0.692377432429)*x[0]**o+(-0.338749041227)*x[0]+(-0.449383750398)*x[1]**o+(0.841669527559)*x[1]+(0.902482059741)*x[2]**o+(-0.655719647704)*x[2]
        arg[3,2,1,0]=(0.152417917522)*x[0]**o+(-0.78860144)*x[0]+(-0.881276170743)*x[1]**o+(0.692901550061)*x[1]+(-0.985377819322)*x[2]**o+(0.362747973601)*x[2]
        arg[3,2,1,1]=(0.238845792119)*x[0]**o+(-0.65838373309)*x[0]+(-0.659676514296)*x[1]**o+(0.870742876778)*x[1]+(-0.367345415947)*x[2]**o+(0.322353666541)*x[2]
        arg[3,2,2,0]=(0.456386394533)*x[0]**o+(-0.135575574979)*x[0]+(-0.731714323922)*x[1]**o+(0.936807859479)*x[1]+(0.511595594967)*x[2]**o+(0.570282464669)*x[2]
        arg[3,2,2,1]=(0.53299212624)*x[0]**o+(0.800998166434)*x[0]+(-0.431740087552)*x[1]**o+(-0.880092532661)*x[1]+(-0.418657988674)*x[2]**o+(-0.181008149338)*x[2]
        arg[3,3,0,0]=(0.60015312936)*x[0]**o+(-0.163125583081)*x[0]+(0.299668981953)*x[1]**o+(-0.761494422747)*x[1]+(0.404839953231)*x[2]**o+(-0.114039836538)*x[2]
        arg[3,3,0,1]=(-0.597481072133)*x[0]**o+(-0.506468582896)*x[0]+(0.406822348574)*x[1]**o+(0.247431348859)*x[1]+(-0.137941563908)*x[2]**o+(0.0503979259383)*x[2]
        arg[3,3,1,0]=(0.0921069092744)*x[0]**o+(-0.113960490794)*x[0]+(0.750059773909)*x[1]**o+(0.894945048248)*x[1]+(-0.154873449786)*x[2]**o+(-0.520229467775)*x[2]
        arg[3,3,1,1]=(0.349078696154)*x[0]**o+(0.141298430827)*x[0]+(0.249161007832)*x[1]**o+(0.0240310278591)*x[1]+(-0.18294527838)*x[2]**o+(-0.666698832632)*x[2]
        arg[3,3,2,0]=(-0.476684936147)*x[0]**o+(0.334093402615)*x[0]+(-0.326434684009)*x[1]**o+(0.91336431975)*x[1]+(0.483080537399)*x[2]**o+(0.439096732335)*x[2]
        arg[3,3,2,1]=(0.214713426286)*x[0]**o+(-0.973239849984)*x[0]+(0.984290637567)*x[1]**o+(-0.644668525299)*x[1]+(0.00985524319943)*x[2]**o+(0.68777403533)*x[2]
        arg[3,4,0,0]=(-0.88715423933)*x[0]**o+(0.642412222188)*x[0]+(-0.119667464132)*x[1]**o+(-0.201583116481)*x[1]+(-0.870921042381)*x[2]**o+(-0.00379039429884)*x[2]
        arg[3,4,0,1]=(0.511114986801)*x[0]**o+(-0.497617928997)*x[0]+(-0.189435233543)*x[1]**o+(-0.29288141421)*x[1]+(-0.476297664539)*x[2]**o+(-0.202915859137)*x[2]
        arg[3,4,1,0]=(0.0739878219028)*x[0]**o+(0.675050675951)*x[0]+(-0.45950101521)*x[1]**o+(0.306538598103)*x[1]+(-0.726069135031)*x[2]**o+(0.193290422951)*x[2]
        arg[3,4,1,1]=(-0.141324267565)*x[0]**o+(0.377343882109)*x[0]+(-0.16075604872)*x[1]**o+(0.263332274591)*x[1]+(0.886416182992)*x[2]**o+(0.931905996631)*x[2]
        arg[3,4,2,0]=(-0.76912732001)*x[0]**o+(-0.255011103121)*x[0]+(-0.372810348364)*x[1]**o+(0.108137766687)*x[1]+(-0.0761382180171)*x[2]**o+(0.46825331282)*x[2]
        arg[3,4,2,1]=(-0.515945940217)*x[0]**o+(-0.630017609554)*x[0]+(-0.815236764508)*x[1]**o+(0.636572471005)*x[1]+(0.244112465789)*x[2]**o+(-0.471661017589)*x[2]
        ref[0,0,0,0]=(-0.738709393227)/(o+1.)+(0.283993125638)+(-0.891975745754)*0.5**o
        ref[0,0,0,1]=(0.912832356419)/(o+1.)+(-0.800452287951)+(0.428698930349)*0.5**o
        ref[0,0,1,0]=(0.604410785754)/(o+1.)+(-0.70496852873)+(0.974069118653)*0.5**o
        ref[0,0,1,1]=(-1.63466543191)/(o+1.)+(0.302144663639)+(0.813412823502)*0.5**o
        ref[0,0,2,0]=(0.755754363963)/(o+1.)+(0.151022836528)+(-0.874502916672)*0.5**o
        ref[0,0,2,1]=(0.958914457666)/(o+1.)+(-0.440871585564)+(-0.258524075807)*0.5**o
        ref[0,1,0,0]=(-0.154165868092)/(o+1.)+(0.484258240357)+(0.489505903018)*0.5**o
        ref[0,1,0,1]=(0.79058715248)/(o+1.)+(0.686313504396)+(0.441567332096)*0.5**o
        ref[0,1,1,0]=(-0.834798928973)/(o+1.)+(0.492360141946)+(0.388576628492)*0.5**o
        ref[0,1,1,1]=(-0.315522016845)/(o+1.)+(0.688152306846)+(-0.0537780037583)*0.5**o
        ref[0,1,2,0]=(0.203060170914)/(o+1.)+(0.198021868056)+(0.58262140787)*0.5**o
        ref[0,1,2,1]=(-0.665732288492)/(o+1.)+(0.798951978927)+(0.438472233911)*0.5**o
        ref[0,2,0,0]=(-1.1918215501)/(o+1.)+(0.114544359058)+(-0.334110476968)*0.5**o
        ref[0,2,0,1]=(0.0771737213265)/(o+1.)+(-0.711198951588)+(0.33041258354)*0.5**o
        ref[0,2,1,0]=(1.1366448279)/(o+1.)+(0.141765838337)+(-0.80021736912)*0.5**o
        ref[0,2,1,1]=(-0.432635401002)/(o+1.)+(0.0361325240497)+(-0.773331228218)*0.5**o
        ref[0,2,2,0]=(1.37338816519)/(o+1.)+(-0.0827542033711)+(-0.943072868965)*0.5**o
        ref[0,2,2,1]=(-0.303620293463)/(o+1.)+(-0.39585636903)+(-0.821201079286)*0.5**o
        ref[0,3,0,0]=(-1.74869869132)/(o+1.)+(-0.845702848785)+(-0.0564164524098)*0.5**o
        ref[0,3,0,1]=(0.499654298722)/(o+1.)+(0.0895873531986)+(-0.553858251068)*0.5**o
        ref[0,3,1,0]=(-0.277226290791)/(o+1.)+(-0.755072202588)+(-0.992317453163)*0.5**o
        ref[0,3,1,1]=(-0.412604788342)/(o+1.)+(0.496792347901)+(-0.713753922213)*0.5**o
        ref[0,3,2,0]=(-0.130885078624)/(o+1.)+(0.312575459575)+(0.536024118289)*0.5**o
        ref[0,3,2,1]=(-1.35620016195)/(o+1.)+(-0.802557814945)+(-0.197968756117)*0.5**o
        ref[0,4,0,0]=(0.214746716397)/(o+1.)+(-0.0864879979042)+(0.688763655127)*0.5**o
        ref[0,4,0,1]=(0.101745206477)/(o+1.)+(-0.431035828594)+(-0.402717742839)*0.5**o
        ref[0,4,1,0]=(-1.71496447458)/(o+1.)+(-0.210739324578)+(0.39352838659)*0.5**o
        ref[0,4,1,1]=(0.516179257264)/(o+1.)+(-0.271979584839)+(-0.375507250175)*0.5**o
        ref[0,4,2,0]=(0.0175356956523)/(o+1.)+(0.255449591592)+(0.0603590263818)*0.5**o
        ref[0,4,2,1]=(0.36499082659)/(o+1.)+(-0.11897969607)+(-0.111089454685)*0.5**o
        ref[1,0,0,0]=(1.12671976333)/(o+1.)+(0.275654183538)+(-0.940865155622)*0.5**o
        ref[1,0,0,1]=(-1.58477430959)/(o+1.)+(-0.471320510546)+(-0.843207880309)*0.5**o
        ref[1,0,1,0]=(0.126570690864)/(o+1.)+(0.505250661477)+(-0.484987528212)*0.5**o
        ref[1,0,1,1]=(-0.807547181539)/(o+1.)+(-0.728382819379)+(0.285548625366)*0.5**o
        ref[1,0,2,0]=(0.151618483009)/(o+1.)+(0.213905131461)+(0.96797757731)*0.5**o
        ref[1,0,2,1]=(0.740661511824)/(o+1.)+(-0.789278288097)+(-0.486190283922)*0.5**o
        ref[1,1,0,0]=(0.0814414907926)/(o+1.)+(-0.0398533374263)+(-0.216544472879)*0.5**o
        ref[1,1,0,1]=(-1.09726915206)/(o+1.)+(0.108361078938)+(0.982934604971)*0.5**o
        ref[1,1,1,0]=(1.75511303167)/(o+1.)+(-0.201459228508)+(0.516177509446)*0.5**o
        ref[1,1,1,1]=(-1.16005664849)/(o+1.)+(0.248930524148)+(-0.914732890633)*0.5**o
        ref[1,1,2,0]=(-0.78384665822)/(o+1.)+(-0.0461152674588)+(-0.96655555619)*0.5**o
        ref[1,1,2,1]=(0.0633477168503)/(o+1.)+(0.576397965591)+(-0.611879453709)*0.5**o
        ref[1,2,0,0]=(-0.707964350108)/(o+1.)+(-0.506456693317)+(0.558820946357)*0.5**o
        ref[1,2,0,1]=(-0.352303090063)/(o+1.)+(-0.881076193856)+(-0.944738664192)*0.5**o
        ref[1,2,1,0]=(-0.283612324861)/(o+1.)+(-0.395528636894)+(0.238225961058)*0.5**o
        ref[1,2,1,1]=(-0.0917638265383)/(o+1.)+(0.328859628638)+(0.188699181238)*0.5**o
        ref[1,2,2,0]=(1.37828110785)/(o+1.)+(-0.39071397624)+(-0.0953160757881)*0.5**o
        ref[1,2,2,1]=(0.138642388492)/(o+1.)+(0.585831787766)+(0.598691886555)*0.5**o
        ref[1,3,0,0]=(-0.165396693296)/(o+1.)+(-0.248292538454)+(-0.482944276372)*0.5**o
        ref[1,3,0,1]=(1.01718528032)/(o+1.)+(-0.282549777519)+(0.565128725562)*0.5**o
        ref[1,3,1,0]=(0.634094178049)/(o+1.)+(0.419667273293)+(0.608648887224)*0.5**o
        ref[1,3,1,1]=(1.21240546445)/(o+1.)+(0.516304368664)+(0.0322521291544)*0.5**o
        ref[1,3,2,0]=(-0.870073605065)/(o+1.)+(0.568353556126)+(-0.757022609619)*0.5**o
        ref[1,3,2,1]=(0.412342060102)/(o+1.)+(-0.392777941868)+(-0.395945302352)*0.5**o
        ref[1,4,0,0]=(-0.0939089748304)/(o+1.)+(0.20572535845)+(0.0462127928202)*0.5**o
        ref[1,4,0,1]=(-0.129808475236)/(o+1.)+(0.511889240164)+(0.914131238526)*0.5**o
        ref[1,4,1,0]=(-0.509772979615)/(o+1.)+(-0.237480842248)+(0.189809824038)*0.5**o
        ref[1,4,1,1]=(-0.843628915969)/(o+1.)+(0.188092090183)+(0.792313292544)*0.5**o
        ref[1,4,2,0]=(0.668340125849)/(o+1.)+(0.577211668608)+(-0.11017764073)*0.5**o
        ref[1,4,2,1]=(-0.411825728886)/(o+1.)+(0.111213092761)+(-0.793584849832)*0.5**o
        ref[2,0,0,0]=(-1.20246016858)/(o+1.)+(-0.164887096623)+(0.249661949438)*0.5**o
        ref[2,0,0,1]=(1.43311449551)/(o+1.)+(1.13832894216)+(-0.588282108798)*0.5**o
        ref[2,0,1,0]=(-0.507527909815)/(o+1.)+(0.342263613646)+(0.0572335623442)*0.5**o
        ref[2,0,1,1]=(0.762893809377)/(o+1.)+(-0.120387231036)+(0.832496085695)*0.5**o
        ref[2,0,2,0]=(-0.100527276479)/(o+1.)+(0.69346218236)+(0.140970192196)*0.5**o
        ref[2,0,2,1]=(1.06838752686)/(o+1.)+(0.0930203522642)+(-0.686218790734)*0.5**o
        ref[2,1,0,0]=(-0.28176535885)/(o+1.)+(0.113205031441)+(0.787423884494)*0.5**o
        ref[2,1,0,1]=(0.0863593391922)/(o+1.)+(-0.487715628853)+(-0.597301631508)*0.5**o
        ref[2,1,1,0]=(0.804711776497)/(o+1.)+(-0.6415801678)+(-0.393486075452)*0.5**o
        ref[2,1,1,1]=(0.0404422495423)/(o+1.)+(0.28725407529)+(0.547747813175)*0.5**o
        ref[2,1,2,0]=(0.897644174054)/(o+1.)+(0.449159193497)+(-0.289583636666)*0.5**o
        ref[2,1,2,1]=(-0.00909125785473)/(o+1.)+(0.233455690063)+(-0.487223003118)*0.5**o
        ref[2,2,0,0]=(0.428705598411)/(o+1.)+(-0.537564631337)+(0.31746495834)*0.5**o
        ref[2,2,0,1]=(-0.13006424301)/(o+1.)+(-0.227472916892)+(0.313462846078)*0.5**o
        ref[2,2,1,0]=(0.678520026185)/(o+1.)+(-0.185723681464)+(-0.180472378556)*0.5**o
        ref[2,2,1,1]=(0.118994939723)/(o+1.)+(-0.668711855142)+(0.303787742688)*0.5**o
        ref[2,2,2,0]=(1.32140542293)/(o+1.)+(-0.257035701286)+(-0.850284190461)*0.5**o
        ref[2,2,2,1]=(0.0420170266993)/(o+1.)+(-0.673170855967)+(0.559527478503)*0.5**o
        ref[2,3,0,0]=(-0.0660736057092)/(o+1.)+(-0.0611877561056)+(-0.274260374984)*0.5**o
        ref[2,3,0,1]=(1.05394255354)/(o+1.)+(0.306998434354)+(-0.793218219979)*0.5**o
        ref[2,3,1,0]=(0.046955729107)/(o+1.)+(-0.599656439191)+(0.411400569812)*0.5**o
        ref[2,3,1,1]=(-0.220516235917)/(o+1.)+(-0.290014707635)+(-0.491445354697)*0.5**o
        ref[2,3,2,0]=(-1.58612153753)/(o+1.)+(-0.698081139059)+(-0.806859723517)*0.5**o
        ref[2,3,2,1]=(-1.9837742327)/(o+1.)+(0.195194695368)+(-0.313979805844)*0.5**o
        ref[2,4,0,0]=(-0.546257320269)/(o+1.)+(-0.303248190467)+(-0.41348240167)*0.5**o
        ref[2,4,0,1]=(-0.995670500932)/(o+1.)+(-0.734851220921)+(0.0222534371058)*0.5**o
        ref[2,4,1,0]=(0.0147835590923)/(o+1.)+(0.147900377243)+(-0.750995516053)*0.5**o
        ref[2,4,1,1]=(0.530844875854)/(o+1.)+(1.05959549796)+(0.321767371741)*0.5**o
        ref[2,4,2,0]=(0.418464886946)/(o+1.)+(0.421412990871)+(-0.519508249649)*0.5**o
        ref[2,4,2,1]=(-1.10056362264)/(o+1.)+(0.852247961116)+(0.807909049346)*0.5**o
        ref[3,0,0,0]=(-0.0482378404454)/(o+1.)+(-0.418008150216)+(-0.780895567041)*0.5**o
        ref[3,0,0,1]=(-1.20294822484)/(o+1.)+(0.957059008835)+(-0.831076704037)*0.5**o
        ref[3,0,1,0]=(-0.459579079427)/(o+1.)+(0.925046639422)+(-0.0127541044953)*0.5**o
        ref[3,0,1,1]=(-0.00238959418047)/(o+1.)+(0.28308053827)+(-0.594972266882)*0.5**o
        ref[3,0,2,0]=(0.790992784744)/(o+1.)+(-0.524896739222)+(-0.715711146058)*0.5**o
        ref[3,0,2,1]=(-1.61712922959)/(o+1.)+(0.794245867809)+(0.306251544915)*0.5**o
        ref[3,1,0,0]=(0.318154478777)/(o+1.)+(-0.807135987793)+(-0.86788221871)*0.5**o
        ref[3,1,0,1]=(0.526003984691)/(o+1.)+(0.196391402369)+(-0.353678394652)*0.5**o
        ref[3,1,1,0]=(-0.395786718317)/(o+1.)+(-0.456262515411)+(-0.92646825221)*0.5**o
        ref[3,1,1,1]=(0.606897862508)/(o+1.)+(0.082987256486)+(-0.824273737615)*0.5**o
        ref[3,1,2,0]=(1.02930743983)/(o+1.)+(0.402256832916)+(0.807756928769)*0.5**o
        ref[3,1,2,1]=(0.225821980128)/(o+1.)+(-0.96267951509)+(-0.494145142543)*0.5**o
        ref[3,2,0,0]=(0.681876997651)/(o+1.)+(-0.556615389596)+(0.970345295013)*0.5**o
        ref[3,2,0,1]=(0.453098309344)/(o+1.)+(-0.0763995806862)+(0.692377432429)*0.5**o
        ref[3,2,1,0]=(-1.86665399006)/(o+1.)+(0.133524041831)+(0.152417917522)*0.5**o
        ref[3,2,1,1]=(-1.02702193024)/(o+1.)+(0.267356405114)+(0.238845792119)*0.5**o
        ref[3,2,2,0]=(-0.220118728954)/(o+1.)+(0.685757374584)+(0.456386394533)*0.5**o
        ref[3,2,2,1]=(-0.850398076225)/(o+1.)+(-0.130051257782)+(0.53299212624)*0.5**o
        ref[3,3,0,0]=(0.704508935183)/(o+1.)+(-0.519329921183)+(0.60015312936)*0.5**o
        ref[3,3,0,1]=(0.268880784666)/(o+1.)+(-0.10431965405)+(-0.597481072133)*0.5**o
        ref[3,3,1,0]=(0.595186324123)/(o+1.)+(0.13037754484)+(0.0921069092744)*0.5**o
        ref[3,3,1,1]=(0.0662157294518)/(o+1.)+(-0.250684686973)+(0.349078696154)*0.5**o
        ref[3,3,2,0]=(0.156645853389)/(o+1.)+(0.84327722735)+(-0.476684936147)*0.5**o
        ref[3,3,2,1]=(0.994145880767)/(o+1.)+(-0.465067169976)+(0.214713426286)*0.5**o
        ref[3,4,0,0]=(-0.990588506513)/(o+1.)+(0.218519355704)+(-0.88715423933)*0.5**o
        ref[3,4,0,1]=(-0.665732898082)/(o+1.)+(-0.496707601172)+(0.511114986801)*0.5**o
        ref[3,4,1,0]=(-1.18557015024)/(o+1.)+(0.587439848502)+(0.0739878219028)*0.5**o
        ref[3,4,1,1]=(0.725660134271)/(o+1.)+(0.786291076666)+(-0.141324267565)*0.5**o
        ref[3,4,2,0]=(-0.448948566381)/(o+1.)+(0.160689988193)+(-0.76912732001)*0.5**o
        ref[3,4,2,1]=(-0.571124298719)/(o+1.)+(-0.232553078069)+(-0.515945940217)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-0.239048993811)*x[0]**o+(0.519530081152)*x[0]+(0.0639850840479)*x[1]**o+(0.629919962063)*x[1]
        ref=(0.0639850840479)/(o+1.)+(0.574725021608)+(-0.239048993811)*0.5**o
      else:
        s=(0.129836073672)*x[0]**o+(0.77979793904)*x[0]+(0.153605570913)*x[1]**o+(0.182457449004)*x[1]+(-0.363742743784)*x[2]**o+(-0.826028359978)*x[2]
        ref=(-0.210137172871)/(o+1.)+(0.068113514033)+(0.129836073672)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.0535727754535)*x[0]**o+(-0.378911132266)*x[0]+(0.893236107106)*x[1]**o+(-0.133308761371)*x[1]
        s[1]=(0.816344010178)*x[0]**o+(-0.629551729403)*x[0]+(0.962635839824)*x[1]**o+(0.531091887731)*x[1]
        ref[0]=(0.893236107106)/(o+1.)+(-0.256109946819)+(-0.0535727754535)*0.5**o
        ref[1]=(0.962635839824)/(o+1.)+(-0.049229920836)+(0.816344010178)*0.5**o
      else:
        s[0]=(0.99651578956)*x[0]**o+(-0.450391117128)*x[0]+(-0.0521202081325)*x[1]**o+(0.409486612049)*x[1]+(0.951839775929)*x[2]**o+(0.0755155386131)*x[2]
        s[1]=(-0.226900637285)*x[0]**o+(-0.784888192711)*x[0]+(-0.475467162806)*x[1]**o+(0.536559857164)*x[1]+(0.346844399644)*x[2]**o+(-0.237869505536)*x[2]
        ref[0]=(0.899719567796)/(o+1.)+(0.0173055167672)+(0.99651578956)*0.5**o
        ref[1]=(-0.128622763161)/(o+1.)+(-0.243098920542)+(-0.226900637285)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(-0.328426418082)*x[0]**o+(-0.966431499834)*x[0]+(0.982530526624)*x[1]**o+(0.475372684178)*x[1]
        s[0,1]=(0.61075753424)*x[0]**o+(-0.974986578257)*x[0]+(-0.0986707750313)*x[1]**o+(-0.490145139235)*x[1]
        s[0,2]=(-0.629292138329)*x[0]**o+(-0.784677771399)*x[0]+(0.662986672949)*x[1]**o+(-0.0634716139549)*x[1]
        s[0,3]=(0.74966960207)*x[0]**o+(-0.672137973696)*x[0]+(-0.104345950525)*x[1]**o+(-0.196646103769)*x[1]
        s[0,4]=(0.714327500249)*x[0]**o+(-0.454839918323)*x[0]+(-0.904749225664)*x[1]**o+(0.829036667249)*x[1]
        s[1,0]=(-0.290327744474)*x[0]**o+(-0.0432653521002)*x[0]+(-0.814637993515)*x[1]**o+(0.329873273442)*x[1]
        s[1,1]=(-0.256944455249)*x[0]**o+(-0.0374267372088)*x[0]+(0.136172411148)*x[1]**o+(-0.82944305625)*x[1]
        s[1,2]=(-0.260661151595)*x[0]**o+(-0.597199898207)*x[0]+(0.909049968542)*x[1]**o+(-0.262195958725)*x[1]
        s[1,3]=(-0.228035815224)*x[0]**o+(0.772135534405)*x[0]+(0.00192609783775)*x[1]**o+(-0.855606696367)*x[1]
        s[1,4]=(0.824519454106)*x[0]**o+(0.723545812848)*x[0]+(0.588395672453)*x[1]**o+(0.701489329605)*x[1]
        s[2,0]=(0.104767951487)*x[0]**o+(0.0937742673825)*x[0]+(-0.226378722473)*x[1]**o+(-0.239638024937)*x[1]
        s[2,1]=(0.922749632743)*x[0]**o+(0.380185381588)*x[0]+(-0.873869266649)*x[1]**o+(-0.995526870666)*x[1]
        s[2,2]=(0.459628441315)*x[0]**o+(-0.870827776883)*x[0]+(0.963527703404)*x[1]**o+(-0.380921690386)*x[1]
        s[2,3]=(0.0538635635094)*x[0]**o+(0.636269518871)*x[0]+(0.496494434174)*x[1]**o+(0.389503037841)*x[1]
        s[2,4]=(0.486584334747)*x[0]**o+(0.595962829728)*x[0]+(-0.0473827215975)*x[1]**o+(-0.0598623245737)*x[1]
        s[3,0]=(0.104809543499)*x[0]**o+(-0.103399959545)*x[0]+(0.46274253883)*x[1]**o+(0.00540100368281)*x[1]
        s[3,1]=(0.182366414916)*x[0]**o+(-0.454996760913)*x[0]+(0.195895079357)*x[1]**o+(-0.445919339196)*x[1]
        s[3,2]=(-0.270350002842)*x[0]**o+(0.0801494193318)*x[0]+(-0.192008845814)*x[1]**o+(0.20055215786)*x[1]
        s[3,3]=(0.946634950526)*x[0]**o+(0.794617946132)*x[0]+(0.266843824183)*x[1]**o+(0.431654105192)*x[1]
        s[3,4]=(-0.282961386823)*x[0]**o+(-0.659458559302)*x[0]+(-0.701137505881)*x[1]**o+(0.419244903032)*x[1]
        ref[0,0]=(0.982530526624)/(o+1.)+(-0.245529407828)+(-0.328426418082)*0.5**o
        ref[0,1]=(-0.0986707750313)/(o+1.)+(-0.732565858746)+(0.61075753424)*0.5**o
        ref[0,2]=(0.662986672949)/(o+1.)+(-0.424074692677)+(-0.629292138329)*0.5**o
        ref[0,3]=(-0.104345950525)/(o+1.)+(-0.434392038732)+(0.74966960207)*0.5**o
        ref[0,4]=(-0.904749225664)/(o+1.)+(0.187098374463)+(0.714327500249)*0.5**o
        ref[1,0]=(-0.814637993515)/(o+1.)+(0.143303960671)+(-0.290327744474)*0.5**o
        ref[1,1]=(0.136172411148)/(o+1.)+(-0.433434896729)+(-0.256944455249)*0.5**o
        ref[1,2]=(0.909049968542)/(o+1.)+(-0.429697928466)+(-0.260661151595)*0.5**o
        ref[1,3]=(0.00192609783775)/(o+1.)+(-0.0417355809806)+(-0.228035815224)*0.5**o
        ref[1,4]=(0.588395672453)/(o+1.)+(0.712517571227)+(0.824519454106)*0.5**o
        ref[2,0]=(-0.226378722473)/(o+1.)+(-0.0729318787773)+(0.104767951487)*0.5**o
        ref[2,1]=(-0.873869266649)/(o+1.)+(-0.307670744539)+(0.922749632743)*0.5**o
        ref[2,2]=(0.963527703404)/(o+1.)+(-0.625874733635)+(0.459628441315)*0.5**o
        ref[2,3]=(0.496494434174)/(o+1.)+(0.512886278356)+(0.0538635635094)*0.5**o
        ref[2,4]=(-0.0473827215975)/(o+1.)+(0.268050252577)+(0.486584334747)*0.5**o
        ref[3,0]=(0.46274253883)/(o+1.)+(-0.0489994779311)+(0.104809543499)*0.5**o
        ref[3,1]=(0.195895079357)/(o+1.)+(-0.450458050054)+(0.182366414916)*0.5**o
        ref[3,2]=(-0.192008845814)/(o+1.)+(0.140350788596)+(-0.270350002842)*0.5**o
        ref[3,3]=(0.266843824183)/(o+1.)+(0.613136025662)+(0.946634950526)*0.5**o
        ref[3,4]=(-0.701137505881)/(o+1.)+(-0.120106828135)+(-0.282961386823)*0.5**o
      else:
        s[0,0]=(-0.544243335601)*x[0]**o+(-0.307372154904)*x[0]+(0.244525574061)*x[1]**o+(-0.528694523489)*x[1]+(0.667705852103)*x[2]**o+(0.866378210585)*x[2]
        s[0,1]=(-0.397733775219)*x[0]**o+(0.195969196217)*x[0]+(-0.941371407192)*x[1]**o+(0.524704832845)*x[1]+(-0.973723558169)*x[2]**o+(0.0452111700317)*x[2]
        s[0,2]=(-0.0445896420815)*x[0]**o+(-0.730345503814)*x[0]+(-0.797148073969)*x[1]**o+(0.687229609119)*x[1]+(-0.905358686985)*x[2]**o+(-0.764008239213)*x[2]
        s[0,3]=(0.803277368887)*x[0]**o+(0.716534949109)*x[0]+(-0.138102366205)*x[1]**o+(-0.0536511450001)*x[1]+(-0.608245637044)*x[2]**o+(-0.922294317712)*x[2]
        s[0,4]=(-0.802690014092)*x[0]**o+(0.397998151759)*x[0]+(0.209143804619)*x[1]**o+(0.171210888095)*x[1]+(0.945371372346)*x[2]**o+(0.143657498886)*x[2]
        s[1,0]=(-0.737094926707)*x[0]**o+(-0.682774905121)*x[0]+(-0.605040082549)*x[1]**o+(0.913015529243)*x[1]+(-0.923053380199)*x[2]**o+(0.488575946117)*x[2]
        s[1,1]=(-0.19024610752)*x[0]**o+(0.112566519608)*x[0]+(0.631915593649)*x[1]**o+(0.613460770368)*x[1]+(-0.145279640801)*x[2]**o+(0.391904990063)*x[2]
        s[1,2]=(0.503053165032)*x[0]**o+(0.150421546144)*x[0]+(-0.975785035648)*x[1]**o+(0.358360240583)*x[1]+(-0.116051949436)*x[2]**o+(0.22565570175)*x[2]
        s[1,3]=(-0.183734715218)*x[0]**o+(0.397188558255)*x[0]+(0.621875746076)*x[1]**o+(-0.683761765859)*x[1]+(-0.964066487584)*x[2]**o+(0.572293215139)*x[2]
        s[1,4]=(0.308876282691)*x[0]**o+(0.163499825051)*x[0]+(-0.859132579068)*x[1]**o+(-0.133046304211)*x[1]+(-0.995751005727)*x[2]**o+(0.256192590636)*x[2]
        s[2,0]=(-0.823620775877)*x[0]**o+(-0.173531059768)*x[0]+(-0.428278048825)*x[1]**o+(-0.935056836732)*x[1]+(-0.16471171795)*x[2]**o+(-0.0746252552822)*x[2]
        s[2,1]=(0.692340272178)*x[0]**o+(-0.178862964433)*x[0]+(0.241112494059)*x[1]**o+(-0.0400607170557)*x[1]+(-0.131477945619)*x[2]**o+(-0.742303256353)*x[2]
        s[2,2]=(-0.213693977195)*x[0]**o+(0.829007036928)*x[0]+(0.269322769984)*x[1]**o+(0.988636255935)*x[1]+(0.145550246384)*x[2]**o+(0.53131223825)*x[2]
        s[2,3]=(0.337485288934)*x[0]**o+(-0.794235442944)*x[0]+(-0.862195558251)*x[1]**o+(-0.302947127951)*x[1]+(0.660574358405)*x[2]**o+(0.383147294118)*x[2]
        s[2,4]=(-0.0555202855446)*x[0]**o+(-0.298089725164)*x[0]+(-0.971009290556)*x[1]**o+(-0.867265062556)*x[1]+(0.669532302056)*x[2]**o+(-0.432375844991)*x[2]
        s[3,0]=(0.596097084223)*x[0]**o+(-0.388031691584)*x[0]+(-0.596718750677)*x[1]**o+(0.196346996307)*x[1]+(0.0230334505824)*x[2]**o+(-0.293224683649)*x[2]
        s[3,1]=(-0.855920365774)*x[0]**o+(-0.0363724823656)*x[0]+(-0.918160096067)*x[1]**o+(-0.275555163751)*x[1]+(-0.90266927)*x[2]**o+(-0.275537041793)*x[2]
        s[3,2]=(0.788923009274)*x[0]**o+(-0.182338499866)*x[0]+(0.649442441856)*x[1]**o+(-0.179319161548)*x[1]+(-0.330240080654)*x[2]**o+(0.45030421169)*x[2]
        s[3,3]=(-0.0731084424823)*x[0]**o+(0.903713856354)*x[0]+(0.749750641159)*x[1]**o+(-0.274337831625)*x[1]+(0.667970754626)*x[2]**o+(-0.369139994984)*x[2]
        s[3,4]=(0.0580656964124)*x[0]**o+(0.30223985624)*x[0]+(-0.0278202819133)*x[1]**o+(-0.214845008141)*x[1]+(0.683342885793)*x[2]**o+(0.920939676772)*x[2]
        ref[0,0]=(0.912231426164)/(o+1.)+(0.0151557660955)+(-0.544243335601)*0.5**o
        ref[0,1]=(-1.91509496536)/(o+1.)+(0.382942599547)+(-0.397733775219)*0.5**o
        ref[0,2]=(-1.70250676095)/(o+1.)+(-0.403562066955)+(-0.0445896420815)*0.5**o
        ref[0,3]=(-0.746348003249)/(o+1.)+(-0.129705256801)+(0.803277368887)*0.5**o
        ref[0,4]=(1.15451517696)/(o+1.)+(0.35643326937)+(-0.802690014092)*0.5**o
        ref[1,0]=(-1.52809346275)/(o+1.)+(0.359408285119)+(-0.737094926707)*0.5**o
        ref[1,1]=(0.486635952848)/(o+1.)+(0.558966140019)+(-0.19024610752)*0.5**o
        ref[1,2]=(-1.09183698508)/(o+1.)+(0.367218744238)+(0.503053165032)*0.5**o
        ref[1,3]=(-0.342190741508)/(o+1.)+(0.142860003768)+(-0.183734715218)*0.5**o
        ref[1,4]=(-1.8548835848)/(o+1.)+(0.143323055738)+(0.308876282691)*0.5**o
        ref[2,0]=(-0.592989766775)/(o+1.)+(-0.591606575891)+(-0.823620775877)*0.5**o
        ref[2,1]=(0.109634548439)/(o+1.)+(-0.480613468921)+(0.692340272178)*0.5**o
        ref[2,2]=(0.414873016368)/(o+1.)+(1.17447776556)+(-0.213693977195)*0.5**o
        ref[2,3]=(-0.201621199846)/(o+1.)+(-0.357017638388)+(0.337485288934)*0.5**o
        ref[2,4]=(-0.3014769885)/(o+1.)+(-0.798865316355)+(-0.0555202855446)*0.5**o
        ref[3,0]=(-0.573685300094)/(o+1.)+(-0.242454689463)+(0.596097084223)*0.5**o
        ref[3,1]=(-1.82082936607)/(o+1.)+(-0.293732343955)+(-0.855920365774)*0.5**o
        ref[3,2]=(0.319202361202)/(o+1.)+(0.044323275138)+(0.788923009274)*0.5**o
        ref[3,3]=(1.41772139578)/(o+1.)+(0.130118014873)+(-0.0731084424823)*0.5**o
        ref[3,4]=(0.65552260388)/(o+1.)+(0.504167262435)+(0.0580656964124)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.2538014101)*x[0]**o+(0.422893022023)*x[0]+(-0.168009677754)*x[1]**o+(0.967205152872)*x[1]
        s[0,0,1]=(-0.42169068503)*x[0]**o+(-0.87035047637)*x[0]+(0.861757151221)*x[1]**o+(0.233579078048)*x[1]
        s[0,1,0]=(0.761004021853)*x[0]**o+(-0.406910518681)*x[0]+(-0.653627037953)*x[1]**o+(0.78163950747)*x[1]
        s[0,1,1]=(0.571752563364)*x[0]**o+(0.352647230887)*x[0]+(0.64023828193)*x[1]**o+(-0.906400256269)*x[1]
        s[1,0,0]=(-0.229152209793)*x[0]**o+(-0.164526860803)*x[0]+(-0.815301528075)*x[1]**o+(-0.375201173874)*x[1]
        s[1,0,1]=(0.497997942477)*x[0]**o+(-0.590120034514)*x[0]+(0.387642938322)*x[1]**o+(-0.441598030675)*x[1]
        s[1,1,0]=(-0.396407524403)*x[0]**o+(0.225115161973)*x[0]+(0.709660265053)*x[1]**o+(-0.723548390356)*x[1]
        s[1,1,1]=(-0.810340425309)*x[0]**o+(0.571580569899)*x[0]+(0.401013753168)*x[1]**o+(0.881936918624)*x[1]
        s[2,0,0]=(0.096907527902)*x[0]**o+(-0.329521007808)*x[0]+(0.872734305266)*x[1]**o+(-0.677632080143)*x[1]
        s[2,0,1]=(-0.657791763259)*x[0]**o+(-0.0622202818891)*x[0]+(0.838133724288)*x[1]**o+(0.679646081219)*x[1]
        s[2,1,0]=(-0.982546119133)*x[0]**o+(0.0982803558898)*x[0]+(0.188605842026)*x[1]**o+(-0.436341762577)*x[1]
        s[2,1,1]=(0.623965743731)*x[0]**o+(-0.470311605613)*x[0]+(-0.700736177085)*x[1]**o+(0.688725936352)*x[1]
        s[3,0,0]=(0.154576108414)*x[0]**o+(-0.114669097915)*x[0]+(-0.922751077939)*x[1]**o+(-0.0336084204309)*x[1]
        s[3,0,1]=(-0.360543465066)*x[0]**o+(0.369432311166)*x[0]+(0.56460991873)*x[1]**o+(-0.56949007527)*x[1]
        s[3,1,0]=(0.914890366289)*x[0]**o+(0.216556566085)*x[0]+(-0.720400002066)*x[1]**o+(-0.44569085463)*x[1]
        s[3,1,1]=(0.0855171738813)*x[0]**o+(-0.47318307368)*x[0]+(0.267072371169)*x[1]**o+(-0.861793396744)*x[1]
        s[4,0,0]=(-0.862522626201)*x[0]**o+(0.101759724363)*x[0]+(-0.843728984752)*x[1]**o+(-0.510998623672)*x[1]
        s[4,0,1]=(0.827712219176)*x[0]**o+(-0.83052404804)*x[0]+(-0.349511963621)*x[1]**o+(0.379838260239)*x[1]
        s[4,1,0]=(0.923120645339)*x[0]**o+(-0.310138654901)*x[0]+(-0.0364015485007)*x[1]**o+(-0.869695736822)*x[1]
        s[4,1,1]=(0.462952706773)*x[0]**o+(0.391666695595)*x[0]+(0.918559046828)*x[1]**o+(0.0448293018515)*x[1]
        s[5,0,0]=(0.708616542984)*x[0]**o+(-0.826033306645)*x[0]+(0.50975079739)*x[1]**o+(-0.213839768114)*x[1]
        s[5,0,1]=(0.874170725144)*x[0]**o+(0.128033874112)*x[0]+(-0.236784782085)*x[1]**o+(0.885355734442)*x[1]
        s[5,1,0]=(0.0315543075879)*x[0]**o+(-0.482419902735)*x[0]+(0.112741960603)*x[1]**o+(0.336157525634)*x[1]
        s[5,1,1]=(0.000481165869329)*x[0]**o+(-0.356220818813)*x[0]+(-0.466568234378)*x[1]**o+(0.851934710295)*x[1]
        ref[0,0,0]=(-0.168009677754)/(o+1.)+(0.695049087447)+(-0.2538014101)*0.5**o
        ref[0,0,1]=(0.861757151221)/(o+1.)+(-0.318385699161)+(-0.42169068503)*0.5**o
        ref[0,1,0]=(-0.653627037953)/(o+1.)+(0.187364494395)+(0.761004021853)*0.5**o
        ref[0,1,1]=(0.64023828193)/(o+1.)+(-0.276876512691)+(0.571752563364)*0.5**o
        ref[1,0,0]=(-0.815301528075)/(o+1.)+(-0.269864017338)+(-0.229152209793)*0.5**o
        ref[1,0,1]=(0.387642938322)/(o+1.)+(-0.515859032595)+(0.497997942477)*0.5**o
        ref[1,1,0]=(0.709660265053)/(o+1.)+(-0.249216614192)+(-0.396407524403)*0.5**o
        ref[1,1,1]=(0.401013753168)/(o+1.)+(0.726758744261)+(-0.810340425309)*0.5**o
        ref[2,0,0]=(0.872734305266)/(o+1.)+(-0.503576543976)+(0.096907527902)*0.5**o
        ref[2,0,1]=(0.838133724288)/(o+1.)+(0.308712899665)+(-0.657791763259)*0.5**o
        ref[2,1,0]=(0.188605842026)/(o+1.)+(-0.169030703344)+(-0.982546119133)*0.5**o
        ref[2,1,1]=(-0.700736177085)/(o+1.)+(0.10920716537)+(0.623965743731)*0.5**o
        ref[3,0,0]=(-0.922751077939)/(o+1.)+(-0.0741387591729)+(0.154576108414)*0.5**o
        ref[3,0,1]=(0.56460991873)/(o+1.)+(-0.100028882052)+(-0.360543465066)*0.5**o
        ref[3,1,0]=(-0.720400002066)/(o+1.)+(-0.114567144272)+(0.914890366289)*0.5**o
        ref[3,1,1]=(0.267072371169)/(o+1.)+(-0.667488235212)+(0.0855171738813)*0.5**o
        ref[4,0,0]=(-0.843728984752)/(o+1.)+(-0.204619449655)+(-0.862522626201)*0.5**o
        ref[4,0,1]=(-0.349511963621)/(o+1.)+(-0.2253428939)+(0.827712219176)*0.5**o
        ref[4,1,0]=(-0.0364015485007)/(o+1.)+(-0.589917195861)+(0.923120645339)*0.5**o
        ref[4,1,1]=(0.918559046828)/(o+1.)+(0.218247998723)+(0.462952706773)*0.5**o
        ref[5,0,0]=(0.50975079739)/(o+1.)+(-0.51993653738)+(0.708616542984)*0.5**o
        ref[5,0,1]=(-0.236784782085)/(o+1.)+(0.506694804277)+(0.874170725144)*0.5**o
        ref[5,1,0]=(0.112741960603)/(o+1.)+(-0.0731311885505)+(0.0315543075879)*0.5**o
        ref[5,1,1]=(-0.466568234378)/(o+1.)+(0.247856945741)+(0.000481165869329)*0.5**o
      else:
        s[0,0,0]=(0.712776413788)*x[0]**o+(-0.232827372726)*x[0]+(0.504361060322)*x[1]**o+(-0.646213742366)*x[1]+(-0.292404315781)*x[2]**o+(0.0934342710289)*x[2]
        s[0,0,1]=(-0.6231391885)*x[0]**o+(-0.201681226437)*x[0]+(0.295572186857)*x[1]**o+(0.490652427459)*x[1]+(-0.816764035717)*x[2]**o+(-0.920253719103)*x[2]
        s[0,1,0]=(0.464396400115)*x[0]**o+(0.256116225806)*x[0]+(0.00347318217819)*x[1]**o+(0.290749204508)*x[1]+(0.755673392263)*x[2]**o+(0.0296476243926)*x[2]
        s[0,1,1]=(-0.901282392808)*x[0]**o+(0.390894518003)*x[0]+(-0.638342109049)*x[1]**o+(0.325572670945)*x[1]+(0.011997038614)*x[2]**o+(-0.953246898018)*x[2]
        s[1,0,0]=(-0.234152998295)*x[0]**o+(-0.686879447381)*x[0]+(0.684513221814)*x[1]**o+(0.314162707683)*x[1]+(-0.140878044122)*x[2]**o+(0.588563624841)*x[2]
        s[1,0,1]=(0.00302398956565)*x[0]**o+(-0.255603279589)*x[0]+(-0.356254001427)*x[1]**o+(-0.00335409560896)*x[1]+(0.761527454384)*x[2]**o+(-0.803864763242)*x[2]
        s[1,1,0]=(0.350958444218)*x[0]**o+(0.626399553048)*x[0]+(-0.804525479633)*x[1]**o+(0.999024446128)*x[1]+(-0.747418498661)*x[2]**o+(0.16538209042)*x[2]
        s[1,1,1]=(0.830959844328)*x[0]**o+(-0.838517518014)*x[0]+(-0.815601516751)*x[1]**o+(-0.527962402292)*x[1]+(0.849695437437)*x[2]**o+(0.0461655137013)*x[2]
        s[2,0,0]=(-0.654485309003)*x[0]**o+(-0.922437021301)*x[0]+(0.0726219637303)*x[1]**o+(-0.27358467284)*x[1]+(0.965940347168)*x[2]**o+(0.136286409807)*x[2]
        s[2,0,1]=(-0.765669487668)*x[0]**o+(-0.381631759049)*x[0]+(-0.338604617382)*x[1]**o+(-0.026416557321)*x[1]+(-0.505094659996)*x[2]**o+(-0.109271565345)*x[2]
        s[2,1,0]=(-0.823307360412)*x[0]**o+(0.742603440907)*x[0]+(0.264688242655)*x[1]**o+(0.152850147645)*x[1]+(0.576103041841)*x[2]**o+(-0.5223182504)*x[2]
        s[2,1,1]=(-0.853043070027)*x[0]**o+(-0.841177435972)*x[0]+(-0.899106240107)*x[1]**o+(0.605850900198)*x[1]+(0.66690888915)*x[2]**o+(-0.294170728255)*x[2]
        s[3,0,0]=(0.570005513209)*x[0]**o+(0.823970182367)*x[0]+(-0.097784833249)*x[1]**o+(0.873052382528)*x[1]+(-0.0636165773808)*x[2]**o+(0.282310913291)*x[2]
        s[3,0,1]=(0.456449154672)*x[0]**o+(0.951161773651)*x[0]+(-0.373225942356)*x[1]**o+(-0.199594431547)*x[1]+(-0.484728313328)*x[2]**o+(-0.931817560358)*x[2]
        s[3,1,0]=(-0.41042836838)*x[0]**o+(0.771670661129)*x[0]+(-0.0646371268204)*x[1]**o+(0.881286289043)*x[1]+(-0.197285717492)*x[2]**o+(0.857484079398)*x[2]
        s[3,1,1]=(0.297402801452)*x[0]**o+(-0.147528679657)*x[0]+(0.0071150978913)*x[1]**o+(0.788738967825)*x[1]+(-0.191726852031)*x[2]**o+(-0.481649460835)*x[2]
        s[4,0,0]=(-0.808360899963)*x[0]**o+(-0.181264991463)*x[0]+(-0.667551398858)*x[1]**o+(0.289372159531)*x[1]+(0.732773385522)*x[2]**o+(-0.123945731785)*x[2]
        s[4,0,1]=(0.854370035772)*x[0]**o+(0.169945736996)*x[0]+(0.305712234323)*x[1]**o+(-0.60291919973)*x[1]+(0.0403778674069)*x[2]**o+(-0.0309870891437)*x[2]
        s[4,1,0]=(0.543462693144)*x[0]**o+(0.102574070937)*x[0]+(0.963469439068)*x[1]**o+(-0.985245165577)*x[1]+(-0.74408200708)*x[2]**o+(-0.146993364858)*x[2]
        s[4,1,1]=(-0.50927952968)*x[0]**o+(0.471050528827)*x[0]+(0.554105772637)*x[1]**o+(0.265977196333)*x[1]+(-0.447676667005)*x[2]**o+(-0.725761367739)*x[2]
        s[5,0,0]=(0.738549622917)*x[0]**o+(-0.300701131285)*x[0]+(0.770397993383)*x[1]**o+(0.604771638849)*x[1]+(-0.839284085987)*x[2]**o+(-0.636936520767)*x[2]
        s[5,0,1]=(0.546026750751)*x[0]**o+(-0.413469373764)*x[0]+(-0.246023997114)*x[1]**o+(0.207570581839)*x[1]+(0.447030203856)*x[2]**o+(0.0894542975251)*x[2]
        s[5,1,0]=(0.262793971997)*x[0]**o+(-0.814182314897)*x[0]+(-0.340418569268)*x[1]**o+(-0.483737889608)*x[1]+(0.287508080597)*x[2]**o+(-0.602853752221)*x[2]
        s[5,1,1]=(-0.417452810992)*x[0]**o+(-0.906502058242)*x[0]+(0.280357642399)*x[1]**o+(-0.452257960569)*x[1]+(0.239691800726)*x[2]**o+(0.0506798793624)*x[2]
        ref[0,0,0]=(0.211956744542)/(o+1.)+(-0.392803422032)+(0.712776413788)*0.5**o
        ref[0,0,1]=(-0.521191848861)/(o+1.)+(-0.31564125904)+(-0.6231391885)*0.5**o
        ref[0,1,0]=(0.759146574441)/(o+1.)+(0.288256527353)+(0.464396400115)*0.5**o
        ref[0,1,1]=(-0.626345070435)/(o+1.)+(-0.118389854535)+(-0.901282392808)*0.5**o
        ref[1,0,0]=(0.543635177691)/(o+1.)+(0.107923442572)+(-0.234152998295)*0.5**o
        ref[1,0,1]=(0.405273452958)/(o+1.)+(-0.53141106922)+(0.00302398956565)*0.5**o
        ref[1,1,0]=(-1.55194397829)/(o+1.)+(0.895403044797)+(0.350958444218)*0.5**o
        ref[1,1,1]=(0.0340939206865)/(o+1.)+(-0.660157203302)+(0.830959844328)*0.5**o
        ref[2,0,0]=(1.0385623109)/(o+1.)+(-0.529867642167)+(-0.654485309003)*0.5**o
        ref[2,0,1]=(-0.843699277378)/(o+1.)+(-0.258659940857)+(-0.765669487668)*0.5**o
        ref[2,1,0]=(0.840791284496)/(o+1.)+(0.186567669076)+(-0.823307360412)*0.5**o
        ref[2,1,1]=(-0.232197350956)/(o+1.)+(-0.264748632015)+(-0.853043070027)*0.5**o
        ref[3,0,0]=(-0.16140141063)/(o+1.)+(0.989666739093)+(0.570005513209)*0.5**o
        ref[3,0,1]=(-0.857954255684)/(o+1.)+(-0.0901251091271)+(0.456449154672)*0.5**o
        ref[3,1,0]=(-0.261922844312)/(o+1.)+(1.25522051478)+(-0.41042836838)*0.5**o
        ref[3,1,1]=(-0.18461175414)/(o+1.)+(0.0797804136672)+(0.297402801452)*0.5**o
        ref[4,0,0]=(0.0652219866638)/(o+1.)+(-0.00791928185857)+(-0.808360899963)*0.5**o
        ref[4,0,1]=(0.34609010173)/(o+1.)+(-0.231980275939)+(0.854370035772)*0.5**o
        ref[4,1,0]=(0.219387431988)/(o+1.)+(-0.514832229749)+(0.543462693144)*0.5**o
        ref[4,1,1]=(0.106429105632)/(o+1.)+(0.00563317871007)+(-0.50927952968)*0.5**o
        ref[5,0,0]=(-0.0688860926042)/(o+1.)+(-0.166433006601)+(0.738549622917)*0.5**o
        ref[5,0,1]=(0.201006206742)/(o+1.)+(-0.0582222472)+(0.546026750751)*0.5**o
        ref[5,1,0]=(-0.0529104886711)/(o+1.)+(-0.950386978363)+(0.262793971997)*0.5**o
        ref[5,1,1]=(0.520049443126)/(o+1.)+(-0.654040069724)+(-0.417452810992)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.829288219058)*x[0]**o+(-0.65217791272)*x[0]+(0.698846288116)*x[1]**o+(-0.0392705140136)*x[1]
        s[0,0,0,1]=(-0.456023711562)*x[0]**o+(0.9183516109)*x[0]+(0.927490172078)*x[1]**o+(-0.394686077168)*x[1]
        s[0,0,1,0]=(-0.497067376291)*x[0]**o+(0.237428033612)*x[0]+(-0.785186724625)*x[1]**o+(0.471101666176)*x[1]
        s[0,0,1,1]=(-0.290568226175)*x[0]**o+(0.893982019035)*x[0]+(0.203073455207)*x[1]**o+(0.78973496755)*x[1]
        s[0,0,2,0]=(0.00829962077999)*x[0]**o+(0.99718958928)*x[0]+(0.330466533936)*x[1]**o+(-0.619185067306)*x[1]
        s[0,0,2,1]=(-0.806092658508)*x[0]**o+(-0.307457723596)*x[0]+(0.847169623314)*x[1]**o+(-0.832290917062)*x[1]
        s[0,1,0,0]=(-0.140461069383)*x[0]**o+(0.760902362673)*x[0]+(0.0231278168453)*x[1]**o+(-0.508849645358)*x[1]
        s[0,1,0,1]=(0.587581627616)*x[0]**o+(-0.229546331489)*x[0]+(-0.659235919696)*x[1]**o+(0.80409204008)*x[1]
        s[0,1,1,0]=(-0.641654760801)*x[0]**o+(0.122524921907)*x[0]+(0.122921572782)*x[1]**o+(-0.23094495884)*x[1]
        s[0,1,1,1]=(-0.380132178505)*x[0]**o+(-0.769451293694)*x[0]+(-0.745741833491)*x[1]**o+(0.11284350488)*x[1]
        s[0,1,2,0]=(0.126835269214)*x[0]**o+(0.918739367312)*x[0]+(0.927407682128)*x[1]**o+(-0.273231826206)*x[1]
        s[0,1,2,1]=(0.608413549196)*x[0]**o+(-0.591552902664)*x[0]+(0.873696757566)*x[1]**o+(-0.900225496133)*x[1]
        s[0,2,0,0]=(0.0488258290791)*x[0]**o+(0.211067968473)*x[0]+(0.11529432626)*x[1]**o+(0.497957233179)*x[1]
        s[0,2,0,1]=(-0.780993161707)*x[0]**o+(0.746546880275)*x[0]+(-0.0997128168301)*x[1]**o+(-0.663371860066)*x[1]
        s[0,2,1,0]=(0.305794159864)*x[0]**o+(0.493723656879)*x[0]+(0.334264621015)*x[1]**o+(0.0579972251793)*x[1]
        s[0,2,1,1]=(0.71588138307)*x[0]**o+(-0.0866536386387)*x[0]+(-0.159835910161)*x[1]**o+(0.562258753174)*x[1]
        s[0,2,2,0]=(0.864605462382)*x[0]**o+(0.818516795215)*x[0]+(-0.0558026806854)*x[1]**o+(-0.225953364341)*x[1]
        s[0,2,2,1]=(-0.0798994114092)*x[0]**o+(-0.73636091403)*x[0]+(-0.478543932177)*x[1]**o+(0.875789857891)*x[1]
        s[0,3,0,0]=(0.998019190199)*x[0]**o+(-0.218007434364)*x[0]+(0.181378057097)*x[1]**o+(0.429126350197)*x[1]
        s[0,3,0,1]=(-0.724306549649)*x[0]**o+(-0.303805025896)*x[0]+(0.58603690984)*x[1]**o+(0.976611908964)*x[1]
        s[0,3,1,0]=(0.776728843377)*x[0]**o+(-0.874157618694)*x[0]+(-0.590753603973)*x[1]**o+(0.185288488913)*x[1]
        s[0,3,1,1]=(0.285035031516)*x[0]**o+(-0.0667711315126)*x[0]+(0.220692714675)*x[1]**o+(0.841408314724)*x[1]
        s[0,3,2,0]=(-0.00286941650137)*x[0]**o+(0.59339349489)*x[0]+(-0.158356936936)*x[1]**o+(-0.451137261062)*x[1]
        s[0,3,2,1]=(0.37992478387)*x[0]**o+(0.835018328571)*x[0]+(-0.446900268053)*x[1]**o+(-0.700751807162)*x[1]
        s[0,4,0,0]=(0.714232167791)*x[0]**o+(-0.688473756667)*x[0]+(0.0552121131111)*x[1]**o+(0.632003397091)*x[1]
        s[0,4,0,1]=(0.49556700372)*x[0]**o+(0.0630560952096)*x[0]+(0.321456277553)*x[1]**o+(0.685060833092)*x[1]
        s[0,4,1,0]=(0.841677614054)*x[0]**o+(0.886957973836)*x[0]+(0.0202839586672)*x[1]**o+(-0.923265656841)*x[1]
        s[0,4,1,1]=(-0.504028346474)*x[0]**o+(0.071280762432)*x[0]+(0.629772140166)*x[1]**o+(-0.195290635886)*x[1]
        s[0,4,2,0]=(0.434265669856)*x[0]**o+(0.376229784992)*x[0]+(0.919945289519)*x[1]**o+(-0.496219699959)*x[1]
        s[0,4,2,1]=(-0.86013960593)*x[0]**o+(0.140206694208)*x[0]+(-0.834647694686)*x[1]**o+(0.381383127993)*x[1]
        s[1,0,0,0]=(-0.437686950383)*x[0]**o+(0.385307277242)*x[0]+(-0.430841927673)*x[1]**o+(-0.556445729508)*x[1]
        s[1,0,0,1]=(0.323843044435)*x[0]**o+(-0.21417604806)*x[0]+(-0.172390658038)*x[1]**o+(-0.847272401994)*x[1]
        s[1,0,1,0]=(-0.845882465152)*x[0]**o+(-0.598486605858)*x[0]+(0.89008620109)*x[1]**o+(0.874381441062)*x[1]
        s[1,0,1,1]=(-0.405423425934)*x[0]**o+(-0.404267054882)*x[0]+(-0.63801489002)*x[1]**o+(-0.728771425845)*x[1]
        s[1,0,2,0]=(-0.216267078676)*x[0]**o+(0.956804195842)*x[0]+(-0.908451202669)*x[1]**o+(-0.322043280117)*x[1]
        s[1,0,2,1]=(-0.168907777516)*x[0]**o+(0.840516962339)*x[0]+(0.103177353457)*x[1]**o+(0.939190271608)*x[1]
        s[1,1,0,0]=(-0.884189035361)*x[0]**o+(-0.396863590748)*x[0]+(-0.380355614494)*x[1]**o+(0.913843764972)*x[1]
        s[1,1,0,1]=(-0.983514772022)*x[0]**o+(0.953676778353)*x[0]+(-0.141666532996)*x[1]**o+(-0.782763806635)*x[1]
        s[1,1,1,0]=(0.723588279961)*x[0]**o+(0.0698022948292)*x[0]+(-0.202960085361)*x[1]**o+(-0.0971108181392)*x[1]
        s[1,1,1,1]=(-0.809610385863)*x[0]**o+(0.78262340178)*x[0]+(-0.292492437285)*x[1]**o+(0.909658049109)*x[1]
        s[1,1,2,0]=(0.831333270285)*x[0]**o+(0.532412110902)*x[0]+(0.852180039142)*x[1]**o+(-0.126550447094)*x[1]
        s[1,1,2,1]=(0.889635940128)*x[0]**o+(-0.0146231223219)*x[0]+(-0.505300606168)*x[1]**o+(0.286596962758)*x[1]
        s[1,2,0,0]=(-0.479209867816)*x[0]**o+(-0.707176716613)*x[0]+(0.385223744345)*x[1]**o+(0.679335984842)*x[1]
        s[1,2,0,1]=(-0.690494514078)*x[0]**o+(-0.591659781424)*x[0]+(-0.111527008468)*x[1]**o+(0.73261078188)*x[1]
        s[1,2,1,0]=(-0.65110579618)*x[0]**o+(-0.861397125883)*x[0]+(-0.264211841662)*x[1]**o+(0.750122373459)*x[1]
        s[1,2,1,1]=(-0.495114108462)*x[0]**o+(-0.555683103062)*x[0]+(-0.0384737773817)*x[1]**o+(0.422372598888)*x[1]
        s[1,2,2,0]=(-0.846365789548)*x[0]**o+(0.247402342046)*x[0]+(-0.998046573914)*x[1]**o+(0.264003327979)*x[1]
        s[1,2,2,1]=(0.4479853512)*x[0]**o+(-0.502771753169)*x[0]+(-0.366626482676)*x[1]**o+(0.506404378836)*x[1]
        s[1,3,0,0]=(-0.677771809341)*x[0]**o+(-0.105232399291)*x[0]+(0.10440523429)*x[1]**o+(-0.780931426435)*x[1]
        s[1,3,0,1]=(0.549864901432)*x[0]**o+(0.79598502718)*x[0]+(-0.424985507693)*x[1]**o+(-0.649629583228)*x[1]
        s[1,3,1,0]=(0.795465752618)*x[0]**o+(-0.0630573960436)*x[0]+(-0.158966662533)*x[1]**o+(0.888189443186)*x[1]
        s[1,3,1,1]=(-0.395120222846)*x[0]**o+(-0.529551413114)*x[0]+(-0.351127736099)*x[1]**o+(-0.960771541871)*x[1]
        s[1,3,2,0]=(-0.244306249618)*x[0]**o+(0.925164172251)*x[0]+(-0.988402656417)*x[1]**o+(-0.0797097670335)*x[1]
        s[1,3,2,1]=(0.905866127894)*x[0]**o+(0.135673487702)*x[0]+(-0.873223112612)*x[1]**o+(0.598121374326)*x[1]
        s[1,4,0,0]=(0.171338765926)*x[0]**o+(-0.31796084081)*x[0]+(-0.914462477805)*x[1]**o+(0.923691484317)*x[1]
        s[1,4,0,1]=(-0.188491880655)*x[0]**o+(-0.67119846649)*x[0]+(0.488643815471)*x[1]**o+(-0.912992530018)*x[1]
        s[1,4,1,0]=(0.252606322081)*x[0]**o+(0.509944026633)*x[0]+(0.539656085813)*x[1]**o+(0.0286599718948)*x[1]
        s[1,4,1,1]=(0.148934160341)*x[0]**o+(0.50451378885)*x[0]+(0.878910174211)*x[1]**o+(-0.617480145541)*x[1]
        s[1,4,2,0]=(-0.235447116973)*x[0]**o+(0.825149714177)*x[0]+(0.300052096347)*x[1]**o+(-0.360690924033)*x[1]
        s[1,4,2,1]=(0.944445188093)*x[0]**o+(-0.170511625527)*x[0]+(-0.333492913384)*x[1]**o+(0.907577674324)*x[1]
        s[2,0,0,0]=(-0.942092595372)*x[0]**o+(-0.254482071505)*x[0]+(-0.0151488336686)*x[1]**o+(-0.0287652780384)*x[1]
        s[2,0,0,1]=(0.0655506752825)*x[0]**o+(0.898719259761)*x[0]+(0.383024592178)*x[1]**o+(0.0989444595983)*x[1]
        s[2,0,1,0]=(0.291304803618)*x[0]**o+(-0.720915295421)*x[0]+(0.138378684)*x[1]**o+(0.876226100573)*x[1]
        s[2,0,1,1]=(0.0625773477714)*x[0]**o+(-0.0294480886227)*x[0]+(0.736449427619)*x[1]**o+(0.371697786988)*x[1]
        s[2,0,2,0]=(-0.931044858876)*x[0]**o+(0.911308988417)*x[0]+(0.689775520125)*x[1]**o+(0.415135153045)*x[1]
        s[2,0,2,1]=(-0.732200781532)*x[0]**o+(0.395135482591)*x[0]+(-0.619692129874)*x[1]**o+(-0.912759567625)*x[1]
        s[2,1,0,0]=(-0.261557477097)*x[0]**o+(-0.933044351058)*x[0]+(0.0156599006787)*x[1]**o+(-0.082399909281)*x[1]
        s[2,1,0,1]=(0.723444855088)*x[0]**o+(-0.216911506016)*x[0]+(0.604446335087)*x[1]**o+(0.947367685426)*x[1]
        s[2,1,1,0]=(-0.606511927315)*x[0]**o+(0.825992890197)*x[0]+(0.757190663205)*x[1]**o+(-0.0991622858024)*x[1]
        s[2,1,1,1]=(0.45110092033)*x[0]**o+(0.0571087683245)*x[0]+(-0.825169962155)*x[1]**o+(0.557059283915)*x[1]
        s[2,1,2,0]=(-0.612806058565)*x[0]**o+(0.928772523716)*x[0]+(-0.288177463065)*x[1]**o+(0.341361092846)*x[1]
        s[2,1,2,1]=(-0.746890321439)*x[0]**o+(0.893018453839)*x[0]+(0.0308905730956)*x[1]**o+(0.291585488925)*x[1]
        s[2,2,0,0]=(-0.665223434533)*x[0]**o+(-0.997256499342)*x[0]+(-0.134118374176)*x[1]**o+(-0.930692055226)*x[1]
        s[2,2,0,1]=(-0.478607794082)*x[0]**o+(0.0372165046416)*x[0]+(-0.149775511078)*x[1]**o+(-0.412243756318)*x[1]
        s[2,2,1,0]=(-0.782692588953)*x[0]**o+(0.896152570987)*x[0]+(-0.265361365664)*x[1]**o+(0.0859566508122)*x[1]
        s[2,2,1,1]=(0.141591460973)*x[0]**o+(0.399004634853)*x[0]+(0.351166595901)*x[1]**o+(-0.230314460514)*x[1]
        s[2,2,2,0]=(-0.282452862833)*x[0]**o+(0.652348758087)*x[0]+(-0.006664462988)*x[1]**o+(0.115435922234)*x[1]
        s[2,2,2,1]=(-0.108570066423)*x[0]**o+(0.536881567792)*x[0]+(-0.967086006781)*x[1]**o+(0.964315151846)*x[1]
        s[2,3,0,0]=(-0.872481061987)*x[0]**o+(-0.152036048838)*x[0]+(0.714460711637)*x[1]**o+(-0.641192704763)*x[1]
        s[2,3,0,1]=(-0.314322497313)*x[0]**o+(0.766601974446)*x[0]+(-0.304360730035)*x[1]**o+(-0.445351381604)*x[1]
        s[2,3,1,0]=(0.364419198839)*x[0]**o+(-0.615166967343)*x[0]+(0.797973787987)*x[1]**o+(0.312408283718)*x[1]
        s[2,3,1,1]=(-0.781147212189)*x[0]**o+(-0.549359753018)*x[0]+(0.235681715573)*x[1]**o+(-0.231862286881)*x[1]
        s[2,3,2,0]=(-0.958493367772)*x[0]**o+(-0.775968770096)*x[0]+(-0.917090286139)*x[1]**o+(0.656115811881)*x[1]
        s[2,3,2,1]=(0.572779229598)*x[0]**o+(-0.875089280859)*x[0]+(0.575188283953)*x[1]**o+(-0.617895968371)*x[1]
        s[2,4,0,0]=(-0.178437300104)*x[0]**o+(-0.305311887897)*x[0]+(-0.362423234235)*x[1]**o+(-0.993155475703)*x[1]
        s[2,4,0,1]=(-0.842863324823)*x[0]**o+(-0.334505517678)*x[0]+(-0.233874335956)*x[1]**o+(-0.280499554274)*x[1]
        s[2,4,1,0]=(-0.396341438458)*x[0]**o+(0.605087475544)*x[0]+(-0.648099915852)*x[1]**o+(-0.338407917903)*x[1]
        s[2,4,1,1]=(-0.359913098139)*x[0]**o+(0.80935120431)*x[0]+(-0.969248694111)*x[1]**o+(0.884624495846)*x[1]
        s[2,4,2,0]=(0.965251612654)*x[0]**o+(-0.811340257859)*x[0]+(0.960012562229)*x[1]**o+(-0.825791870471)*x[1]
        s[2,4,2,1]=(0.43888464177)*x[0]**o+(0.126116195477)*x[0]+(0.0455614359233)*x[1]**o+(0.387001710336)*x[1]
        s[3,0,0,0]=(0.961744925179)*x[0]**o+(0.590267645729)*x[0]+(-0.657096083564)*x[1]**o+(-0.336931534761)*x[1]
        s[3,0,0,1]=(0.0372329050631)*x[0]**o+(0.82966683846)*x[0]+(-0.537423647089)*x[1]**o+(0.13780696077)*x[1]
        s[3,0,1,0]=(-0.762516609688)*x[0]**o+(-0.619904320036)*x[0]+(0.653234747183)*x[1]**o+(0.3188610791)*x[1]
        s[3,0,1,1]=(-0.749684385643)*x[0]**o+(-0.30857008835)*x[0]+(0.066895978166)*x[1]**o+(-0.603289571527)*x[1]
        s[3,0,2,0]=(-0.621186971872)*x[0]**o+(0.109237849031)*x[0]+(0.312234719711)*x[1]**o+(0.214139545654)*x[1]
        s[3,0,2,1]=(-0.479630544493)*x[0]**o+(0.936515248516)*x[0]+(0.135913071464)*x[1]**o+(0.536193827105)*x[1]
        s[3,1,0,0]=(-0.419606668612)*x[0]**o+(-0.825159184029)*x[0]+(-0.862279634673)*x[1]**o+(0.0205463968802)*x[1]
        s[3,1,0,1]=(0.35798046036)*x[0]**o+(-0.599162907156)*x[0]+(0.174478509759)*x[1]**o+(-0.779627181611)*x[1]
        s[3,1,1,0]=(-0.175201495388)*x[0]**o+(0.754090549688)*x[0]+(-0.131095703521)*x[1]**o+(-0.149892880631)*x[1]
        s[3,1,1,1]=(-0.718173244947)*x[0]**o+(0.387119862798)*x[0]+(-0.190359128182)*x[1]**o+(0.71904977881)*x[1]
        s[3,1,2,0]=(0.542104637274)*x[0]**o+(0.85151096271)*x[0]+(0.0402471065929)*x[1]**o+(-0.276985707209)*x[1]
        s[3,1,2,1]=(-0.612520892999)*x[0]**o+(0.475838856018)*x[0]+(-0.524069927205)*x[1]**o+(-0.314728620326)*x[1]
        s[3,2,0,0]=(0.853018031276)*x[0]**o+(0.783150840935)*x[0]+(-0.168512012086)*x[1]**o+(0.713965998504)*x[1]
        s[3,2,0,1]=(0.253413905488)*x[0]**o+(-0.433043547194)*x[0]+(-0.775710938403)*x[1]**o+(-0.906939451854)*x[1]
        s[3,2,1,0]=(0.6612655067)*x[0]**o+(0.959161354342)*x[0]+(-0.351925885901)*x[1]**o+(-0.542741000383)*x[1]
        s[3,2,1,1]=(-0.651886826012)*x[0]**o+(0.799653456288)*x[0]+(0.482387863091)*x[1]**o+(-0.628626395493)*x[1]
        s[3,2,2,0]=(-0.314962063276)*x[0]**o+(-0.237445058522)*x[0]+(0.983233001597)*x[1]**o+(0.105803386746)*x[1]
        s[3,2,2,1]=(0.786422364797)*x[0]**o+(0.437192400732)*x[0]+(-0.238461142143)*x[1]**o+(0.696286963331)*x[1]
        s[3,3,0,0]=(0.483733340742)*x[0]**o+(0.749644548963)*x[0]+(0.765700270847)*x[1]**o+(-0.470185526075)*x[1]
        s[3,3,0,1]=(0.680316641067)*x[0]**o+(0.952443208592)*x[0]+(-0.0164617510632)*x[1]**o+(-0.234575904406)*x[1]
        s[3,3,1,0]=(-0.993408262104)*x[0]**o+(-0.229008195245)*x[0]+(0.523753196917)*x[1]**o+(-0.318485891049)*x[1]
        s[3,3,1,1]=(-0.748894192494)*x[0]**o+(-0.879841134058)*x[0]+(-0.650074035674)*x[1]**o+(0.07564873608)*x[1]
        s[3,3,2,0]=(-0.0390185724072)*x[0]**o+(0.754358690288)*x[0]+(-0.961050878591)*x[1]**o+(-0.849404044511)*x[1]
        s[3,3,2,1]=(0.483849885635)*x[0]**o+(0.168666402938)*x[0]+(-0.948399681695)*x[1]**o+(-0.923760856309)*x[1]
        s[3,4,0,0]=(0.0487172550208)*x[0]**o+(-0.627393318222)*x[0]+(0.328198988132)*x[1]**o+(0.615434829581)*x[1]
        s[3,4,0,1]=(0.294964552743)*x[0]**o+(0.593632204587)*x[0]+(-0.922244339835)*x[1]**o+(0.712032424818)*x[1]
        s[3,4,1,0]=(-0.774393234162)*x[0]**o+(0.122655955494)*x[0]+(-0.993126331736)*x[1]**o+(0.553836798684)*x[1]
        s[3,4,1,1]=(-0.46041945879)*x[0]**o+(-0.676034356031)*x[0]+(0.273980415493)*x[1]**o+(-0.190839002618)*x[1]
        s[3,4,2,0]=(0.0439333449053)*x[0]**o+(-0.0796104621766)*x[0]+(0.479839558444)*x[1]**o+(-0.0221747154)*x[1]
        s[3,4,2,1]=(-0.2108539974)*x[0]**o+(-0.743095604828)*x[0]+(-0.531276902705)*x[1]**o+(0.286137673119)*x[1]
        ref[0,0,0,0]=(0.698846288116)/(o+1.)+(-0.345724213367)+(-0.829288219058)*0.5**o
        ref[0,0,0,1]=(0.927490172078)/(o+1.)+(0.261832766866)+(-0.456023711562)*0.5**o
        ref[0,0,1,0]=(-0.785186724625)/(o+1.)+(0.354264849894)+(-0.497067376291)*0.5**o
        ref[0,0,1,1]=(0.203073455207)/(o+1.)+(0.841858493293)+(-0.290568226175)*0.5**o
        ref[0,0,2,0]=(0.330466533936)/(o+1.)+(0.189002260987)+(0.00829962077999)*0.5**o
        ref[0,0,2,1]=(0.847169623314)/(o+1.)+(-0.569874320329)+(-0.806092658508)*0.5**o
        ref[0,1,0,0]=(0.0231278168453)/(o+1.)+(0.126026358657)+(-0.140461069383)*0.5**o
        ref[0,1,0,1]=(-0.659235919696)/(o+1.)+(0.287272854295)+(0.587581627616)*0.5**o
        ref[0,1,1,0]=(0.122921572782)/(o+1.)+(-0.0542100184667)+(-0.641654760801)*0.5**o
        ref[0,1,1,1]=(-0.745741833491)/(o+1.)+(-0.328303894407)+(-0.380132178505)*0.5**o
        ref[0,1,2,0]=(0.927407682128)/(o+1.)+(0.322753770553)+(0.126835269214)*0.5**o
        ref[0,1,2,1]=(0.873696757566)/(o+1.)+(-0.745889199398)+(0.608413549196)*0.5**o
        ref[0,2,0,0]=(0.11529432626)/(o+1.)+(0.354512600826)+(0.0488258290791)*0.5**o
        ref[0,2,0,1]=(-0.0997128168301)/(o+1.)+(0.0415875101043)+(-0.780993161707)*0.5**o
        ref[0,2,1,0]=(0.334264621015)/(o+1.)+(0.275860441029)+(0.305794159864)*0.5**o
        ref[0,2,1,1]=(-0.159835910161)/(o+1.)+(0.237802557268)+(0.71588138307)*0.5**o
        ref[0,2,2,0]=(-0.0558026806854)/(o+1.)+(0.296281715437)+(0.864605462382)*0.5**o
        ref[0,2,2,1]=(-0.478543932177)/(o+1.)+(0.0697144719306)+(-0.0798994114092)*0.5**o
        ref[0,3,0,0]=(0.181378057097)/(o+1.)+(0.105559457917)+(0.998019190199)*0.5**o
        ref[0,3,0,1]=(0.58603690984)/(o+1.)+(0.336403441534)+(-0.724306549649)*0.5**o
        ref[0,3,1,0]=(-0.590753603973)/(o+1.)+(-0.34443456489)+(0.776728843377)*0.5**o
        ref[0,3,1,1]=(0.220692714675)/(o+1.)+(0.387318591606)+(0.285035031516)*0.5**o
        ref[0,3,2,0]=(-0.158356936936)/(o+1.)+(0.0711281169143)+(-0.00286941650137)*0.5**o
        ref[0,3,2,1]=(-0.446900268053)/(o+1.)+(0.0671332607043)+(0.37992478387)*0.5**o
        ref[0,4,0,0]=(0.0552121131111)/(o+1.)+(-0.0282351797878)+(0.714232167791)*0.5**o
        ref[0,4,0,1]=(0.321456277553)/(o+1.)+(0.374058464151)+(0.49556700372)*0.5**o
        ref[0,4,1,0]=(0.0202839586672)/(o+1.)+(-0.0181538415026)+(0.841677614054)*0.5**o
        ref[0,4,1,1]=(0.629772140166)/(o+1.)+(-0.062004936727)+(-0.504028346474)*0.5**o
        ref[0,4,2,0]=(0.919945289519)/(o+1.)+(-0.0599949574834)+(0.434265669856)*0.5**o
        ref[0,4,2,1]=(-0.834647694686)/(o+1.)+(0.2607949111)+(-0.86013960593)*0.5**o
        ref[1,0,0,0]=(-0.430841927673)/(o+1.)+(-0.0855692261333)+(-0.437686950383)*0.5**o
        ref[1,0,0,1]=(-0.172390658038)/(o+1.)+(-0.530724225027)+(0.323843044435)*0.5**o
        ref[1,0,1,0]=(0.89008620109)/(o+1.)+(0.137947417602)+(-0.845882465152)*0.5**o
        ref[1,0,1,1]=(-0.63801489002)/(o+1.)+(-0.566519240363)+(-0.405423425934)*0.5**o
        ref[1,0,2,0]=(-0.908451202669)/(o+1.)+(0.317380457863)+(-0.216267078676)*0.5**o
        ref[1,0,2,1]=(0.103177353457)/(o+1.)+(0.889853616974)+(-0.168907777516)*0.5**o
        ref[1,1,0,0]=(-0.380355614494)/(o+1.)+(0.258490087112)+(-0.884189035361)*0.5**o
        ref[1,1,0,1]=(-0.141666532996)/(o+1.)+(0.0854564858592)+(-0.983514772022)*0.5**o
        ref[1,1,1,0]=(-0.202960085361)/(o+1.)+(-0.013654261655)+(0.723588279961)*0.5**o
        ref[1,1,1,1]=(-0.292492437285)/(o+1.)+(0.846140725444)+(-0.809610385863)*0.5**o
        ref[1,1,2,0]=(0.852180039142)/(o+1.)+(0.202930831904)+(0.831333270285)*0.5**o
        ref[1,1,2,1]=(-0.505300606168)/(o+1.)+(0.135986920218)+(0.889635940128)*0.5**o
        ref[1,2,0,0]=(0.385223744345)/(o+1.)+(-0.0139203658855)+(-0.479209867816)*0.5**o
        ref[1,2,0,1]=(-0.111527008468)/(o+1.)+(0.0704755002279)+(-0.690494514078)*0.5**o
        ref[1,2,1,0]=(-0.264211841662)/(o+1.)+(-0.055637376212)+(-0.65110579618)*0.5**o
        ref[1,2,1,1]=(-0.0384737773817)/(o+1.)+(-0.066655252087)+(-0.495114108462)*0.5**o
        ref[1,2,2,0]=(-0.998046573914)/(o+1.)+(0.255702835012)+(-0.846365789548)*0.5**o
        ref[1,2,2,1]=(-0.366626482676)/(o+1.)+(0.00181631283349)+(0.4479853512)*0.5**o
        ref[1,3,0,0]=(0.10440523429)/(o+1.)+(-0.443081912863)+(-0.677771809341)*0.5**o
        ref[1,3,0,1]=(-0.424985507693)/(o+1.)+(0.0731777219764)+(0.549864901432)*0.5**o
        ref[1,3,1,0]=(-0.158966662533)/(o+1.)+(0.412566023571)+(0.795465752618)*0.5**o
        ref[1,3,1,1]=(-0.351127736099)/(o+1.)+(-0.745161477493)+(-0.395120222846)*0.5**o
        ref[1,3,2,0]=(-0.988402656417)/(o+1.)+(0.422727202609)+(-0.244306249618)*0.5**o
        ref[1,3,2,1]=(-0.873223112612)/(o+1.)+(0.366897431014)+(0.905866127894)*0.5**o
        ref[1,4,0,0]=(-0.914462477805)/(o+1.)+(0.302865321753)+(0.171338765926)*0.5**o
        ref[1,4,0,1]=(0.488643815471)/(o+1.)+(-0.792095498254)+(-0.188491880655)*0.5**o
        ref[1,4,1,0]=(0.539656085813)/(o+1.)+(0.269301999264)+(0.252606322081)*0.5**o
        ref[1,4,1,1]=(0.878910174211)/(o+1.)+(-0.0564831783457)+(0.148934160341)*0.5**o
        ref[1,4,2,0]=(0.300052096347)/(o+1.)+(0.232229395072)+(-0.235447116973)*0.5**o
        ref[1,4,2,1]=(-0.333492913384)/(o+1.)+(0.368533024398)+(0.944445188093)*0.5**o
        ref[2,0,0,0]=(-0.0151488336686)/(o+1.)+(-0.141623674772)+(-0.942092595372)*0.5**o
        ref[2,0,0,1]=(0.383024592178)/(o+1.)+(0.498831859679)+(0.0655506752825)*0.5**o
        ref[2,0,1,0]=(0.138378684)/(o+1.)+(0.0776554025757)+(0.291304803618)*0.5**o
        ref[2,0,1,1]=(0.736449427619)/(o+1.)+(0.171124849182)+(0.0625773477714)*0.5**o
        ref[2,0,2,0]=(0.689775520125)/(o+1.)+(0.663222070731)+(-0.931044858876)*0.5**o
        ref[2,0,2,1]=(-0.619692129874)/(o+1.)+(-0.258812042517)+(-0.732200781532)*0.5**o
        ref[2,1,0,0]=(0.0156599006787)/(o+1.)+(-0.507722130169)+(-0.261557477097)*0.5**o
        ref[2,1,0,1]=(0.604446335087)/(o+1.)+(0.365228089705)+(0.723444855088)*0.5**o
        ref[2,1,1,0]=(0.757190663205)/(o+1.)+(0.363415302197)+(-0.606511927315)*0.5**o
        ref[2,1,1,1]=(-0.825169962155)/(o+1.)+(0.30708402612)+(0.45110092033)*0.5**o
        ref[2,1,2,0]=(-0.288177463065)/(o+1.)+(0.635066808281)+(-0.612806058565)*0.5**o
        ref[2,1,2,1]=(0.0308905730956)/(o+1.)+(0.592301971382)+(-0.746890321439)*0.5**o
        ref[2,2,0,0]=(-0.134118374176)/(o+1.)+(-0.963974277284)+(-0.665223434533)*0.5**o
        ref[2,2,0,1]=(-0.149775511078)/(o+1.)+(-0.187513625838)+(-0.478607794082)*0.5**o
        ref[2,2,1,0]=(-0.265361365664)/(o+1.)+(0.4910546109)+(-0.782692588953)*0.5**o
        ref[2,2,1,1]=(0.351166595901)/(o+1.)+(0.0843450871693)+(0.141591460973)*0.5**o
        ref[2,2,2,0]=(-0.006664462988)/(o+1.)+(0.383892340161)+(-0.282452862833)*0.5**o
        ref[2,2,2,1]=(-0.967086006781)/(o+1.)+(0.750598359819)+(-0.108570066423)*0.5**o
        ref[2,3,0,0]=(0.714460711637)/(o+1.)+(-0.3966143768)+(-0.872481061987)*0.5**o
        ref[2,3,0,1]=(-0.304360730035)/(o+1.)+(0.160625296421)+(-0.314322497313)*0.5**o
        ref[2,3,1,0]=(0.797973787987)/(o+1.)+(-0.151379341813)+(0.364419198839)*0.5**o
        ref[2,3,1,1]=(0.235681715573)/(o+1.)+(-0.390611019949)+(-0.781147212189)*0.5**o
        ref[2,3,2,0]=(-0.917090286139)/(o+1.)+(-0.0599264791076)+(-0.958493367772)*0.5**o
        ref[2,3,2,1]=(0.575188283953)/(o+1.)+(-0.746492624615)+(0.572779229598)*0.5**o
        ref[2,4,0,0]=(-0.362423234235)/(o+1.)+(-0.6492336818)+(-0.178437300104)*0.5**o
        ref[2,4,0,1]=(-0.233874335956)/(o+1.)+(-0.307502535976)+(-0.842863324823)*0.5**o
        ref[2,4,1,0]=(-0.648099915852)/(o+1.)+(0.133339778821)+(-0.396341438458)*0.5**o
        ref[2,4,1,1]=(-0.969248694111)/(o+1.)+(0.846987850078)+(-0.359913098139)*0.5**o
        ref[2,4,2,0]=(0.960012562229)/(o+1.)+(-0.818566064165)+(0.965251612654)*0.5**o
        ref[2,4,2,1]=(0.0455614359233)/(o+1.)+(0.256558952907)+(0.43888464177)*0.5**o
        ref[3,0,0,0]=(-0.657096083564)/(o+1.)+(0.126668055484)+(0.961744925179)*0.5**o
        ref[3,0,0,1]=(-0.537423647089)/(o+1.)+(0.483736899615)+(0.0372329050631)*0.5**o
        ref[3,0,1,0]=(0.653234747183)/(o+1.)+(-0.150521620468)+(-0.762516609688)*0.5**o
        ref[3,0,1,1]=(0.066895978166)/(o+1.)+(-0.455929829939)+(-0.749684385643)*0.5**o
        ref[3,0,2,0]=(0.312234719711)/(o+1.)+(0.161688697343)+(-0.621186971872)*0.5**o
        ref[3,0,2,1]=(0.135913071464)/(o+1.)+(0.73635453781)+(-0.479630544493)*0.5**o
        ref[3,1,0,0]=(-0.862279634673)/(o+1.)+(-0.402306393574)+(-0.419606668612)*0.5**o
        ref[3,1,0,1]=(0.174478509759)/(o+1.)+(-0.689395044384)+(0.35798046036)*0.5**o
        ref[3,1,1,0]=(-0.131095703521)/(o+1.)+(0.302098834529)+(-0.175201495388)*0.5**o
        ref[3,1,1,1]=(-0.190359128182)/(o+1.)+(0.553084820804)+(-0.718173244947)*0.5**o
        ref[3,1,2,0]=(0.0402471065929)/(o+1.)+(0.28726262775)+(0.542104637274)*0.5**o
        ref[3,1,2,1]=(-0.524069927205)/(o+1.)+(0.0805551178455)+(-0.612520892999)*0.5**o
        ref[3,2,0,0]=(-0.168512012086)/(o+1.)+(0.748558419719)+(0.853018031276)*0.5**o
        ref[3,2,0,1]=(-0.775710938403)/(o+1.)+(-0.669991499524)+(0.253413905488)*0.5**o
        ref[3,2,1,0]=(-0.351925885901)/(o+1.)+(0.20821017698)+(0.6612655067)*0.5**o
        ref[3,2,1,1]=(0.482387863091)/(o+1.)+(0.0855135303978)+(-0.651886826012)*0.5**o
        ref[3,2,2,0]=(0.983233001597)/(o+1.)+(-0.0658208358883)+(-0.314962063276)*0.5**o
        ref[3,2,2,1]=(-0.238461142143)/(o+1.)+(0.566739682031)+(0.786422364797)*0.5**o
        ref[3,3,0,0]=(0.765700270847)/(o+1.)+(0.139729511444)+(0.483733340742)*0.5**o
        ref[3,3,0,1]=(-0.0164617510632)/(o+1.)+(0.358933652093)+(0.680316641067)*0.5**o
        ref[3,3,1,0]=(0.523753196917)/(o+1.)+(-0.273747043147)+(-0.993408262104)*0.5**o
        ref[3,3,1,1]=(-0.650074035674)/(o+1.)+(-0.402096198989)+(-0.748894192494)*0.5**o
        ref[3,3,2,0]=(-0.961050878591)/(o+1.)+(-0.0475226771118)+(-0.0390185724072)*0.5**o
        ref[3,3,2,1]=(-0.948399681695)/(o+1.)+(-0.377547226685)+(0.483849885635)*0.5**o
        ref[3,4,0,0]=(0.328198988132)/(o+1.)+(-0.00597924432023)+(0.0487172550208)*0.5**o
        ref[3,4,0,1]=(-0.922244339835)/(o+1.)+(0.652832314702)+(0.294964552743)*0.5**o
        ref[3,4,1,0]=(-0.993126331736)/(o+1.)+(0.338246377089)+(-0.774393234162)*0.5**o
        ref[3,4,1,1]=(0.273980415493)/(o+1.)+(-0.433436679324)+(-0.46041945879)*0.5**o
        ref[3,4,2,0]=(0.479839558444)/(o+1.)+(-0.0508925887883)+(0.0439333449053)*0.5**o
        ref[3,4,2,1]=(-0.531276902705)/(o+1.)+(-0.228478965855)+(-0.2108539974)*0.5**o
      else:
        s[0,0,0,0]=(-0.48893267678)*x[0]**o+(-0.276480532077)*x[0]+(0.774386441775)*x[1]**o+(-0.649500271111)*x[1]+(-0.0349902316269)*x[2]**o+(0.170017460369)*x[2]
        s[0,0,0,1]=(0.271529548298)*x[0]**o+(-0.318825369645)*x[0]+(0.304421796509)*x[1]**o+(0.445685002224)*x[1]+(0.0335660627736)*x[2]**o+(-0.498125294129)*x[2]
        s[0,0,1,0]=(0.217379546035)*x[0]**o+(0.0217166724721)*x[0]+(0.845692481133)*x[1]**o+(0.991062940209)*x[1]+(-0.504574922644)*x[2]**o+(-0.442660078459)*x[2]
        s[0,0,1,1]=(0.042921886647)*x[0]**o+(0.223486944232)*x[0]+(0.0494176704553)*x[1]**o+(0.96519307605)*x[1]+(-0.138757753118)*x[2]**o+(0.0467978128441)*x[2]
        s[0,0,2,0]=(-0.386813522991)*x[0]**o+(-0.460337705352)*x[0]+(0.868148506432)*x[1]**o+(-0.639578197438)*x[1]+(0.344241610414)*x[2]**o+(-0.340649859294)*x[2]
        s[0,0,2,1]=(0.270966465259)*x[0]**o+(-0.921862313681)*x[0]+(0.419658509548)*x[1]**o+(0.382347312575)*x[1]+(-0.458089861176)*x[2]**o+(-0.680587978014)*x[2]
        s[0,1,0,0]=(0.341922361346)*x[0]**o+(0.992862705739)*x[0]+(0.664064252002)*x[1]**o+(-0.976539711563)*x[1]+(-0.336860627327)*x[2]**o+(0.0351493378936)*x[2]
        s[0,1,0,1]=(0.232432790902)*x[0]**o+(0.661576839972)*x[0]+(-0.0847723144646)*x[1]**o+(0.676452509633)*x[1]+(-0.523713339087)*x[2]**o+(-0.944537647834)*x[2]
        s[0,1,1,0]=(-0.0195600321657)*x[0]**o+(0.548788073658)*x[0]+(0.732671243649)*x[1]**o+(-0.559596045627)*x[1]+(-0.821347880719)*x[2]**o+(0.523044807739)*x[2]
        s[0,1,1,1]=(0.440682443808)*x[0]**o+(0.489252739473)*x[0]+(-0.0286407968844)*x[1]**o+(0.389892189545)*x[1]+(0.802377372742)*x[2]**o+(-0.848679176767)*x[2]
        s[0,1,2,0]=(0.0308644963019)*x[0]**o+(-0.838818939488)*x[0]+(-0.923147289871)*x[1]**o+(-0.898497578423)*x[1]+(0.352358085546)*x[2]**o+(-0.0551880704817)*x[2]
        s[0,1,2,1]=(0.964064258383)*x[0]**o+(0.889207476385)*x[0]+(-0.446058209666)*x[1]**o+(-0.410646592871)*x[1]+(-0.143876047927)*x[2]**o+(-0.231175626697)*x[2]
        s[0,2,0,0]=(-0.378594793341)*x[0]**o+(0.45713093072)*x[0]+(-0.0164617155479)*x[1]**o+(-0.852502076132)*x[1]+(-0.445860749107)*x[2]**o+(0.718303558387)*x[2]
        s[0,2,0,1]=(-0.24119818585)*x[0]**o+(-0.480829504364)*x[0]+(0.0483190702959)*x[1]**o+(-0.943891784533)*x[1]+(0.822005676991)*x[2]**o+(0.462965609893)*x[2]
        s[0,2,1,0]=(0.260426222503)*x[0]**o+(0.801642256974)*x[0]+(-0.344027586708)*x[1]**o+(0.609754775626)*x[1]+(-0.614003273478)*x[2]**o+(0.254286708707)*x[2]
        s[0,2,1,1]=(-0.585208459519)*x[0]**o+(0.409783580697)*x[0]+(0.675131095845)*x[1]**o+(0.962899493666)*x[1]+(-0.555202089686)*x[2]**o+(0.55800653582)*x[2]
        s[0,2,2,0]=(0.926784535292)*x[0]**o+(0.366810833854)*x[0]+(0.280209292502)*x[1]**o+(0.455075782363)*x[1]+(0.315470862333)*x[2]**o+(0.804139765801)*x[2]
        s[0,2,2,1]=(-0.182330163829)*x[0]**o+(0.137160802887)*x[0]+(0.50089868344)*x[1]**o+(0.457091587964)*x[1]+(0.661074305613)*x[2]**o+(-0.774463051929)*x[2]
        s[0,3,0,0]=(0.251053015385)*x[0]**o+(-0.00252354996738)*x[0]+(0.219814741857)*x[1]**o+(-0.788960481779)*x[1]+(-0.628563574142)*x[2]**o+(0.238508420102)*x[2]
        s[0,3,0,1]=(-0.885181589797)*x[0]**o+(0.524674512592)*x[0]+(-0.137981402257)*x[1]**o+(-0.57775224131)*x[1]+(-0.151536711237)*x[2]**o+(0.147483336195)*x[2]
        s[0,3,1,0]=(0.464501690982)*x[0]**o+(0.477393661278)*x[0]+(-0.913546513036)*x[1]**o+(0.209928665471)*x[1]+(0.552522027491)*x[2]**o+(-0.200580731655)*x[2]
        s[0,3,1,1]=(0.117929836206)*x[0]**o+(-0.973701486459)*x[0]+(-0.876411386461)*x[1]**o+(-0.511161888778)*x[1]+(0.213923028781)*x[2]**o+(0.620921035428)*x[2]
        s[0,3,2,0]=(0.228255426058)*x[0]**o+(-0.135554118227)*x[0]+(0.607714808043)*x[1]**o+(0.522943351003)*x[1]+(-0.686514740068)*x[2]**o+(-0.238689322489)*x[2]
        s[0,3,2,1]=(-0.155365105782)*x[0]**o+(0.28572413448)*x[0]+(-0.452657577548)*x[1]**o+(-0.884598572632)*x[1]+(0.279309317605)*x[2]**o+(-0.523804815006)*x[2]
        s[0,4,0,0]=(-0.913401118579)*x[0]**o+(0.141999285441)*x[0]+(-0.0373272930617)*x[1]**o+(-0.907472677652)*x[1]+(0.648778084537)*x[2]**o+(0.905348717002)*x[2]
        s[0,4,0,1]=(0.272596166342)*x[0]**o+(0.523354359959)*x[0]+(-0.597238366724)*x[1]**o+(-0.57955847031)*x[1]+(0.961129977909)*x[2]**o+(-0.539446933115)*x[2]
        s[0,4,1,0]=(0.469445737741)*x[0]**o+(0.272602303288)*x[0]+(-0.168715269045)*x[1]**o+(-0.508483179891)*x[1]+(-0.0542883418628)*x[2]**o+(-0.549230857829)*x[2]
        s[0,4,1,1]=(-0.727336869594)*x[0]**o+(0.501720827606)*x[0]+(0.0112875501961)*x[1]**o+(-0.195351938275)*x[1]+(0.477540723998)*x[2]**o+(0.314035857499)*x[2]
        s[0,4,2,0]=(-0.826661708611)*x[0]**o+(-0.453403968062)*x[0]+(-0.424265582853)*x[1]**o+(0.850699490929)*x[1]+(0.869873737156)*x[2]**o+(0.512188794374)*x[2]
        s[0,4,2,1]=(0.788019130522)*x[0]**o+(-0.38976086271)*x[0]+(0.450211292079)*x[1]**o+(-0.845896268738)*x[1]+(-0.944295444764)*x[2]**o+(0.49424688571)*x[2]
        s[1,0,0,0]=(0.251841546653)*x[0]**o+(-0.262117658277)*x[0]+(-0.756023145868)*x[1]**o+(0.562918802897)*x[1]+(0.999897367962)*x[2]**o+(-0.438732703957)*x[2]
        s[1,0,0,1]=(0.0702543485705)*x[0]**o+(0.553020799687)*x[0]+(0.129510978458)*x[1]**o+(-0.287781735231)*x[1]+(0.0962686272734)*x[2]**o+(-0.153713487101)*x[2]
        s[1,0,1,0]=(0.0132145791001)*x[0]**o+(-0.747224756368)*x[0]+(0.533216099372)*x[1]**o+(0.651501143279)*x[1]+(0.275246126663)*x[2]**o+(0.564330219864)*x[2]
        s[1,0,1,1]=(0.00555685773193)*x[0]**o+(-0.912265903466)*x[0]+(-0.165714475359)*x[1]**o+(-0.29550893963)*x[1]+(-0.834017179013)*x[2]**o+(-0.66051475999)*x[2]
        s[1,0,2,0]=(-0.937628377428)*x[0]**o+(0.670046440332)*x[0]+(-0.836211833803)*x[1]**o+(0.294767128956)*x[1]+(-0.0831464801716)*x[2]**o+(0.173538164187)*x[2]
        s[1,0,2,1]=(0.0853414413422)*x[0]**o+(0.332113726085)*x[0]+(-0.00785676889602)*x[1]**o+(-0.787517944282)*x[1]+(0.640692804663)*x[2]**o+(0.16190882793)*x[2]
        s[1,1,0,0]=(-0.197717271419)*x[0]**o+(0.0875673864383)*x[0]+(0.303400667777)*x[1]**o+(0.561096499643)*x[1]+(-0.544100296942)*x[2]**o+(-0.236967889808)*x[2]
        s[1,1,0,1]=(0.378319093831)*x[0]**o+(-0.173085814456)*x[0]+(-0.520972068858)*x[1]**o+(-0.0887121930691)*x[1]+(0.0219775149259)*x[2]**o+(-0.902192785902)*x[2]
        s[1,1,1,0]=(-0.0852354427742)*x[0]**o+(-0.868052438949)*x[0]+(-0.962245566851)*x[1]**o+(-0.785773600296)*x[1]+(0.871469592508)*x[2]**o+(0.970335434685)*x[2]
        s[1,1,1,1]=(0.543079304077)*x[0]**o+(0.563798729263)*x[0]+(-0.0684074924309)*x[1]**o+(-0.0846345417372)*x[1]+(-0.0409611114801)*x[2]**o+(0.064168518437)*x[2]
        s[1,1,2,0]=(0.163126135652)*x[0]**o+(0.550910259467)*x[0]+(-0.838398060114)*x[1]**o+(0.20704094128)*x[1]+(-0.988745842471)*x[2]**o+(-0.238812411091)*x[2]
        s[1,1,2,1]=(-0.4311680318)*x[0]**o+(-0.689268700879)*x[0]+(-0.478591190853)*x[1]**o+(-0.935785118221)*x[1]+(0.681916835809)*x[2]**o+(0.316911720884)*x[2]
        s[1,2,0,0]=(-0.823741968282)*x[0]**o+(0.337348902553)*x[0]+(-0.773958391461)*x[1]**o+(0.319484407204)*x[1]+(-0.806392888327)*x[2]**o+(0.784342104197)*x[2]
        s[1,2,0,1]=(-0.271373691068)*x[0]**o+(-0.674977315639)*x[0]+(-0.73119288706)*x[1]**o+(-0.822294334638)*x[1]+(-0.348777213792)*x[2]**o+(0.539498527057)*x[2]
        s[1,2,1,0]=(-0.197804966703)*x[0]**o+(-0.000545898061773)*x[0]+(-0.477781076232)*x[1]**o+(-0.726309620722)*x[1]+(0.33565493623)*x[2]**o+(-0.472018740475)*x[2]
        s[1,2,1,1]=(0.985473777724)*x[0]**o+(-0.905489956976)*x[0]+(0.542738966677)*x[1]**o+(0.405770678949)*x[1]+(0.742199205539)*x[2]**o+(-0.834198356515)*x[2]
        s[1,2,2,0]=(0.0963375474866)*x[0]**o+(-0.702341975163)*x[0]+(-0.719805210146)*x[1]**o+(-0.573969955879)*x[1]+(0.849036302763)*x[2]**o+(-0.050325972969)*x[2]
        s[1,2,2,1]=(-0.000809557040863)*x[0]**o+(-0.298554227357)*x[0]+(-0.257571070168)*x[1]**o+(0.902842431485)*x[1]+(-0.565532231171)*x[2]**o+(-0.0268976084038)*x[2]
        s[1,3,0,0]=(-0.450224087014)*x[0]**o+(0.644911723614)*x[0]+(0.585908753859)*x[1]**o+(0.192087613433)*x[1]+(0.37463835574)*x[2]**o+(-0.858368552725)*x[2]
        s[1,3,0,1]=(-0.211716554169)*x[0]**o+(0.133373638633)*x[0]+(-0.477897006462)*x[1]**o+(-0.856170108137)*x[1]+(0.709445201671)*x[2]**o+(0.999843178308)*x[2]
        s[1,3,1,0]=(0.469992449976)*x[0]**o+(-0.547601912734)*x[0]+(-0.652917936853)*x[1]**o+(-0.973841854379)*x[1]+(0.346404346699)*x[2]**o+(0.960819995744)*x[2]
        s[1,3,1,1]=(-0.9202597392)*x[0]**o+(0.476802978382)*x[0]+(-0.106899807732)*x[1]**o+(-0.704577566959)*x[1]+(-0.331549015764)*x[2]**o+(0.936043692204)*x[2]
        s[1,3,2,0]=(0.724283786459)*x[0]**o+(0.822984194337)*x[0]+(0.705848034385)*x[1]**o+(-0.59858805565)*x[1]+(0.350635957833)*x[2]**o+(0.882807237348)*x[2]
        s[1,3,2,1]=(-0.582421422441)*x[0]**o+(0.809035080665)*x[0]+(-0.457851306764)*x[1]**o+(-0.993328352221)*x[1]+(-0.576322826333)*x[2]**o+(-0.749512812669)*x[2]
        s[1,4,0,0]=(0.268654181239)*x[0]**o+(-0.902343324019)*x[0]+(0.638580048206)*x[1]**o+(-0.832694904209)*x[1]+(-0.305201732282)*x[2]**o+(-0.867754959197)*x[2]
        s[1,4,0,1]=(-0.526400834988)*x[0]**o+(-0.40198050654)*x[0]+(0.337289899423)*x[1]**o+(0.179314676284)*x[1]+(-0.931514578551)*x[2]**o+(-0.449197337162)*x[2]
        s[1,4,1,0]=(0.912742445536)*x[0]**o+(-0.815137545811)*x[0]+(-0.38425815792)*x[1]**o+(-0.713804511416)*x[1]+(-0.0940645853762)*x[2]**o+(-0.184482970408)*x[2]
        s[1,4,1,1]=(0.0912352323191)*x[0]**o+(0.990389316513)*x[0]+(-0.0350410457429)*x[1]**o+(0.80277947226)*x[1]+(0.35771085432)*x[2]**o+(0.704976740376)*x[2]
        s[1,4,2,0]=(-0.212374984853)*x[0]**o+(0.115911507956)*x[0]+(0.743357884785)*x[1]**o+(-0.351179816129)*x[1]+(0.363783848165)*x[2]**o+(0.0667503905017)*x[2]
        s[1,4,2,1]=(-0.192346087265)*x[0]**o+(-0.875505251594)*x[0]+(0.450972468787)*x[1]**o+(0.0441627318307)*x[1]+(-0.955445583779)*x[2]**o+(0.561351576194)*x[2]
        s[2,0,0,0]=(0.646959412154)*x[0]**o+(0.49125803323)*x[0]+(-0.380573298578)*x[1]**o+(0.5795381042)*x[1]+(0.988167811553)*x[2]**o+(-0.848010513202)*x[2]
        s[2,0,0,1]=(-0.116490832795)*x[0]**o+(-0.413497866427)*x[0]+(0.015263239692)*x[1]**o+(0.995022978956)*x[1]+(-0.606550379921)*x[2]**o+(0.480728880447)*x[2]
        s[2,0,1,0]=(-0.656776412474)*x[0]**o+(0.105101642124)*x[0]+(-0.152043267549)*x[1]**o+(0.0397914854834)*x[1]+(0.907598907718)*x[2]**o+(0.55003346668)*x[2]
        s[2,0,1,1]=(-0.244997314762)*x[0]**o+(-0.180839249852)*x[0]+(0.737654816515)*x[1]**o+(-0.316505218599)*x[1]+(-0.467254068865)*x[2]**o+(0.642411232963)*x[2]
        s[2,0,2,0]=(0.427359531608)*x[0]**o+(0.0694309336993)*x[0]+(0.567819273901)*x[1]**o+(0.302951042003)*x[1]+(-0.652475445869)*x[2]**o+(-0.0604300175636)*x[2]
        s[2,0,2,1]=(-0.28054117321)*x[0]**o+(-0.506627838493)*x[0]+(0.830518434434)*x[1]**o+(-0.878165796713)*x[1]+(-0.924137956967)*x[2]**o+(-0.542977024006)*x[2]
        s[2,1,0,0]=(0.832323847638)*x[0]**o+(0.788814796981)*x[0]+(0.443003510301)*x[1]**o+(-0.692364079852)*x[1]+(-0.107112423673)*x[2]**o+(-0.42975252335)*x[2]
        s[2,1,0,1]=(0.791743274331)*x[0]**o+(0.506185826171)*x[0]+(0.880323084905)*x[1]**o+(0.875445981105)*x[1]+(-0.988158636575)*x[2]**o+(0.0106467506338)*x[2]
        s[2,1,1,0]=(-0.0716642151005)*x[0]**o+(0.184121338207)*x[0]+(0.563163918743)*x[1]**o+(-0.0476664508964)*x[1]+(-0.779735247644)*x[2]**o+(0.0532353296963)*x[2]
        s[2,1,1,1]=(-0.487936865731)*x[0]**o+(0.910882234056)*x[0]+(0.0698617623832)*x[1]**o+(0.949481044342)*x[1]+(0.605781066129)*x[2]**o+(-0.961538763982)*x[2]
        s[2,1,2,0]=(-0.865760152137)*x[0]**o+(0.98792005348)*x[0]+(-0.266208542741)*x[1]**o+(0.724207675193)*x[1]+(-0.431135420169)*x[2]**o+(-0.719606907727)*x[2]
        s[2,1,2,1]=(-0.550134186201)*x[0]**o+(0.377678575292)*x[0]+(0.681637629077)*x[1]**o+(0.880510886804)*x[1]+(0.185916696615)*x[2]**o+(-0.561352445373)*x[2]
        s[2,2,0,0]=(-0.0191940498302)*x[0]**o+(0.92499736077)*x[0]+(-0.457609595358)*x[1]**o+(0.295953391548)*x[1]+(-0.60039707059)*x[2]**o+(0.439541541552)*x[2]
        s[2,2,0,1]=(-0.593353550722)*x[0]**o+(-0.262307597953)*x[0]+(0.0707406713996)*x[1]**o+(0.510104333108)*x[1]+(-0.325033325591)*x[2]**o+(-0.978979243989)*x[2]
        s[2,2,1,0]=(0.758386313418)*x[0]**o+(-0.904849079285)*x[0]+(0.517417240328)*x[1]**o+(0.662794014603)*x[1]+(-0.9181308007)*x[2]**o+(0.545716036213)*x[2]
        s[2,2,1,1]=(-0.0562030350565)*x[0]**o+(-0.187267436123)*x[0]+(-0.0666932679699)*x[1]**o+(-0.192661397505)*x[1]+(0.683795366538)*x[2]**o+(0.554493956469)*x[2]
        s[2,2,2,0]=(0.632035307709)*x[0]**o+(-0.352426434378)*x[0]+(-0.572996524284)*x[1]**o+(-0.260948177348)*x[1]+(0.0781523669039)*x[2]**o+(-0.755607733499)*x[2]
        s[2,2,2,1]=(0.877117460076)*x[0]**o+(-0.368983710962)*x[0]+(0.339499499347)*x[1]**o+(-0.74687226645)*x[1]+(-0.0236621043423)*x[2]**o+(-0.524200850201)*x[2]
        s[2,3,0,0]=(0.868438479199)*x[0]**o+(-0.490384020524)*x[0]+(-0.348975370347)*x[1]**o+(0.0689779831612)*x[1]+(0.993171286973)*x[2]**o+(0.238168596199)*x[2]
        s[2,3,0,1]=(0.58688914355)*x[0]**o+(-0.299012943187)*x[0]+(-0.475183593899)*x[1]**o+(-0.209284023343)*x[1]+(-0.128788417577)*x[2]**o+(0.88040263674)*x[2]
        s[2,3,1,0]=(-0.491821145506)*x[0]**o+(0.28222061488)*x[0]+(-0.432027482169)*x[1]**o+(0.0843542963065)*x[1]+(0.179895461516)*x[2]**o+(0.26281058218)*x[2]
        s[2,3,1,1]=(-0.68076808014)*x[0]**o+(0.966337829009)*x[0]+(-0.967714227169)*x[1]**o+(-0.511464770717)*x[1]+(-0.00173666009442)*x[2]**o+(0.418327208497)*x[2]
        s[2,3,2,0]=(-0.981204168827)*x[0]**o+(-0.481006793801)*x[0]+(0.223651529206)*x[1]**o+(0.0692948204072)*x[1]+(0.833168651519)*x[2]**o+(-0.747962032571)*x[2]
        s[2,3,2,1]=(-0.979594675181)*x[0]**o+(-0.793815945451)*x[0]+(-0.972489753584)*x[1]**o+(0.193666863184)*x[1]+(0.813999185145)*x[2]**o+(0.976350643493)*x[2]
        s[2,4,0,0]=(0.160095467562)*x[0]**o+(-0.0596430245423)*x[0]+(0.421111483086)*x[1]**o+(-0.50368497144)*x[1]+(0.295956709432)*x[2]**o+(-0.547225692085)*x[2]
        s[2,4,0,1]=(0.121233419707)*x[0]**o+(0.0796884300301)*x[0]+(0.63360038458)*x[1]**o+(-0.285793125165)*x[1]+(-0.322665608493)*x[2]**o+(0.144053221653)*x[2]
        s[2,4,1,0]=(-0.327390540088)*x[0]**o+(-0.158990478104)*x[0]+(0.0417451752863)*x[1]**o+(0.0577661706274)*x[1]+(0.608054602266)*x[2]**o+(0.876076509191)*x[2]
        s[2,4,1,1]=(-0.336090262681)*x[0]**o+(0.460831366224)*x[0]+(0.126375418917)*x[1]**o+(-0.0524791065196)*x[1]+(0.778197798934)*x[2]**o+(-0.938503586105)*x[2]
        s[2,4,2,0]=(-0.157686815732)*x[0]**o+(-0.240464045969)*x[0]+(-0.610957847036)*x[1]**o+(-0.591812526831)*x[1]+(0.683562885502)*x[2]**o+(-0.575699253807)*x[2]
        s[2,4,2,1]=(-0.591186612156)*x[0]**o+(0.952366931656)*x[0]+(0.563360859838)*x[1]**o+(-0.540973061762)*x[1]+(0.95638308424)*x[2]**o+(0.0810587285575)*x[2]
        s[3,0,0,0]=(-0.777152282839)*x[0]**o+(0.0462962198971)*x[0]+(-0.989861157039)*x[1]**o+(-0.895147454926)*x[1]+(0.496304718705)*x[2]**o+(0.724664844743)*x[2]
        s[3,0,0,1]=(-0.152045574171)*x[0]**o+(0.557429298004)*x[0]+(0.172100777056)*x[1]**o+(-0.762302216782)*x[1]+(0.0107560041439)*x[2]**o+(0.0984433240396)*x[2]
        s[3,0,1,0]=(-0.300572515767)*x[0]**o+(-0.776096822514)*x[0]+(-0.304519070945)*x[1]**o+(0.222039297615)*x[1]+(0.42051246201)*x[2]**o+(0.875929404536)*x[2]
        s[3,0,1,1]=(-0.832809662655)*x[0]**o+(-0.775869677688)*x[0]+(-0.548130481677)*x[1]**o+(-0.863910117253)*x[1]+(-0.708195298544)*x[2]**o+(-0.895809178957)*x[2]
        s[3,0,2,0]=(0.417580286092)*x[0]**o+(-0.320463746468)*x[0]+(-0.780326066905)*x[1]**o+(-0.397006341179)*x[1]+(0.575088222676)*x[2]**o+(0.621841867422)*x[2]
        s[3,0,2,1]=(0.266423263811)*x[0]**o+(0.782081751363)*x[0]+(-0.395723332933)*x[1]**o+(-0.474817183348)*x[1]+(0.483870682109)*x[2]**o+(-0.416708790303)*x[2]
        s[3,1,0,0]=(0.364336403912)*x[0]**o+(0.4746091186)*x[0]+(0.419745216537)*x[1]**o+(0.906218032598)*x[1]+(-0.561381612354)*x[2]**o+(0.252977998753)*x[2]
        s[3,1,0,1]=(-0.479065041103)*x[0]**o+(-0.727722678216)*x[0]+(0.298427986755)*x[1]**o+(0.391426108723)*x[1]+(-0.18371001783)*x[2]**o+(-0.298396916251)*x[2]
        s[3,1,1,0]=(-0.456720853948)*x[0]**o+(-0.137192756988)*x[0]+(0.0387577082772)*x[1]**o+(0.0342816278)*x[1]+(0.287825957753)*x[2]**o+(-0.416093408739)*x[2]
        s[3,1,1,1]=(-0.157773606009)*x[0]**o+(0.229634478596)*x[0]+(-0.100573203257)*x[1]**o+(-0.791674554355)*x[1]+(0.633139739302)*x[2]**o+(0.53643300369)*x[2]
        s[3,1,2,0]=(-0.977094714538)*x[0]**o+(-0.980511324919)*x[0]+(-0.996777041114)*x[1]**o+(-0.135014608241)*x[1]+(0.171228488823)*x[2]**o+(-0.826149942234)*x[2]
        s[3,1,2,1]=(0.40095895971)*x[0]**o+(-0.16005681048)*x[0]+(-0.110948052824)*x[1]**o+(-0.0657272460506)*x[1]+(-0.921326915659)*x[2]**o+(0.498246475577)*x[2]
        s[3,2,0,0]=(-0.521393633448)*x[0]**o+(-0.442461853948)*x[0]+(0.882466157567)*x[1]**o+(-0.318640196818)*x[1]+(-0.454978258143)*x[2]**o+(-0.146713474073)*x[2]
        s[3,2,0,1]=(-0.60584665741)*x[0]**o+(0.186330030473)*x[0]+(0.800412347134)*x[1]**o+(0.632355962829)*x[1]+(-0.577489166576)*x[2]**o+(0.288233513083)*x[2]
        s[3,2,1,0]=(0.645974743024)*x[0]**o+(-0.463548979592)*x[0]+(0.454659333323)*x[1]**o+(-0.147068470329)*x[1]+(0.621612597429)*x[2]**o+(0.309226445731)*x[2]
        s[3,2,1,1]=(0.142559408818)*x[0]**o+(0.568796102102)*x[0]+(-0.957487822488)*x[1]**o+(0.199695598234)*x[1]+(0.437309500275)*x[2]**o+(-0.608539956732)*x[2]
        s[3,2,2,0]=(0.814258898685)*x[0]**o+(-0.0657073512095)*x[0]+(-0.675703123952)*x[1]**o+(-0.826924419864)*x[1]+(-0.202583280241)*x[2]**o+(0.556708057646)*x[2]
        s[3,2,2,1]=(0.420183604639)*x[0]**o+(0.234120268268)*x[0]+(-0.690228330954)*x[1]**o+(0.0742691494912)*x[1]+(-0.542445114625)*x[2]**o+(-0.671138939877)*x[2]
        s[3,3,0,0]=(-0.327300600039)*x[0]**o+(-0.883120008711)*x[0]+(-0.588356952373)*x[1]**o+(0.964702848682)*x[1]+(0.0983852055922)*x[2]**o+(-0.517082121951)*x[2]
        s[3,3,0,1]=(0.808391338918)*x[0]**o+(0.413826885405)*x[0]+(-0.781923414495)*x[1]**o+(0.941400794201)*x[1]+(0.566387362748)*x[2]**o+(-0.361926999623)*x[2]
        s[3,3,1,0]=(0.0408315227595)*x[0]**o+(0.00354329999935)*x[0]+(0.29340210554)*x[1]**o+(-0.129271597771)*x[1]+(0.85418604558)*x[2]**o+(0.972437132596)*x[2]
        s[3,3,1,1]=(0.488110633719)*x[0]**o+(0.442243578548)*x[0]+(0.491915283822)*x[1]**o+(0.900808596947)*x[1]+(0.872340191832)*x[2]**o+(-0.821189941972)*x[2]
        s[3,3,2,0]=(0.698445367492)*x[0]**o+(0.235000428999)*x[0]+(0.0231665862971)*x[1]**o+(0.175887750008)*x[1]+(0.285424647457)*x[2]**o+(-0.0889092865387)*x[2]
        s[3,3,2,1]=(-0.619448487664)*x[0]**o+(-0.25845368795)*x[0]+(0.514713543216)*x[1]**o+(0.933603723018)*x[1]+(0.965553741692)*x[2]**o+(0.775325889348)*x[2]
        s[3,4,0,0]=(0.653712053876)*x[0]**o+(0.397899343408)*x[0]+(-0.980528220216)*x[1]**o+(0.192768638146)*x[1]+(-0.131961987222)*x[2]**o+(0.294990291948)*x[2]
        s[3,4,0,1]=(0.519872654154)*x[0]**o+(-0.523923706123)*x[0]+(-0.366056337857)*x[1]**o+(0.587286575656)*x[1]+(0.67858517405)*x[2]**o+(-0.528581733781)*x[2]
        s[3,4,1,0]=(-0.561163638499)*x[0]**o+(0.834141187099)*x[0]+(0.101344553848)*x[1]**o+(-0.630659721656)*x[1]+(0.177616824366)*x[2]**o+(-0.702449367192)*x[2]
        s[3,4,1,1]=(0.0594382754162)*x[0]**o+(-0.274398458709)*x[0]+(0.423874245449)*x[1]**o+(0.644709194846)*x[1]+(0.742592384867)*x[2]**o+(-0.00411951621579)*x[2]
        s[3,4,2,0]=(0.0680763742436)*x[0]**o+(0.718014295363)*x[0]+(0.10166016369)*x[1]**o+(-0.308308565274)*x[1]+(0.529471669819)*x[2]**o+(0.371855430993)*x[2]
        s[3,4,2,1]=(0.154883537954)*x[0]**o+(-0.727616949065)*x[0]+(0.685560277601)*x[1]**o+(0.0846298021044)*x[1]+(0.284159382541)*x[2]**o+(0.869297635219)*x[2]
        ref[0,0,0,0]=(0.739396210148)/(o+1.)+(-0.377981671409)+(-0.48893267678)*0.5**o
        ref[0,0,0,1]=(0.337987859283)/(o+1.)+(-0.185632830775)+(0.271529548298)*0.5**o
        ref[0,0,1,0]=(0.341117558489)/(o+1.)+(0.285059767111)+(0.217379546035)*0.5**o
        ref[0,0,1,1]=(-0.0893400826624)/(o+1.)+(0.617738916563)+(0.042921886647)*0.5**o
        ref[0,0,2,0]=(1.21239011685)/(o+1.)+(-0.720282881042)+(-0.386813522991)*0.5**o
        ref[0,0,2,1]=(-0.0384313516284)/(o+1.)+(-0.61005148956)+(0.270966465259)*0.5**o
        ref[0,1,0,0]=(0.327203624676)/(o+1.)+(0.0257361660344)+(0.341922361346)*0.5**o
        ref[0,1,0,1]=(-0.608485653551)/(o+1.)+(0.196745850885)+(0.232432790902)*0.5**o
        ref[0,1,1,0]=(-0.0886766370694)/(o+1.)+(0.256118417885)+(-0.0195600321657)*0.5**o
        ref[0,1,1,1]=(0.773736575857)/(o+1.)+(0.015232876126)+(0.440682443808)*0.5**o
        ref[0,1,2,0]=(-0.570789204325)/(o+1.)+(-0.896252294196)+(0.0308644963019)*0.5**o
        ref[0,1,2,1]=(-0.589934257593)/(o+1.)+(0.123692628409)+(0.964064258383)*0.5**o
        ref[0,2,0,0]=(-0.462322464655)/(o+1.)+(0.161466206488)+(-0.378594793341)*0.5**o
        ref[0,2,0,1]=(0.870324747287)/(o+1.)+(-0.480877839502)+(-0.24119818585)*0.5**o
        ref[0,2,1,0]=(-0.958030860186)/(o+1.)+(0.832841870654)+(0.260426222503)*0.5**o
        ref[0,2,1,1]=(0.119929006158)/(o+1.)+(0.965344805092)+(-0.585208459519)*0.5**o
        ref[0,2,2,0]=(0.595680154835)/(o+1.)+(0.813013191009)+(0.926784535292)*0.5**o
        ref[0,2,2,1]=(1.16197298905)/(o+1.)+(-0.0901053305394)+(-0.182330163829)*0.5**o
        ref[0,3,0,0]=(-0.408748832285)/(o+1.)+(-0.276487805822)+(0.251053015385)*0.5**o
        ref[0,3,0,1]=(-0.289518113494)/(o+1.)+(0.0472028037384)+(-0.885181589797)*0.5**o
        ref[0,3,1,0]=(-0.361024485545)/(o+1.)+(0.243370797547)+(0.464501690982)*0.5**o
        ref[0,3,1,1]=(-0.66248835768)/(o+1.)+(-0.431971169905)+(0.117929836206)*0.5**o
        ref[0,3,2,0]=(-0.0787999320256)/(o+1.)+(0.0743499551435)+(0.228255426058)*0.5**o
        ref[0,3,2,1]=(-0.173348259943)/(o+1.)+(-0.561339626579)+(-0.155365105782)*0.5**o
        ref[0,4,0,0]=(0.611450791476)/(o+1.)+(0.0699376623952)+(-0.913401118579)*0.5**o
        ref[0,4,0,1]=(0.363891611185)/(o+1.)+(-0.297825521733)+(0.272596166342)*0.5**o
        ref[0,4,1,0]=(-0.223003610908)/(o+1.)+(-0.392555867216)+(0.469445737741)*0.5**o
        ref[0,4,1,1]=(0.488828274194)/(o+1.)+(0.310202373415)+(-0.727336869594)*0.5**o
        ref[0,4,2,0]=(0.445608154304)/(o+1.)+(0.454742158621)+(-0.826661708611)*0.5**o
        ref[0,4,2,1]=(-0.494084152685)/(o+1.)+(-0.370705122869)+(0.788019130522)*0.5**o
        ref[1,0,0,0]=(0.243874222094)/(o+1.)+(-0.0689657796687)+(0.251841546653)*0.5**o
        ref[1,0,0,1]=(0.225779605731)/(o+1.)+(0.0557627886771)+(0.0702543485705)*0.5**o
        ref[1,0,1,0]=(0.808462226036)/(o+1.)+(0.234303303388)+(0.0132145791001)*0.5**o
        ref[1,0,1,1]=(-0.999731654372)/(o+1.)+(-0.934144801543)+(0.00555685773193)*0.5**o
        ref[1,0,2,0]=(-0.919358313974)/(o+1.)+(0.569175866738)+(-0.937628377428)*0.5**o
        ref[1,0,2,1]=(0.632836035767)/(o+1.)+(-0.146747695134)+(0.0853414413422)*0.5**o
        ref[1,1,0,0]=(-0.240699629165)/(o+1.)+(0.205847998136)+(-0.197717271419)*0.5**o
        ref[1,1,0,1]=(-0.498994553932)/(o+1.)+(-0.581995396714)+(0.378319093831)*0.5**o
        ref[1,1,1,0]=(-0.0907759743431)/(o+1.)+(-0.34174530228)+(-0.0852354427742)*0.5**o
        ref[1,1,1,1]=(-0.109368603911)/(o+1.)+(0.271666352981)+(0.543079304077)*0.5**o
        ref[1,1,2,0]=(-1.82714390258)/(o+1.)+(0.259569394828)+(0.163126135652)*0.5**o
        ref[1,1,2,1]=(0.203325644955)/(o+1.)+(-0.654071049108)+(-0.4311680318)*0.5**o
        ref[1,2,0,0]=(-1.58035127979)/(o+1.)+(0.720587706977)+(-0.823741968282)*0.5**o
        ref[1,2,0,1]=(-1.07997010085)/(o+1.)+(-0.47888656161)+(-0.271373691068)*0.5**o
        ref[1,2,1,0]=(-0.142126140002)/(o+1.)+(-0.599437129629)+(-0.197804966703)*0.5**o
        ref[1,2,1,1]=(1.28493817222)/(o+1.)+(-0.666958817271)+(0.985473777724)*0.5**o
        ref[1,2,2,0]=(0.129231092617)/(o+1.)+(-0.663318952006)+(0.0963375474866)*0.5**o
        ref[1,2,2,1]=(-0.823103301339)/(o+1.)+(0.288695297862)+(-0.000809557040863)*0.5**o
        ref[1,3,0,0]=(0.960547109599)/(o+1.)+(-0.010684607839)+(-0.450224087014)*0.5**o
        ref[1,3,0,1]=(0.231548195209)/(o+1.)+(0.138523354402)+(-0.211716554169)*0.5**o
        ref[1,3,1,0]=(-0.306513590154)/(o+1.)+(-0.280311885684)+(0.469992449976)*0.5**o
        ref[1,3,1,1]=(-0.438448823496)/(o+1.)+(0.354134551813)+(-0.9202597392)*0.5**o
        ref[1,3,2,0]=(1.05648399222)/(o+1.)+(0.553601688018)+(0.724283786459)*0.5**o
        ref[1,3,2,1]=(-1.0341741331)/(o+1.)+(-0.466903042112)+(-0.582421422441)*0.5**o
        ref[1,4,0,0]=(0.333378315924)/(o+1.)+(-1.30139659371)+(0.268654181239)*0.5**o
        ref[1,4,0,1]=(-0.594224679128)/(o+1.)+(-0.335931583709)+(-0.526400834988)*0.5**o
        ref[1,4,1,0]=(-0.478322743296)/(o+1.)+(-0.856712513818)+(0.912742445536)*0.5**o
        ref[1,4,1,1]=(0.322669808577)/(o+1.)+(1.24907276457)+(0.0912352323191)*0.5**o
        ref[1,4,2,0]=(1.10714173295)/(o+1.)+(-0.0842589588357)+(-0.212374984853)*0.5**o
        ref[1,4,2,1]=(-0.504473114993)/(o+1.)+(-0.134995471785)+(-0.192346087265)*0.5**o
        ref[2,0,0,0]=(0.607594512975)/(o+1.)+(0.111392812114)+(0.646959412154)*0.5**o
        ref[2,0,0,1]=(-0.59128714023)/(o+1.)+(0.531126996488)+(-0.116490832795)*0.5**o
        ref[2,0,1,0]=(0.755555640169)/(o+1.)+(0.347463297144)+(-0.656776412474)*0.5**o
        ref[2,0,1,1]=(0.27040074765)/(o+1.)+(0.0725333822557)+(-0.244997314762)*0.5**o
        ref[2,0,2,0]=(-0.0846561719678)/(o+1.)+(0.155975979069)+(0.427359531608)*0.5**o
        ref[2,0,2,1]=(-0.0936195225336)/(o+1.)+(-0.963885329606)+(-0.28054117321)*0.5**o
        ref[2,1,0,0]=(0.335891086628)/(o+1.)+(-0.166650903111)+(0.832323847638)*0.5**o
        ref[2,1,0,1]=(-0.10783555167)/(o+1.)+(0.696139278955)+(0.791743274331)*0.5**o
        ref[2,1,1,0]=(-0.2165713289)/(o+1.)+(0.0948451085032)+(-0.0716642151005)*0.5**o
        ref[2,1,1,1]=(0.675642828512)/(o+1.)+(0.449412257208)+(-0.487936865731)*0.5**o
        ref[2,1,2,0]=(-0.69734396291)/(o+1.)+(0.496260410473)+(-0.865760152137)*0.5**o
        ref[2,1,2,1]=(0.867554325692)/(o+1.)+(0.348418508362)+(-0.550134186201)*0.5**o
        ref[2,2,0,0]=(-1.05800666595)/(o+1.)+(0.830246146935)+(-0.0191940498302)*0.5**o
        ref[2,2,0,1]=(-0.254292654192)/(o+1.)+(-0.365591254417)+(-0.593353550722)*0.5**o
        ref[2,2,1,0]=(-0.400713560372)/(o+1.)+(0.151830485765)+(0.758386313418)*0.5**o
        ref[2,2,1,1]=(0.617102098568)/(o+1.)+(0.0872825614209)+(-0.0562030350565)*0.5**o
        ref[2,2,2,0]=(-0.49484415738)/(o+1.)+(-0.684491172613)+(0.632035307709)*0.5**o
        ref[2,2,2,1]=(0.315837395005)/(o+1.)+(-0.820028413806)+(0.877117460076)*0.5**o
        ref[2,3,0,0]=(0.644195916625)/(o+1.)+(-0.0916187205818)+(0.868438479199)*0.5**o
        ref[2,3,0,1]=(-0.603972011476)/(o+1.)+(0.186052835105)+(0.58688914355)*0.5**o
        ref[2,3,1,0]=(-0.252132020652)/(o+1.)+(0.314692746683)+(-0.491821145506)*0.5**o
        ref[2,3,1,1]=(-0.969450887263)/(o+1.)+(0.436600133394)+(-0.68076808014)*0.5**o
        ref[2,3,2,0]=(1.05682018072)/(o+1.)+(-0.579837002982)+(-0.981204168827)*0.5**o
        ref[2,3,2,1]=(-0.15849056844)/(o+1.)+(0.188100780613)+(-0.979594675181)*0.5**o
        ref[2,4,0,0]=(0.717068192518)/(o+1.)+(-0.555276844034)+(0.160095467562)*0.5**o
        ref[2,4,0,1]=(0.310934776087)/(o+1.)+(-0.031025736741)+(0.121233419707)*0.5**o
        ref[2,4,1,0]=(0.649799777552)/(o+1.)+(0.387426100857)+(-0.327390540088)*0.5**o
        ref[2,4,1,1]=(0.904573217851)/(o+1.)+(-0.2650756632)+(-0.336090262681)*0.5**o
        ref[2,4,2,0]=(0.0726050384664)/(o+1.)+(-0.703987913303)+(-0.157686815732)*0.5**o
        ref[2,4,2,1]=(1.51974394408)/(o+1.)+(0.246226299226)+(-0.591186612156)*0.5**o
        ref[3,0,0,0]=(-0.493556438334)/(o+1.)+(-0.0620931951433)+(-0.777152282839)*0.5**o
        ref[3,0,0,1]=(0.1828567812)/(o+1.)+(-0.0532147973691)+(-0.152045574171)*0.5**o
        ref[3,0,1,0]=(0.115993391065)/(o+1.)+(0.160935939818)+(-0.300572515767)*0.5**o
        ref[3,0,1,1]=(-1.25632578022)/(o+1.)+(-1.26779448695)+(-0.832809662655)*0.5**o
        ref[3,0,2,0]=(-0.205237844229)/(o+1.)+(-0.0478141101127)+(0.417580286092)*0.5**o
        ref[3,0,2,1]=(0.088147349176)/(o+1.)+(-0.0547221111442)+(0.266423263811)*0.5**o
        ref[3,1,0,0]=(-0.141636395817)/(o+1.)+(0.816902574975)+(0.364336403912)*0.5**o
        ref[3,1,0,1]=(0.114717968925)/(o+1.)+(-0.317346742872)+(-0.479065041103)*0.5**o
        ref[3,1,1,0]=(0.32658366603)/(o+1.)+(-0.259502268963)+(-0.456720853948)*0.5**o
        ref[3,1,1,1]=(0.532566536046)/(o+1.)+(-0.0128035360346)+(-0.157773606009)*0.5**o
        ref[3,1,2,0]=(-0.825548552291)/(o+1.)+(-0.970837937697)+(-0.977094714538)*0.5**o
        ref[3,1,2,1]=(-1.03227496848)/(o+1.)+(0.136231209523)+(0.40095895971)*0.5**o
        ref[3,2,0,0]=(0.427487899424)/(o+1.)+(-0.453907762419)+(-0.521393633448)*0.5**o
        ref[3,2,0,1]=(0.222923180558)/(o+1.)+(0.553459753192)+(-0.60584665741)*0.5**o
        ref[3,2,1,0]=(1.07627193075)/(o+1.)+(-0.150695502095)+(0.645974743024)*0.5**o
        ref[3,2,1,1]=(-0.520178322214)/(o+1.)+(0.0799758718026)+(0.142559408818)*0.5**o
        ref[3,2,2,0]=(-0.878286404193)/(o+1.)+(-0.167961856714)+(0.814258898685)*0.5**o
        ref[3,2,2,1]=(-1.23267344558)/(o+1.)+(-0.181374761059)+(0.420183604639)*0.5**o
        ref[3,3,0,0]=(-0.489971746781)/(o+1.)+(-0.21774964099)+(-0.327300600039)*0.5**o
        ref[3,3,0,1]=(-0.215536051747)/(o+1.)+(0.496650339992)+(0.808391338918)*0.5**o
        ref[3,3,1,0]=(1.14758815112)/(o+1.)+(0.423354417412)+(0.0408315227595)*0.5**o
        ref[3,3,1,1]=(1.36425547565)/(o+1.)+(0.260931116761)+(0.488110633719)*0.5**o
        ref[3,3,2,0]=(0.308591233754)/(o+1.)+(0.160989446234)+(0.698445367492)*0.5**o
        ref[3,3,2,1]=(1.48026728491)/(o+1.)+(0.725237962208)+(-0.619448487664)*0.5**o
        ref[3,4,0,0]=(-1.11249020744)/(o+1.)+(0.442829136751)+(0.653712053876)*0.5**o
        ref[3,4,0,1]=(0.312528836193)/(o+1.)+(-0.232609432124)+(0.519872654154)*0.5**o
        ref[3,4,1,0]=(0.278961378214)/(o+1.)+(-0.249483950874)+(-0.561163638499)*0.5**o
        ref[3,4,1,1]=(1.16646663032)/(o+1.)+(0.183095609961)+(0.0594382754162)*0.5**o
        ref[3,4,2,0]=(0.631131833509)/(o+1.)+(0.390780580541)+(0.0680763742436)*0.5**o
        ref[3,4,2,1]=(0.969719660142)/(o+1.)+(0.113155244129)+(0.154883537954)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_Solution_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.551831061348)*x[0]**o+(-0.711823790733)*x[0]+(0.766098862021)*x[1]**o+(0.348439108965)*x[1]
        ref=(0.766098862021)/(o+1.)+(-0.181692340884)+(0.551831061348)*0.5**o
      else:
        s=(-0.534750207803)*x[0]**o+(0.67975160623)*x[0]+(0.747517712959)*x[1]**o+(0.392190678153)*x[1]+(-0.586558763208)*x[2]**o+(0.67325251011)*x[2]
        ref=(0.160958949751)/(o+1.)+(0.872597397246)+(-0.534750207803)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_Solution_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(0.824614999579)*x[0]**o+(-0.92501072999)*x[0]+(-0.164852435473)*x[1]**o+(0.625787035398)*x[1]
        s[1]=(0.933187313904)*x[0]**o+(-0.76410941839)*x[0]+(-0.924559271586)*x[1]**o+(-0.951797707375)*x[1]
        ref[0]=(-0.164852435473)/(o+1.)+(-0.149611847296)+(0.824614999579)*0.5**o
        ref[1]=(-0.924559271586)/(o+1.)+(-0.857953562883)+(0.933187313904)*0.5**o
      else:
        s[0]=(-0.73247014084)*x[0]**o+(-0.447784692568)*x[0]+(-0.206145797624)*x[1]**o+(0.800549366557)*x[1]+(0.0980004782263)*x[2]**o+(0.68684151518)*x[2]
        s[1]=(0.734011170766)*x[0]**o+(-0.718028398303)*x[0]+(0.768940123369)*x[1]**o+(0.410156990187)*x[1]+(0.6562835776)*x[2]**o+(-0.899108897402)*x[2]
        ref[0]=(-0.108145319398)/(o+1.)+(0.519803094585)+(-0.73247014084)*0.5**o
        ref[1]=(1.42522370097)/(o+1.)+(-0.603490152759)+(0.734011170766)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_Solution_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.860004136579)*x[0]**o+(-0.117366140441)*x[0]+(0.0876424200904)*x[1]**o+(0.0578427219547)*x[1]
        s[0,1]=(-0.934262599682)*x[0]**o+(-0.834391940774)*x[0]+(-0.37703046074)*x[1]**o+(0.571779357388)*x[1]
        s[0,2]=(-0.524417646775)*x[0]**o+(-0.562788330473)*x[0]+(-0.454146889642)*x[1]**o+(0.382147150671)*x[1]
        s[0,3]=(0.53752054491)*x[0]**o+(0.52118522583)*x[0]+(0.196117385249)*x[1]**o+(0.968096844135)*x[1]
        s[0,4]=(-0.346245303793)*x[0]**o+(0.169183126761)*x[0]+(0.35430553025)*x[1]**o+(-0.1953526461)*x[1]
        s[1,0]=(0.110897459128)*x[0]**o+(-0.189310140801)*x[0]+(-0.503153929692)*x[1]**o+(-0.776512889143)*x[1]
        s[1,1]=(0.0773234920212)*x[0]**o+(-0.323298685849)*x[0]+(0.956652842652)*x[1]**o+(-0.834584362886)*x[1]
        s[1,2]=(0.725330064304)*x[0]**o+(-0.761117907603)*x[0]+(-0.161152622185)*x[1]**o+(0.633185715895)*x[1]
        s[1,3]=(0.399871656297)*x[0]**o+(-0.831922720579)*x[0]+(0.125957093778)*x[1]**o+(0.909312599897)*x[1]
        s[1,4]=(0.450333632811)*x[0]**o+(-0.914467685845)*x[0]+(-0.71553040823)*x[1]**o+(-0.806957497854)*x[1]
        s[2,0]=(-0.596111663177)*x[0]**o+(-0.896500016447)*x[0]+(-0.175137342743)*x[1]**o+(-0.519618663869)*x[1]
        s[2,1]=(0.219789961005)*x[0]**o+(0.394778437788)*x[0]+(0.516359075868)*x[1]**o+(0.158719123393)*x[1]
        s[2,2]=(-0.202978715302)*x[0]**o+(0.326528455071)*x[0]+(-0.475802171068)*x[1]**o+(-0.470892970453)*x[1]
        s[2,3]=(0.34431665114)*x[0]**o+(0.847623303071)*x[0]+(-0.300788565801)*x[1]**o+(0.623946324835)*x[1]
        s[2,4]=(-0.482716534989)*x[0]**o+(0.610848202802)*x[0]+(-0.618220314271)*x[1]**o+(-0.270417044737)*x[1]
        s[3,0]=(0.323084711653)*x[0]**o+(0.870297617987)*x[0]+(-0.817231621484)*x[1]**o+(0.599137155405)*x[1]
        s[3,1]=(-0.464413485909)*x[0]**o+(-0.948296858226)*x[0]+(-0.872776322969)*x[1]**o+(0.0058301771792)*x[1]
        s[3,2]=(-0.920685763376)*x[0]**o+(-0.429364041758)*x[0]+(0.211630014364)*x[1]**o+(-0.311548404071)*x[1]
        s[3,3]=(-0.175827412744)*x[0]**o+(-0.687378086381)*x[0]+(0.265852072745)*x[1]**o+(0.799115907363)*x[1]
        s[3,4]=(-0.99517403847)*x[0]**o+(0.746397561862)*x[0]+(-0.747340816778)*x[1]**o+(-0.57474910244)*x[1]
        ref[0,0]=(0.0876424200904)/(o+1.)+(-0.0297617092432)+(0.860004136579)*0.5**o
        ref[0,1]=(-0.37703046074)/(o+1.)+(-0.131306291693)+(-0.934262599682)*0.5**o
        ref[0,2]=(-0.454146889642)/(o+1.)+(-0.0903205899012)+(-0.524417646775)*0.5**o
        ref[0,3]=(0.196117385249)/(o+1.)+(0.744641034982)+(0.53752054491)*0.5**o
        ref[0,4]=(0.35430553025)/(o+1.)+(-0.0130847596698)+(-0.346245303793)*0.5**o
        ref[1,0]=(-0.503153929692)/(o+1.)+(-0.482911514972)+(0.110897459128)*0.5**o
        ref[1,1]=(0.956652842652)/(o+1.)+(-0.578941524367)+(0.0773234920212)*0.5**o
        ref[1,2]=(-0.161152622185)/(o+1.)+(-0.063966095854)+(0.725330064304)*0.5**o
        ref[1,3]=(0.125957093778)/(o+1.)+(0.0386949396593)+(0.399871656297)*0.5**o
        ref[1,4]=(-0.71553040823)/(o+1.)+(-0.860712591849)+(0.450333632811)*0.5**o
        ref[2,0]=(-0.175137342743)/(o+1.)+(-0.708059340158)+(-0.596111663177)*0.5**o
        ref[2,1]=(0.516359075868)/(o+1.)+(0.27674878059)+(0.219789961005)*0.5**o
        ref[2,2]=(-0.475802171068)/(o+1.)+(-0.072182257691)+(-0.202978715302)*0.5**o
        ref[2,3]=(-0.300788565801)/(o+1.)+(0.735784813953)+(0.34431665114)*0.5**o
        ref[2,4]=(-0.618220314271)/(o+1.)+(0.170215579033)+(-0.482716534989)*0.5**o
        ref[3,0]=(-0.817231621484)/(o+1.)+(0.734717386696)+(0.323084711653)*0.5**o
        ref[3,1]=(-0.872776322969)/(o+1.)+(-0.471233340523)+(-0.464413485909)*0.5**o
        ref[3,2]=(0.211630014364)/(o+1.)+(-0.370456222914)+(-0.920685763376)*0.5**o
        ref[3,3]=(0.265852072745)/(o+1.)+(0.0558689104915)+(-0.175827412744)*0.5**o
        ref[3,4]=(-0.747340816778)/(o+1.)+(0.0858242297109)+(-0.99517403847)*0.5**o
      else:
        s[0,0]=(0.578101616539)*x[0]**o+(-0.941355465542)*x[0]+(-0.661840086733)*x[1]**o+(-0.574686372209)*x[1]+(-0.488980453488)*x[2]**o+(0.8057154356)*x[2]
        s[0,1]=(0.188043130009)*x[0]**o+(-0.53795144833)*x[0]+(0.585611542575)*x[1]**o+(-0.394354708911)*x[1]+(-0.753395938984)*x[2]**o+(-0.775038773873)*x[2]
        s[0,2]=(-0.0069454884707)*x[0]**o+(0.925798676533)*x[0]+(-0.617492289762)*x[1]**o+(-0.412950379597)*x[1]+(0.530650448811)*x[2]**o+(-0.882156765835)*x[2]
        s[0,3]=(-0.109411491583)*x[0]**o+(0.794417685565)*x[0]+(0.395199315447)*x[1]**o+(0.221963288858)*x[1]+(0.944618017853)*x[2]**o+(0.710576727198)*x[2]
        s[0,4]=(0.0376370205208)*x[0]**o+(-0.387469327476)*x[0]+(0.989435100596)*x[1]**o+(-0.697198283115)*x[1]+(0.705109597826)*x[2]**o+(0.00235357316422)*x[2]
        s[1,0]=(-0.861013305772)*x[0]**o+(-0.117175144313)*x[0]+(-0.851114880006)*x[1]**o+(0.830657298231)*x[1]+(0.897872709447)*x[2]**o+(-0.500434787953)*x[2]
        s[1,1]=(-0.659762659407)*x[0]**o+(-0.293584253789)*x[0]+(-0.549133974878)*x[1]**o+(0.124482383522)*x[1]+(-0.71415106775)*x[2]**o+(-0.452353669527)*x[2]
        s[1,2]=(-0.944798023011)*x[0]**o+(0.352545190549)*x[0]+(-0.950981266242)*x[1]**o+(-0.338339076366)*x[1]+(-0.385100481358)*x[2]**o+(-0.751511160424)*x[2]
        s[1,3]=(-0.514889491143)*x[0]**o+(-0.0573778568353)*x[0]+(0.189167569167)*x[1]**o+(-0.122152801538)*x[1]+(-0.075952059447)*x[2]**o+(-0.575271878121)*x[2]
        s[1,4]=(0.092128759086)*x[0]**o+(-0.391395765897)*x[0]+(0.621302034853)*x[1]**o+(-0.169193910488)*x[1]+(0.895953307228)*x[2]**o+(-0.171715374513)*x[2]
        s[2,0]=(-0.896341445352)*x[0]**o+(0.55427420625)*x[0]+(-0.68618123058)*x[1]**o+(0.586997200722)*x[1]+(-0.16193062027)*x[2]**o+(0.47614229102)*x[2]
        s[2,1]=(0.0173555065441)*x[0]**o+(-0.137706680345)*x[0]+(0.124390959958)*x[1]**o+(0.0817218208151)*x[1]+(-0.883487601024)*x[2]**o+(-0.99725370538)*x[2]
        s[2,2]=(0.653947795759)*x[0]**o+(-0.0561188253491)*x[0]+(-0.304869234336)*x[1]**o+(-0.5647971996)*x[1]+(0.842979371974)*x[2]**o+(0.271112357653)*x[2]
        s[2,3]=(-0.916870447792)*x[0]**o+(0.532760446169)*x[0]+(0.125531293566)*x[1]**o+(-0.772485238164)*x[1]+(-0.0249888509834)*x[2]**o+(-0.215774489527)*x[2]
        s[2,4]=(0.82957204564)*x[0]**o+(-0.536668870818)*x[0]+(0.18150637899)*x[1]**o+(0.213776071225)*x[1]+(-0.607190995474)*x[2]**o+(-0.0534051775785)*x[2]
        s[3,0]=(-0.0156695889369)*x[0]**o+(-0.920483023826)*x[0]+(0.173953779108)*x[1]**o+(0.723326965312)*x[1]+(-0.946445962586)*x[2]**o+(0.242480497946)*x[2]
        s[3,1]=(0.253546369583)*x[0]**o+(-0.455303700999)*x[0]+(0.265484731924)*x[1]**o+(-0.334855283665)*x[1]+(0.263585801553)*x[2]**o+(0.768099093921)*x[2]
        s[3,2]=(-0.0884797551735)*x[0]**o+(-0.744966141189)*x[0]+(0.685728482818)*x[1]**o+(-0.700119204761)*x[1]+(-0.996053069429)*x[2]**o+(-0.300758647065)*x[2]
        s[3,3]=(-0.265221319311)*x[0]**o+(0.119741272443)*x[0]+(0.0623093135308)*x[1]**o+(0.617188763307)*x[1]+(-0.14935010921)*x[2]**o+(0.315030342521)*x[2]
        s[3,4]=(0.634255080399)*x[0]**o+(0.0848130779284)*x[0]+(-0.262488356592)*x[1]**o+(-0.698599321231)*x[1]+(-0.411566742148)*x[2]**o+(0.307995972853)*x[2]
        ref[0,0]=(-1.15082054022)/(o+1.)+(-0.355163201075)+(0.578101616539)*0.5**o
        ref[0,1]=(-0.167784396409)/(o+1.)+(-0.853672465557)+(0.188043130009)*0.5**o
        ref[0,2]=(-0.0868418409506)/(o+1.)+(-0.18465423445)+(-0.0069454884707)*0.5**o
        ref[0,3]=(1.3398173333)/(o+1.)+(0.86347885081)+(-0.109411491583)*0.5**o
        ref[0,4]=(1.69454469842)/(o+1.)+(-0.541157018713)+(0.0376370205208)*0.5**o
        ref[1,0]=(0.0467578294411)/(o+1.)+(0.106523682982)+(-0.861013305772)*0.5**o
        ref[1,1]=(-1.26328504263)/(o+1.)+(-0.310727769897)+(-0.659762659407)*0.5**o
        ref[1,2]=(-1.3360817476)/(o+1.)+(-0.36865252312)+(-0.944798023011)*0.5**o
        ref[1,3]=(0.11321550972)/(o+1.)+(-0.377401268247)+(-0.514889491143)*0.5**o
        ref[1,4]=(1.51725534208)/(o+1.)+(-0.366152525449)+(0.092128759086)*0.5**o
        ref[2,0]=(-0.84811185085)/(o+1.)+(0.808706848996)+(-0.896341445352)*0.5**o
        ref[2,1]=(-0.759096641066)/(o+1.)+(-0.526619282455)+(0.0173555065441)*0.5**o
        ref[2,2]=(0.538110137638)/(o+1.)+(-0.174901833648)+(0.653947795759)*0.5**o
        ref[2,3]=(0.100542442583)/(o+1.)+(-0.227749640761)+(-0.916870447792)*0.5**o
        ref[2,4]=(-0.425684616484)/(o+1.)+(-0.188148988586)+(0.82957204564)*0.5**o
        ref[3,0]=(-0.772492183478)/(o+1.)+(0.0226622197163)+(-0.0156695889369)*0.5**o
        ref[3,1]=(0.529070533478)/(o+1.)+(-0.0110299453715)+(0.253546369583)*0.5**o
        ref[3,2]=(-0.310324586611)/(o+1.)+(-0.872921996508)+(-0.0884797551735)*0.5**o
        ref[3,3]=(-0.0870407956792)/(o+1.)+(0.525980189135)+(-0.265221319311)*0.5**o
        ref[3,4]=(-0.67405509874)/(o+1.)+(-0.152895135225)+(0.634255080399)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_Solution_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.970014070821)*x[0]**o+(0.195828821364)*x[0]+(-0.329248582962)*x[1]**o+(0.765729760657)*x[1]
        s[0,0,1]=(-0.78480276531)*x[0]**o+(0.660249421528)*x[0]+(-0.112211565471)*x[1]**o+(-0.732753874188)*x[1]
        s[0,1,0]=(-0.610728226383)*x[0]**o+(-0.617391668915)*x[0]+(-0.755934195771)*x[1]**o+(-0.301037750184)*x[1]
        s[0,1,1]=(-0.271483777605)*x[0]**o+(-0.118144079798)*x[0]+(0.00595756313744)*x[1]**o+(0.00973544005055)*x[1]
        s[1,0,0]=(-0.880152279586)*x[0]**o+(0.173587205863)*x[0]+(-0.772256433861)*x[1]**o+(-0.929831194333)*x[1]
        s[1,0,1]=(0.663917147636)*x[0]**o+(0.602039234824)*x[0]+(-0.761663518039)*x[1]**o+(-0.794981650104)*x[1]
        s[1,1,0]=(0.669982500097)*x[0]**o+(-0.867340940384)*x[0]+(0.425166963846)*x[1]**o+(0.809034058423)*x[1]
        s[1,1,1]=(-0.748164617999)*x[0]**o+(0.820897422648)*x[0]+(0.282790963068)*x[1]**o+(0.418210593072)*x[1]
        s[2,0,0]=(-0.151105173252)*x[0]**o+(0.588856734796)*x[0]+(-0.587574498534)*x[1]**o+(0.214690992942)*x[1]
        s[2,0,1]=(0.846293738229)*x[0]**o+(0.453778324604)*x[0]+(-0.750479939889)*x[1]**o+(0.988318560374)*x[1]
        s[2,1,0]=(0.0520443817173)*x[0]**o+(0.66477304094)*x[0]+(0.220203729906)*x[1]**o+(0.807678486344)*x[1]
        s[2,1,1]=(-0.481828231947)*x[0]**o+(0.301163693914)*x[0]+(-0.240012695397)*x[1]**o+(-0.739330362354)*x[1]
        s[3,0,0]=(-0.464086304345)*x[0]**o+(0.204976865077)*x[0]+(0.360828971652)*x[1]**o+(0.179421383025)*x[1]
        s[3,0,1]=(0.524003162473)*x[0]**o+(0.241725193779)*x[0]+(0.137006148453)*x[1]**o+(0.122270180832)*x[1]
        s[3,1,0]=(-0.148537542555)*x[0]**o+(-0.87771789463)*x[0]+(0.776889116646)*x[1]**o+(0.72202598779)*x[1]
        s[3,1,1]=(-0.0984207735775)*x[0]**o+(-0.200545725506)*x[0]+(-0.422044149217)*x[1]**o+(-0.403374011642)*x[1]
        s[4,0,0]=(0.332893223127)*x[0]**o+(-0.238038393676)*x[0]+(-0.796376263577)*x[1]**o+(0.059346957422)*x[1]
        s[4,0,1]=(-0.877726930853)*x[0]**o+(0.287774676493)*x[0]+(-0.690097100077)*x[1]**o+(0.806523530334)*x[1]
        s[4,1,0]=(-0.466369745006)*x[0]**o+(0.511932688176)*x[0]+(-0.569648246707)*x[1]**o+(-0.180363948019)*x[1]
        s[4,1,1]=(0.82395338594)*x[0]**o+(0.0423959362879)*x[0]+(-0.508349189015)*x[1]**o+(0.0735939835821)*x[1]
        s[5,0,0]=(-0.631799410304)*x[0]**o+(0.0828019140935)*x[0]+(0.132222069751)*x[1]**o+(0.716700894256)*x[1]
        s[5,0,1]=(-0.871739775831)*x[0]**o+(-0.364312533128)*x[0]+(0.660932493381)*x[1]**o+(-0.638799141415)*x[1]
        s[5,1,0]=(-0.927257402325)*x[0]**o+(-0.745507370225)*x[0]+(0.70647119912)*x[1]**o+(0.583112912025)*x[1]
        s[5,1,1]=(-0.440675815785)*x[0]**o+(0.292262539618)*x[0]+(0.172815874747)*x[1]**o+(-0.854959570718)*x[1]
        ref[0,0,0]=(-0.329248582962)/(o+1.)+(0.480779291011)+(-0.970014070821)*0.5**o
        ref[0,0,1]=(-0.112211565471)/(o+1.)+(-0.0362522263304)+(-0.78480276531)*0.5**o
        ref[0,1,0]=(-0.755934195771)/(o+1.)+(-0.459214709549)+(-0.610728226383)*0.5**o
        ref[0,1,1]=(0.00595756313744)/(o+1.)+(-0.0542043198736)+(-0.271483777605)*0.5**o
        ref[1,0,0]=(-0.772256433861)/(o+1.)+(-0.378121994235)+(-0.880152279586)*0.5**o
        ref[1,0,1]=(-0.761663518039)/(o+1.)+(-0.0964712076398)+(0.663917147636)*0.5**o
        ref[1,1,0]=(0.425166963846)/(o+1.)+(-0.0291534409806)+(0.669982500097)*0.5**o
        ref[1,1,1]=(0.282790963068)/(o+1.)+(0.61955400786)+(-0.748164617999)*0.5**o
        ref[2,0,0]=(-0.587574498534)/(o+1.)+(0.401773863869)+(-0.151105173252)*0.5**o
        ref[2,0,1]=(-0.750479939889)/(o+1.)+(0.721048442489)+(0.846293738229)*0.5**o
        ref[2,1,0]=(0.220203729906)/(o+1.)+(0.736225763642)+(0.0520443817173)*0.5**o
        ref[2,1,1]=(-0.240012695397)/(o+1.)+(-0.21908333422)+(-0.481828231947)*0.5**o
        ref[3,0,0]=(0.360828971652)/(o+1.)+(0.192199124051)+(-0.464086304345)*0.5**o
        ref[3,0,1]=(0.137006148453)/(o+1.)+(0.181997687306)+(0.524003162473)*0.5**o
        ref[3,1,0]=(0.776889116646)/(o+1.)+(-0.0778459534199)+(-0.148537542555)*0.5**o
        ref[3,1,1]=(-0.422044149217)/(o+1.)+(-0.301959868574)+(-0.0984207735775)*0.5**o
        ref[4,0,0]=(-0.796376263577)/(o+1.)+(-0.0893457181268)+(0.332893223127)*0.5**o
        ref[4,0,1]=(-0.690097100077)/(o+1.)+(0.547149103413)+(-0.877726930853)*0.5**o
        ref[4,1,0]=(-0.569648246707)/(o+1.)+(0.165784370078)+(-0.466369745006)*0.5**o
        ref[4,1,1]=(-0.508349189015)/(o+1.)+(0.057994959935)+(0.82395338594)*0.5**o
        ref[5,0,0]=(0.132222069751)/(o+1.)+(0.399751404175)+(-0.631799410304)*0.5**o
        ref[5,0,1]=(0.660932493381)/(o+1.)+(-0.501555837272)+(-0.871739775831)*0.5**o
        ref[5,1,0]=(0.70647119912)/(o+1.)+(-0.0811972291003)+(-0.927257402325)*0.5**o
        ref[5,1,1]=(0.172815874747)/(o+1.)+(-0.28134851555)+(-0.440675815785)*0.5**o
      else:
        s[0,0,0]=(-0.565533896373)*x[0]**o+(-0.0872485111367)*x[0]+(-0.283353388539)*x[1]**o+(-0.152989536217)*x[1]+(-0.444002969358)*x[2]**o+(0.670423385061)*x[2]
        s[0,0,1]=(-0.0944154284688)*x[0]**o+(-0.884982028889)*x[0]+(0.79965600284)*x[1]**o+(-0.422245813699)*x[1]+(-0.479173724334)*x[2]**o+(-0.726826676767)*x[2]
        s[0,1,0]=(0.789722540135)*x[0]**o+(-0.0774752885776)*x[0]+(-0.95515742871)*x[1]**o+(0.300583198538)*x[1]+(0.485489410617)*x[2]**o+(-0.303592354814)*x[2]
        s[0,1,1]=(0.652206005345)*x[0]**o+(0.90387230638)*x[0]+(-0.943316098191)*x[1]**o+(-0.600569529668)*x[1]+(-0.157071495888)*x[2]**o+(0.289655248779)*x[2]
        s[1,0,0]=(0.963881471424)*x[0]**o+(-0.67090862423)*x[0]+(-0.56250637167)*x[1]**o+(0.432938287823)*x[1]+(0.632690957193)*x[2]**o+(0.437978271014)*x[2]
        s[1,0,1]=(0.211364301181)*x[0]**o+(-0.482725619403)*x[0]+(0.818668277765)*x[1]**o+(-0.202108275895)*x[1]+(0.38755788328)*x[2]**o+(0.315009480388)*x[2]
        s[1,1,0]=(-0.931623738361)*x[0]**o+(0.865171378595)*x[0]+(0.983563036962)*x[1]**o+(-0.674022850075)*x[1]+(-0.743850008639)*x[2]**o+(-0.666081693537)*x[2]
        s[1,1,1]=(0.00368798622506)*x[0]**o+(0.431757463365)*x[0]+(-0.348566468597)*x[1]**o+(0.451792881229)*x[1]+(-0.380511811466)*x[2]**o+(0.850391058252)*x[2]
        s[2,0,0]=(0.0418268780255)*x[0]**o+(0.749915304085)*x[0]+(0.155766457341)*x[1]**o+(0.782071885494)*x[1]+(-0.539808510551)*x[2]**o+(0.483245601178)*x[2]
        s[2,0,1]=(-0.460744056666)*x[0]**o+(0.124701348548)*x[0]+(-0.703875182049)*x[1]**o+(0.796527478381)*x[1]+(-0.221938800568)*x[2]**o+(0.971830341802)*x[2]
        s[2,1,0]=(0.53954548965)*x[0]**o+(0.0162996837218)*x[0]+(0.142104929682)*x[1]**o+(-0.971657840256)*x[1]+(-0.503179671457)*x[2]**o+(-0.542014263985)*x[2]
        s[2,1,1]=(0.908980902057)*x[0]**o+(-0.502995849973)*x[0]+(-0.306045266955)*x[1]**o+(0.663346607536)*x[1]+(-0.350114579334)*x[2]**o+(0.576410602991)*x[2]
        s[3,0,0]=(0.813242844535)*x[0]**o+(-0.373751247405)*x[0]+(-0.155529865713)*x[1]**o+(-0.757860853884)*x[1]+(0.834637852603)*x[2]**o+(0.909806811712)*x[2]
        s[3,0,1]=(-0.287829796913)*x[0]**o+(-0.521503208519)*x[0]+(0.373235117298)*x[1]**o+(0.820819656976)*x[1]+(0.666911247106)*x[2]**o+(-0.0367218914776)*x[2]
        s[3,1,0]=(0.432791246384)*x[0]**o+(0.958703389048)*x[0]+(0.964027641291)*x[1]**o+(0.546429571768)*x[1]+(-0.299474553396)*x[2]**o+(-0.699665640827)*x[2]
        s[3,1,1]=(0.728884851779)*x[0]**o+(0.650980056729)*x[0]+(0.133592857822)*x[1]**o+(0.693391334869)*x[1]+(-0.836602488593)*x[2]**o+(-0.442753441073)*x[2]
        s[4,0,0]=(0.833243436386)*x[0]**o+(0.980178093504)*x[0]+(-0.819050787144)*x[1]**o+(0.797889271257)*x[1]+(-0.723026474407)*x[2]**o+(0.783764698489)*x[2]
        s[4,0,1]=(-0.452251186626)*x[0]**o+(-0.627980945947)*x[0]+(-0.462394480861)*x[1]**o+(-0.591297748282)*x[1]+(-0.630289931985)*x[2]**o+(0.495939505391)*x[2]
        s[4,1,0]=(-0.774984503568)*x[0]**o+(0.635843202085)*x[0]+(0.835305935226)*x[1]**o+(-0.0209656725511)*x[1]+(0.257099035711)*x[2]**o+(-0.735192237148)*x[2]
        s[4,1,1]=(0.919373693068)*x[0]**o+(0.38072204474)*x[0]+(-0.92955685309)*x[1]**o+(-0.145126274743)*x[1]+(-0.50004893122)*x[2]**o+(-0.252139341208)*x[2]
        s[5,0,0]=(0.802245464817)*x[0]**o+(0.617146384769)*x[0]+(0.0802760805435)*x[1]**o+(-0.698667208547)*x[1]+(-0.531164225022)*x[2]**o+(-0.761354857435)*x[2]
        s[5,0,1]=(-0.400952829207)*x[0]**o+(0.605414258928)*x[0]+(0.563769114393)*x[1]**o+(0.952187363261)*x[1]+(-0.539409233701)*x[2]**o+(-0.680444521941)*x[2]
        s[5,1,0]=(0.0304057674653)*x[0]**o+(0.190919897349)*x[0]+(-0.812827460152)*x[1]**o+(0.822295166707)*x[1]+(0.678796730302)*x[2]**o+(-0.648229118268)*x[2]
        s[5,1,1]=(0.644695792666)*x[0]**o+(-0.0232924889471)*x[0]+(0.294470818979)*x[1]**o+(0.626411257894)*x[1]+(-0.453808003683)*x[2]**o+(0.89191417949)*x[2]
        ref[0,0,0]=(-0.727356357898)/(o+1.)+(0.215092668853)+(-0.565533896373)*0.5**o
        ref[0,0,1]=(0.320482278506)/(o+1.)+(-1.01702725968)+(-0.0944154284688)*0.5**o
        ref[0,1,0]=(-0.469668018093)/(o+1.)+(-0.0402422224272)+(0.789722540135)*0.5**o
        ref[0,1,1]=(-1.10038759408)/(o+1.)+(0.296479012746)+(0.652206005345)*0.5**o
        ref[1,0,0]=(0.0701845855234)/(o+1.)+(0.100003967304)+(0.963881471424)*0.5**o
        ref[1,0,1]=(1.20622616105)/(o+1.)+(-0.184912207455)+(0.211364301181)*0.5**o
        ref[1,1,0]=(0.239713028324)/(o+1.)+(-0.237466582508)+(-0.931623738361)*0.5**o
        ref[1,1,1]=(-0.729078280063)/(o+1.)+(0.866970701424)+(0.00368798622506)*0.5**o
        ref[2,0,0]=(-0.38404205321)/(o+1.)+(1.00761639538)+(0.0418268780255)*0.5**o
        ref[2,0,1]=(-0.925813982617)/(o+1.)+(0.946529584366)+(-0.460744056666)*0.5**o
        ref[2,1,0]=(-0.361074741775)/(o+1.)+(-0.74868621026)+(0.53954548965)*0.5**o
        ref[2,1,1]=(-0.656159846289)/(o+1.)+(0.368380680277)+(0.908980902057)*0.5**o
        ref[3,0,0]=(0.67910798689)/(o+1.)+(-0.110902644788)+(0.813242844535)*0.5**o
        ref[3,0,1]=(1.0401463644)/(o+1.)+(0.13129727849)+(-0.287829796913)*0.5**o
        ref[3,1,0]=(0.664553087895)/(o+1.)+(0.402733659994)+(0.432791246384)*0.5**o
        ref[3,1,1]=(-0.703009630771)/(o+1.)+(0.450808975263)+(0.728884851779)*0.5**o
        ref[4,0,0]=(-1.54207726155)/(o+1.)+(1.28091603163)+(0.833243436386)*0.5**o
        ref[4,0,1]=(-1.09268441285)/(o+1.)+(-0.361669594419)+(-0.452251186626)*0.5**o
        ref[4,1,0]=(1.09240497094)/(o+1.)+(-0.0601573538071)+(-0.774984503568)*0.5**o
        ref[4,1,1]=(-1.42960578431)/(o+1.)+(-0.00827178560514)+(0.919373693068)*0.5**o
        ref[5,0,0]=(-0.450888144479)/(o+1.)+(-0.421437840607)+(0.802245464817)*0.5**o
        ref[5,0,1]=(0.0243598806918)/(o+1.)+(0.438578550124)+(-0.400952829207)*0.5**o
        ref[5,1,0]=(-0.13403072985)/(o+1.)+(0.182492972894)+(0.0304057674653)*0.5**o
        ref[5,1,1]=(-0.159337184705)/(o+1.)+(0.747516474218)+(0.644695792666)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_Solution_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.0390601545717)*x[0]**o+(-0.222613292224)*x[0]+(0.246692793786)*x[1]**o+(-0.0199554145217)*x[1]
        s[0,0,0,1]=(0.608816949634)*x[0]**o+(0.840495963273)*x[0]+(-0.986136095398)*x[1]**o+(0.16852755525)*x[1]
        s[0,0,1,0]=(0.580621174141)*x[0]**o+(-0.931460241997)*x[0]+(0.725705948245)*x[1]**o+(0.0239157549247)*x[1]
        s[0,0,1,1]=(0.388567471102)*x[0]**o+(0.311382975022)*x[0]+(-0.376543304375)*x[1]**o+(-0.859691633345)*x[1]
        s[0,0,2,0]=(-0.692988033922)*x[0]**o+(-0.059082135717)*x[0]+(-0.088525361736)*x[1]**o+(-0.435255796923)*x[1]
        s[0,0,2,1]=(0.274277434778)*x[0]**o+(0.783272547433)*x[0]+(-0.380234357131)*x[1]**o+(-0.355490082493)*x[1]
        s[0,1,0,0]=(-0.802394756916)*x[0]**o+(-0.352698691101)*x[0]+(0.335411545595)*x[1]**o+(0.558556090302)*x[1]
        s[0,1,0,1]=(0.174271017656)*x[0]**o+(-0.442785108924)*x[0]+(0.178161299328)*x[1]**o+(-0.18823731442)*x[1]
        s[0,1,1,0]=(-0.598879030318)*x[0]**o+(0.373869209105)*x[0]+(0.589565043365)*x[1]**o+(-0.62976640408)*x[1]
        s[0,1,1,1]=(-0.667493955405)*x[0]**o+(0.998759793079)*x[0]+(-0.743341570183)*x[1]**o+(-0.0859848525819)*x[1]
        s[0,1,2,0]=(0.47631386081)*x[0]**o+(0.0151722662021)*x[0]+(0.899075872977)*x[1]**o+(0.0678095622752)*x[1]
        s[0,1,2,1]=(-0.497833539416)*x[0]**o+(0.00600269705464)*x[0]+(-0.541353591572)*x[1]**o+(0.0705426009397)*x[1]
        s[0,2,0,0]=(-0.735607995943)*x[0]**o+(0.921942121227)*x[0]+(-0.697588210675)*x[1]**o+(-0.555902048922)*x[1]
        s[0,2,0,1]=(0.705776536011)*x[0]**o+(0.202303757789)*x[0]+(-0.630771158486)*x[1]**o+(-0.0166043126446)*x[1]
        s[0,2,1,0]=(-0.975134219189)*x[0]**o+(0.566584421811)*x[0]+(0.315121166158)*x[1]**o+(-0.952791171948)*x[1]
        s[0,2,1,1]=(-0.43751086407)*x[0]**o+(0.793023085525)*x[0]+(-0.471199351714)*x[1]**o+(0.227828159087)*x[1]
        s[0,2,2,0]=(0.526770705207)*x[0]**o+(-0.779856515281)*x[0]+(0.433608622434)*x[1]**o+(0.45679766746)*x[1]
        s[0,2,2,1]=(-0.418834628035)*x[0]**o+(0.325385358616)*x[0]+(0.0493546850323)*x[1]**o+(-0.611087977891)*x[1]
        s[0,3,0,0]=(0.302691082154)*x[0]**o+(-0.0840254373723)*x[0]+(0.235788766456)*x[1]**o+(0.00697145365732)*x[1]
        s[0,3,0,1]=(-0.400507082213)*x[0]**o+(0.922575813908)*x[0]+(0.653142282067)*x[1]**o+(-0.819060793296)*x[1]
        s[0,3,1,0]=(-0.542123872101)*x[0]**o+(-0.386997884801)*x[0]+(-0.0222151576861)*x[1]**o+(-0.914062036349)*x[1]
        s[0,3,1,1]=(0.0629454961983)*x[0]**o+(0.953558638015)*x[0]+(-0.977561971438)*x[1]**o+(-0.3034113517)*x[1]
        s[0,3,2,0]=(0.088224801816)*x[0]**o+(-0.0370702186771)*x[0]+(0.094320839406)*x[1]**o+(-0.342299582748)*x[1]
        s[0,3,2,1]=(0.976917465786)*x[0]**o+(-0.528174142655)*x[0]+(-0.387883052017)*x[1]**o+(-0.631752291799)*x[1]
        s[0,4,0,0]=(-0.468335475351)*x[0]**o+(-0.565555734167)*x[0]+(-0.308997447406)*x[1]**o+(-0.747826956462)*x[1]
        s[0,4,0,1]=(0.069233902558)*x[0]**o+(-0.646481367913)*x[0]+(-0.978900933671)*x[1]**o+(0.743358367572)*x[1]
        s[0,4,1,0]=(0.192177279681)*x[0]**o+(0.443905094115)*x[0]+(-0.687749538927)*x[1]**o+(-0.0130016040578)*x[1]
        s[0,4,1,1]=(0.336586630924)*x[0]**o+(0.952526894755)*x[0]+(-0.32776980948)*x[1]**o+(-0.46574155251)*x[1]
        s[0,4,2,0]=(0.635240845083)*x[0]**o+(-0.694619696795)*x[0]+(0.184107273061)*x[1]**o+(-0.102554433435)*x[1]
        s[0,4,2,1]=(0.392781256576)*x[0]**o+(0.962026661797)*x[0]+(0.657049172645)*x[1]**o+(0.462113010746)*x[1]
        s[1,0,0,0]=(0.188456710847)*x[0]**o+(0.835668677088)*x[0]+(0.379822929854)*x[1]**o+(-0.864958528812)*x[1]
        s[1,0,0,1]=(-0.910686394304)*x[0]**o+(-0.323019307138)*x[0]+(0.339165812738)*x[1]**o+(0.651547968842)*x[1]
        s[1,0,1,0]=(0.0133563994025)*x[0]**o+(-0.931707806441)*x[0]+(0.473665399577)*x[1]**o+(-0.626120577625)*x[1]
        s[1,0,1,1]=(0.19107514064)*x[0]**o+(-0.462202695026)*x[0]+(0.46369841557)*x[1]**o+(-0.253328976575)*x[1]
        s[1,0,2,0]=(0.179414794128)*x[0]**o+(-0.809074596595)*x[0]+(0.128452495995)*x[1]**o+(-0.501454759976)*x[1]
        s[1,0,2,1]=(0.507586792052)*x[0]**o+(-0.448027963861)*x[0]+(0.244339731125)*x[1]**o+(0.506838949931)*x[1]
        s[1,1,0,0]=(0.0515340520755)*x[0]**o+(-0.554979125841)*x[0]+(0.508215404195)*x[1]**o+(-0.880450798699)*x[1]
        s[1,1,0,1]=(0.149995895729)*x[0]**o+(0.207292493123)*x[0]+(-0.0719243226652)*x[1]**o+(-0.9540219098)*x[1]
        s[1,1,1,0]=(-0.298918981626)*x[0]**o+(0.90891772564)*x[0]+(0.0457980649267)*x[1]**o+(-0.266285753328)*x[1]
        s[1,1,1,1]=(-0.833495545848)*x[0]**o+(0.902967001807)*x[0]+(0.103572135419)*x[1]**o+(-0.262026617122)*x[1]
        s[1,1,2,0]=(0.381644351387)*x[0]**o+(0.77834766803)*x[0]+(-0.785664720197)*x[1]**o+(0.678219935866)*x[1]
        s[1,1,2,1]=(0.589726138962)*x[0]**o+(-0.794897130021)*x[0]+(0.0749818396161)*x[1]**o+(0.818217309223)*x[1]
        s[1,2,0,0]=(0.648262414915)*x[0]**o+(0.737500663109)*x[0]+(0.714248701071)*x[1]**o+(-0.306480036057)*x[1]
        s[1,2,0,1]=(0.154336156671)*x[0]**o+(0.988237826231)*x[0]+(0.186782608772)*x[1]**o+(-0.29179239454)*x[1]
        s[1,2,1,0]=(0.631907675013)*x[0]**o+(-0.297341493926)*x[0]+(-0.159116807039)*x[1]**o+(-0.435773119414)*x[1]
        s[1,2,1,1]=(-0.150281595818)*x[0]**o+(0.00593213086215)*x[0]+(0.995323329778)*x[1]**o+(0.978446533527)*x[1]
        s[1,2,2,0]=(0.15122501321)*x[0]**o+(0.781060971949)*x[0]+(0.945042808379)*x[1]**o+(-0.236073537251)*x[1]
        s[1,2,2,1]=(0.490853599647)*x[0]**o+(0.70560372132)*x[0]+(0.518228280852)*x[1]**o+(0.00359879318509)*x[1]
        s[1,3,0,0]=(-0.868069831372)*x[0]**o+(-0.808015513984)*x[0]+(-0.99302787628)*x[1]**o+(0.643430993188)*x[1]
        s[1,3,0,1]=(-0.540392753009)*x[0]**o+(0.412535909714)*x[0]+(-0.691622353639)*x[1]**o+(-0.726320722169)*x[1]
        s[1,3,1,0]=(-0.38171518034)*x[0]**o+(0.574401211179)*x[0]+(0.239758390058)*x[1]**o+(0.667920000788)*x[1]
        s[1,3,1,1]=(0.405015772479)*x[0]**o+(0.871607122253)*x[0]+(0.875356104271)*x[1]**o+(0.571089711154)*x[1]
        s[1,3,2,0]=(-0.859288591023)*x[0]**o+(0.0495016165977)*x[0]+(0.652544093354)*x[1]**o+(-0.950289461543)*x[1]
        s[1,3,2,1]=(-0.385753789824)*x[0]**o+(-0.929231955794)*x[0]+(-0.266920992105)*x[1]**o+(-0.170089958141)*x[1]
        s[1,4,0,0]=(0.248320342844)*x[0]**o+(-0.193177840651)*x[0]+(-0.974008625555)*x[1]**o+(0.19289653706)*x[1]
        s[1,4,0,1]=(-0.408988831595)*x[0]**o+(-0.753769725549)*x[0]+(-0.890410564837)*x[1]**o+(-0.574271841364)*x[1]
        s[1,4,1,0]=(-0.637267396746)*x[0]**o+(-0.270785389868)*x[0]+(0.272797445173)*x[1]**o+(-0.495088539306)*x[1]
        s[1,4,1,1]=(-0.711284122459)*x[0]**o+(0.635952871792)*x[0]+(-0.0849564635014)*x[1]**o+(-0.227419456586)*x[1]
        s[1,4,2,0]=(0.194861831786)*x[0]**o+(0.52267182066)*x[0]+(0.396913284632)*x[1]**o+(0.446135337457)*x[1]
        s[1,4,2,1]=(-0.111812571843)*x[0]**o+(0.919973056019)*x[0]+(0.954568821795)*x[1]**o+(-0.410846336745)*x[1]
        s[2,0,0,0]=(0.149006416722)*x[0]**o+(-0.254413162151)*x[0]+(0.66590243332)*x[1]**o+(0.28412642191)*x[1]
        s[2,0,0,1]=(-0.788828642343)*x[0]**o+(-0.384244929105)*x[0]+(-0.115430427081)*x[1]**o+(-0.670217327178)*x[1]
        s[2,0,1,0]=(0.598185590774)*x[0]**o+(-0.593162615988)*x[0]+(-0.247117069506)*x[1]**o+(-0.545724450495)*x[1]
        s[2,0,1,1]=(-0.945230420194)*x[0]**o+(-0.158557029333)*x[0]+(-0.628357637608)*x[1]**o+(-0.516938772751)*x[1]
        s[2,0,2,0]=(0.184549704327)*x[0]**o+(-0.753954168024)*x[0]+(-0.43734992018)*x[1]**o+(-0.767428538976)*x[1]
        s[2,0,2,1]=(-0.897896267578)*x[0]**o+(0.782159121394)*x[0]+(0.926088436529)*x[1]**o+(-0.922666911396)*x[1]
        s[2,1,0,0]=(-0.0375376932325)*x[0]**o+(-0.648996277693)*x[0]+(0.163113306006)*x[1]**o+(0.326391594556)*x[1]
        s[2,1,0,1]=(-0.603507455453)*x[0]**o+(-0.227212072795)*x[0]+(0.762838138451)*x[1]**o+(0.784904636664)*x[1]
        s[2,1,1,0]=(-0.250121932289)*x[0]**o+(0.820330134347)*x[0]+(0.954063036094)*x[1]**o+(-0.0944681705347)*x[1]
        s[2,1,1,1]=(0.0147284052497)*x[0]**o+(0.214839823184)*x[0]+(-0.932724945971)*x[1]**o+(0.723405207766)*x[1]
        s[2,1,2,0]=(-0.832131948289)*x[0]**o+(-0.361716015855)*x[0]+(-0.648739038507)*x[1]**o+(-0.825135489955)*x[1]
        s[2,1,2,1]=(-0.809460903823)*x[0]**o+(0.219025460406)*x[0]+(-0.399288944386)*x[1]**o+(-0.443923619258)*x[1]
        s[2,2,0,0]=(0.851821921349)*x[0]**o+(0.864789449232)*x[0]+(-0.146472829559)*x[1]**o+(-0.13802610172)*x[1]
        s[2,2,0,1]=(0.145872642324)*x[0]**o+(-0.53737681799)*x[0]+(-0.262458059774)*x[1]**o+(-0.865100768157)*x[1]
        s[2,2,1,0]=(-0.97150697777)*x[0]**o+(0.74271566101)*x[0]+(-0.941540320886)*x[1]**o+(-0.992417829758)*x[1]
        s[2,2,1,1]=(0.705001677542)*x[0]**o+(-0.464736083815)*x[0]+(0.725341857111)*x[1]**o+(-0.350205035943)*x[1]
        s[2,2,2,0]=(-0.405826604429)*x[0]**o+(0.741314043354)*x[0]+(-0.797706422949)*x[1]**o+(0.177373453057)*x[1]
        s[2,2,2,1]=(-0.338189348522)*x[0]**o+(-0.933697184604)*x[0]+(-0.381859891282)*x[1]**o+(0.0825590545614)*x[1]
        s[2,3,0,0]=(-0.532343324478)*x[0]**o+(-0.425963751562)*x[0]+(0.306014483173)*x[1]**o+(-0.886115500167)*x[1]
        s[2,3,0,1]=(0.384975538101)*x[0]**o+(0.198217241539)*x[0]+(0.939876357973)*x[1]**o+(-0.227463489114)*x[1]
        s[2,3,1,0]=(0.39221893978)*x[0]**o+(-0.173675431821)*x[0]+(0.929829286228)*x[1]**o+(0.643170164534)*x[1]
        s[2,3,1,1]=(-0.706521549808)*x[0]**o+(-0.6114595264)*x[0]+(0.207625492571)*x[1]**o+(0.262958323309)*x[1]
        s[2,3,2,0]=(0.464449153296)*x[0]**o+(-0.438225086666)*x[0]+(-0.463914786644)*x[1]**o+(0.532074329884)*x[1]
        s[2,3,2,1]=(-0.755612237619)*x[0]**o+(0.450659729492)*x[0]+(0.265758298887)*x[1]**o+(0.0352759835818)*x[1]
        s[2,4,0,0]=(-0.913101029308)*x[0]**o+(-0.244134313945)*x[0]+(0.347084253405)*x[1]**o+(0.84625762348)*x[1]
        s[2,4,0,1]=(-0.261381262076)*x[0]**o+(-0.0817994875895)*x[0]+(0.870579357546)*x[1]**o+(-0.917318949068)*x[1]
        s[2,4,1,0]=(-0.128568967272)*x[0]**o+(0.732248131756)*x[0]+(0.414206585164)*x[1]**o+(0.659941361833)*x[1]
        s[2,4,1,1]=(0.924901584611)*x[0]**o+(0.592074499154)*x[0]+(0.681628131999)*x[1]**o+(0.167953983361)*x[1]
        s[2,4,2,0]=(0.409615949394)*x[0]**o+(-0.902690757356)*x[0]+(0.577674551804)*x[1]**o+(0.0220011629429)*x[1]
        s[2,4,2,1]=(0.382356012027)*x[0]**o+(-0.423633937718)*x[0]+(-0.592574898322)*x[1]**o+(0.183184987952)*x[1]
        s[3,0,0,0]=(-0.254267267009)*x[0]**o+(-0.665177288859)*x[0]+(-0.666690913098)*x[1]**o+(-0.433935909161)*x[1]
        s[3,0,0,1]=(-0.672935968283)*x[0]**o+(-0.862578688926)*x[0]+(-0.431014198736)*x[1]**o+(-0.950634125485)*x[1]
        s[3,0,1,0]=(0.198586757881)*x[0]**o+(0.654459371747)*x[0]+(0.768197508919)*x[1]**o+(-0.911430651255)*x[1]
        s[3,0,1,1]=(0.835596691179)*x[0]**o+(0.662532614321)*x[0]+(0.64745394627)*x[1]**o+(-0.177665076446)*x[1]
        s[3,0,2,0]=(-0.60108209247)*x[0]**o+(0.104120238589)*x[0]+(0.478363486403)*x[1]**o+(0.60998776125)*x[1]
        s[3,0,2,1]=(-0.632653025461)*x[0]**o+(0.415693475381)*x[0]+(-0.0139161976239)*x[1]**o+(-0.486360398365)*x[1]
        s[3,1,0,0]=(-0.216238961155)*x[0]**o+(0.605030211804)*x[0]+(-0.894286771395)*x[1]**o+(-0.738005399203)*x[1]
        s[3,1,0,1]=(0.453465128819)*x[0]**o+(-0.958353730943)*x[0]+(-0.191303802435)*x[1]**o+(-0.403969790319)*x[1]
        s[3,1,1,0]=(-0.371601120889)*x[0]**o+(-0.000506485761004)*x[0]+(0.128347107042)*x[1]**o+(-0.617448247517)*x[1]
        s[3,1,1,1]=(-0.492741845463)*x[0]**o+(0.114070742237)*x[0]+(0.968707420077)*x[1]**o+(0.897709784012)*x[1]
        s[3,1,2,0]=(-0.774958662409)*x[0]**o+(0.712770979439)*x[0]+(0.825889537824)*x[1]**o+(0.73040987218)*x[1]
        s[3,1,2,1]=(0.412550829295)*x[0]**o+(-0.861820540337)*x[0]+(-0.64322990825)*x[1]**o+(0.262526540471)*x[1]
        s[3,2,0,0]=(-0.543691366072)*x[0]**o+(0.685553656644)*x[0]+(0.65968803389)*x[1]**o+(0.664750334284)*x[1]
        s[3,2,0,1]=(0.428045943755)*x[0]**o+(-0.140247368953)*x[0]+(0.380175178975)*x[1]**o+(-0.467518419036)*x[1]
        s[3,2,1,0]=(-0.389824098536)*x[0]**o+(-0.276525222589)*x[0]+(0.147155465185)*x[1]**o+(0.976584972227)*x[1]
        s[3,2,1,1]=(-0.801779406727)*x[0]**o+(-0.265379451805)*x[0]+(-0.515076806975)*x[1]**o+(0.436497310193)*x[1]
        s[3,2,2,0]=(0.484267483123)*x[0]**o+(0.17147902302)*x[0]+(0.386200975176)*x[1]**o+(-0.467212146867)*x[1]
        s[3,2,2,1]=(0.508871274459)*x[0]**o+(-0.819775442961)*x[0]+(0.662298902936)*x[1]**o+(-0.680488821518)*x[1]
        s[3,3,0,0]=(-0.268312881659)*x[0]**o+(0.879490107736)*x[0]+(-0.0144262822452)*x[1]**o+(-0.71519934726)*x[1]
        s[3,3,0,1]=(-0.790430004852)*x[0]**o+(-0.532618460762)*x[0]+(0.253908480901)*x[1]**o+(-0.909634079731)*x[1]
        s[3,3,1,0]=(0.0137346713747)*x[0]**o+(-0.385222519657)*x[0]+(-0.217309505922)*x[1]**o+(-0.488231851176)*x[1]
        s[3,3,1,1]=(-0.0284395764434)*x[0]**o+(0.604128820394)*x[0]+(0.459487518143)*x[1]**o+(0.0415640328609)*x[1]
        s[3,3,2,0]=(-0.162643181454)*x[0]**o+(0.998506598628)*x[0]+(0.772502162236)*x[1]**o+(0.0667163114862)*x[1]
        s[3,3,2,1]=(0.623630922274)*x[0]**o+(0.148711722927)*x[0]+(-0.161606838558)*x[1]**o+(0.156709490526)*x[1]
        s[3,4,0,0]=(-0.30946349425)*x[0]**o+(0.0987044449972)*x[0]+(0.620328824713)*x[1]**o+(0.212795150211)*x[1]
        s[3,4,0,1]=(-0.431480440685)*x[0]**o+(-0.000853814120948)*x[0]+(0.322994919175)*x[1]**o+(-0.444398394184)*x[1]
        s[3,4,1,0]=(0.768816881062)*x[0]**o+(-0.148697199679)*x[0]+(0.676778413386)*x[1]**o+(0.58721092116)*x[1]
        s[3,4,1,1]=(0.642322282841)*x[0]**o+(-0.863985751359)*x[0]+(-0.030305847597)*x[1]**o+(0.16420798613)*x[1]
        s[3,4,2,0]=(-0.652491180967)*x[0]**o+(-0.455511531309)*x[0]+(0.739317807968)*x[1]**o+(-0.299398746891)*x[1]
        s[3,4,2,1]=(-0.934623810452)*x[0]**o+(0.0755256471511)*x[0]+(-0.573554337332)*x[1]**o+(0.940012415898)*x[1]
        ref[0,0,0,0]=(0.246692793786)/(o+1.)+(-0.121284353373)+(0.0390601545717)*0.5**o
        ref[0,0,0,1]=(-0.986136095398)/(o+1.)+(0.504511759262)+(0.608816949634)*0.5**o
        ref[0,0,1,0]=(0.725705948245)/(o+1.)+(-0.453772243536)+(0.580621174141)*0.5**o
        ref[0,0,1,1]=(-0.376543304375)/(o+1.)+(-0.274154329162)+(0.388567471102)*0.5**o
        ref[0,0,2,0]=(-0.088525361736)/(o+1.)+(-0.24716896632)+(-0.692988033922)*0.5**o
        ref[0,0,2,1]=(-0.380234357131)/(o+1.)+(0.21389123247)+(0.274277434778)*0.5**o
        ref[0,1,0,0]=(0.335411545595)/(o+1.)+(0.1029286996)+(-0.802394756916)*0.5**o
        ref[0,1,0,1]=(0.178161299328)/(o+1.)+(-0.315511211672)+(0.174271017656)*0.5**o
        ref[0,1,1,0]=(0.589565043365)/(o+1.)+(-0.127948597487)+(-0.598879030318)*0.5**o
        ref[0,1,1,1]=(-0.743341570183)/(o+1.)+(0.456387470249)+(-0.667493955405)*0.5**o
        ref[0,1,2,0]=(0.899075872977)/(o+1.)+(0.0414909142386)+(0.47631386081)*0.5**o
        ref[0,1,2,1]=(-0.541353591572)/(o+1.)+(0.0382726489972)+(-0.497833539416)*0.5**o
        ref[0,2,0,0]=(-0.697588210675)/(o+1.)+(0.183020036152)+(-0.735607995943)*0.5**o
        ref[0,2,0,1]=(-0.630771158486)/(o+1.)+(0.0928497225723)+(0.705776536011)*0.5**o
        ref[0,2,1,0]=(0.315121166158)/(o+1.)+(-0.193103375068)+(-0.975134219189)*0.5**o
        ref[0,2,1,1]=(-0.471199351714)/(o+1.)+(0.510425622306)+(-0.43751086407)*0.5**o
        ref[0,2,2,0]=(0.433608622434)/(o+1.)+(-0.16152942391)+(0.526770705207)*0.5**o
        ref[0,2,2,1]=(0.0493546850323)/(o+1.)+(-0.142851309637)+(-0.418834628035)*0.5**o
        ref[0,3,0,0]=(0.235788766456)/(o+1.)+(-0.0385269918575)+(0.302691082154)*0.5**o
        ref[0,3,0,1]=(0.653142282067)/(o+1.)+(0.0517575103062)+(-0.400507082213)*0.5**o
        ref[0,3,1,0]=(-0.0222151576861)/(o+1.)+(-0.650529960575)+(-0.542123872101)*0.5**o
        ref[0,3,1,1]=(-0.977561971438)/(o+1.)+(0.325073643158)+(0.0629454961983)*0.5**o
        ref[0,3,2,0]=(0.094320839406)/(o+1.)+(-0.189684900712)+(0.088224801816)*0.5**o
        ref[0,3,2,1]=(-0.387883052017)/(o+1.)+(-0.579963217227)+(0.976917465786)*0.5**o
        ref[0,4,0,0]=(-0.308997447406)/(o+1.)+(-0.656691345314)+(-0.468335475351)*0.5**o
        ref[0,4,0,1]=(-0.978900933671)/(o+1.)+(0.0484384998298)+(0.069233902558)*0.5**o
        ref[0,4,1,0]=(-0.687749538927)/(o+1.)+(0.215451745029)+(0.192177279681)*0.5**o
        ref[0,4,1,1]=(-0.32776980948)/(o+1.)+(0.243392671122)+(0.336586630924)*0.5**o
        ref[0,4,2,0]=(0.184107273061)/(o+1.)+(-0.398587065115)+(0.635240845083)*0.5**o
        ref[0,4,2,1]=(0.657049172645)/(o+1.)+(0.712069836271)+(0.392781256576)*0.5**o
        ref[1,0,0,0]=(0.379822929854)/(o+1.)+(-0.014644925862)+(0.188456710847)*0.5**o
        ref[1,0,0,1]=(0.339165812738)/(o+1.)+(0.164264330852)+(-0.910686394304)*0.5**o
        ref[1,0,1,0]=(0.473665399577)/(o+1.)+(-0.778914192033)+(0.0133563994025)*0.5**o
        ref[1,0,1,1]=(0.46369841557)/(o+1.)+(-0.3577658358)+(0.19107514064)*0.5**o
        ref[1,0,2,0]=(0.128452495995)/(o+1.)+(-0.655264678285)+(0.179414794128)*0.5**o
        ref[1,0,2,1]=(0.244339731125)/(o+1.)+(0.029405493035)+(0.507586792052)*0.5**o
        ref[1,1,0,0]=(0.508215404195)/(o+1.)+(-0.71771496227)+(0.0515340520755)*0.5**o
        ref[1,1,0,1]=(-0.0719243226652)/(o+1.)+(-0.373364708338)+(0.149995895729)*0.5**o
        ref[1,1,1,0]=(0.0457980649267)/(o+1.)+(0.321315986156)+(-0.298918981626)*0.5**o
        ref[1,1,1,1]=(0.103572135419)/(o+1.)+(0.320470192342)+(-0.833495545848)*0.5**o
        ref[1,1,2,0]=(-0.785664720197)/(o+1.)+(0.728283801948)+(0.381644351387)*0.5**o
        ref[1,1,2,1]=(0.0749818396161)/(o+1.)+(0.0116600896011)+(0.589726138962)*0.5**o
        ref[1,2,0,0]=(0.714248701071)/(o+1.)+(0.215510313526)+(0.648262414915)*0.5**o
        ref[1,2,0,1]=(0.186782608772)/(o+1.)+(0.348222715845)+(0.154336156671)*0.5**o
        ref[1,2,1,0]=(-0.159116807039)/(o+1.)+(-0.36655730667)+(0.631907675013)*0.5**o
        ref[1,2,1,1]=(0.995323329778)/(o+1.)+(0.492189332195)+(-0.150281595818)*0.5**o
        ref[1,2,2,0]=(0.945042808379)/(o+1.)+(0.272493717349)+(0.15122501321)*0.5**o
        ref[1,2,2,1]=(0.518228280852)/(o+1.)+(0.354601257252)+(0.490853599647)*0.5**o
        ref[1,3,0,0]=(-0.99302787628)/(o+1.)+(-0.0822922603983)+(-0.868069831372)*0.5**o
        ref[1,3,0,1]=(-0.691622353639)/(o+1.)+(-0.156892406228)+(-0.540392753009)*0.5**o
        ref[1,3,1,0]=(0.239758390058)/(o+1.)+(0.621160605983)+(-0.38171518034)*0.5**o
        ref[1,3,1,1]=(0.875356104271)/(o+1.)+(0.721348416703)+(0.405015772479)*0.5**o
        ref[1,3,2,0]=(0.652544093354)/(o+1.)+(-0.450393922473)+(-0.859288591023)*0.5**o
        ref[1,3,2,1]=(-0.266920992105)/(o+1.)+(-0.549660956967)+(-0.385753789824)*0.5**o
        ref[1,4,0,0]=(-0.974008625555)/(o+1.)+(-0.000140651795392)+(0.248320342844)*0.5**o
        ref[1,4,0,1]=(-0.890410564837)/(o+1.)+(-0.664020783456)+(-0.408988831595)*0.5**o
        ref[1,4,1,0]=(0.272797445173)/(o+1.)+(-0.382936964587)+(-0.637267396746)*0.5**o
        ref[1,4,1,1]=(-0.0849564635014)/(o+1.)+(0.204266707603)+(-0.711284122459)*0.5**o
        ref[1,4,2,0]=(0.396913284632)/(o+1.)+(0.484403579059)+(0.194861831786)*0.5**o
        ref[1,4,2,1]=(0.954568821795)/(o+1.)+(0.254563359637)+(-0.111812571843)*0.5**o
        ref[2,0,0,0]=(0.66590243332)/(o+1.)+(0.0148566298797)+(0.149006416722)*0.5**o
        ref[2,0,0,1]=(-0.115430427081)/(o+1.)+(-0.527231128141)+(-0.788828642343)*0.5**o
        ref[2,0,1,0]=(-0.247117069506)/(o+1.)+(-0.569443533242)+(0.598185590774)*0.5**o
        ref[2,0,1,1]=(-0.628357637608)/(o+1.)+(-0.337747901042)+(-0.945230420194)*0.5**o
        ref[2,0,2,0]=(-0.43734992018)/(o+1.)+(-0.7606913535)+(0.184549704327)*0.5**o
        ref[2,0,2,1]=(0.926088436529)/(o+1.)+(-0.070253895001)+(-0.897896267578)*0.5**o
        ref[2,1,0,0]=(0.163113306006)/(o+1.)+(-0.161302341569)+(-0.0375376932325)*0.5**o
        ref[2,1,0,1]=(0.762838138451)/(o+1.)+(0.278846281935)+(-0.603507455453)*0.5**o
        ref[2,1,1,0]=(0.954063036094)/(o+1.)+(0.362930981906)+(-0.250121932289)*0.5**o
        ref[2,1,1,1]=(-0.932724945971)/(o+1.)+(0.469122515475)+(0.0147284052497)*0.5**o
        ref[2,1,2,0]=(-0.648739038507)/(o+1.)+(-0.593425752905)+(-0.832131948289)*0.5**o
        ref[2,1,2,1]=(-0.399288944386)/(o+1.)+(-0.112449079426)+(-0.809460903823)*0.5**o
        ref[2,2,0,0]=(-0.146472829559)/(o+1.)+(0.363381673756)+(0.851821921349)*0.5**o
        ref[2,2,0,1]=(-0.262458059774)/(o+1.)+(-0.701238793074)+(0.145872642324)*0.5**o
        ref[2,2,1,0]=(-0.941540320886)/(o+1.)+(-0.124851084374)+(-0.97150697777)*0.5**o
        ref[2,2,1,1]=(0.725341857111)/(o+1.)+(-0.407470559879)+(0.705001677542)*0.5**o
        ref[2,2,2,0]=(-0.797706422949)/(o+1.)+(0.459343748206)+(-0.405826604429)*0.5**o
        ref[2,2,2,1]=(-0.381859891282)/(o+1.)+(-0.425569065022)+(-0.338189348522)*0.5**o
        ref[2,3,0,0]=(0.306014483173)/(o+1.)+(-0.656039625864)+(-0.532343324478)*0.5**o
        ref[2,3,0,1]=(0.939876357973)/(o+1.)+(-0.0146231237877)+(0.384975538101)*0.5**o
        ref[2,3,1,0]=(0.929829286228)/(o+1.)+(0.234747366357)+(0.39221893978)*0.5**o
        ref[2,3,1,1]=(0.207625492571)/(o+1.)+(-0.174250601546)+(-0.706521549808)*0.5**o
        ref[2,3,2,0]=(-0.463914786644)/(o+1.)+(0.046924621609)+(0.464449153296)*0.5**o
        ref[2,3,2,1]=(0.265758298887)/(o+1.)+(0.242967856537)+(-0.755612237619)*0.5**o
        ref[2,4,0,0]=(0.347084253405)/(o+1.)+(0.301061654767)+(-0.913101029308)*0.5**o
        ref[2,4,0,1]=(0.870579357546)/(o+1.)+(-0.499559218329)+(-0.261381262076)*0.5**o
        ref[2,4,1,0]=(0.414206585164)/(o+1.)+(0.696094746795)+(-0.128568967272)*0.5**o
        ref[2,4,1,1]=(0.681628131999)/(o+1.)+(0.380014241257)+(0.924901584611)*0.5**o
        ref[2,4,2,0]=(0.577674551804)/(o+1.)+(-0.440344797207)+(0.409615949394)*0.5**o
        ref[2,4,2,1]=(-0.592574898322)/(o+1.)+(-0.120224474883)+(0.382356012027)*0.5**o
        ref[3,0,0,0]=(-0.666690913098)/(o+1.)+(-0.54955659901)+(-0.254267267009)*0.5**o
        ref[3,0,0,1]=(-0.431014198736)/(o+1.)+(-0.906606407206)+(-0.672935968283)*0.5**o
        ref[3,0,1,0]=(0.768197508919)/(o+1.)+(-0.128485639754)+(0.198586757881)*0.5**o
        ref[3,0,1,1]=(0.64745394627)/(o+1.)+(0.242433768937)+(0.835596691179)*0.5**o
        ref[3,0,2,0]=(0.478363486403)/(o+1.)+(0.35705399992)+(-0.60108209247)*0.5**o
        ref[3,0,2,1]=(-0.0139161976239)/(o+1.)+(-0.0353334614921)+(-0.632653025461)*0.5**o
        ref[3,1,0,0]=(-0.894286771395)/(o+1.)+(-0.0664875936996)+(-0.216238961155)*0.5**o
        ref[3,1,0,1]=(-0.191303802435)/(o+1.)+(-0.681161760631)+(0.453465128819)*0.5**o
        ref[3,1,1,0]=(0.128347107042)/(o+1.)+(-0.308977366639)+(-0.371601120889)*0.5**o
        ref[3,1,1,1]=(0.968707420077)/(o+1.)+(0.505890263125)+(-0.492741845463)*0.5**o
        ref[3,1,2,0]=(0.825889537824)/(o+1.)+(0.72159042581)+(-0.774958662409)*0.5**o
        ref[3,1,2,1]=(-0.64322990825)/(o+1.)+(-0.299646999933)+(0.412550829295)*0.5**o
        ref[3,2,0,0]=(0.65968803389)/(o+1.)+(0.675151995464)+(-0.543691366072)*0.5**o
        ref[3,2,0,1]=(0.380175178975)/(o+1.)+(-0.303882893994)+(0.428045943755)*0.5**o
        ref[3,2,1,0]=(0.147155465185)/(o+1.)+(0.350029874819)+(-0.389824098536)*0.5**o
        ref[3,2,1,1]=(-0.515076806975)/(o+1.)+(0.0855589291935)+(-0.801779406727)*0.5**o
        ref[3,2,2,0]=(0.386200975176)/(o+1.)+(-0.147866561923)+(0.484267483123)*0.5**o
        ref[3,2,2,1]=(0.662298902936)/(o+1.)+(-0.75013213224)+(0.508871274459)*0.5**o
        ref[3,3,0,0]=(-0.0144262822452)/(o+1.)+(0.0821453802379)+(-0.268312881659)*0.5**o
        ref[3,3,0,1]=(0.253908480901)/(o+1.)+(-0.721126270246)+(-0.790430004852)*0.5**o
        ref[3,3,1,0]=(-0.217309505922)/(o+1.)+(-0.436727185417)+(0.0137346713747)*0.5**o
        ref[3,3,1,1]=(0.459487518143)/(o+1.)+(0.322846426627)+(-0.0284395764434)*0.5**o
        ref[3,3,2,0]=(0.772502162236)/(o+1.)+(0.532611455057)+(-0.162643181454)*0.5**o
        ref[3,3,2,1]=(-0.161606838558)/(o+1.)+(0.152710606726)+(0.623630922274)*0.5**o
        ref[3,4,0,0]=(0.620328824713)/(o+1.)+(0.155749797604)+(-0.30946349425)*0.5**o
        ref[3,4,0,1]=(0.322994919175)/(o+1.)+(-0.222626104153)+(-0.431480440685)*0.5**o
        ref[3,4,1,0]=(0.676778413386)/(o+1.)+(0.21925686074)+(0.768816881062)*0.5**o
        ref[3,4,1,1]=(-0.030305847597)/(o+1.)+(-0.349888882614)+(0.642322282841)*0.5**o
        ref[3,4,2,0]=(0.739317807968)/(o+1.)+(-0.3774551391)+(-0.652491180967)*0.5**o
        ref[3,4,2,1]=(-0.573554337332)/(o+1.)+(0.507769031524)+(-0.934623810452)*0.5**o
      else:
        s[0,0,0,0]=(-0.284157309093)*x[0]**o+(0.849767107542)*x[0]+(-0.384722111658)*x[1]**o+(-0.422005634353)*x[1]+(-0.650336986527)*x[2]**o+(-0.512697943529)*x[2]
        s[0,0,0,1]=(-0.315769534489)*x[0]**o+(0.535386332325)*x[0]+(0.853804045467)*x[1]**o+(-0.547748632318)*x[1]+(0.346701407152)*x[2]**o+(0.37814849359)*x[2]
        s[0,0,1,0]=(-0.4535776613)*x[0]**o+(-0.510530838778)*x[0]+(0.276827299966)*x[1]**o+(-0.382689005507)*x[1]+(0.905088915885)*x[2]**o+(0.0949553680219)*x[2]
        s[0,0,1,1]=(-0.739956684686)*x[0]**o+(0.461075107945)*x[0]+(-0.669109047898)*x[1]**o+(0.894371361493)*x[1]+(-0.67186417627)*x[2]**o+(0.646865110437)*x[2]
        s[0,0,2,0]=(0.630514031324)*x[0]**o+(-0.200697710807)*x[0]+(-0.425713236098)*x[1]**o+(0.990076474527)*x[1]+(0.799964278476)*x[2]**o+(-0.11090726662)*x[2]
        s[0,0,2,1]=(-0.763048729267)*x[0]**o+(0.108312132849)*x[0]+(-0.0743278550192)*x[1]**o+(-0.00609761227579)*x[1]+(0.856275832244)*x[2]**o+(-0.271931694818)*x[2]
        s[0,1,0,0]=(-0.438048883736)*x[0]**o+(0.0995162169923)*x[0]+(0.991935495829)*x[1]**o+(0.10168563116)*x[1]+(0.61021228041)*x[2]**o+(0.935697636412)*x[2]
        s[0,1,0,1]=(0.169577859304)*x[0]**o+(-0.32382927444)*x[0]+(-0.416050245653)*x[1]**o+(-0.218068414951)*x[1]+(-0.828154819878)*x[2]**o+(0.510133764467)*x[2]
        s[0,1,1,0]=(-0.136877583438)*x[0]**o+(0.225702373679)*x[0]+(-0.982330481939)*x[1]**o+(-0.76035657944)*x[1]+(-0.75008234946)*x[2]**o+(0.34026332188)*x[2]
        s[0,1,1,1]=(0.21329287668)*x[0]**o+(-0.583080810655)*x[0]+(0.304728874482)*x[1]**o+(-0.513735666156)*x[1]+(0.678531278973)*x[2]**o+(0.229523450267)*x[2]
        s[0,1,2,0]=(-0.488721257593)*x[0]**o+(-0.623065480166)*x[0]+(-0.689240830032)*x[1]**o+(0.0487255710714)*x[1]+(-0.345860672549)*x[2]**o+(-0.839070113015)*x[2]
        s[0,1,2,1]=(0.0407718763863)*x[0]**o+(-0.73486237198)*x[0]+(-0.430375782223)*x[1]**o+(0.937703487997)*x[1]+(0.211905262532)*x[2]**o+(0.436342043473)*x[2]
        s[0,2,0,0]=(0.587345517354)*x[0]**o+(-0.592886902091)*x[0]+(0.552036449839)*x[1]**o+(0.623893456691)*x[1]+(0.0732753243278)*x[2]**o+(0.0126745042435)*x[2]
        s[0,2,0,1]=(-0.811084805765)*x[0]**o+(0.535274295321)*x[0]+(0.24492936339)*x[1]**o+(-0.800440152287)*x[1]+(0.631212521526)*x[2]**o+(-0.447237919067)*x[2]
        s[0,2,1,0]=(-0.222984108172)*x[0]**o+(0.666955781431)*x[0]+(-0.793761886587)*x[1]**o+(0.767105994377)*x[1]+(0.106607736355)*x[2]**o+(0.107909765632)*x[2]
        s[0,2,1,1]=(-0.351616621125)*x[0]**o+(0.918653285574)*x[0]+(0.374186423556)*x[1]**o+(0.00935909197596)*x[1]+(0.40967652737)*x[2]**o+(0.85098748057)*x[2]
        s[0,2,2,0]=(0.326986640454)*x[0]**o+(-0.922098818053)*x[0]+(0.180209899234)*x[1]**o+(-0.473771920593)*x[1]+(0.850114791793)*x[2]**o+(-0.0591994178493)*x[2]
        s[0,2,2,1]=(0.416408828986)*x[0]**o+(-0.802940087419)*x[0]+(-0.15695987973)*x[1]**o+(-0.212571438106)*x[1]+(-0.695411431279)*x[2]**o+(0.652970553889)*x[2]
        s[0,3,0,0]=(0.165546039968)*x[0]**o+(0.510754381868)*x[0]+(0.922367777435)*x[1]**o+(0.946960595929)*x[1]+(0.488750467594)*x[2]**o+(0.684670926921)*x[2]
        s[0,3,0,1]=(0.806943353866)*x[0]**o+(-0.0452688268514)*x[0]+(-0.915858505648)*x[1]**o+(-0.930357118958)*x[1]+(-0.915989552667)*x[2]**o+(-0.058763902318)*x[2]
        s[0,3,1,0]=(-0.0329058672137)*x[0]**o+(-0.347664127646)*x[0]+(-0.642805650766)*x[1]**o+(-0.772181465981)*x[1]+(-0.489006714362)*x[2]**o+(-0.92809698455)*x[2]
        s[0,3,1,1]=(0.927391314677)*x[0]**o+(-0.00818607467373)*x[0]+(-0.25019363274)*x[1]**o+(-0.944005917142)*x[1]+(0.55451200174)*x[2]**o+(0.97132400122)*x[2]
        s[0,3,2,0]=(-0.395900087683)*x[0]**o+(-0.373500614568)*x[0]+(-0.292146120482)*x[1]**o+(0.481366513649)*x[1]+(0.793324319035)*x[2]**o+(-0.0829523908121)*x[2]
        s[0,3,2,1]=(0.167004592732)*x[0]**o+(-0.412448920865)*x[0]+(-0.898556558084)*x[1]**o+(-0.490869248138)*x[1]+(-0.567143223313)*x[2]**o+(-0.732576896378)*x[2]
        s[0,4,0,0]=(-0.0559473269152)*x[0]**o+(0.927731889097)*x[0]+(-0.650788921118)*x[1]**o+(0.9760762788)*x[1]+(0.115672920967)*x[2]**o+(-0.276468719613)*x[2]
        s[0,4,0,1]=(-0.126102715426)*x[0]**o+(0.948204367434)*x[0]+(-0.337377224065)*x[1]**o+(-0.66690062976)*x[1]+(-0.0486873976343)*x[2]**o+(0.731627670267)*x[2]
        s[0,4,1,0]=(-0.465158745622)*x[0]**o+(0.825435774485)*x[0]+(-0.325537513647)*x[1]**o+(-0.514033669128)*x[1]+(0.561307474551)*x[2]**o+(0.703487324789)*x[2]
        s[0,4,1,1]=(0.433494572203)*x[0]**o+(-0.193734534196)*x[0]+(-0.285490592547)*x[1]**o+(0.7933219877)*x[1]+(-0.968093339339)*x[2]**o+(0.891238901252)*x[2]
        s[0,4,2,0]=(-0.226388318689)*x[0]**o+(0.354588341815)*x[0]+(-0.592835636922)*x[1]**o+(0.164285456556)*x[1]+(0.969440431522)*x[2]**o+(0.942251489525)*x[2]
        s[0,4,2,1]=(-0.487005215247)*x[0]**o+(-0.363562477474)*x[0]+(-0.968419416695)*x[1]**o+(0.0746396954211)*x[1]+(0.0996297479628)*x[2]**o+(-0.977105194209)*x[2]
        s[1,0,0,0]=(-0.599811357812)*x[0]**o+(0.379322984555)*x[0]+(-0.263738481625)*x[1]**o+(0.737645780912)*x[1]+(0.579734520525)*x[2]**o+(0.674309085344)*x[2]
        s[1,0,0,1]=(-0.849384033331)*x[0]**o+(0.835916113742)*x[0]+(-0.95744797963)*x[1]**o+(-0.140222671452)*x[1]+(-0.885202051612)*x[2]**o+(-0.214627624347)*x[2]
        s[1,0,1,0]=(0.560384598535)*x[0]**o+(0.521038386588)*x[0]+(0.405346505288)*x[1]**o+(0.325623245692)*x[1]+(-0.499493979476)*x[2]**o+(0.457353575559)*x[2]
        s[1,0,1,1]=(0.394452679675)*x[0]**o+(-0.335426315796)*x[0]+(0.366492975013)*x[1]**o+(-0.204908992368)*x[1]+(0.72928619323)*x[2]**o+(0.868856537052)*x[2]
        s[1,0,2,0]=(-0.286588291759)*x[0]**o+(-0.457077770862)*x[0]+(0.48947586799)*x[1]**o+(-0.483134695964)*x[1]+(-0.708198861531)*x[2]**o+(-0.185141468661)*x[2]
        s[1,0,2,1]=(0.587814763664)*x[0]**o+(0.369493163541)*x[0]+(0.973921527395)*x[1]**o+(0.792281782334)*x[1]+(-0.622350476528)*x[2]**o+(-0.0910812853654)*x[2]
        s[1,1,0,0]=(-0.0104862086098)*x[0]**o+(0.636242048755)*x[0]+(-0.831278249993)*x[1]**o+(0.789497876069)*x[1]+(-0.14996840164)*x[2]**o+(0.560466658811)*x[2]
        s[1,1,0,1]=(-0.442153331955)*x[0]**o+(0.259117434312)*x[0]+(0.624678092445)*x[1]**o+(-0.95353370493)*x[1]+(-0.647048223519)*x[2]**o+(-0.264328530894)*x[2]
        s[1,1,1,0]=(0.143778546111)*x[0]**o+(-0.0162780042157)*x[0]+(0.11561710021)*x[1]**o+(-0.750325462664)*x[1]+(0.0513768047109)*x[2]**o+(0.605731207893)*x[2]
        s[1,1,1,1]=(0.830078999256)*x[0]**o+(-0.977563707962)*x[0]+(-0.0694815703262)*x[1]**o+(-0.631908693739)*x[1]+(-0.385240583095)*x[2]**o+(-0.325723419389)*x[2]
        s[1,1,2,0]=(-0.818875997493)*x[0]**o+(0.552071308369)*x[0]+(0.42469064565)*x[1]**o+(-0.939401594531)*x[1]+(-0.704918072568)*x[2]**o+(-0.412588503126)*x[2]
        s[1,1,2,1]=(0.897735820104)*x[0]**o+(-0.229171182759)*x[0]+(-0.509740516596)*x[1]**o+(-0.182079029613)*x[1]+(-0.935655203228)*x[2]**o+(0.0659300001682)*x[2]
        s[1,2,0,0]=(-0.225661260024)*x[0]**o+(-0.705274531847)*x[0]+(0.851323519708)*x[1]**o+(0.112877579527)*x[1]+(-0.622263839274)*x[2]**o+(0.0332240292837)*x[2]
        s[1,2,0,1]=(0.188146461111)*x[0]**o+(-0.401949407666)*x[0]+(0.600435405952)*x[1]**o+(-0.205690272021)*x[1]+(-0.715745492382)*x[2]**o+(-0.842790491589)*x[2]
        s[1,2,1,0]=(-0.713236970029)*x[0]**o+(-0.261492144857)*x[0]+(-0.154448102633)*x[1]**o+(-0.970544645841)*x[1]+(-0.920289620236)*x[2]**o+(-0.97207996703)*x[2]
        s[1,2,1,1]=(0.338343830055)*x[0]**o+(0.245579659207)*x[0]+(0.0867267737353)*x[1]**o+(-0.898055915558)*x[1]+(-0.0942524838856)*x[2]**o+(-0.935035704882)*x[2]
        s[1,2,2,0]=(-0.857754750211)*x[0]**o+(-0.491056643232)*x[0]+(-0.869773943254)*x[1]**o+(-0.4760062246)*x[1]+(-0.684952853861)*x[2]**o+(-0.576097444445)*x[2]
        s[1,2,2,1]=(0.798299933694)*x[0]**o+(0.0610709183894)*x[0]+(-0.486420716864)*x[1]**o+(0.0416959278242)*x[1]+(-0.928888319279)*x[2]**o+(0.854902913513)*x[2]
        s[1,3,0,0]=(-0.22936580714)*x[0]**o+(0.708863403011)*x[0]+(0.0460624260266)*x[1]**o+(-0.49429349985)*x[1]+(-0.65165177736)*x[2]**o+(-0.640993879589)*x[2]
        s[1,3,0,1]=(0.272143747738)*x[0]**o+(-0.786035898193)*x[0]+(-0.907839432563)*x[1]**o+(-0.544282319144)*x[1]+(-0.295284311966)*x[2]**o+(-0.646933800599)*x[2]
        s[1,3,1,0]=(-0.371813536068)*x[0]**o+(-0.989821491808)*x[0]+(0.87663418945)*x[1]**o+(0.49557916163)*x[1]+(0.432075714902)*x[2]**o+(0.986679642413)*x[2]
        s[1,3,1,1]=(0.64355520606)*x[0]**o+(0.849290029179)*x[0]+(-0.588615332307)*x[1]**o+(-0.43586534156)*x[1]+(0.440278053071)*x[2]**o+(0.71924945995)*x[2]
        s[1,3,2,0]=(0.296777344281)*x[0]**o+(0.369261091311)*x[0]+(-0.542374725062)*x[1]**o+(-0.378169086763)*x[1]+(-0.376253518198)*x[2]**o+(-0.0261035492256)*x[2]
        s[1,3,2,1]=(-0.631360619387)*x[0]**o+(-0.447767234553)*x[0]+(-0.907807578651)*x[1]**o+(0.0949745118593)*x[1]+(-0.467696925918)*x[2]**o+(0.328688763502)*x[2]
        s[1,4,0,0]=(-0.864162318969)*x[0]**o+(0.0492392548816)*x[0]+(-0.443732835548)*x[1]**o+(0.216532788053)*x[1]+(-0.589754138443)*x[2]**o+(0.225238430912)*x[2]
        s[1,4,0,1]=(-0.0204110610831)*x[0]**o+(-0.361198283837)*x[0]+(-0.534453313822)*x[1]**o+(0.199660564502)*x[1]+(0.76073237233)*x[2]**o+(-0.397852751275)*x[2]
        s[1,4,1,0]=(-0.0714182037356)*x[0]**o+(-0.838354030583)*x[0]+(-0.690623231638)*x[1]**o+(0.718400117263)*x[1]+(0.81989629515)*x[2]**o+(-0.99784667739)*x[2]
        s[1,4,1,1]=(-0.789159638733)*x[0]**o+(0.0550782963202)*x[0]+(0.691693836327)*x[1]**o+(-0.995863220343)*x[1]+(0.489187641363)*x[2]**o+(-0.892540698263)*x[2]
        s[1,4,2,0]=(-0.545542033256)*x[0]**o+(0.534307451322)*x[0]+(0.164514904761)*x[1]**o+(-0.604639193552)*x[1]+(0.299777195543)*x[2]**o+(0.103353434856)*x[2]
        s[1,4,2,1]=(0.655205311592)*x[0]**o+(-0.806735930884)*x[0]+(-0.808306407454)*x[1]**o+(-0.842421999068)*x[1]+(0.071496057035)*x[2]**o+(0.327827774456)*x[2]
        s[2,0,0,0]=(-0.0509015638697)*x[0]**o+(0.122893306456)*x[0]+(-0.495264442266)*x[1]**o+(-0.700582978791)*x[1]+(0.912958594653)*x[2]**o+(0.396603396384)*x[2]
        s[2,0,0,1]=(-0.834927535726)*x[0]**o+(0.0299018772298)*x[0]+(0.950983785443)*x[1]**o+(-0.467301669211)*x[1]+(0.105169729215)*x[2]**o+(0.776869887731)*x[2]
        s[2,0,1,0]=(0.695941957197)*x[0]**o+(-0.0827202988544)*x[0]+(0.551038863364)*x[1]**o+(0.768922568953)*x[1]+(0.658453649199)*x[2]**o+(0.0845854555463)*x[2]
        s[2,0,1,1]=(-0.813515499086)*x[0]**o+(0.37498311883)*x[0]+(0.249460504439)*x[1]**o+(0.57859274713)*x[1]+(0.674876282575)*x[2]**o+(0.358162640602)*x[2]
        s[2,0,2,0]=(0.264441597574)*x[0]**o+(-0.773282762615)*x[0]+(0.548708830043)*x[1]**o+(-0.365859504864)*x[1]+(-0.971213462476)*x[2]**o+(0.341839165432)*x[2]
        s[2,0,2,1]=(0.839834410476)*x[0]**o+(0.73258814656)*x[0]+(0.0894113621016)*x[1]**o+(-0.561436557466)*x[1]+(-0.87929169767)*x[2]**o+(-0.673343626233)*x[2]
        s[2,1,0,0]=(-0.9032683394)*x[0]**o+(0.548037699973)*x[0]+(-0.275249518695)*x[1]**o+(-0.182173933698)*x[1]+(-0.797774902804)*x[2]**o+(-0.541398445737)*x[2]
        s[2,1,0,1]=(-0.563127063275)*x[0]**o+(0.0246839329162)*x[0]+(0.104775018182)*x[1]**o+(0.887831444063)*x[1]+(-0.21494247853)*x[2]**o+(-0.273454823602)*x[2]
        s[2,1,1,0]=(-0.0215129450025)*x[0]**o+(-0.388850056041)*x[0]+(0.286605493305)*x[1]**o+(0.0744061944979)*x[1]+(-0.745577158797)*x[2]**o+(0.465555807335)*x[2]
        s[2,1,1,1]=(0.862938112821)*x[0]**o+(0.440536762323)*x[0]+(0.708402486014)*x[1]**o+(-0.330067981061)*x[1]+(0.212443131768)*x[2]**o+(0.604427083557)*x[2]
        s[2,1,2,0]=(-0.151555342557)*x[0]**o+(-0.422137938709)*x[0]+(0.725618931526)*x[1]**o+(0.965446678276)*x[1]+(-0.782758787615)*x[2]**o+(-0.913406963513)*x[2]
        s[2,1,2,1]=(0.485262168703)*x[0]**o+(-0.155309809717)*x[0]+(0.346371477276)*x[1]**o+(-0.25747778813)*x[1]+(0.29003119075)*x[2]**o+(-0.994256278631)*x[2]
        s[2,2,0,0]=(0.597629111376)*x[0]**o+(-0.675075309746)*x[0]+(-0.276946615105)*x[1]**o+(0.474817826479)*x[1]+(0.384217707699)*x[2]**o+(0.370453233617)*x[2]
        s[2,2,0,1]=(0.0885418745402)*x[0]**o+(0.723684895162)*x[0]+(0.380828880196)*x[1]**o+(-0.200773722805)*x[1]+(-0.72048497776)*x[2]**o+(0.627781439124)*x[2]
        s[2,2,1,0]=(-0.7058457718)*x[0]**o+(0.605583709445)*x[0]+(-0.137932623446)*x[1]**o+(-0.355521140013)*x[1]+(-0.100629345222)*x[2]**o+(-0.0196746976828)*x[2]
        s[2,2,1,1]=(0.431391331275)*x[0]**o+(0.624577796816)*x[0]+(0.517581044445)*x[1]**o+(0.810575610489)*x[1]+(0.151026961294)*x[2]**o+(-0.116575349397)*x[2]
        s[2,2,2,0]=(-0.172742409612)*x[0]**o+(-0.525478587831)*x[0]+(-0.245244804561)*x[1]**o+(0.466265204552)*x[1]+(-0.42763207872)*x[2]**o+(-0.37841245626)*x[2]
        s[2,2,2,1]=(0.193762571076)*x[0]**o+(-0.443537851353)*x[0]+(0.703848629926)*x[1]**o+(-0.694597427026)*x[1]+(0.135855093753)*x[2]**o+(-0.845940858008)*x[2]
        s[2,3,0,0]=(-0.816708755757)*x[0]**o+(-0.181019603056)*x[0]+(-0.743213747688)*x[1]**o+(0.798697343825)*x[1]+(-0.941634970147)*x[2]**o+(0.942560075608)*x[2]
        s[2,3,0,1]=(0.557205351559)*x[0]**o+(0.573309419549)*x[0]+(0.285649088042)*x[1]**o+(-0.915772596908)*x[1]+(0.894469058714)*x[2]**o+(-0.093076259014)*x[2]
        s[2,3,1,0]=(-0.330158214652)*x[0]**o+(0.519069568809)*x[0]+(-0.584129234472)*x[1]**o+(0.508779523144)*x[1]+(-0.496105354274)*x[2]**o+(-0.119894247636)*x[2]
        s[2,3,1,1]=(0.0113498976079)*x[0]**o+(-0.817148495948)*x[0]+(-0.843322049813)*x[1]**o+(0.397509634966)*x[1]+(-0.210167599559)*x[2]**o+(0.452940815863)*x[2]
        s[2,3,2,0]=(0.548708545741)*x[0]**o+(0.701316458542)*x[0]+(0.541383513552)*x[1]**o+(0.818821487001)*x[1]+(0.0337473469103)*x[2]**o+(0.144942886826)*x[2]
        s[2,3,2,1]=(0.367699563724)*x[0]**o+(-0.558358600746)*x[0]+(0.02800962366)*x[1]**o+(0.408211655912)*x[1]+(0.808098902096)*x[2]**o+(0.406029406708)*x[2]
        s[2,4,0,0]=(0.742185577055)*x[0]**o+(0.346992242703)*x[0]+(-0.789510739504)*x[1]**o+(-0.433601148291)*x[1]+(-0.317572193313)*x[2]**o+(-0.0929823026668)*x[2]
        s[2,4,0,1]=(-0.540606064885)*x[0]**o+(0.959079111439)*x[0]+(-0.477472945875)*x[1]**o+(0.327457999632)*x[1]+(0.640838941005)*x[2]**o+(0.600082339571)*x[2]
        s[2,4,1,0]=(-0.893508919799)*x[0]**o+(0.277903035098)*x[0]+(-0.10177580179)*x[1]**o+(0.404076458963)*x[1]+(0.497606493909)*x[2]**o+(0.343868899215)*x[2]
        s[2,4,1,1]=(-0.0277942588293)*x[0]**o+(-0.341120495601)*x[0]+(0.622259478993)*x[1]**o+(0.73519393456)*x[1]+(0.660012187037)*x[2]**o+(0.399368466331)*x[2]
        s[2,4,2,0]=(0.712530777919)*x[0]**o+(0.0672439307577)*x[0]+(0.124381974602)*x[1]**o+(-0.406347903024)*x[1]+(0.0208315631234)*x[2]**o+(-0.791500976149)*x[2]
        s[2,4,2,1]=(0.0858696597238)*x[0]**o+(0.629028381896)*x[0]+(0.795442036928)*x[1]**o+(-0.764623844645)*x[1]+(-0.524125153324)*x[2]**o+(0.974625430391)*x[2]
        s[3,0,0,0]=(-0.124887079943)*x[0]**o+(-0.654604024941)*x[0]+(0.822406023517)*x[1]**o+(-0.429933379615)*x[1]+(-0.693754435109)*x[2]**o+(0.745961675595)*x[2]
        s[3,0,0,1]=(0.0781604618068)*x[0]**o+(0.481187957149)*x[0]+(0.923097062213)*x[1]**o+(0.732993925667)*x[1]+(0.0504012859604)*x[2]**o+(-0.115131599222)*x[2]
        s[3,0,1,0]=(0.822494278919)*x[0]**o+(-0.595704755199)*x[0]+(-0.194581886746)*x[1]**o+(-0.943337806993)*x[1]+(0.147117678978)*x[2]**o+(0.728101168665)*x[2]
        s[3,0,1,1]=(-0.61666199289)*x[0]**o+(-0.311296394607)*x[0]+(0.0936521091279)*x[1]**o+(0.588466331236)*x[1]+(-0.878463665908)*x[2]**o+(-0.675819143473)*x[2]
        s[3,0,2,0]=(-0.275356624889)*x[0]**o+(0.383489643489)*x[0]+(0.738708963797)*x[1]**o+(0.974422154657)*x[1]+(-0.580144378752)*x[2]**o+(-0.398505112717)*x[2]
        s[3,0,2,1]=(0.17925744427)*x[0]**o+(-0.681535969307)*x[0]+(0.902860156428)*x[1]**o+(0.871645168608)*x[1]+(-0.500401958703)*x[2]**o+(-0.817977653599)*x[2]
        s[3,1,0,0]=(0.524297360691)*x[0]**o+(0.984668939309)*x[0]+(-0.929867000718)*x[1]**o+(0.270757914061)*x[1]+(-0.259503975648)*x[2]**o+(-0.780346807445)*x[2]
        s[3,1,0,1]=(-0.261808400698)*x[0]**o+(0.0194613328439)*x[0]+(-0.113405534134)*x[1]**o+(0.734179483403)*x[1]+(0.802102544514)*x[2]**o+(0.565610343674)*x[2]
        s[3,1,1,0]=(0.134876119034)*x[0]**o+(0.431559636814)*x[0]+(0.420152427242)*x[1]**o+(-0.882232674232)*x[1]+(0.267000935164)*x[2]**o+(-0.827008708436)*x[2]
        s[3,1,1,1]=(-0.987212349574)*x[0]**o+(-0.342415633625)*x[0]+(0.639912484673)*x[1]**o+(0.790670494677)*x[1]+(0.15123106124)*x[2]**o+(0.983458455307)*x[2]
        s[3,1,2,0]=(0.742204537127)*x[0]**o+(0.886895993942)*x[0]+(-0.349125661787)*x[1]**o+(-0.626136843474)*x[1]+(0.847031359985)*x[2]**o+(0.802788970865)*x[2]
        s[3,1,2,1]=(-0.235349061749)*x[0]**o+(-0.621187306924)*x[0]+(0.552218669219)*x[1]**o+(0.790729433037)*x[1]+(0.444333479788)*x[2]**o+(0.632032201563)*x[2]
        s[3,2,0,0]=(-0.938490786208)*x[0]**o+(0.869095707989)*x[0]+(0.140982256523)*x[1]**o+(-0.878601697433)*x[1]+(0.184535860313)*x[2]**o+(0.719071828514)*x[2]
        s[3,2,0,1]=(-0.0180578829991)*x[0]**o+(0.0463975318478)*x[0]+(0.00393591018992)*x[1]**o+(0.950931246975)*x[1]+(0.615063351086)*x[2]**o+(-0.258806804322)*x[2]
        s[3,2,1,0]=(0.294998689081)*x[0]**o+(-0.625359797867)*x[0]+(-0.403789197497)*x[1]**o+(-0.999420678246)*x[1]+(0.719776724665)*x[2]**o+(0.66899881431)*x[2]
        s[3,2,1,1]=(-0.722157328967)*x[0]**o+(0.299062154378)*x[0]+(0.598625708687)*x[1]**o+(-0.951467257263)*x[1]+(0.344507050433)*x[2]**o+(0.0139170273087)*x[2]
        s[3,2,2,0]=(0.621065266638)*x[0]**o+(0.985212075414)*x[0]+(-0.698645841337)*x[1]**o+(0.660676253875)*x[1]+(-0.406319768107)*x[2]**o+(-0.307469107008)*x[2]
        s[3,2,2,1]=(0.0383194307525)*x[0]**o+(0.979670738016)*x[0]+(-0.928710294194)*x[1]**o+(0.610840841234)*x[1]+(0.707435385876)*x[2]**o+(-0.243157095062)*x[2]
        s[3,3,0,0]=(0.0357627225956)*x[0]**o+(0.708815172231)*x[0]+(0.065359531343)*x[1]**o+(-0.0182577227471)*x[1]+(-0.0210976208306)*x[2]**o+(0.0761117140757)*x[2]
        s[3,3,0,1]=(0.748296379412)*x[0]**o+(-0.807953754409)*x[0]+(-0.545605437765)*x[1]**o+(0.23683862911)*x[1]+(0.173607048395)*x[2]**o+(-0.44250075226)*x[2]
        s[3,3,1,0]=(-0.726945541384)*x[0]**o+(0.426848422718)*x[0]+(-0.92314597997)*x[1]**o+(0.648637342846)*x[1]+(-0.578392786152)*x[2]**o+(0.848674260689)*x[2]
        s[3,3,1,1]=(-0.644752429929)*x[0]**o+(0.950947546555)*x[0]+(0.0149417119272)*x[1]**o+(0.716391605858)*x[1]+(0.0490453676731)*x[2]**o+(0.0576413425128)*x[2]
        s[3,3,2,0]=(0.466006820631)*x[0]**o+(0.161941404819)*x[0]+(-0.957641267925)*x[1]**o+(0.0765544212389)*x[1]+(0.701408110369)*x[2]**o+(-0.657156965052)*x[2]
        s[3,3,2,1]=(-0.867176738598)*x[0]**o+(-0.449219272229)*x[0]+(0.324298582458)*x[1]**o+(-0.998730968715)*x[1]+(0.574803005179)*x[2]**o+(-0.243281577204)*x[2]
        s[3,4,0,0]=(-0.263021668111)*x[0]**o+(0.802820216492)*x[0]+(0.372317055664)*x[1]**o+(-0.907203003358)*x[1]+(-0.0875142912227)*x[2]**o+(-0.899457536279)*x[2]
        s[3,4,0,1]=(0.223529185934)*x[0]**o+(-0.112858652745)*x[0]+(0.112751409232)*x[1]**o+(-0.383168214822)*x[1]+(0.0253282930677)*x[2]**o+(-0.0727000650191)*x[2]
        s[3,4,1,0]=(0.402273303095)*x[0]**o+(0.577572690365)*x[0]+(0.157976741538)*x[1]**o+(-0.374155092812)*x[1]+(-0.899398318425)*x[2]**o+(0.56916282818)*x[2]
        s[3,4,1,1]=(-0.565673417227)*x[0]**o+(-0.0157754170468)*x[0]+(-0.896925597573)*x[1]**o+(-0.968592388923)*x[1]+(-0.694486144109)*x[2]**o+(-0.795948130804)*x[2]
        s[3,4,2,0]=(-0.962992173758)*x[0]**o+(-0.299086071473)*x[0]+(0.367929277599)*x[1]**o+(-0.139102532943)*x[1]+(-0.838141685104)*x[2]**o+(0.181200376172)*x[2]
        s[3,4,2,1]=(0.610198649476)*x[0]**o+(-0.747032724663)*x[0]+(0.546335594194)*x[1]**o+(0.21236923042)*x[1]+(0.028021042999)*x[2]**o+(0.469015322864)*x[2]
        ref[0,0,0,0]=(-1.03505909819)/(o+1.)+(-0.0424682351702)+(-0.284157309093)*0.5**o
        ref[0,0,0,1]=(1.20050545262)/(o+1.)+(0.182893096798)+(-0.315769534489)*0.5**o
        ref[0,0,1,0]=(1.18191621585)/(o+1.)+(-0.399132238132)+(-0.4535776613)*0.5**o
        ref[0,0,1,1]=(-1.34097322417)/(o+1.)+(1.00115578994)+(-0.739956684686)*0.5**o
        ref[0,0,2,0]=(0.374251042378)/(o+1.)+(0.33923574855)+(0.630514031324)*0.5**o
        ref[0,0,2,1]=(0.781947977225)/(o+1.)+(-0.0848585871226)+(-0.763048729267)*0.5**o
        ref[0,1,0,0]=(1.60214777624)/(o+1.)+(0.568449742282)+(-0.438048883736)*0.5**o
        ref[0,1,0,1]=(-1.24420506553)/(o+1.)+(-0.0158819624619)+(0.169577859304)*0.5**o
        ref[0,1,1,0]=(-1.7324128314)/(o+1.)+(-0.0971954419402)+(-0.136877583438)*0.5**o
        ref[0,1,1,1]=(0.983260153455)/(o+1.)+(-0.433646513272)+(0.21329287668)*0.5**o
        ref[0,1,2,0]=(-1.03510150258)/(o+1.)+(-0.706705011055)+(-0.488721257593)*0.5**o
        ref[0,1,2,1]=(-0.218470519691)/(o+1.)+(0.319591579745)+(0.0407718763863)*0.5**o
        ref[0,2,0,0]=(0.625311774166)/(o+1.)+(0.0218405294219)+(0.587345517354)*0.5**o
        ref[0,2,0,1]=(0.876141884916)/(o+1.)+(-0.356201888016)+(-0.811084805765)*0.5**o
        ref[0,2,1,0]=(-0.687154150232)/(o+1.)+(0.77098577072)+(-0.222984108172)*0.5**o
        ref[0,2,1,1]=(0.783862950926)/(o+1.)+(0.88949992906)+(-0.351616621125)*0.5**o
        ref[0,2,2,0]=(1.03032469103)/(o+1.)+(-0.727535078248)+(0.326986640454)*0.5**o
        ref[0,2,2,1]=(-0.852371311009)/(o+1.)+(-0.181270485818)+(0.416408828986)*0.5**o
        ref[0,3,0,0]=(1.41111824503)/(o+1.)+(1.07119295236)+(0.165546039968)*0.5**o
        ref[0,3,0,1]=(-1.83184805832)/(o+1.)+(-0.517194924063)+(0.806943353866)*0.5**o
        ref[0,3,1,0]=(-1.13181236513)/(o+1.)+(-1.02397128909)+(-0.0329058672137)*0.5**o
        ref[0,3,1,1]=(0.304318369001)/(o+1.)+(0.00956600470204)+(0.927391314677)*0.5**o
        ref[0,3,2,0]=(0.501178198552)/(o+1.)+(0.0124567541342)+(-0.395900087683)*0.5**o
        ref[0,3,2,1]=(-1.4656997814)/(o+1.)+(-0.817947532691)+(0.167004592732)*0.5**o
        ref[0,4,0,0]=(-0.535116000151)/(o+1.)+(0.813669724142)+(-0.0559473269152)*0.5**o
        ref[0,4,0,1]=(-0.386064621699)/(o+1.)+(0.506465703971)+(-0.126102715426)*0.5**o
        ref[0,4,1,0]=(0.235769960904)/(o+1.)+(0.507444715073)+(-0.465158745622)*0.5**o
        ref[0,4,1,1]=(-1.25358393189)/(o+1.)+(0.745413177378)+(0.433494572203)*0.5**o
        ref[0,4,2,0]=(0.3766047946)/(o+1.)+(0.730562643948)+(-0.226388318689)*0.5**o
        ref[0,4,2,1]=(-0.868789668733)/(o+1.)+(-0.633013988131)+(-0.487005215247)*0.5**o
        ref[1,0,0,0]=(0.315996038899)/(o+1.)+(0.895638925406)+(-0.599811357812)*0.5**o
        ref[1,0,0,1]=(-1.84265003124)/(o+1.)+(0.240532908971)+(-0.849384033331)*0.5**o
        ref[1,0,1,0]=(-0.0941474741887)/(o+1.)+(0.65200760392)+(0.560384598535)*0.5**o
        ref[1,0,1,1]=(1.09577916824)/(o+1.)+(0.164260614444)+(0.394452679675)*0.5**o
        ref[1,0,2,0]=(-0.218722993542)/(o+1.)+(-0.562676967744)+(-0.286588291759)*0.5**o
        ref[1,0,2,1]=(0.351571050868)/(o+1.)+(0.535346830254)+(0.587814763664)*0.5**o
        ref[1,1,0,0]=(-0.981246651633)/(o+1.)+(0.993103291818)+(-0.0104862086098)*0.5**o
        ref[1,1,0,1]=(-0.0223701310738)/(o+1.)+(-0.479372400756)+(-0.442153331955)*0.5**o
        ref[1,1,1,0]=(0.166993904921)/(o+1.)+(-0.0804361294934)+(0.143778546111)*0.5**o
        ref[1,1,1,1]=(-0.454722153421)/(o+1.)+(-0.967597910545)+(0.830078999256)*0.5**o
        ref[1,1,2,0]=(-0.280227426918)/(o+1.)+(-0.399959394644)+(-0.818875997493)*0.5**o
        ref[1,1,2,1]=(-1.44539571982)/(o+1.)+(-0.172660106102)+(0.897735820104)*0.5**o
        ref[1,2,0,0]=(0.229059680434)/(o+1.)+(-0.279586461518)+(-0.225661260024)*0.5**o
        ref[1,2,0,1]=(-0.11531008643)/(o+1.)+(-0.725215085638)+(0.188146461111)*0.5**o
        ref[1,2,1,0]=(-1.07473772287)/(o+1.)+(-1.10205837886)+(-0.713236970029)*0.5**o
        ref[1,2,1,1]=(-0.00752571015035)/(o+1.)+(-0.793755980616)+(0.338343830055)*0.5**o
        ref[1,2,2,0]=(-1.55472679711)/(o+1.)+(-0.771580156139)+(-0.857754750211)*0.5**o
        ref[1,2,2,1]=(-1.41530903614)/(o+1.)+(0.478834879863)+(0.798299933694)*0.5**o
        ref[1,3,0,0]=(-0.605589351334)/(o+1.)+(-0.213211988214)+(-0.22936580714)*0.5**o
        ref[1,3,0,1]=(-1.20312374453)/(o+1.)+(-0.988626008968)+(0.272143747738)*0.5**o
        ref[1,3,1,0]=(1.30870990435)/(o+1.)+(0.246218656117)+(-0.371813536068)*0.5**o
        ref[1,3,1,1]=(-0.148337279237)/(o+1.)+(0.566337073785)+(0.64355520606)*0.5**o
        ref[1,3,2,0]=(-0.91862824326)/(o+1.)+(-0.0175057723384)+(0.296777344281)*0.5**o
        ref[1,3,2,1]=(-1.37550450457)/(o+1.)+(-0.0120519795955)+(-0.631360619387)*0.5**o
        ref[1,4,0,0]=(-1.03348697399)/(o+1.)+(0.245505236923)+(-0.864162318969)*0.5**o
        ref[1,4,0,1]=(0.226279058508)/(o+1.)+(-0.279695235305)+(-0.0204110610831)*0.5**o
        ref[1,4,1,0]=(0.129273063512)/(o+1.)+(-0.558900295355)+(-0.0714182037356)*0.5**o
        ref[1,4,1,1]=(1.18088147769)/(o+1.)+(-0.916662811143)+(-0.789159638733)*0.5**o
        ref[1,4,2,0]=(0.464292100303)/(o+1.)+(0.0165108463129)+(-0.545542033256)*0.5**o
        ref[1,4,2,1]=(-0.736810350419)/(o+1.)+(-0.660665077748)+(0.655205311592)*0.5**o
        ref[2,0,0,0]=(0.417694152388)/(o+1.)+(-0.0905431379759)+(-0.0509015638697)*0.5**o
        ref[2,0,0,1]=(1.05615351466)/(o+1.)+(0.169735047875)+(-0.834927535726)*0.5**o
        ref[2,0,1,0]=(1.20949251256)/(o+1.)+(0.385393862823)+(0.695941957197)*0.5**o
        ref[2,0,1,1]=(0.924336787014)/(o+1.)+(0.655869253281)+(-0.813515499086)*0.5**o
        ref[2,0,2,0]=(-0.422504632433)/(o+1.)+(-0.398651551024)+(0.264441597574)*0.5**o
        ref[2,0,2,1]=(-0.789880335569)/(o+1.)+(-0.25109601857)+(0.839834410476)*0.5**o
        ref[2,1,0,0]=(-1.0730244215)/(o+1.)+(-0.0877673397313)+(-0.9032683394)*0.5**o
        ref[2,1,0,1]=(-0.110167460347)/(o+1.)+(0.319530276689)+(-0.563127063275)*0.5**o
        ref[2,1,1,0]=(-0.458971665492)/(o+1.)+(0.0755559728958)+(-0.0215129450025)*0.5**o
        ref[2,1,1,1]=(0.920845617782)/(o+1.)+(0.357447932409)+(0.862938112821)*0.5**o
        ref[2,1,2,0]=(-0.0571398560888)/(o+1.)+(-0.185049111973)+(-0.151555342557)*0.5**o
        ref[2,1,2,1]=(0.636402668026)/(o+1.)+(-0.703521938239)+(0.485262168703)*0.5**o
        ref[2,2,0,0]=(0.107271092594)/(o+1.)+(0.0850978751753)+(0.597629111376)*0.5**o
        ref[2,2,0,1]=(-0.339656097563)/(o+1.)+(0.57534630574)+(0.0885418745402)*0.5**o
        ref[2,2,1,0]=(-0.238561968668)/(o+1.)+(0.115193935875)+(-0.7058457718)*0.5**o
        ref[2,2,1,1]=(0.668608005739)/(o+1.)+(0.659289028954)+(0.431391331275)*0.5**o
        ref[2,2,2,0]=(-0.672876883281)/(o+1.)+(-0.21881291977)+(-0.172742409612)*0.5**o
        ref[2,2,2,1]=(0.83970372368)/(o+1.)+(-0.992038068194)+(0.193762571076)*0.5**o
        ref[2,3,0,0]=(-1.68484871783)/(o+1.)+(0.780118908189)+(-0.816708755757)*0.5**o
        ref[2,3,0,1]=(1.18011814676)/(o+1.)+(-0.217769718186)+(0.557205351559)*0.5**o
        ref[2,3,1,0]=(-1.08023458875)/(o+1.)+(0.453977422158)+(-0.330158214652)*0.5**o
        ref[2,3,1,1]=(-1.05348964937)/(o+1.)+(0.0166509774407)+(0.0113498976079)*0.5**o
        ref[2,3,2,0]=(0.575130860462)/(o+1.)+(0.832540416184)+(0.548708545741)*0.5**o
        ref[2,3,2,1]=(0.836108525756)/(o+1.)+(0.127941230937)+(0.367699563724)*0.5**o
        ref[2,4,0,0]=(-1.10708293282)/(o+1.)+(-0.0897956041276)+(0.742185577055)*0.5**o
        ref[2,4,0,1]=(0.16336599513)/(o+1.)+(0.943309725321)+(-0.540606064885)*0.5**o
        ref[2,4,1,0]=(0.395830692119)/(o+1.)+(0.512924196638)+(-0.893508919799)*0.5**o
        ref[2,4,1,1]=(1.28227166603)/(o+1.)+(0.396720952645)+(-0.0277942588293)*0.5**o
        ref[2,4,2,0]=(0.145213537726)/(o+1.)+(-0.565302474208)+(0.712530777919)*0.5**o
        ref[2,4,2,1]=(0.271316883603)/(o+1.)+(0.419514983821)+(0.0858696597238)*0.5**o
        ref[3,0,0,0]=(0.128651588408)/(o+1.)+(-0.16928786448)+(-0.124887079943)*0.5**o
        ref[3,0,0,1]=(0.973498348173)/(o+1.)+(0.549525141797)+(0.0781604618068)*0.5**o
        ref[3,0,1,0]=(-0.0474642077688)/(o+1.)+(-0.405470696764)+(0.822494278919)*0.5**o
        ref[3,0,1,1]=(-0.78481155678)/(o+1.)+(-0.199324603422)+(-0.61666199289)*0.5**o
        ref[3,0,2,0]=(0.158564585045)/(o+1.)+(0.479703342715)+(-0.275356624889)*0.5**o
        ref[3,0,2,1]=(0.402458197725)/(o+1.)+(-0.313934227149)+(0.17925744427)*0.5**o
        ref[3,1,0,0]=(-1.18937097637)/(o+1.)+(0.237540022962)+(0.524297360691)*0.5**o
        ref[3,1,0,1]=(0.68869701038)/(o+1.)+(0.65962557996)+(-0.261808400698)*0.5**o
        ref[3,1,1,0]=(0.687153362406)/(o+1.)+(-0.638840872927)+(0.134876119034)*0.5**o
        ref[3,1,1,1]=(0.791143545912)/(o+1.)+(0.71585665818)+(-0.987212349574)*0.5**o
        ref[3,1,2,0]=(0.497905698197)/(o+1.)+(0.531774060666)+(0.742204537127)*0.5**o
        ref[3,1,2,1]=(0.996552149008)/(o+1.)+(0.400787163838)+(-0.235349061749)*0.5**o
        ref[3,2,0,0]=(0.325518116836)/(o+1.)+(0.354782919535)+(-0.938490786208)*0.5**o
        ref[3,2,0,1]=(0.618999261276)/(o+1.)+(0.369260987251)+(-0.0180578829991)*0.5**o
        ref[3,2,1,0]=(0.315987527168)/(o+1.)+(-0.477890830901)+(0.294998689081)*0.5**o
        ref[3,2,1,1]=(0.94313275912)/(o+1.)+(-0.319244037788)+(-0.722157328967)*0.5**o
        ref[3,2,2,0]=(-1.10496560944)/(o+1.)+(0.669209611141)+(0.621065266638)*0.5**o
        ref[3,2,2,1]=(-0.221274908319)/(o+1.)+(0.673677242094)+(0.0383194307525)*0.5**o
        ref[3,3,0,0]=(0.0442619105124)/(o+1.)+(0.38333458178)+(0.0357627225956)*0.5**o
        ref[3,3,0,1]=(-0.371998389371)/(o+1.)+(-0.50680793878)+(0.748296379412)*0.5**o
        ref[3,3,1,0]=(-1.50153876612)/(o+1.)+(0.962080013126)+(-0.726945541384)*0.5**o
        ref[3,3,1,1]=(0.0639870796003)/(o+1.)+(0.862490247463)+(-0.644752429929)*0.5**o
        ref[3,3,2,0]=(-0.256233157556)/(o+1.)+(-0.209330569497)+(0.466006820631)*0.5**o
        ref[3,3,2,1]=(0.899101587637)/(o+1.)+(-0.845615909074)+(-0.867176738598)*0.5**o
        ref[3,4,0,0]=(0.284802764441)/(o+1.)+(-0.501920161572)+(-0.263021668111)*0.5**o
        ref[3,4,0,1]=(0.1380797023)/(o+1.)+(-0.284363466293)+(0.223529185934)*0.5**o
        ref[3,4,1,0]=(-0.741421576887)/(o+1.)+(0.386290212867)+(0.402273303095)*0.5**o
        ref[3,4,1,1]=(-1.59141174168)/(o+1.)+(-0.890157968387)+(-0.565673417227)*0.5**o
        ref[3,4,2,0]=(-0.470212407505)/(o+1.)+(-0.128494114122)+(-0.962992173758)*0.5**o
        ref[3,4,2,1]=(0.574356637193)/(o+1.)+(-0.0328240856895)+(0.610198649476)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(1.70255303494)*x[0]+(0.300011314949)*x[1]
        ref=(0.345983004398)/(o+1.)+(0.363938720886)+(0.928703903719)*0.5**o
      else:
        s=(-1.68260770684)*x[0]+(-1.14729600003)*x[1]+(-1.35659279947)*x[2]
        ref=(-1.3902352024)/(o+1.)+(-1.03788235052)+(-0.720496602901)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(0.23958799559)*x[0]+(-0.0458757682877)*x[1]
        s[1]=(0.0897882061379)*x[0]+(-1.54974909413)*x[1]
        ref[0]=(0.0485704769529)/(o+1.)+(0.210351971249)+(-0.275562192148)*0.5**o
        ref[1]=(-0.821668980438)/(o+1.)+(-0.712207676061)+(0.786123444573)*0.5**o
      else:
        s[0]=(-1.44817804789)*x[0]+(0.670605136525)*x[1]+(-0.593548775192)*x[2]
        s[1]=(-0.585702105721)*x[0]+(0.0665105334471)*x[1]+(-0.228099551666)*x[2]
        ref[0]=(0.859021549917)/(o+1.)+(-0.759857813727)+(-0.710427609023)*0.5**o
        ref[1]=(-1.40806718776)/(o+1.)+(0.267420623854)+(0.125934816108)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.933177344575)*x[0]+(-0.643793974434)*x[1]
        s[0,1]=(-0.311019666872)*x[0]+(0.686195407652)*x[1]
        s[0,2]=(0.470203454822)*x[0]+(1.32374103685)*x[1]
        s[0,3]=(-0.653103411901)*x[0]+(0.477452857192)*x[1]
        s[0,4]=(1.12606394408)*x[0]+(0.0898490519564)*x[1]
        s[1,0]=(1.26644130664)*x[0]+(0.226895598587)*x[1]
        s[1,1]=(0.0271345466814)*x[0]+(0.435024033603)*x[1]
        s[1,2]=(-0.227055843926)*x[0]+(-0.144686134637)*x[1]
        s[1,3]=(0.466198287572)*x[0]+(-0.130830709376)*x[1]
        s[1,4]=(1.04066080781)*x[0]+(0.546282129071)*x[1]
        s[2,0]=(0.317469515041)*x[0]+(1.26366516514)*x[1]
        s[2,1]=(-1.20210768286)*x[0]+(-0.0533328989847)*x[1]
        s[2,2]=(0.278459393186)*x[0]+(-0.379156129627)*x[1]
        s[2,3]=(1.03459096792)*x[0]+(-0.610026027371)*x[1]
        s[2,4]=(1.288131278)*x[0]+(-0.309929698872)*x[1]
        s[3,0]=(0.32856946183)*x[0]+(0.225709965354)*x[1]
        s[3,1]=(-1.03183224237)*x[0]+(-0.0153171719792)*x[1]
        s[3,2]=(0.259516430572)*x[0]+(-0.776082702284)*x[1]
        s[3,3]=(-0.417978040907)*x[0]+(-0.0941785049007)*x[1]
        s[3,4]=(1.07527114074)*x[0]+(-0.0198401110946)*x[1]
        ref[0,0]=(-0.79959835955)/(o+1.)+(0.566758804494)+(-0.0445358792971)*0.5**o
        ref[0,1]=(0.583455543567)/(o+1.)+(0.0458448886173)+(-0.299969580021)*0.5**o
        ref[0,2]=(0.471614825642)/(o+1.)+(0.891760595232)+(-0.461191524434)*0.5**o
        ref[0,3]=(0.672045220068)/(o+1.)+(-0.56343583876)+(0.279175902744)*0.5**o
        ref[0,4]=(-0.127993678518)/(o+1.)+(0.52668612755)+(0.290534419455)*0.5**o
        ref[1,0]=(0.822774751438)/(o+1.)+(-0.011855097694)+(0.694272349175)*0.5**o
        ref[1,1]=(0.552626324952)/(o+1.)+(0.277929562319)+(-0.646326869305)*0.5**o
        ref[1,2]=(-0.565996176797)/(o+1.)+(-0.128057099164)+(0.450368396562)*0.5**o
        ref[1,3]=(0.627837338323)/(o+1.)+(-0.555359040353)+(0.818248320579)*0.5**o
        ref[1,4]=(0.722984603229)/(o+1.)+(0.0957452220354)+(0.672467889583)*0.5**o
        ref[2,0]=(0.664524759547)/(o+1.)+(0.678277833656)+(-0.439945746675)*0.5**o
        ref[2,1]=(0.908213473231)/(o+1.)+(-0.805606306623)+(-0.552441441832)*0.5**o
        ref[2,2]=(0.0908414991316)/(o+1.)+(0.131818510391)+(-0.455175256354)*0.5**o
        ref[2,3]=(-0.119095663088)/(o+1.)+(-0.223144373358)+(0.989949350348)*0.5**o
        ref[2,4]=(-0.0540728359185)/(o+1.)+(0.0748680956845)+(0.882538223681)*0.5**o
        ref[3,0]=(0.98273847633)/(o+1.)+(-0.421621406424)+(0.414783763702)*0.5**o
        ref[3,1]=(0.29285575515)/(o+1.)+(-0.462798732226)+(-0.41440770505)*0.5**o
        ref[3,2]=(-0.509767634157)/(o+1.)+(-0.480617720091)+(0.954436802627)*0.5**o
        ref[3,3]=(-0.762302422898)/(o+1.)+(0.100280539595)+(0.0495847978999)*0.5**o
        ref[3,4]=(-0.154196647936)/(o+1.)+(0.329602137701)+(0.550423402184)*0.5**o
      else:
        s[0,0]=(1.34601675616)*x[0]+(-0.451295005459)*x[1]+(-0.49622174234)*x[2]
        s[0,1]=(-0.327908015969)*x[0]+(-1.21019079469)*x[1]+(1.09622527656)*x[2]
        s[0,2]=(-0.0243507161566)*x[0]+(-0.016230100758)*x[1]+(-1.37311484633)*x[2]
        s[0,3]=(-0.445665346289)*x[0]+(-0.626824621259)*x[1]+(-0.196033254199)*x[2]
        s[0,4]=(-0.819703680211)*x[0]+(1.30953832902)*x[1]+(0.0778023021203)*x[2]
        s[1,0]=(0.219519741099)*x[0]+(-1.47335622754)*x[1]+(0.198662145648)*x[2]
        s[1,1]=(-0.65456993306)*x[0]+(-0.125758153194)*x[1]+(-1.53966098547)*x[2]
        s[1,2]=(-0.112157349953)*x[0]+(-0.459351490445)*x[1]+(1.6889234353)*x[2]
        s[1,3]=(0.102642361518)*x[0]+(1.10412193101)*x[1]+(-0.239843060928)*x[2]
        s[1,4]=(-0.232367456037)*x[0]+(-1.17836662288)*x[1]+(-0.814085860866)*x[2]
        s[2,0]=(-1.00510966212)*x[0]+(1.23960710585)*x[1]+(0.0848958213029)*x[2]
        s[2,1]=(-1.93901641139)*x[0]+(-0.0469703867512)*x[1]+(-0.21201338191)*x[2]
        s[2,2]=(1.42666776379)*x[0]+(1.04000263985)*x[1]+(0.151609334515)*x[2]
        s[2,3]=(-0.297049329338)*x[0]+(-0.103284668913)*x[1]+(-0.110261476034)*x[2]
        s[2,4]=(0.964711394219)*x[0]+(1.28218755108)*x[1]+(-1.2382220868)*x[2]
        s[3,0]=(-0.922061452692)*x[0]+(-1.36593539333)*x[1]+(1.11436583585)*x[2]
        s[3,1]=(0.284590223973)*x[0]+(1.08442017719)*x[1]+(1.5619949376)*x[2]
        s[3,2]=(-0.245207105356)*x[0]+(-1.77865635864)*x[1]+(-0.908570594143)*x[2]
        s[3,3]=(0.426334196419)*x[0]+(-0.501103031142)*x[1]+(0.199762115243)*x[2]
        s[3,4]=(1.33158896071)*x[0]+(0.44737802367)*x[1]+(-0.76095091762)*x[2]
        ref[0,0]=(-0.581088472202)/(o+1.)+(0.287163129514)+(0.405262221535)*0.5**o
        ref[0,1]=(0.695209950176)/(o+1.)+(-0.748195486472)+(0.359307488667)*0.5**o
        ref[0,2]=(0.313650504565)/(o+1.)+(-1.20553227172)+(0.683718375628)*0.5**o
        ref[0,3]=(-0.872265925416)/(o+1.)+(-0.216679466249)+(0.0371016361661)*0.5**o
        ref[0,4]=(1.07552646704)/(o+1.)+(-0.293195846094)+(0.0785021760824)*0.5**o
        ref[1,0]=(-1.22710752208)/(o+1.)+(0.409726431872)+(-0.647519682458)*0.5**o
        ref[1,1]=(-0.940490307845)/(o+1.)+(-0.82083756271)+(0.26217636154)*0.5**o
        ref[1,2]=(1.00054234642)/(o+1.)+(-0.0533842117578)+(0.223640672001)*0.5**o
        ref[1,3]=(0.0595140200914)/(o+1.)+(0.407850368171)+(0.0917064751695)*0.5**o
        ref[1,4]=(-0.50735295069)/(o+1.)+(-1.10564117596)+(0.493815362818)*0.5**o
        ref[2,0]=(0.786394742154)/(o+1.)+(-0.212261329287)+(-0.0424788185539)*0.5**o
        ref[2,1]=(-0.868240537836)/(o+1.)+(-0.186797194849)+(-0.956165252514)*0.5**o
        ref[2,2]=(-0.67113838962)/(o+1.)+(1.26208372573)+(0.765250676321)*0.5**o
        ref[2,3]=(-1.2390712788)/(o+1.)+(0.286327258603)+(0.15582128731)*0.5**o
        ref[2,4]=(-0.00831435188402)/(o+1.)+(0.305363694299)+(0.406263821787)*0.5**o
        ref[3,0]=(-0.123205370838)/(o+1.)+(-0.410740153717)+(-0.228945331902)*0.5**o
        ref[3,1]=(1.39199709306)/(o+1.)+(0.646045427731)+(0.246917390241)*0.5**o
        ref[3,2]=(-1.10740261108)/(o+1.)+(-0.860231147304)+(-0.104569152453)*0.5**o
        ref[3,3]=(-0.506214554892)/(o+1.)+(0.53544681941)+(-0.439685803409)*0.5**o
        ref[3,4]=(0.846470301583)/(o+1.)+(-0.134756583683)+(0.441058932543)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.907789262757)*x[0]+(1.43778352913)*x[1]
        s[0,0,1]=(-0.441541130755)*x[0]+(1.75922038312)*x[1]
        s[0,1,0]=(-0.387854312613)*x[0]+(1.22523701409)*x[1]
        s[0,1,1]=(-1.15521894576)*x[0]+(0.0289558035739)*x[1]
        s[1,0,0]=(-0.640400813271)*x[0]+(-1.69766965873)*x[1]
        s[1,0,1]=(-0.641296842318)*x[0]+(-1.35895483901)*x[1]
        s[1,1,0]=(-0.14735518066)*x[0]+(0.520543405774)*x[1]
        s[1,1,1]=(0.369918186173)*x[0]+(0.209781392053)*x[1]
        s[2,0,0]=(0.677808706359)*x[0]+(0.481042907356)*x[1]
        s[2,0,1]=(-0.661702781276)*x[0]+(1.86193178646)*x[1]
        s[2,1,0]=(0.323230036331)*x[0]+(-1.45705288353)*x[1]
        s[2,1,1]=(1.8644362516)*x[0]+(0.764691070666)*x[1]
        s[3,0,0]=(-1.33103240086)*x[0]+(1.29035953404)*x[1]
        s[3,0,1]=(-0.161074703654)*x[0]+(-0.127322745584)*x[1]
        s[3,1,0]=(-0.359913251027)*x[0]+(-0.0952192793759)*x[1]
        s[3,1,1]=(-0.34519536765)*x[0]+(0.483950473232)*x[1]
        s[4,0,0]=(0.981563058768)*x[0]+(-0.0744642367992)*x[1]
        s[4,0,1]=(-0.45912279344)*x[0]+(0.0011253607226)*x[1]
        s[4,1,0]=(-0.618322333127)*x[0]+(0.199638289627)*x[1]
        s[4,1,1]=(-0.371110449749)*x[0]+(-0.382992800899)*x[1]
        s[5,0,0]=(0.840829543072)*x[0]+(-0.925833368141)*x[1]
        s[5,0,1]=(-0.0348263534937)*x[0]+(0.267324292682)*x[1]
        s[5,1,0]=(0.0785260612832)*x[0]+(1.59479548515)*x[1]
        s[5,1,1]=(-0.203914067868)*x[0]+(1.28202597585)*x[1]
        ref[0,0,0]=(0.898417888273)/(o+1.)+(0.171058001117)+(-0.710539624134)*0.5**o
        ref[0,0,1]=(0.949672663046)/(o+1.)+(0.186488421776)+(-0.00497025423347)*0.5**o
        ref[0,1,0]=(0.434571276181)/(o+1.)+(0.106095788846)+(0.190619847602)*0.5**o
        ref[0,1,1]=(0.337711977059)/(o+1.)+(-0.313335995076)+(-0.837303129097)*0.5**o
        ref[1,0,0]=(-0.757199193222)/(o+1.)+(-0.36300260101)+(-0.854866076761)*0.5**o
        ref[1,0,1]=(-0.767144980208)/(o+1.)+(-0.215422826519)+(-0.802261048082)*0.5**o
        ref[1,1,0]=(-0.13190981045)/(o+1.)+(-0.0320289199048)+(0.569155875375)*0.5**o
        ref[1,1,1]=(0.0466405054813)/(o+1.)+(0.565229924314)+(-0.597400775882)*0.5**o
        ref[2,0,0]=(0.760951384359)/(o+1.)+(0.0600961970572)+(0.277707835242)*0.5**o
        ref[2,0,1]=(0.869894715615)/(o+1.)+(0.631323963868)+(-0.932313638168)*0.5**o
        ref[2,1,0]=(-0.666302256751)/(o+1.)+(-0.510864963778)+(0.554209337103)*0.5**o
        ref[2,1,1]=(0.934304180676)/(o+1.)+(0.350887235523)+(0.993048670542)*0.5**o
        ref[3,0,0]=(0.930749923608)/(o+1.)+(-0.283299908306)+(-0.404822973819)*0.5**o
        ref[3,0,1]=(-0.572270969539)/(o+1.)+(0.583432503768)+(-0.882991487235)*0.5**o
        ref[3,1,0]=(0.642892258995)/(o+1.)+(-0.0826293437351)+(-0.932766101927)*0.5**o
        ref[3,1,1]=(0.679591980627)/(o+1.)+(-0.379930907942)+(0.219024940838)*0.5**o
        ref[4,0,0]=(-0.0326170324069)/(o+1.)+(0.0903259186859)+(0.759064017004)*0.5**o
        ref[4,0,1]=(-0.129142887308)/(o+1.)+(0.279560607285)+(-0.887975759979)*0.5**o
        ref[4,1,0]=(0.752463858901)/(o+1.)+(-0.256945595979)+(-0.657256710443)*0.5**o
        ref[4,1,1]=(0.565307319705)/(o+1.)+(-0.898218881636)+(0.477027192919)*0.5**o
        ref[5,0,0]=(-0.28969980947)/(o+1.)+(0.0341656280661)+(0.136364728269)*0.5**o
        ref[5,0,1]=(-0.362525553087)/(o+1.)+(0.17876968499)+(0.237484122295)*0.5**o
        ref[5,1,0]=(0.856225350097)/(o+1.)+(0.375747136218)+(0.0656019238951)*0.5**o
        ref[5,1,1]=(0.358764765052)/(o+1.)+(0.783470816704)+(-0.847594490479)*0.5**o
      else:
        s[0,0,0]=(-0.18318998999)*x[0]+(-1.71372306128)*x[1]+(1.13788709107)*x[2]
        s[0,0,1]=(0.95308908228)*x[0]+(0.123844162735)*x[1]+(0.0868410957691)*x[2]
        s[0,1,0]=(-0.712762731169)*x[0]+(-1.86018372873)*x[1]+(-0.0783828227128)*x[2]
        s[0,1,1]=(-1.72172214895)*x[0]+(-1.25477573826)*x[1]+(1.28096692374)*x[2]
        s[1,0,0]=(0.86250397119)*x[0]+(1.44314824122)*x[1]+(0.763303582012)*x[2]
        s[1,0,1]=(1.05520701337)*x[0]+(1.04926637639)*x[1]+(-0.378977987156)*x[2]
        s[1,1,0]=(0.753550528625)*x[0]+(-1.63882951308)*x[1]+(0.259583964201)*x[2]
        s[1,1,1]=(0.778941098246)*x[0]+(-1.10564597288)*x[1]+(-1.42906071049)*x[2]
        s[2,0,0]=(-0.842438687373)*x[0]+(-0.202024764935)*x[1]+(0.289144880342)*x[2]
        s[2,0,1]=(-1.02319531994)*x[0]+(0.155875285165)*x[1]+(0.310920357117)*x[2]
        s[2,1,0]=(-1.45156693584)*x[0]+(0.12231441645)*x[1]+(0.722232222435)*x[2]
        s[2,1,1]=(-1.08553719113)*x[0]+(0.316521434206)*x[1]+(0.720555059931)*x[2]
        s[3,0,0]=(1.91846595467)*x[0]+(0.199356393766)*x[1]+(-0.438144879601)*x[2]
        s[3,0,1]=(-0.341123312011)*x[0]+(0.325154462361)*x[1]+(0.691743856063)*x[2]
        s[3,1,0]=(1.72547153856)*x[0]+(-0.822030080649)*x[1]+(-1.15169896539)*x[2]
        s[3,1,1]=(0.243194545088)*x[0]+(-0.718504738836)*x[1]+(0.560536413366)*x[2]
        s[4,0,0]=(0.248455459192)*x[0]+(0.415661600687)*x[1]+(0.21712561395)*x[2]
        s[4,0,1]=(-1.23171610721)*x[0]+(-0.443121697053)*x[1]+(0.724481514081)*x[2]
        s[4,1,0]=(-0.0327531013679)*x[0]+(0.385175130963)*x[1]+(-0.0484020348058)*x[2]
        s[4,1,1]=(-0.199960439132)*x[0]+(-0.751568103399)*x[1]+(-1.20119343449)*x[2]
        s[5,0,0]=(0.853262644583)*x[0]+(1.47653986554)*x[1]+(-0.0642737845052)*x[2]
        s[5,0,1]=(1.1703484139)*x[0]+(-0.848977140408)*x[1]+(-0.303628307573)*x[2]
        s[5,1,0]=(-0.719950626922)*x[0]+(0.192452589234)*x[1]+(0.315963976897)*x[2]
        s[5,1,1]=(0.331604591856)*x[0]+(0.428822102766)*x[1]+(-1.35258251093)*x[2]
        ref[0,0,0]=(-0.452131788567)/(o+1.)+(-0.313943872628)+(0.320993573616)*0.5**o
        ref[0,0,1]=(-1.4121302884)/(o+1.)+(0.934332411096)+(0.707239806995)*0.5**o
        ref[0,1,0]=(-0.371701930519)/(o+1.)+(-1.22914563984)+(0.178663927586)*0.5**o
        ref[0,1,1]=(-0.569427715149)/(o+1.)+(-0.102129307368)+(-0.921844633589)*0.5**o
        ref[1,0,0]=(1.07041067382)/(o+1.)+(1.04773121415)+(-0.0969173076836)*0.5**o
        ref[1,0,1]=(0.344908055221)/(o+1.)+(0.253322966116)+(0.873941415143)*0.5**o
        ref[1,1,0]=(-0.568409920368)/(o+1.)+(-0.376074272994)+(0.694863446104)*0.5**o
        ref[1,1,1]=(-1.26296359103)/(o+1.)+(-0.285972966041)+(0.0791439379881)*0.5**o
        ref[2,0,0]=(0.261580662311)/(o+1.)+(-0.0693472624675)+(-0.878204709343)*0.5**o
        ref[2,0,1]=(-0.0659237231253)/(o+1.)+(-0.101871484642)+(-0.286732985248)*0.5**o
        ref[2,1,0]=(-0.609626668188)/(o+1.)+(0.438552975912)+(-0.874499580587)*0.5**o
        ref[2,1,1]=(1.21427389191)/(o+1.)+(-0.396304653588)+(-0.470125281731)*0.5**o
        ref[3,0,0]=(0.466268456837)/(o+1.)+(0.109894182607)+(0.993620646782)*0.5**o
        ref[3,0,1]=(0.798648502977)/(o+1.)+(0.30293631931)+(-0.728746135183)*0.5**o
        ref[3,1,0]=(-0.443525593788)/(o+1.)+(-0.32762855249)+(0.85052519129)*0.5**o
        ref[3,1,1]=(0.520520221786)/(o+1.)+(-0.21037503556)+(-0.0145439310481)*0.5**o
        ref[4,0,0]=(1.51637897594)/(o+1.)+(0.0251054216628)+(-0.685347145435)*0.5**o
        ref[4,0,1]=(-0.0126278181421)/(o+1.)+(-0.255524438913)+(-0.426679594213)*0.5**o
        ref[4,1,0]=(-0.110252848596)/(o+1.)+(-0.270402535847)+(0.95507791508)*0.5**o
        ref[4,1,1]=(-0.965558516877)/(o+1.)+(-0.777022669388)+(0.366881878633)*0.5**o
        ref[5,0,0]=(1.47489510124)/(o+1.)+(0.344964232978)+(0.100705158424)*0.5**o
        ref[5,0,1]=(0.272180101244)/(o+1.)+(-0.219694112974)+(0.184951090624)*0.5**o
        ref[5,1,0]=(0.868944944511)/(o+1.)+(-0.492651110402)+(-0.0951767844975)*0.5**o
        ref[5,1,1]=(-0.112001801469)/(o+1.)+(-0.0274812221923)+(-0.425191570457)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.492266509376)*x[0]+(-0.374307474367)*x[1]
        s[0,0,0,1]=(0.379610803929)*x[0]+(1.26877290052)*x[1]
        s[0,0,1,0]=(0.489836401727)*x[0]+(0.0568437409848)*x[1]
        s[0,0,1,1]=(-0.0962394811856)*x[0]+(1.08297193296)*x[1]
        s[0,0,2,0]=(0.0083854747638)*x[0]+(1.12783902851)*x[1]
        s[0,0,2,1]=(-1.60969353709)*x[0]+(-1.15342435141)*x[1]
        s[0,1,0,0]=(0.718333685586)*x[0]+(-0.580409068311)*x[1]
        s[0,1,0,1]=(-0.471412983112)*x[0]+(-1.21523638921)*x[1]
        s[0,1,1,0]=(0.436952252413)*x[0]+(0.817968269393)*x[1]
        s[0,1,1,1]=(0.904303325207)*x[0]+(1.27944662005)*x[1]
        s[0,1,2,0]=(-0.646670575219)*x[0]+(-0.268471138891)*x[1]
        s[0,1,2,1]=(0.216944526796)*x[0]+(-1.44656748298)*x[1]
        s[0,2,0,0]=(-1.45710792844)*x[0]+(-1.37549168202)*x[1]
        s[0,2,0,1]=(-0.0209124548614)*x[0]+(-0.405359828227)*x[1]
        s[0,2,1,0]=(0.713696154808)*x[0]+(-0.283663569311)*x[1]
        s[0,2,1,1]=(0.0879024421072)*x[0]+(-1.74270037297)*x[1]
        s[0,2,2,0]=(-0.263019221744)*x[0]+(0.587637432145)*x[1]
        s[0,2,2,1]=(0.291949019915)*x[0]+(1.21942896685)*x[1]
        s[0,3,0,0]=(0.711503988663)*x[0]+(-0.0889987684621)*x[1]
        s[0,3,0,1]=(-0.473200478311)*x[0]+(-0.731689338365)*x[1]
        s[0,3,1,0]=(0.0347877428229)*x[0]+(0.436342776392)*x[1]
        s[0,3,1,1]=(1.33181675729)*x[0]+(0.796826790935)*x[1]
        s[0,3,2,0]=(0.975860401214)*x[0]+(-0.0388876329765)*x[1]
        s[0,3,2,1]=(0.336224987742)*x[0]+(1.40851963434)*x[1]
        s[0,4,0,0]=(-0.430668122172)*x[0]+(-0.210883679811)*x[1]
        s[0,4,0,1]=(-0.0947644917837)*x[0]+(-0.145045406149)*x[1]
        s[0,4,1,0]=(-0.975155718684)*x[0]+(0.370091078964)*x[1]
        s[0,4,1,1]=(1.59897077782)*x[0]+(-0.716757934974)*x[1]
        s[0,4,2,0]=(0.0995595315716)*x[0]+(-0.654667529963)*x[1]
        s[0,4,2,1]=(0.621429995817)*x[0]+(-0.830020781954)*x[1]
        s[1,0,0,0]=(0.460799425849)*x[0]+(1.37039134597)*x[1]
        s[1,0,0,1]=(0.484677718571)*x[0]+(-1.06817334128)*x[1]
        s[1,0,1,0]=(0.157323780788)*x[0]+(-0.816294918051)*x[1]
        s[1,0,1,1]=(0.275640307711)*x[0]+(-1.13585749962)*x[1]
        s[1,0,2,0]=(1.16452950894)*x[0]+(-1.17355094567)*x[1]
        s[1,0,2,1]=(-0.567786612292)*x[0]+(-0.78722481996)*x[1]
        s[1,1,0,0]=(-0.106381006132)*x[0]+(1.35734811758)*x[1]
        s[1,1,0,1]=(0.870362310422)*x[0]+(-0.701894980494)*x[1]
        s[1,1,1,0]=(0.463101808026)*x[0]+(-0.106531628533)*x[1]
        s[1,1,1,1]=(0.34927073998)*x[0]+(0.597282241285)*x[1]
        s[1,1,2,0]=(-1.08705596894)*x[0]+(-0.476312920631)*x[1]
        s[1,1,2,1]=(0.461228158094)*x[0]+(0.553430989166)*x[1]
        s[1,2,0,0]=(-0.565889081597)*x[0]+(0.847674515062)*x[1]
        s[1,2,0,1]=(1.22774040742)*x[0]+(0.532076088807)*x[1]
        s[1,2,1,0]=(-1.35738184718)*x[0]+(-0.010480885754)*x[1]
        s[1,2,1,1]=(0.0609383835609)*x[0]+(0.539183578894)*x[1]
        s[1,2,2,0]=(0.765013210057)*x[0]+(-0.0658319206215)*x[1]
        s[1,2,2,1]=(0.720241379555)*x[0]+(-1.29084845886)*x[1]
        s[1,3,0,0]=(1.37641602996)*x[0]+(-0.713391122816)*x[1]
        s[1,3,0,1]=(0.475350779553)*x[0]+(-0.0146303427199)*x[1]
        s[1,3,1,0]=(-0.498436122956)*x[0]+(0.446982991213)*x[1]
        s[1,3,1,1]=(-0.0198417666776)*x[0]+(-0.0330880581816)*x[1]
        s[1,3,2,0]=(-0.968203407981)*x[0]+(-1.43766997027)*x[1]
        s[1,3,2,1]=(-1.516108898)*x[0]+(0.154669696369)*x[1]
        s[1,4,0,0]=(0.107239334472)*x[0]+(-1.01814801515)*x[1]
        s[1,4,0,1]=(0.490733729058)*x[0]+(1.0617427681)*x[1]
        s[1,4,1,0]=(-0.579990484487)*x[0]+(-0.681146890855)*x[1]
        s[1,4,1,1]=(-0.539291982427)*x[0]+(1.40646560401)*x[1]
        s[1,4,2,0]=(-0.804686819612)*x[0]+(0.617047118706)*x[1]
        s[1,4,2,1]=(-0.913106387219)*x[0]+(-0.35453310971)*x[1]
        s[2,0,0,0]=(1.07945504868)*x[0]+(0.147695653661)*x[1]
        s[2,0,0,1]=(0.0321229519775)*x[0]+(-0.80726917422)*x[1]
        s[2,0,1,0]=(-0.276983245168)*x[0]+(-1.8208105745)*x[1]
        s[2,0,1,1]=(-0.390466636115)*x[0]+(-0.753787382303)*x[1]
        s[2,0,2,0]=(-0.0551239488574)*x[0]+(-0.691793238598)*x[1]
        s[2,0,2,1]=(0.455414076199)*x[0]+(1.19885245354)*x[1]
        s[2,1,0,0]=(-0.774122061304)*x[0]+(1.10934639101)*x[1]
        s[2,1,0,1]=(-1.60749547114)*x[0]+(0.305715741213)*x[1]
        s[2,1,1,0]=(0.0697234437299)*x[0]+(0.542820812428)*x[1]
        s[2,1,1,1]=(1.29397510328)*x[0]+(-0.804845682022)*x[1]
        s[2,1,2,0]=(0.478973101459)*x[0]+(1.07219480882)*x[1]
        s[2,1,2,1]=(-0.897309279985)*x[0]+(1.75363512874)*x[1]
        s[2,2,0,0]=(1.61737724977)*x[0]+(0.161191822716)*x[1]
        s[2,2,0,1]=(0.808798403137)*x[0]+(-0.00926345040032)*x[1]
        s[2,2,1,0]=(-0.903485178097)*x[0]+(-0.36599523945)*x[1]
        s[2,2,1,1]=(0.30686972857)*x[0]+(-1.62803935845)*x[1]
        s[2,2,2,0]=(1.48915760228)*x[0]+(0.579057819566)*x[1]
        s[2,2,2,1]=(-0.540786588929)*x[0]+(-0.402843340661)*x[1]
        s[2,3,0,0]=(0.964227135928)*x[0]+(0.0210110310059)*x[1]
        s[2,3,0,1]=(0.0266958261678)*x[0]+(0.830215139026)*x[1]
        s[2,3,1,0]=(0.930518946289)*x[0]+(0.66745827854)*x[1]
        s[2,3,1,1]=(0.0363390243751)*x[0]+(0.591657283448)*x[1]
        s[2,3,2,0]=(-0.433934955699)*x[0]+(-1.57946754208)*x[1]
        s[2,3,2,1]=(-0.890298505624)*x[0]+(0.623825002267)*x[1]
        s[2,4,0,0]=(0.838929180901)*x[0]+(0.699121739125)*x[1]
        s[2,4,0,1]=(1.3886192544)*x[0]+(-0.232981076843)*x[1]
        s[2,4,1,0]=(-0.566792750082)*x[0]+(-0.631000271451)*x[1]
        s[2,4,1,1]=(-0.989529672577)*x[0]+(0.0943919436553)*x[1]
        s[2,4,2,0]=(-1.85858526639)*x[0]+(0.257423736684)*x[1]
        s[2,4,2,1]=(-1.01848069496)*x[0]+(-1.08574972329)*x[1]
        s[3,0,0,0]=(0.135022656073)*x[0]+(-0.641428277939)*x[1]
        s[3,0,0,1]=(-0.613029646479)*x[0]+(0.158334902417)*x[1]
        s[3,0,1,0]=(-1.01838576339)*x[0]+(-0.788404867889)*x[1]
        s[3,0,1,1]=(0.133395871444)*x[0]+(-0.540018893528)*x[1]
        s[3,0,2,0]=(0.359599806799)*x[0]+(-0.163549980956)*x[1]
        s[3,0,2,1]=(0.537279834479)*x[0]+(1.43219657076)*x[1]
        s[3,1,0,0]=(0.699221501837)*x[0]+(0.58098090756)*x[1]
        s[3,1,0,1]=(-0.264653821282)*x[0]+(-0.297670973468)*x[1]
        s[3,1,1,0]=(-1.14805006965)*x[0]+(0.173713527619)*x[1]
        s[3,1,1,1]=(0.582167066862)*x[0]+(0.224704535757)*x[1]
        s[3,1,2,0]=(-0.013329661508)*x[0]+(0.439567816478)*x[1]
        s[3,1,2,1]=(-0.206657167829)*x[0]+(-0.900945403197)*x[1]
        s[3,2,0,0]=(-1.34123093943)*x[0]+(-0.905024065154)*x[1]
        s[3,2,0,1]=(-0.0677797983484)*x[0]+(0.863260908229)*x[1]
        s[3,2,1,0]=(0.0651406495709)*x[0]+(1.35122911589)*x[1]
        s[3,2,1,1]=(-0.00598531484168)*x[0]+(0.690487120132)*x[1]
        s[3,2,2,0]=(0.748701424535)*x[0]+(-1.0273152862)*x[1]
        s[3,2,2,1]=(-0.239064296585)*x[0]+(-0.213292951531)*x[1]
        s[3,3,0,0]=(-0.620272397992)*x[0]+(1.00106031112)*x[1]
        s[3,3,0,1]=(-0.803133841712)*x[0]+(0.873569080382)*x[1]
        s[3,3,1,0]=(-1.187617412)*x[0]+(0.422664418077)*x[1]
        s[3,3,1,1]=(-1.51637824714)*x[0]+(-1.5177161306)*x[1]
        s[3,3,2,0]=(1.41348390435)*x[0]+(1.2134182272)*x[1]
        s[3,3,2,1]=(0.99094246846)*x[0]+(0.34796551642)*x[1]
        s[3,4,0,0]=(0.580352675436)*x[0]+(-1.21782952097)*x[1]
        s[3,4,0,1]=(0.060030794007)*x[0]+(0.711473074059)*x[1]
        s[3,4,1,0]=(0.966745511848)*x[0]+(-0.550401614505)*x[1]
        s[3,4,1,1]=(-0.791329990237)*x[0]+(-0.205150506961)*x[1]
        s[3,4,2,0]=(0.482041855799)*x[0]+(-1.09392636319)*x[1]
        s[3,4,2,1]=(-0.698074703295)*x[0]+(0.510339675206)*x[1]
        ref[0,0,0,0]=(-0.953900694954)/(o+1.)+(0.442044844728)+(0.187770040507)*0.5**o
        ref[0,0,0,1]=(0.580869130103)/(o+1.)+(0.516362992147)+(0.03478859005)*0.5**o
        ref[0,0,1,0]=(-0.411645490601)/(o+1.)+(0.406943479905)+(0.144438673502)*0.5**o
        ref[0,0,1,1]=(0.204312991686)/(o+1.)+(0.383971959467)+(0.0144755411578)*0.5**o
        ref[0,0,2,0]=(0.743369450952)/(o+1.)+(0.0895404122051)+(0.213774227914)*0.5**o
        ref[0,0,2,1]=(-0.239858711457)/(o+1.)+(-0.809763839108)+(-0.903731498821)*0.5**o
        ref[0,1,0,0]=(-0.484413922256)/(o+1.)+(0.0508933433825)+(0.520551852766)*0.5**o
        ref[0,1,0,1]=(-0.590736935429)/(o+1.)+(-0.344843181585)+(-0.406226073725)*0.5**o
        ref[0,1,1,0]=(-0.125338697971)/(o+1.)+(0.369801286198)+(0.640656647382)*0.5**o
        ref[0,1,1,1]=(0.552504077477)/(o+1.)+(0.788979766736)+(0.0532863343083)*0.5**o
        ref[0,1,2,0]=(0.306194481363)/(o+1.)+(-0.445453307231)+(-0.33042958101)*0.5**o
        ref[0,1,2,1]=(-0.818898129415)/(o+1.)+(-0.0332482175532)+(-0.34422839166)*0.5**o
        ref[0,2,0,0]=(-0.878218012751)/(o+1.)+(-0.612244128212)+(-0.729893341289)*0.5**o
        ref[0,2,0,1]=(-0.105155854997)/(o+1.)+(0.281922249648)+(-0.884960927387)*0.5**o
        ref[0,2,1,0]=(0.565149481722)/(o+1.)+(0.0625165001878)+(-0.2601498966)*0.5**o
        ref[0,2,1,1]=(-0.983424704841)/(o+1.)+(0.0730690344226)+(-0.817511294863)*0.5**o
        ref[0,2,2,0]=(-0.258286255412)/(o+1.)+(0.308348049886)+(-0.0337916339596)*0.5**o
        ref[0,2,2,1]=(0.915004878119)/(o+1.)+(-0.166545843752)+(0.929464796149)*0.5**o
        ref[0,3,0,0]=(-0.433529018481)/(o+1.)+(0.627958762155)+(-0.199883285628)*0.5**o
        ref[0,3,0,1]=(-0.945419963966)/(o+1.)+(-0.336318858392)+(0.413167864075)*0.5**o
        ref[0,3,1,0]=(0.502119767083)/(o+1.)+(0.334993773063)+(-0.700976793994)*0.5**o
        ref[0,3,1,1]=(-0.186129206617)/(o+1.)+(0.891324041438)+(0.532124671966)*0.5**o
        ref[0,3,2,0]=(0.504051134603)/(o+1.)+(-0.200874672613)+(0.834670978862)*0.5**o
        ref[0,3,2,1]=(0.436498536789)/(o+1.)+(0.545640525497)+(0.216965034296)*0.5**o
        ref[0,4,0,0]=(-0.756349034292)/(o+1.)+(0.140738322652)+(-0.166679412995)*0.5**o
        ref[0,4,0,1]=(0.780437446749)/(o+1.)+(-0.599105577138)+(0.177963809594)*0.5**o
        ref[0,4,1,0]=(0.943566244729)/(o+1.)+(-0.441716458606)+(-0.665197967238)*0.5**o
        ref[0,4,1,1]=(-0.734101358227)/(o+1.)+(0.356355202125)+(0.903603796827)*0.5**o
        ref[0,4,2,0]=(-0.43430093723)/(o+1.)+(0.383496742595)+(-0.887800546351)*0.5**o
        ref[0,4,2,1]=(-0.227167732111)/(o+1.)+(-0.274598730532)+(0.567774407038)*0.5**o
        ref[1,0,0,0]=(0.391393429129)/(o+1.)+(0.353444577314)+(0.732908188056)*0.5**o
        ref[1,0,0,1]=(-0.171565730455)/(o+1.)+(-0.259205209862)+(0.106480527466)*0.5**o
        ref[1,0,1,0]=(-0.774601901321)/(o+1.)+(0.259483708314)+(-0.403336652569)*0.5**o
        ref[1,0,1,1]=(-0.726406904963)/(o+1.)+(-0.129278181762)+(0.124746076574)*0.5**o
        ref[1,0,2,0]=(-0.617577515377)/(o+1.)+(-0.152390726783)+(0.91333753221)*0.5**o
        ref[1,0,2,1]=(0.138202581628)/(o+1.)+(-0.396089249037)+(-0.701035515806)*0.5**o
        ref[1,1,0,0]=(0.729934336346)/(o+1.)+(-0.00268233232676)+(0.52639743976)*0.5**o
        ref[1,1,0,1]=(-0.158306695958)/(o+1.)+(-0.0162211686892)+(0.359216363265)*0.5**o
        ref[1,1,1,0]=(-0.978599129855)/(o+1.)+(0.71609215355)+(-0.0970149977525)*0.5**o
        ref[1,1,1,1]=(-0.349041967673)/(o+1.)+(0.780124912357)+(-0.264654875775)*0.5**o
        ref[1,1,2,0]=(-0.809194404709)/(o+1.)+(-0.268116096378)+(-0.217942292102)*0.5**o
        ref[1,1,2,1]=(0.455578593899)/(o+1.)+(0.428430852179)+(-0.297781150997)*0.5**o
        ref[1,2,0,0]=(0.116383337262)/(o+1.)+(0.228068268367)+(-0.290734440531)*0.5**o
        ref[1,2,0,1]=(0.977031820054)/(o+1.)+(0.137033678728)+(0.508717318715)*0.5**o
        ref[1,2,1,0]=(0.282937416713)/(o+1.)+(-0.615158071804)+(-0.420484006037)*0.5**o
        ref[1,2,1,1]=(0.904627062081)/(o+1.)+(0.018901292084)+(-0.342307683794)*0.5**o
        ref[1,2,2,0]=(0.755780696034)/(o+1.)+(-0.0362605587438)+(0.0159217108891)*0.5**o
        ref[1,2,2,1]=(-0.699866517547)/(o+1.)+(0.171062073116)+(-0.212864707989)*0.5**o
        ref[1,3,0,0]=(0.228867465112)/(o+1.)+(-0.0322172708178)+(0.498591983668)*0.5**o
        ref[1,3,0,1]=(-0.289542634768)/(o+1.)+(0.110436622855)+(0.529389825891)*0.5**o
        ref[1,3,1,0]=(0.358054041082)/(o+1.)+(0.165615637362)+(-0.74073844755)*0.5**o
        ref[1,3,1,1]=(-0.60359826352)/(o+1.)+(0.517588005735)+(-0.48450757281)*0.5**o
        ref[1,3,2,0]=(-0.545672858809)/(o+1.)+(-0.618462721543)+(-0.623275076358)*0.5**o
        ref[1,3,2,1]=(-0.73428128984)/(o+1.)+(-0.0497647291554)+(-0.527628453484)*0.5**o
        ref[1,4,0,0]=(-0.04306414004)/(o+1.)+(-0.298207200434)+(-0.271430139773)*0.5**o
        ref[1,4,0,1]=(0.971916388567)/(o+1.)+(-0.0691551012311)+(0.718870311054)*0.5**o
        ref[1,4,1,0]=(-0.445510592605)/(o+1.)+(-0.088724728164)+(-0.638177326409)*0.5**o
        ref[1,4,1,1]=(0.753412648385)/(o+1.)+(-0.0777097810015)+(0.269180535197)*0.5**o
        ref[1,4,2,0]=(-0.305234413894)/(o+1.)+(0.169600008291)+(-0.221605303593)*0.5**o
        ref[1,4,2,1]=(-0.286993085073)/(o+1.)+(-0.0493395569951)+(-0.881967297866)*0.5**o
        ref[2,0,0,0]=(-0.719751624491)/(o+1.)+(0.677226475278)+(0.59244937628)*0.5**o
        ref[2,0,0,1]=(-0.670829954915)/(o+1.)+(-0.139434936863)+(0.174553606398)*0.5**o
        ref[2,0,1,0]=(-0.916962595573)/(o+1.)+(-0.372659474123)+(-0.435512275853)*0.5**o
        ref[2,0,1,1]=(-0.893849803211)/(o+1.)+(-0.341833589876)+(0.433262964544)*0.5**o
        ref[2,0,2,0]=(-0.773257190107)/(o+1.)+(0.0495078796887)+(-0.0726757567263)*0.5**o
        ref[2,0,2,1]=(0.632070005323)/(o+1.)+(0.697198313452)+(-0.372200102483)*0.5**o
        ref[2,1,0,0]=(0.459329022417)/(o+1.)+(0.249194755087)+(-0.622494202881)*0.5**o
        ref[2,1,0,1]=(0.0269909119644)/(o+1.)+(-0.210708025265)+(-0.907354591365)*0.5**o
        ref[2,1,1,0]=(0.183761641828)/(o+1.)+(-0.207261190919)+(0.843304996169)*0.5**o
        ref[2,1,1,1]=(-0.49062931094)/(o+1.)+(0.2742786733)+(0.431201385598)*0.5**o
        ref[2,1,2,0]=(0.798332846753)/(o+1.)+(0.187074177535)+(0.378686708458)*0.5**o
        ref[2,1,2,1]=(0.942487410042)/(o+1.)+(0.0268513037692)+(-0.139864168826)*0.5**o
        ref[2,2,0,0]=(-0.306480663139)/(o+1.)+(0.706708669675)+(0.671632396277)*0.5**o
        ref[2,2,0,1]=(-0.68426521806)/(o+1.)+(0.658766824582)+(0.166266521632)*0.5**o
        ref[2,2,1,0]=(-0.0872551950734)/(o+1.)+(-0.212578991849)+(-0.757067238775)*0.5**o
        ref[2,2,1,1]=(-0.779515023363)/(o+1.)+(-0.165651803902)+(-0.210350998718)*0.5**o
        ref[2,2,2,0]=(0.420662034868)/(o+1.)+(0.456572874952)+(0.734407637073)*0.5**o
        ref[2,2,2,1]=(-0.0347308970891)/(o+1.)+(-0.550927478137)+(0.192955923773)*0.5**o
        ref[2,3,0,0]=(0.279479543192)/(o+1.)+(0.340981994922)+(0.0237946338994)*0.5**o
        ref[2,3,0,1]=(0.885111721906)/(o+1.)+(0.0386593998513)+(-0.105519556415)*0.5**o
        ref[2,3,1,0]=(-0.142745975965)/(o+1.)+(0.571228905184)+(0.598265390426)*0.5**o
        ref[2,3,1,1]=(0.676813945202)/(o+1.)+(0.301993597369)+(-0.652804832118)*0.5**o
        ref[2,3,2,0]=(-0.834072218834)/(o+1.)+(-0.836092513405)+(0.492854747868)*0.5**o
        ref[2,3,2,1]=(0.451195972296)/(o+1.)+(-0.330911551268)+(-0.0558463731179)*0.5**o
        ref[2,4,0,0]=(0.604480974758)/(o+1.)+(-0.0272834841321)+(0.988136913533)*0.5**o
        ref[2,4,0,1]=(-0.672293493189)/(o+1.)+(0.436472725256)+(0.954986220232)*0.5**o
        ref[2,4,1,0]=(-0.945983571254)/(o+1.)+(0.362615161801)+(-0.97703977388)*0.5**o
        ref[2,4,1,1]=(-0.778028939318)/(o+1.)+(0.423610287746)+(-0.964329365094)*0.5**o
        ref[2,4,2,0]=(-0.138477487464)/(o+1.)+(-0.290097108281)+(-0.882489825678)*0.5**o
        ref[2,4,2,1]=(-0.953853492601)/(o+1.)+(-0.179508678068)+(-0.791359569512)*0.5**o
        ref[3,0,0,0]=(-0.199022712971)/(o+1.)+(0.253562515321)+(-0.814507939536)*0.5**o
        ref[3,0,0,1]=(0.112777444671)/(o+1.)+(-0.304438182199)+(0.0414041756638)*0.5**o
        ref[3,0,1,0]=(-0.880947344135)/(o+1.)+(-0.194192553178)+(-0.537458180783)*0.5**o
        ref[3,0,1,1]=(0.39314163058)/(o+1.)+(-0.775542968704)+(0.751321284745)*0.5**o
        ref[3,0,2,0]=(-0.482557545787)/(o+1.)+(-0.0683141681573)+(0.815235707945)*0.5**o
        ref[3,0,2,1]=(0.689498951848)/(o+1.)+(0.278187448835)+(0.723602555722)*0.5**o
        ref[3,1,0,0]=(0.293238350118)/(o+1.)+(0.126767755198)+(0.733428548881)*0.5**o
        ref[3,1,0,1]=(-0.26577191789)/(o+1.)+(0.201156903364)+(-0.698866683588)*0.5**o
        ref[3,1,1,0]=(0.439591690299)/(o+1.)+(-0.288902429619)+(-0.836123373092)*0.5**o
        ref[3,1,1,1]=(0.8910765985)/(o+1.)+(0.0553222730519)+(-0.194849541985)*0.5**o
        ref[3,1,2,0]=(-0.0320019026134)/(o+1.)+(0.477772657371)+(-0.497305257159)*0.5**o
        ref[3,1,2,1]=(-0.0499399267727)/(o+1.)+(-0.47037968496)+(-0.116903274335)*0.5**o
        ref[3,2,0,0]=(-0.276422491301)/(o+1.)+(-0.812540687574)+(-0.344751138134)*0.5**o
        ref[3,2,0,1]=(-0.00141392846802)/(o+1.)+(0.102797761295)+(0.591299515759)*0.5**o
        ref[3,2,1,0]=(0.630823139203)/(o+1.)+(0.743132641412)+(-0.700718656569)*0.5**o
        ref[3,2,1,1]=(0.490401876791)/(o+1.)+(-0.0461798489229)+(0.286459626346)*0.5**o
        ref[3,2,2,0]=(-0.787385728473)/(o+1.)+(0.0658852261331)+(0.377001414541)*0.5**o
        ref[3,2,2,1]=(-0.158857143023)/(o+1.)+(-0.421186525234)+(0.548872945376)*0.5**o
        ref[3,3,0,0]=(0.029229133788)/(o+1.)+(0.069575027013)+(0.212408725319)*0.5**o
        ref[3,3,0,1]=(0.757333397205)/(o+1.)+(0.029368913907)+(-0.74563598635)*0.5**o
        ref[3,3,1,0]=(0.0943476349516)/(o+1.)+(0.0337288993927)+(-0.926758427661)*0.5**o
        ref[3,3,1,1]=(-0.769051069188)/(o+1.)+(-0.844682211294)+(-0.575678885962)*0.5**o
        ref[3,3,2,0]=(0.246931939289)/(o+1.)+(0.756380254609)+(0.867209683046)*0.5**o
        ref[3,3,2,1]=(0.535429280541)/(o+1.)+(-0.0329131735419)+(0.869305051424)*0.5**o
        ref[3,4,0,0]=(-0.405156907998)/(o+1.)+(-0.244492906569)+(0.256665875603)*0.5**o
        ref[3,4,0,1]=(-0.140892979474)/(o+1.)+(0.516304250401)+(-0.120211653262)*0.5**o
        ref[3,4,1,0]=(0.168500977091)/(o+1.)+(0.089683045067)+(0.0684768301186)*0.5**o
        ref[3,4,1,1]=(0.479212374255)/(o+1.)+(-0.626588026593)+(-0.222516818267)*0.5**o
        ref[3,4,2,0]=(-0.563625996633)/(o+1.)+(-0.120136908079)+(0.192015305399)*0.5**o
        ref[3,4,2,1]=(-0.031361929046)/(o+1.)+(0.332029567053)+(-0.820432233148)*0.5**o
      else:
        s[0,0,0,0]=(0.186907875567)*x[0]+(0.323825050263)*x[1]+(1.15648314531)*x[2]
        s[0,0,0,1]=(1.12367405158)*x[0]+(1.13427439957)*x[1]+(0.189106618663)*x[2]
        s[0,0,1,0]=(1.76772912309)*x[0]+(0.0616670242122)*x[1]+(-1.23257311969)*x[2]
        s[0,0,1,1]=(0.0497251821243)*x[0]+(-1.47406701801)*x[1]+(0.164922402015)*x[2]
        s[0,0,2,0]=(-1.40783401802)*x[0]+(0.684901383857)*x[1]+(0.283077416398)*x[2]
        s[0,0,2,1]=(-0.283194016281)*x[0]+(-1.60164790888)*x[1]+(0.412908024034)*x[2]
        s[0,1,0,0]=(0.957812695611)*x[0]+(-0.863209638895)*x[1]+(-0.609946161661)*x[2]
        s[0,1,0,1]=(-0.410080093222)*x[0]+(0.703061988282)*x[1]+(0.0546952979936)*x[2]
        s[0,1,1,0]=(-1.43265292137)*x[0]+(-1.28132882624)*x[1]+(-0.103305431528)*x[2]
        s[0,1,1,1]=(-0.973042964661)*x[0]+(0.118946651326)*x[1]+(0.0121414797284)*x[2]
        s[0,1,2,0]=(-1.31257233483)*x[0]+(-1.90572394465)*x[1]+(-0.426472675848)*x[2]
        s[0,1,2,1]=(1.25719983663)*x[0]+(-0.68807451729)*x[1]+(0.329745219822)*x[2]
        s[0,2,0,0]=(-0.317555693596)*x[0]+(0.464722269829)*x[1]+(-0.0253415732374)*x[2]
        s[0,2,0,1]=(-0.802071257989)*x[0]+(-1.07682010382)*x[1]+(-1.52372537155)*x[2]
        s[0,2,1,0]=(-0.697501763365)*x[0]+(-1.5918814652)*x[1]+(-1.03755334358)*x[2]
        s[0,2,1,1]=(0.292457959822)*x[0]+(-0.446371848663)*x[1]+(1.32282628125)*x[2]
        s[0,2,2,0]=(1.44590220139)*x[0]+(-0.556542973367)*x[1]+(0.999665797669)*x[2]
        s[0,2,2,1]=(-0.376272847083)*x[0]+(-0.0251287305789)*x[1]+(0.364915231203)*x[2]
        s[0,3,0,0]=(0.88046028761)*x[0]+(0.372647019255)*x[1]+(-1.52356563515)*x[2]
        s[0,3,0,1]=(0.0765111785452)*x[0]+(-0.947059538185)*x[1]+(0.332098361392)*x[2]
        s[0,3,1,0]=(-1.37435064568)*x[0]+(1.04159418667)*x[1]+(0.314113199294)*x[2]
        s[0,3,1,1]=(1.03796425672)*x[0]+(-0.139508518244)*x[1]+(-0.46214547857)*x[2]
        s[0,3,2,0]=(0.285674556261)*x[0]+(-0.915609582509)*x[1]+(0.683131361973)*x[2]
        s[0,3,2,1]=(0.703275850512)*x[0]+(-0.894071596437)*x[1]+(0.118084971572)*x[2]
        s[0,4,0,0]=(-1.29507182493)*x[0]+(-0.275563564467)*x[1]+(-1.29101960297)*x[2]
        s[0,4,0,1]=(0.726127419233)*x[0]+(-0.163731035409)*x[1]+(1.45773190781)*x[2]
        s[0,4,1,0]=(-0.321962778987)*x[0]+(-0.434741013545)*x[1]+(0.348257210746)*x[2]
        s[0,4,1,1]=(0.892154653814)*x[0]+(1.12188965959)*x[1]+(-1.42589350879)*x[2]
        s[0,4,2,0]=(-1.06019594336)*x[0]+(-1.5907947093)*x[1]+(-1.64125703099)*x[2]
        s[0,4,2,1]=(0.820572048651)*x[0]+(-0.528087471135)*x[1]+(-0.0823830365488)*x[2]
        s[1,0,0,0]=(0.823455925698)*x[0]+(0.456056899485)*x[1]+(0.708907347857)*x[2]
        s[1,0,0,1]=(0.013059728892)*x[0]+(-0.772283592797)*x[1]+(0.363920439078)*x[2]
        s[1,0,1,0]=(-0.569161155945)*x[0]+(-1.60837471571)*x[1]+(-1.12748440619)*x[2]
        s[1,0,1,1]=(-1.06458634572)*x[0]+(-1.10787449393)*x[1]+(1.43157821547)*x[2]
        s[1,0,2,0]=(1.42955732758)*x[0]+(-0.769967391917)*x[1]+(0.461386087764)*x[2]
        s[1,0,2,1]=(-1.12922605294)*x[0]+(-0.256069161837)*x[1]+(0.934117328474)*x[2]
        s[1,1,0,0]=(-0.296512978109)*x[0]+(0.0247034910192)*x[1]+(-0.0918640286973)*x[2]
        s[1,1,0,1]=(0.262151201281)*x[0]+(-0.556624983637)*x[1]+(-0.82641291041)*x[2]
        s[1,1,1,0]=(-0.909049007906)*x[0]+(0.578952420411)*x[1]+(0.0963761548489)*x[2]
        s[1,1,1,1]=(0.789884036316)*x[0]+(0.714044849036)*x[1]+(-0.348148665956)*x[2]
        s[1,1,2,0]=(-0.306802924795)*x[0]+(0.166007262622)*x[1]+(0.812933157357)*x[2]
        s[1,1,2,1]=(-0.23666871482)*x[0]+(0.0180126754613)*x[1]+(0.465074288631)*x[2]
        s[1,2,0,0]=(-1.14910199315)*x[0]+(0.930765031574)*x[1]+(1.63176081675)*x[2]
        s[1,2,0,1]=(-0.220753578398)*x[0]+(0.153024000962)*x[1]+(0.29171013278)*x[2]
        s[1,2,1,0]=(-0.571208521033)*x[0]+(1.18218013588)*x[1]+(-0.0281527591651)*x[2]
        s[1,2,1,1]=(-0.0212229342253)*x[0]+(0.577228434778)*x[1]+(-0.0934776488559)*x[2]
        s[1,2,2,0]=(-0.592424182282)*x[0]+(-0.0403519194823)*x[1]+(0.150970946422)*x[2]
        s[1,2,2,1]=(-1.33143395635)*x[0]+(-1.3121470647)*x[1]+(-0.78895334942)*x[2]
        s[1,3,0,0]=(0.626711601793)*x[0]+(0.0187262812242)*x[1]+(-0.392743911033)*x[2]
        s[1,3,0,1]=(0.0360431567199)*x[0]+(-0.921408398245)*x[1]+(-0.172097608208)*x[2]
        s[1,3,1,0]=(0.0223088597951)*x[0]+(0.139631235358)*x[1]+(-0.529170239405)*x[2]
        s[1,3,1,1]=(0.11834184642)*x[0]+(-0.754799078426)*x[1]+(0.136555856977)*x[2]
        s[1,3,2,0]=(-0.288966482257)*x[0]+(-0.227333376328)*x[1]+(-0.583704417546)*x[2]
        s[1,3,2,1]=(0.263525293937)*x[0]+(0.842984179305)*x[1]+(0.592096192935)*x[2]
        s[1,4,0,0]=(-0.0145931697196)*x[0]+(-0.839359041248)*x[1]+(-0.635230965652)*x[2]
        s[1,4,0,1]=(-0.452080234732)*x[0]+(-0.500376989587)*x[1]+(-0.27541187994)*x[2]
        s[1,4,1,0]=(-0.028441856276)*x[0]+(0.99292041207)*x[1]+(-0.555205406529)*x[2]
        s[1,4,1,1]=(0.670664493076)*x[0]+(0.562911949702)*x[1]+(-0.767721105918)*x[2]
        s[1,4,2,0]=(0.960781399312)*x[0]+(0.0966843021482)*x[1]+(-0.448822164554)*x[2]
        s[1,4,2,1]=(1.19002654689)*x[0]+(0.0423440255032)*x[1]+(-0.566501161163)*x[2]
        s[2,0,0,0]=(-1.21404047236)*x[0]+(0.246576983095)*x[1]+(-1.35965095619)*x[2]
        s[2,0,0,1]=(-0.183423338333)*x[0]+(0.490089064451)*x[1]+(-0.578583461456)*x[2]
        s[2,0,1,0]=(1.12402576003)*x[0]+(-0.175494364486)*x[1]+(-0.303488944097)*x[2]
        s[2,0,1,1]=(-1.65572015787)*x[0]+(-1.0020836407)*x[1]+(0.480903327702)*x[2]
        s[2,0,2,0]=(0.145764271661)*x[0]+(-0.263090439788)*x[1]+(-1.17377189982)*x[2]
        s[2,0,2,1]=(-0.837574918907)*x[0]+(1.48561229389)*x[1]+(0.967914367565)*x[2]
        s[2,1,0,0]=(0.509756439273)*x[0]+(-0.111493103227)*x[1]+(0.748245818033)*x[2]
        s[2,1,0,1]=(0.131007923179)*x[0]+(-0.128179547101)*x[1]+(-0.755140067557)*x[2]
        s[2,1,1,0]=(-0.635852982675)*x[0]+(-0.475693144737)*x[1]+(-0.331519420739)*x[2]
        s[2,1,1,1]=(-1.29780426286)*x[0]+(0.774138127446)*x[1]+(-1.74756722025)*x[2]
        s[2,1,2,0]=(-0.14015158014)*x[0]+(-0.875354388859)*x[1]+(0.791253726662)*x[2]
        s[2,1,2,1]=(-0.0772968366884)*x[0]+(-0.937984863796)*x[1]+(-0.0602294365875)*x[2]
        s[2,2,0,0]=(0.955209462705)*x[0]+(0.849659517825)*x[1]+(0.0983431115722)*x[2]
        s[2,2,0,1]=(1.72389105142)*x[0]+(-0.412358364777)*x[1]+(-1.3083297441)*x[2]
        s[2,2,1,0]=(-0.895927963754)*x[0]+(1.65404011945)*x[1]+(0.297503560372)*x[2]
        s[2,2,1,1]=(1.34506983158)*x[0]+(-0.552690724942)*x[1]+(0.0882447776246)*x[2]
        s[2,2,2,0]=(-0.603470575964)*x[0]+(1.77788342742)*x[1]+(-0.960079624369)*x[2]
        s[2,2,2,1]=(-0.547711891427)*x[0]+(-0.562393805421)*x[1]+(-0.183240255616)*x[2]
        s[2,3,0,0]=(1.01018738642)*x[0]+(1.4085839719)*x[1]+(-0.619343450789)*x[2]
        s[2,3,0,1]=(0.525036070827)*x[0]+(-0.760210492125)*x[1]+(0.621245864477)*x[2]
        s[2,3,1,0]=(-0.786180468736)*x[0]+(0.784642311709)*x[1]+(-0.377020976891)*x[2]
        s[2,3,1,1]=(-0.333203982307)*x[0]+(-0.044265604048)*x[1]+(-1.6196925017)*x[2]
        s[2,3,2,0]=(-0.885601870306)*x[0]+(0.650248271309)*x[1]+(-1.7206378066)*x[2]
        s[2,3,2,1]=(0.0941920781315)*x[0]+(-1.24650013731)*x[1]+(0.67065624977)*x[2]
        s[2,4,0,0]=(0.0693008855416)*x[0]+(-1.33764045153)*x[1]+(0.277137873936)*x[2]
        s[2,4,0,1]=(0.887968960137)*x[0]+(1.57875979002)*x[1]+(-0.103648235191)*x[2]
        s[2,4,1,0]=(-0.547070384787)*x[0]+(-0.376770947917)*x[1]+(-1.81372790514)*x[2]
        s[2,4,1,1]=(0.375805210805)*x[0]+(0.660242065798)*x[1]+(1.69413225283)*x[2]
        s[2,4,2,0]=(-0.914715181893)*x[0]+(1.27301677765)*x[1]+(0.974031227808)*x[2]
        s[2,4,2,1]=(-0.503816280288)*x[0]+(0.552217633496)*x[1]+(-0.90127280688)*x[2]
        s[3,0,0,0]=(0.768275498738)*x[0]+(-0.811563543342)*x[1]+(-0.69998185891)*x[2]
        s[3,0,0,1]=(-0.629451202094)*x[0]+(1.02346787018)*x[1]+(0.780161524988)*x[2]
        s[3,0,1,0]=(0.584052565724)*x[0]+(-0.069634462512)*x[1]+(-1.00341091459)*x[2]
        s[3,0,1,1]=(1.03073176869)*x[0]+(1.53263439484)*x[1]+(1.03753255807)*x[2]
        s[3,0,2,0]=(0.0522744193577)*x[0]+(0.308512837882)*x[1]+(-0.315970675533)*x[2]
        s[3,0,2,1]=(0.0747430001964)*x[0]+(0.863711676177)*x[1]+(1.07705766445)*x[2]
        s[3,1,0,0]=(0.114255376522)*x[0]+(1.47818231679)*x[1]+(0.0222267873076)*x[2]
        s[3,1,0,1]=(0.613783843499)*x[0]+(0.369289287936)*x[1]+(1.08226313005)*x[2]
        s[3,1,1,0]=(0.474121107413)*x[0]+(-0.284169623677)*x[1]+(1.26739419136)*x[2]
        s[3,1,1,1]=(0.703235040854)*x[0]+(0.340511678132)*x[1]+(0.314037803901)*x[2]
        s[3,1,2,0]=(-0.754512705698)*x[0]+(0.957288483514)*x[1]+(1.38853172146)*x[2]
        s[3,1,2,1]=(0.338933480448)*x[0]+(1.30797425088)*x[1]+(-0.492819385452)*x[2]
        s[3,2,0,0]=(0.477902330587)*x[0]+(0.658604196318)*x[1]+(-0.669039618554)*x[2]
        s[3,2,0,1]=(0.584833130533)*x[0]+(0.205626741315)*x[1]+(-0.449267859148)*x[2]
        s[3,2,1,0]=(0.392564971475)*x[0]+(-0.867191184183)*x[1]+(0.508221616556)*x[2]
        s[3,2,1,1]=(0.199023224346)*x[0]+(0.210018232234)*x[1]+(0.17332311179)*x[2]
        s[3,2,2,0]=(-0.530182002398)*x[0]+(-0.70410123336)*x[1]+(0.454418407328)*x[2]
        s[3,2,2,1]=(-1.00165228123)*x[0]+(0.253353462588)*x[1]+(1.07981964164)*x[2]
        s[3,3,0,0]=(-0.00388223127856)*x[0]+(-0.256156832173)*x[1]+(-1.22618259947)*x[2]
        s[3,3,0,1]=(1.04947612909)*x[0]+(-0.590938924785)*x[1]+(-0.80453902875)*x[2]
        s[3,3,1,0]=(0.395025775135)*x[0]+(-1.30382091375)*x[1]+(1.00251618393)*x[2]
        s[3,3,1,1]=(-0.601315067206)*x[0]+(-0.226958312276)*x[1]+(-0.69720544326)*x[2]
        s[3,3,2,0]=(0.748907154335)*x[0]+(-0.694932273918)*x[1]+(0.143655252827)*x[2]
        s[3,3,2,1]=(-0.228346281761)*x[0]+(0.0818793892413)*x[1]+(0.376376078012)*x[2]
        s[3,4,0,0]=(0.675502208069)*x[0]+(0.498131679631)*x[1]+(-0.606527858224)*x[2]
        s[3,4,0,1]=(0.230994211989)*x[0]+(-1.81768645462)*x[1]+(1.59488392513)*x[2]
        s[3,4,1,0]=(-1.35866095694)*x[0]+(-0.122601842831)*x[1]+(1.73437014104)*x[2]
        s[3,4,1,1]=(0.63210638436)*x[0]+(1.50387972886)*x[1]+(0.655743288533)*x[2]
        s[3,4,2,0]=(1.42156357373)*x[0]+(-0.701544596166)*x[1]+(0.88931540397)*x[2]
        s[3,4,2,1]=(-0.405515262733)*x[0]+(0.872922189212)*x[1]+(-1.13847750709)*x[2]
        ref[0,0,0,0]=(0.415231330279)/(o+1.)+(0.982601202296)+(-0.713217663735)*0.5**o
        ref[0,0,0,1]=(0.650505784971)/(o+1.)+(0.406482330235)+(0.983584624374)*0.5**o
        ref[0,0,1,0]=(-0.615926989595)/(o+1.)+(0.113540305186)+(0.98566940684)*0.5**o
        ref[0,0,1,1]=(-1.36210768774)/(o+1.)+(0.330430698616)+(-0.558173143358)*0.5**o
        ref[0,0,2,0]=(0.589319954581)/(o+1.)+(-0.146725890489)+(-0.735723391368)*0.5**o
        ref[0,0,2,1]=(-0.819641973816)/(o+1.)+(0.0696728799133)+(-0.791637687141)*0.5**o
        ref[0,1,0,0]=(-0.984505810214)/(o+1.)+(0.0623424750886)+(0.344477755092)*0.5**o
        ref[0,1,0,1]=(0.0372238318297)/(o+1.)+(0.201167151246)+(-0.0918809412683)*0.5**o
        ref[0,1,1,0]=(-0.988162693644)/(o+1.)+(-0.658809560166)+(-0.51150536516)*0.5**o
        ref[0,1,1,1]=(0.191409590473)/(o+1.)+(-0.426836466412)+(-0.179691491256)*0.5**o
        ref[0,1,2,0]=(-1.50151479209)/(o+1.)+(-0.648874443157)+(-0.84550527693)*0.5**o
        ref[0,1,2,1]=(-1.3172677321)/(o+1.)+(0.885092333538)+(0.445953604186)*0.5**o
        ref[0,2,0,0]=(0.1269682286)/(o+1.)+(-0.175772039094)+(0.346400852583)*0.5**o
        ref[0,2,0,1]=(-1.46726533796)/(o+1.)+(-1.05015066374)+(0.164949932075)*0.5**o
        ref[0,2,1,0]=(-1.23701559967)/(o+1.)+(-0.825973196415)+(-0.437974579642)*0.5**o
        ref[0,2,1,1]=(0.132084480709)/(o+1.)+(0.0364121752536)+(0.964003561191)*0.5**o
        ref[0,2,2,0]=(-0.0575514788048)/(o+1.)+(0.574131321284)+(0.798313861933)*0.5**o
        ref[0,2,2,1]=(-0.854422215721)/(o+1.)+(0.454172855359)+(-0.0904098414555)*0.5**o
        ref[0,3,0,0]=(-1.04634289994)/(o+1.)+(0.354533324899)+(0.0668179218583)*0.5**o
        ref[0,3,0,1]=(-0.415702586981)/(o+1.)+(0.126519101056)+(-0.375785613379)*0.5**o
        ref[0,3,1,0]=(-0.268120824236)/(o+1.)+(0.500467336081)+(-0.751457107646)*0.5**o
        ref[0,3,1,1]=(0.827791290739)/(o+1.)+(-0.347418978526)+(0.303356926219)*0.5**o
        ref[0,3,2,0]=(-0.1387759961)/(o+1.)+(-0.350616137823)+(0.893204607472)*0.5**o
        ref[0,3,2,1]=(0.129310667468)/(o+1.)+(-0.252264005651)+(0.302506569481)*0.5**o
        ref[0,4,0,0]=(-0.021050677621)/(o+1.)+(-0.980639199085)+(-0.879325916576)*0.5**o
        ref[0,4,0,1]=(-0.262715302419)/(o+1.)+(1.20073556064)+(-0.118627527238)*0.5**o
        ref[0,4,1,0]=(0.261035782917)/(o+1.)+(-0.449979981215)+(0.230477597727)*0.5**o
        ref[0,4,1,1]=(-0.47960276307)/(o+1.)+(0.219069456491)+(0.629614654702)*0.5**o
        ref[0,4,2,0]=(-1.27925873031)/(o+1.)+(-1.32602054802)+(-0.360947857308)*0.5**o
        ref[0,4,2,1]=(-1.34486930774)/(o+1.)+(0.546553886393)+(0.46186307592)*0.5**o
        ref[1,0,0,0]=(0.430196940607)/(o+1.)+(0.311302638938)+(0.935617954556)*0.5**o
        ref[1,0,0,1]=(0.0865234935036)/(o+1.)+(-0.268442519337)+(0.055058120343)*0.5**o
        ref[1,0,1,0]=(-1.48387607046)/(o+1.)+(-0.786378289878)+(-0.248387627621)*0.5**o
        ref[1,0,1,1]=(0.758534313728)/(o+1.)+(-0.265213280892)+(-0.968990376127)*0.5**o
        ref[1,0,2,0]=(-0.713142570031)/(o+1.)+(0.462618013893)+(0.908882565677)*0.5**o
        ref[1,0,2,1]=(-0.482219090892)/(o+1.)+(0.307689127346)+(-0.584337050105)*0.5**o
        ref[1,1,0,0]=(-1.17250881543)/(o+1.)+(0.113442845094)+(0.581949609453)*0.5**o
        ref[1,1,0,1]=(-1.3468375595)/(o+1.)+(0.395669021834)+(-0.565387176936)*0.5**o
        ref[1,1,1,0]=(0.2018351732)/(o+1.)+(-0.157830690125)+(-0.119894225596)*0.5**o
        ref[1,1,1,1]=(1.21543817764)/(o+1.)+(-0.0497756593583)+(0.0398933604741)*0.5**o
        ref[1,1,2,0]=(-0.162294483944)/(o+1.)+(0.85994581496)+(-0.885459650791)*0.5**o
        ref[1,1,2,1]=(1.24422084677)/(o+1.)+(-0.379646444866)+(-0.238509707766)*0.5**o
        ref[1,2,0,0]=(1.5435438681)/(o+1.)+(0.08540126524)+(-0.300922543405)*0.5**o
        ref[1,2,0,1]=(-0.112210840363)/(o+1.)+(0.480051249506)+(-0.623911103306)*0.5**o
        ref[1,2,1,0]=(0.285721711645)/(o+1.)+(0.0100191655774)+(0.27705881288)*0.5**o
        ref[1,2,1,1]=(0.66930209958)/(o+1.)+(-0.542529578578)+(0.878284909271)*0.5**o
        ref[1,2,2,0]=(1.12100699995)/(o+1.)+(-0.678457673316)+(-0.245896808662)*0.5**o
        ref[1,2,2,1]=(-0.88612973059)/(o+1.)+(-1.00088764314)+(-0.544629353594)*0.5**o
        ref[1,3,0,0]=(0.387350166894)/(o+1.)+(-0.499575950447)+(0.864495705983)*0.5**o
        ref[1,3,0,1]=(-0.942393535847)/(o+1.)+(0.0303050564575)+(-0.175679426801)*0.5**o
        ref[1,3,1,0]=(-0.798050539357)/(o+1.)+(0.126548837387)+(0.177722720331)*0.5**o
        ref[1,3,1,1]=(-1.50957773465)/(o+1.)+(0.172938183698)+(0.663799992229)*0.5**o
        ref[1,3,2,0]=(0.469444503978)/(o+1.)+(-0.647836043317)+(-0.273776693474)*0.5**o
        ref[1,3,2,1]=(0.310061780349)/(o+1.)+(1.05452404891)+(-0.720504211989)*0.5**o
        ref[1,4,0,0]=(-0.820548632752)/(o+1.)+(0.105943005381)+(-0.88052055463)*0.5**o
        ref[1,4,0,1]=(-0.158467564266)/(o+1.)+(-0.709811754591)+(0.35022196919)*0.5**o
        ref[1,4,1,0]=(0.00990374166591)/(o+1.)+(0.51839921597)+(-0.637429024341)*0.5**o
        ref[1,4,1,1]=(-0.246106620377)/(o+1.)+(0.33455634807)+(0.0428492610972)*0.5**o
        ref[1,4,2,0]=(0.472702988578)/(o+1.)+(0.0688149777117)+(-0.00168940709497)*0.5**o
        ref[1,4,2,1]=(0.284541065049)/(o+1.)+(-0.0548349320689)+(0.490998210318)*0.5**o
        ref[2,0,0,0]=(-0.733338280715)/(o+1.)+(-0.47189177308)+(-0.649992618571)*0.5**o
        ref[2,0,0,1]=(-0.948815264173)/(o+1.)+(0.837962467604)+(-0.999027406375)*0.5**o
        ref[2,0,1,0]=(-0.0944539750337)/(o+1.)+(0.0746201219713)+(0.590256182541)*0.5**o
        ref[2,0,1,1]=(0.044594970161)/(o+1.)+(-0.717673746264)+(-0.786147948501)*0.5**o
        ref[2,0,2,0]=(-0.387429911457)/(o+1.)+(-0.0765750118601)+(-0.750518132769)*0.5**o
        ref[2,0,2,1]=(1.28025192232)/(o+1.)+(0.425010917096)+(-0.514322013965)*0.5**o
        ref[2,1,0,0]=(0.85161480185)/(o+1.)+(-0.117153136076)+(0.52920062438)*0.5**o
        ref[2,1,0,1]=(-0.558914411305)/(o+1.)+(-0.229298513746)+(0.265199747318)*0.5**o
        ref[2,1,1,0]=(-0.33769433116)/(o+1.)+(-0.678382612728)+(0.251394008465)*0.5**o
        ref[2,1,1,1]=(-0.990803230186)/(o+1.)+(-0.413400680719)+(-0.453628764049)*0.5**o
        ref[2,1,2,0]=(-0.377834292093)/(o+1.)+(0.521893888533)+(-0.890205727309)*0.5**o
        ref[2,1,2,1]=(-1.33150035489)/(o+1.)+(-0.0586549531766)+(0.373299124171)*0.5**o
        ref[2,2,0,0]=(-0.166255483746)/(o+1.)+(0.816713521389)+(0.436040533071)*0.5**o
        ref[2,2,0,1]=(-1.39682071748)/(o+1.)+(0.21770833884)+(0.964606982344)*0.5**o
        ref[2,2,1,0]=(1.3247136685)/(o+1.)+(-0.0466914213895)+(-0.175715109647)*0.5**o
        ref[2,2,1,1]=(-0.522454725229)/(o+1.)+(0.291262422208)+(0.820553765077)*0.5**o
        ref[2,2,2,0]=(0.136169385992)/(o+1.)+(0.253426637378)+(-0.42868943366)*0.5**o
        ref[2,2,2,1]=(-0.131390793028)/(o+1.)+(-0.715512276073)+(0.269069392711)*0.5**o
        ref[2,3,0,0]=(0.1679740824)/(o+1.)+(0.653952560954)+(0.323548703221)*0.5**o
        ref[2,3,0,1]=(-0.0511907658967)/(o+1.)+(-0.236699539579)+(0.910661288233)*0.5**o
        ref[2,3,1,0]=(0.451520708483)/(o+1.)+(-0.065786465884)+(-0.698506910633)*0.5**o
        ref[2,3,1,1]=(-0.542162878453)/(o+1.)+(-0.237944135968)+(-0.979110937669)*0.5**o
        ref[2,3,2,0]=(-0.489308922223)/(o+1.)+(-0.563117809253)+(-0.34044686487)*0.5**o
        ref[2,3,2,1]=(0.382652422829)/(o+1.)+(-0.328188452455)+(-0.207927327325)*0.5**o
        ref[2,4,0,0]=(0.0347966753187)/(o+1.)+(-0.629864354262)+(0.233730341151)*0.5**o
        ref[2,4,0,1]=(0.123939573502)/(o+1.)+(1.03666652808)+(0.165807885309)*0.5**o
        ref[2,4,1,0]=(-0.829855747878)/(o+1.)+(-0.507284312041)+(-0.89314486588)*0.5**o
        ref[2,4,1,1]=(1.80556499882)/(o+1.)+(0.554771100606)+(-0.1849276706)*0.5**o
        ref[2,4,2,0]=(0.829439412646)/(o+1.)+(0.342620313927)+(-0.182347216931)*0.5**o
        ref[2,4,2,1]=(-0.824674529166)/(o+1.)+(-0.172483000807)+(0.316769077106)*0.5**o
        ref[3,0,0,0]=(-1.81534289679)/(o+1.)+(0.235921261477)+(0.600230470324)*0.5**o
        ref[3,0,0,1]=(0.758824131522)/(o+1.)+(0.540267308765)+(-0.665180555978)*0.5**o
        ref[3,0,1,0]=(-0.61930013537)/(o+1.)+(-0.0863636993976)+(0.303034722786)*0.5**o
        ref[3,0,1,1]=(1.09849962509)/(o+1.)+(0.780381688481)+(0.941635719543)*0.5**o
        ref[3,0,2,0]=(0.984167465846)/(o+1.)+(-0.471651730612)+(0.00395257708327)*0.5**o
        ref[3,0,2,1]=(-0.0216502142754)/(o+1.)+(1.25274987136)+(-0.468337187615)*0.5**o
        ref[3,1,0,0]=(1.21762392246)/(o+1.)+(0.0235896546035)+(0.349861248945)*0.5**o
        ref[3,1,0,1]=(0.681142299068)/(o+1.)+(0.586170195383)+(0.211853571648)*0.5**o
        ref[3,1,1,0]=(1.22842568638)/(o+1.)+(0.308050279545)+(-0.387180570377)*0.5**o
        ref[3,1,1,1]=(-0.708900188728)/(o+1.)+(1.04208633918)+(-0.0174879667472)*0.5**o
        ref[3,1,2,0]=(1.79188214766)/(o+1.)+(0.301719505956)+(-0.804013660301)*0.5**o
        ref[3,1,2,1]=(0.669297533033)/(o+1.)+(0.119247079862)+(0.246296653123)*0.5**o
        ref[3,2,0,0]=(-0.791486989477)/(o+1.)+(0.204677775698)+(0.849598346434)*0.5**o
        ref[3,2,0,1]=(-0.505948254664)/(o+1.)+(0.0688840300017)+(0.70937220736)*0.5**o
        ref[3,2,1,0]=(-0.691348115315)/(o+1.)+(0.437490279091)+(-0.150037039019)*0.5**o
        ref[3,2,1,1]=(0.708369627369)/(o+1.)+(0.176205102648)+(-0.478415264295)*0.5**o
        ref[3,2,2,0]=(0.297093119787)/(o+1.)+(-0.248132872678)+(-0.580692202861)*0.5**o
        ref[3,2,2,1]=(-0.476148841282)/(o+1.)+(0.443525381364)+(-0.0793810984529)*0.5**o
        ref[3,3,0,0]=(-0.901387033571)/(o+1.)+(-0.628090499737)+(0.671346370124)*0.5**o
        ref[3,3,0,1]=(-0.123005978892)/(o+1.)+(-0.59694482259)+(0.970893799626)*0.5**o
        ref[3,3,1,0]=(-0.784454504087)/(o+1.)+(0.436648462004)+(0.00487862539679)*0.5**o
        ref[3,3,1,1]=(-1.73297919322)/(o+1.)+(-0.09410977014)+(0.395719910762)*0.5**o
        ref[3,3,2,0]=(0.0989755292654)/(o+1.)+(0.062352403584)+(-0.0260502031901)*0.5**o
        ref[3,3,2,1]=(-0.690845491742)/(o+1.)+(0.678904082779)+(-0.437053488325)*0.5**o
        ref[3,4,0,0]=(-0.801695028055)/(o+1.)+(0.731880266747)+(-0.0949594759642)*0.5**o
        ref[3,4,0,1]=(-0.263446786535)/(o+1.)+(0.0496642554438)+(0.172309958154)*0.5**o
        ref[3,4,1,0]=(0.542595531974)/(o+1.)+(0.308327980561)+(-0.906144151831)*0.5**o
        ref[3,4,1,1]=(0.637885608826)/(o+1.)+(1.16403227519)+(-0.174220757444)*0.5**o
        ref[3,4,2,0]=(0.946926166426)/(o+1.)+(0.0242541266649)+(0.613899961774)*0.5**o
        ref[3,4,2,1]=(-0.0303035732231)/(o+1.)+(0.0375314231208)+(-0.715829853629)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_FunctionOnContactZero_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.793574201557)*x[0]**o+(0.516960263083)*x[0]+(-0.448328841896)*x[1]**o+(-0.142637802972)*x[1]
        ref=(-0.448328841896)/(o+1.)+(0.187161230055)+(0.793574201557)*0.5**o
      else:
        s=(-0.338096271642)*x[0]**o+(0.968157263648)*x[0]+(0.646364944878)*x[1]**o+(-0.80014418872)*x[1]+(0.0561188904819)*x[2]**o+(0.413390558956)*x[2]
        ref=(0.702483835359)/(o+1.)+(0.290701816942)+(-0.338096271642)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_FunctionOnContactZero_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.298300777435)*x[0]**o+(-0.656203877839)*x[0]+(0.706465159872)*x[1]**o+(-0.441355227209)*x[1]
        s[1]=(-0.323920359168)*x[0]**o+(0.167106922584)*x[0]+(-0.77484608349)*x[1]**o+(0.961265696466)*x[1]
        ref[0]=(0.706465159872)/(o+1.)+(-0.548779552524)+(-0.298300777435)*0.5**o
        ref[1]=(-0.77484608349)/(o+1.)+(0.564186309525)+(-0.323920359168)*0.5**o
      else:
        s[0]=(0.226749576468)*x[0]**o+(-0.794303615675)*x[0]+(-0.475688985171)*x[1]**o+(-0.502986687652)*x[1]+(0.620418017904)*x[2]**o+(-0.201211072609)*x[2]
        s[1]=(-0.623757173924)*x[0]**o+(0.408817385275)*x[0]+(0.732106423025)*x[1]**o+(-0.414680272664)*x[1]+(-0.37214615142)*x[2]**o+(0.0433104237128)*x[2]
        ref[0]=(0.144729032732)/(o+1.)+(-0.749250687968)+(0.226749576468)*0.5**o
        ref[1]=(0.359960271605)/(o+1.)+(0.0187237681618)+(-0.623757173924)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_FunctionOnContactZero_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.111040625394)*x[0]**o+(-0.262719374505)*x[0]+(-0.629693203515)*x[1]**o+(-0.483036975224)*x[1]
        s[0,1]=(-0.710606684727)*x[0]**o+(-0.0460165503366)*x[0]+(-0.293965417547)*x[1]**o+(-0.495255124461)*x[1]
        s[0,2]=(-0.777570630133)*x[0]**o+(-0.116630316032)*x[0]+(0.137509413983)*x[1]**o+(0.819368394153)*x[1]
        s[0,3]=(-0.710576800354)*x[0]**o+(-0.580982318739)*x[0]+(0.88040631872)*x[1]**o+(0.906791051848)*x[1]
        s[0,4]=(-0.182839498651)*x[0]**o+(-0.73087599847)*x[0]+(0.343867628394)*x[1]**o+(0.430107584469)*x[1]
        s[1,0]=(0.69614992851)*x[0]**o+(-0.897687606816)*x[0]+(0.0635059035444)*x[1]**o+(-0.664283784877)*x[1]
        s[1,1]=(-0.838368623112)*x[0]**o+(0.235356849847)*x[0]+(-0.575094104243)*x[1]**o+(0.317897877318)*x[1]
        s[1,2]=(-0.466268810559)*x[0]**o+(-0.0899593004601)*x[0]+(-0.966257251835)*x[1]**o+(-0.144068791611)*x[1]
        s[1,3]=(0.0053613868128)*x[0]**o+(0.0318146753697)*x[0]+(0.679315501165)*x[1]**o+(-0.0722416861767)*x[1]
        s[1,4]=(0.933407356129)*x[0]**o+(-0.495175209275)*x[0]+(-0.6009471862)*x[1]**o+(-0.539903879411)*x[1]
        s[2,0]=(0.557935263092)*x[0]**o+(0.858947740632)*x[0]+(0.0661071238236)*x[1]**o+(-0.92607178646)*x[1]
        s[2,1]=(-0.992502095953)*x[0]**o+(0.725486544204)*x[0]+(0.966008980795)*x[1]**o+(-0.687474869885)*x[1]
        s[2,2]=(0.131446552365)*x[0]**o+(-0.23682138542)*x[0]+(0.762830166878)*x[1]**o+(0.154873065449)*x[1]
        s[2,3]=(-0.325278661025)*x[0]**o+(0.00830856266952)*x[0]+(-0.67055674604)*x[1]**o+(-0.200351789931)*x[1]
        s[2,4]=(-0.153591894122)*x[0]**o+(0.11301998318)*x[0]+(-0.931207923183)*x[1]**o+(-0.808854650606)*x[1]
        s[3,0]=(0.482659628909)*x[0]**o+(0.625042019107)*x[0]+(-0.0579000114037)*x[1]**o+(0.468282154942)*x[1]
        s[3,1]=(-0.324897146141)*x[0]**o+(0.107637712241)*x[0]+(-0.802284595948)*x[1]**o+(0.462102155569)*x[1]
        s[3,2]=(0.0324851257443)*x[0]**o+(0.88112504986)*x[0]+(0.364393243039)*x[1]**o+(0.279546598993)*x[1]
        s[3,3]=(0.362592102084)*x[0]**o+(0.531299996192)*x[0]+(-0.133406058793)*x[1]**o+(0.331414049109)*x[1]
        s[3,4]=(0.527090134663)*x[0]**o+(0.992717007892)*x[0]+(0.0417616039807)*x[1]**o+(-0.447250742864)*x[1]
        ref[0,0]=(-0.629693203515)/(o+1.)+(-0.372878174865)+(0.111040625394)*0.5**o
        ref[0,1]=(-0.293965417547)/(o+1.)+(-0.270635837399)+(-0.710606684727)*0.5**o
        ref[0,2]=(0.137509413983)/(o+1.)+(0.351369039061)+(-0.777570630133)*0.5**o
        ref[0,3]=(0.88040631872)/(o+1.)+(0.162904366555)+(-0.710576800354)*0.5**o
        ref[0,4]=(0.343867628394)/(o+1.)+(-0.150384207)+(-0.182839498651)*0.5**o
        ref[1,0]=(0.0635059035444)/(o+1.)+(-0.780985695846)+(0.69614992851)*0.5**o
        ref[1,1]=(-0.575094104243)/(o+1.)+(0.276627363583)+(-0.838368623112)*0.5**o
        ref[1,2]=(-0.966257251835)/(o+1.)+(-0.117014046036)+(-0.466268810559)*0.5**o
        ref[1,3]=(0.679315501165)/(o+1.)+(-0.0202135054035)+(0.0053613868128)*0.5**o
        ref[1,4]=(-0.6009471862)/(o+1.)+(-0.517539544343)+(0.933407356129)*0.5**o
        ref[2,0]=(0.0661071238236)/(o+1.)+(-0.0335620229141)+(0.557935263092)*0.5**o
        ref[2,1]=(0.966008980795)/(o+1.)+(0.0190058371594)+(-0.992502095953)*0.5**o
        ref[2,2]=(0.762830166878)/(o+1.)+(-0.0409741599856)+(0.131446552365)*0.5**o
        ref[2,3]=(-0.67055674604)/(o+1.)+(-0.0960216136307)+(-0.325278661025)*0.5**o
        ref[2,4]=(-0.931207923183)/(o+1.)+(-0.347917333713)+(-0.153591894122)*0.5**o
        ref[3,0]=(-0.0579000114037)/(o+1.)+(0.546662087024)+(0.482659628909)*0.5**o
        ref[3,1]=(-0.802284595948)/(o+1.)+(0.284869933905)+(-0.324897146141)*0.5**o
        ref[3,2]=(0.364393243039)/(o+1.)+(0.580335824427)+(0.0324851257443)*0.5**o
        ref[3,3]=(-0.133406058793)/(o+1.)+(0.431357022651)+(0.362592102084)*0.5**o
        ref[3,4]=(0.0417616039807)/(o+1.)+(0.272733132514)+(0.527090134663)*0.5**o
      else:
        s[0,0]=(-0.910274365459)*x[0]**o+(0.444602331451)*x[0]+(0.109320774249)*x[1]**o+(-0.340302571967)*x[1]+(-0.43434237629)*x[2]**o+(-0.943276146561)*x[2]
        s[0,1]=(0.290437327261)*x[0]**o+(0.936756757082)*x[0]+(0.169426804577)*x[1]**o+(-0.606271363634)*x[1]+(0.0955072153861)*x[2]**o+(0.500289189372)*x[2]
        s[0,2]=(0.857537342473)*x[0]**o+(-0.441518068791)*x[0]+(0.280884170231)*x[1]**o+(-0.712646882141)*x[1]+(-0.771612131879)*x[2]**o+(-0.191796438089)*x[2]
        s[0,3]=(0.171520107567)*x[0]**o+(0.92204336001)*x[0]+(-0.370919720606)*x[1]**o+(0.768895739632)*x[1]+(0.784096316797)*x[2]**o+(-0.687371757606)*x[2]
        s[0,4]=(-0.941363513955)*x[0]**o+(-0.715641149458)*x[0]+(0.309819925901)*x[1]**o+(0.807925106464)*x[1]+(0.283008337009)*x[2]**o+(-0.858020235388)*x[2]
        s[1,0]=(-0.368063286241)*x[0]**o+(-0.379538647626)*x[0]+(0.568731253476)*x[1]**o+(-0.129142499862)*x[1]+(0.664990905083)*x[2]**o+(0.72526514854)*x[2]
        s[1,1]=(0.609862576834)*x[0]**o+(0.168414778244)*x[0]+(0.705960386503)*x[1]**o+(0.414950596481)*x[1]+(-0.324853936067)*x[2]**o+(0.705193129155)*x[2]
        s[1,2]=(0.259927679551)*x[0]**o+(0.023313779932)*x[0]+(0.542815998551)*x[1]**o+(-0.980335573131)*x[1]+(-0.104377098432)*x[2]**o+(0.678830057048)*x[2]
        s[1,3]=(-0.592662443082)*x[0]**o+(0.887389713188)*x[0]+(-0.907629711077)*x[1]**o+(0.965433874409)*x[1]+(-0.0179359825534)*x[2]**o+(-0.768070640771)*x[2]
        s[1,4]=(0.0233212032451)*x[0]**o+(-0.0505203178694)*x[0]+(-0.465871409785)*x[1]**o+(-0.437317133846)*x[1]+(0.208545612303)*x[2]**o+(-0.0502465428942)*x[2]
        s[2,0]=(-0.273603162201)*x[0]**o+(0.192745661279)*x[0]+(0.296585107806)*x[1]**o+(0.46173411046)*x[1]+(0.673984995689)*x[2]**o+(-0.88275015509)*x[2]
        s[2,1]=(0.36805707552)*x[0]**o+(-0.33705395449)*x[0]+(0.0140175482223)*x[1]**o+(0.64760814101)*x[1]+(-0.91874701962)*x[2]**o+(0.383318293978)*x[2]
        s[2,2]=(-0.900273344488)*x[0]**o+(0.498842169958)*x[0]+(-0.498406294921)*x[1]**o+(-0.403932835154)*x[1]+(-0.156723389073)*x[2]**o+(0.214962470693)*x[2]
        s[2,3]=(-0.798208224472)*x[0]**o+(-0.746730197648)*x[0]+(-0.397704785717)*x[1]**o+(-0.970985500613)*x[1]+(0.750200448417)*x[2]**o+(0.974572822346)*x[2]
        s[2,4]=(-0.464282027917)*x[0]**o+(-0.754333918275)*x[0]+(0.332816676589)*x[1]**o+(-0.600568600942)*x[1]+(0.188339826223)*x[2]**o+(0.956665673953)*x[2]
        s[3,0]=(0.291526453393)*x[0]**o+(0.259245798805)*x[0]+(0.742708355753)*x[1]**o+(0.21348170853)*x[1]+(-0.983407115555)*x[2]**o+(-0.862966239373)*x[2]
        s[3,1]=(0.874250384958)*x[0]**o+(-0.542706319171)*x[0]+(0.513206274058)*x[1]**o+(-0.493584668769)*x[1]+(-0.990552049402)*x[2]**o+(-0.0611365067488)*x[2]
        s[3,2]=(-0.620092725842)*x[0]**o+(-0.0940854652025)*x[0]+(-0.788220564782)*x[1]**o+(0.952851796216)*x[1]+(-0.102879423616)*x[2]**o+(-0.559035384428)*x[2]
        s[3,3]=(-0.149822264616)*x[0]**o+(-0.113017264993)*x[0]+(-0.472046202247)*x[1]**o+(-0.21062255325)*x[1]+(-0.531066124816)*x[2]**o+(0.307214441703)*x[2]
        s[3,4]=(0.412388911019)*x[0]**o+(-0.0814495987981)*x[0]+(0.176049376352)*x[1]**o+(-0.660623309779)*x[1]+(0.573030010589)*x[2]**o+(-0.671602921264)*x[2]
        ref[0,0]=(-0.325021602041)/(o+1.)+(-0.419488193539)+(-0.910274365459)*0.5**o
        ref[0,1]=(0.264934019963)/(o+1.)+(0.41538729141)+(0.290437327261)*0.5**o
        ref[0,2]=(-0.490727961648)/(o+1.)+(-0.672980694511)+(0.857537342473)*0.5**o
        ref[0,3]=(0.413176596192)/(o+1.)+(0.501783671018)+(0.171520107567)*0.5**o
        ref[0,4]=(0.592828262909)/(o+1.)+(-0.382868139192)+(-0.941363513955)*0.5**o
        ref[1,0]=(1.23372215856)/(o+1.)+(0.108292000526)+(-0.368063286241)*0.5**o
        ref[1,1]=(0.381106450436)/(o+1.)+(0.64427925194)+(0.609862576834)*0.5**o
        ref[1,2]=(0.438438900119)/(o+1.)+(-0.139095868075)+(0.259927679551)*0.5**o
        ref[1,3]=(-0.92556569363)/(o+1.)+(0.542376473413)+(-0.592662443082)*0.5**o
        ref[1,4]=(-0.257325797482)/(o+1.)+(-0.269041997305)+(0.0233212032451)*0.5**o
        ref[2,0]=(0.970570103495)/(o+1.)+(-0.114135191676)+(-0.273603162201)*0.5**o
        ref[2,1]=(-0.904729471398)/(o+1.)+(0.346936240249)+(0.36805707552)*0.5**o
        ref[2,2]=(-0.655129683994)/(o+1.)+(0.154935902749)+(-0.900273344488)*0.5**o
        ref[2,3]=(0.352495662699)/(o+1.)+(-0.371571437957)+(-0.798208224472)*0.5**o
        ref[2,4]=(0.521156502812)/(o+1.)+(-0.199118422633)+(-0.464282027917)*0.5**o
        ref[3,0]=(-0.240698759801)/(o+1.)+(-0.195119366019)+(0.291526453393)*0.5**o
        ref[3,1]=(-0.477345775345)/(o+1.)+(-0.548713747345)+(0.874250384958)*0.5**o
        ref[3,2]=(-0.891099988398)/(o+1.)+(0.149865473293)+(-0.620092725842)*0.5**o
        ref[3,3]=(-1.00311232706)/(o+1.)+(-0.00821268827029)+(-0.149822264616)*0.5**o
        ref[3,4]=(0.749079386941)/(o+1.)+(-0.70683791492)+(0.412388911019)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_FunctionOnContactZero_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.467159870975)*x[0]**o+(-0.231363355451)*x[0]+(-0.522613470003)*x[1]**o+(-0.396872827596)*x[1]
        s[0,0,1]=(0.483392039154)*x[0]**o+(-0.0481934692208)*x[0]+(0.59831432517)*x[1]**o+(0.753587205182)*x[1]
        s[0,1,0]=(-0.642178324261)*x[0]**o+(0.580441968971)*x[0]+(0.19099567725)*x[1]**o+(-0.409684325755)*x[1]
        s[0,1,1]=(-0.963913869717)*x[0]**o+(-0.412074133404)*x[0]+(-0.272818985272)*x[1]**o+(0.187802732278)*x[1]
        s[1,0,0]=(0.377505937225)*x[0]**o+(0.51898033576)*x[0]+(-0.439566585731)*x[1]**o+(-0.998166796948)*x[1]
        s[1,0,1]=(0.389095949557)*x[0]**o+(-0.382477743743)*x[0]+(-0.960850005856)*x[1]**o+(-0.440393846867)*x[1]
        s[1,1,0]=(-0.70296977387)*x[0]**o+(0.315478264729)*x[0]+(-0.867044520578)*x[1]**o+(-0.760970516579)*x[1]
        s[1,1,1]=(0.706189511641)*x[0]**o+(-0.847541758712)*x[0]+(0.814254280461)*x[1]**o+(0.38248389532)*x[1]
        s[2,0,0]=(-0.651567091764)*x[0]**o+(-0.410805007914)*x[0]+(0.0538051169317)*x[1]**o+(0.534010791665)*x[1]
        s[2,0,1]=(0.487085829627)*x[0]**o+(0.774536856681)*x[0]+(-0.873566030375)*x[1]**o+(0.370185957857)*x[1]
        s[2,1,0]=(0.632552547114)*x[0]**o+(0.147565981324)*x[0]+(0.868108695886)*x[1]**o+(0.671762982739)*x[1]
        s[2,1,1]=(-0.259846254622)*x[0]**o+(0.631407506034)*x[0]+(-0.681905081868)*x[1]**o+(0.0452497065686)*x[1]
        s[3,0,0]=(0.057043606868)*x[0]**o+(-0.0902461813963)*x[0]+(-0.240745938715)*x[1]**o+(-0.831861045923)*x[1]
        s[3,0,1]=(0.699648897337)*x[0]**o+(0.640417545224)*x[0]+(-0.430848221186)*x[1]**o+(0.462058652596)*x[1]
        s[3,1,0]=(0.664926292599)*x[0]**o+(-0.891859906903)*x[0]+(0.775280390876)*x[1]**o+(0.614722294397)*x[1]
        s[3,1,1]=(-0.785736689922)*x[0]**o+(0.687423487421)*x[0]+(-0.573349590903)*x[1]**o+(-0.653598711028)*x[1]
        s[4,0,0]=(0.319805468591)*x[0]**o+(0.601962226985)*x[0]+(0.358802389875)*x[1]**o+(-0.468789714036)*x[1]
        s[4,0,1]=(0.975677606412)*x[0]**o+(-0.702436984042)*x[0]+(-0.720390079934)*x[1]**o+(-0.377014128023)*x[1]
        s[4,1,0]=(0.736756275381)*x[0]**o+(-0.257998474493)*x[0]+(0.5991398372)*x[1]**o+(-0.32399683906)*x[1]
        s[4,1,1]=(-0.215912723594)*x[0]**o+(0.326544778825)*x[0]+(-0.620761245415)*x[1]**o+(-0.498174781757)*x[1]
        s[5,0,0]=(-0.601667515189)*x[0]**o+(0.516733915255)*x[0]+(0.183410588351)*x[1]**o+(-0.792386589315)*x[1]
        s[5,0,1]=(-0.561245419581)*x[0]**o+(0.371706636352)*x[0]+(-0.795300794294)*x[1]**o+(0.41047673348)*x[1]
        s[5,1,0]=(0.466316419068)*x[0]**o+(-0.0802419079562)*x[0]+(0.569083019829)*x[1]**o+(-0.20883523199)*x[1]
        s[5,1,1]=(-0.546242876843)*x[0]**o+(-0.499594802846)*x[0]+(-0.945490356092)*x[1]**o+(0.938984415563)*x[1]
        ref[0,0,0]=(-0.522613470003)/(o+1.)+(-0.314118091524)+(0.467159870975)*0.5**o
        ref[0,0,1]=(0.59831432517)/(o+1.)+(0.35269686798)+(0.483392039154)*0.5**o
        ref[0,1,0]=(0.19099567725)/(o+1.)+(0.0853788216078)+(-0.642178324261)*0.5**o
        ref[0,1,1]=(-0.272818985272)/(o+1.)+(-0.112135700563)+(-0.963913869717)*0.5**o
        ref[1,0,0]=(-0.439566585731)/(o+1.)+(-0.239593230594)+(0.377505937225)*0.5**o
        ref[1,0,1]=(-0.960850005856)/(o+1.)+(-0.411435795305)+(0.389095949557)*0.5**o
        ref[1,1,0]=(-0.867044520578)/(o+1.)+(-0.222746125925)+(-0.70296977387)*0.5**o
        ref[1,1,1]=(0.814254280461)/(o+1.)+(-0.232528931696)+(0.706189511641)*0.5**o
        ref[2,0,0]=(0.0538051169317)/(o+1.)+(0.0616028918756)+(-0.651567091764)*0.5**o
        ref[2,0,1]=(-0.873566030375)/(o+1.)+(0.572361407269)+(0.487085829627)*0.5**o
        ref[2,1,0]=(0.868108695886)/(o+1.)+(0.409664482032)+(0.632552547114)*0.5**o
        ref[2,1,1]=(-0.681905081868)/(o+1.)+(0.338328606302)+(-0.259846254622)*0.5**o
        ref[3,0,0]=(-0.240745938715)/(o+1.)+(-0.46105361366)+(0.057043606868)*0.5**o
        ref[3,0,1]=(-0.430848221186)/(o+1.)+(0.55123809891)+(0.699648897337)*0.5**o
        ref[3,1,0]=(0.775280390876)/(o+1.)+(-0.138568806253)+(0.664926292599)*0.5**o
        ref[3,1,1]=(-0.573349590903)/(o+1.)+(0.0169123881966)+(-0.785736689922)*0.5**o
        ref[4,0,0]=(0.358802389875)/(o+1.)+(0.0665862564747)+(0.319805468591)*0.5**o
        ref[4,0,1]=(-0.720390079934)/(o+1.)+(-0.539725556033)+(0.975677606412)*0.5**o
        ref[4,1,0]=(0.5991398372)/(o+1.)+(-0.290997656776)+(0.736756275381)*0.5**o
        ref[4,1,1]=(-0.620761245415)/(o+1.)+(-0.0858150014665)+(-0.215912723594)*0.5**o
        ref[5,0,0]=(0.183410588351)/(o+1.)+(-0.13782633703)+(-0.601667515189)*0.5**o
        ref[5,0,1]=(-0.795300794294)/(o+1.)+(0.391091684916)+(-0.561245419581)*0.5**o
        ref[5,1,0]=(0.569083019829)/(o+1.)+(-0.144538569973)+(0.466316419068)*0.5**o
        ref[5,1,1]=(-0.945490356092)/(o+1.)+(0.219694806358)+(-0.546242876843)*0.5**o
      else:
        s[0,0,0]=(-0.669363049954)*x[0]**o+(0.94445770304)*x[0]+(-0.504461532785)*x[1]**o+(0.636064462988)*x[1]+(0.416245244177)*x[2]**o+(0.666397932744)*x[2]
        s[0,0,1]=(-0.778564625852)*x[0]**o+(-0.825187520549)*x[0]+(0.72174236037)*x[1]**o+(-0.884811347472)*x[1]+(-0.206727051888)*x[2]**o+(0.669175992728)*x[2]
        s[0,1,0]=(0.59083523386)*x[0]**o+(0.264891177321)*x[0]+(0.728529437979)*x[1]**o+(0.689869176288)*x[1]+(0.759759991708)*x[2]**o+(-0.768640416685)*x[2]
        s[0,1,1]=(-0.256994678625)*x[0]**o+(0.151952222597)*x[0]+(-0.615154134713)*x[1]**o+(0.705589259856)*x[1]+(-0.27400110493)*x[2]**o+(-0.042497975508)*x[2]
        s[1,0,0]=(0.577165945348)*x[0]**o+(-0.475277785249)*x[0]+(-0.106826355519)*x[1]**o+(0.0424930134605)*x[1]+(0.680372240013)*x[2]**o+(0.943809871598)*x[2]
        s[1,0,1]=(-0.309232479272)*x[0]**o+(0.195348662283)*x[0]+(0.833914381189)*x[1]**o+(0.262108970555)*x[1]+(-0.716673250709)*x[2]**o+(-0.168478923947)*x[2]
        s[1,1,0]=(-0.275625390067)*x[0]**o+(0.523842393012)*x[0]+(0.437231937115)*x[1]**o+(0.758417244685)*x[1]+(0.826527568677)*x[2]**o+(-0.998749362644)*x[2]
        s[1,1,1]=(0.148292586557)*x[0]**o+(0.405011487356)*x[0]+(0.4599949448)*x[1]**o+(-0.612512744054)*x[1]+(0.187004698026)*x[2]**o+(0.41423737326)*x[2]
        s[2,0,0]=(-0.0683880574768)*x[0]**o+(0.527974031235)*x[0]+(0.761878395348)*x[1]**o+(0.588459184489)*x[1]+(-0.587912848751)*x[2]**o+(0.305103889218)*x[2]
        s[2,0,1]=(0.520929962776)*x[0]**o+(0.33193799149)*x[0]+(-0.342126485854)*x[1]**o+(-0.14865315386)*x[1]+(0.310895900233)*x[2]**o+(-0.322869734717)*x[2]
        s[2,1,0]=(-0.321360677385)*x[0]**o+(0.252389514576)*x[0]+(-0.0393452094196)*x[1]**o+(0.700761849784)*x[1]+(-0.526926106563)*x[2]**o+(0.510264453258)*x[2]
        s[2,1,1]=(-0.417527085289)*x[0]**o+(-0.272942288011)*x[0]+(0.601765245586)*x[1]**o+(-0.790696366296)*x[1]+(-0.012638708702)*x[2]**o+(0.932434350334)*x[2]
        s[3,0,0]=(-0.511516099074)*x[0]**o+(0.41782462791)*x[0]+(0.0995516379245)*x[1]**o+(0.546046499872)*x[1]+(0.874011011955)*x[2]**o+(-0.788555434082)*x[2]
        s[3,0,1]=(0.327526313236)*x[0]**o+(-0.425896436338)*x[0]+(0.914336317958)*x[1]**o+(0.307045278546)*x[1]+(0.72678975804)*x[2]**o+(-0.752188240491)*x[2]
        s[3,1,0]=(0.396685657572)*x[0]**o+(-0.853213412456)*x[0]+(0.592696880548)*x[1]**o+(-0.300028961606)*x[1]+(0.876996858765)*x[2]**o+(-0.0882159006726)*x[2]
        s[3,1,1]=(-0.482121450588)*x[0]**o+(-0.112743359188)*x[0]+(0.328241708104)*x[1]**o+(-0.617997058589)*x[1]+(0.936876537283)*x[2]**o+(0.350080033532)*x[2]
        s[4,0,0]=(-0.200856211954)*x[0]**o+(-0.122991084849)*x[0]+(0.487659949467)*x[1]**o+(-0.425527004923)*x[1]+(-0.147553486772)*x[2]**o+(-0.32641504978)*x[2]
        s[4,0,1]=(0.333642453215)*x[0]**o+(0.954952509878)*x[0]+(-0.291340184543)*x[1]**o+(-0.628839479489)*x[1]+(0.67230688241)*x[2]**o+(0.84754444469)*x[2]
        s[4,1,0]=(0.0708849044002)*x[0]**o+(-0.53553180865)*x[0]+(-0.114931581103)*x[1]**o+(-0.374826425939)*x[1]+(-0.0919922579012)*x[2]**o+(-0.745351276697)*x[2]
        s[4,1,1]=(-0.224313591576)*x[0]**o+(0.329362356625)*x[0]+(-0.60957590052)*x[1]**o+(0.824884117846)*x[1]+(-0.695979917244)*x[2]**o+(-0.279844578235)*x[2]
        s[5,0,0]=(-0.431218311479)*x[0]**o+(0.349200792571)*x[0]+(0.840732425028)*x[1]**o+(-0.484758521346)*x[1]+(0.295545194625)*x[2]**o+(0.47040408229)*x[2]
        s[5,0,1]=(0.506935329965)*x[0]**o+(0.797912921589)*x[0]+(-0.143979832786)*x[1]**o+(-0.660815905482)*x[1]+(0.123849993986)*x[2]**o+(-0.877052796091)*x[2]
        s[5,1,0]=(0.500348066835)*x[0]**o+(-0.455430279521)*x[0]+(-0.569813267302)*x[1]**o+(-0.855668211999)*x[1]+(0.203279416274)*x[2]**o+(-0.112743061503)*x[2]
        s[5,1,1]=(0.993758177333)*x[0]**o+(-0.784317748398)*x[0]+(0.530003336163)*x[1]**o+(-0.857305987154)*x[1]+(0.391887947598)*x[2]**o+(0.933473063729)*x[2]
        ref[0,0,0]=(-0.0882162886075)/(o+1.)+(1.12346004939)+(-0.669363049954)*0.5**o
        ref[0,0,1]=(0.515015308482)/(o+1.)+(-0.520411437647)+(-0.778564625852)*0.5**o
        ref[0,1,0]=(1.48828942969)/(o+1.)+(0.0930599684618)+(0.59083523386)*0.5**o
        ref[0,1,1]=(-0.889155239643)/(o+1.)+(0.407521753473)+(-0.256994678625)*0.5**o
        ref[1,0,0]=(0.573545884494)/(o+1.)+(0.255512549905)+(0.577165945348)*0.5**o
        ref[1,0,1]=(0.11724113048)/(o+1.)+(0.144489354446)+(-0.309232479272)*0.5**o
        ref[1,1,0]=(1.26375950579)/(o+1.)+(0.141755137526)+(-0.275625390067)*0.5**o
        ref[1,1,1]=(0.646999642826)/(o+1.)+(0.103368058281)+(0.148292586557)*0.5**o
        ref[2,0,0]=(0.173965546596)/(o+1.)+(0.710768552471)+(-0.0683880574768)*0.5**o
        ref[2,0,1]=(-0.0312305856211)/(o+1.)+(-0.0697924485433)+(0.520929962776)*0.5**o
        ref[2,1,0]=(-0.566271315982)/(o+1.)+(0.731707908809)+(-0.321360677385)*0.5**o
        ref[2,1,1]=(0.589126536884)/(o+1.)+(-0.0656021519867)+(-0.417527085289)*0.5**o
        ref[3,0,0]=(0.973562649879)/(o+1.)+(0.0876578468496)+(-0.511516099074)*0.5**o
        ref[3,0,1]=(1.641126076)/(o+1.)+(-0.435519699141)+(0.327526313236)*0.5**o
        ref[3,1,0]=(1.46969373931)/(o+1.)+(-0.620729137367)+(0.396685657572)*0.5**o
        ref[3,1,1]=(1.26511824539)/(o+1.)+(-0.190330192122)+(-0.482121450588)*0.5**o
        ref[4,0,0]=(0.340106462695)/(o+1.)+(-0.437466569776)+(-0.200856211954)*0.5**o
        ref[4,0,1]=(0.380966697866)/(o+1.)+(0.586828737539)+(0.333642453215)*0.5**o
        ref[4,1,0]=(-0.206923839004)/(o+1.)+(-0.827854755643)+(0.0708849044002)*0.5**o
        ref[4,1,1]=(-1.30555581776)/(o+1.)+(0.437200948118)+(-0.224313591576)*0.5**o
        ref[5,0,0]=(1.13627761965)/(o+1.)+(0.167423176757)+(-0.431218311479)*0.5**o
        ref[5,0,1]=(-0.0201298387998)/(o+1.)+(-0.369977889992)+(0.506935329965)*0.5**o
        ref[5,1,0]=(-0.366533851028)/(o+1.)+(-0.711920776511)+(0.500348066835)*0.5**o
        ref[5,1,1]=(0.921891283761)/(o+1.)+(-0.354075335912)+(0.993758177333)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactZero_fromSymbol_FunctionOnContactZero_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactZero

      assumptions: FunctionOnContactZero(self.domain) exists
                   self.domain supports integral on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      w=FunctionOnContactZero(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.135767714785)*x[0]**o+(0.602721853735)*x[0]+(0.685908691403)*x[1]**o+(-0.278963806046)*x[1]
        s[0,0,0,1]=(0.548074276718)*x[0]**o+(-0.00153460595028)*x[0]+(0.964032895202)*x[1]**o+(0.145345601288)*x[1]
        s[0,0,1,0]=(0.00388957848949)*x[0]**o+(-0.00330645752363)*x[0]+(-0.398340925709)*x[1]**o+(0.544904812736)*x[1]
        s[0,0,1,1]=(0.896772134786)*x[0]**o+(-0.305756341328)*x[0]+(0.766835159085)*x[1]**o+(-0.185065752039)*x[1]
        s[0,0,2,0]=(0.455765211649)*x[0]**o+(-0.172084793069)*x[0]+(-0.745694059134)*x[1]**o+(0.467137037155)*x[1]
        s[0,0,2,1]=(-0.683685778458)*x[0]**o+(-0.526137358848)*x[0]+(0.499311653339)*x[1]**o+(-0.810057930627)*x[1]
        s[0,1,0,0]=(0.244426126288)*x[0]**o+(0.464096329887)*x[0]+(-0.565273192791)*x[1]**o+(0.341584391362)*x[1]
        s[0,1,0,1]=(-0.0873578866485)*x[0]**o+(-0.280704680398)*x[0]+(0.0551381505624)*x[1]**o+(0.224333075687)*x[1]
        s[0,1,1,0]=(0.0886184124686)*x[0]**o+(-0.577421322103)*x[0]+(-0.784267376644)*x[1]**o+(-0.220754022299)*x[1]
        s[0,1,1,1]=(-0.901203063708)*x[0]**o+(-0.791637322168)*x[0]+(-0.615643115793)*x[1]**o+(-0.0955674319946)*x[1]
        s[0,1,2,0]=(0.418411748143)*x[0]**o+(0.0825948292296)*x[0]+(0.00527147896827)*x[1]**o+(0.474507057947)*x[1]
        s[0,1,2,1]=(0.574446727172)*x[0]**o+(0.634382868948)*x[0]+(-0.8192829244)*x[1]**o+(0.0916815679535)*x[1]
        s[0,2,0,0]=(-0.324743695914)*x[0]**o+(-0.517660802435)*x[0]+(-0.694637110589)*x[1]**o+(-0.191013585315)*x[1]
        s[0,2,0,1]=(0.538239581284)*x[0]**o+(-0.793537232228)*x[0]+(-0.260263189341)*x[1]**o+(-0.232999585659)*x[1]
        s[0,2,1,0]=(-0.535444326182)*x[0]**o+(0.375771246892)*x[0]+(-0.351338268294)*x[1]**o+(-0.922383156347)*x[1]
        s[0,2,1,1]=(-0.754984712928)*x[0]**o+(0.844268402619)*x[0]+(-0.373848162528)*x[1]**o+(-0.0348415758383)*x[1]
        s[0,2,2,0]=(0.101157816757)*x[0]**o+(0.322178434764)*x[0]+(0.309106041559)*x[1]**o+(-0.720194799504)*x[1]
        s[0,2,2,1]=(-0.537633855745)*x[0]**o+(-0.149185820274)*x[0]+(-0.155113200571)*x[1]**o+(0.433800441998)*x[1]
        s[0,3,0,0]=(0.466579973711)*x[0]**o+(-0.924681979368)*x[0]+(0.491019303223)*x[1]**o+(0.994389212618)*x[1]
        s[0,3,0,1]=(0.202651138329)*x[0]**o+(0.114061296405)*x[0]+(-0.660374384585)*x[1]**o+(0.192752003014)*x[1]
        s[0,3,1,0]=(0.442171269159)*x[0]**o+(-0.0740165829499)*x[0]+(-0.952344452735)*x[1]**o+(0.734456419975)*x[1]
        s[0,3,1,1]=(0.733989617351)*x[0]**o+(0.157469674236)*x[0]+(-0.305478230795)*x[1]**o+(-0.416091191381)*x[1]
        s[0,3,2,0]=(-0.709003057494)*x[0]**o+(-0.554321605532)*x[0]+(-0.374724207394)*x[1]**o+(-0.799384819999)*x[1]
        s[0,3,2,1]=(-0.125623348142)*x[0]**o+(-0.695830039564)*x[0]+(0.0283773197868)*x[1]**o+(-0.459458049105)*x[1]
        s[0,4,0,0]=(0.490207583728)*x[0]**o+(0.302026020799)*x[0]+(0.582676151383)*x[1]**o+(-0.540047416714)*x[1]
        s[0,4,0,1]=(-0.605187460486)*x[0]**o+(-0.700102630541)*x[0]+(0.576928080618)*x[1]**o+(-0.753735278462)*x[1]
        s[0,4,1,0]=(-0.0850932164524)*x[0]**o+(-0.132436670102)*x[0]+(0.634879197271)*x[1]**o+(-0.40759333575)*x[1]
        s[0,4,1,1]=(0.258713682268)*x[0]**o+(0.941275860044)*x[0]+(-0.976313171743)*x[1]**o+(-0.817915320276)*x[1]
        s[0,4,2,0]=(-0.350506879421)*x[0]**o+(-0.935416620637)*x[0]+(0.153793647237)*x[1]**o+(0.384520330312)*x[1]
        s[0,4,2,1]=(0.671395932648)*x[0]**o+(-0.338473533885)*x[0]+(-0.769374193622)*x[1]**o+(-0.0867650576614)*x[1]
        s[1,0,0,0]=(0.188023378319)*x[0]**o+(0.662970173794)*x[0]+(0.307120506561)*x[1]**o+(-0.561302563336)*x[1]
        s[1,0,0,1]=(0.800293252159)*x[0]**o+(0.414126518273)*x[0]+(-0.411140279426)*x[1]**o+(-0.726050617156)*x[1]
        s[1,0,1,0]=(-0.515339883608)*x[0]**o+(-0.849896429803)*x[0]+(-0.404819325345)*x[1]**o+(-0.660381411211)*x[1]
        s[1,0,1,1]=(0.0512515899156)*x[0]**o+(-0.59411151972)*x[0]+(-0.586954384255)*x[1]**o+(-0.581246213363)*x[1]
        s[1,0,2,0]=(-0.581670807515)*x[0]**o+(-0.151580006917)*x[0]+(0.166288186202)*x[1]**o+(-0.90507298782)*x[1]
        s[1,0,2,1]=(-0.634327645938)*x[0]**o+(0.227054101481)*x[0]+(-0.698802363494)*x[1]**o+(-0.191787378024)*x[1]
        s[1,1,0,0]=(0.434696675884)*x[0]**o+(0.550165686473)*x[0]+(-0.381545673134)*x[1]**o+(0.0353703778505)*x[1]
        s[1,1,0,1]=(0.438065102364)*x[0]**o+(0.734419538756)*x[0]+(-0.654368291721)*x[1]**o+(-0.288248589993)*x[1]
        s[1,1,1,0]=(0.812437488024)*x[0]**o+(0.105098628605)*x[0]+(0.670405216194)*x[1]**o+(-0.932828342978)*x[1]
        s[1,1,1,1]=(0.52676928941)*x[0]**o+(0.34803390652)*x[0]+(0.0351984047833)*x[1]**o+(0.410003399979)*x[1]
        s[1,1,2,0]=(-0.0967009361026)*x[0]**o+(0.164660384961)*x[0]+(0.210182888846)*x[1]**o+(0.522971695817)*x[1]
        s[1,1,2,1]=(-0.664016192839)*x[0]**o+(0.452428778809)*x[0]+(-0.107282780635)*x[1]**o+(0.807095090624)*x[1]
        s[1,2,0,0]=(-0.289167783943)*x[0]**o+(0.667637278664)*x[0]+(0.615088613098)*x[1]**o+(-0.771365681637)*x[1]
        s[1,2,0,1]=(0.554991016918)*x[0]**o+(-0.0658224324202)*x[0]+(0.305877722926)*x[1]**o+(-0.410754491717)*x[1]
        s[1,2,1,0]=(0.131109587703)*x[0]**o+(-0.589856526298)*x[0]+(-0.457418380817)*x[1]**o+(-0.766026536542)*x[1]
        s[1,2,1,1]=(-0.339196055896)*x[0]**o+(0.0879106255633)*x[0]+(-0.300776404484)*x[1]**o+(-0.855785910082)*x[1]
        s[1,2,2,0]=(0.169433038681)*x[0]**o+(0.900452320033)*x[0]+(-0.515800574208)*x[1]**o+(0.0353282676014)*x[1]
        s[1,2,2,1]=(0.120477320496)*x[0]**o+(0.544656714229)*x[0]+(0.712210191539)*x[1]**o+(-0.835300413971)*x[1]
        s[1,3,0,0]=(-0.144180890917)*x[0]**o+(0.847389690669)*x[0]+(0.21796553543)*x[1]**o+(0.0580182644011)*x[1]
        s[1,3,0,1]=(0.0202759559404)*x[0]**o+(-0.832118697631)*x[0]+(0.860042691805)*x[1]**o+(0.954802209319)*x[1]
        s[1,3,1,0]=(-0.232327132843)*x[0]**o+(0.988485328327)*x[0]+(-0.941830133542)*x[1]**o+(0.796919796173)*x[1]
        s[1,3,1,1]=(-0.0528857772705)*x[0]**o+(0.24536410605)*x[0]+(-0.89565411974)*x[1]**o+(0.473315809996)*x[1]
        s[1,3,2,0]=(0.920179439848)*x[0]**o+(0.415154298944)*x[0]+(0.690915792422)*x[1]**o+(0.0956157306525)*x[1]
        s[1,3,2,1]=(-0.332235130954)*x[0]**o+(0.756254925963)*x[0]+(0.936945508353)*x[1]**o+(0.56286108057)*x[1]
        s[1,4,0,0]=(0.802947524473)*x[0]**o+(0.764953990189)*x[0]+(0.58992910698)*x[1]**o+(0.807094950185)*x[1]
        s[1,4,0,1]=(-0.309951166637)*x[0]**o+(-0.605960228686)*x[0]+(0.0223945031407)*x[1]**o+(-0.230764354345)*x[1]
        s[1,4,1,0]=(0.856801428802)*x[0]**o+(0.748897933626)*x[0]+(0.0648717388846)*x[1]**o+(-0.197803227055)*x[1]
        s[1,4,1,1]=(0.160470457446)*x[0]**o+(0.466029696285)*x[0]+(-0.808841434426)*x[1]**o+(-0.890661270209)*x[1]
        s[1,4,2,0]=(0.316160329076)*x[0]**o+(-0.616711166445)*x[0]+(0.176082750216)*x[1]**o+(-0.389156386122)*x[1]
        s[1,4,2,1]=(0.966674586588)*x[0]**o+(0.743418831809)*x[0]+(0.828814302078)*x[1]**o+(0.443124030799)*x[1]
        s[2,0,0,0]=(0.895605391818)*x[0]**o+(-0.712359772806)*x[0]+(-0.254420890563)*x[1]**o+(0.04060068125)*x[1]
        s[2,0,0,1]=(0.407669194399)*x[0]**o+(-0.561911820032)*x[0]+(0.759519426562)*x[1]**o+(-0.791065777521)*x[1]
        s[2,0,1,0]=(0.0220907964237)*x[0]**o+(0.764347460016)*x[0]+(-0.894211196035)*x[1]**o+(-0.766734523336)*x[1]
        s[2,0,1,1]=(0.276708235973)*x[0]**o+(0.902519459875)*x[0]+(0.957736485845)*x[1]**o+(0.861836071217)*x[1]
        s[2,0,2,0]=(0.209485180668)*x[0]**o+(0.463649158628)*x[0]+(-0.0521057130471)*x[1]**o+(-0.64350767543)*x[1]
        s[2,0,2,1]=(-0.605362744895)*x[0]**o+(-0.131055561812)*x[0]+(-0.0963734475683)*x[1]**o+(0.38191997821)*x[1]
        s[2,1,0,0]=(0.242435009983)*x[0]**o+(-0.0678120221956)*x[0]+(-0.981711153358)*x[1]**o+(0.799273232234)*x[1]
        s[2,1,0,1]=(-0.178432239175)*x[0]**o+(-0.895623369837)*x[0]+(-0.572639180822)*x[1]**o+(-0.83834422153)*x[1]
        s[2,1,1,0]=(0.993103298694)*x[0]**o+(0.728567708683)*x[0]+(-0.799812986792)*x[1]**o+(-0.057428598921)*x[1]
        s[2,1,1,1]=(-0.776745418541)*x[0]**o+(-0.338983048206)*x[0]+(-0.565511785334)*x[1]**o+(-0.308717365714)*x[1]
        s[2,1,2,0]=(-0.199225286482)*x[0]**o+(-0.158190421122)*x[0]+(0.150112974223)*x[1]**o+(0.954346438264)*x[1]
        s[2,1,2,1]=(-0.402303812441)*x[0]**o+(-0.874974485349)*x[0]+(0.680761341229)*x[1]**o+(-0.694296934266)*x[1]
        s[2,2,0,0]=(0.0582479020766)*x[0]**o+(-0.562861368267)*x[0]+(0.757525601337)*x[1]**o+(0.932167579204)*x[1]
        s[2,2,0,1]=(-0.379424441757)*x[0]**o+(0.177098262781)*x[0]+(-0.485467998718)*x[1]**o+(-0.17324576024)*x[1]
        s[2,2,1,0]=(-0.339388895182)*x[0]**o+(0.491140214169)*x[0]+(0.471276867115)*x[1]**o+(0.292216420243)*x[1]
        s[2,2,1,1]=(0.502027084477)*x[0]**o+(0.927860130016)*x[0]+(0.787575747782)*x[1]**o+(-0.470519713839)*x[1]
        s[2,2,2,0]=(-0.583469643173)*x[0]**o+(-0.765710060231)*x[0]+(-0.54135991724)*x[1]**o+(0.665415514934)*x[1]
        s[2,2,2,1]=(-0.472362804158)*x[0]**o+(-0.766567819149)*x[0]+(0.201380986075)*x[1]**o+(0.270890088749)*x[1]
        s[2,3,0,0]=(-0.547838738364)*x[0]**o+(0.373177565132)*x[0]+(-0.921379470525)*x[1]**o+(0.0837731390271)*x[1]
        s[2,3,0,1]=(-0.557990737044)*x[0]**o+(-0.561311443234)*x[0]+(-0.924235646481)*x[1]**o+(-0.746081692868)*x[1]
        s[2,3,1,0]=(0.566861818147)*x[0]**o+(-0.107222369398)*x[0]+(-0.53810139661)*x[1]**o+(-0.814508288518)*x[1]
        s[2,3,1,1]=(-0.0578464759524)*x[0]**o+(0.525704186493)*x[0]+(0.434855750568)*x[1]**o+(-0.761515114625)*x[1]
        s[2,3,2,0]=(0.388204865306)*x[0]**o+(-0.320298614451)*x[0]+(0.0228508430597)*x[1]**o+(-0.436245057461)*x[1]
        s[2,3,2,1]=(0.70625829226)*x[0]**o+(-0.459381956838)*x[0]+(-0.756416817999)*x[1]**o+(0.963958503587)*x[1]
        s[2,4,0,0]=(0.595101935764)*x[0]**o+(0.0182198304835)*x[0]+(0.389172632633)*x[1]**o+(0.571052531257)*x[1]
        s[2,4,0,1]=(-0.59261552462)*x[0]**o+(0.176171578479)*x[0]+(-0.481303115308)*x[1]**o+(0.476762838828)*x[1]
        s[2,4,1,0]=(-0.274360684371)*x[0]**o+(0.496939161979)*x[0]+(0.0982270602491)*x[1]**o+(0.0521672721299)*x[1]
        s[2,4,1,1]=(0.0022428239189)*x[0]**o+(-0.926985821019)*x[0]+(0.0530228030052)*x[1]**o+(0.403935928384)*x[1]
        s[2,4,2,0]=(-0.96226874392)*x[0]**o+(0.282033354362)*x[0]+(0.917864727482)*x[1]**o+(0.32541112383)*x[1]
        s[2,4,2,1]=(0.684506236166)*x[0]**o+(0.215015538573)*x[0]+(0.74280905237)*x[1]**o+(0.781203116718)*x[1]
        s[3,0,0,0]=(0.658782504284)*x[0]**o+(0.396806335664)*x[0]+(0.0780367521917)*x[1]**o+(0.533907837354)*x[1]
        s[3,0,0,1]=(0.386822554052)*x[0]**o+(-0.951475963073)*x[0]+(0.992735332775)*x[1]**o+(-0.158295718477)*x[1]
        s[3,0,1,0]=(-0.253862856162)*x[0]**o+(-0.0131419224769)*x[0]+(0.810452271623)*x[1]**o+(-0.116490242053)*x[1]
        s[3,0,1,1]=(-0.297107568873)*x[0]**o+(0.339277467727)*x[0]+(-0.0455924137238)*x[1]**o+(0.408214745405)*x[1]
        s[3,0,2,0]=(0.101103302929)*x[0]**o+(0.84974169826)*x[0]+(0.668273722779)*x[1]**o+(-0.134494535453)*x[1]
        s[3,0,2,1]=(0.144907392006)*x[0]**o+(0.59561768643)*x[0]+(0.808003987088)*x[1]**o+(0.442993444756)*x[1]
        s[3,1,0,0]=(0.050719218416)*x[0]**o+(-0.205363570154)*x[0]+(-0.267767797056)*x[1]**o+(0.473617859576)*x[1]
        s[3,1,0,1]=(-0.488804469299)*x[0]**o+(-0.108366154443)*x[0]+(0.754051956614)*x[1]**o+(0.601979535209)*x[1]
        s[3,1,1,0]=(0.665579804971)*x[0]**o+(-0.820977378045)*x[0]+(-0.99768277192)*x[1]**o+(-0.553278556669)*x[1]
        s[3,1,1,1]=(0.28421003692)*x[0]**o+(0.34932169662)*x[0]+(-0.942736776261)*x[1]**o+(-0.761313236403)*x[1]
        s[3,1,2,0]=(-0.271033791176)*x[0]**o+(-0.269316831976)*x[0]+(0.637503921768)*x[1]**o+(0.550986595411)*x[1]
        s[3,1,2,1]=(-0.314094366001)*x[0]**o+(0.771643852473)*x[0]+(-0.370702666003)*x[1]**o+(0.925989724825)*x[1]
        s[3,2,0,0]=(0.608693141558)*x[0]**o+(-0.865838490365)*x[0]+(0.390277717008)*x[1]**o+(0.651999980469)*x[1]
        s[3,2,0,1]=(-0.911099837761)*x[0]**o+(0.307504460716)*x[0]+(0.82234563191)*x[1]**o+(-0.565850042096)*x[1]
        s[3,2,1,0]=(-0.876634035391)*x[0]**o+(0.410910752799)*x[0]+(-0.578952272394)*x[1]**o+(0.204714780618)*x[1]
        s[3,2,1,1]=(0.06295832442)*x[0]**o+(0.441355368057)*x[0]+(0.767590856273)*x[1]**o+(-0.67580811237)*x[1]
        s[3,2,2,0]=(-0.186380273058)*x[0]**o+(-0.891590560039)*x[0]+(-0.957486087526)*x[1]**o+(0.198598656166)*x[1]
        s[3,2,2,1]=(-0.733041869578)*x[0]**o+(-0.369283091906)*x[0]+(-0.103339143054)*x[1]**o+(-0.5468960827)*x[1]
        s[3,3,0,0]=(0.381695999815)*x[0]**o+(-0.398360040383)*x[0]+(-0.00816783658019)*x[1]**o+(0.209734829036)*x[1]
        s[3,3,0,1]=(-0.458999917243)*x[0]**o+(0.693814798148)*x[0]+(0.988023235161)*x[1]**o+(0.249848645187)*x[1]
        s[3,3,1,0]=(0.35272081264)*x[0]**o+(-0.24196842916)*x[0]+(-0.376576617413)*x[1]**o+(-0.512660897623)*x[1]
        s[3,3,1,1]=(-0.880579928879)*x[0]**o+(-0.901266101944)*x[0]+(-0.6695966178)*x[1]**o+(0.81462165322)*x[1]
        s[3,3,2,0]=(0.179006063683)*x[0]**o+(-0.772199368214)*x[0]+(0.173717958996)*x[1]**o+(0.943451083071)*x[1]
        s[3,3,2,1]=(0.772059778005)*x[0]**o+(-0.816863867151)*x[0]+(0.931619586753)*x[1]**o+(0.618296473051)*x[1]
        s[3,4,0,0]=(0.609550545616)*x[0]**o+(-0.226822163333)*x[0]+(0.498238525714)*x[1]**o+(0.145755694026)*x[1]
        s[3,4,0,1]=(0.925097562117)*x[0]**o+(0.793877528837)*x[0]+(0.483353477991)*x[1]**o+(-0.547313214969)*x[1]
        s[3,4,1,0]=(-0.878072917122)*x[0]**o+(0.703236130488)*x[0]+(-0.511134933342)*x[1]**o+(0.676303306122)*x[1]
        s[3,4,1,1]=(0.0745582123775)*x[0]**o+(0.668129797141)*x[0]+(-0.493968471165)*x[1]**o+(-0.26653808146)*x[1]
        s[3,4,2,0]=(-0.736620884918)*x[0]**o+(0.0401872117)*x[0]+(-0.312111305637)*x[1]**o+(0.811490469583)*x[1]
        s[3,4,2,1]=(-0.663426736678)*x[0]**o+(-0.630806839416)*x[0]+(0.638515711599)*x[1]**o+(-0.386941335499)*x[1]
        ref[0,0,0,0]=(0.685908691403)/(o+1.)+(0.161879023844)+(-0.135767714785)*0.5**o
        ref[0,0,0,1]=(0.964032895202)/(o+1.)+(0.071905497669)+(0.548074276718)*0.5**o
        ref[0,0,1,0]=(-0.398340925709)/(o+1.)+(0.270799177606)+(0.00388957848949)*0.5**o
        ref[0,0,1,1]=(0.766835159085)/(o+1.)+(-0.245411046684)+(0.896772134786)*0.5**o
        ref[0,0,2,0]=(-0.745694059134)/(o+1.)+(0.147526122043)+(0.455765211649)*0.5**o
        ref[0,0,2,1]=(0.499311653339)/(o+1.)+(-0.668097644737)+(-0.683685778458)*0.5**o
        ref[0,1,0,0]=(-0.565273192791)/(o+1.)+(0.402840360625)+(0.244426126288)*0.5**o
        ref[0,1,0,1]=(0.0551381505624)/(o+1.)+(-0.0281858023555)+(-0.0873578866485)*0.5**o
        ref[0,1,1,0]=(-0.784267376644)/(o+1.)+(-0.399087672201)+(0.0886184124686)*0.5**o
        ref[0,1,1,1]=(-0.615643115793)/(o+1.)+(-0.443602377081)+(-0.901203063708)*0.5**o
        ref[0,1,2,0]=(0.00527147896827)/(o+1.)+(0.278550943588)+(0.418411748143)*0.5**o
        ref[0,1,2,1]=(-0.8192829244)/(o+1.)+(0.363032218451)+(0.574446727172)*0.5**o
        ref[0,2,0,0]=(-0.694637110589)/(o+1.)+(-0.354337193875)+(-0.324743695914)*0.5**o
        ref[0,2,0,1]=(-0.260263189341)/(o+1.)+(-0.513268408944)+(0.538239581284)*0.5**o
        ref[0,2,1,0]=(-0.351338268294)/(o+1.)+(-0.273305954728)+(-0.535444326182)*0.5**o
        ref[0,2,1,1]=(-0.373848162528)/(o+1.)+(0.40471341339)+(-0.754984712928)*0.5**o
        ref[0,2,2,0]=(0.309106041559)/(o+1.)+(-0.19900818237)+(0.101157816757)*0.5**o
        ref[0,2,2,1]=(-0.155113200571)/(o+1.)+(0.142307310862)+(-0.537633855745)*0.5**o
        ref[0,3,0,0]=(0.491019303223)/(o+1.)+(0.0348536166248)+(0.466579973711)*0.5**o
        ref[0,3,0,1]=(-0.660374384585)/(o+1.)+(0.153406649709)+(0.202651138329)*0.5**o
        ref[0,3,1,0]=(-0.952344452735)/(o+1.)+(0.330219918513)+(0.442171269159)*0.5**o
        ref[0,3,1,1]=(-0.305478230795)/(o+1.)+(-0.129310758573)+(0.733989617351)*0.5**o
        ref[0,3,2,0]=(-0.374724207394)/(o+1.)+(-0.676853212765)+(-0.709003057494)*0.5**o
        ref[0,3,2,1]=(0.0283773197868)/(o+1.)+(-0.577644044334)+(-0.125623348142)*0.5**o
        ref[0,4,0,0]=(0.582676151383)/(o+1.)+(-0.119010697958)+(0.490207583728)*0.5**o
        ref[0,4,0,1]=(0.576928080618)/(o+1.)+(-0.726918954502)+(-0.605187460486)*0.5**o
        ref[0,4,1,0]=(0.634879197271)/(o+1.)+(-0.270015002926)+(-0.0850932164524)*0.5**o
        ref[0,4,1,1]=(-0.976313171743)/(o+1.)+(0.061680269884)+(0.258713682268)*0.5**o
        ref[0,4,2,0]=(0.153793647237)/(o+1.)+(-0.275448145163)+(-0.350506879421)*0.5**o
        ref[0,4,2,1]=(-0.769374193622)/(o+1.)+(-0.212619295773)+(0.671395932648)*0.5**o
        ref[1,0,0,0]=(0.307120506561)/(o+1.)+(0.0508338052288)+(0.188023378319)*0.5**o
        ref[1,0,0,1]=(-0.411140279426)/(o+1.)+(-0.155962049441)+(0.800293252159)*0.5**o
        ref[1,0,1,0]=(-0.404819325345)/(o+1.)+(-0.755138920507)+(-0.515339883608)*0.5**o
        ref[1,0,1,1]=(-0.586954384255)/(o+1.)+(-0.587678866541)+(0.0512515899156)*0.5**o
        ref[1,0,2,0]=(0.166288186202)/(o+1.)+(-0.528326497368)+(-0.581670807515)*0.5**o
        ref[1,0,2,1]=(-0.698802363494)/(o+1.)+(0.0176333617287)+(-0.634327645938)*0.5**o
        ref[1,1,0,0]=(-0.381545673134)/(o+1.)+(0.292768032162)+(0.434696675884)*0.5**o
        ref[1,1,0,1]=(-0.654368291721)/(o+1.)+(0.223085474382)+(0.438065102364)*0.5**o
        ref[1,1,1,0]=(0.670405216194)/(o+1.)+(-0.413864857186)+(0.812437488024)*0.5**o
        ref[1,1,1,1]=(0.0351984047833)/(o+1.)+(0.379018653249)+(0.52676928941)*0.5**o
        ref[1,1,2,0]=(0.210182888846)/(o+1.)+(0.343816040389)+(-0.0967009361026)*0.5**o
        ref[1,1,2,1]=(-0.107282780635)/(o+1.)+(0.629761934716)+(-0.664016192839)*0.5**o
        ref[1,2,0,0]=(0.615088613098)/(o+1.)+(-0.0518642014867)+(-0.289167783943)*0.5**o
        ref[1,2,0,1]=(0.305877722926)/(o+1.)+(-0.238288462068)+(0.554991016918)*0.5**o
        ref[1,2,1,0]=(-0.457418380817)/(o+1.)+(-0.67794153142)+(0.131109587703)*0.5**o
        ref[1,2,1,1]=(-0.300776404484)/(o+1.)+(-0.38393764226)+(-0.339196055896)*0.5**o
        ref[1,2,2,0]=(-0.515800574208)/(o+1.)+(0.467890293817)+(0.169433038681)*0.5**o
        ref[1,2,2,1]=(0.712210191539)/(o+1.)+(-0.145321849871)+(0.120477320496)*0.5**o
        ref[1,3,0,0]=(0.21796553543)/(o+1.)+(0.452703977535)+(-0.144180890917)*0.5**o
        ref[1,3,0,1]=(0.860042691805)/(o+1.)+(0.0613417558442)+(0.0202759559404)*0.5**o
        ref[1,3,1,0]=(-0.941830133542)/(o+1.)+(0.89270256225)+(-0.232327132843)*0.5**o
        ref[1,3,1,1]=(-0.89565411974)/(o+1.)+(0.359339958023)+(-0.0528857772705)*0.5**o
        ref[1,3,2,0]=(0.690915792422)/(o+1.)+(0.255385014798)+(0.920179439848)*0.5**o
        ref[1,3,2,1]=(0.936945508353)/(o+1.)+(0.659558003266)+(-0.332235130954)*0.5**o
        ref[1,4,0,0]=(0.58992910698)/(o+1.)+(0.786024470187)+(0.802947524473)*0.5**o
        ref[1,4,0,1]=(0.0223945031407)/(o+1.)+(-0.418362291515)+(-0.309951166637)*0.5**o
        ref[1,4,1,0]=(0.0648717388846)/(o+1.)+(0.275547353285)+(0.856801428802)*0.5**o
        ref[1,4,1,1]=(-0.808841434426)/(o+1.)+(-0.212315786962)+(0.160470457446)*0.5**o
        ref[1,4,2,0]=(0.176082750216)/(o+1.)+(-0.502933776283)+(0.316160329076)*0.5**o
        ref[1,4,2,1]=(0.828814302078)/(o+1.)+(0.593271431304)+(0.966674586588)*0.5**o
        ref[2,0,0,0]=(-0.254420890563)/(o+1.)+(-0.335879545778)+(0.895605391818)*0.5**o
        ref[2,0,0,1]=(0.759519426562)/(o+1.)+(-0.676488798776)+(0.407669194399)*0.5**o
        ref[2,0,1,0]=(-0.894211196035)/(o+1.)+(-0.00119353166009)+(0.0220907964237)*0.5**o
        ref[2,0,1,1]=(0.957736485845)/(o+1.)+(0.882177765546)+(0.276708235973)*0.5**o
        ref[2,0,2,0]=(-0.0521057130471)/(o+1.)+(-0.0899292584008)+(0.209485180668)*0.5**o
        ref[2,0,2,1]=(-0.0963734475683)/(o+1.)+(0.125432208199)+(-0.605362744895)*0.5**o
        ref[2,1,0,0]=(-0.981711153358)/(o+1.)+(0.365730605019)+(0.242435009983)*0.5**o
        ref[2,1,0,1]=(-0.572639180822)/(o+1.)+(-0.866983795684)+(-0.178432239175)*0.5**o
        ref[2,1,1,0]=(-0.799812986792)/(o+1.)+(0.335569554881)+(0.993103298694)*0.5**o
        ref[2,1,1,1]=(-0.565511785334)/(o+1.)+(-0.32385020696)+(-0.776745418541)*0.5**o
        ref[2,1,2,0]=(0.150112974223)/(o+1.)+(0.398078008571)+(-0.199225286482)*0.5**o
        ref[2,1,2,1]=(0.680761341229)/(o+1.)+(-0.784635709807)+(-0.402303812441)*0.5**o
        ref[2,2,0,0]=(0.757525601337)/(o+1.)+(0.184653105468)+(0.0582479020766)*0.5**o
        ref[2,2,0,1]=(-0.485467998718)/(o+1.)+(0.00192625127016)+(-0.379424441757)*0.5**o
        ref[2,2,1,0]=(0.471276867115)/(o+1.)+(0.391678317206)+(-0.339388895182)*0.5**o
        ref[2,2,1,1]=(0.787575747782)/(o+1.)+(0.228670208089)+(0.502027084477)*0.5**o
        ref[2,2,2,0]=(-0.54135991724)/(o+1.)+(-0.0501472726484)+(-0.583469643173)*0.5**o
        ref[2,2,2,1]=(0.201380986075)/(o+1.)+(-0.2478388652)+(-0.472362804158)*0.5**o
        ref[2,3,0,0]=(-0.921379470525)/(o+1.)+(0.228475352079)+(-0.547838738364)*0.5**o
        ref[2,3,0,1]=(-0.924235646481)/(o+1.)+(-0.653696568051)+(-0.557990737044)*0.5**o
        ref[2,3,1,0]=(-0.53810139661)/(o+1.)+(-0.460865328958)+(0.566861818147)*0.5**o
        ref[2,3,1,1]=(0.434855750568)/(o+1.)+(-0.117905464066)+(-0.0578464759524)*0.5**o
        ref[2,3,2,0]=(0.0228508430597)/(o+1.)+(-0.378271835956)+(0.388204865306)*0.5**o
        ref[2,3,2,1]=(-0.756416817999)/(o+1.)+(0.252288273374)+(0.70625829226)*0.5**o
        ref[2,4,0,0]=(0.389172632633)/(o+1.)+(0.29463618087)+(0.595101935764)*0.5**o
        ref[2,4,0,1]=(-0.481303115308)/(o+1.)+(0.326467208654)+(-0.59261552462)*0.5**o
        ref[2,4,1,0]=(0.0982270602491)/(o+1.)+(0.274553217055)+(-0.274360684371)*0.5**o
        ref[2,4,1,1]=(0.0530228030052)/(o+1.)+(-0.261524946318)+(0.0022428239189)*0.5**o
        ref[2,4,2,0]=(0.917864727482)/(o+1.)+(0.303722239096)+(-0.96226874392)*0.5**o
        ref[2,4,2,1]=(0.74280905237)/(o+1.)+(0.498109327645)+(0.684506236166)*0.5**o
        ref[3,0,0,0]=(0.0780367521917)/(o+1.)+(0.465357086509)+(0.658782504284)*0.5**o
        ref[3,0,0,1]=(0.992735332775)/(o+1.)+(-0.554885840775)+(0.386822554052)*0.5**o
        ref[3,0,1,0]=(0.810452271623)/(o+1.)+(-0.0648160822652)+(-0.253862856162)*0.5**o
        ref[3,0,1,1]=(-0.0455924137238)/(o+1.)+(0.373746106566)+(-0.297107568873)*0.5**o
        ref[3,0,2,0]=(0.668273722779)/(o+1.)+(0.357623581403)+(0.101103302929)*0.5**o
        ref[3,0,2,1]=(0.808003987088)/(o+1.)+(0.519305565593)+(0.144907392006)*0.5**o
        ref[3,1,0,0]=(-0.267767797056)/(o+1.)+(0.134127144711)+(0.050719218416)*0.5**o
        ref[3,1,0,1]=(0.754051956614)/(o+1.)+(0.246806690383)+(-0.488804469299)*0.5**o
        ref[3,1,1,0]=(-0.99768277192)/(o+1.)+(-0.687127967357)+(0.665579804971)*0.5**o
        ref[3,1,1,1]=(-0.942736776261)/(o+1.)+(-0.205995769892)+(0.28421003692)*0.5**o
        ref[3,1,2,0]=(0.637503921768)/(o+1.)+(0.140834881718)+(-0.271033791176)*0.5**o
        ref[3,1,2,1]=(-0.370702666003)/(o+1.)+(0.848816788649)+(-0.314094366001)*0.5**o
        ref[3,2,0,0]=(0.390277717008)/(o+1.)+(-0.106919254948)+(0.608693141558)*0.5**o
        ref[3,2,0,1]=(0.82234563191)/(o+1.)+(-0.12917279069)+(-0.911099837761)*0.5**o
        ref[3,2,1,0]=(-0.578952272394)/(o+1.)+(0.307812766709)+(-0.876634035391)*0.5**o
        ref[3,2,1,1]=(0.767590856273)/(o+1.)+(-0.117226372156)+(0.06295832442)*0.5**o
        ref[3,2,2,0]=(-0.957486087526)/(o+1.)+(-0.346495951936)+(-0.186380273058)*0.5**o
        ref[3,2,2,1]=(-0.103339143054)/(o+1.)+(-0.458089587303)+(-0.733041869578)*0.5**o
        ref[3,3,0,0]=(-0.00816783658019)/(o+1.)+(-0.0943126056733)+(0.381695999815)*0.5**o
        ref[3,3,0,1]=(0.988023235161)/(o+1.)+(0.471831721667)+(-0.458999917243)*0.5**o
        ref[3,3,1,0]=(-0.376576617413)/(o+1.)+(-0.377314663391)+(0.35272081264)*0.5**o
        ref[3,3,1,1]=(-0.6695966178)/(o+1.)+(-0.043322224362)+(-0.880579928879)*0.5**o
        ref[3,3,2,0]=(0.173717958996)/(o+1.)+(0.0856258574287)+(0.179006063683)*0.5**o
        ref[3,3,2,1]=(0.931619586753)/(o+1.)+(-0.0992836970501)+(0.772059778005)*0.5**o
        ref[3,4,0,0]=(0.498238525714)/(o+1.)+(-0.0405332346536)+(0.609550545616)*0.5**o
        ref[3,4,0,1]=(0.483353477991)/(o+1.)+(0.123282156934)+(0.925097562117)*0.5**o
        ref[3,4,1,0]=(-0.511134933342)/(o+1.)+(0.689769718305)+(-0.878072917122)*0.5**o
        ref[3,4,1,1]=(-0.493968471165)/(o+1.)+(0.200795857841)+(0.0745582123775)*0.5**o
        ref[3,4,2,0]=(-0.312111305637)/(o+1.)+(0.425838840642)+(-0.736620884918)*0.5**o
        ref[3,4,2,1]=(0.638515711599)/(o+1.)+(-0.508874087457)+(-0.663426736678)*0.5**o
      else:
        s[0,0,0,0]=(-0.938544579906)*x[0]**o+(0.180067483394)*x[0]+(-0.719233529982)*x[1]**o+(0.788617757419)*x[1]+(0.556994205355)*x[2]**o+(-0.127037817454)*x[2]
        s[0,0,0,1]=(0.953579560099)*x[0]**o+(0.562347618447)*x[0]+(-0.100565718949)*x[1]**o+(-0.110294341288)*x[1]+(0.23833069113)*x[2]**o+(-0.762859899976)*x[2]
        s[0,0,1,0]=(-0.0146573390123)*x[0]**o+(0.610306989551)*x[0]+(-0.322740693558)*x[1]**o+(0.0287307185836)*x[1]+(0.464511767666)*x[2]**o+(0.609636002246)*x[2]
        s[0,0,1,1]=(-0.658403837278)*x[0]**o+(0.446799474387)*x[0]+(-0.240860101539)*x[1]**o+(-0.198397925626)*x[1]+(0.874003266701)*x[2]**o+(0.313133624565)*x[2]
        s[0,0,2,0]=(0.62578079836)*x[0]**o+(-0.0257593936528)*x[0]+(-0.60984452513)*x[1]**o+(0.635946424498)*x[1]+(-0.218596411854)*x[2]**o+(0.00763050290993)*x[2]
        s[0,0,2,1]=(0.314093680988)*x[0]**o+(-0.869278986994)*x[0]+(-0.651770479439)*x[1]**o+(0.202960060033)*x[1]+(0.382275480924)*x[2]**o+(-0.595512215137)*x[2]
        s[0,1,0,0]=(0.00620161785372)*x[0]**o+(0.876847803666)*x[0]+(0.520320206245)*x[1]**o+(0.228011364507)*x[1]+(0.634707030605)*x[2]**o+(0.750039227257)*x[2]
        s[0,1,0,1]=(0.0303982843122)*x[0]**o+(-0.843928008659)*x[0]+(0.175282997162)*x[1]**o+(0.628713373934)*x[1]+(-0.260785452479)*x[2]**o+(-0.768157994235)*x[2]
        s[0,1,1,0]=(0.310811455642)*x[0]**o+(-0.907217641071)*x[0]+(-0.982538210789)*x[1]**o+(-0.600525634532)*x[1]+(-0.864394932414)*x[2]**o+(0.458881514929)*x[2]
        s[0,1,1,1]=(-0.751411238653)*x[0]**o+(-0.640190422476)*x[0]+(-0.408377872461)*x[1]**o+(0.72944579088)*x[1]+(0.946023481982)*x[2]**o+(-0.778523105712)*x[2]
        s[0,1,2,0]=(-0.852982317135)*x[0]**o+(-0.770284090211)*x[0]+(-0.0651898089121)*x[1]**o+(0.570265822823)*x[1]+(0.28669660112)*x[2]**o+(0.0651543264368)*x[2]
        s[0,1,2,1]=(-0.973162329979)*x[0]**o+(-0.246891970345)*x[0]+(0.0766743752541)*x[1]**o+(-0.403798628829)*x[1]+(-0.643254181567)*x[2]**o+(-0.378598111893)*x[2]
        s[0,2,0,0]=(0.472595355875)*x[0]**o+(0.00120464758292)*x[0]+(-0.42244937935)*x[1]**o+(-0.9164663947)*x[1]+(-0.0845858448629)*x[2]**o+(0.72392919756)*x[2]
        s[0,2,0,1]=(0.486817890916)*x[0]**o+(-0.70489295232)*x[0]+(-0.817086734784)*x[1]**o+(0.645820907995)*x[1]+(-0.335350124515)*x[2]**o+(-0.32309401603)*x[2]
        s[0,2,1,0]=(0.832549390017)*x[0]**o+(-0.434882976553)*x[0]+(0.0796018608256)*x[1]**o+(-0.815177284988)*x[1]+(0.420723606982)*x[2]**o+(-0.996616855812)*x[2]
        s[0,2,1,1]=(0.152135328754)*x[0]**o+(0.119431209093)*x[0]+(-0.0565707514319)*x[1]**o+(-0.779402141878)*x[1]+(0.504116223295)*x[2]**o+(0.35421565275)*x[2]
        s[0,2,2,0]=(-0.358237320736)*x[0]**o+(0.486656376538)*x[0]+(-0.831122271401)*x[1]**o+(-0.0521486506858)*x[1]+(-0.782495078477)*x[2]**o+(0.856211020463)*x[2]
        s[0,2,2,1]=(-0.1707212422)*x[0]**o+(-0.798979986621)*x[0]+(0.882236543414)*x[1]**o+(0.377099798101)*x[1]+(0.489392175267)*x[2]**o+(0.930902331932)*x[2]
        s[0,3,0,0]=(-0.128307529775)*x[0]**o+(-0.846783963276)*x[0]+(0.946673346517)*x[1]**o+(-0.335187413972)*x[1]+(-0.408325612416)*x[2]**o+(0.629338432074)*x[2]
        s[0,3,0,1]=(-0.554435822439)*x[0]**o+(0.990524237381)*x[0]+(-0.537192696978)*x[1]**o+(-0.826994397531)*x[1]+(0.866744291726)*x[2]**o+(-0.285154443258)*x[2]
        s[0,3,1,0]=(-0.823501956971)*x[0]**o+(0.881638907149)*x[0]+(-0.0906956584345)*x[1]**o+(-0.902956378971)*x[1]+(-0.161189770505)*x[2]**o+(-0.160538443759)*x[2]
        s[0,3,1,1]=(0.430542618951)*x[0]**o+(-0.769516956782)*x[0]+(0.475479099202)*x[1]**o+(-0.917793889771)*x[1]+(0.763381631494)*x[2]**o+(0.346636926064)*x[2]
        s[0,3,2,0]=(-0.958502709531)*x[0]**o+(-0.177711289961)*x[0]+(0.586266935723)*x[1]**o+(0.890784623626)*x[1]+(-0.787544127664)*x[2]**o+(0.446360741993)*x[2]
        s[0,3,2,1]=(-0.792569155533)*x[0]**o+(0.863653363017)*x[0]+(0.308377143826)*x[1]**o+(-0.30341033471)*x[1]+(0.0641187823207)*x[2]**o+(0.52775945782)*x[2]
        s[0,4,0,0]=(-0.0338438096091)*x[0]**o+(-0.200503853968)*x[0]+(-0.540577100866)*x[1]**o+(-0.228756900341)*x[1]+(-0.388513893583)*x[2]**o+(0.134360460805)*x[2]
        s[0,4,0,1]=(-0.406152624356)*x[0]**o+(-0.925153078113)*x[0]+(-0.432893083261)*x[1]**o+(0.118318067951)*x[1]+(0.839662677949)*x[2]**o+(-0.0163758572356)*x[2]
        s[0,4,1,0]=(-0.799456787818)*x[0]**o+(-0.0974094140856)*x[0]+(-0.967532895407)*x[1]**o+(0.313503423815)*x[1]+(-0.255345608246)*x[2]**o+(0.0212515985458)*x[2]
        s[0,4,1,1]=(0.561141037244)*x[0]**o+(0.421885997959)*x[0]+(-0.951943006997)*x[1]**o+(-0.293583958606)*x[1]+(0.26979445144)*x[2]**o+(-0.678061968406)*x[2]
        s[0,4,2,0]=(-0.346440790531)*x[0]**o+(0.486394576884)*x[0]+(0.318188318547)*x[1]**o+(-0.635068217742)*x[1]+(-0.0718964652741)*x[2]**o+(-0.702552674876)*x[2]
        s[0,4,2,1]=(0.450982323218)*x[0]**o+(0.682381807031)*x[0]+(-0.808585522869)*x[1]**o+(0.0201338006052)*x[1]+(-0.480685256454)*x[2]**o+(0.137075879378)*x[2]
        s[1,0,0,0]=(0.00370747226485)*x[0]**o+(-0.0925055645922)*x[0]+(-0.917381168613)*x[1]**o+(-0.193114928297)*x[1]+(-0.00570424377166)*x[2]**o+(0.913135198646)*x[2]
        s[1,0,0,1]=(0.314513438122)*x[0]**o+(-0.479659124185)*x[0]+(0.42293180951)*x[1]**o+(-0.597525641033)*x[1]+(-0.417172553037)*x[2]**o+(0.499251735975)*x[2]
        s[1,0,1,0]=(0.904368787276)*x[0]**o+(-0.514051100643)*x[0]+(0.212361933482)*x[1]**o+(-0.445110428363)*x[1]+(0.221673520737)*x[2]**o+(-0.0710601569942)*x[2]
        s[1,0,1,1]=(-0.0645313731593)*x[0]**o+(0.263267052465)*x[0]+(-0.715349556062)*x[1]**o+(0.236872392267)*x[1]+(0.605241495355)*x[2]**o+(-0.152375732378)*x[2]
        s[1,0,2,0]=(0.721223990054)*x[0]**o+(-0.704265146199)*x[0]+(-0.586881850891)*x[1]**o+(0.425307854616)*x[1]+(0.33484446761)*x[2]**o+(-0.573115444223)*x[2]
        s[1,0,2,1]=(-0.928667989887)*x[0]**o+(-0.877606514031)*x[0]+(-0.403016486409)*x[1]**o+(-0.517530622207)*x[1]+(0.0254991827594)*x[2]**o+(-0.82134638059)*x[2]
        s[1,1,0,0]=(-0.598976144645)*x[0]**o+(-0.0568344921691)*x[0]+(0.944100507076)*x[1]**o+(0.636963899978)*x[1]+(0.253911413671)*x[2]**o+(-0.178511347672)*x[2]
        s[1,1,0,1]=(0.51758257139)*x[0]**o+(-0.826610314817)*x[0]+(0.0669491359674)*x[1]**o+(-0.236450271581)*x[1]+(-0.702832265335)*x[2]**o+(-0.268110228427)*x[2]
        s[1,1,1,0]=(-0.847292260359)*x[0]**o+(-0.382061283693)*x[0]+(0.85982617142)*x[1]**o+(0.0930902132719)*x[1]+(0.568918674)*x[2]**o+(-0.811808588084)*x[2]
        s[1,1,1,1]=(0.396422756052)*x[0]**o+(0.667551047328)*x[0]+(-0.174441000478)*x[1]**o+(-0.40295080705)*x[1]+(0.075193248527)*x[2]**o+(-0.258123308085)*x[2]
        s[1,1,2,0]=(0.391968381002)*x[0]**o+(0.277092735448)*x[0]+(0.72619079286)*x[1]**o+(0.336787672025)*x[1]+(0.622007882)*x[2]**o+(0.286619657146)*x[2]
        s[1,1,2,1]=(-0.212692240987)*x[0]**o+(0.786660459419)*x[0]+(-0.528445652722)*x[1]**o+(0.177147918886)*x[1]+(0.40734794393)*x[2]**o+(0.155376280493)*x[2]
        s[1,2,0,0]=(0.0157691022819)*x[0]**o+(-0.661679523157)*x[0]+(0.123711726993)*x[1]**o+(-0.0870910621738)*x[1]+(-0.865865892104)*x[2]**o+(0.999338641606)*x[2]
        s[1,2,0,1]=(-0.828402321641)*x[0]**o+(-0.528217338749)*x[0]+(0.723149264147)*x[1]**o+(0.752532155985)*x[1]+(0.443929080203)*x[2]**o+(-0.929781507182)*x[2]
        s[1,2,1,0]=(-0.375626403305)*x[0]**o+(-0.510977471867)*x[0]+(0.288802388225)*x[1]**o+(0.168184581445)*x[1]+(-0.985676398515)*x[2]**o+(-0.993246463175)*x[2]
        s[1,2,1,1]=(0.839254171086)*x[0]**o+(-0.663664452054)*x[0]+(0.990048916717)*x[1]**o+(-0.986318241383)*x[1]+(0.726312571574)*x[2]**o+(0.411365473711)*x[2]
        s[1,2,2,0]=(0.179198759222)*x[0]**o+(0.362349404368)*x[0]+(0.372503911575)*x[1]**o+(-0.885663720586)*x[1]+(-0.656319589417)*x[2]**o+(-0.1547676929)*x[2]
        s[1,2,2,1]=(0.431283737039)*x[0]**o+(0.573392031568)*x[0]+(-0.167580615772)*x[1]**o+(-0.427449288729)*x[1]+(-0.771868709235)*x[2]**o+(-0.272748901939)*x[2]
        s[1,3,0,0]=(-0.735181806951)*x[0]**o+(0.536012589912)*x[0]+(0.623248739525)*x[1]**o+(0.590921832149)*x[1]+(-0.21724838693)*x[2]**o+(0.95165954451)*x[2]
        s[1,3,0,1]=(0.953086533561)*x[0]**o+(0.855151309595)*x[0]+(-0.877649378409)*x[1]**o+(-0.79234800867)*x[1]+(-0.647423149686)*x[2]**o+(0.718784987888)*x[2]
        s[1,3,1,0]=(-0.723560393521)*x[0]**o+(-0.0864445384144)*x[0]+(0.852841011672)*x[1]**o+(-0.953082229559)*x[1]+(0.983938853476)*x[2]**o+(-0.195518521863)*x[2]
        s[1,3,1,1]=(-0.915440550473)*x[0]**o+(-0.92449299685)*x[0]+(-0.150518843387)*x[1]**o+(-0.66259291358)*x[1]+(-0.812332416698)*x[2]**o+(-0.362998001567)*x[2]
        s[1,3,2,0]=(-0.205303485441)*x[0]**o+(-0.44047413477)*x[0]+(0.563675490655)*x[1]**o+(-0.802613298805)*x[1]+(-0.384663506204)*x[2]**o+(0.881891732298)*x[2]
        s[1,3,2,1]=(0.542339109554)*x[0]**o+(0.459852398778)*x[0]+(0.531257436652)*x[1]**o+(-0.0918654697667)*x[1]+(0.728385543797)*x[2]**o+(-0.142579191699)*x[2]
        s[1,4,0,0]=(-0.444230035592)*x[0]**o+(0.0532350197552)*x[0]+(-0.280357698853)*x[1]**o+(0.00480903349516)*x[1]+(-0.147327835489)*x[2]**o+(-0.630977138596)*x[2]
        s[1,4,0,1]=(0.972127984006)*x[0]**o+(0.904605524232)*x[0]+(0.44361144766)*x[1]**o+(0.586027289354)*x[1]+(-0.194334042153)*x[2]**o+(0.477271167786)*x[2]
        s[1,4,1,0]=(-0.162531060958)*x[0]**o+(-0.186338052619)*x[0]+(-0.0696302540091)*x[1]**o+(0.143088503291)*x[1]+(0.0107879016639)*x[2]**o+(0.39899128749)*x[2]
        s[1,4,1,1]=(0.315463685116)*x[0]**o+(-0.290348790738)*x[0]+(-0.292829602611)*x[1]**o+(-0.272218595021)*x[1]+(-0.247363514071)*x[2]**o+(0.830943482915)*x[2]
        s[1,4,2,0]=(0.340729082172)*x[0]**o+(0.266345838644)*x[0]+(0.205349295082)*x[1]**o+(-0.0281621785636)*x[1]+(0.89948000824)*x[2]**o+(-0.764082368496)*x[2]
        s[1,4,2,1]=(0.7615004712)*x[0]**o+(-0.366790213041)*x[0]+(-0.347719278119)*x[1]**o+(-0.664644802127)*x[1]+(0.153340126952)*x[2]**o+(-0.699790837984)*x[2]
        s[2,0,0,0]=(0.0125409231833)*x[0]**o+(-0.497512034949)*x[0]+(0.688244767493)*x[1]**o+(-0.160005018143)*x[1]+(-0.119715348465)*x[2]**o+(-0.797969768194)*x[2]
        s[2,0,0,1]=(-0.0036047535766)*x[0]**o+(0.726289674137)*x[0]+(-0.110716355541)*x[1]**o+(-0.937117263903)*x[1]+(0.540476278776)*x[2]**o+(-0.0254788538753)*x[2]
        s[2,0,1,0]=(0.0494808240706)*x[0]**o+(-0.469224784419)*x[0]+(0.599591744744)*x[1]**o+(-0.694323071412)*x[1]+(-0.584890416602)*x[2]**o+(0.795168667963)*x[2]
        s[2,0,1,1]=(-0.53303893512)*x[0]**o+(0.012157220346)*x[0]+(-0.546109156126)*x[1]**o+(-0.719758078719)*x[1]+(-0.496492728702)*x[2]**o+(0.816565066681)*x[2]
        s[2,0,2,0]=(-0.306356882566)*x[0]**o+(0.501809420086)*x[0]+(0.171130235154)*x[1]**o+(-0.804095060824)*x[1]+(0.929639721152)*x[2]**o+(-0.516285706731)*x[2]
        s[2,0,2,1]=(0.337441903133)*x[0]**o+(-0.524705933088)*x[0]+(0.490789790623)*x[1]**o+(0.0420695613636)*x[1]+(-0.296688134663)*x[2]**o+(-0.508555097135)*x[2]
        s[2,1,0,0]=(0.984282580742)*x[0]**o+(0.692515911833)*x[0]+(0.610802160351)*x[1]**o+(0.174938187813)*x[1]+(0.777154457482)*x[2]**o+(-0.296265352251)*x[2]
        s[2,1,0,1]=(0.263434795622)*x[0]**o+(0.146263475693)*x[0]+(-0.135060978)*x[1]**o+(-0.612057700058)*x[1]+(0.401206478053)*x[2]**o+(0.614641881217)*x[2]
        s[2,1,1,0]=(0.839155090264)*x[0]**o+(0.893746351779)*x[0]+(0.652777744086)*x[1]**o+(-0.119538495003)*x[1]+(-0.116919455352)*x[2]**o+(-0.24237363241)*x[2]
        s[2,1,1,1]=(-0.626863009974)*x[0]**o+(-0.328592553389)*x[0]+(-0.483755510715)*x[1]**o+(0.506129888719)*x[1]+(-0.369314928449)*x[2]**o+(-0.974391328259)*x[2]
        s[2,1,2,0]=(-0.548834239805)*x[0]**o+(-0.137282729528)*x[0]+(0.980067336071)*x[1]**o+(-0.677019881527)*x[1]+(-0.633352248762)*x[2]**o+(0.394845574769)*x[2]
        s[2,1,2,1]=(0.304097820123)*x[0]**o+(0.205705406237)*x[0]+(0.431075221394)*x[1]**o+(0.965948087934)*x[1]+(0.797211333629)*x[2]**o+(-0.750481732005)*x[2]
        s[2,2,0,0]=(0.00294465132151)*x[0]**o+(-0.36531365965)*x[0]+(-0.477095178168)*x[1]**o+(0.640123142737)*x[1]+(0.307285555133)*x[2]**o+(-0.535459483965)*x[2]
        s[2,2,0,1]=(0.185831262234)*x[0]**o+(0.680621489598)*x[0]+(-0.606597858106)*x[1]**o+(0.605582792294)*x[1]+(0.67028817128)*x[2]**o+(0.0936479735813)*x[2]
        s[2,2,1,0]=(0.234717477502)*x[0]**o+(0.739313223999)*x[0]+(-0.765253630778)*x[1]**o+(-0.199364440863)*x[1]+(-0.10386639265)*x[2]**o+(-0.772307849674)*x[2]
        s[2,2,1,1]=(0.692290926695)*x[0]**o+(-0.841554910484)*x[0]+(-0.156803726414)*x[1]**o+(0.656797138877)*x[1]+(0.4668832013)*x[2]**o+(-0.320142791051)*x[2]
        s[2,2,2,0]=(-0.408729971023)*x[0]**o+(0.28023578811)*x[0]+(0.756339486697)*x[1]**o+(0.130791597709)*x[1]+(-0.388130026173)*x[2]**o+(-0.232133676528)*x[2]
        s[2,2,2,1]=(-0.30215609634)*x[0]**o+(-0.515622149267)*x[0]+(-0.979560898475)*x[1]**o+(0.424855014788)*x[1]+(-0.0265200291972)*x[2]**o+(0.244204914292)*x[2]
        s[2,3,0,0]=(-0.731783739254)*x[0]**o+(-0.910917581289)*x[0]+(-0.490859941251)*x[1]**o+(0.265521242704)*x[1]+(0.246576247389)*x[2]**o+(0.551033884684)*x[2]
        s[2,3,0,1]=(0.353316440436)*x[0]**o+(0.607852620987)*x[0]+(0.716634525835)*x[1]**o+(0.931269029696)*x[1]+(0.512042632855)*x[2]**o+(0.84647829057)*x[2]
        s[2,3,1,0]=(-0.682583926526)*x[0]**o+(0.0414372583894)*x[0]+(-0.368919279038)*x[1]**o+(0.263442044187)*x[1]+(0.651154272252)*x[2]**o+(0.625505230753)*x[2]
        s[2,3,1,1]=(-0.773410808141)*x[0]**o+(-0.308532872412)*x[0]+(0.484022099132)*x[1]**o+(0.748310916514)*x[1]+(0.484822489595)*x[2]**o+(0.0919219970104)*x[2]
        s[2,3,2,0]=(-0.856792343472)*x[0]**o+(0.475526910813)*x[0]+(0.858286241213)*x[1]**o+(0.765684964483)*x[1]+(0.842680693423)*x[2]**o+(0.759239366541)*x[2]
        s[2,3,2,1]=(0.208814714888)*x[0]**o+(-0.319616331598)*x[0]+(-0.786662106876)*x[1]**o+(-0.742419573118)*x[1]+(-0.671654532185)*x[2]**o+(-0.81098024788)*x[2]
        s[2,4,0,0]=(0.0581246014334)*x[0]**o+(-0.738212823784)*x[0]+(0.42828697377)*x[1]**o+(-0.795604474847)*x[1]+(-0.867930879138)*x[2]**o+(0.897777664383)*x[2]
        s[2,4,0,1]=(0.658005351748)*x[0]**o+(0.318056754281)*x[0]+(-0.241917242833)*x[1]**o+(0.321210074114)*x[1]+(0.341921510554)*x[2]**o+(-0.713222645312)*x[2]
        s[2,4,1,0]=(-0.865800829839)*x[0]**o+(-0.24789092495)*x[0]+(-0.765024475984)*x[1]**o+(0.246675200333)*x[1]+(0.63601593739)*x[2]**o+(0.758761609858)*x[2]
        s[2,4,1,1]=(-0.722774458642)*x[0]**o+(-0.640277272458)*x[0]+(-0.847467314954)*x[1]**o+(-0.676376490579)*x[1]+(-0.867510590824)*x[2]**o+(0.304980448789)*x[2]
        s[2,4,2,0]=(-0.556352556597)*x[0]**o+(-0.314836337315)*x[0]+(-0.172549538929)*x[1]**o+(-0.603791779732)*x[1]+(-0.482556973138)*x[2]**o+(0.155915646569)*x[2]
        s[2,4,2,1]=(-0.790402254477)*x[0]**o+(0.137494169657)*x[0]+(-0.546722957671)*x[1]**o+(-0.504092758637)*x[1]+(0.370205905665)*x[2]**o+(0.905182951166)*x[2]
        s[3,0,0,0]=(-0.393498907366)*x[0]**o+(0.792111044321)*x[0]+(0.160732029377)*x[1]**o+(0.531118521589)*x[1]+(0.616077214135)*x[2]**o+(0.0450299929995)*x[2]
        s[3,0,0,1]=(0.0490385695005)*x[0]**o+(-0.112630305424)*x[0]+(0.932194477491)*x[1]**o+(-0.692641363201)*x[1]+(0.0679516868523)*x[2]**o+(0.997252361895)*x[2]
        s[3,0,1,0]=(0.372518182464)*x[0]**o+(-0.390347141072)*x[0]+(-0.551584590493)*x[1]**o+(-0.762622043128)*x[1]+(-0.777489328164)*x[2]**o+(-0.306555622213)*x[2]
        s[3,0,1,1]=(-0.907039911971)*x[0]**o+(0.716176125684)*x[0]+(-0.0317846045066)*x[1]**o+(0.344154975432)*x[1]+(-0.581050833334)*x[2]**o+(-0.800597412247)*x[2]
        s[3,0,2,0]=(0.671061807362)*x[0]**o+(-0.632730364318)*x[0]+(0.784926714274)*x[1]**o+(-0.689167186471)*x[1]+(-0.828322284596)*x[2]**o+(-0.757384289233)*x[2]
        s[3,0,2,1]=(0.797200318087)*x[0]**o+(0.0748753590429)*x[0]+(0.98432669884)*x[1]**o+(0.19160698616)*x[1]+(-0.941839443214)*x[2]**o+(-0.51797940249)*x[2]
        s[3,1,0,0]=(0.396318123324)*x[0]**o+(0.553544474446)*x[0]+(-0.196123045916)*x[1]**o+(0.931142300652)*x[1]+(-0.893432985678)*x[2]**o+(0.61239614626)*x[2]
        s[3,1,0,1]=(-0.281320711026)*x[0]**o+(0.0272769480991)*x[0]+(-0.43587599777)*x[1]**o+(0.419822767553)*x[1]+(-0.453045711683)*x[2]**o+(0.47569249252)*x[2]
        s[3,1,1,0]=(-0.213862255449)*x[0]**o+(0.355661536766)*x[0]+(0.251742827449)*x[1]**o+(-0.807017120416)*x[1]+(-0.730339835476)*x[2]**o+(0.551573971157)*x[2]
        s[3,1,1,1]=(0.554657719161)*x[0]**o+(-0.912970059328)*x[0]+(0.800146831674)*x[1]**o+(-0.583227572533)*x[1]+(-0.0933072839888)*x[2]**o+(0.950038311476)*x[2]
        s[3,1,2,0]=(-0.485569875217)*x[0]**o+(-0.636350568501)*x[0]+(-0.560720680426)*x[1]**o+(0.126204185032)*x[1]+(-0.272414378167)*x[2]**o+(-0.888532404451)*x[2]
        s[3,1,2,1]=(-0.727409224907)*x[0]**o+(0.856672459636)*x[0]+(0.37848918095)*x[1]**o+(0.622080880799)*x[1]+(-0.228417584572)*x[2]**o+(0.562188460361)*x[2]
        s[3,2,0,0]=(-0.294609451063)*x[0]**o+(0.577588405163)*x[0]+(0.667703746348)*x[1]**o+(-0.910501998185)*x[1]+(0.843110506022)*x[2]**o+(-0.826714153775)*x[2]
        s[3,2,0,1]=(-0.193869261184)*x[0]**o+(0.76598264579)*x[0]+(-0.15832998161)*x[1]**o+(0.647800212602)*x[1]+(0.0578289377486)*x[2]**o+(0.00658825845732)*x[2]
        s[3,2,1,0]=(-0.567464737056)*x[0]**o+(-0.149652747243)*x[0]+(-0.55259439138)*x[1]**o+(-0.879859303137)*x[1]+(-0.618763037058)*x[2]**o+(-0.361881515471)*x[2]
        s[3,2,1,1]=(-0.331240639597)*x[0]**o+(-0.842702790198)*x[0]+(0.14240123238)*x[1]**o+(0.732696112887)*x[1]+(0.678517810911)*x[2]**o+(0.874215749104)*x[2]
        s[3,2,2,0]=(0.569105573686)*x[0]**o+(-0.671670416897)*x[0]+(0.809241806071)*x[1]**o+(-0.781683673317)*x[1]+(0.915497987962)*x[2]**o+(0.529423259835)*x[2]
        s[3,2,2,1]=(0.803926266415)*x[0]**o+(0.973851217854)*x[0]+(0.00110452925071)*x[1]**o+(-0.0258074727224)*x[1]+(0.397580796648)*x[2]**o+(-0.483394954284)*x[2]
        s[3,3,0,0]=(-0.239744952662)*x[0]**o+(0.0330238686771)*x[0]+(0.57663829323)*x[1]**o+(-0.835285980271)*x[1]+(-0.541211231475)*x[2]**o+(0.309919910162)*x[2]
        s[3,3,0,1]=(0.998856178514)*x[0]**o+(0.69963418829)*x[0]+(-0.590956618638)*x[1]**o+(0.437083139196)*x[1]+(0.24957499362)*x[2]**o+(-0.207180573624)*x[2]
        s[3,3,1,0]=(-0.654845715855)*x[0]**o+(0.960307610722)*x[0]+(0.615977294745)*x[1]**o+(-0.717345465881)*x[1]+(-0.0724170395954)*x[2]**o+(0.660888358757)*x[2]
        s[3,3,1,1]=(-0.283730169109)*x[0]**o+(0.712609062937)*x[0]+(0.922422201518)*x[1]**o+(0.941787071667)*x[1]+(-0.317440296596)*x[2]**o+(-0.776070611464)*x[2]
        s[3,3,2,0]=(-0.377933655183)*x[0]**o+(-0.946504205082)*x[0]+(-0.705852108222)*x[1]**o+(0.735471828851)*x[1]+(0.740387572185)*x[2]**o+(0.478923064569)*x[2]
        s[3,3,2,1]=(-0.74484862371)*x[0]**o+(-0.394147355587)*x[0]+(-0.961488506416)*x[1]**o+(-0.117956733646)*x[1]+(-0.45639006521)*x[2]**o+(0.800113732885)*x[2]
        s[3,4,0,0]=(-0.625504798604)*x[0]**o+(0.316567164198)*x[0]+(-0.616071176069)*x[1]**o+(0.882101858084)*x[1]+(0.734544640696)*x[2]**o+(-0.0269245549068)*x[2]
        s[3,4,0,1]=(-0.307431859474)*x[0]**o+(-0.0850940272398)*x[0]+(0.389650545234)*x[1]**o+(-0.0311288588201)*x[1]+(0.560636030796)*x[2]**o+(0.990554208909)*x[2]
        s[3,4,1,0]=(-0.85379517016)*x[0]**o+(0.768069325756)*x[0]+(0.0149807290805)*x[1]**o+(-0.87320355719)*x[1]+(-0.153198452162)*x[2]**o+(0.0809551506622)*x[2]
        s[3,4,1,1]=(-0.427217312348)*x[0]**o+(0.860261211584)*x[0]+(0.988421955689)*x[1]**o+(0.10533108572)*x[1]+(0.903327272548)*x[2]**o+(0.434209037137)*x[2]
        s[3,4,2,0]=(-0.264611936187)*x[0]**o+(0.0438724619932)*x[0]+(0.398401170965)*x[1]**o+(0.53328233455)*x[1]+(-0.437516039922)*x[2]**o+(0.926837033874)*x[2]
        s[3,4,2,1]=(-0.0213427465429)*x[0]**o+(-0.41324925677)*x[0]+(0.00876072281828)*x[1]**o+(0.640763350258)*x[1]+(-0.548829379894)*x[2]**o+(0.523108062556)*x[2]
        ref[0,0,0,0]=(-0.162239324627)/(o+1.)+(0.420823711679)+(-0.938544579906)*0.5**o
        ref[0,0,0,1]=(0.137764972182)/(o+1.)+(-0.155403311408)+(0.953579560099)*0.5**o
        ref[0,0,1,0]=(0.141771074109)/(o+1.)+(0.62433685519)+(-0.0146573390123)*0.5**o
        ref[0,0,1,1]=(0.633143165162)/(o+1.)+(0.280767586663)+(-0.658403837278)*0.5**o
        ref[0,0,2,0]=(-0.828440936984)/(o+1.)+(0.308908766878)+(0.62578079836)*0.5**o
        ref[0,0,2,1]=(-0.269494998515)/(o+1.)+(-0.630915571049)+(0.314093680988)*0.5**o
        ref[0,1,0,0]=(1.15502723685)/(o+1.)+(0.927449197715)+(0.00620161785372)*0.5**o
        ref[0,1,0,1]=(-0.0855024553167)/(o+1.)+(-0.49168631448)+(0.0303982843122)*0.5**o
        ref[0,1,1,0]=(-1.8469331432)/(o+1.)+(-0.524430880337)+(0.310811455642)*0.5**o
        ref[0,1,1,1]=(0.537645609521)/(o+1.)+(-0.344633868654)+(-0.751411238653)*0.5**o
        ref[0,1,2,0]=(0.221506792208)/(o+1.)+(-0.0674319704757)+(-0.852982317135)*0.5**o
        ref[0,1,2,1]=(-0.566579806313)/(o+1.)+(-0.514644355533)+(-0.973162329979)*0.5**o
        ref[0,2,0,0]=(-0.507035224213)/(o+1.)+(-0.0956662747788)+(0.472595355875)*0.5**o
        ref[0,2,0,1]=(-1.1524368593)/(o+1.)+(-0.191083030177)+(0.486817890916)*0.5**o
        ref[0,2,1,0]=(0.500325467807)/(o+1.)+(-1.12333855868)+(0.832549390017)*0.5**o
        ref[0,2,1,1]=(0.447545471863)/(o+1.)+(-0.152877640017)+(0.152135328754)*0.5**o
        ref[0,2,2,0]=(-1.61361734988)/(o+1.)+(0.645359373158)+(-0.358237320736)*0.5**o
        ref[0,2,2,1]=(1.37162871868)/(o+1.)+(0.254511071706)+(-0.1707212422)*0.5**o
        ref[0,3,0,0]=(0.538347734102)/(o+1.)+(-0.276316472587)+(-0.128307529775)*0.5**o
        ref[0,3,0,1]=(0.329551594748)/(o+1.)+(-0.0608123017038)+(-0.554435822439)*0.5**o
        ref[0,3,1,0]=(-0.251885428939)/(o+1.)+(-0.0909279577907)+(-0.823501956971)*0.5**o
        ref[0,3,1,1]=(1.2388607307)/(o+1.)+(-0.670336960245)+(0.430542618951)*0.5**o
        ref[0,3,2,0]=(-0.201277191941)/(o+1.)+(0.579717037829)+(-0.958502709531)*0.5**o
        ref[0,3,2,1]=(0.372495926146)/(o+1.)+(0.544001243064)+(-0.792569155533)*0.5**o
        ref[0,4,0,0]=(-0.929090994448)/(o+1.)+(-0.147450146752)+(-0.0338438096091)*0.5**o
        ref[0,4,0,1]=(0.406769594688)/(o+1.)+(-0.411605433699)+(-0.406152624356)*0.5**o
        ref[0,4,1,0]=(-1.22287850365)/(o+1.)+(0.118672804138)+(-0.799456787818)*0.5**o
        ref[0,4,1,1]=(-0.682148555557)/(o+1.)+(-0.274879964526)+(0.561141037244)*0.5**o
        ref[0,4,2,0]=(0.246291853273)/(o+1.)+(-0.425613157867)+(-0.346440790531)*0.5**o
        ref[0,4,2,1]=(-1.28927077932)/(o+1.)+(0.419795743507)+(0.450982323218)*0.5**o
        ref[1,0,0,0]=(-0.923085412384)/(o+1.)+(0.313757352879)+(0.00370747226485)*0.5**o
        ref[1,0,0,1]=(0.00575925647317)/(o+1.)+(-0.288966514622)+(0.314513438122)*0.5**o
        ref[1,0,1,0]=(0.434035454219)/(o+1.)+(-0.515110843)+(0.904368787276)*0.5**o
        ref[1,0,1,1]=(-0.110108060707)/(o+1.)+(0.173881856177)+(-0.0645313731593)*0.5**o
        ref[1,0,2,0]=(-0.252037383281)/(o+1.)+(-0.426036367903)+(0.721223990054)*0.5**o
        ref[1,0,2,1]=(-0.37751730365)/(o+1.)+(-1.10824175841)+(-0.928667989887)*0.5**o
        ref[1,1,0,0]=(1.19801192075)/(o+1.)+(0.200809030069)+(-0.598976144645)*0.5**o
        ref[1,1,0,1]=(-0.635883129368)/(o+1.)+(-0.665585407412)+(0.51758257139)*0.5**o
        ref[1,1,1,0]=(1.42874484542)/(o+1.)+(-0.550389829253)+(-0.847292260359)*0.5**o
        ref[1,1,1,1]=(-0.0992477519506)/(o+1.)+(0.00323846609633)+(0.396422756052)*0.5**o
        ref[1,1,2,0]=(1.34819867486)/(o+1.)+(0.450250032309)+(0.391968381002)*0.5**o
        ref[1,1,2,1]=(-0.121097708792)/(o+1.)+(0.559592329399)+(-0.212692240987)*0.5**o
        ref[1,2,0,0]=(-0.74215416511)/(o+1.)+(0.125284028138)+(0.0157691022819)*0.5**o
        ref[1,2,0,1]=(1.16707834435)/(o+1.)+(-0.352733344973)+(-0.828402321641)*0.5**o
        ref[1,2,1,0]=(-0.69687401029)/(o+1.)+(-0.668019676798)+(-0.375626403305)*0.5**o
        ref[1,2,1,1]=(1.71636148829)/(o+1.)+(-0.619308609863)+(0.839254171086)*0.5**o
        ref[1,2,2,0]=(-0.283815677841)/(o+1.)+(-0.339041004559)+(0.179198759222)*0.5**o
        ref[1,2,2,1]=(-0.939449325007)/(o+1.)+(-0.0634030795503)+(0.431283737039)*0.5**o
        ref[1,3,0,0]=(0.406000352595)/(o+1.)+(1.03929698329)+(-0.735181806951)*0.5**o
        ref[1,3,0,1]=(-1.52507252809)/(o+1.)+(0.390794144406)+(0.953086533561)*0.5**o
        ref[1,3,1,0]=(1.83677986515)/(o+1.)+(-0.617522644919)+(-0.723560393521)*0.5**o
        ref[1,3,1,1]=(-0.962851260085)/(o+1.)+(-0.975041955998)+(-0.915440550473)*0.5**o
        ref[1,3,2,0]=(0.179011984451)/(o+1.)+(-0.180597850638)+(-0.205303485441)*0.5**o
        ref[1,3,2,1]=(1.25964298045)/(o+1.)+(0.112703868656)+(0.542339109554)*0.5**o
        ref[1,4,0,0]=(-0.427685534341)/(o+1.)+(-0.286466542673)+(-0.444230035592)*0.5**o
        ref[1,4,0,1]=(0.249277405507)/(o+1.)+(0.983951990686)+(0.972127984006)*0.5**o
        ref[1,4,1,0]=(-0.0588423523453)/(o+1.)+(0.177870869081)+(-0.162531060958)*0.5**o
        ref[1,4,1,1]=(-0.540193116681)/(o+1.)+(0.134188048578)+(0.315463685116)*0.5**o
        ref[1,4,2,0]=(1.10482930332)/(o+1.)+(-0.262949354208)+(0.340729082172)*0.5**o
        ref[1,4,2,1]=(-0.194379151166)/(o+1.)+(-0.865612926576)+(0.7615004712)*0.5**o
        ref[2,0,0,0]=(0.568529419028)/(o+1.)+(-0.727743410643)+(0.0125409231833)*0.5**o
        ref[2,0,0,1]=(0.429759923235)/(o+1.)+(-0.118153221821)+(-0.0036047535766)*0.5**o
        ref[2,0,1,0]=(0.0147013281422)/(o+1.)+(-0.184189593934)+(0.0494808240706)*0.5**o
        ref[2,0,1,1]=(-1.04260188483)/(o+1.)+(0.0544821041543)+(-0.53303893512)*0.5**o
        ref[2,0,2,0]=(1.10076995631)/(o+1.)+(-0.409285673735)+(-0.306356882566)*0.5**o
        ref[2,0,2,1]=(0.19410165596)/(o+1.)+(-0.49559573443)+(0.337441903133)*0.5**o
        ref[2,1,0,0]=(1.38795661783)/(o+1.)+(0.285594373698)+(0.984282580742)*0.5**o
        ref[2,1,0,1]=(0.266145500053)/(o+1.)+(0.0744238284255)+(0.263434795622)*0.5**o
        ref[2,1,1,0]=(0.535858288734)/(o+1.)+(0.265917112183)+(0.839155090264)*0.5**o
        ref[2,1,1,1]=(-0.853070439164)/(o+1.)+(-0.398426996464)+(-0.626863009974)*0.5**o
        ref[2,1,2,0]=(0.346715087308)/(o+1.)+(-0.209728518143)+(-0.548834239805)*0.5**o
        ref[2,1,2,1]=(1.22828655502)/(o+1.)+(0.210585881083)+(0.304097820123)*0.5**o
        ref[2,2,0,0]=(-0.169809623035)/(o+1.)+(-0.13032500044)+(0.00294465132151)*0.5**o
        ref[2,2,0,1]=(0.0636903131735)/(o+1.)+(0.689926127736)+(0.185831262234)*0.5**o
        ref[2,2,1,0]=(-0.869120023429)/(o+1.)+(-0.116179533269)+(0.234717477502)*0.5**o
        ref[2,2,1,1]=(0.310079474886)/(o+1.)+(-0.252450281328)+(0.692290926695)*0.5**o
        ref[2,2,2,0]=(0.368209460524)/(o+1.)+(0.0894468546456)+(-0.408729971023)*0.5**o
        ref[2,2,2,1]=(-1.00608092767)/(o+1.)+(0.0767188899067)+(-0.30215609634)*0.5**o
        ref[2,3,0,0]=(-0.244283693862)/(o+1.)+(-0.0471812269507)+(-0.731783739254)*0.5**o
        ref[2,3,0,1]=(1.22867715869)/(o+1.)+(1.19279997063)+(0.353316440436)*0.5**o
        ref[2,3,1,0]=(0.282234993214)/(o+1.)+(0.465192266665)+(-0.682583926526)*0.5**o
        ref[2,3,1,1]=(0.968844588727)/(o+1.)+(0.265850020556)+(-0.773410808141)*0.5**o
        ref[2,3,2,0]=(1.70096693464)/(o+1.)+(1.00022562092)+(-0.856792343472)*0.5**o
        ref[2,3,2,1]=(-1.45831663906)/(o+1.)+(-0.936508076298)+(0.208814714888)*0.5**o
        ref[2,4,0,0]=(-0.439643905368)/(o+1.)+(-0.318019817124)+(0.0581246014334)*0.5**o
        ref[2,4,0,1]=(0.100004267721)/(o+1.)+(-0.0369779084584)+(0.658005351748)*0.5**o
        ref[2,4,1,0]=(-0.129008538594)/(o+1.)+(0.37877294262)+(-0.865800829839)*0.5**o
        ref[2,4,1,1]=(-1.71497790578)/(o+1.)+(-0.505836657124)+(-0.722774458642)*0.5**o
        ref[2,4,2,0]=(-0.655106512067)/(o+1.)+(-0.38135623524)+(-0.556352556597)*0.5**o
        ref[2,4,2,1]=(-0.176517052006)/(o+1.)+(0.269292181093)+(-0.790402254477)*0.5**o
        ref[3,0,0,0]=(0.776809243512)/(o+1.)+(0.684129779455)+(-0.393498907366)*0.5**o
        ref[3,0,0,1]=(1.00014616434)/(o+1.)+(0.0959903466349)+(0.0490385695005)*0.5**o
        ref[3,0,1,0]=(-1.32907391866)/(o+1.)+(-0.729762403206)+(0.372518182464)*0.5**o
        ref[3,0,1,1]=(-0.612835437841)/(o+1.)+(0.129866844435)+(-0.907039911971)*0.5**o
        ref[3,0,2,0]=(-0.0433955703218)/(o+1.)+(-1.03964092001)+(0.671061807362)*0.5**o
        ref[3,0,2,1]=(0.0424872556266)/(o+1.)+(-0.125748528644)+(0.797200318087)*0.5**o
        ref[3,1,0,0]=(-1.08955603159)/(o+1.)+(1.04854146068)+(0.396318123324)*0.5**o
        ref[3,1,0,1]=(-0.888921709452)/(o+1.)+(0.461396104086)+(-0.281320711026)*0.5**o
        ref[3,1,1,0]=(-0.478597008027)/(o+1.)+(0.0501091937538)+(-0.213862255449)*0.5**o
        ref[3,1,1,1]=(0.706839547685)/(o+1.)+(-0.273079660193)+(0.554657719161)*0.5**o
        ref[3,1,2,0]=(-0.833135058593)/(o+1.)+(-0.69933939396)+(-0.485569875217)*0.5**o
        ref[3,1,2,1]=(0.150071596378)/(o+1.)+(1.0204709004)+(-0.727409224907)*0.5**o
        ref[3,2,0,0]=(1.51081425237)/(o+1.)+(-0.579813873399)+(-0.294609451063)*0.5**o
        ref[3,2,0,1]=(-0.100501043862)/(o+1.)+(0.710185558425)+(-0.193869261184)*0.5**o
        ref[3,2,1,0]=(-1.17135742844)/(o+1.)+(-0.695696782926)+(-0.567464737056)*0.5**o
        ref[3,2,1,1]=(0.820919043291)/(o+1.)+(0.382104535896)+(-0.331240639597)*0.5**o
        ref[3,2,2,0]=(1.72473979403)/(o+1.)+(-0.461965415189)+(0.569105573686)*0.5**o
        ref[3,2,2,1]=(0.398685325899)/(o+1.)+(0.232324395424)+(0.803926266415)*0.5**o
        ref[3,3,0,0]=(0.0354270617556)/(o+1.)+(-0.246171100716)+(-0.239744952662)*0.5**o
        ref[3,3,0,1]=(-0.341381625018)/(o+1.)+(0.464768376931)+(0.998856178514)*0.5**o
        ref[3,3,1,0]=(0.543560255149)/(o+1.)+(0.451925251799)+(-0.654845715855)*0.5**o
        ref[3,3,1,1]=(0.604981904922)/(o+1.)+(0.43916276157)+(-0.283730169109)*0.5**o
        ref[3,3,2,0]=(0.0345354639628)/(o+1.)+(0.133945344169)+(-0.377933655183)*0.5**o
        ref[3,3,2,1]=(-1.41787857163)/(o+1.)+(0.144004821826)+(-0.74484862371)*0.5**o
        ref[3,4,0,0]=(0.118473464627)/(o+1.)+(0.585872233688)+(-0.625504798604)*0.5**o
        ref[3,4,0,1]=(0.95028657603)/(o+1.)+(0.437165661424)+(-0.307431859474)*0.5**o
        ref[3,4,1,0]=(-0.138217723081)/(o+1.)+(-0.0120895403861)+(-0.85379517016)*0.5**o
        ref[3,4,1,1]=(1.89174922824)/(o+1.)+(0.699900667221)+(-0.427217312348)*0.5**o
        ref[3,4,2,0]=(-0.0391148689569)/(o+1.)+(0.751995915209)+(-0.264611936187)*0.5**o
        ref[3,4,2,1]=(-0.540068657076)/(o+1.)+(0.375311078022)+(-0.0213427465429)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.0333010052777)*x[0]**o+(-0.242011298555)*x[0]+(0.686457578633)*x[1]**o+(0.438506741453)*x[1]
        ref=(0.686457578633)/(o+1.)+(0.0982477214491)+(-0.0333010052777)*0.5**o
      else:
        arg=(-0.365813216932)*x[0]**o+(0.969816151161)*x[0]+(0.349995764077)*x[1]**o+(0.867492181692)*x[1]+(-0.866177355796)*x[2]**o+(-0.203219031102)*x[2]
        ref=(-0.516181591719)/(o+1.)+(0.817044650875)+(-0.365813216932)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.038446371199)*x[0]**o+(0.323075821067)*x[0]+(0.770528210463)*x[1]**o+(0.0434528043023)*x[1]
        arg[1]=(-0.461876402566)*x[0]**o+(0.746965376214)*x[0]+(0.861234840159)*x[1]**o+(-0.568165009958)*x[1]
        ref[0]=(0.770528210463)/(o+1.)+(0.183264312685)+(0.038446371199)*0.5**o
        ref[1]=(0.861234840159)/(o+1.)+(0.0894001831281)+(-0.461876402566)*0.5**o
      else:
        arg[0]=(-0.472858663642)*x[0]**o+(-0.680210745369)*x[0]+(0.175425838082)*x[1]**o+(0.0189427039667)*x[1]+(0.0365198456146)*x[2]**o+(0.7840527457)*x[2]
        arg[1]=(-0.0191775972693)*x[0]**o+(0.19303923194)*x[0]+(0.775528295333)*x[1]**o+(-0.765500708496)*x[1]+(0.351369471606)*x[2]**o+(-0.351587727906)*x[2]
        ref[0]=(0.211945683696)/(o+1.)+(0.0613923521485)+(-0.472858663642)*0.5**o
        ref[1]=(1.12689776694)/(o+1.)+(-0.462024602231)+(-0.0191775972693)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.994443255559)*x[0]**o+(-0.403427184912)*x[0]+(-0.889656446862)*x[1]**o+(-0.411934106034)*x[1]
        arg[0,1]=(-0.864086447061)*x[0]**o+(-0.277489357308)*x[0]+(0.977910864864)*x[1]**o+(-0.0505775488074)*x[1]
        arg[0,2]=(-0.397179114534)*x[0]**o+(-0.448046821439)*x[0]+(-0.340253609736)*x[1]**o+(0.624988837716)*x[1]
        arg[0,3]=(-0.9155191116)*x[0]**o+(0.133777450278)*x[0]+(-0.809567026065)*x[1]**o+(-0.815374059364)*x[1]
        arg[0,4]=(-0.416764684181)*x[0]**o+(0.0965164570638)*x[0]+(0.190191799833)*x[1]**o+(0.0970709424519)*x[1]
        arg[1,0]=(0.646527294535)*x[0]**o+(-0.337119506636)*x[0]+(0.42669563245)*x[1]**o+(-0.185228568706)*x[1]
        arg[1,1]=(-0.411532647934)*x[0]**o+(0.178830973832)*x[0]+(-0.904886020892)*x[1]**o+(-0.740623071275)*x[1]
        arg[1,2]=(0.523024622808)*x[0]**o+(-0.226298848077)*x[0]+(-0.707740568617)*x[1]**o+(0.998182796571)*x[1]
        arg[1,3]=(0.840649917357)*x[0]**o+(-0.736279151571)*x[0]+(0.996017554392)*x[1]**o+(-0.397833319931)*x[1]
        arg[1,4]=(0.76711764419)*x[0]**o+(-0.905452991298)*x[0]+(-0.925675237951)*x[1]**o+(-0.982712645237)*x[1]
        arg[2,0]=(0.198547103682)*x[0]**o+(0.674537682234)*x[0]+(-0.891195618193)*x[1]**o+(0.979109691481)*x[1]
        arg[2,1]=(0.171629921737)*x[0]**o+(0.0102727001751)*x[0]+(0.467578393374)*x[1]**o+(0.583960984645)*x[1]
        arg[2,2]=(-0.637526271497)*x[0]**o+(-0.900821073531)*x[0]+(0.61637733965)*x[1]**o+(0.43717505341)*x[1]
        arg[2,3]=(-0.205861963967)*x[0]**o+(-0.104621062003)*x[0]+(0.582584591946)*x[1]**o+(0.351739662419)*x[1]
        arg[2,4]=(-0.179355911316)*x[0]**o+(-0.188415282678)*x[0]+(0.598342895007)*x[1]**o+(0.364638908577)*x[1]
        arg[3,0]=(0.150471526119)*x[0]**o+(-0.940789873202)*x[0]+(-0.524275825864)*x[1]**o+(0.729004683023)*x[1]
        arg[3,1]=(0.123933417087)*x[0]**o+(0.192413160498)*x[0]+(0.203730760507)*x[1]**o+(0.852010172966)*x[1]
        arg[3,2]=(-0.297766950847)*x[0]**o+(0.269905131596)*x[0]+(-0.0830931256847)*x[1]**o+(0.26964712569)*x[1]
        arg[3,3]=(0.96961517265)*x[0]**o+(0.363312967302)*x[0]+(-0.811142762589)*x[1]**o+(-0.420442983537)*x[1]
        arg[3,4]=(-0.314185602206)*x[0]**o+(-0.0446515646101)*x[0]+(-0.884651038732)*x[1]**o+(-0.166386477611)*x[1]
        ref[0,0]=(-0.889656446862)/(o+1.)+(-0.407680645473)+(-0.994443255559)*0.5**o
        ref[0,1]=(0.977910864864)/(o+1.)+(-0.164033453058)+(-0.864086447061)*0.5**o
        ref[0,2]=(-0.340253609736)/(o+1.)+(0.0884710081389)+(-0.397179114534)*0.5**o
        ref[0,3]=(-0.809567026065)/(o+1.)+(-0.340798304543)+(-0.9155191116)*0.5**o
        ref[0,4]=(0.190191799833)/(o+1.)+(0.0967936997578)+(-0.416764684181)*0.5**o
        ref[1,0]=(0.42669563245)/(o+1.)+(-0.261174037671)+(0.646527294535)*0.5**o
        ref[1,1]=(-0.904886020892)/(o+1.)+(-0.280896048722)+(-0.411532647934)*0.5**o
        ref[1,2]=(-0.707740568617)/(o+1.)+(0.385941974247)+(0.523024622808)*0.5**o
        ref[1,3]=(0.996017554392)/(o+1.)+(-0.567056235751)+(0.840649917357)*0.5**o
        ref[1,4]=(-0.925675237951)/(o+1.)+(-0.944082818268)+(0.76711764419)*0.5**o
        ref[2,0]=(-0.891195618193)/(o+1.)+(0.826823686857)+(0.198547103682)*0.5**o
        ref[2,1]=(0.467578393374)/(o+1.)+(0.29711684241)+(0.171629921737)*0.5**o
        ref[2,2]=(0.61637733965)/(o+1.)+(-0.231823010061)+(-0.637526271497)*0.5**o
        ref[2,3]=(0.582584591946)/(o+1.)+(0.123559300208)+(-0.205861963967)*0.5**o
        ref[2,4]=(0.598342895007)/(o+1.)+(0.0881118129495)+(-0.179355911316)*0.5**o
        ref[3,0]=(-0.524275825864)/(o+1.)+(-0.105892595089)+(0.150471526119)*0.5**o
        ref[3,1]=(0.203730760507)/(o+1.)+(0.522211666732)+(0.123933417087)*0.5**o
        ref[3,2]=(-0.0830931256847)/(o+1.)+(0.269776128643)+(-0.297766950847)*0.5**o
        ref[3,3]=(-0.811142762589)/(o+1.)+(-0.0285650081177)+(0.96961517265)*0.5**o
        ref[3,4]=(-0.884651038732)/(o+1.)+(-0.105519021111)+(-0.314185602206)*0.5**o
      else:
        arg[0,0]=(0.264691789613)*x[0]**o+(0.816541340997)*x[0]+(-0.402990464667)*x[1]**o+(-0.57479619687)*x[1]+(0.336313666995)*x[2]**o+(-0.353125285536)*x[2]
        arg[0,1]=(-0.0526559162494)*x[0]**o+(-0.901336706583)*x[0]+(0.237482536727)*x[1]**o+(-0.458564275773)*x[1]+(-0.90715992057)*x[2]**o+(-0.352062856077)*x[2]
        arg[0,2]=(0.786349112412)*x[0]**o+(-0.395569856472)*x[0]+(-0.996593023157)*x[1]**o+(-0.277001350627)*x[1]+(0.435375913289)*x[2]**o+(0.00380742297736)*x[2]
        arg[0,3]=(0.3336751197)*x[0]**o+(0.592185657129)*x[0]+(0.148956266814)*x[1]**o+(-0.852264651722)*x[1]+(-0.680249245511)*x[2]**o+(0.238843544413)*x[2]
        arg[0,4]=(0.875206676786)*x[0]**o+(0.0420423017124)*x[0]+(-0.690488811412)*x[1]**o+(-0.191328696331)*x[1]+(-0.861423624177)*x[2]**o+(0.483925405411)*x[2]
        arg[1,0]=(-0.573216715158)*x[0]**o+(-0.0668114726198)*x[0]+(0.382097918101)*x[1]**o+(-0.126485626438)*x[1]+(0.37521336616)*x[2]**o+(0.42402066058)*x[2]
        arg[1,1]=(-0.0919326514467)*x[0]**o+(-0.791351880042)*x[0]+(0.772694542694)*x[1]**o+(-0.537902003787)*x[1]+(0.424413342503)*x[2]**o+(-0.285553230731)*x[2]
        arg[1,2]=(0.855490362389)*x[0]**o+(0.60428104628)*x[0]+(-0.846565232506)*x[1]**o+(-0.243727717758)*x[1]+(0.900077399935)*x[2]**o+(-0.974305489047)*x[2]
        arg[1,3]=(-0.90802343526)*x[0]**o+(0.00950587842259)*x[0]+(0.821234711321)*x[1]**o+(-0.0628912085092)*x[1]+(-0.773563396868)*x[2]**o+(-0.403955952419)*x[2]
        arg[1,4]=(-0.33139358787)*x[0]**o+(-0.901382943687)*x[0]+(-0.981921375707)*x[1]**o+(-0.0654519807133)*x[1]+(0.880069861158)*x[2]**o+(-0.0796172270076)*x[2]
        arg[2,0]=(-0.202818692518)*x[0]**o+(-0.155436611971)*x[0]+(0.739467305515)*x[1]**o+(-0.12096877475)*x[1]+(0.479644796804)*x[2]**o+(0.0580715322389)*x[2]
        arg[2,1]=(0.0461326006936)*x[0]**o+(0.122168224674)*x[0]+(0.986788073931)*x[1]**o+(-0.435933938764)*x[1]+(-0.312527130215)*x[2]**o+(0.726805187165)*x[2]
        arg[2,2]=(-0.539659153805)*x[0]**o+(-0.26082353681)*x[0]+(0.367739719819)*x[1]**o+(0.943584828354)*x[1]+(0.688225221556)*x[2]**o+(-0.121563525696)*x[2]
        arg[2,3]=(0.861717128203)*x[0]**o+(0.0666983176426)*x[0]+(0.984510848927)*x[1]**o+(-0.321865378029)*x[1]+(0.522584734)*x[2]**o+(0.589527116625)*x[2]
        arg[2,4]=(0.778575699703)*x[0]**o+(0.515802361664)*x[0]+(0.817655905624)*x[1]**o+(0.883824717911)*x[1]+(0.656833761714)*x[2]**o+(-0.991585145611)*x[2]
        arg[3,0]=(0.752875513075)*x[0]**o+(0.615136567082)*x[0]+(-0.205265870704)*x[1]**o+(0.483918142728)*x[1]+(-0.0495322147557)*x[2]**o+(-0.132474571954)*x[2]
        arg[3,1]=(0.0563875061408)*x[0]**o+(-0.603033440119)*x[0]+(-0.0944809376206)*x[1]**o+(0.725330686731)*x[1]+(0.00527671533343)*x[2]**o+(-0.434519675586)*x[2]
        arg[3,2]=(0.100078550382)*x[0]**o+(-0.340988639989)*x[0]+(-0.392591649097)*x[1]**o+(-0.924705734588)*x[1]+(0.420410192075)*x[2]**o+(-0.94741221593)*x[2]
        arg[3,3]=(0.536414145801)*x[0]**o+(0.142421640429)*x[0]+(0.213162255423)*x[1]**o+(-0.695193008147)*x[1]+(0.9625091599)*x[2]**o+(0.534409542153)*x[2]
        arg[3,4]=(0.305683606235)*x[0]**o+(0.340964210305)*x[0]+(0.757807973246)*x[1]**o+(0.11459551493)*x[1]+(-0.81395047506)*x[2]**o+(0.636392281491)*x[2]
        ref[0,0]=(-0.0666767976714)/(o+1.)+(-0.0556900707042)+(0.264691789613)*0.5**o
        ref[0,1]=(-0.669677383843)/(o+1.)+(-0.855981919217)+(-0.0526559162494)*0.5**o
        ref[0,2]=(-0.561217109869)/(o+1.)+(-0.334381892061)+(0.786349112412)*0.5**o
        ref[0,3]=(-0.531292978697)/(o+1.)+(-0.0106177250896)+(0.3336751197)*0.5**o
        ref[0,4]=(-1.55191243559)/(o+1.)+(0.167319505396)+(0.875206676786)*0.5**o
        ref[1,0]=(0.757311284261)/(o+1.)+(0.115361780761)+(-0.573216715158)*0.5**o
        ref[1,1]=(1.1971078852)/(o+1.)+(-0.80740355728)+(-0.0919326514467)*0.5**o
        ref[1,2]=(0.0535121674292)/(o+1.)+(-0.306876080263)+(0.855490362389)*0.5**o
        ref[1,3]=(0.0476713144526)/(o+1.)+(-0.228670641253)+(-0.90802343526)*0.5**o
        ref[1,4]=(-0.101851514548)/(o+1.)+(-0.523226075704)+(-0.33139358787)*0.5**o
        ref[2,0]=(1.21911210232)/(o+1.)+(-0.109166927241)+(-0.202818692518)*0.5**o
        ref[2,1]=(0.674260943716)/(o+1.)+(0.206519736538)+(0.0461326006936)*0.5**o
        ref[2,2]=(1.05596494137)/(o+1.)+(0.280598882924)+(-0.539659153805)*0.5**o
        ref[2,3]=(1.50709558293)/(o+1.)+(0.167180028119)+(0.861717128203)*0.5**o
        ref[2,4]=(1.47448966734)/(o+1.)+(0.204020966982)+(0.778575699703)*0.5**o
        ref[3,0]=(-0.25479808546)/(o+1.)+(0.483290068928)+(0.752875513075)*0.5**o
        ref[3,1]=(-0.0892042222872)/(o+1.)+(-0.156111214487)+(0.0563875061408)*0.5**o
        ref[3,2]=(0.0278185429781)/(o+1.)+(-1.10655329525)+(0.100078550382)*0.5**o
        ref[3,3]=(1.17567141532)/(o+1.)+(-0.00918091278228)+(0.536414145801)*0.5**o
        ref[3,4]=(-0.0561425018138)/(o+1.)+(0.545976003363)+(0.305683606235)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(0.448877659671)*x[0]**o+(0.130599173692)*x[0]+(-0.264185555629)*x[1]**o+(-0.722726040492)*x[1]
        arg[0,0,1]=(-0.543806308372)*x[0]**o+(-0.685242399166)*x[0]+(0.325336801501)*x[1]**o+(0.572960380228)*x[1]
        arg[0,1,0]=(-0.893080563297)*x[0]**o+(-0.251553981066)*x[0]+(0.256078388483)*x[1]**o+(-0.926701685259)*x[1]
        arg[0,1,1]=(0.346088914447)*x[0]**o+(0.166180418696)*x[0]+(0.353024178635)*x[1]**o+(0.731811935721)*x[1]
        arg[1,0,0]=(0.553083243483)*x[0]**o+(0.976153803522)*x[0]+(-0.260777317634)*x[1]**o+(-0.641936915628)*x[1]
        arg[1,0,1]=(-0.561076901068)*x[0]**o+(0.837832618302)*x[0]+(-0.638970151828)*x[1]**o+(-0.495169195543)*x[1]
        arg[1,1,0]=(-0.292805925132)*x[0]**o+(0.670472035586)*x[0]+(-0.752026521307)*x[1]**o+(-0.473087472861)*x[1]
        arg[1,1,1]=(-0.432857805275)*x[0]**o+(0.495387797249)*x[0]+(0.0579881469257)*x[1]**o+(0.831644440274)*x[1]
        arg[2,0,0]=(0.413433231384)*x[0]**o+(0.919831571878)*x[0]+(-0.373581626416)*x[1]**o+(0.16423318333)*x[1]
        arg[2,0,1]=(0.857566619293)*x[0]**o+(0.340454525569)*x[0]+(0.139298007219)*x[1]**o+(0.220542978265)*x[1]
        arg[2,1,0]=(-0.914184896115)*x[0]**o+(-0.0279186159835)*x[0]+(0.893417478351)*x[1]**o+(-0.108178714604)*x[1]
        arg[2,1,1]=(-0.749629612712)*x[0]**o+(-0.649957092299)*x[0]+(0.181944194719)*x[1]**o+(-0.988782927329)*x[1]
        arg[3,0,0]=(0.292013067678)*x[0]**o+(0.491680364317)*x[0]+(0.951144487798)*x[1]**o+(0.980949630108)*x[1]
        arg[3,0,1]=(0.89779245885)*x[0]**o+(-0.147546711846)*x[0]+(0.0902450198362)*x[1]**o+(-0.669984062969)*x[1]
        arg[3,1,0]=(0.62590631314)*x[0]**o+(0.329384454978)*x[0]+(-0.676917185409)*x[1]**o+(-0.0903173226074)*x[1]
        arg[3,1,1]=(-0.668268661271)*x[0]**o+(-0.847167879584)*x[0]+(0.329431843319)*x[1]**o+(-0.989253343115)*x[1]
        arg[4,0,0]=(-0.675111374291)*x[0]**o+(0.738030423939)*x[0]+(-0.413299452027)*x[1]**o+(0.36859580301)*x[1]
        arg[4,0,1]=(-0.207625666422)*x[0]**o+(-0.455639256266)*x[0]+(0.554118743878)*x[1]**o+(0.14044849621)*x[1]
        arg[4,1,0]=(-0.313337039275)*x[0]**o+(-0.451797308521)*x[0]+(0.201296275104)*x[1]**o+(-0.779869953962)*x[1]
        arg[4,1,1]=(-0.0308697706768)*x[0]**o+(0.214664850788)*x[0]+(-0.824157101269)*x[1]**o+(0.156012836486)*x[1]
        arg[5,0,0]=(0.277885566309)*x[0]**o+(-0.387820938776)*x[0]+(0.820602896312)*x[1]**o+(0.162715513355)*x[1]
        arg[5,0,1]=(-0.216951421349)*x[0]**o+(0.906019329549)*x[0]+(-0.330132336808)*x[1]**o+(0.416109194357)*x[1]
        arg[5,1,0]=(0.923496627826)*x[0]**o+(-0.177644464371)*x[0]+(0.482278717995)*x[1]**o+(-0.362003106154)*x[1]
        arg[5,1,1]=(0.9109111591)*x[0]**o+(-0.0919782899769)*x[0]+(0.103950387446)*x[1]**o+(0.447452648868)*x[1]
        ref[0,0,0]=(-0.264185555629)/(o+1.)+(-0.2960634334)+(0.448877659671)*0.5**o
        ref[0,0,1]=(0.325336801501)/(o+1.)+(-0.0561410094689)+(-0.543806308372)*0.5**o
        ref[0,1,0]=(0.256078388483)/(o+1.)+(-0.589127833162)+(-0.893080563297)*0.5**o
        ref[0,1,1]=(0.353024178635)/(o+1.)+(0.448996177208)+(0.346088914447)*0.5**o
        ref[1,0,0]=(-0.260777317634)/(o+1.)+(0.167108443947)+(0.553083243483)*0.5**o
        ref[1,0,1]=(-0.638970151828)/(o+1.)+(0.17133171138)+(-0.561076901068)*0.5**o
        ref[1,1,0]=(-0.752026521307)/(o+1.)+(0.0986922813626)+(-0.292805925132)*0.5**o
        ref[1,1,1]=(0.0579881469257)/(o+1.)+(0.663516118762)+(-0.432857805275)*0.5**o
        ref[2,0,0]=(-0.373581626416)/(o+1.)+(0.542032377604)+(0.413433231384)*0.5**o
        ref[2,0,1]=(0.139298007219)/(o+1.)+(0.280498751917)+(0.857566619293)*0.5**o
        ref[2,1,0]=(0.893417478351)/(o+1.)+(-0.0680486652939)+(-0.914184896115)*0.5**o
        ref[2,1,1]=(0.181944194719)/(o+1.)+(-0.819370009814)+(-0.749629612712)*0.5**o
        ref[3,0,0]=(0.951144487798)/(o+1.)+(0.736314997212)+(0.292013067678)*0.5**o
        ref[3,0,1]=(0.0902450198362)/(o+1.)+(-0.408765387408)+(0.89779245885)*0.5**o
        ref[3,1,0]=(-0.676917185409)/(o+1.)+(0.119533566185)+(0.62590631314)*0.5**o
        ref[3,1,1]=(0.329431843319)/(o+1.)+(-0.91821061135)+(-0.668268661271)*0.5**o
        ref[4,0,0]=(-0.413299452027)/(o+1.)+(0.553313113475)+(-0.675111374291)*0.5**o
        ref[4,0,1]=(0.554118743878)/(o+1.)+(-0.157595380028)+(-0.207625666422)*0.5**o
        ref[4,1,0]=(0.201296275104)/(o+1.)+(-0.615833631241)+(-0.313337039275)*0.5**o
        ref[4,1,1]=(-0.824157101269)/(o+1.)+(0.185338843637)+(-0.0308697706768)*0.5**o
        ref[5,0,0]=(0.820602896312)/(o+1.)+(-0.11255271271)+(0.277885566309)*0.5**o
        ref[5,0,1]=(-0.330132336808)/(o+1.)+(0.661064261953)+(-0.216951421349)*0.5**o
        ref[5,1,0]=(0.482278717995)/(o+1.)+(-0.269823785262)+(0.923496627826)*0.5**o
        ref[5,1,1]=(0.103950387446)/(o+1.)+(0.177737179446)+(0.9109111591)*0.5**o
      else:
        arg[0,0,0]=(0.843169691966)*x[0]**o+(0.252560741792)*x[0]+(0.0428740803857)*x[1]**o+(-0.702885246223)*x[1]+(0.175406156382)*x[2]**o+(-0.819206174419)*x[2]
        arg[0,0,1]=(-0.780678250187)*x[0]**o+(-0.628781977796)*x[0]+(0.345241549754)*x[1]**o+(-0.686783366275)*x[1]+(0.298501249797)*x[2]**o+(-0.592222734778)*x[2]
        arg[0,1,0]=(0.680331984783)*x[0]**o+(0.20945731105)*x[0]+(0.582220641498)*x[1]**o+(0.159144772508)*x[1]+(0.197544685245)*x[2]**o+(-0.542847499692)*x[2]
        arg[0,1,1]=(0.561649107089)*x[0]**o+(0.409538404439)*x[0]+(0.687461001448)*x[1]**o+(0.327986995905)*x[1]+(0.701007758697)*x[2]**o+(0.95919995454)*x[2]
        arg[1,0,0]=(0.0620287124894)*x[0]**o+(-0.946536581396)*x[0]+(-0.813637608115)*x[1]**o+(0.0808967031579)*x[1]+(0.545408819059)*x[2]**o+(0.250558134093)*x[2]
        arg[1,0,1]=(-0.0778300410758)*x[0]**o+(-0.852201314682)*x[0]+(0.712528858815)*x[1]**o+(-0.69009644973)*x[1]+(-0.0836140529567)*x[2]**o+(0.687579338803)*x[2]
        arg[1,1,0]=(-0.37648103863)*x[0]**o+(-0.264461846666)*x[0]+(-0.45921598716)*x[1]**o+(-0.516551658367)*x[1]+(0.512446750786)*x[2]**o+(0.850266522322)*x[2]
        arg[1,1,1]=(-0.951741356481)*x[0]**o+(-0.989023540683)*x[0]+(0.338787640816)*x[1]**o+(0.764043925298)*x[1]+(0.524009019713)*x[2]**o+(-0.912507794534)*x[2]
        arg[2,0,0]=(0.613468181683)*x[0]**o+(-0.357325179573)*x[0]+(0.153221256731)*x[1]**o+(-0.748686771579)*x[1]+(0.364085012368)*x[2]**o+(-0.134535056195)*x[2]
        arg[2,0,1]=(-0.728948376511)*x[0]**o+(-0.0657162843876)*x[0]+(-0.336013775703)*x[1]**o+(0.299044747397)*x[1]+(-0.712877779871)*x[2]**o+(0.229974926734)*x[2]
        arg[2,1,0]=(-0.213428159952)*x[0]**o+(0.680250111549)*x[0]+(-0.986942572737)*x[1]**o+(0.549006049647)*x[1]+(0.572921637402)*x[2]**o+(-0.241851127933)*x[2]
        arg[2,1,1]=(0.0367155018841)*x[0]**o+(-0.768111161527)*x[0]+(-0.748085216726)*x[1]**o+(-0.752536272228)*x[1]+(0.555945063877)*x[2]**o+(0.012687074005)*x[2]
        arg[3,0,0]=(-0.945391902075)*x[0]**o+(-0.581330133808)*x[0]+(-0.253390460088)*x[1]**o+(-0.885589795648)*x[1]+(-0.555900062171)*x[2]**o+(-0.241006607054)*x[2]
        arg[3,0,1]=(0.924110231188)*x[0]**o+(0.428520753545)*x[0]+(0.187773835144)*x[1]**o+(-0.53787305121)*x[1]+(0.0970284978901)*x[2]**o+(0.0580212350951)*x[2]
        arg[3,1,0]=(0.426389283701)*x[0]**o+(-0.0976148877161)*x[0]+(-0.364828466078)*x[1]**o+(-0.536398529197)*x[1]+(0.648605043498)*x[2]**o+(-0.234629706559)*x[2]
        arg[3,1,1]=(-0.736098543054)*x[0]**o+(0.985014182905)*x[0]+(-0.563513361433)*x[1]**o+(0.589434310221)*x[1]+(-0.360296462891)*x[2]**o+(-0.586591636182)*x[2]
        arg[4,0,0]=(0.953916732391)*x[0]**o+(-0.835620914249)*x[0]+(0.562803727423)*x[1]**o+(-0.904263689551)*x[1]+(-0.349815820142)*x[2]**o+(-0.156410988081)*x[2]
        arg[4,0,1]=(-0.236710267891)*x[0]**o+(0.958992060128)*x[0]+(0.711565908363)*x[1]**o+(-0.639771085045)*x[1]+(-0.919042661652)*x[2]**o+(-0.198907436333)*x[2]
        arg[4,1,0]=(0.275058935551)*x[0]**o+(0.563461500878)*x[0]+(0.438833998471)*x[1]**o+(0.686375712335)*x[1]+(-0.930322605963)*x[2]**o+(0.710777122765)*x[2]
        arg[4,1,1]=(-0.507845102241)*x[0]**o+(-0.390574086909)*x[0]+(-0.170020669232)*x[1]**o+(-0.107455242464)*x[1]+(-0.97056652533)*x[2]**o+(-0.720180192255)*x[2]
        arg[5,0,0]=(-0.922597172214)*x[0]**o+(0.229197305733)*x[0]+(-0.943214499543)*x[1]**o+(0.269256599046)*x[1]+(-0.11540537404)*x[2]**o+(0.956940487934)*x[2]
        arg[5,0,1]=(-0.0350868975578)*x[0]**o+(-0.547620412319)*x[0]+(-0.818344866429)*x[1]**o+(-0.0632082353078)*x[1]+(-0.490536679501)*x[2]**o+(-0.79641747407)*x[2]
        arg[5,1,0]=(0.877279477171)*x[0]**o+(-0.408752853807)*x[0]+(0.143432191997)*x[1]**o+(0.230679627667)*x[1]+(0.0346230515425)*x[2]**o+(0.357377660033)*x[2]
        arg[5,1,1]=(0.294375780312)*x[0]**o+(-0.688447065878)*x[0]+(0.213334642918)*x[1]**o+(0.664021137697)*x[1]+(-0.532996065961)*x[2]**o+(0.794315136407)*x[2]
        ref[0,0,0]=(0.218280236768)/(o+1.)+(-0.634765339425)+(0.843169691966)*0.5**o
        ref[0,0,1]=(0.64374279955)/(o+1.)+(-0.953894039424)+(-0.780678250187)*0.5**o
        ref[0,1,0]=(0.779765326742)/(o+1.)+(-0.0871227080671)+(0.680331984783)*0.5**o
        ref[0,1,1]=(1.38846876015)/(o+1.)+(0.848362677442)+(0.561649107089)*0.5**o
        ref[1,0,0]=(-0.268228789055)/(o+1.)+(-0.307540872072)+(0.0620287124894)*0.5**o
        ref[1,0,1]=(0.628914805859)/(o+1.)+(-0.427359212804)+(-0.0778300410758)*0.5**o
        ref[1,1,0]=(0.0532307636262)/(o+1.)+(0.0346265086445)+(-0.37648103863)*0.5**o
        ref[1,1,1]=(0.862796660529)/(o+1.)+(-0.56874370496)+(-0.951741356481)*0.5**o
        ref[2,0,0]=(0.5173062691)/(o+1.)+(-0.620273503673)+(0.613468181683)*0.5**o
        ref[2,0,1]=(-1.04889155557)/(o+1.)+(0.231651694871)+(-0.728948376511)*0.5**o
        ref[2,1,0]=(-0.414020935335)/(o+1.)+(0.493702516631)+(-0.213428159952)*0.5**o
        ref[2,1,1]=(-0.192140152849)/(o+1.)+(-0.753980179875)+(0.0367155018841)*0.5**o
        ref[3,0,0]=(-0.809290522259)/(o+1.)+(-0.853963268255)+(-0.945391902075)*0.5**o
        ref[3,0,1]=(0.284802333034)/(o+1.)+(-0.0256655312851)+(0.924110231188)*0.5**o
        ref[3,1,0]=(0.28377657742)/(o+1.)+(-0.434321561736)+(0.426389283701)*0.5**o
        ref[3,1,1]=(-0.923809824324)/(o+1.)+(0.493928428472)+(-0.736098543054)*0.5**o
        ref[4,0,0]=(0.212987907281)/(o+1.)+(-0.948147795941)+(0.953916732391)*0.5**o
        ref[4,0,1]=(-0.207476753289)/(o+1.)+(0.0601567693744)+(-0.236710267891)*0.5**o
        ref[4,1,0]=(-0.491488607492)/(o+1.)+(0.980307167989)+(0.275058935551)*0.5**o
        ref[4,1,1]=(-1.14058719456)/(o+1.)+(-0.609104760814)+(-0.507845102241)*0.5**o
        ref[5,0,0]=(-1.05861987358)/(o+1.)+(0.727697196357)+(-0.922597172214)*0.5**o
        ref[5,0,1]=(-1.30888154593)/(o+1.)+(-0.703623060848)+(-0.0350868975578)*0.5**o
        ref[5,1,0]=(0.17805524354)/(o+1.)+(0.0896522169463)+(0.877279477171)*0.5**o
        ref[5,1,1]=(-0.319661423044)/(o+1.)+(0.384944604113)+(0.294375780312)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.182956096072)*x[0]**o+(0.857065806542)*x[0]+(-0.0352052809673)*x[1]**o+(0.950661773214)*x[1]
        arg[0,0,0,1]=(-0.81342189211)*x[0]**o+(0.36137453013)*x[0]+(0.0610373691872)*x[1]**o+(-0.974859653337)*x[1]
        arg[0,0,1,0]=(-0.149103531408)*x[0]**o+(0.853517194849)*x[0]+(0.623943596759)*x[1]**o+(0.441477983782)*x[1]
        arg[0,0,1,1]=(0.74912087771)*x[0]**o+(0.935896347068)*x[0]+(0.136600247183)*x[1]**o+(0.915043476739)*x[1]
        arg[0,0,2,0]=(-0.289042694587)*x[0]**o+(-0.0324580134489)*x[0]+(0.966454801911)*x[1]**o+(0.158747002668)*x[1]
        arg[0,0,2,1]=(0.0809737838902)*x[0]**o+(0.483125829124)*x[0]+(-0.156074498516)*x[1]**o+(-0.387215102608)*x[1]
        arg[0,1,0,0]=(0.638822193145)*x[0]**o+(-0.211942445721)*x[0]+(-0.016865109839)*x[1]**o+(-0.596486509057)*x[1]
        arg[0,1,0,1]=(0.611604473356)*x[0]**o+(-0.330484367791)*x[0]+(-0.897448372147)*x[1]**o+(-0.0188556077191)*x[1]
        arg[0,1,1,0]=(-0.745407006471)*x[0]**o+(0.547985829362)*x[0]+(-0.229098133178)*x[1]**o+(0.339357994536)*x[1]
        arg[0,1,1,1]=(0.756528549281)*x[0]**o+(0.0968167016962)*x[0]+(0.481206893907)*x[1]**o+(-0.320299781291)*x[1]
        arg[0,1,2,0]=(0.335544368565)*x[0]**o+(0.143490409353)*x[0]+(0.367303506039)*x[1]**o+(-0.459001464112)*x[1]
        arg[0,1,2,1]=(0.669933676654)*x[0]**o+(0.0679909847194)*x[0]+(0.182483888026)*x[1]**o+(-0.382138842505)*x[1]
        arg[0,2,0,0]=(-0.929163949925)*x[0]**o+(0.670533855076)*x[0]+(0.587675819052)*x[1]**o+(0.221939557678)*x[1]
        arg[0,2,0,1]=(0.639896773528)*x[0]**o+(-0.166901547286)*x[0]+(-0.83934259298)*x[1]**o+(-0.522536841927)*x[1]
        arg[0,2,1,0]=(-0.399556357179)*x[0]**o+(0.860582177909)*x[0]+(0.675592435624)*x[1]**o+(0.77480796903)*x[1]
        arg[0,2,1,1]=(-0.281969675471)*x[0]**o+(-0.250831251067)*x[0]+(0.14396936899)*x[1]**o+(-0.65775670156)*x[1]
        arg[0,2,2,0]=(0.339204154215)*x[0]**o+(0.125319656279)*x[0]+(0.417557775604)*x[1]**o+(-0.985431777777)*x[1]
        arg[0,2,2,1]=(-0.655500794874)*x[0]**o+(-0.419889131296)*x[0]+(-0.0763188160723)*x[1]**o+(0.995600932757)*x[1]
        arg[0,3,0,0]=(-0.483746115201)*x[0]**o+(-0.256632816498)*x[0]+(-0.0533973517656)*x[1]**o+(-0.982541041474)*x[1]
        arg[0,3,0,1]=(0.446810992304)*x[0]**o+(-0.823523374302)*x[0]+(-0.607238533539)*x[1]**o+(-0.97562384609)*x[1]
        arg[0,3,1,0]=(-0.0235907627093)*x[0]**o+(-0.0720587626585)*x[0]+(0.930589323947)*x[1]**o+(0.327916365569)*x[1]
        arg[0,3,1,1]=(0.486342062258)*x[0]**o+(0.430279082913)*x[0]+(0.237445053125)*x[1]**o+(0.577650421809)*x[1]
        arg[0,3,2,0]=(-0.581025309937)*x[0]**o+(0.97026755344)*x[0]+(0.180505264557)*x[1]**o+(0.289585805796)*x[1]
        arg[0,3,2,1]=(-0.523356041281)*x[0]**o+(-0.502230606793)*x[0]+(0.915270822508)*x[1]**o+(0.622076448072)*x[1]
        arg[0,4,0,0]=(-0.584782530121)*x[0]**o+(-0.433761163729)*x[0]+(-0.449731522195)*x[1]**o+(0.392234342377)*x[1]
        arg[0,4,0,1]=(-0.0724106581167)*x[0]**o+(0.76896002907)*x[0]+(0.0374933582543)*x[1]**o+(-0.417790382045)*x[1]
        arg[0,4,1,0]=(0.0460360663465)*x[0]**o+(-0.0343116732267)*x[0]+(0.815864788848)*x[1]**o+(-0.922236546574)*x[1]
        arg[0,4,1,1]=(-0.978584425712)*x[0]**o+(0.249337867126)*x[0]+(-0.822961904166)*x[1]**o+(0.627473480274)*x[1]
        arg[0,4,2,0]=(-0.267227111945)*x[0]**o+(0.791320996051)*x[0]+(0.721009228711)*x[1]**o+(0.00199546728243)*x[1]
        arg[0,4,2,1]=(-0.141372777283)*x[0]**o+(-0.996912487736)*x[0]+(0.94281427253)*x[1]**o+(-0.780685413978)*x[1]
        arg[1,0,0,0]=(-0.721911758033)*x[0]**o+(0.0119756829508)*x[0]+(0.583083015744)*x[1]**o+(0.80826073507)*x[1]
        arg[1,0,0,1]=(0.929636966638)*x[0]**o+(-0.35107696413)*x[0]+(-0.656523378462)*x[1]**o+(0.610681274197)*x[1]
        arg[1,0,1,0]=(0.594847872723)*x[0]**o+(-0.15013091781)*x[0]+(-0.562311637909)*x[1]**o+(0.871283992407)*x[1]
        arg[1,0,1,1]=(0.529274819592)*x[0]**o+(0.998035152453)*x[0]+(-0.265309908189)*x[1]**o+(-0.703391843389)*x[1]
        arg[1,0,2,0]=(0.2321959905)*x[0]**o+(-0.781602927232)*x[0]+(-0.0509405210126)*x[1]**o+(0.839298348419)*x[1]
        arg[1,0,2,1]=(0.0811824999287)*x[0]**o+(0.916373714851)*x[0]+(0.817375877796)*x[1]**o+(-0.926274023089)*x[1]
        arg[1,1,0,0]=(0.418525096774)*x[0]**o+(0.064653235493)*x[0]+(0.15912570069)*x[1]**o+(0.47570489259)*x[1]
        arg[1,1,0,1]=(0.784138248952)*x[0]**o+(-0.715130508682)*x[0]+(-0.299421222048)*x[1]**o+(-0.816706522916)*x[1]
        arg[1,1,1,0]=(-0.911449050332)*x[0]**o+(-0.472182975049)*x[0]+(0.935180253062)*x[1]**o+(0.527208406385)*x[1]
        arg[1,1,1,1]=(-0.378301315644)*x[0]**o+(0.430065353544)*x[0]+(0.827581865806)*x[1]**o+(-0.355263817375)*x[1]
        arg[1,1,2,0]=(-0.882543004053)*x[0]**o+(0.503794963637)*x[0]+(-0.580086073626)*x[1]**o+(0.545676378283)*x[1]
        arg[1,1,2,1]=(-0.116197074531)*x[0]**o+(-0.0629871602139)*x[0]+(0.320343551712)*x[1]**o+(0.0552550885696)*x[1]
        arg[1,2,0,0]=(-0.870347384636)*x[0]**o+(-0.611439594673)*x[0]+(0.707766015783)*x[1]**o+(0.0653036268139)*x[1]
        arg[1,2,0,1]=(-0.219872666014)*x[0]**o+(-0.435867669656)*x[0]+(0.825489444837)*x[1]**o+(-0.737253859382)*x[1]
        arg[1,2,1,0]=(-0.963149287055)*x[0]**o+(0.964306345088)*x[0]+(0.502736178959)*x[1]**o+(0.998017404878)*x[1]
        arg[1,2,1,1]=(-0.586350249194)*x[0]**o+(-0.437455605038)*x[0]+(-0.182719660538)*x[1]**o+(-0.50797820305)*x[1]
        arg[1,2,2,0]=(-0.423818475166)*x[0]**o+(0.290902418459)*x[0]+(-0.304129806418)*x[1]**o+(-0.67571878331)*x[1]
        arg[1,2,2,1]=(0.901384945886)*x[0]**o+(0.0526906910209)*x[0]+(0.438755721196)*x[1]**o+(-0.774352941544)*x[1]
        arg[1,3,0,0]=(-0.797968602257)*x[0]**o+(0.856637297517)*x[0]+(0.427243495756)*x[1]**o+(0.212942988457)*x[1]
        arg[1,3,0,1]=(-0.696126104381)*x[0]**o+(0.616445534254)*x[0]+(-0.943037028688)*x[1]**o+(0.807265721375)*x[1]
        arg[1,3,1,0]=(-0.69028368426)*x[0]**o+(-0.652017674488)*x[0]+(-0.772965740874)*x[1]**o+(-0.726830598291)*x[1]
        arg[1,3,1,1]=(-0.534347181294)*x[0]**o+(-0.861020241321)*x[0]+(-0.250549859157)*x[1]**o+(-0.638289396201)*x[1]
        arg[1,3,2,0]=(-0.827981962115)*x[0]**o+(-0.427544131008)*x[0]+(-0.516514308221)*x[1]**o+(-0.101906062547)*x[1]
        arg[1,3,2,1]=(0.864701869194)*x[0]**o+(0.876327129524)*x[0]+(0.806201346091)*x[1]**o+(0.845259832272)*x[1]
        arg[1,4,0,0]=(-0.589044559231)*x[0]**o+(0.697104039773)*x[0]+(-0.288389617381)*x[1]**o+(0.422618969092)*x[1]
        arg[1,4,0,1]=(0.814971550967)*x[0]**o+(-0.665151459593)*x[0]+(-0.696145763418)*x[1]**o+(0.906949165457)*x[1]
        arg[1,4,1,0]=(0.760190450826)*x[0]**o+(-0.883964913626)*x[0]+(-0.507159320061)*x[1]**o+(-0.15707026975)*x[1]
        arg[1,4,1,1]=(-0.0416603697257)*x[0]**o+(0.560561779164)*x[0]+(0.0153574982122)*x[1]**o+(0.75228872946)*x[1]
        arg[1,4,2,0]=(0.105929120872)*x[0]**o+(0.130738968719)*x[0]+(-0.0991159921294)*x[1]**o+(0.972627650896)*x[1]
        arg[1,4,2,1]=(-0.503911541225)*x[0]**o+(-0.00357063650385)*x[0]+(0.377083955928)*x[1]**o+(0.343010153434)*x[1]
        arg[2,0,0,0]=(0.953733725947)*x[0]**o+(-0.988629842686)*x[0]+(0.196766730386)*x[1]**o+(0.0427993038279)*x[1]
        arg[2,0,0,1]=(0.491469820597)*x[0]**o+(0.708248604732)*x[0]+(-0.600347310418)*x[1]**o+(-0.0380188651191)*x[1]
        arg[2,0,1,0]=(0.615118477478)*x[0]**o+(0.832030863133)*x[0]+(0.783037278839)*x[1]**o+(-0.331824170309)*x[1]
        arg[2,0,1,1]=(-0.806125471265)*x[0]**o+(0.763233458333)*x[0]+(-0.381389710969)*x[1]**o+(0.652974431609)*x[1]
        arg[2,0,2,0]=(-0.831727679795)*x[0]**o+(0.239296785135)*x[0]+(-0.13737609858)*x[1]**o+(0.583210422723)*x[1]
        arg[2,0,2,1]=(-0.805843206194)*x[0]**o+(-0.523576669019)*x[0]+(0.159758297984)*x[1]**o+(-0.298308874886)*x[1]
        arg[2,1,0,0]=(0.589135530105)*x[0]**o+(0.272145879514)*x[0]+(0.325741074892)*x[1]**o+(-0.579782654647)*x[1]
        arg[2,1,0,1]=(0.106049062774)*x[0]**o+(0.790280056075)*x[0]+(0.0171600098883)*x[1]**o+(-0.419540445094)*x[1]
        arg[2,1,1,0]=(-0.181511670026)*x[0]**o+(-0.814531462508)*x[0]+(-0.576165158737)*x[1]**o+(0.679678310717)*x[1]
        arg[2,1,1,1]=(-0.709695453728)*x[0]**o+(-0.489487606257)*x[0]+(-0.424093531654)*x[1]**o+(0.535427169862)*x[1]
        arg[2,1,2,0]=(0.60069280023)*x[0]**o+(-0.909882731214)*x[0]+(0.640141428017)*x[1]**o+(-0.697396064954)*x[1]
        arg[2,1,2,1]=(0.896964594562)*x[0]**o+(0.976387328697)*x[0]+(0.144061490066)*x[1]**o+(0.378042869796)*x[1]
        arg[2,2,0,0]=(0.447633246258)*x[0]**o+(-0.531416367062)*x[0]+(0.199304002742)*x[1]**o+(0.85195706213)*x[1]
        arg[2,2,0,1]=(-0.683614706554)*x[0]**o+(0.933255565209)*x[0]+(-0.328047392082)*x[1]**o+(-0.0865769137182)*x[1]
        arg[2,2,1,0]=(0.22474720984)*x[0]**o+(0.0910500178874)*x[0]+(0.449220001922)*x[1]**o+(-0.0406214557829)*x[1]
        arg[2,2,1,1]=(-0.266419887395)*x[0]**o+(-0.48883285131)*x[0]+(-0.794933934805)*x[1]**o+(0.182439649969)*x[1]
        arg[2,2,2,0]=(0.949852186215)*x[0]**o+(-0.116121704259)*x[0]+(-0.977131144423)*x[1]**o+(0.698402625747)*x[1]
        arg[2,2,2,1]=(-0.0446180768654)*x[0]**o+(-0.742263614438)*x[0]+(-0.898675367333)*x[1]**o+(-0.260891146746)*x[1]
        arg[2,3,0,0]=(0.819774310005)*x[0]**o+(-0.0677371406664)*x[0]+(0.276747165681)*x[1]**o+(-0.42828783)*x[1]
        arg[2,3,0,1]=(-0.391001671385)*x[0]**o+(0.0558814994728)*x[0]+(-0.624786978129)*x[1]**o+(0.178742280566)*x[1]
        arg[2,3,1,0]=(0.904597103646)*x[0]**o+(-0.825472271707)*x[0]+(0.112221476422)*x[1]**o+(0.269349199527)*x[1]
        arg[2,3,1,1]=(-0.190955697638)*x[0]**o+(0.441698994606)*x[0]+(-0.26229840557)*x[1]**o+(0.148974540187)*x[1]
        arg[2,3,2,0]=(-0.873098622934)*x[0]**o+(-0.624915584376)*x[0]+(-0.151646578512)*x[1]**o+(-0.914878228283)*x[1]
        arg[2,3,2,1]=(-0.712569947477)*x[0]**o+(-0.72679361801)*x[0]+(-0.0946869166491)*x[1]**o+(-0.580512407933)*x[1]
        arg[2,4,0,0]=(-0.655752680768)*x[0]**o+(-0.409544975855)*x[0]+(0.865325438086)*x[1]**o+(-0.227397026937)*x[1]
        arg[2,4,0,1]=(0.670566711209)*x[0]**o+(-0.794343533883)*x[0]+(-0.127116396219)*x[1]**o+(-0.422419866647)*x[1]
        arg[2,4,1,0]=(0.46903441444)*x[0]**o+(0.0689129759715)*x[0]+(-0.549325647826)*x[1]**o+(0.893700020399)*x[1]
        arg[2,4,1,1]=(-0.0099246750652)*x[0]**o+(0.446742615509)*x[0]+(0.900251202513)*x[1]**o+(0.221599931055)*x[1]
        arg[2,4,2,0]=(0.218854380066)*x[0]**o+(0.877849336909)*x[0]+(-0.338211083089)*x[1]**o+(0.746950973063)*x[1]
        arg[2,4,2,1]=(-0.890762146523)*x[0]**o+(0.439653904008)*x[0]+(0.0802890292215)*x[1]**o+(-0.305233739845)*x[1]
        arg[3,0,0,0]=(0.284622209957)*x[0]**o+(0.983284338924)*x[0]+(-0.732588048234)*x[1]**o+(0.654066388109)*x[1]
        arg[3,0,0,1]=(0.379628076244)*x[0]**o+(-0.75362875047)*x[0]+(0.288422119968)*x[1]**o+(0.139197401407)*x[1]
        arg[3,0,1,0]=(0.0594472092467)*x[0]**o+(-0.391581973307)*x[0]+(-0.898996153568)*x[1]**o+(-2.75165483707e-05)*x[1]
        arg[3,0,1,1]=(-0.241252797172)*x[0]**o+(-0.87384982932)*x[0]+(0.811628957112)*x[1]**o+(0.0170539509618)*x[1]
        arg[3,0,2,0]=(0.255617459837)*x[0]**o+(-0.744071491889)*x[0]+(0.745552769828)*x[1]**o+(0.128612266243)*x[1]
        arg[3,0,2,1]=(0.0725082197254)*x[0]**o+(0.779602587374)*x[0]+(-0.751879287668)*x[1]**o+(0.838360641095)*x[1]
        arg[3,1,0,0]=(-0.444520674459)*x[0]**o+(-0.811442143542)*x[0]+(-0.485010478999)*x[1]**o+(0.727600464745)*x[1]
        arg[3,1,0,1]=(0.260061065042)*x[0]**o+(0.932320346965)*x[0]+(0.556377882844)*x[1]**o+(0.284348284894)*x[1]
        arg[3,1,1,0]=(0.561755002522)*x[0]**o+(-0.842983435746)*x[0]+(0.729209244377)*x[1]**o+(-0.254683846974)*x[1]
        arg[3,1,1,1]=(-0.949556399673)*x[0]**o+(-0.0804522142379)*x[0]+(0.066141483426)*x[1]**o+(0.78626145966)*x[1]
        arg[3,1,2,0]=(0.833198651881)*x[0]**o+(-0.297955946153)*x[0]+(-0.561247934789)*x[1]**o+(-0.645124432611)*x[1]
        arg[3,1,2,1]=(-0.641727656043)*x[0]**o+(0.32981201062)*x[0]+(-0.152588766563)*x[1]**o+(-0.289611460761)*x[1]
        arg[3,2,0,0]=(0.825643539598)*x[0]**o+(0.924286336436)*x[0]+(0.413089850944)*x[1]**o+(-0.640198886209)*x[1]
        arg[3,2,0,1]=(0.0855693847128)*x[0]**o+(-0.363881253576)*x[0]+(0.0397854550832)*x[1]**o+(-0.844391996875)*x[1]
        arg[3,2,1,0]=(-0.8248537795)*x[0]**o+(0.153070857979)*x[0]+(0.970009460355)*x[1]**o+(0.431000028243)*x[1]
        arg[3,2,1,1]=(-0.978024209918)*x[0]**o+(-0.527494257814)*x[0]+(-0.814691105217)*x[1]**o+(0.458334868681)*x[1]
        arg[3,2,2,0]=(0.944359157869)*x[0]**o+(-0.868016282191)*x[0]+(0.410849160429)*x[1]**o+(0.480177162607)*x[1]
        arg[3,2,2,1]=(0.109166287134)*x[0]**o+(0.940100154901)*x[0]+(0.630946061805)*x[1]**o+(0.347160020469)*x[1]
        arg[3,3,0,0]=(0.364585502975)*x[0]**o+(0.717282598047)*x[0]+(0.517805310585)*x[1]**o+(0.963452728824)*x[1]
        arg[3,3,0,1]=(0.0373453558524)*x[0]**o+(0.943887402198)*x[0]+(0.983624425071)*x[1]**o+(-0.396242794059)*x[1]
        arg[3,3,1,0]=(-0.563724031351)*x[0]**o+(0.959753988518)*x[0]+(0.118506885299)*x[1]**o+(-0.587748202342)*x[1]
        arg[3,3,1,1]=(0.460419807013)*x[0]**o+(0.237753399499)*x[0]+(0.585589833251)*x[1]**o+(0.935177937667)*x[1]
        arg[3,3,2,0]=(-0.750248086829)*x[0]**o+(-0.561629848994)*x[0]+(-0.919919077536)*x[1]**o+(0.239984179086)*x[1]
        arg[3,3,2,1]=(-0.0969897163659)*x[0]**o+(0.185433022889)*x[0]+(0.733111631837)*x[1]**o+(-0.508147081928)*x[1]
        arg[3,4,0,0]=(0.247054568876)*x[0]**o+(0.721751593201)*x[0]+(-0.684740924498)*x[1]**o+(0.28395202476)*x[1]
        arg[3,4,0,1]=(-0.0949248638736)*x[0]**o+(0.270285273316)*x[0]+(0.850836559464)*x[1]**o+(-0.771085947382)*x[1]
        arg[3,4,1,0]=(-0.965410502362)*x[0]**o+(-0.582448742001)*x[0]+(-0.90307507827)*x[1]**o+(0.914051445745)*x[1]
        arg[3,4,1,1]=(0.443340058617)*x[0]**o+(0.434462120769)*x[0]+(0.522015964301)*x[1]**o+(-0.520184389865)*x[1]
        arg[3,4,2,0]=(-0.961375562593)*x[0]**o+(-0.474630747481)*x[0]+(0.59574636341)*x[1]**o+(0.434190359663)*x[1]
        arg[3,4,2,1]=(0.174154210501)*x[0]**o+(-0.510858596799)*x[0]+(-0.0279700806065)*x[1]**o+(-0.0401612371912)*x[1]
        ref[0,0,0,0]=(-0.0352052809673)/(o+1.)+(0.903863789878)+(0.182956096072)*0.5**o
        ref[0,0,0,1]=(0.0610373691872)/(o+1.)+(-0.306742561603)+(-0.81342189211)*0.5**o
        ref[0,0,1,0]=(0.623943596759)/(o+1.)+(0.647497589315)+(-0.149103531408)*0.5**o
        ref[0,0,1,1]=(0.136600247183)/(o+1.)+(0.925469911903)+(0.74912087771)*0.5**o
        ref[0,0,2,0]=(0.966454801911)/(o+1.)+(0.0631444946098)+(-0.289042694587)*0.5**o
        ref[0,0,2,1]=(-0.156074498516)/(o+1.)+(0.047955363258)+(0.0809737838902)*0.5**o
        ref[0,1,0,0]=(-0.016865109839)/(o+1.)+(-0.404214477389)+(0.638822193145)*0.5**o
        ref[0,1,0,1]=(-0.897448372147)/(o+1.)+(-0.174669987755)+(0.611604473356)*0.5**o
        ref[0,1,1,0]=(-0.229098133178)/(o+1.)+(0.443671911949)+(-0.745407006471)*0.5**o
        ref[0,1,1,1]=(0.481206893907)/(o+1.)+(-0.111741539797)+(0.756528549281)*0.5**o
        ref[0,1,2,0]=(0.367303506039)/(o+1.)+(-0.157755527379)+(0.335544368565)*0.5**o
        ref[0,1,2,1]=(0.182483888026)/(o+1.)+(-0.157073928893)+(0.669933676654)*0.5**o
        ref[0,2,0,0]=(0.587675819052)/(o+1.)+(0.446236706377)+(-0.929163949925)*0.5**o
        ref[0,2,0,1]=(-0.83934259298)/(o+1.)+(-0.344719194607)+(0.639896773528)*0.5**o
        ref[0,2,1,0]=(0.675592435624)/(o+1.)+(0.81769507347)+(-0.399556357179)*0.5**o
        ref[0,2,1,1]=(0.14396936899)/(o+1.)+(-0.454293976313)+(-0.281969675471)*0.5**o
        ref[0,2,2,0]=(0.417557775604)/(o+1.)+(-0.430056060749)+(0.339204154215)*0.5**o
        ref[0,2,2,1]=(-0.0763188160723)/(o+1.)+(0.28785590073)+(-0.655500794874)*0.5**o
        ref[0,3,0,0]=(-0.0533973517656)/(o+1.)+(-0.619586928986)+(-0.483746115201)*0.5**o
        ref[0,3,0,1]=(-0.607238533539)/(o+1.)+(-0.899573610196)+(0.446810992304)*0.5**o
        ref[0,3,1,0]=(0.930589323947)/(o+1.)+(0.127928801455)+(-0.0235907627093)*0.5**o
        ref[0,3,1,1]=(0.237445053125)/(o+1.)+(0.503964752361)+(0.486342062258)*0.5**o
        ref[0,3,2,0]=(0.180505264557)/(o+1.)+(0.629926679618)+(-0.581025309937)*0.5**o
        ref[0,3,2,1]=(0.915270822508)/(o+1.)+(0.0599229206396)+(-0.523356041281)*0.5**o
        ref[0,4,0,0]=(-0.449731522195)/(o+1.)+(-0.0207634106763)+(-0.584782530121)*0.5**o
        ref[0,4,0,1]=(0.0374933582543)/(o+1.)+(0.175584823513)+(-0.0724106581167)*0.5**o
        ref[0,4,1,0]=(0.815864788848)/(o+1.)+(-0.4782741099)+(0.0460360663465)*0.5**o
        ref[0,4,1,1]=(-0.822961904166)/(o+1.)+(0.4384056737)+(-0.978584425712)*0.5**o
        ref[0,4,2,0]=(0.721009228711)/(o+1.)+(0.396658231667)+(-0.267227111945)*0.5**o
        ref[0,4,2,1]=(0.94281427253)/(o+1.)+(-0.888798950857)+(-0.141372777283)*0.5**o
        ref[1,0,0,0]=(0.583083015744)/(o+1.)+(0.41011820901)+(-0.721911758033)*0.5**o
        ref[1,0,0,1]=(-0.656523378462)/(o+1.)+(0.129802155034)+(0.929636966638)*0.5**o
        ref[1,0,1,0]=(-0.562311637909)/(o+1.)+(0.360576537299)+(0.594847872723)*0.5**o
        ref[1,0,1,1]=(-0.265309908189)/(o+1.)+(0.147321654532)+(0.529274819592)*0.5**o
        ref[1,0,2,0]=(-0.0509405210126)/(o+1.)+(0.0288477105933)+(0.2321959905)*0.5**o
        ref[1,0,2,1]=(0.817375877796)/(o+1.)+(-0.00495015411903)+(0.0811824999287)*0.5**o
        ref[1,1,0,0]=(0.15912570069)/(o+1.)+(0.270179064041)+(0.418525096774)*0.5**o
        ref[1,1,0,1]=(-0.299421222048)/(o+1.)+(-0.765918515799)+(0.784138248952)*0.5**o
        ref[1,1,1,0]=(0.935180253062)/(o+1.)+(0.0275127156677)+(-0.911449050332)*0.5**o
        ref[1,1,1,1]=(0.827581865806)/(o+1.)+(0.0374007680845)+(-0.378301315644)*0.5**o
        ref[1,1,2,0]=(-0.580086073626)/(o+1.)+(0.52473567096)+(-0.882543004053)*0.5**o
        ref[1,1,2,1]=(0.320343551712)/(o+1.)+(-0.00386603582212)+(-0.116197074531)*0.5**o
        ref[1,2,0,0]=(0.707766015783)/(o+1.)+(-0.273067983929)+(-0.870347384636)*0.5**o
        ref[1,2,0,1]=(0.825489444837)/(o+1.)+(-0.586560764519)+(-0.219872666014)*0.5**o
        ref[1,2,1,0]=(0.502736178959)/(o+1.)+(0.981161874983)+(-0.963149287055)*0.5**o
        ref[1,2,1,1]=(-0.182719660538)/(o+1.)+(-0.472716904044)+(-0.586350249194)*0.5**o
        ref[1,2,2,0]=(-0.304129806418)/(o+1.)+(-0.192408182425)+(-0.423818475166)*0.5**o
        ref[1,2,2,1]=(0.438755721196)/(o+1.)+(-0.360831125262)+(0.901384945886)*0.5**o
        ref[1,3,0,0]=(0.427243495756)/(o+1.)+(0.534790142987)+(-0.797968602257)*0.5**o
        ref[1,3,0,1]=(-0.943037028688)/(o+1.)+(0.711855627815)+(-0.696126104381)*0.5**o
        ref[1,3,1,0]=(-0.772965740874)/(o+1.)+(-0.689424136389)+(-0.69028368426)*0.5**o
        ref[1,3,1,1]=(-0.250549859157)/(o+1.)+(-0.749654818761)+(-0.534347181294)*0.5**o
        ref[1,3,2,0]=(-0.516514308221)/(o+1.)+(-0.264725096778)+(-0.827981962115)*0.5**o
        ref[1,3,2,1]=(0.806201346091)/(o+1.)+(0.860793480898)+(0.864701869194)*0.5**o
        ref[1,4,0,0]=(-0.288389617381)/(o+1.)+(0.559861504432)+(-0.589044559231)*0.5**o
        ref[1,4,0,1]=(-0.696145763418)/(o+1.)+(0.120898852932)+(0.814971550967)*0.5**o
        ref[1,4,1,0]=(-0.507159320061)/(o+1.)+(-0.520517591688)+(0.760190450826)*0.5**o
        ref[1,4,1,1]=(0.0153574982122)/(o+1.)+(0.656425254312)+(-0.0416603697257)*0.5**o
        ref[1,4,2,0]=(-0.0991159921294)/(o+1.)+(0.551683309807)+(0.105929120872)*0.5**o
        ref[1,4,2,1]=(0.377083955928)/(o+1.)+(0.169719758465)+(-0.503911541225)*0.5**o
        ref[2,0,0,0]=(0.196766730386)/(o+1.)+(-0.472915269429)+(0.953733725947)*0.5**o
        ref[2,0,0,1]=(-0.600347310418)/(o+1.)+(0.335114869806)+(0.491469820597)*0.5**o
        ref[2,0,1,0]=(0.783037278839)/(o+1.)+(0.250103346412)+(0.615118477478)*0.5**o
        ref[2,0,1,1]=(-0.381389710969)/(o+1.)+(0.708103944971)+(-0.806125471265)*0.5**o
        ref[2,0,2,0]=(-0.13737609858)/(o+1.)+(0.411253603929)+(-0.831727679795)*0.5**o
        ref[2,0,2,1]=(0.159758297984)/(o+1.)+(-0.410942771953)+(-0.805843206194)*0.5**o
        ref[2,1,0,0]=(0.325741074892)/(o+1.)+(-0.153818387566)+(0.589135530105)*0.5**o
        ref[2,1,0,1]=(0.0171600098883)/(o+1.)+(0.185369805491)+(0.106049062774)*0.5**o
        ref[2,1,1,0]=(-0.576165158737)/(o+1.)+(-0.0674265758955)+(-0.181511670026)*0.5**o
        ref[2,1,1,1]=(-0.424093531654)/(o+1.)+(0.0229697818029)+(-0.709695453728)*0.5**o
        ref[2,1,2,0]=(0.640141428017)/(o+1.)+(-0.803639398084)+(0.60069280023)*0.5**o
        ref[2,1,2,1]=(0.144061490066)/(o+1.)+(0.677215099246)+(0.896964594562)*0.5**o
        ref[2,2,0,0]=(0.199304002742)/(o+1.)+(0.160270347534)+(0.447633246258)*0.5**o
        ref[2,2,0,1]=(-0.328047392082)/(o+1.)+(0.423339325745)+(-0.683614706554)*0.5**o
        ref[2,2,1,0]=(0.449220001922)/(o+1.)+(0.0252142810523)+(0.22474720984)*0.5**o
        ref[2,2,1,1]=(-0.794933934805)/(o+1.)+(-0.153196600671)+(-0.266419887395)*0.5**o
        ref[2,2,2,0]=(-0.977131144423)/(o+1.)+(0.291140460744)+(0.949852186215)*0.5**o
        ref[2,2,2,1]=(-0.898675367333)/(o+1.)+(-0.501577380592)+(-0.0446180768654)*0.5**o
        ref[2,3,0,0]=(0.276747165681)/(o+1.)+(-0.248012485333)+(0.819774310005)*0.5**o
        ref[2,3,0,1]=(-0.624786978129)/(o+1.)+(0.11731189002)+(-0.391001671385)*0.5**o
        ref[2,3,1,0]=(0.112221476422)/(o+1.)+(-0.27806153609)+(0.904597103646)*0.5**o
        ref[2,3,1,1]=(-0.26229840557)/(o+1.)+(0.295336767397)+(-0.190955697638)*0.5**o
        ref[2,3,2,0]=(-0.151646578512)/(o+1.)+(-0.76989690633)+(-0.873098622934)*0.5**o
        ref[2,3,2,1]=(-0.0946869166491)/(o+1.)+(-0.653653012971)+(-0.712569947477)*0.5**o
        ref[2,4,0,0]=(0.865325438086)/(o+1.)+(-0.318471001396)+(-0.655752680768)*0.5**o
        ref[2,4,0,1]=(-0.127116396219)/(o+1.)+(-0.608381700265)+(0.670566711209)*0.5**o
        ref[2,4,1,0]=(-0.549325647826)/(o+1.)+(0.481306498185)+(0.46903441444)*0.5**o
        ref[2,4,1,1]=(0.900251202513)/(o+1.)+(0.334171273282)+(-0.0099246750652)*0.5**o
        ref[2,4,2,0]=(-0.338211083089)/(o+1.)+(0.812400154986)+(0.218854380066)*0.5**o
        ref[2,4,2,1]=(0.0802890292215)/(o+1.)+(0.0672100820814)+(-0.890762146523)*0.5**o
        ref[3,0,0,0]=(-0.732588048234)/(o+1.)+(0.818675363516)+(0.284622209957)*0.5**o
        ref[3,0,0,1]=(0.288422119968)/(o+1.)+(-0.307215674532)+(0.379628076244)*0.5**o
        ref[3,0,1,0]=(-0.898996153568)/(o+1.)+(-0.195804744928)+(0.0594472092467)*0.5**o
        ref[3,0,1,1]=(0.811628957112)/(o+1.)+(-0.428397939179)+(-0.241252797172)*0.5**o
        ref[3,0,2,0]=(0.745552769828)/(o+1.)+(-0.307729612823)+(0.255617459837)*0.5**o
        ref[3,0,2,1]=(-0.751879287668)/(o+1.)+(0.808981614234)+(0.0725082197254)*0.5**o
        ref[3,1,0,0]=(-0.485010478999)/(o+1.)+(-0.0419208393982)+(-0.444520674459)*0.5**o
        ref[3,1,0,1]=(0.556377882844)/(o+1.)+(0.60833431593)+(0.260061065042)*0.5**o
        ref[3,1,1,0]=(0.729209244377)/(o+1.)+(-0.54883364136)+(0.561755002522)*0.5**o
        ref[3,1,1,1]=(0.066141483426)/(o+1.)+(0.352904622711)+(-0.949556399673)*0.5**o
        ref[3,1,2,0]=(-0.561247934789)/(o+1.)+(-0.471540189382)+(0.833198651881)*0.5**o
        ref[3,1,2,1]=(-0.152588766563)/(o+1.)+(0.0201002749295)+(-0.641727656043)*0.5**o
        ref[3,2,0,0]=(0.413089850944)/(o+1.)+(0.142043725114)+(0.825643539598)*0.5**o
        ref[3,2,0,1]=(0.0397854550832)/(o+1.)+(-0.604136625225)+(0.0855693847128)*0.5**o
        ref[3,2,1,0]=(0.970009460355)/(o+1.)+(0.292035443111)+(-0.8248537795)*0.5**o
        ref[3,2,1,1]=(-0.814691105217)/(o+1.)+(-0.0345796945668)+(-0.978024209918)*0.5**o
        ref[3,2,2,0]=(0.410849160429)/(o+1.)+(-0.193919559792)+(0.944359157869)*0.5**o
        ref[3,2,2,1]=(0.630946061805)/(o+1.)+(0.643630087685)+(0.109166287134)*0.5**o
        ref[3,3,0,0]=(0.517805310585)/(o+1.)+(0.840367663435)+(0.364585502975)*0.5**o
        ref[3,3,0,1]=(0.983624425071)/(o+1.)+(0.273822304069)+(0.0373453558524)*0.5**o
        ref[3,3,1,0]=(0.118506885299)/(o+1.)+(0.186002893088)+(-0.563724031351)*0.5**o
        ref[3,3,1,1]=(0.585589833251)/(o+1.)+(0.586465668583)+(0.460419807013)*0.5**o
        ref[3,3,2,0]=(-0.919919077536)/(o+1.)+(-0.160822834954)+(-0.750248086829)*0.5**o
        ref[3,3,2,1]=(0.733111631837)/(o+1.)+(-0.161357029519)+(-0.0969897163659)*0.5**o
        ref[3,4,0,0]=(-0.684740924498)/(o+1.)+(0.50285180898)+(0.247054568876)*0.5**o
        ref[3,4,0,1]=(0.850836559464)/(o+1.)+(-0.250400337033)+(-0.0949248638736)*0.5**o
        ref[3,4,1,0]=(-0.90307507827)/(o+1.)+(0.165801351872)+(-0.965410502362)*0.5**o
        ref[3,4,1,1]=(0.522015964301)/(o+1.)+(-0.0428611345479)+(0.443340058617)*0.5**o
        ref[3,4,2,0]=(0.59574636341)/(o+1.)+(-0.0202201939092)+(-0.961375562593)*0.5**o
        ref[3,4,2,1]=(-0.0279700806065)/(o+1.)+(-0.275509916995)+(0.174154210501)*0.5**o
      else:
        arg[0,0,0,0]=(-0.793251694335)*x[0]**o+(0.616970271582)*x[0]+(-0.805609243189)*x[1]**o+(0.949515692474)*x[1]+(0.484069738431)*x[2]**o+(-0.0407533911672)*x[2]
        arg[0,0,0,1]=(-0.624206604764)*x[0]**o+(-0.992961148702)*x[0]+(-0.737741763879)*x[1]**o+(0.161544434398)*x[1]+(0.47292947772)*x[2]**o+(0.525538846945)*x[2]
        arg[0,0,1,0]=(0.115999561481)*x[0]**o+(-0.612694096044)*x[0]+(0.625539443386)*x[1]**o+(0.857353715882)*x[1]+(-0.0811256709155)*x[2]**o+(0.183474706394)*x[2]
        arg[0,0,1,1]=(-0.972466831671)*x[0]**o+(0.262980887655)*x[0]+(0.920924576059)*x[1]**o+(0.983517658667)*x[1]+(0.579443973505)*x[2]**o+(0.101139612823)*x[2]
        arg[0,0,2,0]=(0.708180260094)*x[0]**o+(-0.0950913766285)*x[0]+(0.361602191798)*x[1]**o+(-0.880757848201)*x[1]+(0.326272205058)*x[2]**o+(-0.997155694972)*x[2]
        arg[0,0,2,1]=(0.0282615573045)*x[0]**o+(-0.317851994728)*x[0]+(0.449330147388)*x[1]**o+(-0.156946318079)*x[1]+(0.344196894245)*x[2]**o+(-0.045082290904)*x[2]
        arg[0,1,0,0]=(0.231621820235)*x[0]**o+(0.0985804817846)*x[0]+(-0.343623333022)*x[1]**o+(0.115043475441)*x[1]+(-0.910742772023)*x[2]**o+(-0.663592068553)*x[2]
        arg[0,1,0,1]=(0.114056801155)*x[0]**o+(-0.463711315494)*x[0]+(0.380521147429)*x[1]**o+(0.294823684238)*x[1]+(0.510501672453)*x[2]**o+(-0.161234251875)*x[2]
        arg[0,1,1,0]=(-0.973115195017)*x[0]**o+(-0.0133290715609)*x[0]+(-0.642072931588)*x[1]**o+(-0.580655605735)*x[1]+(-0.191371539061)*x[2]**o+(-0.0513051439064)*x[2]
        arg[0,1,1,1]=(-0.304758579369)*x[0]**o+(-0.321904612871)*x[0]+(-0.389525877547)*x[1]**o+(-0.0602638359252)*x[1]+(0.199726168523)*x[2]**o+(-0.10313327614)*x[2]
        arg[0,1,2,0]=(0.0923844967157)*x[0]**o+(-0.369319307184)*x[0]+(-0.614761123101)*x[1]**o+(0.78817430449)*x[1]+(-0.783809995839)*x[2]**o+(-0.701522582246)*x[2]
        arg[0,1,2,1]=(0.793568921835)*x[0]**o+(0.352244892726)*x[0]+(0.185546719529)*x[1]**o+(0.145969792058)*x[1]+(0.85147546253)*x[2]**o+(-0.862069843156)*x[2]
        arg[0,2,0,0]=(0.570673248048)*x[0]**o+(0.607924942767)*x[0]+(-0.353952625913)*x[1]**o+(0.111796842318)*x[1]+(-0.765670542263)*x[2]**o+(0.589532724922)*x[2]
        arg[0,2,0,1]=(0.299061155215)*x[0]**o+(-0.542978954882)*x[0]+(0.0946151623892)*x[1]**o+(0.310266302534)*x[1]+(-0.00880229885823)*x[2]**o+(0.585508874849)*x[2]
        arg[0,2,1,0]=(0.694725244159)*x[0]**o+(0.530004132186)*x[0]+(-0.32588478629)*x[1]**o+(0.357278329148)*x[1]+(-0.93877612203)*x[2]**o+(0.34973013935)*x[2]
        arg[0,2,1,1]=(-0.83896527178)*x[0]**o+(0.487231460025)*x[0]+(0.493952010418)*x[1]**o+(0.247442509692)*x[1]+(-0.312456515075)*x[2]**o+(0.90248200924)*x[2]
        arg[0,2,2,0]=(0.2228052704)*x[0]**o+(0.901373696962)*x[0]+(0.149826948427)*x[1]**o+(0.234013159005)*x[1]+(0.717685535862)*x[2]**o+(-0.42865545543)*x[2]
        arg[0,2,2,1]=(0.63141216243)*x[0]**o+(0.448446314659)*x[0]+(0.379625538779)*x[1]**o+(-0.807448154272)*x[1]+(0.238724835223)*x[2]**o+(-0.478216911196)*x[2]
        arg[0,3,0,0]=(0.00698107166168)*x[0]**o+(-0.727207190747)*x[0]+(-0.78731647832)*x[1]**o+(0.885371753974)*x[1]+(-0.0146821479126)*x[2]**o+(-0.763310617205)*x[2]
        arg[0,3,0,1]=(0.243423742325)*x[0]**o+(0.0587322175837)*x[0]+(-0.453213790216)*x[1]**o+(0.861270481703)*x[1]+(0.867332526083)*x[2]**o+(-0.713187214416)*x[2]
        arg[0,3,1,0]=(-0.106629554393)*x[0]**o+(0.723693136654)*x[0]+(-0.0276604293602)*x[1]**o+(0.339456904686)*x[1]+(-0.102075459215)*x[2]**o+(-0.0348969356596)*x[2]
        arg[0,3,1,1]=(0.375143733111)*x[0]**o+(-0.490781234413)*x[0]+(0.168903339622)*x[1]**o+(0.594080859808)*x[1]+(-0.0802336915361)*x[2]**o+(0.472348979787)*x[2]
        arg[0,3,2,0]=(0.955685455438)*x[0]**o+(0.105142628533)*x[0]+(-0.446384800971)*x[1]**o+(-0.905998305229)*x[1]+(-0.30011637186)*x[2]**o+(0.0218195326037)*x[2]
        arg[0,3,2,1]=(0.353654445481)*x[0]**o+(-0.0477024594709)*x[0]+(-0.495075817497)*x[1]**o+(-0.425091398447)*x[1]+(-0.571207600446)*x[2]**o+(0.177935012163)*x[2]
        arg[0,4,0,0]=(0.974759684151)*x[0]**o+(-0.876975976179)*x[0]+(-0.472336406836)*x[1]**o+(0.991410874408)*x[1]+(0.297823444758)*x[2]**o+(-0.161436760659)*x[2]
        arg[0,4,0,1]=(-0.0799922241539)*x[0]**o+(0.975369691404)*x[0]+(0.302361880712)*x[1]**o+(0.171779641966)*x[1]+(0.878428630413)*x[2]**o+(0.814497247319)*x[2]
        arg[0,4,1,0]=(0.532633280629)*x[0]**o+(0.902436316468)*x[0]+(-0.676910177358)*x[1]**o+(-0.986029752926)*x[1]+(-0.519990783496)*x[2]**o+(0.430468215617)*x[2]
        arg[0,4,1,1]=(-0.353243658293)*x[0]**o+(-0.908938062877)*x[0]+(0.922933758125)*x[1]**o+(0.00500161721147)*x[1]+(0.189861558609)*x[2]**o+(-0.623307494462)*x[2]
        arg[0,4,2,0]=(-0.720840869801)*x[0]**o+(0.0349736577597)*x[0]+(-0.516608060915)*x[1]**o+(0.688756843577)*x[1]+(-0.302494303699)*x[2]**o+(-0.0703783111937)*x[2]
        arg[0,4,2,1]=(-0.179073400214)*x[0]**o+(0.128485402427)*x[0]+(-0.726789308786)*x[1]**o+(-0.691163482057)*x[1]+(0.329009412577)*x[2]**o+(-0.79293394396)*x[2]
        arg[1,0,0,0]=(-0.384011553333)*x[0]**o+(0.285271264922)*x[0]+(0.512105930181)*x[1]**o+(0.190321101872)*x[1]+(-0.509334982029)*x[2]**o+(0.128097742502)*x[2]
        arg[1,0,0,1]=(-0.808211570649)*x[0]**o+(-0.730450956462)*x[0]+(0.92309757237)*x[1]**o+(-0.703749565272)*x[1]+(0.301129716544)*x[2]**o+(0.244379489105)*x[2]
        arg[1,0,1,0]=(0.0404274840294)*x[0]**o+(-0.483903392253)*x[0]+(0.73680959705)*x[1]**o+(0.190850758522)*x[1]+(0.133136432605)*x[2]**o+(0.910055186498)*x[2]
        arg[1,0,1,1]=(0.302394139901)*x[0]**o+(0.802524687002)*x[0]+(0.970871728408)*x[1]**o+(0.207348092291)*x[1]+(0.666310912781)*x[2]**o+(0.510392805767)*x[2]
        arg[1,0,2,0]=(-0.981981997649)*x[0]**o+(-0.465269233707)*x[0]+(0.916146418639)*x[1]**o+(0.143602438774)*x[1]+(-0.947874263512)*x[2]**o+(0.0840394012229)*x[2]
        arg[1,0,2,1]=(-0.237479805943)*x[0]**o+(-0.89993757244)*x[0]+(-0.759650487895)*x[1]**o+(-0.807139164373)*x[1]+(-0.377055204014)*x[2]**o+(-0.57656201026)*x[2]
        arg[1,1,0,0]=(-0.543719871098)*x[0]**o+(-0.726308160246)*x[0]+(0.821244616742)*x[1]**o+(0.718112961487)*x[1]+(-0.655445553192)*x[2]**o+(-0.599104608292)*x[2]
        arg[1,1,0,1]=(-0.2624625471)*x[0]**o+(0.85250071151)*x[0]+(-0.665066081561)*x[1]**o+(-0.566502138196)*x[1]+(-0.572858653628)*x[2]**o+(-0.862890633323)*x[2]
        arg[1,1,1,0]=(0.88003513115)*x[0]**o+(-0.0150959972442)*x[0]+(-0.698880737368)*x[1]**o+(-0.236909810427)*x[1]+(-0.721315930706)*x[2]**o+(-0.219894530829)*x[2]
        arg[1,1,1,1]=(0.177746615088)*x[0]**o+(0.205790814183)*x[0]+(-0.216021190604)*x[1]**o+(0.384079010991)*x[1]+(0.61634008905)*x[2]**o+(0.940900776108)*x[2]
        arg[1,1,2,0]=(0.889070121473)*x[0]**o+(0.68131533527)*x[0]+(0.709207182081)*x[1]**o+(-0.765184991252)*x[1]+(0.506328018952)*x[2]**o+(-0.46041174473)*x[2]
        arg[1,1,2,1]=(0.951736215954)*x[0]**o+(-0.147499702642)*x[0]+(0.60348358384)*x[1]**o+(0.777404433567)*x[1]+(-0.482441452679)*x[2]**o+(0.714835256434)*x[2]
        arg[1,2,0,0]=(-0.954701036263)*x[0]**o+(-0.360901887475)*x[0]+(-0.644285028623)*x[1]**o+(0.169271524632)*x[1]+(-0.687047203668)*x[2]**o+(0.205115312108)*x[2]
        arg[1,2,0,1]=(0.256489282842)*x[0]**o+(0.17406448362)*x[0]+(0.97500243816)*x[1]**o+(0.614577997602)*x[1]+(0.0537536804583)*x[2]**o+(-0.211963274032)*x[2]
        arg[1,2,1,0]=(-0.94015914517)*x[0]**o+(0.169982490736)*x[0]+(0.482085495724)*x[1]**o+(-0.556994404153)*x[1]+(-0.809311296883)*x[2]**o+(0.719907503024)*x[2]
        arg[1,2,1,1]=(0.367156421931)*x[0]**o+(0.489648825153)*x[0]+(-0.0398225517816)*x[1]**o+(-0.495726296032)*x[1]+(0.359374061053)*x[2]**o+(0.231991952482)*x[2]
        arg[1,2,2,0]=(-0.812516694781)*x[0]**o+(-0.631181257391)*x[0]+(-0.723784471687)*x[1]**o+(0.178976877342)*x[1]+(-0.629293758013)*x[2]**o+(-0.313897724608)*x[2]
        arg[1,2,2,1]=(-0.497461944186)*x[0]**o+(0.268998525103)*x[0]+(-0.478017492026)*x[1]**o+(0.026395792841)*x[1]+(0.581256386137)*x[2]**o+(-0.476961644324)*x[2]
        arg[1,3,0,0]=(-0.227077550639)*x[0]**o+(0.400407424161)*x[0]+(-0.53529812303)*x[1]**o+(-0.418594299853)*x[1]+(-0.195190916346)*x[2]**o+(-0.624284483774)*x[2]
        arg[1,3,0,1]=(0.822091021645)*x[0]**o+(-0.31133140026)*x[0]+(0.0665130965049)*x[1]**o+(0.596697216047)*x[1]+(0.466195828646)*x[2]**o+(-0.477988391299)*x[2]
        arg[1,3,1,0]=(-0.0341577310045)*x[0]**o+(-0.77936644392)*x[0]+(0.954811382784)*x[1]**o+(0.837374830631)*x[1]+(0.738992234768)*x[2]**o+(-0.501187788985)*x[2]
        arg[1,3,1,1]=(-0.102867224088)*x[0]**o+(0.00829793194765)*x[0]+(0.081790556957)*x[1]**o+(-0.779351210472)*x[1]+(-0.735321115716)*x[2]**o+(0.126919542418)*x[2]
        arg[1,3,2,0]=(0.556301076488)*x[0]**o+(0.0923434629749)*x[0]+(-0.191048735713)*x[1]**o+(-0.218833028687)*x[1]+(-0.088867516146)*x[2]**o+(-0.247214200389)*x[2]
        arg[1,3,2,1]=(0.888436531887)*x[0]**o+(-0.79225495914)*x[0]+(0.0154788262219)*x[1]**o+(-0.210622890864)*x[1]+(0.782629134632)*x[2]**o+(0.350772185791)*x[2]
        arg[1,4,0,0]=(0.651898073685)*x[0]**o+(-0.84098616689)*x[0]+(0.674088959443)*x[1]**o+(-0.658824952898)*x[1]+(-0.423551541558)*x[2]**o+(0.985098530356)*x[2]
        arg[1,4,0,1]=(-0.149187282052)*x[0]**o+(0.0880370482988)*x[0]+(0.780809276595)*x[1]**o+(-0.610833366472)*x[1]+(0.794946384304)*x[2]**o+(-0.817031796429)*x[2]
        arg[1,4,1,0]=(-0.285938055108)*x[0]**o+(-0.106165154734)*x[0]+(-0.948376845189)*x[1]**o+(0.874607682056)*x[1]+(-0.100051825909)*x[2]**o+(-0.483640835026)*x[2]
        arg[1,4,1,1]=(-0.34015136472)*x[0]**o+(0.991331180352)*x[0]+(-0.925796518928)*x[1]**o+(-0.872775691287)*x[1]+(0.953898056819)*x[2]**o+(0.985025365955)*x[2]
        arg[1,4,2,0]=(-0.464687865356)*x[0]**o+(-0.439271850879)*x[0]+(0.302716649876)*x[1]**o+(0.235186289965)*x[1]+(0.672062761925)*x[2]**o+(-0.793689262392)*x[2]
        arg[1,4,2,1]=(-0.777967458564)*x[0]**o+(0.0565891925223)*x[0]+(-0.27539733623)*x[1]**o+(0.252329868046)*x[1]+(-0.269529792944)*x[2]**o+(-0.953051723483)*x[2]
        arg[2,0,0,0]=(0.665321754689)*x[0]**o+(0.00639681939987)*x[0]+(0.262193891905)*x[1]**o+(-0.312800735151)*x[1]+(0.8403244871)*x[2]**o+(-0.607084328204)*x[2]
        arg[2,0,0,1]=(0.876435018569)*x[0]**o+(-0.388250784543)*x[0]+(-0.799866349878)*x[1]**o+(0.114896594902)*x[1]+(-0.438064877186)*x[2]**o+(-0.458871344685)*x[2]
        arg[2,0,1,0]=(-0.344552466761)*x[0]**o+(0.967217640605)*x[0]+(-0.00183230845245)*x[1]**o+(-0.861206591247)*x[1]+(0.795588257851)*x[2]**o+(-0.333607767932)*x[2]
        arg[2,0,1,1]=(0.841069648591)*x[0]**o+(0.580162460873)*x[0]+(-0.0277035983747)*x[1]**o+(-0.404616536792)*x[1]+(-0.403195438454)*x[2]**o+(-0.202877947947)*x[2]
        arg[2,0,2,0]=(0.192691357169)*x[0]**o+(-0.519968251714)*x[0]+(-0.575397578091)*x[1]**o+(-0.029378989829)*x[1]+(-0.958861195684)*x[2]**o+(0.848705509543)*x[2]
        arg[2,0,2,1]=(0.556616365284)*x[0]**o+(0.679993071506)*x[0]+(-0.800652717274)*x[1]**o+(0.979182847258)*x[1]+(-0.501953582042)*x[2]**o+(0.127003985335)*x[2]
        arg[2,1,0,0]=(0.947750123445)*x[0]**o+(-0.0350691553359)*x[0]+(0.0650485999092)*x[1]**o+(-0.131216537555)*x[1]+(0.888782559831)*x[2]**o+(0.0338703818654)*x[2]
        arg[2,1,0,1]=(0.962918564559)*x[0]**o+(-0.119367421389)*x[0]+(0.43003549616)*x[1]**o+(-0.097883763913)*x[1]+(0.230422206305)*x[2]**o+(0.187273479711)*x[2]
        arg[2,1,1,0]=(-0.549909211973)*x[0]**o+(0.263443098451)*x[0]+(-0.476703606205)*x[1]**o+(0.216159301182)*x[1]+(-0.561829938323)*x[2]**o+(0.943016557203)*x[2]
        arg[2,1,1,1]=(0.382867749635)*x[0]**o+(0.404317006935)*x[0]+(0.786117847428)*x[1]**o+(-0.80719258612)*x[1]+(0.471144889777)*x[2]**o+(0.6478813349)*x[2]
        arg[2,1,2,0]=(0.355742024596)*x[0]**o+(-0.728812391059)*x[0]+(0.766039604734)*x[1]**o+(-0.532629598363)*x[1]+(-0.518284303077)*x[2]**o+(-0.972348067947)*x[2]
        arg[2,1,2,1]=(-0.882334243081)*x[0]**o+(-0.0940633993231)*x[0]+(-0.00166643832426)*x[1]**o+(-0.971243725495)*x[1]+(-0.0422614083707)*x[2]**o+(-0.547881520447)*x[2]
        arg[2,2,0,0]=(0.372164678051)*x[0]**o+(-0.0644361811234)*x[0]+(0.886078780084)*x[1]**o+(-0.459054628604)*x[1]+(-0.983880547097)*x[2]**o+(-0.669749873181)*x[2]
        arg[2,2,0,1]=(0.126650330827)*x[0]**o+(0.375111974063)*x[0]+(-0.759797654917)*x[1]**o+(-0.663216091322)*x[1]+(-0.683191373782)*x[2]**o+(-0.607048449469)*x[2]
        arg[2,2,1,0]=(-0.805920040628)*x[0]**o+(-0.0144685877057)*x[0]+(0.00875222056291)*x[1]**o+(-0.110000267929)*x[1]+(-0.478201664476)*x[2]**o+(-0.0537439708493)*x[2]
        arg[2,2,1,1]=(-0.550624517803)*x[0]**o+(0.570407090431)*x[0]+(0.661026826148)*x[1]**o+(0.905189813242)*x[1]+(0.00707531661352)*x[2]**o+(0.711072343064)*x[2]
        arg[2,2,2,0]=(-0.644276976064)*x[0]**o+(-0.151665972531)*x[0]+(-0.645369927259)*x[1]**o+(0.915967227715)*x[1]+(-0.211750817665)*x[2]**o+(-0.596646212118)*x[2]
        arg[2,2,2,1]=(0.564688999107)*x[0]**o+(0.635094410913)*x[0]+(0.281863287848)*x[1]**o+(-0.927529659408)*x[1]+(0.581071087484)*x[2]**o+(0.164399277305)*x[2]
        arg[2,3,0,0]=(0.64754765253)*x[0]**o+(0.176693707964)*x[0]+(0.172801737347)*x[1]**o+(-0.769408746261)*x[1]+(-0.176026486601)*x[2]**o+(0.187304474822)*x[2]
        arg[2,3,0,1]=(0.365315558093)*x[0]**o+(0.888853264239)*x[0]+(0.0541759434362)*x[1]**o+(0.241489226711)*x[1]+(0.441822201832)*x[2]**o+(0.075541840076)*x[2]
        arg[2,3,1,0]=(-0.984940830356)*x[0]**o+(0.521596714942)*x[0]+(-0.933671223761)*x[1]**o+(-0.132907654205)*x[1]+(-0.225804727932)*x[2]**o+(0.987334445626)*x[2]
        arg[2,3,1,1]=(-0.785516613303)*x[0]**o+(0.0324126413814)*x[0]+(-0.084233004699)*x[1]**o+(0.45131442059)*x[1]+(0.36498759129)*x[2]**o+(0.417036982561)*x[2]
        arg[2,3,2,0]=(-0.310575473358)*x[0]**o+(-0.769219454218)*x[0]+(-0.263431454577)*x[1]**o+(0.474143448264)*x[1]+(-0.490633240671)*x[2]**o+(0.435609988849)*x[2]
        arg[2,3,2,1]=(0.230960030802)*x[0]**o+(-0.480593443732)*x[0]+(0.547888534735)*x[1]**o+(-0.818842709599)*x[1]+(-0.857141410253)*x[2]**o+(-0.287898487847)*x[2]
        arg[2,4,0,0]=(-0.811008715357)*x[0]**o+(-0.608505768579)*x[0]+(-0.117642307757)*x[1]**o+(-0.658229045784)*x[1]+(0.246542958193)*x[2]**o+(-0.42783248265)*x[2]
        arg[2,4,0,1]=(0.817994599948)*x[0]**o+(0.394931907893)*x[0]+(-0.273993145403)*x[1]**o+(0.9572397013)*x[1]+(0.101025833331)*x[2]**o+(-0.925874548613)*x[2]
        arg[2,4,1,0]=(-0.626152000269)*x[0]**o+(0.821322294557)*x[0]+(0.543761841392)*x[1]**o+(0.112341361443)*x[1]+(-0.395657376418)*x[2]**o+(0.815481187683)*x[2]
        arg[2,4,1,1]=(0.97134483493)*x[0]**o+(0.303341541402)*x[0]+(-0.270102237344)*x[1]**o+(-0.982452271352)*x[1]+(0.435568243011)*x[2]**o+(-0.200051496445)*x[2]
        arg[2,4,2,0]=(-0.827528679064)*x[0]**o+(-0.559447627475)*x[0]+(-0.867397899368)*x[1]**o+(0.915539157819)*x[1]+(0.370118757042)*x[2]**o+(0.578366179408)*x[2]
        arg[2,4,2,1]=(0.685882920875)*x[0]**o+(0.830016468585)*x[0]+(-0.603607199824)*x[1]**o+(0.888619939961)*x[1]+(-0.264173896988)*x[2]**o+(-0.588065135532)*x[2]
        arg[3,0,0,0]=(0.480000662344)*x[0]**o+(-0.240072007989)*x[0]+(0.252669294205)*x[1]**o+(-0.657466732916)*x[1]+(0.945149322572)*x[2]**o+(0.340592627149)*x[2]
        arg[3,0,0,1]=(-0.819956304014)*x[0]**o+(0.910408628621)*x[0]+(-0.875714560314)*x[1]**o+(0.653323198674)*x[1]+(0.910127896386)*x[2]**o+(0.21382952806)*x[2]
        arg[3,0,1,0]=(0.736655857249)*x[0]**o+(-0.982636511328)*x[0]+(0.747965385081)*x[1]**o+(-0.952056699676)*x[1]+(0.143168283422)*x[2]**o+(0.891386576579)*x[2]
        arg[3,0,1,1]=(0.615723453617)*x[0]**o+(0.57376968582)*x[0]+(0.766802940979)*x[1]**o+(-0.294849095727)*x[1]+(-0.26718123792)*x[2]**o+(-0.979175148343)*x[2]
        arg[3,0,2,0]=(-0.299975789693)*x[0]**o+(-0.941879795797)*x[0]+(-0.332633604206)*x[1]**o+(0.887589360228)*x[1]+(0.570321438438)*x[2]**o+(0.107180499249)*x[2]
        arg[3,0,2,1]=(-0.77479605873)*x[0]**o+(0.928359807986)*x[0]+(-0.144170026638)*x[1]**o+(0.533835316696)*x[1]+(0.183938136052)*x[2]**o+(-0.87336340483)*x[2]
        arg[3,1,0,0]=(-0.121858163593)*x[0]**o+(-0.971122306623)*x[0]+(-0.351891554168)*x[1]**o+(-0.989754547278)*x[1]+(0.48106592456)*x[2]**o+(0.750009716044)*x[2]
        arg[3,1,0,1]=(-0.332320017719)*x[0]**o+(0.229814969323)*x[0]+(0.950038106614)*x[1]**o+(-0.364221636516)*x[1]+(-0.842684764717)*x[2]**o+(-0.430003876831)*x[2]
        arg[3,1,1,0]=(0.1036461168)*x[0]**o+(0.243047542195)*x[0]+(-0.189881740385)*x[1]**o+(-0.646948186795)*x[1]+(-0.246523431838)*x[2]**o+(0.0363222140239)*x[2]
        arg[3,1,1,1]=(0.629747493968)*x[0]**o+(0.257110968013)*x[0]+(-0.594332699815)*x[1]**o+(-0.74041867705)*x[1]+(0.656583120031)*x[2]**o+(0.392776534802)*x[2]
        arg[3,1,2,0]=(0.997368307137)*x[0]**o+(-0.709004475665)*x[0]+(-0.379447862403)*x[1]**o+(-0.368700793823)*x[1]+(0.293673648471)*x[2]**o+(-0.555545691082)*x[2]
        arg[3,1,2,1]=(-0.323027033928)*x[0]**o+(0.804640557762)*x[0]+(-0.199434780533)*x[1]**o+(0.604194682736)*x[1]+(0.945516011113)*x[2]**o+(-0.831838977373)*x[2]
        arg[3,2,0,0]=(0.255071922458)*x[0]**o+(0.261075290259)*x[0]+(0.198792431961)*x[1]**o+(0.987681568369)*x[1]+(-0.257626079249)*x[2]**o+(0.817801578613)*x[2]
        arg[3,2,0,1]=(-0.732615916833)*x[0]**o+(0.8114347023)*x[0]+(0.308896981216)*x[1]**o+(-0.164981244979)*x[1]+(0.724411853266)*x[2]**o+(-0.647969863039)*x[2]
        arg[3,2,1,0]=(0.126755528121)*x[0]**o+(0.0203968097627)*x[0]+(0.350888385037)*x[1]**o+(0.765584878761)*x[1]+(0.43521215637)*x[2]**o+(0.5821821143)*x[2]
        arg[3,2,1,1]=(0.795956472753)*x[0]**o+(0.363631111688)*x[0]+(-0.296417527594)*x[1]**o+(-0.0927953540926)*x[1]+(0.396041397741)*x[2]**o+(0.43932000066)*x[2]
        arg[3,2,2,0]=(-0.926754341344)*x[0]**o+(-0.688414966522)*x[0]+(-0.660984101932)*x[1]**o+(-0.627883344982)*x[1]+(0.403036784646)*x[2]**o+(0.818277068314)*x[2]
        arg[3,2,2,1]=(-0.358921307079)*x[0]**o+(0.636847962491)*x[0]+(-0.510050460541)*x[1]**o+(-0.758190944228)*x[1]+(-0.0319326931965)*x[2]**o+(-0.643422203077)*x[2]
        arg[3,3,0,0]=(-0.930730482483)*x[0]**o+(-0.883991363505)*x[0]+(0.156751809769)*x[1]**o+(0.669949596594)*x[1]+(0.697840698407)*x[2]**o+(0.721622061073)*x[2]
        arg[3,3,0,1]=(0.108814498453)*x[0]**o+(-0.164024398834)*x[0]+(-0.172084798233)*x[1]**o+(0.031530303081)*x[1]+(-0.985663868487)*x[2]**o+(-0.290224642955)*x[2]
        arg[3,3,1,0]=(0.690575802875)*x[0]**o+(-0.720428203968)*x[0]+(-0.837111899789)*x[1]**o+(0.140256279088)*x[1]+(0.532813462778)*x[2]**o+(-0.557885762558)*x[2]
        arg[3,3,1,1]=(-0.0785388159589)*x[0]**o+(-0.40595445804)*x[0]+(-0.691255332383)*x[1]**o+(0.54108326284)*x[1]+(0.737684932212)*x[2]**o+(0.423508847197)*x[2]
        arg[3,3,2,0]=(-0.589838770269)*x[0]**o+(-0.557133995504)*x[0]+(-0.297626023793)*x[1]**o+(-0.511809000987)*x[1]+(-0.933566600332)*x[2]**o+(-0.21434993446)*x[2]
        arg[3,3,2,1]=(0.19892263441)*x[0]**o+(0.633952342142)*x[0]+(0.0179400729177)*x[1]**o+(0.154020947355)*x[1]+(-0.620690264897)*x[2]**o+(0.524853027077)*x[2]
        arg[3,4,0,0]=(0.475231682303)*x[0]**o+(-0.48174419167)*x[0]+(-0.100854189221)*x[1]**o+(0.818166518054)*x[1]+(-0.922566309657)*x[2]**o+(-0.498745068755)*x[2]
        arg[3,4,0,1]=(0.613982633884)*x[0]**o+(-0.947323459945)*x[0]+(0.17395204013)*x[1]**o+(0.929669087853)*x[1]+(-0.617278089466)*x[2]**o+(0.900537470392)*x[2]
        arg[3,4,1,0]=(-0.403633510324)*x[0]**o+(0.954097943555)*x[0]+(-0.463422043607)*x[1]**o+(0.843916487223)*x[1]+(-0.5955912138)*x[2]**o+(-0.765444657727)*x[2]
        arg[3,4,1,1]=(-0.663412886802)*x[0]**o+(-0.547440885077)*x[0]+(-0.479993570508)*x[1]**o+(0.0620303034445)*x[1]+(-0.653759917895)*x[2]**o+(-0.681004441743)*x[2]
        arg[3,4,2,0]=(-0.994529375243)*x[0]**o+(0.546983479745)*x[0]+(0.17913912435)*x[1]**o+(0.660366383627)*x[1]+(0.0747943517387)*x[2]**o+(-0.321063660452)*x[2]
        arg[3,4,2,1]=(-0.538074654323)*x[0]**o+(-0.81330034965)*x[0]+(0.660614896398)*x[1]**o+(-0.918192909648)*x[1]+(0.553635166581)*x[2]**o+(-0.918131802189)*x[2]
        ref[0,0,0,0]=(-0.321539504757)/(o+1.)+(0.762866286444)+(-0.793251694335)*0.5**o
        ref[0,0,0,1]=(-0.264812286159)/(o+1.)+(-0.15293893368)+(-0.624206604764)*0.5**o
        ref[0,0,1,0]=(0.54441377247)/(o+1.)+(0.214067163116)+(0.115999561481)*0.5**o
        ref[0,0,1,1]=(1.50036854956)/(o+1.)+(0.673819079573)+(-0.972466831671)*0.5**o
        ref[0,0,2,0]=(0.687874396856)/(o+1.)+(-0.986502459901)+(0.708180260094)*0.5**o
        ref[0,0,2,1]=(0.793527041633)/(o+1.)+(-0.259940301856)+(0.0282615573045)*0.5**o
        ref[0,1,0,0]=(-1.25436610505)/(o+1.)+(-0.224984055664)+(0.231621820235)*0.5**o
        ref[0,1,0,1]=(0.891022819882)/(o+1.)+(-0.165060941565)+(0.114056801155)*0.5**o
        ref[0,1,1,0]=(-0.833444470649)/(o+1.)+(-0.322644910601)+(-0.973115195017)*0.5**o
        ref[0,1,1,1]=(-0.189799709023)/(o+1.)+(-0.242650862468)+(-0.304758579369)*0.5**o
        ref[0,1,2,0]=(-1.39857111894)/(o+1.)+(-0.14133379247)+(0.0923844967157)*0.5**o
        ref[0,1,2,1]=(1.03702218206)/(o+1.)+(-0.181927579186)+(0.793568921835)*0.5**o
        ref[0,2,0,0]=(-1.11962316818)/(o+1.)+(0.654627255004)+(0.570673248048)*0.5**o
        ref[0,2,0,1]=(0.085812863531)/(o+1.)+(0.17639811125)+(0.299061155215)*0.5**o
        ref[0,2,1,0]=(-1.26466090832)/(o+1.)+(0.618506300342)+(0.694725244159)*0.5**o
        ref[0,2,1,1]=(0.181495495342)/(o+1.)+(0.818577989479)+(-0.83896527178)*0.5**o
        ref[0,2,2,0]=(0.867512484289)/(o+1.)+(0.353365700269)+(0.2228052704)*0.5**o
        ref[0,2,2,1]=(0.618350374002)/(o+1.)+(-0.418609375405)+(0.63141216243)*0.5**o
        ref[0,3,0,0]=(-0.801998626232)/(o+1.)+(-0.302573026989)+(0.00698107166168)*0.5**o
        ref[0,3,0,1]=(0.414118735868)/(o+1.)+(0.103407742435)+(0.243423742325)*0.5**o
        ref[0,3,1,0]=(-0.129735888575)/(o+1.)+(0.51412655284)+(-0.106629554393)*0.5**o
        ref[0,3,1,1]=(0.0886696480864)/(o+1.)+(0.287824302591)+(0.375143733111)*0.5**o
        ref[0,3,2,0]=(-0.746501172831)/(o+1.)+(-0.389518072046)+(0.955685455438)*0.5**o
        ref[0,3,2,1]=(-1.06628341794)/(o+1.)+(-0.147429422878)+(0.353654445481)*0.5**o
        ref[0,4,0,0]=(-0.174512962078)/(o+1.)+(-0.023500931215)+(0.974759684151)*0.5**o
        ref[0,4,0,1]=(1.18079051113)/(o+1.)+(0.980823290345)+(-0.0799922241539)*0.5**o
        ref[0,4,1,0]=(-1.19690096085)/(o+1.)+(0.173437389579)+(0.532633280629)*0.5**o
        ref[0,4,1,1]=(1.11279531673)/(o+1.)+(-0.763621970064)+(-0.353243658293)*0.5**o
        ref[0,4,2,0]=(-0.819102364613)/(o+1.)+(0.326676095071)+(-0.720840869801)*0.5**o
        ref[0,4,2,1]=(-0.397779896209)/(o+1.)+(-0.677806011795)+(-0.179073400214)*0.5**o
        ref[1,0,0,0]=(0.00277094815158)/(o+1.)+(0.301845054648)+(-0.384011553333)*0.5**o
        ref[1,0,0,1]=(1.22422728891)/(o+1.)+(-0.594910516315)+(-0.808211570649)*0.5**o
        ref[1,0,1,0]=(0.869946029655)/(o+1.)+(0.308501276384)+(0.0404274840294)*0.5**o
        ref[1,0,1,1]=(1.63718264119)/(o+1.)+(0.76013279253)+(0.302394139901)*0.5**o
        ref[1,0,2,0]=(-0.0317278448724)/(o+1.)+(-0.118813696855)+(-0.981981997649)*0.5**o
        ref[1,0,2,1]=(-1.13670569191)/(o+1.)+(-1.14181937354)+(-0.237479805943)*0.5**o
        ref[1,1,0,0]=(0.16579906355)/(o+1.)+(-0.303649903525)+(-0.543719871098)*0.5**o
        ref[1,1,0,1]=(-1.23792473519)/(o+1.)+(-0.288446030005)+(-0.2624625471)*0.5**o
        ref[1,1,1,0]=(-1.42019666807)/(o+1.)+(-0.23595016925)+(0.88003513115)*0.5**o
        ref[1,1,1,1]=(0.400318898446)/(o+1.)+(0.765385300641)+(0.177746615088)*0.5**o
        ref[1,1,2,0]=(1.21553520103)/(o+1.)+(-0.272140700356)+(0.889070121473)*0.5**o
        ref[1,1,2,1]=(0.121042131161)/(o+1.)+(0.672369993679)+(0.951736215954)*0.5**o
        ref[1,2,0,0]=(-1.33133223229)/(o+1.)+(0.0067424746325)+(-0.954701036263)*0.5**o
        ref[1,2,0,1]=(1.02875611862)/(o+1.)+(0.288339603595)+(0.256489282842)*0.5**o
        ref[1,2,1,0]=(-0.32722580116)/(o+1.)+(0.166447794803)+(-0.94015914517)*0.5**o
        ref[1,2,1,1]=(0.319551509271)/(o+1.)+(0.112957240802)+(0.367156421931)*0.5**o
        ref[1,2,2,0]=(-1.3530782297)/(o+1.)+(-0.383051052329)+(-0.812516694781)*0.5**o
        ref[1,2,2,1]=(0.103238894111)/(o+1.)+(-0.09078366319)+(-0.497461944186)*0.5**o
        ref[1,3,0,0]=(-0.730489039376)/(o+1.)+(-0.321235679733)+(-0.227077550639)*0.5**o
        ref[1,3,0,1]=(0.532708925151)/(o+1.)+(-0.0963112877562)+(0.822091021645)*0.5**o
        ref[1,3,1,0]=(1.69380361755)/(o+1.)+(-0.221589701137)+(-0.0341577310045)*0.5**o
        ref[1,3,1,1]=(-0.653530558759)/(o+1.)+(-0.322066868053)+(-0.102867224088)*0.5**o
        ref[1,3,2,0]=(-0.279916251859)/(o+1.)+(-0.18685188305)+(0.556301076488)*0.5**o
        ref[1,3,2,1]=(0.798107960854)/(o+1.)+(-0.326052832107)+(0.888436531887)*0.5**o
        ref[1,4,0,0]=(0.250537417885)/(o+1.)+(-0.257356294716)+(0.651898073685)*0.5**o
        ref[1,4,0,1]=(1.5757556609)/(o+1.)+(-0.669914057301)+(-0.149187282052)*0.5**o
        ref[1,4,1,0]=(-1.0484286711)/(o+1.)+(0.142400846148)+(-0.285938055108)*0.5**o
        ref[1,4,1,1]=(0.028101537891)/(o+1.)+(0.55179042751)+(-0.34015136472)*0.5**o
        ref[1,4,2,0]=(0.974779411801)/(o+1.)+(-0.498887411653)+(-0.464687865356)*0.5**o
        ref[1,4,2,1]=(-0.544927129174)/(o+1.)+(-0.322066331457)+(-0.777967458564)*0.5**o
        ref[2,0,0,0]=(1.102518379)/(o+1.)+(-0.456744121978)+(0.665321754689)*0.5**o
        ref[2,0,0,1]=(-1.23793122706)/(o+1.)+(-0.366112767163)+(0.876435018569)*0.5**o
        ref[2,0,1,0]=(0.793755949398)/(o+1.)+(-0.113798359287)+(-0.344552466761)*0.5**o
        ref[2,0,1,1]=(-0.430899036829)/(o+1.)+(-0.0136660119329)+(0.841069648591)*0.5**o
        ref[2,0,2,0]=(-1.53425877377)/(o+1.)+(0.149679134)+(0.192691357169)*0.5**o
        ref[2,0,2,1]=(-1.30260629932)/(o+1.)+(0.89308995205)+(0.556616365284)*0.5**o
        ref[2,1,0,0]=(0.95383115974)/(o+1.)+(-0.0662076555126)+(0.947750123445)*0.5**o
        ref[2,1,0,1]=(0.660457702465)/(o+1.)+(-0.0149888527952)+(0.962918564559)*0.5**o
        ref[2,1,1,0]=(-1.03853354453)/(o+1.)+(0.711309478418)+(-0.549909211973)*0.5**o
        ref[2,1,1,1]=(1.25726273721)/(o+1.)+(0.122502877857)+(0.382867749635)*0.5**o
        ref[2,1,2,0]=(0.247755301657)/(o+1.)+(-1.11689502868)+(0.355742024596)*0.5**o
        ref[2,1,2,1]=(-0.043927846695)/(o+1.)+(-0.806594322632)+(-0.882334243081)*0.5**o
        ref[2,2,0,0]=(-0.0978017670124)/(o+1.)+(-0.596620341454)+(0.372164678051)*0.5**o
        ref[2,2,0,1]=(-1.4429890287)/(o+1.)+(-0.447576283364)+(0.126650330827)*0.5**o
        ref[2,2,1,0]=(-0.469449443913)/(o+1.)+(-0.0891064132419)+(-0.805920040628)*0.5**o
        ref[2,2,1,1]=(0.668102142762)/(o+1.)+(1.09333462337)+(-0.550624517803)*0.5**o
        ref[2,2,2,0]=(-0.857120744924)/(o+1.)+(0.0838275215328)+(-0.644276976064)*0.5**o
        ref[2,2,2,1]=(0.862934375332)/(o+1.)+(-0.0640179855954)+(0.564688999107)*0.5**o
        ref[2,3,0,0]=(-0.00322474925369)/(o+1.)+(-0.202705281737)+(0.64754765253)*0.5**o
        ref[2,3,0,1]=(0.495998145268)/(o+1.)+(0.602942165513)+(0.365315558093)*0.5**o
        ref[2,3,1,0]=(-1.15947595169)/(o+1.)+(0.688011753181)+(-0.984940830356)*0.5**o
        ref[2,3,1,1]=(0.280754586591)/(o+1.)+(0.450382022266)+(-0.785516613303)*0.5**o
        ref[2,3,2,0]=(-0.754064695248)/(o+1.)+(0.0702669914474)+(-0.310575473358)*0.5**o
        ref[2,3,2,1]=(-0.309252875518)/(o+1.)+(-0.793667320589)+(0.230960030802)*0.5**o
        ref[2,4,0,0]=(0.128900650436)/(o+1.)+(-0.847283648506)+(-0.811008715357)*0.5**o
        ref[2,4,0,1]=(-0.172967312072)/(o+1.)+(0.21314853029)+(0.817994599948)*0.5**o
        ref[2,4,1,0]=(0.148104464974)/(o+1.)+(0.874572421841)+(-0.626152000269)*0.5**o
        ref[2,4,1,1]=(0.165466005667)/(o+1.)+(-0.439581113198)+(0.97134483493)*0.5**o
        ref[2,4,2,0]=(-0.497279142326)/(o+1.)+(0.467228854876)+(-0.827528679064)*0.5**o
        ref[2,4,2,1]=(-0.867781096812)/(o+1.)+(0.565285636507)+(0.685882920875)*0.5**o
        ref[3,0,0,0]=(1.19781861678)/(o+1.)+(-0.278473056878)+(0.480000662344)*0.5**o
        ref[3,0,0,1]=(0.0344133360711)/(o+1.)+(0.888780677678)+(-0.819956304014)*0.5**o
        ref[3,0,1,0]=(0.891133668503)/(o+1.)+(-0.521653317213)+(0.736655857249)*0.5**o
        ref[3,0,1,1]=(0.499621703059)/(o+1.)+(-0.350127279125)+(0.615723453617)*0.5**o
        ref[3,0,2,0]=(0.237687834232)/(o+1.)+(0.0264450318399)+(-0.299975789693)*0.5**o
        ref[3,0,2,1]=(0.0397681094138)/(o+1.)+(0.294415859926)+(-0.77479605873)*0.5**o
        ref[3,1,0,0]=(0.129174370391)/(o+1.)+(-0.605433568929)+(-0.121858163593)*0.5**o
        ref[3,1,0,1]=(0.107353341897)/(o+1.)+(-0.282205272012)+(-0.332320017719)*0.5**o
        ref[3,1,1,0]=(-0.436405172223)/(o+1.)+(-0.183789215288)+(0.1036461168)*0.5**o
        ref[3,1,1,1]=(0.0622504202157)/(o+1.)+(-0.0452655871179)+(0.629747493968)*0.5**o
        ref[3,1,2,0]=(-0.0857742139322)/(o+1.)+(-0.816625480285)+(0.997368307137)*0.5**o
        ref[3,1,2,1]=(0.746081230581)/(o+1.)+(0.288498131562)+(-0.323027033928)*0.5**o
        ref[3,2,0,0]=(-0.0588336472879)/(o+1.)+(1.03327921862)+(0.255071922458)*0.5**o
        ref[3,2,0,1]=(1.03330883448)/(o+1.)+(-0.000758202858916)+(-0.732615916833)*0.5**o
        ref[3,2,1,0]=(0.786100541406)/(o+1.)+(0.684081901412)+(0.126755528121)*0.5**o
        ref[3,2,1,1]=(0.099623870147)/(o+1.)+(0.355077879128)+(0.795956472753)*0.5**o
        ref[3,2,2,0]=(-0.257947317287)/(o+1.)+(-0.249010621595)+(-0.926754341344)*0.5**o
        ref[3,2,2,1]=(-0.541983153738)/(o+1.)+(-0.382382592407)+(-0.358921307079)*0.5**o
        ref[3,3,0,0]=(0.854592508176)/(o+1.)+(0.253790147081)+(-0.930730482483)*0.5**o
        ref[3,3,0,1]=(-1.15774866672)/(o+1.)+(-0.211359369354)+(0.108814498453)*0.5**o
        ref[3,3,1,0]=(-0.304298437011)/(o+1.)+(-0.569028843719)+(0.690575802875)*0.5**o
        ref[3,3,1,1]=(0.0464295998283)/(o+1.)+(0.279318825998)+(-0.0785388159589)*0.5**o
        ref[3,3,2,0]=(-1.23119262412)/(o+1.)+(-0.641646465476)+(-0.589838770269)*0.5**o
        ref[3,3,2,1]=(-0.60275019198)/(o+1.)+(0.656413158287)+(0.19892263441)*0.5**o
        ref[3,4,0,0]=(-1.02342049888)/(o+1.)+(-0.0811613711857)+(0.475231682303)*0.5**o
        ref[3,4,0,1]=(-0.443326049337)/(o+1.)+(0.44144154915)+(0.613982633884)*0.5**o
        ref[3,4,1,0]=(-1.05901325741)/(o+1.)+(0.516284886526)+(-0.403633510324)*0.5**o
        ref[3,4,1,1]=(-1.1337534884)/(o+1.)+(-0.583207511688)+(-0.663412886802)*0.5**o
        ref[3,4,2,0]=(0.253933476088)/(o+1.)+(0.44314310146)+(-0.994529375243)*0.5**o
        ref[3,4,2,1]=(1.21425006298)/(o+1.)+(-1.32481253074)+(-0.538074654323)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_Solution_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(-0.441098788712)*x[0]**o+(0.082953252724)*x[0]+(-0.97005044508)*x[1]**o+(0.928239302707)*x[1]
        ref=(-0.97005044508)/(o+1.)+(0.505596277715)+(-0.441098788712)*0.5**o
      else:
        arg=(0.384995424392)*x[0]**o+(0.999298118235)*x[0]+(0.144745460948)*x[1]**o+(0.0545198589076)*x[1]+(-0.773375797864)*x[2]**o+(0.145524911495)*x[2]
        ref=(-0.628630336917)/(o+1.)+(0.599671444318)+(0.384995424392)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_Solution_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.0745889108767)*x[0]**o+(-0.694812761318)*x[0]+(-0.357791726239)*x[1]**o+(-0.785448350489)*x[1]
        arg[1]=(0.436006633056)*x[0]**o+(-0.797943632034)*x[0]+(-0.903321835716)*x[1]**o+(0.299527545727)*x[1]
        ref[0]=(-0.357791726239)/(o+1.)+(-0.740130555904)+(0.0745889108767)*0.5**o
        ref[1]=(-0.903321835716)/(o+1.)+(-0.249208043154)+(0.436006633056)*0.5**o
      else:
        arg[0]=(-0.292048194246)*x[0]**o+(-0.612402340241)*x[0]+(0.830253896674)*x[1]**o+(-0.0173245051245)*x[1]+(-0.105062444571)*x[2]**o+(0.968232377167)*x[2]
        arg[1]=(0.153118126553)*x[0]**o+(0.958628221601)*x[0]+(-0.326368437133)*x[1]**o+(0.878861879269)*x[1]+(-0.297398071379)*x[2]**o+(0.155202299471)*x[2]
        ref[0]=(0.725191452103)/(o+1.)+(0.169252765901)+(-0.292048194246)*0.5**o
        ref[1]=(-0.623766508512)/(o+1.)+(0.99634620017)+(0.153118126553)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_Solution_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(0.410346849722)*x[0]**o+(0.86102012198)*x[0]+(-0.0143604505833)*x[1]**o+(-0.333268586255)*x[1]
        arg[0,1]=(-0.104991947387)*x[0]**o+(0.51540973662)*x[0]+(0.449773354197)*x[1]**o+(0.0397236625379)*x[1]
        arg[0,2]=(0.0010671797269)*x[0]**o+(0.165202831822)*x[0]+(-0.536444395178)*x[1]**o+(0.142112903729)*x[1]
        arg[0,3]=(0.0655247081801)*x[0]**o+(-0.59093644572)*x[0]+(-0.0135713515051)*x[1]**o+(0.665578431202)*x[1]
        arg[0,4]=(0.902382714765)*x[0]**o+(-0.358716290301)*x[0]+(-0.504792876433)*x[1]**o+(-0.760982991404)*x[1]
        arg[1,0]=(0.663815334483)*x[0]**o+(-0.967978720711)*x[0]+(-0.308953852146)*x[1]**o+(-0.250315651366)*x[1]
        arg[1,1]=(0.602976841368)*x[0]**o+(0.407346455361)*x[0]+(0.820076160142)*x[1]**o+(0.720380314572)*x[1]
        arg[1,2]=(0.0899286747557)*x[0]**o+(-0.636748133402)*x[0]+(0.615853620374)*x[1]**o+(0.389136375831)*x[1]
        arg[1,3]=(-0.695859848989)*x[0]**o+(-0.160892907203)*x[0]+(0.972252211687)*x[1]**o+(0.971653054313)*x[1]
        arg[1,4]=(-0.229141368314)*x[0]**o+(0.434757135281)*x[0]+(0.508751791725)*x[1]**o+(-0.593022987916)*x[1]
        arg[2,0]=(-0.732297666821)*x[0]**o+(-0.885623150041)*x[0]+(0.355264312146)*x[1]**o+(-0.203582600498)*x[1]
        arg[2,1]=(-0.0683706126862)*x[0]**o+(0.390953181924)*x[0]+(-0.104115827873)*x[1]**o+(-0.0586349400277)*x[1]
        arg[2,2]=(0.213052201915)*x[0]**o+(0.813758731408)*x[0]+(-0.927085393446)*x[1]**o+(-0.70884993627)*x[1]
        arg[2,3]=(-0.11792311156)*x[0]**o+(0.705053056049)*x[0]+(-0.988858028527)*x[1]**o+(-0.532493233644)*x[1]
        arg[2,4]=(0.643258167584)*x[0]**o+(0.991059864292)*x[0]+(0.466734669253)*x[1]**o+(-0.763209421816)*x[1]
        arg[3,0]=(-0.686036752646)*x[0]**o+(-0.0152278415398)*x[0]+(0.572818298467)*x[1]**o+(0.0883817883272)*x[1]
        arg[3,1]=(-0.498088836117)*x[0]**o+(0.413958831603)*x[0]+(-0.788338642889)*x[1]**o+(-0.219412111863)*x[1]
        arg[3,2]=(0.895103303091)*x[0]**o+(0.967224972282)*x[0]+(0.778129303031)*x[1]**o+(-0.239067231978)*x[1]
        arg[3,3]=(-0.715385920659)*x[0]**o+(-0.928446013585)*x[0]+(-0.919578735328)*x[1]**o+(0.735438220506)*x[1]
        arg[3,4]=(0.273825880641)*x[0]**o+(0.602304312788)*x[0]+(-0.788415866411)*x[1]**o+(0.841776933557)*x[1]
        ref[0,0]=(-0.0143604505833)/(o+1.)+(0.263875767862)+(0.410346849722)*0.5**o
        ref[0,1]=(0.449773354197)/(o+1.)+(0.277566699579)+(-0.104991947387)*0.5**o
        ref[0,2]=(-0.536444395178)/(o+1.)+(0.153657867776)+(0.0010671797269)*0.5**o
        ref[0,3]=(-0.0135713515051)/(o+1.)+(0.0373209927411)+(0.0655247081801)*0.5**o
        ref[0,4]=(-0.504792876433)/(o+1.)+(-0.559849640852)+(0.902382714765)*0.5**o
        ref[1,0]=(-0.308953852146)/(o+1.)+(-0.609147186038)+(0.663815334483)*0.5**o
        ref[1,1]=(0.820076160142)/(o+1.)+(0.563863384966)+(0.602976841368)*0.5**o
        ref[1,2]=(0.615853620374)/(o+1.)+(-0.123805878786)+(0.0899286747557)*0.5**o
        ref[1,3]=(0.972252211687)/(o+1.)+(0.405380073555)+(-0.695859848989)*0.5**o
        ref[1,4]=(0.508751791725)/(o+1.)+(-0.0791329263176)+(-0.229141368314)*0.5**o
        ref[2,0]=(0.355264312146)/(o+1.)+(-0.544602875269)+(-0.732297666821)*0.5**o
        ref[2,1]=(-0.104115827873)/(o+1.)+(0.166159120948)+(-0.0683706126862)*0.5**o
        ref[2,2]=(-0.927085393446)/(o+1.)+(0.0524543975689)+(0.213052201915)*0.5**o
        ref[2,3]=(-0.988858028527)/(o+1.)+(0.0862799112023)+(-0.11792311156)*0.5**o
        ref[2,4]=(0.466734669253)/(o+1.)+(0.113925221238)+(0.643258167584)*0.5**o
        ref[3,0]=(0.572818298467)/(o+1.)+(0.0365769733937)+(-0.686036752646)*0.5**o
        ref[3,1]=(-0.788338642889)/(o+1.)+(0.0972733598697)+(-0.498088836117)*0.5**o
        ref[3,2]=(0.778129303031)/(o+1.)+(0.364078870152)+(0.895103303091)*0.5**o
        ref[3,3]=(-0.919578735328)/(o+1.)+(-0.0965038965398)+(-0.715385920659)*0.5**o
        ref[3,4]=(-0.788415866411)/(o+1.)+(0.722040623173)+(0.273825880641)*0.5**o
      else:
        arg[0,0]=(-0.903197979191)*x[0]**o+(-0.497252911882)*x[0]+(0.5689188153)*x[1]**o+(-0.569434759407)*x[1]+(-0.204533481399)*x[2]**o+(-0.0255207088467)*x[2]
        arg[0,1]=(-0.0296606374337)*x[0]**o+(0.917552577919)*x[0]+(0.746132694062)*x[1]**o+(0.285568252958)*x[1]+(0.175571603104)*x[2]**o+(0.5701931124)*x[2]
        arg[0,2]=(0.657981464039)*x[0]**o+(-0.105816675859)*x[0]+(-0.210726712386)*x[1]**o+(-0.457303699577)*x[1]+(-0.225517453595)*x[2]**o+(0.61593257413)*x[2]
        arg[0,3]=(-0.652766009035)*x[0]**o+(0.538908603782)*x[0]+(0.226594150058)*x[1]**o+(0.691428293374)*x[1]+(-0.210896072508)*x[2]**o+(0.538061905948)*x[2]
        arg[0,4]=(0.175024193446)*x[0]**o+(0.433285241007)*x[0]+(0.928411521986)*x[1]**o+(-0.241175862661)*x[1]+(-0.779192552542)*x[2]**o+(0.428100531631)*x[2]
        arg[1,0]=(-0.094230207815)*x[0]**o+(-0.113255272088)*x[0]+(-0.880816596679)*x[1]**o+(0.56261116141)*x[1]+(-0.418606336511)*x[2]**o+(0.858058623759)*x[2]
        arg[1,1]=(0.08556853498)*x[0]**o+(0.95491440456)*x[0]+(-0.435275492231)*x[1]**o+(0.339105115812)*x[1]+(-0.634101556975)*x[2]**o+(0.357557194572)*x[2]
        arg[1,2]=(-0.692883812524)*x[0]**o+(0.673540357384)*x[0]+(0.240219465837)*x[1]**o+(0.139957925862)*x[1]+(0.135892430596)*x[2]**o+(0.383465818668)*x[2]
        arg[1,3]=(-0.892921935206)*x[0]**o+(0.0694647682287)*x[0]+(0.0530888770821)*x[1]**o+(-0.0735398003251)*x[1]+(-0.40702392212)*x[2]**o+(-0.223494881098)*x[2]
        arg[1,4]=(0.743112585337)*x[0]**o+(-0.12393012942)*x[0]+(-0.660616664197)*x[1]**o+(-0.0334489536139)*x[1]+(-0.0566394013558)*x[2]**o+(-0.0281273872158)*x[2]
        arg[2,0]=(-0.500500871517)*x[0]**o+(-0.326237506809)*x[0]+(-0.960480146386)*x[1]**o+(0.0901654083154)*x[1]+(0.466124845857)*x[2]**o+(0.6908848619)*x[2]
        arg[2,1]=(0.120233846989)*x[0]**o+(0.520609850629)*x[0]+(-0.407423400749)*x[1]**o+(0.59145151128)*x[1]+(0.981171407459)*x[2]**o+(-0.703987165108)*x[2]
        arg[2,2]=(0.811775583161)*x[0]**o+(-0.209650983138)*x[0]+(-0.286223486261)*x[1]**o+(-0.864122954179)*x[1]+(0.609725467363)*x[2]**o+(0.0311464898903)*x[2]
        arg[2,3]=(-0.325647787579)*x[0]**o+(0.956001955119)*x[0]+(0.637272546129)*x[1]**o+(-0.951109798103)*x[1]+(0.406445558466)*x[2]**o+(-0.930854597943)*x[2]
        arg[2,4]=(0.0621315789778)*x[0]**o+(-0.917033227802)*x[0]+(-0.179584904974)*x[1]**o+(0.283357518809)*x[1]+(-0.778863909832)*x[2]**o+(-0.524497331838)*x[2]
        arg[3,0]=(0.140605486894)*x[0]**o+(0.172882849759)*x[0]+(-0.883586756712)*x[1]**o+(-0.160461884399)*x[1]+(-0.718343713337)*x[2]**o+(0.196937721256)*x[2]
        arg[3,1]=(-0.660232764173)*x[0]**o+(-0.92091042631)*x[0]+(-0.568852134661)*x[1]**o+(-0.331441330509)*x[1]+(-0.220286922375)*x[2]**o+(-0.256407439105)*x[2]
        arg[3,2]=(0.593940468197)*x[0]**o+(0.527756437117)*x[0]+(0.943980933807)*x[1]**o+(0.749415167795)*x[1]+(0.484043332105)*x[2]**o+(0.40135030381)*x[2]
        arg[3,3]=(0.870508483705)*x[0]**o+(-0.234209640456)*x[0]+(-0.62692310882)*x[1]**o+(0.352628981854)*x[1]+(-0.24937844453)*x[2]**o+(0.73438735864)*x[2]
        arg[3,4]=(-0.638437449353)*x[0]**o+(0.308007229542)*x[0]+(0.537590844528)*x[1]**o+(-0.755595388361)*x[1]+(-0.152781228745)*x[2]**o+(-0.450122095362)*x[2]
        ref[0,0]=(0.364385333901)/(o+1.)+(-0.546104190068)+(-0.903197979191)*0.5**o
        ref[0,1]=(0.921704297167)/(o+1.)+(0.886656971638)+(-0.0296606374337)*0.5**o
        ref[0,2]=(-0.436244165981)/(o+1.)+(0.0264060993469)+(0.657981464039)*0.5**o
        ref[0,3]=(0.0156980775503)/(o+1.)+(0.884199401552)+(-0.652766009035)*0.5**o
        ref[0,4]=(0.149218969444)/(o+1.)+(0.310104954989)+(0.175024193446)*0.5**o
        ref[1,0]=(-1.29942293319)/(o+1.)+(0.653707256541)+(-0.094230207815)*0.5**o
        ref[1,1]=(-1.06937704921)/(o+1.)+(0.825788357473)+(0.08556853498)*0.5**o
        ref[1,2]=(0.376111896433)/(o+1.)+(0.598482050957)+(-0.692883812524)*0.5**o
        ref[1,3]=(-0.353935045038)/(o+1.)+(-0.113784956597)+(-0.892921935206)*0.5**o
        ref[1,4]=(-0.717256065552)/(o+1.)+(-0.0927532351247)+(0.743112585337)*0.5**o
        ref[2,0]=(-0.494355300528)/(o+1.)+(0.227406381703)+(-0.500500871517)*0.5**o
        ref[2,1]=(0.57374800671)/(o+1.)+(0.2040370984)+(0.120233846989)*0.5**o
        ref[2,2]=(0.323501981101)/(o+1.)+(-0.521313723714)+(0.811775583161)*0.5**o
        ref[2,3]=(1.04371810459)/(o+1.)+(-0.462981220464)+(-0.325647787579)*0.5**o
        ref[2,4]=(-0.958448814807)/(o+1.)+(-0.579086520416)+(0.0621315789778)*0.5**o
        ref[3,0]=(-1.60193047005)/(o+1.)+(0.104679343308)+(0.140605486894)*0.5**o
        ref[3,1]=(-0.789139057035)/(o+1.)+(-0.754379597962)+(-0.660232764173)*0.5**o
        ref[3,2]=(1.42802426591)/(o+1.)+(0.839260954361)+(0.593940468197)*0.5**o
        ref[3,3]=(-0.87630155335)/(o+1.)+(0.426403350019)+(0.870508483705)*0.5**o
        ref[3,4]=(0.384809615783)/(o+1.)+(-0.448855127091)+(-0.638437449353)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_Solution_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.315756069525)*x[0]**o+(0.253240552004)*x[0]+(0.86540335823)*x[1]**o+(-0.616203780065)*x[1]
        arg[0,0,1]=(-0.948116617977)*x[0]**o+(0.892154336439)*x[0]+(0.136605864823)*x[1]**o+(-0.135599413854)*x[1]
        arg[0,1,0]=(0.249388669107)*x[0]**o+(-0.299043026617)*x[0]+(0.335963868826)*x[1]**o+(-0.147202749474)*x[1]
        arg[0,1,1]=(0.649003124445)*x[0]**o+(0.102344972673)*x[0]+(-0.795038258171)*x[1]**o+(0.149716983842)*x[1]
        arg[1,0,0]=(0.814606374941)*x[0]**o+(-0.949251236145)*x[0]+(0.723727126173)*x[1]**o+(-0.75419822708)*x[1]
        arg[1,0,1]=(0.043251358201)*x[0]**o+(-0.227748374318)*x[0]+(-0.231556019421)*x[1]**o+(-0.152524439909)*x[1]
        arg[1,1,0]=(0.565989211326)*x[0]**o+(-0.488248650798)*x[0]+(-0.353077780419)*x[1]**o+(-0.0139123365766)*x[1]
        arg[1,1,1]=(-0.106085432662)*x[0]**o+(0.627311916563)*x[0]+(-0.496301561324)*x[1]**o+(-0.648448849796)*x[1]
        arg[2,0,0]=(0.741868098354)*x[0]**o+(-0.486898566862)*x[0]+(0.0461464851414)*x[1]**o+(0.0133916949979)*x[1]
        arg[2,0,1]=(0.969108066213)*x[0]**o+(-0.688797899381)*x[0]+(0.897017408844)*x[1]**o+(0.807714585761)*x[1]
        arg[2,1,0]=(-0.138159486947)*x[0]**o+(-0.377759480876)*x[0]+(-0.764484355987)*x[1]**o+(-0.723912265361)*x[1]
        arg[2,1,1]=(-0.781167132076)*x[0]**o+(0.119512137054)*x[0]+(-0.535230596139)*x[1]**o+(0.441358968417)*x[1]
        arg[3,0,0]=(-0.663820836909)*x[0]**o+(0.907668749761)*x[0]+(-0.345114213135)*x[1]**o+(0.0580058218243)*x[1]
        arg[3,0,1]=(-0.359054701663)*x[0]**o+(0.0389188839076)*x[0]+(0.168050801441)*x[1]**o+(-0.695770024565)*x[1]
        arg[3,1,0]=(0.70118269628)*x[0]**o+(0.87976625188)*x[0]+(0.154503286758)*x[1]**o+(0.807878896951)*x[1]
        arg[3,1,1]=(-0.143516320927)*x[0]**o+(-0.369452129865)*x[0]+(-0.0392268449697)*x[1]**o+(-0.046104227955)*x[1]
        arg[4,0,0]=(0.197244254754)*x[0]**o+(-0.580444991466)*x[0]+(0.334036744845)*x[1]**o+(0.000791083620504)*x[1]
        arg[4,0,1]=(-0.892626226865)*x[0]**o+(0.140042741589)*x[0]+(0.158775259845)*x[1]**o+(-0.308266331028)*x[1]
        arg[4,1,0]=(0.650374542633)*x[0]**o+(0.586152174865)*x[0]+(0.0201324360301)*x[1]**o+(-0.813221777119)*x[1]
        arg[4,1,1]=(0.149656968314)*x[0]**o+(0.700641349434)*x[0]+(-0.529780404433)*x[1]**o+(0.512159137234)*x[1]
        arg[5,0,0]=(0.288664621864)*x[0]**o+(0.119652133593)*x[0]+(-0.599113573241)*x[1]**o+(0.879966724309)*x[1]
        arg[5,0,1]=(0.861443356689)*x[0]**o+(0.530607121787)*x[0]+(0.240306513701)*x[1]**o+(-0.575772515225)*x[1]
        arg[5,1,0]=(0.721635890008)*x[0]**o+(-0.109537583449)*x[0]+(0.162041613112)*x[1]**o+(0.229143033467)*x[1]
        arg[5,1,1]=(-0.876930820494)*x[0]**o+(0.749378811252)*x[0]+(0.886213554632)*x[1]**o+(0.433327797349)*x[1]
        ref[0,0,0]=(0.86540335823)/(o+1.)+(-0.18148161403)+(-0.315756069525)*0.5**o
        ref[0,0,1]=(0.136605864823)/(o+1.)+(0.378277461292)+(-0.948116617977)*0.5**o
        ref[0,1,0]=(0.335963868826)/(o+1.)+(-0.223122888045)+(0.249388669107)*0.5**o
        ref[0,1,1]=(-0.795038258171)/(o+1.)+(0.126030978258)+(0.649003124445)*0.5**o
        ref[1,0,0]=(0.723727126173)/(o+1.)+(-0.851724731613)+(0.814606374941)*0.5**o
        ref[1,0,1]=(-0.231556019421)/(o+1.)+(-0.190136407114)+(0.043251358201)*0.5**o
        ref[1,1,0]=(-0.353077780419)/(o+1.)+(-0.251080493687)+(0.565989211326)*0.5**o
        ref[1,1,1]=(-0.496301561324)/(o+1.)+(-0.0105684666165)+(-0.106085432662)*0.5**o
        ref[2,0,0]=(0.0461464851414)/(o+1.)+(-0.236753435932)+(0.741868098354)*0.5**o
        ref[2,0,1]=(0.897017408844)/(o+1.)+(0.05945834319)+(0.969108066213)*0.5**o
        ref[2,1,0]=(-0.764484355987)/(o+1.)+(-0.550835873118)+(-0.138159486947)*0.5**o
        ref[2,1,1]=(-0.535230596139)/(o+1.)+(0.280435552736)+(-0.781167132076)*0.5**o
        ref[3,0,0]=(-0.345114213135)/(o+1.)+(0.482837285793)+(-0.663820836909)*0.5**o
        ref[3,0,1]=(0.168050801441)/(o+1.)+(-0.328425570329)+(-0.359054701663)*0.5**o
        ref[3,1,0]=(0.154503286758)/(o+1.)+(0.843822574415)+(0.70118269628)*0.5**o
        ref[3,1,1]=(-0.0392268449697)/(o+1.)+(-0.20777817891)+(-0.143516320927)*0.5**o
        ref[4,0,0]=(0.334036744845)/(o+1.)+(-0.289826953923)+(0.197244254754)*0.5**o
        ref[4,0,1]=(0.158775259845)/(o+1.)+(-0.0841117947196)+(-0.892626226865)*0.5**o
        ref[4,1,0]=(0.0201324360301)/(o+1.)+(-0.113534801127)+(0.650374542633)*0.5**o
        ref[4,1,1]=(-0.529780404433)/(o+1.)+(0.606400243334)+(0.149656968314)*0.5**o
        ref[5,0,0]=(-0.599113573241)/(o+1.)+(0.499809428951)+(0.288664621864)*0.5**o
        ref[5,0,1]=(0.240306513701)/(o+1.)+(-0.022582696719)+(0.861443356689)*0.5**o
        ref[5,1,0]=(0.162041613112)/(o+1.)+(0.0598027250089)+(0.721635890008)*0.5**o
        ref[5,1,1]=(0.886213554632)/(o+1.)+(0.5913533043)+(-0.876930820494)*0.5**o
      else:
        arg[0,0,0]=(0.804252705823)*x[0]**o+(-0.215722921442)*x[0]+(-0.806316349529)*x[1]**o+(-0.984002993222)*x[1]+(-0.411946014731)*x[2]**o+(-0.526356191855)*x[2]
        arg[0,0,1]=(-0.845902068304)*x[0]**o+(0.0773568471048)*x[0]+(-0.746877301439)*x[1]**o+(-0.581914187059)*x[1]+(-0.0299873869697)*x[2]**o+(-0.133702230427)*x[2]
        arg[0,1,0]=(0.0113663840954)*x[0]**o+(-0.155702215771)*x[0]+(-0.134490626112)*x[1]**o+(0.973329917011)*x[1]+(-0.71585624135)*x[2]**o+(-0.840113198085)*x[2]
        arg[0,1,1]=(0.708589516593)*x[0]**o+(0.40282025998)*x[0]+(0.114498353117)*x[1]**o+(0.117244230433)*x[1]+(0.110135318853)*x[2]**o+(-0.0227879044898)*x[2]
        arg[1,0,0]=(0.836102144172)*x[0]**o+(0.212564417583)*x[0]+(0.744354739679)*x[1]**o+(-0.265633978841)*x[1]+(0.843108381264)*x[2]**o+(-0.288428427501)*x[2]
        arg[1,0,1]=(-0.0712209756059)*x[0]**o+(-0.186158140814)*x[0]+(0.184457099888)*x[1]**o+(0.381365494077)*x[1]+(-0.547874738232)*x[2]**o+(0.645124013254)*x[2]
        arg[1,1,0]=(-0.982992052158)*x[0]**o+(0.259627201342)*x[0]+(-0.885159598031)*x[1]**o+(-0.720754022982)*x[1]+(-0.762444117798)*x[2]**o+(0.737661938668)*x[2]
        arg[1,1,1]=(0.518426662725)*x[0]**o+(0.718331452733)*x[0]+(0.523870992899)*x[1]**o+(0.527831420124)*x[1]+(0.791634534316)*x[2]**o+(0.17320870773)*x[2]
        arg[2,0,0]=(-0.0368697940364)*x[0]**o+(-0.101718169515)*x[0]+(0.933712377315)*x[1]**o+(-0.465193151914)*x[1]+(-0.113637506449)*x[2]**o+(0.606619949802)*x[2]
        arg[2,0,1]=(-0.785633726304)*x[0]**o+(0.526518355588)*x[0]+(0.151859749675)*x[1]**o+(0.805094094642)*x[1]+(-0.881122119524)*x[2]**o+(0.85143600659)*x[2]
        arg[2,1,0]=(0.969244001518)*x[0]**o+(0.22600349917)*x[0]+(0.404826692149)*x[1]**o+(0.633039564539)*x[1]+(0.470567669552)*x[2]**o+(0.378348877016)*x[2]
        arg[2,1,1]=(-0.310035929524)*x[0]**o+(0.42632271287)*x[0]+(0.866930472029)*x[1]**o+(-0.124483457934)*x[1]+(0.291920406068)*x[2]**o+(0.573984377154)*x[2]
        arg[3,0,0]=(0.245553971829)*x[0]**o+(-0.567563766526)*x[0]+(0.326654705159)*x[1]**o+(0.642370867777)*x[1]+(-0.538450732704)*x[2]**o+(0.773349470647)*x[2]
        arg[3,0,1]=(0.427017913395)*x[0]**o+(0.885132021286)*x[0]+(0.0338747045378)*x[1]**o+(-0.978508839789)*x[1]+(-0.734559666249)*x[2]**o+(0.379991690191)*x[2]
        arg[3,1,0]=(-0.29533334088)*x[0]**o+(-0.894548834889)*x[0]+(0.537043269081)*x[1]**o+(-0.559173506199)*x[1]+(0.359216600837)*x[2]**o+(0.269563745611)*x[2]
        arg[3,1,1]=(-0.146152544907)*x[0]**o+(-0.95681567795)*x[0]+(-0.0323978120064)*x[1]**o+(-0.5351716012)*x[1]+(-0.548536561192)*x[2]**o+(0.489675460511)*x[2]
        arg[4,0,0]=(0.0552991386013)*x[0]**o+(0.772417012152)*x[0]+(-0.298212559744)*x[1]**o+(-0.189934984078)*x[1]+(0.74843296731)*x[2]**o+(-0.00412448772016)*x[2]
        arg[4,0,1]=(0.577046858044)*x[0]**o+(-0.804142676861)*x[0]+(-0.0703211154568)*x[1]**o+(-0.84092953544)*x[1]+(0.254119640557)*x[2]**o+(-0.765048199333)*x[2]
        arg[4,1,0]=(-0.358558179011)*x[0]**o+(-0.998072158283)*x[0]+(0.508152998513)*x[1]**o+(-0.0813296609683)*x[1]+(-0.534332816004)*x[2]**o+(-0.189623317277)*x[2]
        arg[4,1,1]=(0.840098089823)*x[0]**o+(0.966726062679)*x[0]+(0.920079609258)*x[1]**o+(-0.242532131681)*x[1]+(0.429713768025)*x[2]**o+(0.171223902751)*x[2]
        arg[5,0,0]=(0.695331559401)*x[0]**o+(0.819482211381)*x[0]+(0.550452400412)*x[1]**o+(0.518496496336)*x[1]+(-0.24727850431)*x[2]**o+(-0.796406493488)*x[2]
        arg[5,0,1]=(0.469488028534)*x[0]**o+(0.457530124732)*x[0]+(0.922206279456)*x[1]**o+(0.678758573006)*x[1]+(0.34102098746)*x[2]**o+(0.108616278675)*x[2]
        arg[5,1,0]=(0.444799933589)*x[0]**o+(-0.361568786934)*x[0]+(0.470174557338)*x[1]**o+(-0.344557214342)*x[1]+(0.894860467988)*x[2]**o+(-0.347027743579)*x[2]
        arg[5,1,1]=(0.0304781332872)*x[0]**o+(-0.69046475182)*x[0]+(0.873260975232)*x[1]**o+(-0.705100555993)*x[1]+(0.660057279013)*x[2]**o+(-0.910002146105)*x[2]
        ref[0,0,0]=(-1.21826236426)/(o+1.)+(-0.863041053259)+(0.804252705823)*0.5**o
        ref[0,0,1]=(-0.776864688409)/(o+1.)+(-0.31912978519)+(-0.845902068304)*0.5**o
        ref[0,1,0]=(-0.850346867462)/(o+1.)+(-0.0112427484226)+(0.0113663840954)*0.5**o
        ref[0,1,1]=(0.22463367197)/(o+1.)+(0.248638292962)+(0.708589516593)*0.5**o
        ref[1,0,0]=(1.58746312094)/(o+1.)+(-0.17074899438)+(0.836102144172)*0.5**o
        ref[1,0,1]=(-0.363417638344)/(o+1.)+(0.420165683258)+(-0.0712209756059)*0.5**o
        ref[1,1,0]=(-1.64760371583)/(o+1.)+(0.138267558514)+(-0.982992052158)*0.5**o
        ref[1,1,1]=(1.31550552722)/(o+1.)+(0.709685790293)+(0.518426662725)*0.5**o
        ref[2,0,0]=(0.820074870865)/(o+1.)+(0.0198543141864)+(-0.0368697940364)*0.5**o
        ref[2,0,1]=(-0.729262369848)/(o+1.)+(1.09152422841)+(-0.785633726304)*0.5**o
        ref[2,1,0]=(0.875394361701)/(o+1.)+(0.618695970363)+(0.969244001518)*0.5**o
        ref[2,1,1]=(1.1588508781)/(o+1.)+(0.437911816045)+(-0.310035929524)*0.5**o
        ref[3,0,0]=(-0.211796027546)/(o+1.)+(0.424078285949)+(0.245553971829)*0.5**o
        ref[3,0,1]=(-0.700684961711)/(o+1.)+(0.143307435844)+(0.427017913395)*0.5**o
        ref[3,1,0]=(0.896259869918)/(o+1.)+(-0.592079297738)+(-0.29533334088)*0.5**o
        ref[3,1,1]=(-0.580934373198)/(o+1.)+(-0.50115590932)+(-0.146152544907)*0.5**o
        ref[4,0,0]=(0.450220407566)/(o+1.)+(0.289178770177)+(0.0552991386013)*0.5**o
        ref[4,0,1]=(0.1837985251)/(o+1.)+(-1.20506020582)+(0.577046858044)*0.5**o
        ref[4,1,0]=(-0.0261798174917)/(o+1.)+(-0.634512568264)+(-0.358558179011)*0.5**o
        ref[4,1,1]=(1.34979337728)/(o+1.)+(0.447708916874)+(0.840098089823)*0.5**o
        ref[5,0,0]=(0.303173896103)/(o+1.)+(0.270786107114)+(0.695331559401)*0.5**o
        ref[5,0,1]=(1.26322726692)/(o+1.)+(0.622452488207)+(0.469488028534)*0.5**o
        ref[5,1,0]=(1.36503502533)/(o+1.)+(-0.526576872427)+(0.444799933589)*0.5**o
        ref[5,1,1]=(1.53331825424)/(o+1.)+(-1.15278372696)+(0.0304781332872)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_Solution_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.348972036919)*x[0]**o+(0.123542094911)*x[0]+(-0.596353540657)*x[1]**o+(0.717656729405)*x[1]
        arg[0,0,0,1]=(0.187733014896)*x[0]**o+(0.76244697815)*x[0]+(0.261409664458)*x[1]**o+(0.0213714031642)*x[1]
        arg[0,0,1,0]=(0.951655197513)*x[0]**o+(-0.865274104487)*x[0]+(0.59127040848)*x[1]**o+(-0.261622300136)*x[1]
        arg[0,0,1,1]=(-0.188127934304)*x[0]**o+(-0.513768204254)*x[0]+(0.77162116582)*x[1]**o+(-0.12621176914)*x[1]
        arg[0,0,2,0]=(0.770717242337)*x[0]**o+(-0.991038362841)*x[0]+(0.908566805373)*x[1]**o+(-0.24890064672)*x[1]
        arg[0,0,2,1]=(-0.543253359807)*x[0]**o+(-0.0504511921259)*x[0]+(-0.724584621389)*x[1]**o+(0.999965312141)*x[1]
        arg[0,1,0,0]=(0.986939140609)*x[0]**o+(0.236894127675)*x[0]+(0.520162431169)*x[1]**o+(0.306413415759)*x[1]
        arg[0,1,0,1]=(-0.171773212929)*x[0]**o+(-0.248436968201)*x[0]+(0.43818378458)*x[1]**o+(-0.495734982435)*x[1]
        arg[0,1,1,0]=(-0.369350989684)*x[0]**o+(0.59047357584)*x[0]+(0.422340945702)*x[1]**o+(0.326270009775)*x[1]
        arg[0,1,1,1]=(0.559606389467)*x[0]**o+(-0.0507064379501)*x[0]+(-0.0464190048363)*x[1]**o+(0.18964879235)*x[1]
        arg[0,1,2,0]=(-0.989408371198)*x[0]**o+(0.108750148268)*x[0]+(-0.347984444559)*x[1]**o+(-0.819590699683)*x[1]
        arg[0,1,2,1]=(-0.289295900777)*x[0]**o+(-0.579698633174)*x[0]+(-0.124928198101)*x[1]**o+(0.640901698875)*x[1]
        arg[0,2,0,0]=(0.132599667548)*x[0]**o+(-0.102095433147)*x[0]+(0.446169236302)*x[1]**o+(-0.844062525718)*x[1]
        arg[0,2,0,1]=(-0.452662917924)*x[0]**o+(-0.0497770418153)*x[0]+(-0.258525519083)*x[1]**o+(-0.0365197858914)*x[1]
        arg[0,2,1,0]=(0.318740871592)*x[0]**o+(0.562764515639)*x[0]+(-0.209089266173)*x[1]**o+(0.922024900771)*x[1]
        arg[0,2,1,1]=(-0.825757440563)*x[0]**o+(0.634009249217)*x[0]+(0.954836398565)*x[1]**o+(-0.910652766097)*x[1]
        arg[0,2,2,0]=(-0.640337007803)*x[0]**o+(0.862625623816)*x[0]+(-0.0327529254483)*x[1]**o+(-0.327305638603)*x[1]
        arg[0,2,2,1]=(-0.956300293885)*x[0]**o+(0.456116376134)*x[0]+(0.312023159058)*x[1]**o+(0.768546792276)*x[1]
        arg[0,3,0,0]=(-0.927040285049)*x[0]**o+(-0.614994799603)*x[0]+(-0.431859510779)*x[1]**o+(-0.088774748513)*x[1]
        arg[0,3,0,1]=(-0.807009561768)*x[0]**o+(0.00323409463398)*x[0]+(0.274814268019)*x[1]**o+(-0.132755038246)*x[1]
        arg[0,3,1,0]=(0.931774139846)*x[0]**o+(0.665327108449)*x[0]+(0.130437344004)*x[1]**o+(-0.00859025546518)*x[1]
        arg[0,3,1,1]=(-0.314188008746)*x[0]**o+(0.405251729437)*x[0]+(-0.313484462262)*x[1]**o+(-0.670765905491)*x[1]
        arg[0,3,2,0]=(0.748691505108)*x[0]**o+(0.717110963353)*x[0]+(-0.451892315269)*x[1]**o+(-0.103930621637)*x[1]
        arg[0,3,2,1]=(-0.124290384657)*x[0]**o+(0.0761550925153)*x[0]+(0.864166710803)*x[1]**o+(0.050297196468)*x[1]
        arg[0,4,0,0]=(-0.726606985714)*x[0]**o+(-0.304862755503)*x[0]+(-0.364735884875)*x[1]**o+(0.769999145518)*x[1]
        arg[0,4,0,1]=(-0.716457484159)*x[0]**o+(0.850185561874)*x[0]+(0.924535166786)*x[1]**o+(0.414539526778)*x[1]
        arg[0,4,1,0]=(-0.67154700238)*x[0]**o+(-0.0990079744678)*x[0]+(-0.738258048173)*x[1]**o+(-0.105333364414)*x[1]
        arg[0,4,1,1]=(-0.568569022142)*x[0]**o+(-0.865340476096)*x[0]+(0.592223896873)*x[1]**o+(0.545216501911)*x[1]
        arg[0,4,2,0]=(0.959619955514)*x[0]**o+(-0.625097978453)*x[0]+(0.447944032533)*x[1]**o+(-0.792670959618)*x[1]
        arg[0,4,2,1]=(-0.446578795272)*x[0]**o+(0.516341492325)*x[0]+(0.383143400712)*x[1]**o+(-0.339255681885)*x[1]
        arg[1,0,0,0]=(0.130600745253)*x[0]**o+(-0.225084866063)*x[0]+(-0.871963625443)*x[1]**o+(-0.0741251944735)*x[1]
        arg[1,0,0,1]=(-0.684630134211)*x[0]**o+(-0.298097256903)*x[0]+(0.511206122216)*x[1]**o+(-0.784104136535)*x[1]
        arg[1,0,1,0]=(0.624178362847)*x[0]**o+(0.161787148072)*x[0]+(-0.0906465041298)*x[1]**o+(-0.0302149132362)*x[1]
        arg[1,0,1,1]=(-0.403988173215)*x[0]**o+(-0.423895624882)*x[0]+(-0.0594261878161)*x[1]**o+(0.71753539369)*x[1]
        arg[1,0,2,0]=(0.411689797339)*x[0]**o+(0.0555768292842)*x[0]+(0.786614145981)*x[1]**o+(-0.701418967065)*x[1]
        arg[1,0,2,1]=(0.971933572797)*x[0]**o+(0.203165120814)*x[0]+(0.50340688009)*x[1]**o+(-0.443869607992)*x[1]
        arg[1,1,0,0]=(0.517782412737)*x[0]**o+(-0.233071827503)*x[0]+(0.310115588175)*x[1]**o+(-0.970604318783)*x[1]
        arg[1,1,0,1]=(0.250379154253)*x[0]**o+(-0.0914513321258)*x[0]+(0.466403827523)*x[1]**o+(-0.454369386353)*x[1]
        arg[1,1,1,0]=(-0.235520035004)*x[0]**o+(0.0932661387959)*x[0]+(0.0964933173918)*x[1]**o+(0.585245824454)*x[1]
        arg[1,1,1,1]=(-0.466145341257)*x[0]**o+(0.532910678544)*x[0]+(0.757545184326)*x[1]**o+(-0.488241176428)*x[1]
        arg[1,1,2,0]=(0.802070127079)*x[0]**o+(0.30227826497)*x[0]+(0.76818718588)*x[1]**o+(-0.966380392422)*x[1]
        arg[1,1,2,1]=(0.764411747219)*x[0]**o+(0.62151105703)*x[0]+(0.310875960956)*x[1]**o+(0.218417169467)*x[1]
        arg[1,2,0,0]=(0.627865841486)*x[0]**o+(0.328844171432)*x[0]+(0.47405718918)*x[1]**o+(0.238471462812)*x[1]
        arg[1,2,0,1]=(-0.890402471541)*x[0]**o+(0.0654874441479)*x[0]+(0.411199516291)*x[1]**o+(0.0669990208336)*x[1]
        arg[1,2,1,0]=(-0.789401901979)*x[0]**o+(-0.379725885915)*x[0]+(-0.103817842125)*x[1]**o+(0.358055283478)*x[1]
        arg[1,2,1,1]=(-0.619688531158)*x[0]**o+(0.314022911152)*x[0]+(-0.515963904961)*x[1]**o+(0.807912272743)*x[1]
        arg[1,2,2,0]=(0.696584946679)*x[0]**o+(-0.156405028983)*x[0]+(0.99374085906)*x[1]**o+(0.692362331558)*x[1]
        arg[1,2,2,1]=(0.463393460998)*x[0]**o+(-0.0302433372264)*x[0]+(0.243006695756)*x[1]**o+(0.934578685307)*x[1]
        arg[1,3,0,0]=(-0.760149691585)*x[0]**o+(0.305312987392)*x[0]+(0.478665319824)*x[1]**o+(-0.395734016727)*x[1]
        arg[1,3,0,1]=(-0.495638457166)*x[0]**o+(-0.352868042523)*x[0]+(0.0577132713041)*x[1]**o+(0.856507718332)*x[1]
        arg[1,3,1,0]=(-0.588160041725)*x[0]**o+(-0.941242199161)*x[0]+(-0.883563055172)*x[1]**o+(-0.474349426459)*x[1]
        arg[1,3,1,1]=(-0.822752260982)*x[0]**o+(0.284881595545)*x[0]+(-0.914198363943)*x[1]**o+(0.421107500666)*x[1]
        arg[1,3,2,0]=(-0.125099230328)*x[0]**o+(-0.0167977306674)*x[0]+(-0.880147366581)*x[1]**o+(0.947650728684)*x[1]
        arg[1,3,2,1]=(-0.770895899992)*x[0]**o+(-0.121705997003)*x[0]+(-0.0486858273347)*x[1]**o+(0.666179109672)*x[1]
        arg[1,4,0,0]=(-0.767476534476)*x[0]**o+(0.720013119195)*x[0]+(-0.540220631624)*x[1]**o+(-0.363702385125)*x[1]
        arg[1,4,0,1]=(0.90195509915)*x[0]**o+(0.104569298687)*x[0]+(0.901816813435)*x[1]**o+(0.421060929159)*x[1]
        arg[1,4,1,0]=(0.0901631681262)*x[0]**o+(-0.330570875574)*x[0]+(0.892147778885)*x[1]**o+(-0.102976747188)*x[1]
        arg[1,4,1,1]=(-0.336016437275)*x[0]**o+(-0.00913798206221)*x[0]+(-0.20211674106)*x[1]**o+(-0.0470039081275)*x[1]
        arg[1,4,2,0]=(0.194383418491)*x[0]**o+(-0.913993330791)*x[0]+(-0.0207457431142)*x[1]**o+(-0.728130242724)*x[1]
        arg[1,4,2,1]=(-0.285983741049)*x[0]**o+(-0.359824200302)*x[0]+(-0.286913656927)*x[1]**o+(-0.801477464894)*x[1]
        arg[2,0,0,0]=(-0.266085322677)*x[0]**o+(-0.477036323188)*x[0]+(0.967304544659)*x[1]**o+(-0.843721203165)*x[1]
        arg[2,0,0,1]=(-0.431692878995)*x[0]**o+(-0.326793076488)*x[0]+(0.478220893643)*x[1]**o+(-0.953607426852)*x[1]
        arg[2,0,1,0]=(0.800398295672)*x[0]**o+(-0.726923243756)*x[0]+(0.641194491232)*x[1]**o+(0.933755071699)*x[1]
        arg[2,0,1,1]=(0.778158607269)*x[0]**o+(0.192895772287)*x[0]+(0.160540751687)*x[1]**o+(0.132780133987)*x[1]
        arg[2,0,2,0]=(0.0700487728725)*x[0]**o+(0.366571342769)*x[0]+(0.213123464402)*x[1]**o+(0.0224970803568)*x[1]
        arg[2,0,2,1]=(-0.608321696505)*x[0]**o+(0.416761589908)*x[0]+(0.0499280394381)*x[1]**o+(-0.678150075911)*x[1]
        arg[2,1,0,0]=(-0.580987690899)*x[0]**o+(-0.625951863984)*x[0]+(0.0064094419355)*x[1]**o+(0.646045286912)*x[1]
        arg[2,1,0,1]=(-0.881255703221)*x[0]**o+(-0.153796152409)*x[0]+(0.320566497467)*x[1]**o+(-0.217827916224)*x[1]
        arg[2,1,1,0]=(0.981593086009)*x[0]**o+(0.659643450249)*x[0]+(0.824530802391)*x[1]**o+(0.109125926037)*x[1]
        arg[2,1,1,1]=(-0.79695617371)*x[0]**o+(-0.340030091407)*x[0]+(0.476648191338)*x[1]**o+(-0.751961375342)*x[1]
        arg[2,1,2,0]=(0.00785807621726)*x[0]**o+(-0.177037931946)*x[0]+(-0.322685883101)*x[1]**o+(0.639485466195)*x[1]
        arg[2,1,2,1]=(0.386667953213)*x[0]**o+(0.805115373435)*x[0]+(0.489529148574)*x[1]**o+(0.380650996708)*x[1]
        arg[2,2,0,0]=(-0.205678281473)*x[0]**o+(0.725798252716)*x[0]+(-0.884620261631)*x[1]**o+(0.737678769923)*x[1]
        arg[2,2,0,1]=(-0.859841848792)*x[0]**o+(0.215497396508)*x[0]+(-0.9231710768)*x[1]**o+(-0.504914651252)*x[1]
        arg[2,2,1,0]=(-0.0161889255216)*x[0]**o+(0.218150095097)*x[0]+(0.508505799895)*x[1]**o+(0.441270271663)*x[1]
        arg[2,2,1,1]=(0.645494826531)*x[0]**o+(0.812462584734)*x[0]+(0.498639261012)*x[1]**o+(0.695415642432)*x[1]
        arg[2,2,2,0]=(-0.855342734108)*x[0]**o+(0.174928383231)*x[0]+(-0.550636347213)*x[1]**o+(0.814295216919)*x[1]
        arg[2,2,2,1]=(-0.146152468476)*x[0]**o+(-0.810876776267)*x[0]+(0.77444775812)*x[1]**o+(0.758171250375)*x[1]
        arg[2,3,0,0]=(0.914771099535)*x[0]**o+(-0.801103658802)*x[0]+(-0.339761119169)*x[1]**o+(-0.0697409372498)*x[1]
        arg[2,3,0,1]=(-0.278017621273)*x[0]**o+(-0.916896227964)*x[0]+(0.0151205004002)*x[1]**o+(-0.36424189479)*x[1]
        arg[2,3,1,0]=(0.635845368235)*x[0]**o+(-0.286420165946)*x[0]+(-0.547314386502)*x[1]**o+(-0.297882680065)*x[1]
        arg[2,3,1,1]=(0.236860892332)*x[0]**o+(0.670289851551)*x[0]+(-0.437288046493)*x[1]**o+(0.0610684872034)*x[1]
        arg[2,3,2,0]=(0.096479176127)*x[0]**o+(-0.992608241155)*x[0]+(0.622650933171)*x[1]**o+(-0.171594052732)*x[1]
        arg[2,3,2,1]=(0.259913661654)*x[0]**o+(0.521353257934)*x[0]+(0.141212812345)*x[1]**o+(0.0311971708742)*x[1]
        arg[2,4,0,0]=(0.208498140469)*x[0]**o+(0.914285328223)*x[0]+(-0.368860713612)*x[1]**o+(0.744057640483)*x[1]
        arg[2,4,0,1]=(-0.0760701135919)*x[0]**o+(-0.0666410245297)*x[0]+(-0.442858585142)*x[1]**o+(-0.869273907698)*x[1]
        arg[2,4,1,0]=(0.694291134331)*x[0]**o+(0.153487646161)*x[0]+(-0.454726570824)*x[1]**o+(0.12533511793)*x[1]
        arg[2,4,1,1]=(0.505643124198)*x[0]**o+(0.935208927517)*x[0]+(0.120271053976)*x[1]**o+(0.472499209985)*x[1]
        arg[2,4,2,0]=(0.458890639035)*x[0]**o+(-0.38125264637)*x[0]+(-0.742525095759)*x[1]**o+(0.0727341692272)*x[1]
        arg[2,4,2,1]=(-0.228856512525)*x[0]**o+(0.215540806099)*x[0]+(-0.492076254398)*x[1]**o+(0.325121281149)*x[1]
        arg[3,0,0,0]=(0.791320435019)*x[0]**o+(0.264208069532)*x[0]+(0.105218141263)*x[1]**o+(-0.947073121631)*x[1]
        arg[3,0,0,1]=(0.384081306848)*x[0]**o+(-0.735420806741)*x[0]+(0.695451719819)*x[1]**o+(-0.104071285853)*x[1]
        arg[3,0,1,0]=(0.176280431402)*x[0]**o+(0.766248516714)*x[0]+(0.620920827635)*x[1]**o+(0.571778731591)*x[1]
        arg[3,0,1,1]=(0.895148060637)*x[0]**o+(0.120401904357)*x[0]+(0.500131556768)*x[1]**o+(-0.432523916076)*x[1]
        arg[3,0,2,0]=(-0.171375065793)*x[0]**o+(0.731777853738)*x[0]+(0.914774635339)*x[1]**o+(-0.329504614878)*x[1]
        arg[3,0,2,1]=(-0.65523706909)*x[0]**o+(-0.309487164889)*x[0]+(-0.244763521442)*x[1]**o+(0.790744116827)*x[1]
        arg[3,1,0,0]=(-0.515742288)*x[0]**o+(0.688021032329)*x[0]+(0.744558730681)*x[1]**o+(0.663410706435)*x[1]
        arg[3,1,0,1]=(0.299920493853)*x[0]**o+(0.221554378219)*x[0]+(-0.262111371211)*x[1]**o+(0.597219370531)*x[1]
        arg[3,1,1,0]=(-0.491648532317)*x[0]**o+(-0.0763921400417)*x[0]+(0.517994656474)*x[1]**o+(0.690649210498)*x[1]
        arg[3,1,1,1]=(0.291881729319)*x[0]**o+(0.388296683726)*x[0]+(0.304223657331)*x[1]**o+(-0.17249216188)*x[1]
        arg[3,1,2,0]=(0.309288981861)*x[0]**o+(-0.638172982762)*x[0]+(-0.566768084047)*x[1]**o+(-0.694439437371)*x[1]
        arg[3,1,2,1]=(-0.680391436031)*x[0]**o+(0.876096306554)*x[0]+(0.676979754874)*x[1]**o+(0.376507786465)*x[1]
        arg[3,2,0,0]=(-0.688464200232)*x[0]**o+(0.404140014906)*x[0]+(-0.389359624725)*x[1]**o+(0.218257423404)*x[1]
        arg[3,2,0,1]=(-0.321661287857)*x[0]**o+(0.305707842777)*x[0]+(0.0488067596906)*x[1]**o+(0.475071042874)*x[1]
        arg[3,2,1,0]=(-0.172172832131)*x[0]**o+(-0.0589598637728)*x[0]+(0.997578239775)*x[1]**o+(0.0919614884141)*x[1]
        arg[3,2,1,1]=(0.500590025777)*x[0]**o+(0.258724052781)*x[0]+(0.233819575609)*x[1]**o+(0.787949345995)*x[1]
        arg[3,2,2,0]=(-0.464931198743)*x[0]**o+(0.689246395117)*x[0]+(0.0701366334357)*x[1]**o+(-0.206391031385)*x[1]
        arg[3,2,2,1]=(-0.352492545609)*x[0]**o+(-0.160385273073)*x[0]+(0.876791526094)*x[1]**o+(0.748257988817)*x[1]
        arg[3,3,0,0]=(0.70346530112)*x[0]**o+(-0.351192123239)*x[0]+(-0.985298342079)*x[1]**o+(-0.286817451723)*x[1]
        arg[3,3,0,1]=(0.841285056577)*x[0]**o+(0.741986440026)*x[0]+(-0.758645627646)*x[1]**o+(-0.914494381783)*x[1]
        arg[3,3,1,0]=(-0.614293213484)*x[0]**o+(-0.746555667296)*x[0]+(-0.301781252786)*x[1]**o+(-0.721633195357)*x[1]
        arg[3,3,1,1]=(-0.287510519978)*x[0]**o+(-0.764960517935)*x[0]+(-0.948032248565)*x[1]**o+(-0.548676002552)*x[1]
        arg[3,3,2,0]=(0.145506943729)*x[0]**o+(-0.353925293653)*x[0]+(0.786904887352)*x[1]**o+(-0.36548133551)*x[1]
        arg[3,3,2,1]=(0.60782215735)*x[0]**o+(0.872444227513)*x[0]+(-0.237571902274)*x[1]**o+(-0.0559745367747)*x[1]
        arg[3,4,0,0]=(0.691107698337)*x[0]**o+(0.0800532750053)*x[0]+(-0.847456183316)*x[1]**o+(0.911068576288)*x[1]
        arg[3,4,0,1]=(-0.00167606578449)*x[0]**o+(-0.697603805697)*x[0]+(-0.362440886816)*x[1]**o+(-0.0604379772766)*x[1]
        arg[3,4,1,0]=(-0.74026325403)*x[0]**o+(-0.539076677004)*x[0]+(-0.317176913637)*x[1]**o+(0.759776288772)*x[1]
        arg[3,4,1,1]=(-0.230005454291)*x[0]**o+(-0.929557352119)*x[0]+(-0.435125210116)*x[1]**o+(0.106892135893)*x[1]
        arg[3,4,2,0]=(-0.638149620463)*x[0]**o+(-0.0511424128986)*x[0]+(0.460436795546)*x[1]**o+(-0.919535518181)*x[1]
        arg[3,4,2,1]=(-0.793537245531)*x[0]**o+(0.409768940347)*x[0]+(0.632560678557)*x[1]**o+(0.700596370851)*x[1]
        ref[0,0,0,0]=(-0.596353540657)/(o+1.)+(0.420599412158)+(-0.348972036919)*0.5**o
        ref[0,0,0,1]=(0.261409664458)/(o+1.)+(0.391909190657)+(0.187733014896)*0.5**o
        ref[0,0,1,0]=(0.59127040848)/(o+1.)+(-0.563448202311)+(0.951655197513)*0.5**o
        ref[0,0,1,1]=(0.77162116582)/(o+1.)+(-0.319989986697)+(-0.188127934304)*0.5**o
        ref[0,0,2,0]=(0.908566805373)/(o+1.)+(-0.619969504781)+(0.770717242337)*0.5**o
        ref[0,0,2,1]=(-0.724584621389)/(o+1.)+(0.474757060008)+(-0.543253359807)*0.5**o
        ref[0,1,0,0]=(0.520162431169)/(o+1.)+(0.271653771717)+(0.986939140609)*0.5**o
        ref[0,1,0,1]=(0.43818378458)/(o+1.)+(-0.372085975318)+(-0.171773212929)*0.5**o
        ref[0,1,1,0]=(0.422340945702)/(o+1.)+(0.458371792807)+(-0.369350989684)*0.5**o
        ref[0,1,1,1]=(-0.0464190048363)/(o+1.)+(0.0694711771999)+(0.559606389467)*0.5**o
        ref[0,1,2,0]=(-0.347984444559)/(o+1.)+(-0.355420275708)+(-0.989408371198)*0.5**o
        ref[0,1,2,1]=(-0.124928198101)/(o+1.)+(0.0306015328506)+(-0.289295900777)*0.5**o
        ref[0,2,0,0]=(0.446169236302)/(o+1.)+(-0.473078979432)+(0.132599667548)*0.5**o
        ref[0,2,0,1]=(-0.258525519083)/(o+1.)+(-0.0431484138534)+(-0.452662917924)*0.5**o
        ref[0,2,1,0]=(-0.209089266173)/(o+1.)+(0.742394708205)+(0.318740871592)*0.5**o
        ref[0,2,1,1]=(0.954836398565)/(o+1.)+(-0.13832175844)+(-0.825757440563)*0.5**o
        ref[0,2,2,0]=(-0.0327529254483)/(o+1.)+(0.267659992607)+(-0.640337007803)*0.5**o
        ref[0,2,2,1]=(0.312023159058)/(o+1.)+(0.612331584205)+(-0.956300293885)*0.5**o
        ref[0,3,0,0]=(-0.431859510779)/(o+1.)+(-0.351884774058)+(-0.927040285049)*0.5**o
        ref[0,3,0,1]=(0.274814268019)/(o+1.)+(-0.064760471806)+(-0.807009561768)*0.5**o
        ref[0,3,1,0]=(0.130437344004)/(o+1.)+(0.328368426492)+(0.931774139846)*0.5**o
        ref[0,3,1,1]=(-0.313484462262)/(o+1.)+(-0.132757088027)+(-0.314188008746)*0.5**o
        ref[0,3,2,0]=(-0.451892315269)/(o+1.)+(0.306590170858)+(0.748691505108)*0.5**o
        ref[0,3,2,1]=(0.864166710803)/(o+1.)+(0.0632261444916)+(-0.124290384657)*0.5**o
        ref[0,4,0,0]=(-0.364735884875)/(o+1.)+(0.232568195007)+(-0.726606985714)*0.5**o
        ref[0,4,0,1]=(0.924535166786)/(o+1.)+(0.632362544326)+(-0.716457484159)*0.5**o
        ref[0,4,1,0]=(-0.738258048173)/(o+1.)+(-0.102170669441)+(-0.67154700238)*0.5**o
        ref[0,4,1,1]=(0.592223896873)/(o+1.)+(-0.160061987092)+(-0.568569022142)*0.5**o
        ref[0,4,2,0]=(0.447944032533)/(o+1.)+(-0.708884469036)+(0.959619955514)*0.5**o
        ref[0,4,2,1]=(0.383143400712)/(o+1.)+(0.0885429052198)+(-0.446578795272)*0.5**o
        ref[1,0,0,0]=(-0.871963625443)/(o+1.)+(-0.149605030268)+(0.130600745253)*0.5**o
        ref[1,0,0,1]=(0.511206122216)/(o+1.)+(-0.541100696719)+(-0.684630134211)*0.5**o
        ref[1,0,1,0]=(-0.0906465041298)/(o+1.)+(0.065786117418)+(0.624178362847)*0.5**o
        ref[1,0,1,1]=(-0.0594261878161)/(o+1.)+(0.146819884404)+(-0.403988173215)*0.5**o
        ref[1,0,2,0]=(0.786614145981)/(o+1.)+(-0.32292106889)+(0.411689797339)*0.5**o
        ref[1,0,2,1]=(0.50340688009)/(o+1.)+(-0.120352243589)+(0.971933572797)*0.5**o
        ref[1,1,0,0]=(0.310115588175)/(o+1.)+(-0.601838073143)+(0.517782412737)*0.5**o
        ref[1,1,0,1]=(0.466403827523)/(o+1.)+(-0.27291035924)+(0.250379154253)*0.5**o
        ref[1,1,1,0]=(0.0964933173918)/(o+1.)+(0.339255981625)+(-0.235520035004)*0.5**o
        ref[1,1,1,1]=(0.757545184326)/(o+1.)+(0.0223347510579)+(-0.466145341257)*0.5**o
        ref[1,1,2,0]=(0.76818718588)/(o+1.)+(-0.332051063726)+(0.802070127079)*0.5**o
        ref[1,1,2,1]=(0.310875960956)/(o+1.)+(0.419964113249)+(0.764411747219)*0.5**o
        ref[1,2,0,0]=(0.47405718918)/(o+1.)+(0.283657817122)+(0.627865841486)*0.5**o
        ref[1,2,0,1]=(0.411199516291)/(o+1.)+(0.0662432324908)+(-0.890402471541)*0.5**o
        ref[1,2,1,0]=(-0.103817842125)/(o+1.)+(-0.0108353012186)+(-0.789401901979)*0.5**o
        ref[1,2,1,1]=(-0.515963904961)/(o+1.)+(0.560967591948)+(-0.619688531158)*0.5**o
        ref[1,2,2,0]=(0.99374085906)/(o+1.)+(0.267978651288)+(0.696584946679)*0.5**o
        ref[1,2,2,1]=(0.243006695756)/(o+1.)+(0.45216767404)+(0.463393460998)*0.5**o
        ref[1,3,0,0]=(0.478665319824)/(o+1.)+(-0.0452105146678)+(-0.760149691585)*0.5**o
        ref[1,3,0,1]=(0.0577132713041)/(o+1.)+(0.251819837904)+(-0.495638457166)*0.5**o
        ref[1,3,1,0]=(-0.883563055172)/(o+1.)+(-0.70779581281)+(-0.588160041725)*0.5**o
        ref[1,3,1,1]=(-0.914198363943)/(o+1.)+(0.352994548105)+(-0.822752260982)*0.5**o
        ref[1,3,2,0]=(-0.880147366581)/(o+1.)+(0.465426499008)+(-0.125099230328)*0.5**o
        ref[1,3,2,1]=(-0.0486858273347)/(o+1.)+(0.272236556335)+(-0.770895899992)*0.5**o
        ref[1,4,0,0]=(-0.540220631624)/(o+1.)+(0.178155367035)+(-0.767476534476)*0.5**o
        ref[1,4,0,1]=(0.901816813435)/(o+1.)+(0.262815113923)+(0.90195509915)*0.5**o
        ref[1,4,1,0]=(0.892147778885)/(o+1.)+(-0.216773811381)+(0.0901631681262)*0.5**o
        ref[1,4,1,1]=(-0.20211674106)/(o+1.)+(-0.0280709450949)+(-0.336016437275)*0.5**o
        ref[1,4,2,0]=(-0.0207457431142)/(o+1.)+(-0.821061786757)+(0.194383418491)*0.5**o
        ref[1,4,2,1]=(-0.286913656927)/(o+1.)+(-0.580650832598)+(-0.285983741049)*0.5**o
        ref[2,0,0,0]=(0.967304544659)/(o+1.)+(-0.660378763176)+(-0.266085322677)*0.5**o
        ref[2,0,0,1]=(0.478220893643)/(o+1.)+(-0.64020025167)+(-0.431692878995)*0.5**o
        ref[2,0,1,0]=(0.641194491232)/(o+1.)+(0.103415913972)+(0.800398295672)*0.5**o
        ref[2,0,1,1]=(0.160540751687)/(o+1.)+(0.162837953137)+(0.778158607269)*0.5**o
        ref[2,0,2,0]=(0.213123464402)/(o+1.)+(0.194534211563)+(0.0700487728725)*0.5**o
        ref[2,0,2,1]=(0.0499280394381)/(o+1.)+(-0.130694243001)+(-0.608321696505)*0.5**o
        ref[2,1,0,0]=(0.0064094419355)/(o+1.)+(0.0100467114639)+(-0.580987690899)*0.5**o
        ref[2,1,0,1]=(0.320566497467)/(o+1.)+(-0.185812034316)+(-0.881255703221)*0.5**o
        ref[2,1,1,0]=(0.824530802391)/(o+1.)+(0.384384688143)+(0.981593086009)*0.5**o
        ref[2,1,1,1]=(0.476648191338)/(o+1.)+(-0.545995733375)+(-0.79695617371)*0.5**o
        ref[2,1,2,0]=(-0.322685883101)/(o+1.)+(0.231223767125)+(0.00785807621726)*0.5**o
        ref[2,1,2,1]=(0.489529148574)/(o+1.)+(0.592883185071)+(0.386667953213)*0.5**o
        ref[2,2,0,0]=(-0.884620261631)/(o+1.)+(0.73173851132)+(-0.205678281473)*0.5**o
        ref[2,2,0,1]=(-0.9231710768)/(o+1.)+(-0.144708627372)+(-0.859841848792)*0.5**o
        ref[2,2,1,0]=(0.508505799895)/(o+1.)+(0.32971018338)+(-0.0161889255216)*0.5**o
        ref[2,2,1,1]=(0.498639261012)/(o+1.)+(0.753939113583)+(0.645494826531)*0.5**o
        ref[2,2,2,0]=(-0.550636347213)/(o+1.)+(0.494611800075)+(-0.855342734108)*0.5**o
        ref[2,2,2,1]=(0.77444775812)/(o+1.)+(-0.0263527629459)+(-0.146152468476)*0.5**o
        ref[2,3,0,0]=(-0.339761119169)/(o+1.)+(-0.435422298026)+(0.914771099535)*0.5**o
        ref[2,3,0,1]=(0.0151205004002)/(o+1.)+(-0.640569061377)+(-0.278017621273)*0.5**o
        ref[2,3,1,0]=(-0.547314386502)/(o+1.)+(-0.292151423006)+(0.635845368235)*0.5**o
        ref[2,3,1,1]=(-0.437288046493)/(o+1.)+(0.365679169377)+(0.236860892332)*0.5**o
        ref[2,3,2,0]=(0.622650933171)/(o+1.)+(-0.582101146943)+(0.096479176127)*0.5**o
        ref[2,3,2,1]=(0.141212812345)/(o+1.)+(0.276275214404)+(0.259913661654)*0.5**o
        ref[2,4,0,0]=(-0.368860713612)/(o+1.)+(0.829171484353)+(0.208498140469)*0.5**o
        ref[2,4,0,1]=(-0.442858585142)/(o+1.)+(-0.467957466114)+(-0.0760701135919)*0.5**o
        ref[2,4,1,0]=(-0.454726570824)/(o+1.)+(0.139411382046)+(0.694291134331)*0.5**o
        ref[2,4,1,1]=(0.120271053976)/(o+1.)+(0.703854068751)+(0.505643124198)*0.5**o
        ref[2,4,2,0]=(-0.742525095759)/(o+1.)+(-0.154259238572)+(0.458890639035)*0.5**o
        ref[2,4,2,1]=(-0.492076254398)/(o+1.)+(0.270331043624)+(-0.228856512525)*0.5**o
        ref[3,0,0,0]=(0.105218141263)/(o+1.)+(-0.34143252605)+(0.791320435019)*0.5**o
        ref[3,0,0,1]=(0.695451719819)/(o+1.)+(-0.419746046297)+(0.384081306848)*0.5**o
        ref[3,0,1,0]=(0.620920827635)/(o+1.)+(0.669013624153)+(0.176280431402)*0.5**o
        ref[3,0,1,1]=(0.500131556768)/(o+1.)+(-0.15606100586)+(0.895148060637)*0.5**o
        ref[3,0,2,0]=(0.914774635339)/(o+1.)+(0.20113661943)+(-0.171375065793)*0.5**o
        ref[3,0,2,1]=(-0.244763521442)/(o+1.)+(0.240628475969)+(-0.65523706909)*0.5**o
        ref[3,1,0,0]=(0.744558730681)/(o+1.)+(0.675715869382)+(-0.515742288)*0.5**o
        ref[3,1,0,1]=(-0.262111371211)/(o+1.)+(0.409386874375)+(0.299920493853)*0.5**o
        ref[3,1,1,0]=(0.517994656474)/(o+1.)+(0.307128535228)+(-0.491648532317)*0.5**o
        ref[3,1,1,1]=(0.304223657331)/(o+1.)+(0.107902260923)+(0.291881729319)*0.5**o
        ref[3,1,2,0]=(-0.566768084047)/(o+1.)+(-0.666306210066)+(0.309288981861)*0.5**o
        ref[3,1,2,1]=(0.676979754874)/(o+1.)+(0.62630204651)+(-0.680391436031)*0.5**o
        ref[3,2,0,0]=(-0.389359624725)/(o+1.)+(0.311198719155)+(-0.688464200232)*0.5**o
        ref[3,2,0,1]=(0.0488067596906)/(o+1.)+(0.390389442826)+(-0.321661287857)*0.5**o
        ref[3,2,1,0]=(0.997578239775)/(o+1.)+(0.0165008123207)+(-0.172172832131)*0.5**o
        ref[3,2,1,1]=(0.233819575609)/(o+1.)+(0.523336699388)+(0.500590025777)*0.5**o
        ref[3,2,2,0]=(0.0701366334357)/(o+1.)+(0.241427681866)+(-0.464931198743)*0.5**o
        ref[3,2,2,1]=(0.876791526094)/(o+1.)+(0.293936357872)+(-0.352492545609)*0.5**o
        ref[3,3,0,0]=(-0.985298342079)/(o+1.)+(-0.319004787481)+(0.70346530112)*0.5**o
        ref[3,3,0,1]=(-0.758645627646)/(o+1.)+(-0.0862539708788)+(0.841285056577)*0.5**o
        ref[3,3,1,0]=(-0.301781252786)/(o+1.)+(-0.734094431327)+(-0.614293213484)*0.5**o
        ref[3,3,1,1]=(-0.948032248565)/(o+1.)+(-0.656818260243)+(-0.287510519978)*0.5**o
        ref[3,3,2,0]=(0.786904887352)/(o+1.)+(-0.359703314582)+(0.145506943729)*0.5**o
        ref[3,3,2,1]=(-0.237571902274)/(o+1.)+(0.408234845369)+(0.60782215735)*0.5**o
        ref[3,4,0,0]=(-0.847456183316)/(o+1.)+(0.495560925646)+(0.691107698337)*0.5**o
        ref[3,4,0,1]=(-0.362440886816)/(o+1.)+(-0.379020891487)+(-0.00167606578449)*0.5**o
        ref[3,4,1,0]=(-0.317176913637)/(o+1.)+(0.110349805884)+(-0.74026325403)*0.5**o
        ref[3,4,1,1]=(-0.435125210116)/(o+1.)+(-0.411332608113)+(-0.230005454291)*0.5**o
        ref[3,4,2,0]=(0.460436795546)/(o+1.)+(-0.48533896554)+(-0.638149620463)*0.5**o
        ref[3,4,2,1]=(0.632560678557)/(o+1.)+(0.555182655599)+(-0.793537245531)*0.5**o
      else:
        arg[0,0,0,0]=(0.816458625566)*x[0]**o+(-0.438180707327)*x[0]+(-0.39836196112)*x[1]**o+(0.641701267855)*x[1]+(0.919064096208)*x[2]**o+(0.0155653082454)*x[2]
        arg[0,0,0,1]=(-0.709065020122)*x[0]**o+(-0.787938005558)*x[0]+(-0.459829890247)*x[1]**o+(-0.306587811189)*x[1]+(0.648348776519)*x[2]**o+(-0.782857657922)*x[2]
        arg[0,0,1,0]=(-0.09165636265)*x[0]**o+(-0.215464577259)*x[0]+(-0.445060581145)*x[1]**o+(0.541797069021)*x[1]+(-0.312096860473)*x[2]**o+(0.307061070632)*x[2]
        arg[0,0,1,1]=(0.900670566988)*x[0]**o+(-0.157226841228)*x[0]+(-0.00514019601556)*x[1]**o+(0.167616993369)*x[1]+(0.331077209212)*x[2]**o+(0.0797784869412)*x[2]
        arg[0,0,2,0]=(-0.883617789072)*x[0]**o+(-0.233507045302)*x[0]+(0.540311388635)*x[1]**o+(-0.0698351272775)*x[1]+(0.598059668701)*x[2]**o+(-0.842961707358)*x[2]
        arg[0,0,2,1]=(-0.770041366552)*x[0]**o+(-0.683157969301)*x[0]+(0.235580399076)*x[1]**o+(-0.994177047985)*x[1]+(-0.90074656484)*x[2]**o+(-0.0133600820046)*x[2]
        arg[0,1,0,0]=(0.90396926296)*x[0]**o+(0.0492056402145)*x[0]+(0.32744155595)*x[1]**o+(0.0162505824727)*x[1]+(0.386607661085)*x[2]**o+(0.759639829913)*x[2]
        arg[0,1,0,1]=(0.47956310963)*x[0]**o+(0.638067028609)*x[0]+(-0.520596788355)*x[1]**o+(0.476897948019)*x[1]+(0.950320232053)*x[2]**o+(-0.603034001297)*x[2]
        arg[0,1,1,0]=(-0.75177304495)*x[0]**o+(0.369014786745)*x[0]+(-0.332220011735)*x[1]**o+(-0.835059332186)*x[1]+(0.0494323092557)*x[2]**o+(-0.796200422375)*x[2]
        arg[0,1,1,1]=(-0.109937058453)*x[0]**o+(0.607637390544)*x[0]+(0.464147925564)*x[1]**o+(0.650325883743)*x[1]+(0.698196425121)*x[2]**o+(0.933002044297)*x[2]
        arg[0,1,2,0]=(-0.13801307581)*x[0]**o+(0.75768744715)*x[0]+(-0.35990643116)*x[1]**o+(-0.787975707318)*x[1]+(-0.259281382264)*x[2]**o+(0.971003238549)*x[2]
        arg[0,1,2,1]=(-0.518540484981)*x[0]**o+(0.197912267942)*x[0]+(0.481058074022)*x[1]**o+(0.918189335061)*x[1]+(0.160239271801)*x[2]**o+(0.75950986792)*x[2]
        arg[0,2,0,0]=(0.286922773164)*x[0]**o+(-0.874592150595)*x[0]+(0.416014232771)*x[1]**o+(-0.492379239759)*x[1]+(0.950640982197)*x[2]**o+(-0.10625158241)*x[2]
        arg[0,2,0,1]=(-0.116447648923)*x[0]**o+(-0.499481854319)*x[0]+(-0.556602044084)*x[1]**o+(0.753256358343)*x[1]+(0.280780022694)*x[2]**o+(-0.879728755507)*x[2]
        arg[0,2,1,0]=(-0.322803067618)*x[0]**o+(0.0974878233964)*x[0]+(0.420547949274)*x[1]**o+(0.304839957099)*x[1]+(-0.12605355567)*x[2]**o+(-0.166970509739)*x[2]
        arg[0,2,1,1]=(0.997823909059)*x[0]**o+(0.76749010767)*x[0]+(0.376351544673)*x[1]**o+(-0.316937252621)*x[1]+(-0.627670639733)*x[2]**o+(0.584121037987)*x[2]
        arg[0,2,2,0]=(0.516866019209)*x[0]**o+(0.413564799736)*x[0]+(-0.0730736747833)*x[1]**o+(-0.500984764568)*x[1]+(-0.989323894645)*x[2]**o+(-0.261458643035)*x[2]
        arg[0,2,2,1]=(0.777538237337)*x[0]**o+(-0.0623276952959)*x[0]+(0.167068351133)*x[1]**o+(-0.345550070545)*x[1]+(-0.28166577069)*x[2]**o+(-0.568650037569)*x[2]
        arg[0,3,0,0]=(-0.622067362782)*x[0]**o+(0.971384323624)*x[0]+(-0.099597286042)*x[1]**o+(-0.265680407306)*x[1]+(-0.446275631545)*x[2]**o+(-0.0637591060995)*x[2]
        arg[0,3,0,1]=(-0.49698112241)*x[0]**o+(0.766181263321)*x[0]+(-0.977014162391)*x[1]**o+(0.806444170647)*x[1]+(-0.441023882645)*x[2]**o+(-0.919279365683)*x[2]
        arg[0,3,1,0]=(0.917091542097)*x[0]**o+(-0.67016353228)*x[0]+(0.0468346020734)*x[1]**o+(0.81092419675)*x[1]+(0.174037096652)*x[2]**o+(0.564190407348)*x[2]
        arg[0,3,1,1]=(-0.437188100982)*x[0]**o+(-0.0857174204982)*x[0]+(-0.971592105442)*x[1]**o+(-0.122352019844)*x[1]+(-0.853225566811)*x[2]**o+(-0.861128476903)*x[2]
        arg[0,3,2,0]=(-0.841265485658)*x[0]**o+(0.553186811235)*x[0]+(0.414489259007)*x[1]**o+(-0.800997281522)*x[1]+(0.630269543743)*x[2]**o+(0.263584335528)*x[2]
        arg[0,3,2,1]=(0.383282548921)*x[0]**o+(0.260041562865)*x[0]+(-0.95180999378)*x[1]**o+(0.566954668715)*x[1]+(0.688843907846)*x[2]**o+(-0.166837115553)*x[2]
        arg[0,4,0,0]=(0.0385891845805)*x[0]**o+(0.324932244772)*x[0]+(-0.946997425504)*x[1]**o+(-0.745439090316)*x[1]+(-0.721657519976)*x[2]**o+(-0.714366519961)*x[2]
        arg[0,4,0,1]=(-0.387739686761)*x[0]**o+(-0.860915144676)*x[0]+(0.270056169204)*x[1]**o+(-0.914861208322)*x[1]+(-0.453514265988)*x[2]**o+(-0.495768314604)*x[2]
        arg[0,4,1,0]=(-0.329464483421)*x[0]**o+(0.313424566493)*x[0]+(0.185677682455)*x[1]**o+(-0.720200750426)*x[1]+(0.425742092834)*x[2]**o+(0.505209526425)*x[2]
        arg[0,4,1,1]=(0.63272559561)*x[0]**o+(-0.026429919604)*x[0]+(-0.14023723263)*x[1]**o+(-0.580805084228)*x[1]+(0.141232832837)*x[2]**o+(0.241327430534)*x[2]
        arg[0,4,2,0]=(-0.847582850604)*x[0]**o+(0.207270297356)*x[0]+(0.851958035148)*x[1]**o+(0.336594484304)*x[1]+(-0.221434386211)*x[2]**o+(-0.607602400875)*x[2]
        arg[0,4,2,1]=(-0.722990535113)*x[0]**o+(-0.379964881881)*x[0]+(0.825779173038)*x[1]**o+(-0.285509543358)*x[1]+(-0.518809494335)*x[2]**o+(-0.788507606636)*x[2]
        arg[1,0,0,0]=(0.0725951752952)*x[0]**o+(-0.282800153416)*x[0]+(-0.0228303688498)*x[1]**o+(-0.863127549259)*x[1]+(-0.383553228278)*x[2]**o+(-0.0151737809185)*x[2]
        arg[1,0,0,1]=(-0.254920010173)*x[0]**o+(0.160195189848)*x[0]+(0.216407190109)*x[1]**o+(-0.814599655672)*x[1]+(0.771746025302)*x[2]**o+(0.0636221760766)*x[2]
        arg[1,0,1,0]=(0.486342223622)*x[0]**o+(0.736242651359)*x[0]+(0.720722697611)*x[1]**o+(0.974853194395)*x[1]+(-0.834707965096)*x[2]**o+(-0.947169299038)*x[2]
        arg[1,0,1,1]=(0.777015150638)*x[0]**o+(-0.228082772046)*x[0]+(-0.51095285588)*x[1]**o+(-0.835057692508)*x[1]+(-0.564012944223)*x[2]**o+(-0.898040787549)*x[2]
        arg[1,0,2,0]=(0.240813275278)*x[0]**o+(-0.509566588932)*x[0]+(0.247803237451)*x[1]**o+(0.156442781059)*x[1]+(0.618367580757)*x[2]**o+(0.943435734207)*x[2]
        arg[1,0,2,1]=(-0.670257601629)*x[0]**o+(-0.470716006203)*x[0]+(-0.559207336128)*x[1]**o+(-0.81577896974)*x[1]+(0.0571093198914)*x[2]**o+(0.477103420898)*x[2]
        arg[1,1,0,0]=(0.985895581872)*x[0]**o+(-0.00359465828149)*x[0]+(0.00739312124399)*x[1]**o+(-0.931299968425)*x[1]+(-0.10047347666)*x[2]**o+(0.410589913002)*x[2]
        arg[1,1,0,1]=(-0.954132399275)*x[0]**o+(0.159222338169)*x[0]+(-0.865370419503)*x[1]**o+(-0.744696059283)*x[1]+(-0.794993976252)*x[2]**o+(0.961664562839)*x[2]
        arg[1,1,1,0]=(0.462810965625)*x[0]**o+(0.927378551017)*x[0]+(-0.105005418179)*x[1]**o+(0.282340667975)*x[1]+(-0.443931241323)*x[2]**o+(0.740071617715)*x[2]
        arg[1,1,1,1]=(0.645629353541)*x[0]**o+(0.848804271896)*x[0]+(-0.882497356826)*x[1]**o+(-0.74661619875)*x[1]+(-0.927133238344)*x[2]**o+(-0.502758459229)*x[2]
        arg[1,1,2,0]=(-0.554993653726)*x[0]**o+(-0.473286752336)*x[0]+(0.759624773306)*x[1]**o+(0.809169103932)*x[1]+(0.657766085675)*x[2]**o+(0.763913478843)*x[2]
        arg[1,1,2,1]=(0.1476587556)*x[0]**o+(0.385711162597)*x[0]+(-0.0767252754622)*x[1]**o+(-0.544968629318)*x[1]+(0.16751959089)*x[2]**o+(-0.742697412247)*x[2]
        arg[1,2,0,0]=(-0.715887407694)*x[0]**o+(0.273818352078)*x[0]+(0.0426629688432)*x[1]**o+(-0.808531265186)*x[1]+(-0.699839650334)*x[2]**o+(-0.332093073009)*x[2]
        arg[1,2,0,1]=(0.48440337855)*x[0]**o+(0.765443731546)*x[0]+(-0.0761968055499)*x[1]**o+(0.0516389293584)*x[1]+(-0.486224925751)*x[2]**o+(-0.796105709176)*x[2]
        arg[1,2,1,0]=(0.621562227153)*x[0]**o+(0.907213416636)*x[0]+(0.591392192921)*x[1]**o+(-0.825911160831)*x[1]+(0.690773959314)*x[2]**o+(-0.744144678185)*x[2]
        arg[1,2,1,1]=(0.472846565983)*x[0]**o+(-0.837395663533)*x[0]+(0.526438435448)*x[1]**o+(0.310053110281)*x[1]+(0.634301291566)*x[2]**o+(0.608270679412)*x[2]
        arg[1,2,2,0]=(-0.212000572333)*x[0]**o+(0.644218219058)*x[0]+(0.827779140409)*x[1]**o+(0.563968121281)*x[1]+(-0.0556319977635)*x[2]**o+(0.98126338415)*x[2]
        arg[1,2,2,1]=(-0.632752637148)*x[0]**o+(-0.999490611532)*x[0]+(0.0717950178432)*x[1]**o+(-0.0611949850049)*x[1]+(0.740177288895)*x[2]**o+(0.241010363236)*x[2]
        arg[1,3,0,0]=(0.390081216336)*x[0]**o+(-0.389460065845)*x[0]+(0.0812808695521)*x[1]**o+(0.0843698990866)*x[1]+(0.672844227186)*x[2]**o+(0.306345015188)*x[2]
        arg[1,3,0,1]=(-0.402887151891)*x[0]**o+(-0.908615473265)*x[0]+(-0.296307155209)*x[1]**o+(0.228858413043)*x[1]+(0.509401868055)*x[2]**o+(-0.793787805038)*x[2]
        arg[1,3,1,0]=(0.253947492129)*x[0]**o+(0.401465417831)*x[0]+(-0.942329176703)*x[1]**o+(-0.518371272083)*x[1]+(0.90142806242)*x[2]**o+(0.694084281869)*x[2]
        arg[1,3,1,1]=(-0.435656267291)*x[0]**o+(-0.743058541536)*x[0]+(-0.22434079396)*x[1]**o+(-0.414125965702)*x[1]+(0.743546448275)*x[2]**o+(0.323188772386)*x[2]
        arg[1,3,2,0]=(-0.069319863146)*x[0]**o+(-0.0749969565014)*x[0]+(0.29700943253)*x[1]**o+(0.972639470201)*x[1]+(-0.270592469279)*x[2]**o+(-0.355098058901)*x[2]
        arg[1,3,2,1]=(0.741825647399)*x[0]**o+(0.542055833087)*x[0]+(-0.0684409109262)*x[1]**o+(0.842094761143)*x[1]+(-0.777320219447)*x[2]**o+(0.758570478904)*x[2]
        arg[1,4,0,0]=(-0.66003338591)*x[0]**o+(-0.393755284573)*x[0]+(0.617154869065)*x[1]**o+(-0.480999198967)*x[1]+(0.350625972066)*x[2]**o+(0.733472524967)*x[2]
        arg[1,4,0,1]=(-0.0001759210396)*x[0]**o+(-0.0900574950432)*x[0]+(-0.592936627579)*x[1]**o+(-0.647214933825)*x[1]+(-0.43249743908)*x[2]**o+(-0.901387692551)*x[2]
        arg[1,4,1,0]=(0.052435899043)*x[0]**o+(0.163326392489)*x[0]+(0.433169876656)*x[1]**o+(0.977133611649)*x[1]+(-0.311959404527)*x[2]**o+(0.297218570651)*x[2]
        arg[1,4,1,1]=(0.00806522196579)*x[0]**o+(-0.121807466189)*x[0]+(-0.176557734776)*x[1]**o+(0.865146379005)*x[1]+(-0.304648040177)*x[2]**o+(0.269150163824)*x[2]
        arg[1,4,2,0]=(0.440212388104)*x[0]**o+(-0.590292628428)*x[0]+(-0.595359323633)*x[1]**o+(0.606734888384)*x[1]+(-0.951693103773)*x[2]**o+(-0.539741612207)*x[2]
        arg[1,4,2,1]=(0.346121727918)*x[0]**o+(0.188961570963)*x[0]+(0.402818736255)*x[1]**o+(-0.474029523974)*x[1]+(-0.95972237672)*x[2]**o+(0.983543070357)*x[2]
        arg[2,0,0,0]=(-0.801941188348)*x[0]**o+(-0.318215868754)*x[0]+(0.322031073259)*x[1]**o+(-0.00368402006147)*x[1]+(0.473846239338)*x[2]**o+(0.512752561753)*x[2]
        arg[2,0,0,1]=(0.786459471841)*x[0]**o+(0.941049841845)*x[0]+(0.064717660139)*x[1]**o+(-0.891518891268)*x[1]+(-0.317681565962)*x[2]**o+(-0.672310725168)*x[2]
        arg[2,0,1,0]=(0.813571093948)*x[0]**o+(-0.146551267883)*x[0]+(0.942106359835)*x[1]**o+(0.165543949281)*x[1]+(-0.0301736488709)*x[2]**o+(0.936915469225)*x[2]
        arg[2,0,1,1]=(-0.0298664722355)*x[0]**o+(-0.596644819792)*x[0]+(-0.306728572634)*x[1]**o+(0.770671782936)*x[1]+(-0.334606536003)*x[2]**o+(0.888940190159)*x[2]
        arg[2,0,2,0]=(0.688553055025)*x[0]**o+(-0.241541868482)*x[0]+(-0.694609526571)*x[1]**o+(-0.509896457784)*x[1]+(-0.0610272843414)*x[2]**o+(-0.251290389152)*x[2]
        arg[2,0,2,1]=(-0.959007707329)*x[0]**o+(-0.193856482901)*x[0]+(-0.138697126551)*x[1]**o+(0.768166305153)*x[1]+(0.951006645306)*x[2]**o+(-0.533986863953)*x[2]
        arg[2,1,0,0]=(0.648021743651)*x[0]**o+(-0.839074631201)*x[0]+(-0.445337118707)*x[1]**o+(0.997475278653)*x[1]+(-0.154475323496)*x[2]**o+(-0.45292992537)*x[2]
        arg[2,1,0,1]=(-0.134785884326)*x[0]**o+(-0.906738442209)*x[0]+(0.00509900741927)*x[1]**o+(0.489865232888)*x[1]+(0.620823018353)*x[2]**o+(-0.480127263607)*x[2]
        arg[2,1,1,0]=(-0.210371458935)*x[0]**o+(0.308453655681)*x[0]+(-0.510473100104)*x[1]**o+(-0.0776488834445)*x[1]+(0.58103002434)*x[2]**o+(0.039267622777)*x[2]
        arg[2,1,1,1]=(-0.124204683462)*x[0]**o+(0.429525935007)*x[0]+(0.183174600008)*x[1]**o+(-0.665914708196)*x[1]+(-0.576713549033)*x[2]**o+(-0.3788567811)*x[2]
        arg[2,1,2,0]=(-0.864065825608)*x[0]**o+(0.644046059464)*x[0]+(-0.265959280151)*x[1]**o+(0.989465634246)*x[1]+(0.536466956842)*x[2]**o+(0.689999246325)*x[2]
        arg[2,1,2,1]=(0.37622234855)*x[0]**o+(-0.905554688955)*x[0]+(-0.0258037833143)*x[1]**o+(-0.23415538846)*x[1]+(-0.64461795706)*x[2]**o+(0.262259040646)*x[2]
        arg[2,2,0,0]=(0.0541619627989)*x[0]**o+(-0.978918782799)*x[0]+(0.478333900479)*x[1]**o+(0.958652455667)*x[1]+(-0.746701804693)*x[2]**o+(-0.557405653804)*x[2]
        arg[2,2,0,1]=(0.611472347101)*x[0]**o+(-0.409754132769)*x[0]+(0.291274496706)*x[1]**o+(0.901983238042)*x[1]+(-0.102917678824)*x[2]**o+(-0.668205224505)*x[2]
        arg[2,2,1,0]=(-0.926062469523)*x[0]**o+(0.101032437783)*x[0]+(-0.385485330853)*x[1]**o+(0.0521756546126)*x[1]+(0.132320977758)*x[2]**o+(0.471619572767)*x[2]
        arg[2,2,1,1]=(0.0689111652346)*x[0]**o+(-0.517070173331)*x[0]+(-0.599184868344)*x[1]**o+(-0.814239996638)*x[1]+(0.97403158037)*x[2]**o+(-0.546843890524)*x[2]
        arg[2,2,2,0]=(-0.133251706696)*x[0]**o+(-0.0954736405212)*x[0]+(0.780584398494)*x[1]**o+(-0.505305860913)*x[1]+(-0.11518705364)*x[2]**o+(0.0855698333433)*x[2]
        arg[2,2,2,1]=(-0.567309977436)*x[0]**o+(-0.284182307402)*x[0]+(0.220302202269)*x[1]**o+(-0.252628588826)*x[1]+(-0.368390646272)*x[2]**o+(-0.577499260947)*x[2]
        arg[2,3,0,0]=(0.477968626266)*x[0]**o+(0.522764690241)*x[0]+(-0.0339165683557)*x[1]**o+(0.623897338329)*x[1]+(-0.169558925831)*x[2]**o+(-0.426663511213)*x[2]
        arg[2,3,0,1]=(0.185482762361)*x[0]**o+(0.496017413966)*x[0]+(-0.217189284009)*x[1]**o+(0.488205372581)*x[1]+(0.445762454794)*x[2]**o+(-0.423587587222)*x[2]
        arg[2,3,1,0]=(-0.489549524298)*x[0]**o+(-0.482299084307)*x[0]+(0.567729727254)*x[1]**o+(-0.341933025591)*x[1]+(-0.325429025641)*x[2]**o+(0.476030984261)*x[2]
        arg[2,3,1,1]=(-0.390754226646)*x[0]**o+(-0.980255652462)*x[0]+(0.109328516217)*x[1]**o+(-0.0141509875662)*x[1]+(0.486458644215)*x[2]**o+(-0.668018419371)*x[2]
        arg[2,3,2,0]=(0.352912006363)*x[0]**o+(-0.542969561227)*x[0]+(0.512067200296)*x[1]**o+(0.661110389562)*x[1]+(0.289744832231)*x[2]**o+(-0.176943484459)*x[2]
        arg[2,3,2,1]=(0.535262244127)*x[0]**o+(0.528325019892)*x[0]+(-0.106312276613)*x[1]**o+(-0.484575045858)*x[1]+(-0.407717587021)*x[2]**o+(-0.786366604025)*x[2]
        arg[2,4,0,0]=(-0.511771630262)*x[0]**o+(-0.590485876141)*x[0]+(0.493685168985)*x[1]**o+(-0.726700517739)*x[1]+(-0.213137223607)*x[2]**o+(-0.566923814015)*x[2]
        arg[2,4,0,1]=(0.421559088561)*x[0]**o+(0.838784944841)*x[0]+(-0.693654869402)*x[1]**o+(-0.0755493272975)*x[1]+(-0.174245799979)*x[2]**o+(0.242245946157)*x[2]
        arg[2,4,1,0]=(0.681235817735)*x[0]**o+(-0.313564199551)*x[0]+(0.663598935418)*x[1]**o+(-0.604327253895)*x[1]+(0.698985821444)*x[2]**o+(0.298899431146)*x[2]
        arg[2,4,1,1]=(0.432866305507)*x[0]**o+(-0.891501121013)*x[0]+(-0.290106178906)*x[1]**o+(0.268152357012)*x[1]+(0.75279498948)*x[2]**o+(0.211312203371)*x[2]
        arg[2,4,2,0]=(-0.956901622446)*x[0]**o+(0.742548241435)*x[0]+(-0.956209816095)*x[1]**o+(-0.539017080821)*x[1]+(-0.08062797007)*x[2]**o+(0.383843198102)*x[2]
        arg[2,4,2,1]=(-0.16700370288)*x[0]**o+(0.388837619298)*x[0]+(-0.190586726252)*x[1]**o+(0.916004535916)*x[1]+(0.310254387059)*x[2]**o+(-0.380371301717)*x[2]
        arg[3,0,0,0]=(0.64046380712)*x[0]**o+(0.254058760972)*x[0]+(-0.829050222873)*x[1]**o+(0.289942284927)*x[1]+(0.196268101069)*x[2]**o+(0.748880970446)*x[2]
        arg[3,0,0,1]=(-0.226057776579)*x[0]**o+(0.982685008224)*x[0]+(0.819680514589)*x[1]**o+(0.48005222662)*x[1]+(-0.615248069776)*x[2]**o+(-0.0923489923012)*x[2]
        arg[3,0,1,0]=(-0.358031084019)*x[0]**o+(-0.83941518843)*x[0]+(-0.0687218422525)*x[1]**o+(-0.648976147029)*x[1]+(0.711009285701)*x[2]**o+(0.360758898243)*x[2]
        arg[3,0,1,1]=(-0.312175299678)*x[0]**o+(0.360877864123)*x[0]+(0.653283960509)*x[1]**o+(0.323527948404)*x[1]+(-0.278454805659)*x[2]**o+(0.0585194127844)*x[2]
        arg[3,0,2,0]=(0.367207247645)*x[0]**o+(-0.0743547693027)*x[0]+(-0.473358544608)*x[1]**o+(0.332985041128)*x[1]+(-0.899612971909)*x[2]**o+(0.69409768473)*x[2]
        arg[3,0,2,1]=(-0.806787228991)*x[0]**o+(-0.110344204889)*x[0]+(-0.631610779885)*x[1]**o+(0.0239853435419)*x[1]+(0.83036063388)*x[2]**o+(0.623825256849)*x[2]
        arg[3,1,0,0]=(-0.268344201624)*x[0]**o+(-0.59230799177)*x[0]+(0.493719194706)*x[1]**o+(-0.128351291806)*x[1]+(0.0584636422077)*x[2]**o+(0.0859725996454)*x[2]
        arg[3,1,0,1]=(-0.870410307785)*x[0]**o+(-0.917370176071)*x[0]+(0.395701966434)*x[1]**o+(0.694856510628)*x[1]+(-0.748440730513)*x[2]**o+(0.748465450614)*x[2]
        arg[3,1,1,0]=(-0.178465888488)*x[0]**o+(-0.956884701156)*x[0]+(0.0472790389286)*x[1]**o+(0.946702274722)*x[1]+(-0.200668750878)*x[2]**o+(-0.0104023894447)*x[2]
        arg[3,1,1,1]=(0.113559334778)*x[0]**o+(0.270505514561)*x[0]+(-0.238008799138)*x[1]**o+(0.533067625871)*x[1]+(-0.586814102301)*x[2]**o+(0.045657074859)*x[2]
        arg[3,1,2,0]=(-0.574716699633)*x[0]**o+(-0.659499274639)*x[0]+(0.892605757655)*x[1]**o+(-0.39697940457)*x[1]+(0.363011145793)*x[2]**o+(-0.364722526091)*x[2]
        arg[3,1,2,1]=(-0.0193167048813)*x[0]**o+(0.761104649925)*x[0]+(0.490164183635)*x[1]**o+(0.10693267057)*x[1]+(0.635328989408)*x[2]**o+(-0.353114187925)*x[2]
        arg[3,2,0,0]=(0.0777423524941)*x[0]**o+(-0.431011355257)*x[0]+(-0.356762042134)*x[1]**o+(-0.94361679144)*x[1]+(-0.716191700456)*x[2]**o+(0.49906825221)*x[2]
        arg[3,2,0,1]=(0.80859948321)*x[0]**o+(0.542680788872)*x[0]+(-0.626897369633)*x[1]**o+(-0.821877255135)*x[1]+(-0.455575534023)*x[2]**o+(0.317480554025)*x[2]
        arg[3,2,1,0]=(-0.0144328272818)*x[0]**o+(-0.395367848628)*x[0]+(-0.601042089925)*x[1]**o+(-0.0822921879892)*x[1]+(0.896199761801)*x[2]**o+(-0.215055215166)*x[2]
        arg[3,2,1,1]=(0.377945289524)*x[0]**o+(-0.580064012583)*x[0]+(0.993926713349)*x[1]**o+(-0.736307101943)*x[1]+(-0.939628422411)*x[2]**o+(-0.923219473393)*x[2]
        arg[3,2,2,0]=(-0.733150287394)*x[0]**o+(0.692501827859)*x[0]+(0.904655347343)*x[1]**o+(0.310386512564)*x[1]+(-0.93795078156)*x[2]**o+(0.772534565721)*x[2]
        arg[3,2,2,1]=(-0.155229801255)*x[0]**o+(0.580356480314)*x[0]+(0.0673352927499)*x[1]**o+(-0.274975805243)*x[1]+(0.553818209037)*x[2]**o+(-0.835142674988)*x[2]
        arg[3,3,0,0]=(0.60752130978)*x[0]**o+(0.847750395856)*x[0]+(0.8635279539)*x[1]**o+(0.16341072973)*x[1]+(0.470011948821)*x[2]**o+(0.41529971393)*x[2]
        arg[3,3,0,1]=(0.755049219363)*x[0]**o+(0.66080573214)*x[0]+(-0.0256982576552)*x[1]**o+(-0.0311937109251)*x[1]+(-0.028843413794)*x[2]**o+(-0.19345503082)*x[2]
        arg[3,3,1,0]=(-0.39765237082)*x[0]**o+(-0.746359385218)*x[0]+(0.275396324626)*x[1]**o+(0.064571659107)*x[1]+(0.771289010752)*x[2]**o+(-6.69891594269e-05)*x[2]
        arg[3,3,1,1]=(0.350497253938)*x[0]**o+(-0.236419516561)*x[0]+(0.673483791847)*x[1]**o+(-0.934644138115)*x[1]+(0.994408125332)*x[2]**o+(-0.398423596854)*x[2]
        arg[3,3,2,0]=(-0.952544750261)*x[0]**o+(0.24256752245)*x[0]+(0.376782843601)*x[1]**o+(-0.349840168156)*x[1]+(-0.260325141903)*x[2]**o+(-0.452866344447)*x[2]
        arg[3,3,2,1]=(-0.0232941915849)*x[0]**o+(0.191625715695)*x[0]+(-0.490187753329)*x[1]**o+(-0.823976612466)*x[1]+(0.476804203752)*x[2]**o+(0.61057521184)*x[2]
        arg[3,4,0,0]=(0.0279130167137)*x[0]**o+(-0.134953133648)*x[0]+(0.0821614836141)*x[1]**o+(-0.894046763697)*x[1]+(-0.497197221983)*x[2]**o+(0.586297244251)*x[2]
        arg[3,4,0,1]=(0.0423746259802)*x[0]**o+(0.458075512165)*x[0]+(0.855157549678)*x[1]**o+(-0.607654212682)*x[1]+(-0.672693159955)*x[2]**o+(-0.300116892313)*x[2]
        arg[3,4,1,0]=(-0.695685046398)*x[0]**o+(-0.709807910289)*x[0]+(-0.167879145281)*x[1]**o+(0.524084329764)*x[1]+(0.763706690019)*x[2]**o+(-0.219502671318)*x[2]
        arg[3,4,1,1]=(0.864599640696)*x[0]**o+(-0.341125612414)*x[0]+(-0.548888211648)*x[1]**o+(0.918497762429)*x[1]+(-0.445600024463)*x[2]**o+(0.221658300325)*x[2]
        arg[3,4,2,0]=(-0.893419673448)*x[0]**o+(0.653718653341)*x[0]+(0.323868832441)*x[1]**o+(0.905933530129)*x[1]+(0.62045953406)*x[2]**o+(0.145474797235)*x[2]
        arg[3,4,2,1]=(0.480643160777)*x[0]**o+(-0.15896921521)*x[0]+(-0.329564714008)*x[1]**o+(-0.613303857496)*x[1]+(-0.483827450625)*x[2]**o+(-0.91023336048)*x[2]
        ref[0,0,0,0]=(0.520702135089)/(o+1.)+(0.109542934387)+(0.816458625566)*0.5**o
        ref[0,0,0,1]=(0.188518886272)/(o+1.)+(-0.938691737334)+(-0.709065020122)*0.5**o
        ref[0,0,1,0]=(-0.757157441618)/(o+1.)+(0.316696781197)+(-0.09165636265)*0.5**o
        ref[0,0,1,1]=(0.325937013197)/(o+1.)+(0.0450843195409)+(0.900670566988)*0.5**o
        ref[0,0,2,0]=(1.13837105734)/(o+1.)+(-0.573151939969)+(-0.883617789072)*0.5**o
        ref[0,0,2,1]=(-0.665166165764)/(o+1.)+(-0.845347549645)+(-0.770041366552)*0.5**o
        ref[0,1,0,0]=(0.714049217035)/(o+1.)+(0.4125480263)+(0.90396926296)*0.5**o
        ref[0,1,0,1]=(0.429723443697)/(o+1.)+(0.255965487666)+(0.47956310963)*0.5**o
        ref[0,1,1,0]=(-0.282787702479)/(o+1.)+(-0.631122483908)+(-0.75177304495)*0.5**o
        ref[0,1,1,1]=(1.16234435068)/(o+1.)+(1.09548265929)+(-0.109937058453)*0.5**o
        ref[0,1,2,0]=(-0.619187813423)/(o+1.)+(0.47035748919)+(-0.13801307581)*0.5**o
        ref[0,1,2,1]=(0.641297345823)/(o+1.)+(0.937805735461)+(-0.518540484981)*0.5**o
        ref[0,2,0,0]=(1.36665521497)/(o+1.)+(-0.736611486382)+(0.286922773164)*0.5**o
        ref[0,2,0,1]=(-0.27582202139)/(o+1.)+(-0.312977125741)+(-0.116447648923)*0.5**o
        ref[0,2,1,0]=(0.294494393603)/(o+1.)+(0.117678635379)+(-0.322803067618)*0.5**o
        ref[0,2,1,1]=(-0.251319095061)/(o+1.)+(0.517336946518)+(0.997823909059)*0.5**o
        ref[0,2,2,0]=(-1.06239756943)/(o+1.)+(-0.174439303934)+(0.516866019209)*0.5**o
        ref[0,2,2,1]=(-0.114597419557)/(o+1.)+(-0.488263901705)+(0.777538237337)*0.5**o
        ref[0,3,0,0]=(-0.545872917587)/(o+1.)+(0.320972405109)+(-0.622067362782)*0.5**o
        ref[0,3,0,1]=(-1.41803804504)/(o+1.)+(0.326673034142)+(-0.49698112241)*0.5**o
        ref[0,3,1,0]=(0.220871698725)/(o+1.)+(0.352475535909)+(0.917091542097)*0.5**o
        ref[0,3,1,1]=(-1.82481767225)/(o+1.)+(-0.534598958622)+(-0.437188100982)*0.5**o
        ref[0,3,2,0]=(1.04475880275)/(o+1.)+(0.00788693262039)+(-0.841265485658)*0.5**o
        ref[0,3,2,1]=(-0.262966085934)/(o+1.)+(0.330079558014)+(0.383282548921)*0.5**o
        ref[0,4,0,0]=(-1.66865494548)/(o+1.)+(-0.567436682752)+(0.0385891845805)*0.5**o
        ref[0,4,0,1]=(-0.183458096784)/(o+1.)+(-1.1357723338)+(-0.387739686761)*0.5**o
        ref[0,4,1,0]=(0.611419775289)/(o+1.)+(0.0492166712458)+(-0.329464483421)*0.5**o
        ref[0,4,1,1]=(0.000995600207189)/(o+1.)+(-0.182953786649)+(0.63272559561)*0.5**o
        ref[0,4,2,0]=(0.630523648936)/(o+1.)+(-0.0318688096074)+(-0.847582850604)*0.5**o
        ref[0,4,2,1]=(0.306969678703)/(o+1.)+(-0.726991015938)+(-0.722990535113)*0.5**o
        ref[1,0,0,0]=(-0.406383597128)/(o+1.)+(-0.580550741796)+(0.0725951752952)*0.5**o
        ref[1,0,0,1]=(0.988153215411)/(o+1.)+(-0.295391144874)+(-0.254920010173)*0.5**o
        ref[1,0,1,0]=(-0.113985267485)/(o+1.)+(0.381963273358)+(0.486342223622)*0.5**o
        ref[1,0,1,1]=(-1.0749658001)/(o+1.)+(-0.980590626052)+(0.777015150638)*0.5**o
        ref[1,0,2,0]=(0.866170818208)/(o+1.)+(0.295155963167)+(0.240813275278)*0.5**o
        ref[1,0,2,1]=(-0.502098016236)/(o+1.)+(-0.404695777523)+(-0.670257601629)*0.5**o
        ref[1,1,0,0]=(-0.0930803554155)/(o+1.)+(-0.262152356852)+(0.985895581872)*0.5**o
        ref[1,1,0,1]=(-1.66036439576)/(o+1.)+(0.188095420862)+(-0.954132399275)*0.5**o
        ref[1,1,1,0]=(-0.548936659502)/(o+1.)+(0.974895418354)+(0.462810965625)*0.5**o
        ref[1,1,1,1]=(-1.80963059517)/(o+1.)+(-0.200285193041)+(0.645629353541)*0.5**o
        ref[1,1,2,0]=(1.41739085898)/(o+1.)+(0.549897915219)+(-0.554993653726)*0.5**o
        ref[1,1,2,1]=(0.0907943154278)/(o+1.)+(-0.450977439484)+(0.1476587556)*0.5**o
        ref[1,2,0,0]=(-0.657176681491)/(o+1.)+(-0.433402993059)+(-0.715887407694)*0.5**o
        ref[1,2,0,1]=(-0.562421731301)/(o+1.)+(0.0104884758643)+(0.48440337855)*0.5**o
        ref[1,2,1,0]=(1.28216615223)/(o+1.)+(-0.33142121119)+(0.621562227153)*0.5**o
        ref[1,2,1,1]=(1.16073972701)/(o+1.)+(0.0404640630801)+(0.472846565983)*0.5**o
        ref[1,2,2,0]=(0.772147142645)/(o+1.)+(1.09472486224)+(-0.212000572333)*0.5**o
        ref[1,2,2,1]=(0.811972306738)/(o+1.)+(-0.409837616651)+(-0.632752637148)*0.5**o
        ref[1,3,0,0]=(0.754125096738)/(o+1.)+(0.000627424214716)+(0.390081216336)*0.5**o
        ref[1,3,0,1]=(0.213094712846)/(o+1.)+(-0.73677243263)+(-0.402887151891)*0.5**o
        ref[1,3,1,0]=(-0.0409011142831)/(o+1.)+(0.288589213809)+(0.253947492129)*0.5**o
        ref[1,3,1,1]=(0.519205654314)/(o+1.)+(-0.416997867426)+(-0.435656267291)*0.5**o
        ref[1,3,2,0]=(0.0264169632513)/(o+1.)+(0.271272227399)+(-0.069319863146)*0.5**o
        ref[1,3,2,1]=(-0.845761130374)/(o+1.)+(1.07136053657)+(0.741825647399)*0.5**o
        ref[1,4,0,0]=(0.967780841131)/(o+1.)+(-0.0706409792865)+(-0.66003338591)*0.5**o
        ref[1,4,0,1]=(-1.02543406666)/(o+1.)+(-0.81933006071)+(-0.0001759210396)*0.5**o
        ref[1,4,1,0]=(0.121210472128)/(o+1.)+(0.718839287394)+(0.052435899043)*0.5**o
        ref[1,4,1,1]=(-0.481205774953)/(o+1.)+(0.50624453832)+(0.00806522196579)*0.5**o
        ref[1,4,2,0]=(-1.54705242741)/(o+1.)+(-0.261649676126)+(0.440212388104)*0.5**o
        ref[1,4,2,1]=(-0.556903640465)/(o+1.)+(0.349237558673)+(0.346121727918)*0.5**o
        ref[2,0,0,0]=(0.795877312597)/(o+1.)+(0.0954263364687)+(-0.801941188348)*0.5**o
        ref[2,0,0,1]=(-0.252963905823)/(o+1.)+(-0.311389887295)+(0.786459471841)*0.5**o
        ref[2,0,1,0]=(0.911932710964)/(o+1.)+(0.477954075311)+(0.813571093948)*0.5**o
        ref[2,0,1,1]=(-0.641335108636)/(o+1.)+(0.531483576652)+(-0.0298664722355)*0.5**o
        ref[2,0,2,0]=(-0.755636810913)/(o+1.)+(-0.501364357709)+(0.688553055025)*0.5**o
        ref[2,0,2,1]=(0.812309518755)/(o+1.)+(0.0201614791497)+(-0.959007707329)*0.5**o
        ref[2,1,0,0]=(-0.599812442203)/(o+1.)+(-0.147264638959)+(0.648021743651)*0.5**o
        ref[2,1,0,1]=(0.625922025772)/(o+1.)+(-0.448500236464)+(-0.134785884326)*0.5**o
        ref[2,1,1,0]=(0.0705569242367)/(o+1.)+(0.135036197507)+(-0.210371458935)*0.5**o
        ref[2,1,1,1]=(-0.393538949024)/(o+1.)+(-0.307622777145)+(-0.124204683462)*0.5**o
        ref[2,1,2,0]=(0.270507676691)/(o+1.)+(1.16175547002)+(-0.864065825608)*0.5**o
        ref[2,1,2,1]=(-0.670421740374)/(o+1.)+(-0.438725518385)+(0.37622234855)*0.5**o
        ref[2,2,0,0]=(-0.268367904213)/(o+1.)+(-0.288835990468)+(0.0541619627989)*0.5**o
        ref[2,2,0,1]=(0.188356817882)/(o+1.)+(-0.0879880596161)+(0.611472347101)*0.5**o
        ref[2,2,1,0]=(-0.253164353095)/(o+1.)+(0.312413832582)+(-0.926062469523)*0.5**o
        ref[2,2,1,1]=(0.374846712027)/(o+1.)+(-0.939077030246)+(0.0689111652346)*0.5**o
        ref[2,2,2,0]=(0.665397344854)/(o+1.)+(-0.257604834045)+(-0.133251706696)*0.5**o
        ref[2,2,2,1]=(-0.148088444003)/(o+1.)+(-0.557155078588)+(-0.567309977436)*0.5**o
        ref[2,3,0,0]=(-0.203475494187)/(o+1.)+(0.359999258678)+(0.477968626266)*0.5**o
        ref[2,3,0,1]=(0.228573170785)/(o+1.)+(0.280317599662)+(0.185482762361)*0.5**o
        ref[2,3,1,0]=(0.242300701614)/(o+1.)+(-0.174100562819)+(-0.489549524298)*0.5**o
        ref[2,3,1,1]=(0.595787160431)/(o+1.)+(-0.8312125297)+(-0.390754226646)*0.5**o
        ref[2,3,2,0]=(0.801812032527)/(o+1.)+(-0.0294013280621)+(0.352912006363)*0.5**o
        ref[2,3,2,1]=(-0.514029863634)/(o+1.)+(-0.371308314996)+(0.535262244127)*0.5**o
        ref[2,4,0,0]=(0.280547945378)/(o+1.)+(-0.942055103948)+(-0.511771630262)*0.5**o
        ref[2,4,0,1]=(-0.867900669381)/(o+1.)+(0.50274078185)+(0.421559088561)*0.5**o
        ref[2,4,1,0]=(1.36258475686)/(o+1.)+(-0.30949601115)+(0.681235817735)*0.5**o
        ref[2,4,1,1]=(0.462688810574)/(o+1.)+(-0.206018280315)+(0.432866305507)*0.5**o
        ref[2,4,2,0]=(-1.03683778617)/(o+1.)+(0.293687179358)+(-0.956901622446)*0.5**o
        ref[2,4,2,1]=(0.119667660807)/(o+1.)+(0.462235426749)+(-0.16700370288)*0.5**o
        ref[3,0,0,0]=(-0.632782121804)/(o+1.)+(0.646441008172)+(0.64046380712)*0.5**o
        ref[3,0,0,1]=(0.204432444813)/(o+1.)+(0.685194121272)+(-0.226057776579)*0.5**o
        ref[3,0,1,0]=(0.642287443449)/(o+1.)+(-0.563816218608)+(-0.358031084019)*0.5**o
        ref[3,0,1,1]=(0.37482915485)/(o+1.)+(0.371462612656)+(-0.312175299678)*0.5**o
        ref[3,0,2,0]=(-1.37297151652)/(o+1.)+(0.476363978278)+(0.367207247645)*0.5**o
        ref[3,0,2,1]=(0.198749853995)/(o+1.)+(0.268733197751)+(-0.806787228991)*0.5**o
        ref[3,1,0,0]=(0.552182836914)/(o+1.)+(-0.317343341965)+(-0.268344201624)*0.5**o
        ref[3,1,0,1]=(-0.352738764079)/(o+1.)+(0.262975892585)+(-0.870410307785)*0.5**o
        ref[3,1,1,0]=(-0.153389711949)/(o+1.)+(-0.0102924079393)+(-0.178465888488)*0.5**o
        ref[3,1,1,1]=(-0.824822901439)/(o+1.)+(0.424615107645)+(0.113559334778)*0.5**o
        ref[3,1,2,0]=(1.25561690345)/(o+1.)+(-0.71060060265)+(-0.574716699633)*0.5**o
        ref[3,1,2,1]=(1.12549317304)/(o+1.)+(0.257461566285)+(-0.0193167048813)*0.5**o
        ref[3,2,0,0]=(-1.07295374259)/(o+1.)+(-0.437779947243)+(0.0777423524941)*0.5**o
        ref[3,2,0,1]=(-1.08247290366)/(o+1.)+(0.019142043881)+(0.80859948321)*0.5**o
        ref[3,2,1,0]=(0.295157671875)/(o+1.)+(-0.346357625892)+(-0.0144328272818)*0.5**o
        ref[3,2,1,1]=(0.054298290938)/(o+1.)+(-1.11979529396)+(0.377945289524)*0.5**o
        ref[3,2,2,0]=(-0.0332954342171)/(o+1.)+(0.887711453071)+(-0.733150287394)*0.5**o
        ref[3,2,2,1]=(0.621153501787)/(o+1.)+(-0.264880999958)+(-0.155229801255)*0.5**o
        ref[3,3,0,0]=(1.33353990272)/(o+1.)+(0.713230419758)+(0.60752130978)*0.5**o
        ref[3,3,0,1]=(-0.0545416714491)/(o+1.)+(0.218078495198)+(0.755049219363)*0.5**o
        ref[3,3,1,0]=(1.04668533538)/(o+1.)+(-0.340927357635)+(-0.39765237082)*0.5**o
        ref[3,3,1,1]=(1.66789191718)/(o+1.)+(-0.784743625765)+(0.350497253938)*0.5**o
        ref[3,3,2,0]=(0.116457701698)/(o+1.)+(-0.280069495076)+(-0.952544750261)*0.5**o
        ref[3,3,2,1]=(-0.0133835495768)/(o+1.)+(-0.0108878424651)+(-0.0232941915849)*0.5**o
        ref[3,4,0,0]=(-0.415035738369)/(o+1.)+(-0.221351326547)+(0.0279130167137)*0.5**o
        ref[3,4,0,1]=(0.182464389723)/(o+1.)+(-0.224847796415)+(0.0423746259802)*0.5**o
        ref[3,4,1,0]=(0.595827544738)/(o+1.)+(-0.202613125922)+(-0.695685046398)*0.5**o
        ref[3,4,1,1]=(-0.99448823611)/(o+1.)+(0.39951522517)+(0.864599640696)*0.5**o
        ref[3,4,2,0]=(0.944328366501)/(o+1.)+(0.852563490353)+(-0.893419673448)*0.5**o
        ref[3,4,2,1]=(-0.813392164634)/(o+1.)+(-0.841253216593)+(0.480643160777)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.241972460279)*x[0]+(0.539729925673)*x[1]
        ref=(-0.11832904353)/(o+1.)+(0.649911364492)+(-0.399791299503)*0.5**o
      else:
        arg=(0.53919797656)*x[0]+(0.379010664884)*x[1]+(0.274416064529)*x[2]
        ref=(0.307947301472)/(o+1.)+(0.120674157748)+(0.643329089005)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.84849017056)*x[0]+(-0.161962845202)*x[1]
        arg[1]=(-0.794717919135)*x[0]+(1.16003773358)*x[1]
        ref[0]=(0.780514448202)/(o+1.)+(-0.34628958021)+(0.598592037576)*0.5**o
        ref[1]=(0.570158156278)/(o+1.)+(0.241192316704)+(-0.687222975237)*0.5**o
      else:
        arg[0]=(-0.637352163634)*x[0]+(1.49477462643)*x[1]+(-0.284018740238)*x[2]
        arg[1]=(0.125937459904)*x[0]+(-0.206499869891)*x[1]+(-0.342856240345)*x[2]
        ref[0]=(-0.274486314451)/(o+1.)+(0.379737553853)+(0.0884149293071)*0.5**o
        ref[1]=(-0.78452814021)/(o+1.)+(-0.122017410137)+(0.605144310151)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(-0.440868762581)*x[0]+(-0.216223666616)*x[1]
        arg[0,1]=(-1.78807355591)*x[0]+(-0.208278123838)*x[1]
        arg[0,2]=(-0.448066998103)*x[0]+(-0.819815507826)*x[1]
        arg[0,3]=(1.27247881689)*x[0]+(0.0653439567221)*x[1]
        arg[0,4]=(-1.00344990223)*x[0]+(-0.291263790583)*x[1]
        arg[1,0]=(0.440080423838)*x[0]+(0.0356836558113)*x[1]
        arg[1,1]=(-1.49545340091)*x[0]+(-0.133615590211)*x[1]
        arg[1,2]=(1.05947638385)*x[0]+(0.408685904238)*x[1]
        arg[1,3]=(-0.170309086605)*x[0]+(0.660523970285)*x[1]
        arg[1,4]=(0.764323678475)*x[0]+(-0.529415080303)*x[1]
        arg[2,0]=(0.55270081325)*x[0]+(-1.60630146231)*x[1]
        arg[2,1]=(1.57419330248)*x[0]+(-1.24644288706)*x[1]
        arg[2,2]=(0.0416757238363)*x[0]+(0.0247379738465)*x[1]
        arg[2,3]=(1.0200370393)*x[0]+(0.364209137693)*x[1]
        arg[2,4]=(-1.21858490389)*x[0]+(0.523056254546)*x[1]
        arg[3,0]=(0.0524205820842)*x[0]+(1.65953217854)*x[1]
        arg[3,1]=(1.21824883395)*x[0]+(0.905190834998)*x[1]
        arg[3,2]=(0.226344434525)*x[0]+(-0.735349531462)*x[1]
        arg[3,3]=(-1.00295245717)*x[0]+(-0.719605376499)*x[1]
        arg[3,4]=(-0.446228759693)*x[0]+(1.23441974277)*x[1]
        ref[0,0]=(0.347328582602)/(o+1.)+(-0.520484463519)+(0.0365479152384)*0.5**o
        ref[0,1]=(-0.274564442352)/(o+1.)+(-0.413557210678)+(-0.894672816039)*0.5**o
        ref[0,2]=(0.0720644688954)/(o+1.)+(-0.906636966188)+(0.473326957552)*0.5**o
        ref[0,3]=(-0.747749341777)/(o+1.)+(0.730249972378)+(0.625072170633)*0.5**o
        ref[0,4]=(-0.194031116169)/(o+1.)+(-0.432063325829)+(-0.236555924983)*0.5**o
        ref[1,0]=(0.807081538033)/(o+1.)+(-0.612266650007)+(0.893215841629)*0.5**o
        ref[1,1]=(-0.662516518957)/(o+1.)+(-0.176318925886)+(-0.61391462039)*0.5**o
        ref[1,2]=(-0.570345636156)/(o+1.)+(0.791877954963)+(0.454752014319)*0.5**o
        ref[1,3]=(-0.312400910795)/(o+1.)+(0.212935137466)+(0.376745519544)*0.5**o
        ref[1,4]=(-0.764680414264)/(o+1.)+(0.174215486579)+(0.651158039278)*0.5**o
        ref[2,0]=(-0.837942771642)/(o+1.)+(-0.187938486702)+(0.160219095985)*0.5**o
        ref[2,1]=(-0.672421039761)/(o+1.)+(0.17384002882)+(0.652491397549)*0.5**o
        ref[2,2]=(-0.656187949922)/(o+1.)+(0.559888736121)+(-0.397175824637)*0.5**o
        ref[2,3]=(0.259558368195)/(o+1.)+(0.55148644978)+(0.0217149092406)*0.5**o
        ref[2,4]=(-0.188397537901)/(o+1.)+(-0.0561706170512)+(-0.394789877345)*0.5**o
        ref[3,0]=(0.91055628617)/(o+1.)+(0.574211274098)+(-0.347026073739)*0.5**o
        ref[3,1]=(0.29225509237)/(o+1.)+(0.64447705482)+(0.542230466941)*0.5**o
        ref[3,2]=(0.121065624384)/(o+1.)+(0.0316495277836)+(-0.693369776888)*0.5**o
        ref[3,3]=(-0.943523334976)/(o+1.)+(-0.266302644031)+(-0.246429210629)*0.5**o
        ref[3,4]=(0.714915399455)/(o+1.)+(0.459963131994)+(-0.846650680369)*0.5**o
      else:
        arg[0,0]=(-0.493869713454)*x[0]+(-0.381969413515)*x[1]+(1.59862368848)*x[2]
        arg[0,1]=(-0.581245543547)*x[0]+(0.961117271889)*x[1]+(-0.158073515343)*x[2]
        arg[0,2]=(-0.635283143641)*x[0]+(0.695573236987)*x[1]+(-0.719180832278)*x[2]
        arg[0,3]=(-0.737780596733)*x[0]+(-1.11171283352)*x[1]+(0.459954346315)*x[2]
        arg[0,4]=(1.12522065074)*x[0]+(-1.08427904854)*x[1]+(-0.715679673556)*x[2]
        arg[1,0]=(0.972468186181)*x[0]+(-0.211014530435)*x[1]+(-0.734414099002)*x[2]
        arg[1,1]=(-1.67337704748)*x[0]+(0.871096213089)*x[1]+(1.51063313223)*x[2]
        arg[1,2]=(-0.222013007834)*x[0]+(1.46474508326)*x[1]+(-0.979243908862)*x[2]
        arg[1,3]=(1.21195281087)*x[0]+(0.274082389329)*x[1]+(1.56144436465)*x[2]
        arg[1,4]=(1.35812865884)*x[0]+(1.25819798853)*x[1]+(0.895334048395)*x[2]
        arg[2,0]=(-0.167404344437)*x[0]+(0.0710591934315)*x[1]+(-0.124469683665)*x[2]
        arg[2,1]=(-0.492240632996)*x[0]+(-0.317251117382)*x[1]+(0.0195461703529)*x[2]
        arg[2,2]=(-0.277590266225)*x[0]+(-1.65859476899)*x[1]+(-0.0100216405668)*x[2]
        arg[2,3]=(-0.0701281298455)*x[0]+(0.502137254703)*x[1]+(0.701220923443)*x[2]
        arg[2,4]=(-0.72186096407)*x[0]+(-0.900487568179)*x[1]+(-0.735573922826)*x[2]
        arg[3,0]=(-0.0677324474129)*x[0]+(-0.649963209718)*x[1]+(-0.770861099726)*x[2]
        arg[3,1]=(0.563588189481)*x[0]+(0.714614932251)*x[1]+(-0.0957764632886)*x[2]
        arg[3,2]=(1.13337395062)*x[0]+(0.507556316073)*x[1]+(-0.196759085949)*x[2]
        arg[3,3]=(-1.2636883168)*x[0]+(-0.811660344076)*x[1]+(0.645462052598)*x[2]
        arg[3,4]=(-0.104175186987)*x[0]+(-0.929176038155)*x[1]+(1.07530379856)*x[2]
        ref[0,0]=(0.84538674973)/(o+1.)+(0.0569713556632)+(-0.236544899547)*0.5**o
        ref[0,1]=(-0.307689589699)/(o+1.)+(0.245040337642)+(0.0394071274131)*0.5**o
        ref[0,2]=(0.955244736357)/(o+1.)+(-0.341771136504)+(-0.930593202281)*0.5**o
        ref[0,3]=(-0.353490461722)/(o+1.)+(-0.476228433901)+(-0.083591754415)*0.5**o
        ref[0,4]=(-1.31220485482)/(o+1.)+(0.0466426656676)+(0.544181452128)*0.5**o
        ref[1,0]=(0.22773475414)/(o+1.)+(-0.488454801654)+(0.776214405914)*0.5**o
        ref[1,1]=(1.50688678707)/(o+1.)+(0.0851415404695)+(-0.96881757017)*0.5**o
        ref[1,2]=(0.313471097102)/(o+1.)+(-0.0875594518156)+(0.125135973096)*0.5**o
        ref[1,3]=(0.269521220179)/(o+1.)+(1.1192007195)+(0.539556905661)*0.5**o
        ref[1,4]=(1.91499876064)/(o+1.)+(0.509063797893)+(0.578534339343)*0.5**o
        ref[2,0]=(0.941352651562)/(o+1.)+(-0.966199402186)+(0.770231318139)*0.5**o
        ref[2,1]=(-0.141490823562)/(o+1.)+(-0.20919987022)+(-0.230055016023)*0.5**o
        ref[2,2]=(-0.916148047971)/(o+1.)+(-0.371740600192)+(-0.286577427426)*0.5**o
        ref[2,3]=(0.229516219331)/(o+1.)+(0.274790532736)+(0.354132763498)*0.5**o
        ref[2,4]=(-1.19120612619)/(o+1.)+(-0.139859859385)+(-0.88699661011)*0.5**o
        ref[3,0]=(-1.48630121465)/(o+1.)+(0.0744166251063)+(-0.151088792417)*0.5**o
        ref[3,1]=(-0.335583560513)/(o+1.)+(0.277436410841)+(0.963137397276)*0.5**o
        ref[3,2]=(-0.673942688644)/(o+1.)+(0.70077509905)+(0.716563671283)*0.5**o
        ref[3,3]=(-0.148394092795)/(o+1.)+(-0.237190239072)+(-0.807112037336)*0.5**o
        ref[3,4]=(0.529983886211)/(o+1.)+(-0.371055083588)+(0.254078854382)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(0.661725715165)*x[0]+(0.219720717581)*x[1]
        arg[0,0,1]=(-0.642240082304)*x[0]+(-0.279652756776)*x[1]
        arg[0,1,0]=(0.0204235813151)*x[0]+(-0.374873249933)*x[1]
        arg[0,1,1]=(1.4418481252)*x[0]+(0.205656834772)*x[1]
        arg[1,0,0]=(0.65992179951)*x[0]+(-1.04887875458)*x[1]
        arg[1,0,1]=(-0.195480216199)*x[0]+(-0.373905275039)*x[1]
        arg[1,1,0]=(0.781251543352)*x[0]+(0.0416248109536)*x[1]
        arg[1,1,1]=(-0.925751319189)*x[0]+(-0.113992910046)*x[1]
        arg[2,0,0]=(-0.0767414065227)*x[0]+(-0.156682840973)*x[1]
        arg[2,0,1]=(0.688457272529)*x[0]+(0.524916336046)*x[1]
        arg[2,1,0]=(0.753722830084)*x[0]+(-0.890325839466)*x[1]
        arg[2,1,1]=(0.730789290145)*x[0]+(-0.278986703716)*x[1]
        arg[3,0,0]=(-0.287376796439)*x[0]+(-0.153987233224)*x[1]
        arg[3,0,1]=(-1.15687435255)*x[0]+(0.250005890238)*x[1]
        arg[3,1,0]=(-0.845312830629)*x[0]+(0.256211962352)*x[1]
        arg[3,1,1]=(-0.574311820519)*x[0]+(-0.440297035998)*x[1]
        arg[4,0,0]=(-0.360607647308)*x[0]+(-1.29380437557)*x[1]
        arg[4,0,1]=(1.32019433485)*x[0]+(0.295255956618)*x[1]
        arg[4,1,0]=(-1.64162941972)*x[0]+(0.117482372162)*x[1]
        arg[4,1,1]=(-0.303103646619)*x[0]+(-0.88458982681)*x[1]
        arg[5,0,0]=(-0.666761879038)*x[0]+(-0.735786278877)*x[1]
        arg[5,0,1]=(0.0892896382617)*x[0]+(-0.45478872773)*x[1]
        arg[5,1,0]=(-0.50985624415)*x[0]+(-0.400022939567)*x[1]
        arg[5,1,1]=(1.39240706368)*x[0]+(0.0149740822664)*x[1]
        ref[0,0,0]=(-0.114834538488)/(o+1.)+(0.240621006484)+(0.515038958264)*0.5**o
        ref[0,0,1]=(0.588698337077)/(o+1.)+(-0.702256377233)+(-0.10607842169)*0.5**o
        ref[0,1,0]=(0.13849818224)/(o+1.)+(-0.277555277991)+(0.0621627051247)*0.5**o
        ref[0,1,1]=(-0.0878009521163)/(o+1.)+(0.630168348947)+(0.474969214192)*0.5**o
        ref[1,0,0]=(-0.696600538111)/(o+1.)+(-0.343318260912)+(0.994280104861)*0.5**o
        ref[1,0,1]=(-0.0887026688527)/(o+1.)+(-0.385753227979)+(0.290823633572)*0.5**o
        ref[1,1,0]=(0.831408608956)/(o+1.)+(-0.242985671853)+(0.477439089057)*0.5**o
        ref[1,1,1]=(-0.621059053191)/(o+1.)+(-0.0700203481241)+(-0.278644479797)*0.5**o
        ref[2,0,0]=(0.7890720399)/(o+1.)+(-0.539721196393)+(0.0569461053905)*0.5**o
        ref[2,0,1]=(-0.228628151401)/(o+1.)+(0.826946074171)+(-0.211890388366)*0.5**o
        ref[2,1,0]=(-0.837617325493)/(o+1.)+(0.289656653751)+(0.121701008608)*0.5**o
        ref[2,1,1]=(0.246577988625)/(o+1.)+(0.0512227634376)+(0.102779070928)*0.5**o
        ref[3,0,0]=(-0.0109584684212)/(o+1.)+(-0.334888666171)+(0.239371771102)*0.5**o
        ref[3,0,1]=(-0.125987676419)/(o+1.)+(-0.170179004032)+(-0.440522777827)*0.5**o
        ref[3,1,0]=(-0.354093141636)/(o+1.)+(-0.177294275919)+(0.119580825198)*0.5**o
        ref[3,1,1]=(-0.746761075412)/(o+1.)+(0.192068760731)+(-0.651985302566)*0.5**o
        ref[4,0,0]=(-0.42411673219)/(o+1.)+(-0.579162944937)+(-0.0719694008158)*0.5**o
        ref[4,0,1]=(0.169881169584)/(o+1.)+(0.483614029132)+(0.478341063616)*0.5**o
        ref[4,1,0]=(0.943567836264)/(o+1.)+(-0.898782941264)+(-0.670149001297)*0.5**o
        ref[4,1,1]=(-0.703610807936)/(o+1.)+(0.225342628657)+(-0.934767922806)*0.5**o
        ref[5,0,0]=(-0.788792225213)/(o+1.)+(-0.1768857093)+(-0.259984514102)*0.5**o
        ref[5,0,1]=(-0.788708879899)/(o+1.)+(-0.202288491141)+(0.827786772711)*0.5**o
        ref[5,1,0]=(-0.823081809707)/(o+1.)+(0.274720963093)+(-0.636239300197)*0.5**o
        ref[5,1,1]=(0.498922549807)/(o+1.)+(0.0129388257746)+(0.882580944588)*0.5**o
      else:
        arg[0,0,0]=(-0.426613654844)*x[0]+(-1.01433980801)*x[1]+(0.564621874916)*x[2]
        arg[0,0,1]=(-0.438521968882)*x[0]+(1.6033775267)*x[1]+(0.691349995832)*x[2]
        arg[0,1,0]=(-0.04337513731)*x[0]+(0.142927668234)*x[1]+(0.506581723199)*x[2]
        arg[0,1,1]=(-0.120598868162)*x[0]+(-0.213666787813)*x[1]+(-1.04221679332)*x[2]
        arg[1,0,0]=(0.153696490712)*x[0]+(-0.122516529815)*x[1]+(-1.08837272712)*x[2]
        arg[1,0,1]=(0.410706464237)*x[0]+(0.720079363315)*x[1]+(-0.767790357539)*x[2]
        arg[1,1,0]=(-1.03726428173)*x[0]+(-0.316809853003)*x[1]+(-0.780405868082)*x[2]
        arg[1,1,1]=(-0.427547967216)*x[0]+(-0.897766643609)*x[1]+(-1.56913552404)*x[2]
        arg[2,0,0]=(-0.282789248898)*x[0]+(-0.110846936031)*x[1]+(-1.4329391906)*x[2]
        arg[2,0,1]=(1.46866588617)*x[0]+(-1.23022501959)*x[1]+(-0.3123390018)*x[2]
        arg[2,1,0]=(-0.314115718621)*x[0]+(1.7333934438)*x[1]+(0.833572700726)*x[2]
        arg[2,1,1]=(0.464246462638)*x[0]+(0.267484068646)*x[1]+(0.342009204787)*x[2]
        arg[3,0,0]=(0.578853099163)*x[0]+(-0.0453855508465)*x[1]+(-0.0751578475516)*x[2]
        arg[3,0,1]=(-0.526734485752)*x[0]+(-1.03286310016)*x[1]+(-0.398986583917)*x[2]
        arg[3,1,0]=(0.0239088277798)*x[0]+(0.205105470192)*x[1]+(-1.04986349166)*x[2]
        arg[3,1,1]=(0.130893744001)*x[0]+(-0.273702140669)*x[1]+(-0.0804222415128)*x[2]
        arg[4,0,0]=(-0.822661618584)*x[0]+(-0.267189204519)*x[1]+(-0.290013766971)*x[2]
        arg[4,0,1]=(-1.46759823734)*x[0]+(0.317465945316)*x[1]+(0.108284317752)*x[2]
        arg[4,1,0]=(-1.3920990386)*x[0]+(-1.17823778694)*x[1]+(-0.18366434307)*x[2]
        arg[4,1,1]=(-0.0915496209516)*x[0]+(-0.367624609832)*x[1]+(1.30630257323)*x[2]
        arg[5,0,0]=(0.117840830455)*x[0]+(-0.667875433194)*x[1]+(-1.59716688455)*x[2]
        arg[5,0,1]=(-0.818693227605)*x[0]+(0.483842075248)*x[1]+(-0.408373205535)*x[2]
        arg[5,1,0]=(1.36906770301)*x[0]+(0.494926179999)*x[1]+(0.717041707262)*x[2]
        arg[5,1,1]=(0.819757116081)*x[0]+(0.0982458749015)*x[1]+(0.275080391599)*x[2]
        ref[0,0,0]=(0.236560699949)/(o+1.)+(-0.392784388084)+(-0.327323511722)*0.5**o
        ref[0,0,1]=(1.32491522045)/(o+1.)+(0.525146863711)+(-0.519003394222)*0.5**o
        ref[0,1,0]=(0.433749865563)/(o+1.)+(0.23007126008)+(-0.287758131599)*0.5**o
        ref[0,1,1]=(-0.0563021060686)/(o+1.)+(-0.403921160703)+(-0.512338021825)*0.5**o
        ref[1,0,0]=(-0.170496965963)/(o+1.)+(-0.914421777259)+(0.942147754258)*0.5**o
        ref[1,0,1]=(-0.372707483726)/(o+1.)+(0.636041158872)+(-0.536379364005)*0.5**o
        ref[1,1,0]=(-0.211529878364)/(o+1.)+(-0.912151985776)+(-0.0986461529033)*0.5**o
        ref[1,1,1]=(-1.32533998437)/(o+1.)+(-0.685030198386)+(-0.19904975372)*0.5**o
        ref[2,0,0]=(0.152048902469)/(o+1.)+(-0.88880590209)+(-0.201012473813)*0.5**o
        ref[2,0,1]=(-0.748900052246)/(o+1.)+(-0.0226120471998)+(0.720226011425)*0.5**o
        ref[2,1,0]=(0.77797707941)/(o+1.)+(1.01635055442)+(-0.557827762351)*0.5**o
        ref[2,1,1]=(1.08969334716)/(o+1.)+(-0.404644728844)+(0.793335846595)*0.5**o
        ref[3,0,0]=(1.56498448669)/(o+1.)+(-0.699967188685)+(0.293259591449)*0.5**o
        ref[3,0,1]=(-0.620133427128)/(o+1.)+(-0.550037413688)+(-0.238375915329)*0.5**o
        ref[3,1,0]=(-0.156380586288)/(o+1.)+(-0.0154369973565)+(-0.633594612687)*0.5**o
        ref[3,1,1]=(-0.352989559326)/(o+1.)+(-0.290547031627)+(0.710852984398)*0.5**o
        ref[4,0,0]=(-0.147579361355)/(o+1.)+(-0.615173424765)+(-0.00193837918766)*0.5**o
        ref[4,0,1]=(0.598152345277)/(o+1.)+(-0.540248606426)+(-0.559503106696)*0.5**o
        ref[4,1,0]=(-1.17182448825)/(o+1.)+(-0.590551681576)+(-0.401073317208)*0.5**o
        ref[4,1,1]=(0.837504141173)/(o+1.)+(0.0807414267186)+(-0.15185865216)*0.5**o
        ref[5,0,0]=(-0.646601115533)/(o+1.)+(-1.20895265273)+(0.9173049337)*0.5**o
        ref[5,0,1]=(1.26626110052)/(o+1.)+(-0.56471923973)+(-0.880046978955)*0.5**o
        ref[5,1,0]=(-0.069063169298)/(o+1.)+(0.883536796964)+(0.883025165644)*0.5**o
        ref[5,1,1]=(1.05999338993)/(o+1.)+(-0.392519102893)+(0.918128198439)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(0.257898226293)*x[0]+(-0.01230083314)*x[1]
        arg[0,0,0,1]=(0.0531183070647)*x[0]+(-0.170192287836)*x[1]
        arg[0,0,1,0]=(-0.364644940864)*x[0]+(1.04227651446)*x[1]
        arg[0,0,1,1]=(-0.894334108203)*x[0]+(0.151390331211)*x[1]
        arg[0,0,2,0]=(1.03825401708)*x[0]+(-0.882136097149)*x[1]
        arg[0,0,2,1]=(-1.05304910155)*x[0]+(1.06866311708)*x[1]
        arg[0,1,0,0]=(1.54742542159)*x[0]+(0.941778348482)*x[1]
        arg[0,1,0,1]=(1.1797380956)*x[0]+(-0.296417138234)*x[1]
        arg[0,1,1,0]=(-1.09196028027)*x[0]+(-0.783377624006)*x[1]
        arg[0,1,1,1]=(0.370952191443)*x[0]+(-0.0854141858991)*x[1]
        arg[0,1,2,0]=(-1.23552368139)*x[0]+(1.23848088087)*x[1]
        arg[0,1,2,1]=(0.216345350114)*x[0]+(-0.136524468427)*x[1]
        arg[0,2,0,0]=(-1.21206901263)*x[0]+(0.804219582144)*x[1]
        arg[0,2,0,1]=(0.192956526208)*x[0]+(0.588417678858)*x[1]
        arg[0,2,1,0]=(-0.940175603742)*x[0]+(0.329047260784)*x[1]
        arg[0,2,1,1]=(-0.138597387792)*x[0]+(0.398298326223)*x[1]
        arg[0,2,2,0]=(0.10089766824)*x[0]+(1.25459493298)*x[1]
        arg[0,2,2,1]=(-0.401163525883)*x[0]+(0.276542765282)*x[1]
        arg[0,3,0,0]=(0.252156795268)*x[0]+(-0.50223063539)*x[1]
        arg[0,3,0,1]=(0.466244610905)*x[0]+(-0.587025224301)*x[1]
        arg[0,3,1,0]=(-0.268082012713)*x[0]+(-1.28874675764)*x[1]
        arg[0,3,1,1]=(1.10867463519)*x[0]+(-0.165500912864)*x[1]
        arg[0,3,2,0]=(-1.94681908266)*x[0]+(0.166854108476)*x[1]
        arg[0,3,2,1]=(-0.537150417922)*x[0]+(0.0872851457131)*x[1]
        arg[0,4,0,0]=(-0.376548581807)*x[0]+(-0.245201133388)*x[1]
        arg[0,4,0,1]=(-0.135287690767)*x[0]+(0.750376238942)*x[1]
        arg[0,4,1,0]=(-0.0240491596907)*x[0]+(-1.21337088424)*x[1]
        arg[0,4,1,1]=(0.699215733397)*x[0]+(0.0596356032853)*x[1]
        arg[0,4,2,0]=(-0.521316010702)*x[0]+(-1.75309802615)*x[1]
        arg[0,4,2,1]=(0.403640172305)*x[0]+(1.41465827077)*x[1]
        arg[1,0,0,0]=(-1.01538089315)*x[0]+(-1.14785578909)*x[1]
        arg[1,0,0,1]=(1.10045201832)*x[0]+(0.630761728795)*x[1]
        arg[1,0,1,0]=(0.137673646147)*x[0]+(-0.387129090253)*x[1]
        arg[1,0,1,1]=(-1.04588287863)*x[0]+(-1.22433029859)*x[1]
        arg[1,0,2,0]=(-0.567830263535)*x[0]+(-0.405808616295)*x[1]
        arg[1,0,2,1]=(0.139326102495)*x[0]+(-1.93153384363)*x[1]
        arg[1,1,0,0]=(-0.638524762921)*x[0]+(0.506405751653)*x[1]
        arg[1,1,0,1]=(0.130775153144)*x[0]+(0.531317202208)*x[1]
        arg[1,1,1,0]=(0.557476206038)*x[0]+(0.447588676184)*x[1]
        arg[1,1,1,1]=(-0.538795916875)*x[0]+(-0.593869493531)*x[1]
        arg[1,1,2,0]=(-1.09827483942)*x[0]+(0.376431061876)*x[1]
        arg[1,1,2,1]=(-0.0074505620387)*x[0]+(-0.798645151486)*x[1]
        arg[1,2,0,0]=(0.251283911459)*x[0]+(0.194595071813)*x[1]
        arg[1,2,0,1]=(1.00482763799)*x[0]+(-1.00059863394)*x[1]
        arg[1,2,1,0]=(-0.453095434684)*x[0]+(-0.513922011418)*x[1]
        arg[1,2,1,1]=(0.558548837484)*x[0]+(0.0696328406825)*x[1]
        arg[1,2,2,0]=(-1.20625552545)*x[0]+(-0.151371710692)*x[1]
        arg[1,2,2,1]=(0.100262209656)*x[0]+(-0.314628804179)*x[1]
        arg[1,3,0,0]=(0.947063141882)*x[0]+(-0.297271200562)*x[1]
        arg[1,3,0,1]=(0.0760277251261)*x[0]+(-1.17982146387)*x[1]
        arg[1,3,1,0]=(-1.46946063969)*x[0]+(-0.615302663567)*x[1]
        arg[1,3,1,1]=(0.419747293729)*x[0]+(-0.629842531949)*x[1]
        arg[1,3,2,0]=(-1.44607954917)*x[0]+(0.520024093924)*x[1]
        arg[1,3,2,1]=(-1.01556392596)*x[0]+(-0.307173811354)*x[1]
        arg[1,4,0,0]=(-0.164339335244)*x[0]+(0.390736414982)*x[1]
        arg[1,4,0,1]=(-0.266932380288)*x[0]+(-0.731533848078)*x[1]
        arg[1,4,1,0]=(-0.903825489055)*x[0]+(-1.81564784421)*x[1]
        arg[1,4,1,1]=(-0.426008882665)*x[0]+(-1.09792948908)*x[1]
        arg[1,4,2,0]=(-1.32984927589)*x[0]+(1.58196302541)*x[1]
        arg[1,4,2,1]=(-0.0581032806145)*x[0]+(-0.323073355302)*x[1]
        arg[2,0,0,0]=(-0.744014251373)*x[0]+(-0.818253254872)*x[1]
        arg[2,0,0,1]=(0.368656965396)*x[0]+(-0.0864646380237)*x[1]
        arg[2,0,1,0]=(-0.112428845773)*x[0]+(0.109170104421)*x[1]
        arg[2,0,1,1]=(0.0682241548911)*x[0]+(-1.65999482283)*x[1]
        arg[2,0,2,0]=(0.212777058993)*x[0]+(0.127163480945)*x[1]
        arg[2,0,2,1]=(-0.256989443356)*x[0]+(0.183206687414)*x[1]
        arg[2,1,0,0]=(0.578997994373)*x[0]+(0.413087453689)*x[1]
        arg[2,1,0,1]=(0.886532090807)*x[0]+(0.330645525532)*x[1]
        arg[2,1,1,0]=(0.18224742814)*x[0]+(-0.713166591262)*x[1]
        arg[2,1,1,1]=(-0.25218296706)*x[0]+(0.736797897014)*x[1]
        arg[2,1,2,0]=(0.885270371408)*x[0]+(-1.35641397127)*x[1]
        arg[2,1,2,1]=(-0.963214290879)*x[0]+(0.348421598509)*x[1]
        arg[2,2,0,0]=(0.884120745351)*x[0]+(0.956857507884)*x[1]
        arg[2,2,0,1]=(-0.00795298517561)*x[0]+(0.51243740322)*x[1]
        arg[2,2,1,0]=(-0.563655252975)*x[0]+(-0.716305131721)*x[1]
        arg[2,2,1,1]=(0.648243491623)*x[0]+(-0.142239786485)*x[1]
        arg[2,2,2,0]=(1.50677848542)*x[0]+(-0.359722006818)*x[1]
        arg[2,2,2,1]=(-0.522592086302)*x[0]+(-0.18544927497)*x[1]
        arg[2,3,0,0]=(0.0822787762966)*x[0]+(0.196309662733)*x[1]
        arg[2,3,0,1]=(0.232573258627)*x[0]+(-0.0597976775432)*x[1]
        arg[2,3,1,0]=(1.50895737052)*x[0]+(0.546625934312)*x[1]
        arg[2,3,1,1]=(-1.64023373286)*x[0]+(0.220053261777)*x[1]
        arg[2,3,2,0]=(1.5897208842)*x[0]+(-0.0355885594992)*x[1]
        arg[2,3,2,1]=(-1.52822349982)*x[0]+(-0.0906934717656)*x[1]
        arg[2,4,0,0]=(0.496696582601)*x[0]+(-0.303888675059)*x[1]
        arg[2,4,0,1]=(-0.0819586112177)*x[0]+(-0.0449047294378)*x[1]
        arg[2,4,1,0]=(-0.678530758513)*x[0]+(-1.2173963447)*x[1]
        arg[2,4,1,1]=(-0.645450475268)*x[0]+(0.356771113426)*x[1]
        arg[2,4,2,0]=(-0.486643021867)*x[0]+(0.977763869689)*x[1]
        arg[2,4,2,1]=(-0.458991807397)*x[0]+(1.80038432923)*x[1]
        arg[3,0,0,0]=(0.270795948755)*x[0]+(-0.691512096338)*x[1]
        arg[3,0,0,1]=(-0.756717130099)*x[0]+(1.16189640534)*x[1]
        arg[3,0,1,0]=(0.967554346699)*x[0]+(-0.272119008963)*x[1]
        arg[3,0,1,1]=(1.14296491195)*x[0]+(-0.707175662379)*x[1]
        arg[3,0,2,0]=(1.15665030692)*x[0]+(0.414803389409)*x[1]
        arg[3,0,2,1]=(1.38997274955)*x[0]+(1.07065568192)*x[1]
        arg[3,1,0,0]=(-0.623998925511)*x[0]+(0.375545806421)*x[1]
        arg[3,1,0,1]=(-0.363431948398)*x[0]+(-0.183100417297)*x[1]
        arg[3,1,1,0]=(0.0435866301729)*x[0]+(-0.557137572068)*x[1]
        arg[3,1,1,1]=(-0.253225217468)*x[0]+(-0.0657932188329)*x[1]
        arg[3,1,2,0]=(0.147700921064)*x[0]+(0.681624563015)*x[1]
        arg[3,1,2,1]=(-0.075394297616)*x[0]+(0.271741245789)*x[1]
        arg[3,2,0,0]=(1.34803044812)*x[0]+(0.87991065609)*x[1]
        arg[3,2,0,1]=(0.0529487135353)*x[0]+(0.806480092352)*x[1]
        arg[3,2,1,0]=(-1.52038624166)*x[0]+(-0.992718138685)*x[1]
        arg[3,2,1,1]=(0.0859852188749)*x[0]+(1.63512596202)*x[1]
        arg[3,2,2,0]=(1.46925148575)*x[0]+(-1.60383564005)*x[1]
        arg[3,2,2,1]=(0.114463395473)*x[0]+(-1.0186377376)*x[1]
        arg[3,3,0,0]=(-1.02962502658)*x[0]+(-1.06788543146)*x[1]
        arg[3,3,0,1]=(-0.184391597652)*x[0]+(0.462603936483)*x[1]
        arg[3,3,1,0]=(0.611113335782)*x[0]+(0.282417397043)*x[1]
        arg[3,3,1,1]=(-0.193423873796)*x[0]+(-0.56108614964)*x[1]
        arg[3,3,2,0]=(-0.0290687598224)*x[0]+(-0.460221158417)*x[1]
        arg[3,3,2,1]=(0.784513522959)*x[0]+(-0.484813129206)*x[1]
        arg[3,4,0,0]=(0.423780748664)*x[0]+(-0.344020787894)*x[1]
        arg[3,4,0,1]=(1.10623024451)*x[0]+(-0.775008153301)*x[1]
        arg[3,4,1,0]=(0.554847534291)*x[0]+(-0.854749107999)*x[1]
        arg[3,4,1,1]=(-0.639595693597)*x[0]+(-0.966152813212)*x[1]
        arg[3,4,2,0]=(-0.0172621996023)*x[0]+(0.321815074269)*x[1]
        arg[3,4,2,1]=(0.39605156824)*x[0]+(-0.499138231749)*x[1]
        ref[0,0,0,0]=(0.169892838337)/(o+1.)+(-0.323261281472)+(0.722227117759)*0.5**o
        ref[0,0,0,1]=(-0.899797330597)/(o+1.)+(0.731242549464)+(-0.679761749104)*0.5**o
        ref[0,0,1,0]=(0.948969615551)/(o+1.)+(-0.173478478707)+(0.0756189154575)*0.5**o
        ref[0,0,1,1]=(-0.484419525942)/(o+1.)+(0.287761319651)+(-0.834046890353)*0.5**o
        ref[0,0,2,0]=(-0.275366085384)/(o+1.)+(-0.051636507926)+(0.534757021171)*0.5**o
        ref[0,0,2,1]=(0.338862631582)/(o+1.)+(0.076489529483)+(-0.47622767501)*0.5**o
        ref[0,1,0,0]=(0.960885993642)/(o+1.)+(0.36959166751)+(0.789134441414)*0.5**o
        ref[0,1,0,1]=(-0.101908900511)/(o+1.)+(0.343409131566)+(0.298411594744)*0.5**o
        ref[0,1,1,0]=(-0.50227382988)/(o+1.)+(-0.431549057432)+(-0.509965959533)*0.5**o
        ref[0,1,1,1]=(-0.294216689224)/(o+1.)+(0.293114907564)+(-0.00647512035965)*0.5**o
        ref[0,1,2,0]=(0.330313139948)/(o+1.)+(0.0601559902451)+(-0.447667920962)*0.5**o
        ref[0,1,2,1]=(-0.855325117375)/(o+1.)+(0.455706690618)+(0.0237326178252)*0.5**o
        ref[0,2,0,0]=(0.958948557218)/(o+1.)+(-0.307015973897)+(-0.752766039908)*0.5**o
        ref[0,2,0,1]=(0.622666086232)/(o+1.)+(0.417782845058)+(-0.676857571283)*0.5**o
        ref[0,2,1,0]=(-0.476269525636)/(o+1.)+(0.203518519787)+(-0.541895856898)*0.5**o
        ref[0,2,1,1]=(0.396862410812)/(o+1.)+(-0.318442063423)+(0.499722654464)*0.5**o
        ref[0,2,2,0]=(0.291546173382)/(o+1.)+(0.345688404218)+(0.372569619405)*0.5**o
        ref[0,2,2,1]=(-0.0863432016899)/(o+1.)+(0.296494638577)+(-0.631266836064)*0.5**o
        ref[0,3,0,0]=(0.437179077921)/(o+1.)+(-0.340515851088)+(-0.00622121586734)*0.5**o
        ref[0,3,0,1]=(-0.0670787919003)/(o+1.)+(-0.492735838895)+(0.931769856293)*0.5**o
        ref[0,3,1,0]=(-0.455620785864)/(o+1.)+(-0.866886545624)+(0.632565106759)*0.5**o
        ref[0,3,1,1]=(0.769395985412)/(o+1.)+(-0.303642587154)+(0.781062911223)*0.5**o
        ref[0,3,2,0]=(-0.338160377272)/(o+1.)+(-0.237545833658)+(-0.966712929597)*0.5**o
        ref[0,3,2,1]=(-0.796435534783)/(o+1.)+(0.544922318125)+(-0.743274373676)*0.5**o
        ref[0,4,0,0]=(0.452932120968)/(o+1.)+(-0.512874769603)+(-0.048932296957)*0.5**o
        ref[0,4,0,1]=(0.361579034112)/(o+1.)+(-0.0561290568189)+(0.365767627701)*0.5**o
        ref[0,4,1,0]=(-0.626053161593)/(o+1.)+(-0.761324946295)+(0.911283010254)*0.5**o
        ref[0,4,1,1]=(-0.0455977379835)/(o+1.)+(0.292122388548)+(0.22020429757)*0.5**o
        ref[0,4,2,0]=(-0.881052488675)/(o+1.)+(-0.210171400955)+(-0.973018746263)*0.5**o
        ref[0,4,2,1]=(0.955475719603)/(o+1.)+(0.367959093676)+(0.126904536122)*0.5**o
        ref[1,0,0,0]=(-0.314523133291)/(o+1.)+(-0.649561146707)+(-0.54959125554)*0.5**o
        ref[1,0,0,1]=(0.776726613012)/(o+1.)+(0.0747896120381)+(0.804907910029)*0.5**o
        ref[1,0,1,0]=(0.416309554773)/(o+1.)+(0.0650606132082)+(-0.795886225295)*0.5**o
        ref[1,0,1,1]=(-0.642083920221)/(o+1.)+(-0.518812997818)+(-0.590503261366)*0.5**o
        ref[1,0,2,0]=(0.209400082886)/(o+1.)+(-0.592256267485)+(0.00147357225359)*0.5**o
        ref[1,0,2,1]=(-0.969945221754)/(o+1.)+(-0.364559871358)+(-0.0931427766681)*0.5**o
        ref[1,1,0,0]=(0.941138659497)/(o+1.)+(-0.103485523138)+(-0.866286624489)*0.5**o
        ref[1,1,0,1]=(0.527395399401)/(o+1.)+(0.373358049173)+(-0.612019142395)*0.5**o
        ref[1,1,1,0]=(-0.276942103917)/(o+1.)+(0.624509599487)+(0.0329877871648)*0.5**o
        ref[1,1,1,1]=(-0.153477829221)/(o+1.)+(-0.0616268433725)+(-0.85593389444)*0.5**o
        ref[1,1,2,0]=(0.2685285297)/(o+1.)+(-0.301824551915)+(-0.386723203413)*0.5**o
        ref[1,1,2,1]=(-0.530960074652)/(o+1.)+(0.248621312801)+(-0.772378264474)*0.5**o
        ref[1,2,0,0]=(0.745071931955)/(o+1.)+(-0.149268301427)+(-0.000656345828701)*0.5**o
        ref[1,2,0,1]=(-0.581822428087)/(o+1.)+(0.2315691847)+(0.122913062738)*0.5**o
        ref[1,2,1,0]=(-0.325165099021)/(o+1.)+(-0.414758139139)+(0.187663931198)*0.5**o
        ref[1,2,1,1]=(-0.389683593964)/(o+1.)+(0.265985790556)+(0.485893691018)*0.5**o
        ref[1,2,2,0]=(0.661969003098)/(o+1.)+(-0.514584521701)+(-0.990427195841)*0.5**o
        ref[1,2,2,1]=(-0.0828384828188)/(o+1.)+(-0.482166570368)+(0.832805029032)*0.5**o
        ref[1,3,0,0]=(-0.756020671713)/(o+1.)+(0.627704058228)+(0.150404496577)*0.5**o
        ref[1,3,0,1]=(-0.93648010541)/(o+1.)+(0.11022703478)+(-0.387767702896)*0.5**o
        ref[1,3,1,0]=(-0.995823513997)/(o+1.)+(-0.242072805569)+(-0.604794178119)*0.5**o
        ref[1,3,1,1]=(-0.543071878541)/(o+1.)+(-0.160890620667)+(0.654757881656)*0.5**o
        ref[1,3,2,0]=(0.803184441579)/(o+1.)+(-0.612293875048)+(-0.504652146723)*0.5**o
        ref[1,3,2,1]=(-0.786714439322)/(o+1.)+(-0.175556007517)+(-0.18491128296)*0.5**o
        ref[1,4,0,0]=(-0.302928744298)/(o+1.)+(0.476360987754)+(-0.423396151472)*0.5**o
        ref[1,4,0,1]=(-0.410240602476)/(o+1.)+(-0.49551630458)+(0.40280698327)*0.5**o
        ref[1,4,1,0]=(-0.820677400346)/(o+1.)+(-0.573037933363)+(-0.752720066188)*0.5**o
        ref[1,4,1,1]=(-0.492748923658)/(o+1.)+(-0.600739806799)+(0.170290165507)*0.5**o
        ref[1,4,2,0]=(0.926654770824)/(o+1.)+(0.011282908181)+(-0.697106837662)*0.5**o
        ref[1,4,2,1]=(-0.958477382611)/(o+1.)+(0.618515858902)+(-0.65973097111)*0.5**o
        ref[2,0,0,0]=(-0.15636950624)/(o+1.)+(-0.520670547262)+(-0.36455690548)*0.5**o
        ref[2,0,0,1]=(-0.726424878286)/(o+1.)+(0.697757734621)+(-0.386898263585)*0.5**o
        ref[2,0,1,0]=(-0.055162393508)/(o+1.)+(0.247015646426)+(-0.442127640696)*0.5**o
        ref[2,0,1,1]=(-0.769332288875)/(o+1.)+(-0.0917175733456)+(-0.639003232373)*0.5**o
        ref[2,0,2,0]=(-0.196390038297)/(o+1.)+(0.0977907270548)+(0.340749124126)*0.5**o
        ref[2,0,2,1]=(0.841927481859)/(o+1.)+(-0.489185426146)+(0.0626606144906)*0.5**o
        ref[2,1,0,0]=(0.590018249148)/(o+1.)+(0.378476967182)+(-0.354886735451)*0.5**o
        ref[2,1,0,1]=(0.178495604742)/(o+1.)+(0.233073081069)+(0.572535849459)*0.5**o
        ref[2,1,1,0]=(-0.762671064919)/(o+1.)+(-0.108539686142)+(0.448831274081)*0.5**o
        ref[2,1,1,1]=(0.927591406535)/(o+1.)+(0.0441635703243)+(-0.53130361723)*0.5**o
        ref[2,1,2,0]=(-0.604360706259)/(o+1.)+(-0.134848102332)+(0.402913311063)*0.5**o
        ref[2,1,2,1]=(0.229727627441)/(o+1.)+(-0.323296604293)+(-0.197927111225)*0.5**o
        ref[2,2,0,0]=(0.287478356112)/(o+1.)+(0.762635506201)+(0.0282288847209)*0.5**o
        ref[2,2,0,1]=(0.243518182621)/(o+1.)+(-0.241502069199)+(0.743970373822)*0.5**o
        ref[2,2,1,0]=(-0.369049760378)/(o+1.)+(-0.21941778965)+(-0.472075045017)*0.5**o
        ref[2,2,1,1]=(-0.745343658666)/(o+1.)+(0.193375557775)+(0.864596248255)*0.5**o
        ref[2,2,2,0]=(-0.491769251494)/(o+1.)+(0.442742387618)+(0.753340954862)*0.5**o
        ref[2,2,2,1]=(0.551196377158)/(o+1.)+(-0.523535406613)+(-0.212166925203)*0.5**o
        ref[2,3,0,0]=(0.192271522168)/(o+1.)+(-0.0181953944687)+(0.122707705798)*0.5**o
        ref[2,3,0,1]=(-0.593768738594)/(o+1.)+(0.199088910545)+(0.368366498588)*0.5**o
        ref[2,3,1,0]=(0.0866211808983)/(o+1.)+(0.723512694127)+(0.521936735685)*0.5**o
        ref[2,3,1,1]=(-0.453288268254)/(o+1.)+(-0.15580970281)+(-0.655272797205)*0.5**o
        ref[2,3,2,0]=(0.614105802669)/(o+1.)+(0.0411427694898)+(0.85774098305)*0.5**o
        ref[2,3,2,1]=(0.263133533654)/(o+1.)+(-0.628776355867)+(-0.624497793507)*0.5**o
        ref[2,4,0,0]=(-0.809347914722)/(o+1.)+(0.367719412237)+(0.26671699779)*0.5**o
        ref[2,4,0,1]=(0.773124137566)/(o+1.)+(-0.442496395542)+(-0.0149946871367)*0.5**o
        ref[2,4,1,0]=(-0.927311525126)/(o+1.)+(-0.0125177466568)+(-0.943580084777)*0.5**o
        ref[2,4,1,1]=(0.306409665483)/(o+1.)+(0.128569553604)+(-0.852228134533)*0.5**o
        ref[2,4,2,0]=(0.926185522145)/(o+1.)+(0.0750538146738)+(-0.58517230367)*0.5**o
        ref[2,4,2,1]=(0.858245470922)/(o+1.)+(0.0125876600893)+(0.457971730734)*0.5**o
        ref[3,0,0,0]=(-0.74501947953)/(o+1.)+(0.343942243752)+(-0.363581155556)*0.5**o
        ref[3,0,0,1]=(0.850890737948)/(o+1.)+(0.157997002133)+(-0.761705466968)*0.5**o
        ref[3,0,1,0]=(-0.0468962248591)/(o+1.)+(0.0297980532763)+(0.682735456043)*0.5**o
        ref[3,0,1,1]=(0.0126326425456)/(o+1.)+(-0.076115296096)+(0.575387199213)*0.5**o
        ref[3,0,2,0]=(-0.410549752333)/(o+1.)+(0.85556811978)+(0.270867209104)*0.5**o
        ref[3,0,2,1]=(0.580487848545)/(o+1.)+(0.59069171729)+(0.698757148346)*0.5**o
        ref[3,1,0,0]=(0.139052775786)/(o+1.)+(-0.334747475889)+(0.281989056901)*0.5**o
        ref[3,1,0,1]=(0.591083610998)/(o+1.)+(-0.322680889668)+(-0.492254197357)*0.5**o
        ref[3,1,1,0]=(0.384713965427)/(o+1.)+(-0.522411606102)+(0.146558304882)*0.5**o
        ref[3,1,1,1]=(-0.827615582009)/(o+1.)+(-0.00295218575854)+(0.514501517225)*0.5**o
        ref[3,1,2,0]=(0.84762578765)/(o+1.)+(0.208361555685)+(-0.43502341494)*0.5**o
        ref[3,1,2,1]=(-0.554668615664)/(o+1.)+(0.825347835483)+(-0.899680107129)*0.5**o
        ref[3,2,0,0]=(0.652802712143)/(o+1.)+(0.397197582731)+(0.7807432266)*0.5**o
        ref[3,2,0,1]=(0.421495251937)/(o+1.)+(-0.119571710512)+(0.677076974975)*0.5**o
        ref[3,2,1,0]=(-0.230439630375)/(o+1.)+(-0.733165339017)+(-0.816334071941)*0.5**o
        ref[3,2,1,1]=(0.64153308098)/(o+1.)+(0.778374176432)+(-0.477170252948)*0.5**o
        ref[3,2,2,0]=(-0.987848717403)/(o+1.)+(-0.0606435888479)+(0.974551740798)*0.5**o
        ref[3,2,2,1]=(-0.318593711859)/(o+1.)+(-0.459904454409)+(0.334228278552)*0.5**o
        ref[3,3,0,0]=(-0.418115413351)/(o+1.)+(-0.348616063735)+(-0.982162917221)*0.5**o
        ref[3,3,0,1]=(-0.437684435015)/(o+1.)+(0.804145379606)+(-0.892393985366)*0.5**o
        ref[3,3,1,0]=(0.944100110135)/(o+1.)+(-0.059994562245)+(0.0694197471801)*0.5**o
        ref[3,3,1,1]=(-0.860656048613)/(o+1.)+(0.178136109535)+(-0.250126193893)*0.5**o
        ref[3,3,2,0]=(-0.363631991908)/(o+1.)+(-0.298384287282)+(0.471110648232)*0.5**o
        ref[3,3,2,1]=(-0.578021736479)/(o+1.)+(0.320913094365)+(0.235895941501)*0.5**o
        ref[3,4,0,0]=(-0.946995649946)/(o+1.)+(0.0451978887455)+(0.936359833225)*0.5**o
        ref[3,4,0,1]=(-0.636305818291)/(o+1.)+(0.258932088634)+(0.449663732234)*0.5**o
        ref[3,4,1,0]=(-0.823421937366)/(o+1.)+(0.112980674356)+(0.297559014947)*0.5**o
        ref[3,4,1,1]=(-0.441768022626)/(o+1.)+(-0.240840962617)+(-0.682298558949)*0.5**o
        ref[3,4,2,0]=(-0.258808936822)/(o+1.)+(0.510306577882)+(-0.457251344276)*0.5**o
        ref[3,4,2,1]=(-0.489365749016)/(o+1.)+(-0.296617385332)+(0.979513856171)*0.5**o
      else:
        arg[0,0,0,0]=(-0.474247989728)*x[0]+(-0.768689352235)*x[1]+(-1.08527900853)*x[2]
        arg[0,0,0,1]=(-0.237113797789)*x[0]+(0.0842735741018)*x[1]+(0.203858551029)*x[2]
        arg[0,0,1,0]=(0.24237127665)*x[0]+(0.421022955803)*x[1]+(-1.52818540927)*x[2]
        arg[0,0,1,1]=(1.34624865817)*x[0]+(-0.798943272818)*x[1]+(-0.823168386315)*x[2]
        arg[0,0,2,0]=(-0.906723771267)*x[0]+(0.328893123771)*x[1]+(-0.942770202463)*x[2]
        arg[0,0,2,1]=(1.54305197694)*x[0]+(0.813063941984)*x[1]+(0.205532727168)*x[2]
        arg[0,1,0,0]=(0.399159979872)*x[0]+(-1.52089837934)*x[1]+(-1.4064251406)*x[2]
        arg[0,1,0,1]=(-0.121139354731)*x[0]+(1.12768246422)*x[1]+(0.234299409411)*x[2]
        arg[0,1,1,0]=(-1.62513899388)*x[0]+(-0.173131700583)*x[1]+(1.24199996799)*x[2]
        arg[0,1,1,1]=(-0.371929434177)*x[0]+(-0.606278610409)*x[1]+(-0.00600790063066)*x[2]
        arg[0,1,2,0]=(-0.804531294423)*x[0]+(0.869392248002)*x[1]+(0.840417359943)*x[2]
        arg[0,1,2,1]=(0.329452946275)*x[0]+(1.1072495446)*x[1]+(-0.213517932323)*x[2]
        arg[0,2,0,0]=(1.02784887224)*x[0]+(0.435517042337)*x[1]+(1.58767206677)*x[2]
        arg[0,2,0,1]=(-0.0120997177)*x[0]+(0.430135803314)*x[1]+(-0.717473068956)*x[2]
        arg[0,2,1,0]=(0.955455517302)*x[0]+(0.712976918968)*x[1]+(-0.624804508641)*x[2]
        arg[0,2,1,1]=(-1.03293986594)*x[0]+(-0.539062834482)*x[1]+(-1.61172701428)*x[2]
        arg[0,2,2,0]=(-0.177662810138)*x[0]+(0.553352366127)*x[1]+(0.695417121111)*x[2]
        arg[0,2,2,1]=(0.318133474679)*x[0]+(-0.452528947926)*x[1]+(0.468602505091)*x[2]
        arg[0,3,0,0]=(-0.294467725916)*x[0]+(1.67314409894)*x[1]+(0.100736440007)*x[2]
        arg[0,3,0,1]=(-0.517162349887)*x[0]+(-1.57430191254)*x[1]+(1.24045877402)*x[2]
        arg[0,3,1,0]=(0.667393640368)*x[0]+(0.340993632212)*x[1]+(-1.09920535559)*x[2]
        arg[0,3,1,1]=(0.37451406727)*x[0]+(0.37350649326)*x[1]+(0.357440871322)*x[2]
        arg[0,3,2,0]=(-0.989366398194)*x[0]+(0.596179154759)*x[1]+(-0.573280308087)*x[2]
        arg[0,3,2,1]=(-0.25561190141)*x[0]+(1.42296905238)*x[1]+(-1.21032031399)*x[2]
        arg[0,4,0,0]=(-0.41394085285)*x[0]+(-0.751213929646)*x[1]+(-0.68470718293)*x[2]
        arg[0,4,0,1]=(0.702985204167)*x[0]+(-0.0375821582587)*x[1]+(0.290630803819)*x[2]
        arg[0,4,1,0]=(0.0558204653441)*x[0]+(1.61940057302)*x[1]+(-0.518863528354)*x[2]
        arg[0,4,1,1]=(1.25876303604)*x[0]+(-1.40923202908)*x[1]+(1.05202333762)*x[2]
        arg[0,4,2,0]=(0.0715295483294)*x[0]+(0.883869702529)*x[1]+(-0.463253474408)*x[2]
        arg[0,4,2,1]=(0.564563789615)*x[0]+(-0.135049742988)*x[1]+(-1.3118878567)*x[2]
        arg[1,0,0,0]=(0.707267335291)*x[0]+(-0.197244449872)*x[1]+(-0.114362773781)*x[2]
        arg[1,0,0,1]=(-0.144762815659)*x[0]+(0.434177706452)*x[1]+(0.0754859099691)*x[2]
        arg[1,0,1,0]=(-0.906934991359)*x[0]+(0.179011995627)*x[1]+(0.823936036469)*x[2]
        arg[1,0,1,1]=(1.11165724605)*x[0]+(0.48023223731)*x[1]+(0.981353808181)*x[2]
        arg[1,0,2,0]=(0.499460583481)*x[0]+(0.171586243561)*x[1]+(-0.252474775657)*x[2]
        arg[1,0,2,1]=(-0.604289370884)*x[0]+(1.11610914086)*x[1]+(0.747439062711)*x[2]
        arg[1,1,0,0]=(0.696191463882)*x[0]+(0.349547714404)*x[1]+(0.651361019042)*x[2]
        arg[1,1,0,1]=(0.152679923426)*x[0]+(-0.448442911425)*x[1]+(1.33964371501)*x[2]
        arg[1,1,1,0]=(-0.74612592015)*x[0]+(-1.27089239786)*x[1]+(-0.261725631736)*x[2]
        arg[1,1,1,1]=(1.50839493929)*x[0]+(1.93229724987)*x[1]+(-0.963996845831)*x[2]
        arg[1,1,2,0]=(0.867984447375)*x[0]+(-0.777493811854)*x[1]+(0.847847553133)*x[2]
        arg[1,1,2,1]=(1.34249389498)*x[0]+(0.776160804062)*x[1]+(-0.295393972199)*x[2]
        arg[1,2,0,0]=(-0.655771613243)*x[0]+(1.58220214455)*x[1]+(-0.406292477629)*x[2]
        arg[1,2,0,1]=(0.59294895986)*x[0]+(0.544961164723)*x[1]+(0.634279670948)*x[2]
        arg[1,2,1,0]=(1.15324179862)*x[0]+(0.645764835217)*x[1]+(0.670364725309)*x[2]
        arg[1,2,1,1]=(-0.819459106271)*x[0]+(0.024815625404)*x[1]+(0.769753650676)*x[2]
        arg[1,2,2,0]=(1.19042366161)*x[0]+(0.982020548972)*x[1]+(0.92730609738)*x[2]
        arg[1,2,2,1]=(-0.742441488349)*x[0]+(-1.3101429812)*x[1]+(-0.198104246324)*x[2]
        arg[1,3,0,0]=(0.349205030437)*x[0]+(-0.745240339596)*x[1]+(-0.744742092259)*x[2]
        arg[1,3,0,1]=(0.993101296711)*x[0]+(-1.48331355036)*x[1]+(-1.00616778677)*x[2]
        arg[1,3,1,0]=(-1.10586442824)*x[0]+(1.71922449779)*x[1]+(-0.943451153259)*x[2]
        arg[1,3,1,1]=(-1.72393763035)*x[0]+(-1.14113495956)*x[1]+(-0.211909615809)*x[2]
        arg[1,3,2,0]=(-0.378302963108)*x[0]+(-0.494705322002)*x[1]+(0.940164363332)*x[2]
        arg[1,3,2,1]=(0.850541148743)*x[0]+(-1.45461945468)*x[1]+(1.20025821328)*x[2]
        arg[1,4,0,0]=(1.33882463795)*x[0]+(0.475208133119)*x[1]+(0.722686059253)*x[2]
        arg[1,4,0,1]=(0.0750422155969)*x[0]+(1.29758288845)*x[1]+(-1.41431668738)*x[2]
        arg[1,4,1,0]=(1.36072344575)*x[0]+(-0.345743547563)*x[1]+(-0.63248018754)*x[2]
        arg[1,4,1,1]=(0.579049229913)*x[0]+(0.954245074078)*x[1]+(-0.170538926965)*x[2]
        arg[1,4,2,0]=(1.67615484634)*x[0]+(0.561067019023)*x[1]+(-1.26952326914)*x[2]
        arg[1,4,2,1]=(0.700910547934)*x[0]+(0.58717328764)*x[1]+(0.795138196965)*x[2]
        arg[2,0,0,0]=(0.763193592359)*x[0]+(-0.397549328381)*x[1]+(-0.230593559545)*x[2]
        arg[2,0,0,1]=(0.454026153468)*x[0]+(-1.12464443717)*x[1]+(-0.147462098246)*x[2]
        arg[2,0,1,0]=(-0.276457034935)*x[0]+(0.118173156654)*x[1]+(0.57296366275)*x[2]
        arg[2,0,1,1]=(1.31887812253)*x[0]+(-0.544644483254)*x[1]+(0.0013728350582)*x[2]
        arg[2,0,2,0]=(-0.257589384265)*x[0]+(-0.016005453203)*x[1]+(-0.508836430965)*x[2]
        arg[2,0,2,1]=(-0.259420301773)*x[0]+(0.122645293168)*x[1]+(0.381613885289)*x[2]
        arg[2,1,0,0]=(-1.64168512418)*x[0]+(0.025182006192)*x[1]+(0.0268780458975)*x[2]
        arg[2,1,0,1]=(-0.0885344200898)*x[0]+(0.408795219114)*x[1]+(0.635798801606)*x[2]
        arg[2,1,1,0]=(-0.959658503283)*x[0]+(1.034415556)*x[1]+(0.725681105748)*x[2]
        arg[2,1,1,1]=(1.59312707789)*x[0]+(-0.116514952101)*x[1]+(-0.86121633507)*x[2]
        arg[2,1,2,0]=(-1.44859572067)*x[0]+(-1.28344247275)*x[1]+(0.299296401869)*x[2]
        arg[2,1,2,1]=(-0.488424372501)*x[0]+(1.23481402288)*x[1]+(0.01702902463)*x[2]
        arg[2,2,0,0]=(-1.29986951244)*x[0]+(-1.20190912751)*x[1]+(-0.755848291051)*x[2]
        arg[2,2,0,1]=(-0.52421656312)*x[0]+(-0.335471509689)*x[1]+(-1.01264312499)*x[2]
        arg[2,2,1,0]=(-1.12066642609)*x[0]+(-1.02138558053)*x[1]+(-1.00777755552)*x[2]
        arg[2,2,1,1]=(-1.42127024744)*x[0]+(1.63480022479)*x[1]+(0.542244906643)*x[2]
        arg[2,2,2,0]=(-0.418852880297)*x[0]+(-0.983110436453)*x[1]+(-0.622603673805)*x[2]
        arg[2,2,2,1]=(0.727366446825)*x[0]+(-0.256324856361)*x[1]+(-0.20608740758)*x[2]
        arg[2,3,0,0]=(0.548268302883)*x[0]+(0.0102173127665)*x[1]+(0.869833576217)*x[2]
        arg[2,3,0,1]=(-1.70159091061)*x[0]+(1.15876875083)*x[1]+(-0.234757706773)*x[2]
        arg[2,3,1,0]=(-1.72817024817)*x[0]+(0.690055132218)*x[1]+(-0.149398998825)*x[2]
        arg[2,3,1,1]=(1.80829412387)*x[0]+(-0.217899654855)*x[1]+(-0.922672217822)*x[2]
        arg[2,3,2,0]=(1.23855200328)*x[0]+(0.412795411508)*x[1]+(0.960476191755)*x[2]
        arg[2,3,2,1]=(-1.43061904621)*x[0]+(-0.766039000745)*x[1]+(-1.25765397361)*x[2]
        arg[2,4,0,0]=(-0.660872016687)*x[0]+(-0.000405233718708)*x[1]+(-0.178507968219)*x[2]
        arg[2,4,0,1]=(-0.168526882871)*x[0]+(-1.06936802685)*x[1]+(1.54083857104)*x[2]
        arg[2,4,1,0]=(0.565807359529)*x[0]+(-1.41401297939)*x[1]+(-1.23254260537)*x[2]
        arg[2,4,1,1]=(-0.373920075802)*x[0]+(0.407330812903)*x[1]+(-0.204667001328)*x[2]
        arg[2,4,2,0]=(0.874100879885)*x[0]+(-0.191238094267)*x[1]+(1.54890969328)*x[2]
        arg[2,4,2,1]=(0.566428125313)*x[0]+(-1.60899595601)*x[1]+(-1.05112529768)*x[2]
        arg[3,0,0,0]=(-0.688037248111)*x[0]+(-1.56483484784)*x[1]+(0.26782504619)*x[2]
        arg[3,0,0,1]=(0.418788954459)*x[0]+(-0.670455226092)*x[1]+(-0.0562760591375)*x[2]
        arg[3,0,1,0]=(-0.2614362754)*x[0]+(0.271050519855)*x[1]+(0.227811982923)*x[2]
        arg[3,0,1,1]=(-0.873198928647)*x[0]+(-0.483763141395)*x[1]+(0.33532383979)*x[2]
        arg[3,0,2,0]=(-0.864161938176)*x[0]+(-1.4682754386)*x[1]+(-0.38126411162)*x[2]
        arg[3,0,2,1]=(0.142827521381)*x[0]+(0.464483940188)*x[1]+(0.214297576606)*x[2]
        arg[3,1,0,0]=(0.188747079113)*x[0]+(0.590821253713)*x[1]+(0.908850367108)*x[2]
        arg[3,1,0,1]=(0.0587541582624)*x[0]+(0.955494266151)*x[1]+(1.70822209849)*x[2]
        arg[3,1,1,0]=(-0.420356861523)*x[0]+(-0.551445918262)*x[1]+(-0.0187114754269)*x[2]
        arg[3,1,1,1]=(1.07071658401)*x[0]+(-0.589035602194)*x[1]+(0.133725074027)*x[2]
        arg[3,1,2,0]=(0.370477043767)*x[0]+(0.226262353618)*x[1]+(0.566087784489)*x[2]
        arg[3,1,2,1]=(1.77828660075)*x[0]+(0.607419742685)*x[1]+(0.0297054744582)*x[2]
        arg[3,2,0,0]=(-1.19326939474)*x[0]+(1.20875153887)*x[1]+(-0.124756222091)*x[2]
        arg[3,2,0,1]=(0.0645190914271)*x[0]+(0.357580475716)*x[1]+(-1.59461469718)*x[2]
        arg[3,2,1,0]=(1.4853619905)*x[0]+(0.751582301648)*x[1]+(0.859363177167)*x[2]
        arg[3,2,1,1]=(1.36658655075)*x[0]+(-0.776650996613)*x[1]+(0.654743994261)*x[2]
        arg[3,2,2,0]=(0.406696005677)*x[0]+(-0.528546876384)*x[1]+(-0.439775325396)*x[2]
        arg[3,2,2,1]=(-0.725198159461)*x[0]+(-0.0933136564416)*x[1]+(-0.720365141393)*x[2]
        arg[3,3,0,0]=(-0.428669112669)*x[0]+(0.626162511175)*x[1]+(-0.382776233923)*x[2]
        arg[3,3,0,1]=(0.340474939218)*x[0]+(-0.140550383925)*x[1]+(0.353836983746)*x[2]
        arg[3,3,1,0]=(0.851646816711)*x[0]+(0.0171684195949)*x[1]+(0.38173044322)*x[2]
        arg[3,3,1,1]=(0.359647722225)*x[0]+(0.425799941165)*x[1]+(-0.80174052212)*x[2]
        arg[3,3,2,0]=(0.13012568736)*x[0]+(-0.573735693651)*x[1]+(1.08843730088)*x[2]
        arg[3,3,2,1]=(-1.01372953294)*x[0]+(0.335282956856)*x[1]+(1.24570512628)*x[2]
        arg[3,4,0,0]=(-0.05674609039)*x[0]+(-0.814879575064)*x[1]+(-0.169789408264)*x[2]
        arg[3,4,0,1]=(1.5968230938)*x[0]+(0.0679819277023)*x[1]+(0.892284314512)*x[2]
        arg[3,4,1,0]=(1.22220298478)*x[0]+(-0.0258417926472)*x[1]+(0.440670138568)*x[2]
        arg[3,4,1,1]=(0.647072768716)*x[0]+(-0.177651087906)*x[1]+(-0.115553644646)*x[2]
        arg[3,4,2,0]=(1.29816363306)*x[0]+(-1.18656044167)*x[1]+(-0.465776533157)*x[2]
        arg[3,4,2,1]=(0.328907496091)*x[0]+(-0.179857937151)*x[1]+(-0.476306938306)*x[2]
        ref[0,0,0,0]=(-0.530378359482)/(o+1.)+(-0.935143327523)+(0.0724486640358)*0.5**o
        ref[0,0,0,1]=(1.22837847871)/(o+1.)+(-0.113350954728)+(-0.950658241915)*0.5**o
        ref[0,0,1,0]=(-0.000414683535449)/(o+1.)+(-0.183158731552)+(-0.49805903018)*0.5**o
        ref[0,0,1,1]=(-0.882730389132)/(o+1.)+(-0.112174958816)+(0.831217305802)*0.5**o
        ref[0,0,2,0]=(-1.1913557966)/(o+1.)+(-0.0615750891074)+(-0.206094875146)*0.5**o
        ref[0,0,2,1]=(0.634536492589)/(o+1.)+(0.649890059464)+(0.627332034578)*0.5**o
        ref[0,1,0,0]=(-1.38665625775)/(o+1.)+(-1.0210653524)+(0.900623422471)*0.5**o
        ref[0,1,0,1]=(1.20633678024)/(o+1.)+(0.0888193121856)+(-0.143132885707)*0.5**o
        ref[0,1,1,0]=(0.452225278035)/(o+1.)+(-0.148926943801)+(-0.710642116901)*0.5**o
        ref[0,1,1,1]=(-0.244223430204)/(o+1.)+(-0.619607191996)+(0.499221868978)*0.5**o
        ref[0,1,2,0]=(0.0383849036606)/(o+1.)+(0.759484971644)+(-0.652076533427)*0.5**o
        ref[0,1,2,1]=(0.207558055759)/(o+1.)+(0.502305382384)+(0.0110157380215)*0.5**o
        ref[0,2,0,0]=(0.761374280144)/(o+1.)+(0.777616611515)+(0.734430478174)*0.5**o
        ref[0,2,0,1]=(0.554502862028)/(o+1.)+(-0.409274602016)+(-0.0353906413371)*0.5**o
        ref[0,2,1,0]=(-0.252543841709)/(o+1.)+(0.386640377894)+(0.522891013551)*0.5**o
        ref[0,2,1,1]=(-1.52497235887)/(o+1.)+(-0.807603254401)+(-0.0435508470367)*0.5**o
        ref[0,2,2,0]=(0.172485606257)/(o+1.)+(0.350297526187)+(0.19802601847)*0.5**o
        ref[0,2,2,1]=(-0.141271359379)/(o+1.)+(0.0509198134622)+(0.373638764298)*0.5**o
        ref[0,3,0,0]=(1.31278836809)/(o+1.)+(-0.0918739323256)+(0.350372309595)*0.5**o
        ref[0,3,0,1]=(-0.396933928109)/(o+1.)+(-0.436137805999)+(0.418204051696)*0.5**o
        ref[0,3,1,0]=(-0.206619840099)/(o+1.)+(-0.118703289798)+(0.353208336689)*0.5**o
        ref[0,3,1,1]=(-0.595153371293)/(o+1.)+(0.615722581562)+(0.469169640021)*0.5**o
        ref[0,3,2,0]=(-0.680858997986)/(o+1.)+(-0.0393223937964)+(-0.206963765944)*0.5**o
        ref[0,3,2,1]=(0.012753264598)/(o+1.)+(0.246188741489)+(-0.548093910595)*0.5**o
        ref[0,4,0,0]=(-0.40478987122)/(o+1.)+(-0.890399681609)+(0.33572726901)*0.5**o
        ref[0,4,0,1]=(0.0280062557264)/(o+1.)+(0.0358049413228)+(0.856417711355)*0.5**o
        ref[0,4,1,0]=(0.181560004565)/(o+1.)+(0.329885369854)+(0.31502676574)*0.5**o
        ref[0,4,1,1]=(0.0552681276841)/(o+1.)+(0.00372919426319)+(0.838827828375)*0.5**o
        ref[0,4,2,0]=(0.656057162724)/(o+1.)+(0.179315527684)+(-0.522542441641)*0.5**o
        ref[0,4,2,1]=(0.126189389317)/(o+1.)+(-0.429452001643)+(-0.149659196108)*0.5**o
        ref[1,0,0,0]=(1.43443485527)/(o+1.)+(-0.55091754491)+(0.0630603461901)*0.5**o
        ref[1,0,0,1]=(-0.612191779306)/(o+1.)+(0.604025235381)+(-0.230957890695)*0.5**o
        ref[1,0,1,0]=(0.373085423681)/(o+1.)+(-0.0817391530697)+(-0.113594076805)*0.5**o
        ref[1,0,1,1]=(0.761862677657)/(o+1.)+(0.819524484428)+(0.172331645033)*0.5**o
        ref[1,0,2,0]=(0.929265450746)/(o+1.)+(-0.382585784938)+(0.254478170515)*0.5**o
        ref[1,0,2,1]=(1.58236203463)/(o+1.)+(-0.280641188811)+(0.238179175679)*0.5**o
        ref[1,1,0,0]=(-0.117055726312)/(o+1.)+(0.957914090571)+(-0.101672257501)*0.5**o
        ref[1,1,0,1]=(0.0849062553796)/(o+1.)+(0.0703564566846)+(0.818261558262)*0.5**o
        ref[1,1,1,0]=(-1.72219113622)/(o+1.)+(-0.357454724939)+(0.15835663635)*0.5**o
        ref[1,1,1,1]=(0.739078400468)/(o+1.)+(0.532292543169)+(0.673031856531)*0.5**o
        ref[1,1,2,0]=(0.255023909903)/(o+1.)+(0.229656917655)+(0.22400044344)*0.5**o
        ref[1,1,2,1]=(0.518856765199)/(o+1.)+(0.380552790125)+(0.543298381396)*0.5**o
        ref[1,2,0,0]=(0.0321563884831)/(o+1.)+(0.25981567762)+(-0.0316496900482)*0.5**o
        ref[1,2,0,1]=(1.09318176771)/(o+1.)+(0.0572442907603)+(0.564519446305)*0.5**o
        ref[1,2,1,0]=(0.756962791387)/(o+1.)+(0.69419429624)+(0.32401997528)*0.5**o
        ref[1,2,1,1]=(1.28480299241)/(o+1.)+(-0.201990593541)+(-0.905711635518)*0.5**o
        ref[1,2,2,0]=(1.04969566442)/(o+1.)+(0.72854097372)+(0.592972696101)*0.5**o
        ref[1,2,2,1]=(-1.77086264775)/(o+1.)+(-0.261914180361)+(0.0440022926066)*0.5**o
        ref[1,3,0,0]=(-0.477780531124)/(o+1.)+(-0.181354085163)+(-0.300288699967)*0.5**o
        ref[1,3,0,1]=(-0.797627013456)/(o+1.)+(-0.523163955197)+(0.347574883435)*0.5**o
        ref[1,3,1,0]=(0.428806106821)/(o+1.)+(-0.0514584302394)+(-0.655980330052)*0.5**o
        ref[1,3,1,1]=(-0.141740459457)/(o+1.)+(-1.05699960931)+(-0.821242527644)*0.5**o
        ref[1,3,2,0]=(0.0181810985873)/(o+1.)+(-0.180697139553)+(0.41036925874)*0.5**o
        ref[1,3,2,1]=(-0.061077367)/(o+1.)+(0.250077446763)+(0.157102380812)*0.5**o
        ref[1,4,0,0]=(1.14087212913)/(o+1.)+(0.368059029864)+(0.659728641463)*0.5**o
        ref[1,4,0,1]=(0.365658713316)/(o+1.)+(0.088533821044)+(-0.584417938734)*0.5**o
        ref[1,4,1,0]=(-1.11681308321)/(o+1.)+(0.438275560627)+(0.622761672604)*0.5**o
        ref[1,4,1,1]=(1.18893372018)/(o+1.)+(0.172934240923)+(-0.172046824999)*0.5**o
        ref[1,4,2,0]=(0.16240489493)/(o+1.)+(-0.0145923852256)+(0.834478471749)*0.5**o
        ref[1,4,2,1]=(0.571355829378)/(o+1.)+(0.526896417749)+(0.458073367663)*0.5**o
        ref[2,0,0,0]=(-0.489234572937)/(o+1.)+(-0.0135589093901)+(0.65140309615)*0.5**o
        ref[2,0,0,1]=(-1.55383491931)/(o+1.)+(0.0161644619972)+(0.703425613366)*0.5**o
        ref[2,0,1,0]=(-0.258604855723)/(o+1.)+(0.0827812678671)+(0.507722104457)*0.5**o
        ref[2,0,1,1]=(0.0504178529481)/(o+1.)+(0.182991850332)+(0.359204920726)*0.5**o
        ref[2,0,2,0]=(0.652043479841)/(o+1.)+(-0.443015450013)+(-0.548443848248)*0.5**o
        ref[2,0,2,1]=(0.340317839857)/(o+1.)+(-0.379565594545)+(0.663652225917)*0.5**o
        ref[2,1,0,0]=(-0.587863196667)/(o+1.)+(-0.0137797674284)+(-0.974202340562)*0.5**o
        ref[2,1,0,1]=(1.00030747039)/(o+1.)+(-0.399997754768)+(0.755747639771)*0.5**o
        ref[2,1,1,0]=(0.703413281036)/(o+1.)+(0.487016208736)+(-0.877007540039)*0.5**o
        ref[2,1,1,1]=(0.263166830572)/(o+1.)+(-0.157259452849)+(0.666747865841)*0.5**o
        ref[2,1,2,0]=(0.104532343004)/(o+1.)+(-1.02548001493)+(-0.486314104701)*0.5**o
        ref[2,1,2,1]=(0.933518655478)/(o+1.)+(0.0369928229139)+(-0.244085626298)*0.5**o
        ref[2,2,0,0]=(-1.50550384519)/(o+1.)+(-0.590996227594)+(-0.570130630622)*0.5**o
        ref[2,2,0,1]=(-0.60318683839)/(o+1.)+(-0.38308245528)+(-0.502979448853)*0.5**o
        ref[2,2,1,0]=(-1.11258910879)/(o+1.)+(-0.518777277969)+(-0.999685897413)*0.5**o
        ref[2,2,1,1]=(1.84366617107)/(o+1.)+(-0.232866738261)+(-0.622157810558)*0.5**o
        ref[2,2,2,0]=(-0.620181988585)/(o+1.)+(-0.836162444183)+(0.267939886396)*0.5**o
        ref[2,2,2,1]=(-0.826647389099)/(o+1.)+(0.0929536518109)+(0.905694268362)*0.5**o
        ref[2,3,0,0]=(0.184067674443)/(o+1.)+(0.259745858757)+(0.724759799909)*0.5**o
        ref[2,3,0,1]=(0.0175595303049)/(o+1.)+(0.0560117358912)+(-0.907162868639)*0.5**o
        ref[2,3,1,0]=(-0.609443154617)/(o+1.)+(0.186540819401)+(-0.951152598958)*0.5**o
        ref[2,3,1,1]=(-1.61858082094)/(o+1.)+(0.679439858578)+(0.927423354971)*0.5**o
        ref[2,3,2,0]=(0.44350652486)/(o+1.)+(0.81466177481)+(0.53899353207)*0.5**o
        ref[2,3,2,1]=(-0.877289862245)/(o+1.)+(-1.05742260849)+(-0.462176941342)*0.5**o
        ref[2,4,0,0]=(-0.736381416539)/(o+1.)+(-0.0139374259612)+(-0.0755289501641)*0.5**o
        ref[2,4,0,1]=(0.690429326999)/(o+1.)+(-0.0293644018251)+(-0.328756862036)*0.5**o
        ref[2,4,1,0]=(-1.57117034002)/(o+1.)+(-0.531463765387)+(0.553349645561)*0.5**o
        ref[2,4,1,1]=(1.24898175282)/(o+1.)+(-0.452273024959)+(-0.515691967125)*0.5**o
        ref[2,4,2,0]=(0.239126191643)/(o+1.)+(0.722504563932)+(0.547637159392)*0.5**o
        ref[2,4,2,1]=(-1.40763254209)/(o+1.)+(-0.809456441012)+(0.932852295739)*0.5**o
        ref[3,0,0,0]=(-0.416554297686)/(o+1.)+(-0.632193610911)+(-0.304105530258)*0.5**o
        ref[3,0,0,1]=(-1.02983448036)/(o+1.)+(0.579212231778)+(-0.436532313966)*0.5**o
        ref[3,0,1,0]=(0.42124133216)/(o+1.)+(0.368290418827)+(-0.920395942436)*0.5**o
        ref[3,0,1,1]=(0.158195474854)/(o+1.)+(-0.17459474514)+(-0.830644214826)*0.5**o
        ref[3,0,2,0]=(-1.18749647329)/(o+1.)+(-0.506173996178)+(-0.513857022748)*0.5**o
        ref[3,0,2,1]=(0.233437753018)/(o+1.)+(0.455705145371)+(-0.323239005586)*0.5**o
        ref[3,1,0,0]=(1.42991958566)/(o+1.)+(0.053769921022)+(0.150959272234)*0.5**o
        ref[3,1,0,1]=(1.48423731111)/(o+1.)+(0.964048315997)+(-0.689863420196)*0.5**o
        ref[3,1,1,0]=(0.868837676765)/(o+1.)+(-1.01261543254)+(0.165878933098)*0.5**o
        ref[3,1,1,1]=(0.820750307831)/(o+1.)+(-0.300930223821)+(0.396516195659)*0.5**o
        ref[3,1,2,0]=(0.477077782202)/(o+1.)+(-0.0416336989494)+(0.769016797571)*0.5**o
        ref[3,1,2,1]=(0.359895440587)/(o+1.)+(0.555322395811)+(0.944871585683)*0.5**o
        ref[3,2,0,0]=(0.657668315832)/(o+1.)+(-0.240321895174)+(-0.286298603451)*0.5**o
        ref[3,2,0,1]=(-0.941360568282)/(o+1.)+(-0.0246544136593)+(-0.181845734439)*0.5**o
        ref[3,2,1,0]=(1.60316834971)/(o+1.)+(0.252291602298)+(0.988555915005)*0.5**o
        ref[3,2,1,1]=(0.833811957678)/(o+1.)+(-0.111970621871)+(0.634808834458)*0.5**o
        ref[3,2,2,0]=(-1.38877073784)/(o+1.)+(0.538356636307)+(-0.249568730877)*0.5**o
        ref[3,2,2,1]=(-0.311839184097)/(o+1.)+(-0.698114103264)+(0.169190433329)*0.5**o
        ref[3,3,0,0]=(0.743170989696)/(o+1.)+(-0.499224746788)+(0.0699956684628)*0.5**o
        ref[3,3,0,1]=(-0.293538786051)/(o+1.)+(0.26667992866)+(0.313940467768)*0.5**o
        ref[3,3,1,0]=(0.951483461345)/(o+1.)+(0.148317904561)+(0.00242640905887)*0.5**o
        ref[3,3,1,1]=(-0.110753912776)/(o+1.)+(-0.44308689138)+(0.980634836805)*0.5**o
        ref[3,3,2,0]=(-0.337895223544)/(o+1.)+(0.358941646037)+(0.264839226057)*0.5**o
        ref[3,3,2,1]=(0.857823611315)/(o+1.)+(0.30404611512)+(-0.898657291359)*0.5**o
        ref[3,4,0,0]=(0.037944509376)/(o+1.)+(-0.364801700413)+(-0.349756182268)*0.5**o
        ref[3,4,0,1]=(1.01114399396)/(o+1.)+(0.457103279485)+(0.631738783076)*0.5**o
        ref[3,4,1,0]=(0.969931913888)/(o+1.)+(-0.165922085756)+(0.998943588321)*0.5**o
        ref[3,4,1,1]=(1.35441114248)/(o+1.)+(-0.502422727199)+(0.00430234808496)*0.5**o
        ref[3,4,2,0]=(-0.367201097566)/(o+1.)+(-0.337780780531)+(0.688589316866)*0.5**o
        ref[3,4,2,1]=(-0.0547905846061)/(o+1.)+(-0.293870420685)+(0.31527404661)*0.5**o
      res=integrate(arg,where=w_ref)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_FunctionOnContactOne_rank0(self):
      """
      tests integral of rank 0 Data on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      if dim==2:
        arg=(0.311787641998)*x[0]**o+(0.161673282875)*x[0]+(0.32570909237)*x[1]**o+(-0.249404742764)*x[1]
        ref=(0.32570909237)/(o+1.)+(-0.0438657299447)+(0.311787641998)*0.5**o
      else:
        arg=(0.0675036998003)*x[0]**o+(-0.247751392136)*x[0]+(0.791676220029)*x[1]**o+(-0.269015236163)*x[1]+(0.265735156875)*x[2]**o+(0.820319192519)*x[2]
        ref=(1.0574113769)/(o+1.)+(0.15177628211)+(0.0675036998003)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,float),"wrong type of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_FunctionOnContactOne_rank1(self):
      """
      tests integral of rank 1 Data on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        arg[0]=(0.99235950851)*x[0]**o+(0.00867392831518)*x[0]+(-0.598024390869)*x[1]**o+(0.00945232777857)*x[1]
        arg[1]=(-0.140261338996)*x[0]**o+(-0.166524016889)*x[0]+(0.59850076881)*x[1]**o+(-0.805756215354)*x[1]
        ref[0]=(-0.598024390869)/(o+1.)+(0.00906312804687)+(0.99235950851)*0.5**o
        ref[1]=(0.59850076881)/(o+1.)+(-0.486140116122)+(-0.140261338996)*0.5**o
      else:
        arg[0]=(-0.158686556523)*x[0]**o+(0.249193164275)*x[0]+(-0.801383648208)*x[1]**o+(-0.439021533504)*x[1]+(-0.112035191366)*x[2]**o+(-0.323385862625)*x[2]
        arg[1]=(0.392997873484)*x[0]**o+(-0.867468854104)*x[0]+(0.804459243476)*x[1]**o+(0.129028860314)*x[1]+(-0.252715502862)*x[2]**o+(0.457355923469)*x[2]
        ref[0]=(-0.913418839574)/(o+1.)+(-0.256607115927)+(-0.158686556523)*0.5**o
        ref[1]=(0.551743740614)/(o+1.)+(-0.140542035161)+(0.392997873484)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(2,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_FunctionOnContactOne_rank2(self):
      """
      tests integral of rank 2 Data on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        arg[0,0]=(0.330520725992)*x[0]**o+(0.160118740246)*x[0]+(-0.178670895269)*x[1]**o+(-0.281660040648)*x[1]
        arg[0,1]=(-0.871801084852)*x[0]**o+(0.692549035429)*x[0]+(-0.265102051042)*x[1]**o+(-0.799752901882)*x[1]
        arg[0,2]=(-0.816985024574)*x[0]**o+(0.534242721856)*x[0]+(0.81492666918)*x[1]**o+(0.891189158633)*x[1]
        arg[0,3]=(-0.20728122917)*x[0]**o+(-0.656873565737)*x[0]+(-0.924660993906)*x[1]**o+(0.453699593426)*x[1]
        arg[0,4]=(-0.541377726375)*x[0]**o+(0.916287049432)*x[0]+(-0.15879052465)*x[1]**o+(-0.319875161126)*x[1]
        arg[1,0]=(0.296966289838)*x[0]**o+(0.170347587334)*x[0]+(0.755207250839)*x[1]**o+(0.677658805212)*x[1]
        arg[1,1]=(-0.507591010573)*x[0]**o+(0.299638021889)*x[0]+(-0.757702071557)*x[1]**o+(-0.194564860748)*x[1]
        arg[1,2]=(0.821972467197)*x[0]**o+(-0.75902704466)*x[0]+(0.19424332718)*x[1]**o+(-0.070182646035)*x[1]
        arg[1,3]=(-0.340805687409)*x[0]**o+(0.585961973082)*x[0]+(-0.602942732318)*x[1]**o+(-0.288941395094)*x[1]
        arg[1,4]=(0.0314374795024)*x[0]**o+(0.293710824013)*x[0]+(0.576509865762)*x[1]**o+(-0.481377812302)*x[1]
        arg[2,0]=(0.250117528833)*x[0]**o+(-0.318419344173)*x[0]+(-0.793830015706)*x[1]**o+(0.0445553063586)*x[1]
        arg[2,1]=(-0.347974394766)*x[0]**o+(-0.569347105354)*x[0]+(0.838687005759)*x[1]**o+(0.534306628908)*x[1]
        arg[2,2]=(0.53063272248)*x[0]**o+(0.426504428158)*x[0]+(0.215398162753)*x[1]**o+(0.324348187788)*x[1]
        arg[2,3]=(-0.336752121527)*x[0]**o+(0.666074768462)*x[0]+(-0.739123251932)*x[1]**o+(-0.538899653147)*x[1]
        arg[2,4]=(-0.832783810519)*x[0]**o+(0.558572116384)*x[0]+(0.119988536199)*x[1]**o+(-0.664170918761)*x[1]
        arg[3,0]=(0.4941356722)*x[0]**o+(-0.403591783006)*x[0]+(0.205050527245)*x[1]**o+(0.351642574939)*x[1]
        arg[3,1]=(0.12538190695)*x[0]**o+(-0.890722638937)*x[0]+(-0.897011486902)*x[1]**o+(-0.465522770696)*x[1]
        arg[3,2]=(-0.862829007552)*x[0]**o+(-0.950531038019)*x[0]+(-0.970016379643)*x[1]**o+(-0.500580755888)*x[1]
        arg[3,3]=(0.131451743264)*x[0]**o+(0.43845495141)*x[0]+(-0.929808474589)*x[1]**o+(-0.104714452616)*x[1]
        arg[3,4]=(-0.81935224348)*x[0]**o+(-0.53791483312)*x[0]+(-0.714512816761)*x[1]**o+(0.329859667225)*x[1]
        ref[0,0]=(-0.178670895269)/(o+1.)+(-0.0607706502011)+(0.330520725992)*0.5**o
        ref[0,1]=(-0.265102051042)/(o+1.)+(-0.0536019332266)+(-0.871801084852)*0.5**o
        ref[0,2]=(0.81492666918)/(o+1.)+(0.712715940244)+(-0.816985024574)*0.5**o
        ref[0,3]=(-0.924660993906)/(o+1.)+(-0.101586986156)+(-0.20728122917)*0.5**o
        ref[0,4]=(-0.15879052465)/(o+1.)+(0.298205944153)+(-0.541377726375)*0.5**o
        ref[1,0]=(0.755207250839)/(o+1.)+(0.424003196273)+(0.296966289838)*0.5**o
        ref[1,1]=(-0.757702071557)/(o+1.)+(0.0525365805706)+(-0.507591010573)*0.5**o
        ref[1,2]=(0.19424332718)/(o+1.)+(-0.414604845348)+(0.821972467197)*0.5**o
        ref[1,3]=(-0.602942732318)/(o+1.)+(0.148510288994)+(-0.340805687409)*0.5**o
        ref[1,4]=(0.576509865762)/(o+1.)+(-0.0938334941445)+(0.0314374795024)*0.5**o
        ref[2,0]=(-0.793830015706)/(o+1.)+(-0.136932018907)+(0.250117528833)*0.5**o
        ref[2,1]=(0.838687005759)/(o+1.)+(-0.0175202382229)+(-0.347974394766)*0.5**o
        ref[2,2]=(0.215398162753)/(o+1.)+(0.375426307973)+(0.53063272248)*0.5**o
        ref[2,3]=(-0.739123251932)/(o+1.)+(0.0635875576574)+(-0.336752121527)*0.5**o
        ref[2,4]=(0.119988536199)/(o+1.)+(-0.0527994011886)+(-0.832783810519)*0.5**o
        ref[3,0]=(0.205050527245)/(o+1.)+(-0.0259746040335)+(0.4941356722)*0.5**o
        ref[3,1]=(-0.897011486902)/(o+1.)+(-0.678122704817)+(0.12538190695)*0.5**o
        ref[3,2]=(-0.970016379643)/(o+1.)+(-0.725555896953)+(-0.862829007552)*0.5**o
        ref[3,3]=(-0.929808474589)/(o+1.)+(0.166870249397)+(0.131451743264)*0.5**o
        ref[3,4]=(-0.714512816761)/(o+1.)+(-0.104027582947)+(-0.81935224348)*0.5**o
      else:
        arg[0,0]=(-0.916251178344)*x[0]**o+(0.858306033367)*x[0]+(0.814515071272)*x[1]**o+(-0.31988121358)*x[1]+(-0.973228319626)*x[2]**o+(-0.448894628432)*x[2]
        arg[0,1]=(0.394307707909)*x[0]**o+(-0.270473398988)*x[0]+(0.904831123674)*x[1]**o+(-0.949869961069)*x[1]+(0.771889549168)*x[2]**o+(0.650652953462)*x[2]
        arg[0,2]=(-0.0387282383528)*x[0]**o+(0.0292919821249)*x[0]+(-0.165189629855)*x[1]**o+(-0.265182468614)*x[1]+(0.919042632361)*x[2]**o+(0.710368688769)*x[2]
        arg[0,3]=(0.680006301334)*x[0]**o+(0.96959940913)*x[0]+(0.773153544603)*x[1]**o+(-0.460435754764)*x[1]+(-0.202448514604)*x[2]**o+(-0.495739672831)*x[2]
        arg[0,4]=(-0.972790915366)*x[0]**o+(-0.14148426268)*x[0]+(0.511995390348)*x[1]**o+(-0.252881217719)*x[1]+(0.255711210131)*x[2]**o+(0.729991325048)*x[2]
        arg[1,0]=(-0.105824689194)*x[0]**o+(-0.201427239595)*x[0]+(-0.00550922402684)*x[1]**o+(-0.732794556814)*x[1]+(-0.0820953451459)*x[2]**o+(0.289904794134)*x[2]
        arg[1,1]=(-0.378707957559)*x[0]**o+(0.776904510463)*x[0]+(0.0406721415351)*x[1]**o+(0.159288221237)*x[1]+(0.961004037621)*x[2]**o+(-0.0866180279992)*x[2]
        arg[1,2]=(-0.0226058491089)*x[0]**o+(-0.569995151391)*x[0]+(-0.0675265986408)*x[1]**o+(-0.141280346236)*x[1]+(0.116098815262)*x[2]**o+(0.654630437206)*x[2]
        arg[1,3]=(-0.567270755897)*x[0]**o+(0.580139672878)*x[0]+(-0.411816626246)*x[1]**o+(-0.490525831459)*x[1]+(0.9322522728)*x[2]**o+(-0.948230068413)*x[2]
        arg[1,4]=(0.977251285351)*x[0]**o+(-0.457921996364)*x[0]+(-0.586207130671)*x[1]**o+(0.801370818191)*x[1]+(-0.667233775445)*x[2]**o+(0.277054304674)*x[2]
        arg[2,0]=(0.997778241906)*x[0]**o+(0.490242237175)*x[0]+(0.406384527224)*x[1]**o+(-0.00724475574186)*x[1]+(-0.59799957401)*x[2]**o+(0.520598391022)*x[2]
        arg[2,1]=(0.59766081214)*x[0]**o+(-0.144793824209)*x[0]+(-0.191121009265)*x[1]**o+(-0.178016091024)*x[1]+(0.168431462883)*x[2]**o+(-0.766200678925)*x[2]
        arg[2,2]=(0.633988266946)*x[0]**o+(-0.880495194817)*x[0]+(-0.217502420499)*x[1]**o+(-0.730159316723)*x[1]+(0.255599562732)*x[2]**o+(-0.510511087905)*x[2]
        arg[2,3]=(0.102332382261)*x[0]**o+(-0.370884332534)*x[0]+(-0.0926186085648)*x[1]**o+(0.86446607832)*x[1]+(0.0643112986026)*x[2]**o+(0.950118360785)*x[2]
        arg[2,4]=(0.928323090624)*x[0]**o+(0.942943574803)*x[0]+(0.162570981489)*x[1]**o+(-0.971092675635)*x[1]+(0.641489870001)*x[2]**o+(0.695989498774)*x[2]
        arg[3,0]=(-0.988813741403)*x[0]**o+(0.407960892494)*x[0]+(0.671572481461)*x[1]**o+(0.119756938854)*x[1]+(-0.923671788537)*x[2]**o+(-0.458931381612)*x[2]
        arg[3,1]=(-0.241202616681)*x[0]**o+(-0.369134099039)*x[0]+(-0.129164268709)*x[1]**o+(-0.469311903775)*x[1]+(0.633909205241)*x[2]**o+(0.564043934538)*x[2]
        arg[3,2]=(-0.397081811407)*x[0]**o+(0.909387986899)*x[0]+(0.260590665694)*x[1]**o+(-0.371472818152)*x[1]+(-0.0369834262513)*x[2]**o+(-0.887598789153)*x[2]
        arg[3,3]=(-0.304262529036)*x[0]**o+(0.741316478862)*x[0]+(-0.384317206475)*x[1]**o+(-0.854685760579)*x[1]+(0.502373892581)*x[2]**o+(-0.923561844368)*x[2]
        arg[3,4]=(-0.720555420423)*x[0]**o+(-0.115786593478)*x[0]+(0.832043243085)*x[1]**o+(-0.912631896773)*x[1]+(-0.583397798668)*x[2]**o+(-0.508174721594)*x[2]
        ref[0,0]=(-0.158713248354)/(o+1.)+(0.0447650956777)+(-0.916251178344)*0.5**o
        ref[0,1]=(1.67672067284)/(o+1.)+(-0.284845203298)+(0.394307707909)*0.5**o
        ref[0,2]=(0.753853002506)/(o+1.)+(0.23723910114)+(-0.0387282383528)*0.5**o
        ref[0,3]=(0.570705029999)/(o+1.)+(0.00671199076774)+(0.680006301334)*0.5**o
        ref[0,4]=(0.767706600479)/(o+1.)+(0.167812922325)+(-0.972790915366)*0.5**o
        ref[1,0]=(-0.0876045691728)/(o+1.)+(-0.322158501138)+(-0.105824689194)*0.5**o
        ref[1,1]=(1.00167617916)/(o+1.)+(0.42478735185)+(-0.378707957559)*0.5**o
        ref[1,2]=(0.0485722166212)/(o+1.)+(-0.0283225302105)+(-0.0226058491089)*0.5**o
        ref[1,3]=(0.520435646554)/(o+1.)+(-0.429308113497)+(-0.567270755897)*0.5**o
        ref[1,4]=(-1.25344090612)/(o+1.)+(0.31025156325)+(0.977251285351)*0.5**o
        ref[2,0]=(-0.191615046786)/(o+1.)+(0.501797936227)+(0.997778241906)*0.5**o
        ref[2,1]=(-0.0226895463818)/(o+1.)+(-0.544505297079)+(0.59766081214)*0.5**o
        ref[2,2]=(0.0380971422336)/(o+1.)+(-1.06058279972)+(0.633988266946)*0.5**o
        ref[2,3]=(-0.0283073099622)/(o+1.)+(0.721850053286)+(0.102332382261)*0.5**o
        ref[2,4]=(0.80406085149)/(o+1.)+(0.333920198971)+(0.928323090624)*0.5**o
        ref[3,0]=(-0.252099307076)/(o+1.)+(0.0343932248679)+(-0.988813741403)*0.5**o
        ref[3,1]=(0.504744936532)/(o+1.)+(-0.137201034138)+(-0.241202616681)*0.5**o
        ref[3,2]=(0.223607239442)/(o+1.)+(-0.174841810203)+(-0.397081811407)*0.5**o
        ref[3,3]=(0.118056686106)/(o+1.)+(-0.518465563043)+(-0.304262529036)*0.5**o
        ref[3,4]=(0.248645444416)/(o+1.)+(-0.768296605922)+(-0.720555420423)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_FunctionOnContactOne_rank3(self):
      """
      tests integral of rank 3 Data on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        arg[0,0,0]=(-0.347273720148)*x[0]**o+(0.325185727721)*x[0]+(-0.855515194735)*x[1]**o+(0.825807975597)*x[1]
        arg[0,0,1]=(0.842054669437)*x[0]**o+(0.353768311241)*x[0]+(0.0148900864182)*x[1]**o+(-0.402154654143)*x[1]
        arg[0,1,0]=(-0.191525791617)*x[0]**o+(-0.299181220926)*x[0]+(-0.696260869529)*x[1]**o+(0.285645399154)*x[1]
        arg[0,1,1]=(0.190151633835)*x[0]**o+(0.184074338131)*x[0]+(-0.497689504982)*x[1]**o+(-0.813410371313)*x[1]
        arg[1,0,0]=(-0.695114302024)*x[0]**o+(0.427133485674)*x[0]+(-0.711899825683)*x[1]**o+(-0.296004734911)*x[1]
        arg[1,0,1]=(0.37620789583)*x[0]**o+(-0.944850444544)*x[0]+(0.666194812839)*x[1]**o+(-0.0715430628168)*x[1]
        arg[1,1,0]=(-0.0312291891427)*x[0]**o+(0.403009732443)*x[0]+(-0.378486005359)*x[1]**o+(-0.992729541609)*x[1]
        arg[1,1,1]=(0.0675984132698)*x[0]**o+(0.241001129867)*x[0]+(0.340546237588)*x[1]**o+(-0.024830810543)*x[1]
        arg[2,0,0]=(-0.146870758676)*x[0]**o+(-0.170434897147)*x[0]+(-0.579618469996)*x[1]**o+(-0.770817574749)*x[1]
        arg[2,0,1]=(-0.3029068201)*x[0]**o+(-0.110636302601)*x[0]+(-0.905841665338)*x[1]**o+(-0.280977886629)*x[1]
        arg[2,1,0]=(0.0547810600344)*x[0]**o+(0.00763321517272)*x[0]+(0.0156822194106)*x[1]**o+(-0.528337857094)*x[1]
        arg[2,1,1]=(0.12016647407)*x[0]**o+(0.4590743733)*x[0]+(-0.574499998403)*x[1]**o+(0.698871172503)*x[1]
        arg[3,0,0]=(0.481811757276)*x[0]**o+(0.748356476205)*x[0]+(-0.300272959749)*x[1]**o+(-0.707230263391)*x[1]
        arg[3,0,1]=(-0.347858576311)*x[0]**o+(-0.177810365974)*x[0]+(0.384658344075)*x[1]**o+(-0.837385668636)*x[1]
        arg[3,1,0]=(0.943559460135)*x[0]**o+(0.178778474835)*x[0]+(-0.831384000346)*x[1]**o+(-0.474975888568)*x[1]
        arg[3,1,1]=(-0.589903969401)*x[0]**o+(0.271114795948)*x[0]+(-0.946594221253)*x[1]**o+(-0.964029170264)*x[1]
        arg[4,0,0]=(0.221077049797)*x[0]**o+(0.986052914095)*x[0]+(-0.392982812685)*x[1]**o+(0.370828365061)*x[1]
        arg[4,0,1]=(0.463121232737)*x[0]**o+(-0.91920434872)*x[0]+(0.830655891827)*x[1]**o+(0.193876462558)*x[1]
        arg[4,1,0]=(0.925740559506)*x[0]**o+(0.534342942418)*x[0]+(0.446730463706)*x[1]**o+(0.181095371535)*x[1]
        arg[4,1,1]=(-0.777093674353)*x[0]**o+(-0.435130879793)*x[0]+(0.134406853212)*x[1]**o+(0.861099956528)*x[1]
        arg[5,0,0]=(-0.443943796359)*x[0]**o+(0.359190127208)*x[0]+(0.0570788998709)*x[1]**o+(0.548070594378)*x[1]
        arg[5,0,1]=(0.762962865085)*x[0]**o+(0.969248002849)*x[0]+(0.729222816543)*x[1]**o+(-0.865271983926)*x[1]
        arg[5,1,0]=(-0.915609563739)*x[0]**o+(-0.338560068696)*x[0]+(0.972145654544)*x[1]**o+(0.0941277349395)*x[1]
        arg[5,1,1]=(-0.486023356984)*x[0]**o+(-0.426382776921)*x[0]+(-0.114606039743)*x[1]**o+(-0.992152486495)*x[1]
        ref[0,0,0]=(-0.855515194735)/(o+1.)+(0.575496851659)+(-0.347273720148)*0.5**o
        ref[0,0,1]=(0.0148900864182)/(o+1.)+(-0.0241931714509)+(0.842054669437)*0.5**o
        ref[0,1,0]=(-0.696260869529)/(o+1.)+(-0.00676791088595)+(-0.191525791617)*0.5**o
        ref[0,1,1]=(-0.497689504982)/(o+1.)+(-0.314668016591)+(0.190151633835)*0.5**o
        ref[1,0,0]=(-0.711899825683)/(o+1.)+(0.0655643753813)+(-0.695114302024)*0.5**o
        ref[1,0,1]=(0.666194812839)/(o+1.)+(-0.50819675368)+(0.37620789583)*0.5**o
        ref[1,1,0]=(-0.378486005359)/(o+1.)+(-0.294859904583)+(-0.0312291891427)*0.5**o
        ref[1,1,1]=(0.340546237588)/(o+1.)+(0.108085159662)+(0.0675984132698)*0.5**o
        ref[2,0,0]=(-0.579618469996)/(o+1.)+(-0.470626235948)+(-0.146870758676)*0.5**o
        ref[2,0,1]=(-0.905841665338)/(o+1.)+(-0.195807094615)+(-0.3029068201)*0.5**o
        ref[2,1,0]=(0.0156822194106)/(o+1.)+(-0.260352320961)+(0.0547810600344)*0.5**o
        ref[2,1,1]=(-0.574499998403)/(o+1.)+(0.578972772902)+(0.12016647407)*0.5**o
        ref[3,0,0]=(-0.300272959749)/(o+1.)+(0.0205631064069)+(0.481811757276)*0.5**o
        ref[3,0,1]=(0.384658344075)/(o+1.)+(-0.507598017305)+(-0.347858576311)*0.5**o
        ref[3,1,0]=(-0.831384000346)/(o+1.)+(-0.148098706867)+(0.943559460135)*0.5**o
        ref[3,1,1]=(-0.946594221253)/(o+1.)+(-0.346457187158)+(-0.589903969401)*0.5**o
        ref[4,0,0]=(-0.392982812685)/(o+1.)+(0.678440639578)+(0.221077049797)*0.5**o
        ref[4,0,1]=(0.830655891827)/(o+1.)+(-0.362663943081)+(0.463121232737)*0.5**o
        ref[4,1,0]=(0.446730463706)/(o+1.)+(0.357719156977)+(0.925740559506)*0.5**o
        ref[4,1,1]=(0.134406853212)/(o+1.)+(0.212984538367)+(-0.777093674353)*0.5**o
        ref[5,0,0]=(0.0570788998709)/(o+1.)+(0.453630360793)+(-0.443943796359)*0.5**o
        ref[5,0,1]=(0.729222816543)/(o+1.)+(0.0519880094615)+(0.762962865085)*0.5**o
        ref[5,1,0]=(0.972145654544)/(o+1.)+(-0.122216166878)+(-0.915609563739)*0.5**o
        ref[5,1,1]=(-0.114606039743)/(o+1.)+(-0.709267631708)+(-0.486023356984)*0.5**o
      else:
        arg[0,0,0]=(0.455440122065)*x[0]**o+(0.911340571887)*x[0]+(0.158409397783)*x[1]**o+(0.353755257124)*x[1]+(-0.392556456322)*x[2]**o+(0.707232271095)*x[2]
        arg[0,0,1]=(-0.816405087957)*x[0]**o+(0.0691299991887)*x[0]+(0.178677657085)*x[1]**o+(0.526176369634)*x[1]+(-0.159459641444)*x[2]**o+(-0.197907778155)*x[2]
        arg[0,1,0]=(-0.463418217546)*x[0]**o+(-0.485835567862)*x[0]+(0.760458548482)*x[1]**o+(0.902873590314)*x[1]+(-0.760679635511)*x[2]**o+(-0.483163544794)*x[2]
        arg[0,1,1]=(0.743029549626)*x[0]**o+(-0.39131913217)*x[0]+(0.488809682734)*x[1]**o+(-0.256115251135)*x[1]+(0.0918611991036)*x[2]**o+(-0.281291060967)*x[2]
        arg[1,0,0]=(0.794367740289)*x[0]**o+(0.727663222288)*x[0]+(-0.631739003283)*x[1]**o+(0.733862609049)*x[1]+(-0.721230552103)*x[2]**o+(0.787774790111)*x[2]
        arg[1,0,1]=(0.505578181889)*x[0]**o+(0.616497234291)*x[0]+(-0.616903198005)*x[1]**o+(-0.355969913594)*x[1]+(0.0105854597103)*x[2]**o+(0.510273945857)*x[2]
        arg[1,1,0]=(0.35370601878)*x[0]**o+(-0.0414232536827)*x[0]+(0.0546619209334)*x[1]**o+(0.0459241421788)*x[1]+(0.796266758386)*x[2]**o+(0.303998757002)*x[2]
        arg[1,1,1]=(-0.245326163282)*x[0]**o+(0.0893045737315)*x[0]+(0.019401528413)*x[1]**o+(-0.838249399348)*x[1]+(0.510320088517)*x[2]**o+(0.544558918049)*x[2]
        arg[2,0,0]=(-0.660208039977)*x[0]**o+(-0.224874460802)*x[0]+(-0.0467836584153)*x[1]**o+(-0.463886703951)*x[1]+(-0.0951679104966)*x[2]**o+(-0.735787783779)*x[2]
        arg[2,0,1]=(-0.588259372806)*x[0]**o+(-0.18950606147)*x[0]+(-0.373439432467)*x[1]**o+(-0.116285718036)*x[1]+(-0.944687791765)*x[2]**o+(-0.243001707318)*x[2]
        arg[2,1,0]=(0.798498386971)*x[0]**o+(0.500125941024)*x[0]+(0.197339376576)*x[1]**o+(-0.068777545221)*x[1]+(0.36649695624)*x[2]**o+(0.193956440608)*x[2]
        arg[2,1,1]=(0.27501104189)*x[0]**o+(0.203066488761)*x[0]+(0.379278873515)*x[1]**o+(-0.789154057614)*x[1]+(0.893889499095)*x[2]**o+(0.867881975803)*x[2]
        arg[3,0,0]=(0.0579414247006)*x[0]**o+(0.661826954985)*x[0]+(0.313969775635)*x[1]**o+(-0.125420102972)*x[1]+(-0.808513922748)*x[2]**o+(0.0301073398588)*x[2]
        arg[3,0,1]=(-0.254544981247)*x[0]**o+(0.755983567644)*x[0]+(0.129524533092)*x[1]**o+(0.562828535682)*x[1]+(0.712881323083)*x[2]**o+(0.375450604678)*x[2]
        arg[3,1,0]=(-0.100221176995)*x[0]**o+(-0.470987646782)*x[0]+(-0.444245257427)*x[1]**o+(-0.0112626639353)*x[1]+(-0.516917833845)*x[2]**o+(-0.664158938756)*x[2]
        arg[3,1,1]=(0.259306174564)*x[0]**o+(0.367178744389)*x[0]+(0.177897569676)*x[1]**o+(-0.355724319562)*x[1]+(-0.809141944951)*x[2]**o+(0.962429694607)*x[2]
        arg[4,0,0]=(0.351990799011)*x[0]**o+(-0.41657457182)*x[0]+(-0.769748341564)*x[1]**o+(-0.856355494001)*x[1]+(-0.777902936204)*x[2]**o+(-0.388980567423)*x[2]
        arg[4,0,1]=(0.875307372684)*x[0]**o+(0.061375057221)*x[0]+(-0.262062525469)*x[1]**o+(0.0950324968281)*x[1]+(-0.145145751811)*x[2]**o+(-0.246872045818)*x[2]
        arg[4,1,0]=(0.115340652181)*x[0]**o+(0.910414483949)*x[0]+(0.347463744624)*x[1]**o+(0.399961393031)*x[1]+(0.0491863598064)*x[2]**o+(-0.992304094864)*x[2]
        arg[4,1,1]=(-0.125763267852)*x[0]**o+(0.485867057874)*x[0]+(-0.414172783931)*x[1]**o+(0.164145362806)*x[1]+(-0.488738184728)*x[2]**o+(-0.232758639076)*x[2]
        arg[5,0,0]=(-0.748184063441)*x[0]**o+(-0.252715593115)*x[0]+(0.688609235584)*x[1]**o+(0.0645665122312)*x[1]+(0.365465805991)*x[2]**o+(-0.217347848328)*x[2]
        arg[5,0,1]=(-0.298018437594)*x[0]**o+(-0.39683066279)*x[0]+(-0.0609074331294)*x[1]**o+(0.146930937933)*x[1]+(-0.00737018012329)*x[2]**o+(-0.700002160047)*x[2]
        arg[5,1,0]=(0.974781669859)*x[0]**o+(0.0634072121163)*x[0]+(0.0194044697894)*x[1]**o+(-0.919375545742)*x[1]+(-0.779806244021)*x[2]**o+(0.641761171945)*x[2]
        arg[5,1,1]=(0.485215976154)*x[0]**o+(0.879804212343)*x[0]+(-0.765170516406)*x[1]**o+(-0.205158612954)*x[1]+(-0.586708070331)*x[2]**o+(0.506670980992)*x[2]
        ref[0,0,0]=(-0.23414705854)/(o+1.)+(0.986164050053)+(0.455440122065)*0.5**o
        ref[0,0,1]=(0.0192180156412)/(o+1.)+(0.198699295334)+(-0.816405087957)*0.5**o
        ref[0,1,0]=(-0.000221087029094)/(o+1.)+(-0.0330627611712)+(-0.463418217546)*0.5**o
        ref[0,1,1]=(0.580670881837)/(o+1.)+(-0.464362722135)+(0.743029549626)*0.5**o
        ref[1,0,0]=(-1.35296955539)/(o+1.)+(1.12465031072)+(0.794367740289)*0.5**o
        ref[1,0,1]=(-0.606317738295)/(o+1.)+(0.385400633277)+(0.505578181889)*0.5**o
        ref[1,1,0]=(0.85092867932)/(o+1.)+(0.154249822749)+(0.35370601878)*0.5**o
        ref[1,1,1]=(0.52972161693)/(o+1.)+(-0.102192953784)+(-0.245326163282)*0.5**o
        ref[2,0,0]=(-0.141951568912)/(o+1.)+(-0.712274474266)+(-0.660208039977)*0.5**o
        ref[2,0,1]=(-1.31812722423)/(o+1.)+(-0.274396743412)+(-0.588259372806)*0.5**o
        ref[2,1,0]=(0.563836332815)/(o+1.)+(0.312652418205)+(0.798498386971)*0.5**o
        ref[2,1,1]=(1.27316837261)/(o+1.)+(0.140897203475)+(0.27501104189)*0.5**o
        ref[3,0,0]=(-0.494544147113)/(o+1.)+(0.283257095936)+(0.0579414247006)*0.5**o
        ref[3,0,1]=(0.842405856175)/(o+1.)+(0.847131354002)+(-0.254544981247)*0.5**o
        ref[3,1,0]=(-0.961163091272)/(o+1.)+(-0.573204624737)+(-0.100221176995)*0.5**o
        ref[3,1,1]=(-0.631244375275)/(o+1.)+(0.486942059717)+(0.259306174564)*0.5**o
        ref[4,0,0]=(-1.54765127777)/(o+1.)+(-0.830955316622)+(0.351990799011)*0.5**o
        ref[4,0,1]=(-0.407208277279)/(o+1.)+(-0.0452322458845)+(0.875307372684)*0.5**o
        ref[4,1,0]=(0.39665010443)/(o+1.)+(0.159035891058)+(0.115340652181)*0.5**o
        ref[4,1,1]=(-0.902910968659)/(o+1.)+(0.208626890802)+(-0.125763267852)*0.5**o
        ref[5,0,0]=(1.05407504158)/(o+1.)+(-0.202748464606)+(-0.748184063441)*0.5**o
        ref[5,0,1]=(-0.0682776132527)/(o+1.)+(-0.474950942452)+(-0.298018437594)*0.5**o
        ref[5,1,0]=(-0.760401774232)/(o+1.)+(-0.10710358084)+(0.974781669859)*0.5**o
        ref[5,1,1]=(-1.35187858674)/(o+1.)+(0.590658290191)+(0.485215976154)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromData_FunctionOnContactOne_rank4(self):
      """
      tests integral of rank 4 Data on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        arg[0,0,0,0]=(-0.177078428867)*x[0]**o+(0.338116995819)*x[0]+(-0.750823220445)*x[1]**o+(0.0630074420245)*x[1]
        arg[0,0,0,1]=(-0.682838671264)*x[0]**o+(-0.893797611147)*x[0]+(-0.0127659464437)*x[1]**o+(0.144120749888)*x[1]
        arg[0,0,1,0]=(0.352439319413)*x[0]**o+(0.380064866457)*x[0]+(-0.932452125435)*x[1]**o+(0.914519937443)*x[1]
        arg[0,0,1,1]=(-0.354033408023)*x[0]**o+(0.771069338542)*x[0]+(-0.702758889809)*x[1]**o+(-0.484485925087)*x[1]
        arg[0,0,2,0]=(0.706826713479)*x[0]**o+(0.0526230471775)*x[0]+(-0.535244256862)*x[1]**o+(-0.085929844746)*x[1]
        arg[0,0,2,1]=(-0.893497856528)*x[0]**o+(-0.892309840177)*x[0]+(0.742770093639)*x[1]**o+(0.987917060326)*x[1]
        arg[0,1,0,0]=(-0.536624329097)*x[0]**o+(-0.569536051343)*x[0]+(-0.7740511254)*x[1]**o+(0.873150177653)*x[1]
        arg[0,1,0,1]=(0.388396767346)*x[0]**o+(-0.902569510334)*x[0]+(0.196975646933)*x[1]**o+(0.184178333918)*x[1]
        arg[0,1,1,0]=(-0.125771297178)*x[0]**o+(-0.335093336446)*x[0]+(0.372752949038)*x[1]**o+(-0.883928748878)*x[1]
        arg[0,1,1,1]=(-0.313637256508)*x[0]**o+(-0.49607955109)*x[0]+(-0.726599229867)*x[1]**o+(0.360837115079)*x[1]
        arg[0,1,2,0]=(0.92425817047)*x[0]**o+(0.734728600171)*x[0]+(1.60583902129e-05)*x[1]**o+(-0.124600971339)*x[1]
        arg[0,1,2,1]=(-0.0981827607557)*x[0]**o+(-0.556005942436)*x[0]+(-0.888060617134)*x[1]**o+(0.857508807636)*x[1]
        arg[0,2,0,0]=(-0.871590768072)*x[0]**o+(-0.208546938841)*x[0]+(-0.228336105988)*x[1]**o+(0.444098195066)*x[1]
        arg[0,2,0,1]=(-0.628675127006)*x[0]**o+(0.834043549769)*x[0]+(-0.509662470381)*x[1]**o+(-0.801907226651)*x[1]
        arg[0,2,1,0]=(-0.767528433339)*x[0]**o+(0.305967685996)*x[0]+(-0.587902586916)*x[1]**o+(0.38652781193)*x[1]
        arg[0,2,1,1]=(0.388984380682)*x[0]**o+(0.490673256209)*x[0]+(-0.78470263647)*x[1]**o+(0.34909383158)*x[1]
        arg[0,2,2,0]=(-0.910514531543)*x[0]**o+(-0.418810366626)*x[0]+(-0.637159792471)*x[1]**o+(0.794653160897)*x[1]
        arg[0,2,2,1]=(0.570535552656)*x[0]**o+(-0.590385806831)*x[0]+(-0.298806908011)*x[1]**o+(-0.901531327347)*x[1]
        arg[0,3,0,0]=(0.916864925136)*x[0]**o+(-0.019733476459)*x[0]+(-0.91370863065)*x[1]**o+(0.291932128733)*x[1]
        arg[0,3,0,1]=(-0.851147484632)*x[0]**o+(-0.159304969602)*x[0]+(0.699832871063)*x[1]**o+(0.327932729929)*x[1]
        arg[0,3,1,0]=(0.461273862468)*x[0]**o+(0.40068516653)*x[0]+(0.0203170502559)*x[1]**o+(0.973716167207)*x[1]
        arg[0,3,1,1]=(0.63984877633)*x[0]**o+(0.580871491133)*x[0]+(-0.00587359808953)*x[1]**o+(-0.104805621161)*x[1]
        arg[0,3,2,0]=(-0.159416471436)*x[0]**o+(-0.585039922994)*x[0]+(0.689553978928)*x[1]**o+(0.569617375406)*x[1]
        arg[0,3,2,1]=(0.782397836312)*x[0]**o+(-0.581894025693)*x[0]+(0.0370277809126)*x[1]**o+(0.597309139432)*x[1]
        arg[0,4,0,0]=(-0.0063433205485)*x[0]**o+(-0.242291627085)*x[0]+(0.110218625254)*x[1]**o+(0.819656578408)*x[1]
        arg[0,4,0,1]=(-0.128215646666)*x[0]**o+(0.821312510893)*x[0]+(0.910723121611)*x[1]**o+(-0.0174623980585)*x[1]
        arg[0,4,1,0]=(-0.604528735513)*x[0]**o+(-0.358705990504)*x[0]+(-0.281954207008)*x[1]**o+(0.123469639952)*x[1]
        arg[0,4,1,1]=(0.65096807032)*x[0]**o+(0.882935341204)*x[0]+(-0.761226249914)*x[1]**o+(-0.830800218214)*x[1]
        arg[0,4,2,0]=(-0.710718948634)*x[0]**o+(0.452128874613)*x[0]+(-0.780671499903)*x[1]**o+(-0.942033435912)*x[1]
        arg[0,4,2,1]=(-0.0443187506467)*x[0]**o+(0.513943853321)*x[0]+(0.709902333411)*x[1]**o+(0.755430555318)*x[1]
        arg[1,0,0,0]=(0.731890221753)*x[0]**o+(-0.821835735249)*x[0]+(-0.713098084853)*x[1]**o+(0.875738077525)*x[1]
        arg[1,0,0,1]=(-0.130335125365)*x[0]**o+(0.580579210083)*x[0]+(-0.427105331069)*x[1]**o+(0.0435798068353)*x[1]
        arg[1,0,1,0]=(-0.203908509107)*x[0]**o+(-0.941974700448)*x[0]+(0.344459670502)*x[1]**o+(0.758336135081)*x[1]
        arg[1,0,1,1]=(0.186770929724)*x[0]**o+(0.348332058705)*x[0]+(-0.0683630778679)*x[1]**o+(0.480425212189)*x[1]
        arg[1,0,2,0]=(-0.891275312975)*x[0]**o+(0.260630881729)*x[0]+(0.127955472707)*x[1]**o+(-0.554992279729)*x[1]
        arg[1,0,2,1]=(-0.74620344519)*x[0]**o+(0.944025669845)*x[0]+(-0.052031562679)*x[1]**o+(0.966060927262)*x[1]
        arg[1,1,0,0]=(0.871423198418)*x[0]**o+(-0.0769723128617)*x[0]+(0.783714758356)*x[1]**o+(0.530209967997)*x[1]
        arg[1,1,0,1]=(0.943197824902)*x[0]**o+(-0.62624855429)*x[0]+(-0.00888785913795)*x[1]**o+(-0.0408857497082)*x[1]
        arg[1,1,1,0]=(-0.74971981056)*x[0]**o+(0.925175163834)*x[0]+(0.481063204532)*x[1]**o+(-0.476700447185)*x[1]
        arg[1,1,1,1]=(-0.431776603043)*x[0]**o+(-0.495358165507)*x[0]+(-0.0110588803484)*x[1]**o+(-0.575147325496)*x[1]
        arg[1,1,2,0]=(0.578105297721)*x[0]**o+(-0.88169100464)*x[0]+(-0.646224518073)*x[1]**o+(0.465619837803)*x[1]
        arg[1,1,2,1]=(0.442066689582)*x[0]**o+(0.0937839719519)*x[0]+(-0.101534585934)*x[1]**o+(-0.974003442605)*x[1]
        arg[1,2,0,0]=(-0.206702379228)*x[0]**o+(0.330161049866)*x[0]+(0.185493587693)*x[1]**o+(0.0391986992855)*x[1]
        arg[1,2,0,1]=(0.79092697362)*x[0]**o+(0.692054695304)*x[0]+(0.141622971369)*x[1]**o+(0.643869474153)*x[1]
        arg[1,2,1,0]=(0.914281902407)*x[0]**o+(0.936365302055)*x[0]+(0.249095964198)*x[1]**o+(-0.440892551355)*x[1]
        arg[1,2,1,1]=(-0.602926709108)*x[0]**o+(0.817198874641)*x[0]+(0.262528290838)*x[1]**o+(0.493607450371)*x[1]
        arg[1,2,2,0]=(-0.724435531493)*x[0]**o+(-0.455127093687)*x[0]+(0.144972402754)*x[1]**o+(-0.361255031527)*x[1]
        arg[1,2,2,1]=(-0.611538590545)*x[0]**o+(-0.780730652602)*x[0]+(-0.150439352532)*x[1]**o+(0.450875229163)*x[1]
        arg[1,3,0,0]=(-0.913553947133)*x[0]**o+(-0.930172924067)*x[0]+(-0.509426399026)*x[1]**o+(0.3953360754)*x[1]
        arg[1,3,0,1]=(-0.709834132519)*x[0]**o+(0.972632526254)*x[0]+(0.540358729462)*x[1]**o+(-0.0295254269136)*x[1]
        arg[1,3,1,0]=(-0.30788139278)*x[0]**o+(-0.362561853154)*x[0]+(0.0135015706177)*x[1]**o+(0.558034983013)*x[1]
        arg[1,3,1,1]=(-0.243327801257)*x[0]**o+(-0.156242539226)*x[0]+(0.076082439418)*x[1]**o+(0.818613998695)*x[1]
        arg[1,3,2,0]=(-0.0290765899224)*x[0]**o+(-0.108604693002)*x[0]+(-0.0741034599215)*x[1]**o+(0.44467098076)*x[1]
        arg[1,3,2,1]=(-0.751374584848)*x[0]**o+(0.568700665267)*x[0]+(-0.431665912498)*x[1]**o+(0.881337230634)*x[1]
        arg[1,4,0,0]=(-0.940864464113)*x[0]**o+(-0.204392585977)*x[0]+(-0.872729326815)*x[1]**o+(0.454069061239)*x[1]
        arg[1,4,0,1]=(0.620544898911)*x[0]**o+(-0.194050689442)*x[0]+(0.399921161647)*x[1]**o+(0.812456444893)*x[1]
        arg[1,4,1,0]=(-0.398096053023)*x[0]**o+(-0.521802671926)*x[0]+(-0.525522030503)*x[1]**o+(-0.795276120062)*x[1]
        arg[1,4,1,1]=(0.277239330261)*x[0]**o+(-0.376159942175)*x[0]+(0.785902674573)*x[1]**o+(-0.00686958652716)*x[1]
        arg[1,4,2,0]=(-0.469242672532)*x[0]**o+(0.289432797089)*x[0]+(0.728305062026)*x[1]**o+(0.821761742668)*x[1]
        arg[1,4,2,1]=(0.828113301834)*x[0]**o+(-0.149301261166)*x[0]+(0.279230829643)*x[1]**o+(-0.971944918618)*x[1]
        arg[2,0,0,0]=(-0.724500208669)*x[0]**o+(-0.761179166402)*x[0]+(0.302409732402)*x[1]**o+(0.509101646177)*x[1]
        arg[2,0,0,1]=(-0.133300605917)*x[0]**o+(-0.0299057843108)*x[0]+(0.190028790905)*x[1]**o+(-0.668097775221)*x[1]
        arg[2,0,1,0]=(0.828019154028)*x[0]**o+(-0.446721913762)*x[0]+(0.745204383075)*x[1]**o+(0.363968853359)*x[1]
        arg[2,0,1,1]=(-0.653962912288)*x[0]**o+(0.753529804971)*x[0]+(-0.104712073949)*x[1]**o+(-0.44152589042)*x[1]
        arg[2,0,2,0]=(0.21572653818)*x[0]**o+(-0.553685840495)*x[0]+(0.372296357092)*x[1]**o+(-0.23566755183)*x[1]
        arg[2,0,2,1]=(-0.0943992743407)*x[0]**o+(0.677836956763)*x[0]+(-0.33055202826)*x[1]**o+(0.444414877097)*x[1]
        arg[2,1,0,0]=(-0.812500024009)*x[0]**o+(0.4856670967)*x[0]+(-0.891481528328)*x[1]**o+(-0.244043957515)*x[1]
        arg[2,1,0,1]=(-0.958152880518)*x[0]**o+(0.494470945352)*x[0]+(-0.000696143847979)*x[1]**o+(-0.036680781152)*x[1]
        arg[2,1,1,0]=(-0.81109120479)*x[0]**o+(-0.929246624754)*x[0]+(0.128356074186)*x[1]**o+(0.0107006959497)*x[1]
        arg[2,1,1,1]=(-0.72470858095)*x[0]**o+(-0.202254265463)*x[0]+(-0.995176229907)*x[1]**o+(-0.752592973024)*x[1]
        arg[2,1,2,0]=(-0.191810147267)*x[0]**o+(-0.819397723879)*x[0]+(0.306860971474)*x[1]**o+(0.681274705052)*x[1]
        arg[2,1,2,1]=(-0.867447323913)*x[0]**o+(-0.279148200325)*x[0]+(-0.195907590382)*x[1]**o+(-0.305826952304)*x[1]
        arg[2,2,0,0]=(0.983782298896)*x[0]**o+(-0.284064487432)*x[0]+(-0.0928333646602)*x[1]**o+(-0.929708520581)*x[1]
        arg[2,2,0,1]=(0.121619221979)*x[0]**o+(-0.876309915691)*x[0]+(0.455030678927)*x[1]**o+(0.635763125356)*x[1]
        arg[2,2,1,0]=(0.378726440151)*x[0]**o+(-0.626329947078)*x[0]+(-0.0239503446136)*x[1]**o+(0.32696940295)*x[1]
        arg[2,2,1,1]=(0.442586981104)*x[0]**o+(-0.427714534417)*x[0]+(0.906235883406)*x[1]**o+(0.819595435756)*x[1]
        arg[2,2,2,0]=(-0.564560890159)*x[0]**o+(-0.115075498726)*x[0]+(-0.520596320159)*x[1]**o+(-0.368366112222)*x[1]
        arg[2,2,2,1]=(0.215858165597)*x[0]**o+(-0.575665537635)*x[0]+(0.792289256264)*x[1]**o+(0.215575294284)*x[1]
        arg[2,3,0,0]=(-0.596335978041)*x[0]**o+(-0.677983108509)*x[0]+(-0.551360906631)*x[1]**o+(-0.874453959198)*x[1]
        arg[2,3,0,1]=(-0.913806992124)*x[0]**o+(0.192343143898)*x[0]+(0.821070238869)*x[1]**o+(-0.188359117641)*x[1]
        arg[2,3,1,0]=(-0.0831972104302)*x[0]**o+(-0.927005811846)*x[0]+(-0.43240265235)*x[1]**o+(-0.144332400422)*x[1]
        arg[2,3,1,1]=(0.643878326697)*x[0]**o+(0.212328499471)*x[0]+(0.72072318435)*x[1]**o+(-0.146144387035)*x[1]
        arg[2,3,2,0]=(0.843652876743)*x[0]**o+(-0.0386075132797)*x[0]+(0.754511827443)*x[1]**o+(-0.26945353599)*x[1]
        arg[2,3,2,1]=(0.0413857115672)*x[0]**o+(0.682727309008)*x[0]+(0.261249117327)*x[1]**o+(-0.753970539308)*x[1]
        arg[2,4,0,0]=(-0.607477693828)*x[0]**o+(-0.5870344058)*x[0]+(-0.0678823396451)*x[1]**o+(0.201869223616)*x[1]
        arg[2,4,0,1]=(-0.618172945146)*x[0]**o+(0.685084114438)*x[0]+(0.0457149578306)*x[1]**o+(-0.877971038996)*x[1]
        arg[2,4,1,0]=(0.722668769621)*x[0]**o+(0.302142466253)*x[0]+(0.630735604709)*x[1]**o+(-0.427754766567)*x[1]
        arg[2,4,1,1]=(-0.847113860795)*x[0]**o+(-0.779747246887)*x[0]+(-0.693659242703)*x[1]**o+(0.897451884568)*x[1]
        arg[2,4,2,0]=(-0.437578500878)*x[0]**o+(0.399407036331)*x[0]+(0.705207362097)*x[1]**o+(-0.271060427211)*x[1]
        arg[2,4,2,1]=(0.329570005179)*x[0]**o+(-0.712089906899)*x[0]+(0.860707329294)*x[1]**o+(0.553218273352)*x[1]
        arg[3,0,0,0]=(0.932602317046)*x[0]**o+(-0.948445141026)*x[0]+(0.549409370786)*x[1]**o+(0.782964260926)*x[1]
        arg[3,0,0,1]=(0.975116319103)*x[0]**o+(-0.0131313829738)*x[0]+(0.222376331882)*x[1]**o+(0.545375534163)*x[1]
        arg[3,0,1,0]=(0.019317277942)*x[0]**o+(0.918003018679)*x[0]+(-0.481194397466)*x[1]**o+(0.762780571026)*x[1]
        arg[3,0,1,1]=(-0.393162543578)*x[0]**o+(0.984304464298)*x[0]+(0.737901448601)*x[1]**o+(-0.890589811376)*x[1]
        arg[3,0,2,0]=(0.458096711279)*x[0]**o+(0.0343270226524)*x[0]+(0.278242150139)*x[1]**o+(-0.158378755134)*x[1]
        arg[3,0,2,1]=(0.307111052767)*x[0]**o+(-0.294724312785)*x[0]+(-0.489134379327)*x[1]**o+(-0.211139185303)*x[1]
        arg[3,1,0,0]=(0.420707084879)*x[0]**o+(-0.998173294986)*x[0]+(0.508808683)*x[1]**o+(-0.189902487212)*x[1]
        arg[3,1,0,1]=(-0.745253594401)*x[0]**o+(-0.344809947215)*x[0]+(0.198212694401)*x[1]**o+(-0.125428245606)*x[1]
        arg[3,1,1,0]=(0.535215252931)*x[0]**o+(0.565625295858)*x[0]+(-0.0741524230667)*x[1]**o+(-0.898600294889)*x[1]
        arg[3,1,1,1]=(0.193417593556)*x[0]**o+(-0.80053921694)*x[0]+(-0.664372557476)*x[1]**o+(0.47786060257)*x[1]
        arg[3,1,2,0]=(0.553690237434)*x[0]**o+(0.970763166888)*x[0]+(0.408815221365)*x[1]**o+(0.143175119269)*x[1]
        arg[3,1,2,1]=(-0.211683249218)*x[0]**o+(0.0643055656631)*x[0]+(-0.111028404397)*x[1]**o+(0.506093872018)*x[1]
        arg[3,2,0,0]=(-0.866119051438)*x[0]**o+(-0.417310807983)*x[0]+(-0.228385234131)*x[1]**o+(0.554977378653)*x[1]
        arg[3,2,0,1]=(-0.146618266885)*x[0]**o+(0.817733306502)*x[0]+(-0.709059272627)*x[1]**o+(-0.271140815458)*x[1]
        arg[3,2,1,0]=(0.622973500199)*x[0]**o+(-0.568858605993)*x[0]+(-0.651609755171)*x[1]**o+(-0.866184190672)*x[1]
        arg[3,2,1,1]=(-0.538565077894)*x[0]**o+(-0.676237465393)*x[0]+(0.106659392436)*x[1]**o+(0.488735158765)*x[1]
        arg[3,2,2,0]=(-0.325897413686)*x[0]**o+(0.99502293321)*x[0]+(-0.339096900793)*x[1]**o+(0.238083096263)*x[1]
        arg[3,2,2,1]=(0.861430484293)*x[0]**o+(-0.761739126386)*x[0]+(-0.10651751912)*x[1]**o+(0.688993400068)*x[1]
        arg[3,3,0,0]=(0.0890838652267)*x[0]**o+(0.151733228604)*x[0]+(0.230063809846)*x[1]**o+(-0.135041740614)*x[1]
        arg[3,3,0,1]=(-0.969251937403)*x[0]**o+(0.345709865473)*x[0]+(-0.309971427898)*x[1]**o+(-0.262217856737)*x[1]
        arg[3,3,1,0]=(0.640075232231)*x[0]**o+(-0.00817560718155)*x[0]+(0.55773788655)*x[1]**o+(0.642205213407)*x[1]
        arg[3,3,1,1]=(-0.350002630494)*x[0]**o+(0.373270925939)*x[0]+(-0.655757122598)*x[1]**o+(-0.74598967873)*x[1]
        arg[3,3,2,0]=(-0.262399316954)*x[0]**o+(-0.37991094527)*x[0]+(0.310310045807)*x[1]**o+(0.838942372822)*x[1]
        arg[3,3,2,1]=(-0.977039760257)*x[0]**o+(-0.0804751651971)*x[0]+(-0.844329846245)*x[1]**o+(0.905827257908)*x[1]
        arg[3,4,0,0]=(0.749594099085)*x[0]**o+(0.382880202285)*x[0]+(0.39699250956)*x[1]**o+(-0.708672318437)*x[1]
        arg[3,4,0,1]=(0.913703789336)*x[0]**o+(-0.497792024208)*x[0]+(-0.34125011876)*x[1]**o+(-0.657159430634)*x[1]
        arg[3,4,1,0]=(-0.397439923687)*x[0]**o+(0.595274583577)*x[0]+(-0.292338728991)*x[1]**o+(-0.314101057271)*x[1]
        arg[3,4,1,1]=(-0.403584993513)*x[0]**o+(-0.758728905384)*x[0]+(-0.182501473325)*x[1]**o+(-0.0942108622967)*x[1]
        arg[3,4,2,0]=(-0.263608698751)*x[0]**o+(-0.591451983536)*x[0]+(0.620412677389)*x[1]**o+(0.600005456466)*x[1]
        arg[3,4,2,1]=(-0.633502278259)*x[0]**o+(0.733127573934)*x[0]+(-0.765468966987)*x[1]**o+(-0.24211874772)*x[1]
        ref[0,0,0,0]=(-0.750823220445)/(o+1.)+(0.200562218922)+(-0.177078428867)*0.5**o
        ref[0,0,0,1]=(-0.0127659464437)/(o+1.)+(-0.374838430629)+(-0.682838671264)*0.5**o
        ref[0,0,1,0]=(-0.932452125435)/(o+1.)+(0.64729240195)+(0.352439319413)*0.5**o
        ref[0,0,1,1]=(-0.702758889809)/(o+1.)+(0.143291706728)+(-0.354033408023)*0.5**o
        ref[0,0,2,0]=(-0.535244256862)/(o+1.)+(-0.0166533987843)+(0.706826713479)*0.5**o
        ref[0,0,2,1]=(0.742770093639)/(o+1.)+(0.0478036100749)+(-0.893497856528)*0.5**o
        ref[0,1,0,0]=(-0.7740511254)/(o+1.)+(0.151807063155)+(-0.536624329097)*0.5**o
        ref[0,1,0,1]=(0.196975646933)/(o+1.)+(-0.359195588208)+(0.388396767346)*0.5**o
        ref[0,1,1,0]=(0.372752949038)/(o+1.)+(-0.609511042662)+(-0.125771297178)*0.5**o
        ref[0,1,1,1]=(-0.726599229867)/(o+1.)+(-0.0676212180057)+(-0.313637256508)*0.5**o
        ref[0,1,2,0]=(1.60583902129e-05)/(o+1.)+(0.305063814416)+(0.92425817047)*0.5**o
        ref[0,1,2,1]=(-0.888060617134)/(o+1.)+(0.1507514326)+(-0.0981827607557)*0.5**o
        ref[0,2,0,0]=(-0.228336105988)/(o+1.)+(0.117775628113)+(-0.871590768072)*0.5**o
        ref[0,2,0,1]=(-0.509662470381)/(o+1.)+(0.0160681615592)+(-0.628675127006)*0.5**o
        ref[0,2,1,0]=(-0.587902586916)/(o+1.)+(0.346247748963)+(-0.767528433339)*0.5**o
        ref[0,2,1,1]=(-0.78470263647)/(o+1.)+(0.419883543895)+(0.388984380682)*0.5**o
        ref[0,2,2,0]=(-0.637159792471)/(o+1.)+(0.187921397135)+(-0.910514531543)*0.5**o
        ref[0,2,2,1]=(-0.298806908011)/(o+1.)+(-0.745958567089)+(0.570535552656)*0.5**o
        ref[0,3,0,0]=(-0.91370863065)/(o+1.)+(0.136099326137)+(0.916864925136)*0.5**o
        ref[0,3,0,1]=(0.699832871063)/(o+1.)+(0.0843138801635)+(-0.851147484632)*0.5**o
        ref[0,3,1,0]=(0.0203170502559)/(o+1.)+(0.687200666868)+(0.461273862468)*0.5**o
        ref[0,3,1,1]=(-0.00587359808953)/(o+1.)+(0.238032934986)+(0.63984877633)*0.5**o
        ref[0,3,2,0]=(0.689553978928)/(o+1.)+(-0.00771127379434)+(-0.159416471436)*0.5**o
        ref[0,3,2,1]=(0.0370277809126)/(o+1.)+(0.00770755686953)+(0.782397836312)*0.5**o
        ref[0,4,0,0]=(0.110218625254)/(o+1.)+(0.288682475662)+(-0.0063433205485)*0.5**o
        ref[0,4,0,1]=(0.910723121611)/(o+1.)+(0.401925056417)+(-0.128215646666)*0.5**o
        ref[0,4,1,0]=(-0.281954207008)/(o+1.)+(-0.117618175276)+(-0.604528735513)*0.5**o
        ref[0,4,1,1]=(-0.761226249914)/(o+1.)+(0.0260675614951)+(0.65096807032)*0.5**o
        ref[0,4,2,0]=(-0.780671499903)/(o+1.)+(-0.244952280649)+(-0.710718948634)*0.5**o
        ref[0,4,2,1]=(0.709902333411)/(o+1.)+(0.63468720432)+(-0.0443187506467)*0.5**o
        ref[1,0,0,0]=(-0.713098084853)/(o+1.)+(0.026951171138)+(0.731890221753)*0.5**o
        ref[1,0,0,1]=(-0.427105331069)/(o+1.)+(0.312079508459)+(-0.130335125365)*0.5**o
        ref[1,0,1,0]=(0.344459670502)/(o+1.)+(-0.0918192826838)+(-0.203908509107)*0.5**o
        ref[1,0,1,1]=(-0.0683630778679)/(o+1.)+(0.414378635447)+(0.186770929724)*0.5**o
        ref[1,0,2,0]=(0.127955472707)/(o+1.)+(-0.147180699)+(-0.891275312975)*0.5**o
        ref[1,0,2,1]=(-0.052031562679)/(o+1.)+(0.955043298554)+(-0.74620344519)*0.5**o
        ref[1,1,0,0]=(0.783714758356)/(o+1.)+(0.226618827568)+(0.871423198418)*0.5**o
        ref[1,1,0,1]=(-0.00888785913795)/(o+1.)+(-0.333567151999)+(0.943197824902)*0.5**o
        ref[1,1,1,0]=(0.481063204532)/(o+1.)+(0.224237358325)+(-0.74971981056)*0.5**o
        ref[1,1,1,1]=(-0.0110588803484)/(o+1.)+(-0.535252745501)+(-0.431776603043)*0.5**o
        ref[1,1,2,0]=(-0.646224518073)/(o+1.)+(-0.208035583419)+(0.578105297721)*0.5**o
        ref[1,1,2,1]=(-0.101534585934)/(o+1.)+(-0.440109735326)+(0.442066689582)*0.5**o
        ref[1,2,0,0]=(0.185493587693)/(o+1.)+(0.184679874576)+(-0.206702379228)*0.5**o
        ref[1,2,0,1]=(0.141622971369)/(o+1.)+(0.667962084728)+(0.79092697362)*0.5**o
        ref[1,2,1,0]=(0.249095964198)/(o+1.)+(0.24773637535)+(0.914281902407)*0.5**o
        ref[1,2,1,1]=(0.262528290838)/(o+1.)+(0.655403162506)+(-0.602926709108)*0.5**o
        ref[1,2,2,0]=(0.144972402754)/(o+1.)+(-0.408191062607)+(-0.724435531493)*0.5**o
        ref[1,2,2,1]=(-0.150439352532)/(o+1.)+(-0.16492771172)+(-0.611538590545)*0.5**o
        ref[1,3,0,0]=(-0.509426399026)/(o+1.)+(-0.267418424334)+(-0.913553947133)*0.5**o
        ref[1,3,0,1]=(0.540358729462)/(o+1.)+(0.47155354967)+(-0.709834132519)*0.5**o
        ref[1,3,1,0]=(0.0135015706177)/(o+1.)+(0.0977365649293)+(-0.30788139278)*0.5**o
        ref[1,3,1,1]=(0.076082439418)/(o+1.)+(0.331185729735)+(-0.243327801257)*0.5**o
        ref[1,3,2,0]=(-0.0741034599215)/(o+1.)+(0.168033143879)+(-0.0290765899224)*0.5**o
        ref[1,3,2,1]=(-0.431665912498)/(o+1.)+(0.72501894795)+(-0.751374584848)*0.5**o
        ref[1,4,0,0]=(-0.872729326815)/(o+1.)+(0.124838237631)+(-0.940864464113)*0.5**o
        ref[1,4,0,1]=(0.399921161647)/(o+1.)+(0.309202877726)+(0.620544898911)*0.5**o
        ref[1,4,1,0]=(-0.525522030503)/(o+1.)+(-0.658539395994)+(-0.398096053023)*0.5**o
        ref[1,4,1,1]=(0.785902674573)/(o+1.)+(-0.191514764351)+(0.277239330261)*0.5**o
        ref[1,4,2,0]=(0.728305062026)/(o+1.)+(0.555597269878)+(-0.469242672532)*0.5**o
        ref[1,4,2,1]=(0.279230829643)/(o+1.)+(-0.560623089892)+(0.828113301834)*0.5**o
        ref[2,0,0,0]=(0.302409732402)/(o+1.)+(-0.126038760113)+(-0.724500208669)*0.5**o
        ref[2,0,0,1]=(0.190028790905)/(o+1.)+(-0.349001779766)+(-0.133300605917)*0.5**o
        ref[2,0,1,0]=(0.745204383075)/(o+1.)+(-0.0413765302013)+(0.828019154028)*0.5**o
        ref[2,0,1,1]=(-0.104712073949)/(o+1.)+(0.156001957276)+(-0.653962912288)*0.5**o
        ref[2,0,2,0]=(0.372296357092)/(o+1.)+(-0.394676696163)+(0.21572653818)*0.5**o
        ref[2,0,2,1]=(-0.33055202826)/(o+1.)+(0.56112591693)+(-0.0943992743407)*0.5**o
        ref[2,1,0,0]=(-0.891481528328)/(o+1.)+(0.120811569592)+(-0.812500024009)*0.5**o
        ref[2,1,0,1]=(-0.000696143847979)/(o+1.)+(0.2288950821)+(-0.958152880518)*0.5**o
        ref[2,1,1,0]=(0.128356074186)/(o+1.)+(-0.459272964402)+(-0.81109120479)*0.5**o
        ref[2,1,1,1]=(-0.995176229907)/(o+1.)+(-0.477423619244)+(-0.72470858095)*0.5**o
        ref[2,1,2,0]=(0.306860971474)/(o+1.)+(-0.0690615094134)+(-0.191810147267)*0.5**o
        ref[2,1,2,1]=(-0.195907590382)/(o+1.)+(-0.292487576314)+(-0.867447323913)*0.5**o
        ref[2,2,0,0]=(-0.0928333646602)/(o+1.)+(-0.606886504006)+(0.983782298896)*0.5**o
        ref[2,2,0,1]=(0.455030678927)/(o+1.)+(-0.120273395167)+(0.121619221979)*0.5**o
        ref[2,2,1,0]=(-0.0239503446136)/(o+1.)+(-0.149680272064)+(0.378726440151)*0.5**o
        ref[2,2,1,1]=(0.906235883406)/(o+1.)+(0.19594045067)+(0.442586981104)*0.5**o
        ref[2,2,2,0]=(-0.520596320159)/(o+1.)+(-0.241720805474)+(-0.564560890159)*0.5**o
        ref[2,2,2,1]=(0.792289256264)/(o+1.)+(-0.180045121676)+(0.215858165597)*0.5**o
        ref[2,3,0,0]=(-0.551360906631)/(o+1.)+(-0.776218533854)+(-0.596335978041)*0.5**o
        ref[2,3,0,1]=(0.821070238869)/(o+1.)+(0.00199201312847)+(-0.913806992124)*0.5**o
        ref[2,3,1,0]=(-0.43240265235)/(o+1.)+(-0.535669106134)+(-0.0831972104302)*0.5**o
        ref[2,3,1,1]=(0.72072318435)/(o+1.)+(0.0330920562179)+(0.643878326697)*0.5**o
        ref[2,3,2,0]=(0.754511827443)/(o+1.)+(-0.154030524635)+(0.843652876743)*0.5**o
        ref[2,3,2,1]=(0.261249117327)/(o+1.)+(-0.03562161515)+(0.0413857115672)*0.5**o
        ref[2,4,0,0]=(-0.0678823396451)/(o+1.)+(-0.192582591092)+(-0.607477693828)*0.5**o
        ref[2,4,0,1]=(0.0457149578306)/(o+1.)+(-0.0964434622791)+(-0.618172945146)*0.5**o
        ref[2,4,1,0]=(0.630735604709)/(o+1.)+(-0.0628061501569)+(0.722668769621)*0.5**o
        ref[2,4,1,1]=(-0.693659242703)/(o+1.)+(0.0588523188405)+(-0.847113860795)*0.5**o
        ref[2,4,2,0]=(0.705207362097)/(o+1.)+(0.0641733045603)+(-0.437578500878)*0.5**o
        ref[2,4,2,1]=(0.860707329294)/(o+1.)+(-0.0794358167735)+(0.329570005179)*0.5**o
        ref[3,0,0,0]=(0.549409370786)/(o+1.)+(-0.0827404400499)+(0.932602317046)*0.5**o
        ref[3,0,0,1]=(0.222376331882)/(o+1.)+(0.266122075595)+(0.975116319103)*0.5**o
        ref[3,0,1,0]=(-0.481194397466)/(o+1.)+(0.840391794852)+(0.019317277942)*0.5**o
        ref[3,0,1,1]=(0.737901448601)/(o+1.)+(0.0468573264614)+(-0.393162543578)*0.5**o
        ref[3,0,2,0]=(0.278242150139)/(o+1.)+(-0.0620258662406)+(0.458096711279)*0.5**o
        ref[3,0,2,1]=(-0.489134379327)/(o+1.)+(-0.252931749044)+(0.307111052767)*0.5**o
        ref[3,1,0,0]=(0.508808683)/(o+1.)+(-0.594037891099)+(0.420707084879)*0.5**o
        ref[3,1,0,1]=(0.198212694401)/(o+1.)+(-0.23511909641)+(-0.745253594401)*0.5**o
        ref[3,1,1,0]=(-0.0741524230667)/(o+1.)+(-0.166487499516)+(0.535215252931)*0.5**o
        ref[3,1,1,1]=(-0.664372557476)/(o+1.)+(-0.161339307185)+(0.193417593556)*0.5**o
        ref[3,1,2,0]=(0.408815221365)/(o+1.)+(0.556969143078)+(0.553690237434)*0.5**o
        ref[3,1,2,1]=(-0.111028404397)/(o+1.)+(0.28519971884)+(-0.211683249218)*0.5**o
        ref[3,2,0,0]=(-0.228385234131)/(o+1.)+(0.068833285335)+(-0.866119051438)*0.5**o
        ref[3,2,0,1]=(-0.709059272627)/(o+1.)+(0.273296245522)+(-0.146618266885)*0.5**o
        ref[3,2,1,0]=(-0.651609755171)/(o+1.)+(-0.717521398332)+(0.622973500199)*0.5**o
        ref[3,2,1,1]=(0.106659392436)/(o+1.)+(-0.0937511533137)+(-0.538565077894)*0.5**o
        ref[3,2,2,0]=(-0.339096900793)/(o+1.)+(0.616553014737)+(-0.325897413686)*0.5**o
        ref[3,2,2,1]=(-0.10651751912)/(o+1.)+(-0.0363728631586)+(0.861430484293)*0.5**o
        ref[3,3,0,0]=(0.230063809846)/(o+1.)+(0.0083457439947)+(0.0890838652267)*0.5**o
        ref[3,3,0,1]=(-0.309971427898)/(o+1.)+(0.0417460043682)+(-0.969251937403)*0.5**o
        ref[3,3,1,0]=(0.55773788655)/(o+1.)+(0.317014803113)+(0.640075232231)*0.5**o
        ref[3,3,1,1]=(-0.655757122598)/(o+1.)+(-0.186359376395)+(-0.350002630494)*0.5**o
        ref[3,3,2,0]=(0.310310045807)/(o+1.)+(0.229515713776)+(-0.262399316954)*0.5**o
        ref[3,3,2,1]=(-0.844329846245)/(o+1.)+(0.412676046356)+(-0.977039760257)*0.5**o
        ref[3,4,0,0]=(0.39699250956)/(o+1.)+(-0.162896058076)+(0.749594099085)*0.5**o
        ref[3,4,0,1]=(-0.34125011876)/(o+1.)+(-0.577475727421)+(0.913703789336)*0.5**o
        ref[3,4,1,0]=(-0.292338728991)/(o+1.)+(0.140586763153)+(-0.397439923687)*0.5**o
        ref[3,4,1,1]=(-0.182501473325)/(o+1.)+(-0.42646988384)+(-0.403584993513)*0.5**o
        ref[3,4,2,0]=(0.620412677389)/(o+1.)+(0.00427673646471)+(-0.263608698751)*0.5**o
        ref[3,4,2,1]=(-0.765468966987)/(o+1.)+(0.245504413107)+(-0.633502278259)*0.5**o
      else:
        arg[0,0,0,0]=(0.480896043196)*x[0]**o+(0.113355160927)*x[0]+(0.498630339771)*x[1]**o+(0.0149514785179)*x[1]+(-0.944439525708)*x[2]**o+(-0.349299625744)*x[2]
        arg[0,0,0,1]=(-0.609632888023)*x[0]**o+(-0.576508904483)*x[0]+(-0.0610487008887)*x[1]**o+(-0.844087384492)*x[1]+(-0.715427733517)*x[2]**o+(-0.263424969452)*x[2]
        arg[0,0,1,0]=(0.205065167181)*x[0]**o+(-0.840225514826)*x[0]+(0.808161497555)*x[1]**o+(0.685902712814)*x[1]+(-0.625183952417)*x[2]**o+(-0.0947932775112)*x[2]
        arg[0,0,1,1]=(0.875716461075)*x[0]**o+(0.814425331995)*x[0]+(-0.805331622235)*x[1]**o+(-0.287737068993)*x[1]+(-0.365715978159)*x[2]**o+(0.689907502778)*x[2]
        arg[0,0,2,0]=(0.711372030289)*x[0]**o+(-0.393612062405)*x[0]+(0.642793863702)*x[1]**o+(-0.66636178423)*x[1]+(0.00488425355017)*x[2]**o+(-0.444523817626)*x[2]
        arg[0,0,2,1]=(-0.0536842545617)*x[0]**o+(-0.714279418499)*x[0]+(-0.487452457649)*x[1]**o+(0.917805820162)*x[1]+(0.445007135027)*x[2]**o+(0.101201310289)*x[2]
        arg[0,1,0,0]=(-0.710091748251)*x[0]**o+(0.470243562863)*x[0]+(-0.0178862343634)*x[1]**o+(0.393644042332)*x[1]+(-0.952839337577)*x[2]**o+(-0.152392013939)*x[2]
        arg[0,1,0,1]=(0.250989366649)*x[0]**o+(0.592158236555)*x[0]+(0.698185234877)*x[1]**o+(0.112154263635)*x[1]+(0.843915127813)*x[2]**o+(-0.825331842242)*x[2]
        arg[0,1,1,0]=(0.690360096543)*x[0]**o+(0.78906430602)*x[0]+(0.596189773531)*x[1]**o+(-0.293452572358)*x[1]+(0.737565980909)*x[2]**o+(-0.96988090057)*x[2]
        arg[0,1,1,1]=(-0.815220933301)*x[0]**o+(-0.875224889387)*x[0]+(-0.0562950344908)*x[1]**o+(0.56567431969)*x[1]+(0.133489969036)*x[2]**o+(0.299403989148)*x[2]
        arg[0,1,2,0]=(0.169442617085)*x[0]**o+(-0.413300800662)*x[0]+(0.580773652363)*x[1]**o+(-0.627706012397)*x[1]+(-0.730218498677)*x[2]**o+(0.587233195345)*x[2]
        arg[0,1,2,1]=(-0.110636656112)*x[0]**o+(-0.302213944624)*x[0]+(0.643229732019)*x[1]**o+(-0.651805494828)*x[1]+(-0.528276901455)*x[2]**o+(-0.272057635286)*x[2]
        arg[0,2,0,0]=(0.340661037085)*x[0]**o+(-0.672207039496)*x[0]+(0.676291394824)*x[1]**o+(0.596998737167)*x[1]+(-0.689800391841)*x[2]**o+(-0.134273731064)*x[2]
        arg[0,2,0,1]=(0.185282186176)*x[0]**o+(0.252489447393)*x[0]+(-0.0447305595755)*x[1]**o+(-0.558361084175)*x[1]+(0.922681220429)*x[2]**o+(-0.484588607971)*x[2]
        arg[0,2,1,0]=(0.238772787004)*x[0]**o+(0.987311136495)*x[0]+(0.215079265839)*x[1]**o+(-0.797762453244)*x[1]+(0.0329055379323)*x[2]**o+(-0.88999503049)*x[2]
        arg[0,2,1,1]=(-0.175884373587)*x[0]**o+(0.806690051494)*x[0]+(0.0086744009376)*x[1]**o+(0.286131063746)*x[1]+(0.536839534689)*x[2]**o+(-0.0946282917135)*x[2]
        arg[0,2,2,0]=(-0.615695203188)*x[0]**o+(0.600565627235)*x[0]+(-0.869759996675)*x[1]**o+(0.648192341374)*x[1]+(-0.952728999251)*x[2]**o+(0.564068973312)*x[2]
        arg[0,2,2,1]=(-0.0992379560876)*x[0]**o+(-0.897179656441)*x[0]+(-0.519600820875)*x[1]**o+(0.70507167679)*x[1]+(0.903640275297)*x[2]**o+(-0.645039734963)*x[2]
        arg[0,3,0,0]=(0.432415072474)*x[0]**o+(-0.748137008742)*x[0]+(0.875883324091)*x[1]**o+(0.706172632952)*x[1]+(-0.47486904255)*x[2]**o+(0.238106343647)*x[2]
        arg[0,3,0,1]=(-0.656397468061)*x[0]**o+(-0.530867058489)*x[0]+(-0.904148914114)*x[1]**o+(0.87213389632)*x[1]+(0.0612056123548)*x[2]**o+(0.288620109264)*x[2]
        arg[0,3,1,0]=(-0.472896985897)*x[0]**o+(0.83328574859)*x[0]+(0.744310819801)*x[1]**o+(0.0601035189502)*x[1]+(-0.198693260491)*x[2]**o+(-0.882304016543)*x[2]
        arg[0,3,1,1]=(-0.515568063685)*x[0]**o+(0.484765564236)*x[0]+(0.754304059424)*x[1]**o+(0.654790289063)*x[1]+(-0.102335538236)*x[2]**o+(-0.0705158755887)*x[2]
        arg[0,3,2,0]=(-0.709802317012)*x[0]**o+(-0.346551215683)*x[0]+(0.312943005623)*x[1]**o+(0.476828461567)*x[1]+(0.901171463566)*x[2]**o+(0.538981245022)*x[2]
        arg[0,3,2,1]=(-0.20057625974)*x[0]**o+(0.0458666109661)*x[0]+(0.909610730794)*x[1]**o+(0.145637065192)*x[1]+(0.666420073244)*x[2]**o+(0.0550124082656)*x[2]
        arg[0,4,0,0]=(-0.726921583373)*x[0]**o+(0.891306726707)*x[0]+(-0.189151461127)*x[1]**o+(0.479274047923)*x[1]+(-0.129077261233)*x[2]**o+(-0.873599130413)*x[2]
        arg[0,4,0,1]=(0.765272127757)*x[0]**o+(0.159307695759)*x[0]+(-0.569162341331)*x[1]**o+(-0.530158933095)*x[1]+(-0.216727788754)*x[2]**o+(-0.519551969741)*x[2]
        arg[0,4,1,0]=(-0.613269202518)*x[0]**o+(0.612846846793)*x[0]+(-0.187285796021)*x[1]**o+(-0.462603518143)*x[1]+(-0.739162067312)*x[2]**o+(0.0737393951189)*x[2]
        arg[0,4,1,1]=(-0.727485674691)*x[0]**o+(-0.461427895477)*x[0]+(0.917029475887)*x[1]**o+(0.265874989879)*x[1]+(0.602505162351)*x[2]**o+(-0.372206475027)*x[2]
        arg[0,4,2,0]=(-0.663071984573)*x[0]**o+(0.511217165998)*x[0]+(-0.472765672078)*x[1]**o+(0.814962161218)*x[1]+(-0.608890631297)*x[2]**o+(-0.284872941025)*x[2]
        arg[0,4,2,1]=(0.893396132015)*x[0]**o+(0.183468149957)*x[0]+(0.647812435076)*x[1]**o+(-0.398672312216)*x[1]+(0.6359553902)*x[2]**o+(0.485509522238)*x[2]
        arg[1,0,0,0]=(-0.0771632829864)*x[0]**o+(-0.723025089864)*x[0]+(0.486209418481)*x[1]**o+(0.0869704919133)*x[1]+(-0.365499197901)*x[2]**o+(-0.0796713538898)*x[2]
        arg[1,0,0,1]=(0.133617787097)*x[0]**o+(0.993872304226)*x[0]+(-0.898504795319)*x[1]**o+(0.656793416434)*x[1]+(-0.821841885906)*x[2]**o+(0.726972748423)*x[2]
        arg[1,0,1,0]=(0.174277385391)*x[0]**o+(-0.301857401564)*x[0]+(-0.846153302312)*x[1]**o+(-0.559076632516)*x[1]+(-0.89870762709)*x[2]**o+(0.640171641512)*x[2]
        arg[1,0,1,1]=(0.795443369588)*x[0]**o+(-0.346082013333)*x[0]+(-0.439713049567)*x[1]**o+(0.860680213906)*x[1]+(-0.466761099917)*x[2]**o+(-0.843656974958)*x[2]
        arg[1,0,2,0]=(0.482814141263)*x[0]**o+(0.142978643528)*x[0]+(-0.735291704767)*x[1]**o+(-0.925675892787)*x[1]+(0.747235439093)*x[2]**o+(-0.569454067374)*x[2]
        arg[1,0,2,1]=(0.619359374773)*x[0]**o+(-0.547172728307)*x[0]+(0.0829642963797)*x[1]**o+(-0.0180882163346)*x[1]+(0.328627445196)*x[2]**o+(-0.274608686384)*x[2]
        arg[1,1,0,0]=(-0.510375454058)*x[0]**o+(-0.779894165181)*x[0]+(0.656168894408)*x[1]**o+(-0.449484133421)*x[1]+(-0.147284453744)*x[2]**o+(-0.488384108271)*x[2]
        arg[1,1,0,1]=(-0.302705575836)*x[0]**o+(0.256670307547)*x[0]+(0.110465379068)*x[1]**o+(0.319291387545)*x[1]+(0.408832172454)*x[2]**o+(0.718793126931)*x[2]
        arg[1,1,1,0]=(0.520882033451)*x[0]**o+(0.412524861348)*x[0]+(0.761080123209)*x[1]**o+(0.401223078157)*x[1]+(-0.65945839721)*x[2]**o+(0.71349489395)*x[2]
        arg[1,1,1,1]=(0.624622427594)*x[0]**o+(0.847907716976)*x[0]+(0.855268296474)*x[1]**o+(-0.671685662164)*x[1]+(-0.407895715308)*x[2]**o+(-0.719054767733)*x[2]
        arg[1,1,2,0]=(-0.044254701409)*x[0]**o+(0.72911290175)*x[0]+(0.869467934211)*x[1]**o+(0.613006764744)*x[1]+(0.678602796496)*x[2]**o+(0.388923815748)*x[2]
        arg[1,1,2,1]=(-0.240571107795)*x[0]**o+(0.838382917252)*x[0]+(0.0342933298383)*x[1]**o+(0.595421789197)*x[1]+(-0.989088178853)*x[2]**o+(-0.20002339454)*x[2]
        arg[1,2,0,0]=(0.0596937021722)*x[0]**o+(0.196768537308)*x[0]+(0.0834459161806)*x[1]**o+(0.194049508373)*x[1]+(-0.097309631361)*x[2]**o+(-0.867555781902)*x[2]
        arg[1,2,0,1]=(-0.935541542647)*x[0]**o+(-0.00702430636955)*x[0]+(-0.384657002538)*x[1]**o+(0.186884376746)*x[1]+(0.97207387841)*x[2]**o+(0.452460932869)*x[2]
        arg[1,2,1,0]=(0.276741406646)*x[0]**o+(0.838348610585)*x[0]+(-0.403054578066)*x[1]**o+(0.655318135938)*x[1]+(0.37614761635)*x[2]**o+(0.82736662494)*x[2]
        arg[1,2,1,1]=(0.828731604537)*x[0]**o+(0.762067030749)*x[0]+(-0.881827056079)*x[1]**o+(0.250928989647)*x[1]+(-0.771040367979)*x[2]**o+(0.239950799138)*x[2]
        arg[1,2,2,0]=(-0.380797583569)*x[0]**o+(0.112805267222)*x[0]+(-0.454730562411)*x[1]**o+(0.926061735219)*x[1]+(0.348331256905)*x[2]**o+(-0.725641369775)*x[2]
        arg[1,2,2,1]=(0.257022926473)*x[0]**o+(0.0160557858816)*x[0]+(-0.291367922966)*x[1]**o+(-0.611341260765)*x[1]+(0.232472950268)*x[2]**o+(-0.738139185521)*x[2]
        arg[1,3,0,0]=(-0.645340088797)*x[0]**o+(0.480235460274)*x[0]+(0.135346246274)*x[1]**o+(-0.560730820351)*x[1]+(-0.635582025321)*x[2]**o+(-0.476912924392)*x[2]
        arg[1,3,0,1]=(0.124132693667)*x[0]**o+(-0.813993821983)*x[0]+(-0.108593659227)*x[1]**o+(-0.432186668568)*x[1]+(0.209382070426)*x[2]**o+(0.928912669667)*x[2]
        arg[1,3,1,0]=(-0.7660131868)*x[0]**o+(-0.30274186797)*x[0]+(0.140498262981)*x[1]**o+(0.993084314471)*x[1]+(0.684043026981)*x[2]**o+(-0.339724714081)*x[2]
        arg[1,3,1,1]=(-0.150578257351)*x[0]**o+(-0.674840941109)*x[0]+(0.469240334383)*x[1]**o+(0.729963338278)*x[1]+(-0.800829664334)*x[2]**o+(0.0467922871395)*x[2]
        arg[1,3,2,0]=(-0.336661555676)*x[0]**o+(0.705661383379)*x[0]+(-0.76993460355)*x[1]**o+(0.459144989218)*x[1]+(0.545901025663)*x[2]**o+(0.385988013614)*x[2]
        arg[1,3,2,1]=(0.165928745462)*x[0]**o+(0.540718600752)*x[0]+(0.172773708803)*x[1]**o+(0.253664803784)*x[1]+(-0.264896626947)*x[2]**o+(-0.478577475495)*x[2]
        arg[1,4,0,0]=(0.283586653542)*x[0]**o+(-0.104364884571)*x[0]+(-0.840555806526)*x[1]**o+(0.701868415915)*x[1]+(-0.290943689679)*x[2]**o+(-0.73024942052)*x[2]
        arg[1,4,0,1]=(-0.772849835334)*x[0]**o+(-0.432170589951)*x[0]+(-0.376099423267)*x[1]**o+(0.0215357491826)*x[1]+(-0.346787011464)*x[2]**o+(0.620411709813)*x[2]
        arg[1,4,1,0]=(-0.718524564964)*x[0]**o+(0.119936682579)*x[0]+(-0.994276256462)*x[1]**o+(-0.839783920473)*x[1]+(-0.454576336782)*x[2]**o+(-0.515489988915)*x[2]
        arg[1,4,1,1]=(-0.771664154234)*x[0]**o+(-0.584052299067)*x[0]+(-0.0233756210307)*x[1]**o+(-0.174442816636)*x[1]+(-0.702383477714)*x[2]**o+(-0.279952858144)*x[2]
        arg[1,4,2,0]=(-0.591902790978)*x[0]**o+(-0.151826578123)*x[0]+(0.923906788219)*x[1]**o+(0.301090558476)*x[1]+(-0.518314647811)*x[2]**o+(-0.784331717681)*x[2]
        arg[1,4,2,1]=(0.303567440092)*x[0]**o+(0.744948852961)*x[0]+(0.719939071212)*x[1]**o+(-0.161138638319)*x[1]+(0.924953261766)*x[2]**o+(-0.875565390131)*x[2]
        arg[2,0,0,0]=(0.197574550087)*x[0]**o+(-0.962018785397)*x[0]+(0.498378037582)*x[1]**o+(-0.334199169606)*x[1]+(0.852426750588)*x[2]**o+(-0.650173474618)*x[2]
        arg[2,0,0,1]=(0.0663499012532)*x[0]**o+(0.00812461763474)*x[0]+(0.237233309304)*x[1]**o+(-0.839377881658)*x[1]+(-0.67246872567)*x[2]**o+(0.677471261363)*x[2]
        arg[2,0,1,0]=(-0.789090971877)*x[0]**o+(-0.387724517273)*x[0]+(0.455954877641)*x[1]**o+(-0.356995254842)*x[1]+(-0.897019846935)*x[2]**o+(-0.0703543939474)*x[2]
        arg[2,0,1,1]=(0.222873274437)*x[0]**o+(0.405228982254)*x[0]+(-0.532697993554)*x[1]**o+(-0.836340143789)*x[1]+(-0.139525062661)*x[2]**o+(-0.916307770461)*x[2]
        arg[2,0,2,0]=(-0.300828039715)*x[0]**o+(-0.584457605313)*x[0]+(-0.443125109903)*x[1]**o+(0.292734004842)*x[1]+(-0.55875691535)*x[2]**o+(0.391237822545)*x[2]
        arg[2,0,2,1]=(-0.501507304569)*x[0]**o+(-0.203549089015)*x[0]+(-0.113050138121)*x[1]**o+(0.712978728546)*x[1]+(-0.642617274635)*x[2]**o+(-0.307119076865)*x[2]
        arg[2,1,0,0]=(-0.809237327867)*x[0]**o+(0.984684980548)*x[0]+(-0.643310231704)*x[1]**o+(0.759430082065)*x[1]+(-0.393902220205)*x[2]**o+(-0.900173371318)*x[2]
        arg[2,1,0,1]=(-0.722795722506)*x[0]**o+(0.433309366611)*x[0]+(-0.559871890844)*x[1]**o+(0.417301432603)*x[1]+(-0.364192390887)*x[2]**o+(0.64549736058)*x[2]
        arg[2,1,1,0]=(-0.551325611251)*x[0]**o+(-0.638520772682)*x[0]+(0.222655558982)*x[1]**o+(-0.230002147207)*x[1]+(-0.290821163957)*x[2]**o+(0.0647728628594)*x[2]
        arg[2,1,1,1]=(0.743453045588)*x[0]**o+(-0.901163108996)*x[0]+(-0.546031302921)*x[1]**o+(-0.512614476111)*x[1]+(-0.886430682715)*x[2]**o+(0.720650678026)*x[2]
        arg[2,1,2,0]=(-0.033787671958)*x[0]**o+(0.930927279443)*x[0]+(-0.530482747719)*x[1]**o+(0.714053784656)*x[1]+(-0.0978565618487)*x[2]**o+(-0.0423072209447)*x[2]
        arg[2,1,2,1]=(0.127121989623)*x[0]**o+(0.809654796091)*x[0]+(0.718533701795)*x[1]**o+(0.542738494557)*x[1]+(-0.342918607246)*x[2]**o+(-0.627991145352)*x[2]
        arg[2,2,0,0]=(-0.867530011926)*x[0]**o+(0.870295856967)*x[0]+(-0.13043222912)*x[1]**o+(0.2670058777)*x[1]+(0.395016123247)*x[2]**o+(-0.811207959629)*x[2]
        arg[2,2,0,1]=(-0.00858729113056)*x[0]**o+(-0.885551110851)*x[0]+(0.820441870015)*x[1]**o+(-0.348896120549)*x[1]+(0.295475751596)*x[2]**o+(-0.672688762902)*x[2]
        arg[2,2,1,0]=(-0.982123891355)*x[0]**o+(0.232770408062)*x[0]+(0.374641341895)*x[1]**o+(-0.21375197203)*x[1]+(0.436992590849)*x[2]**o+(-0.473399371298)*x[2]
        arg[2,2,1,1]=(-0.415533190881)*x[0]**o+(0.0945615271507)*x[0]+(-0.281959759072)*x[1]**o+(0.0807942449559)*x[1]+(0.225501997354)*x[2]**o+(0.305247648387)*x[2]
        arg[2,2,2,0]=(-0.559916632426)*x[0]**o+(-0.372679495574)*x[0]+(0.392857820158)*x[1]**o+(0.726824319268)*x[1]+(0.36923535014)*x[2]**o+(-0.208169256022)*x[2]
        arg[2,2,2,1]=(-0.869055045156)*x[0]**o+(0.359188490398)*x[0]+(0.702110073265)*x[1]**o+(0.668757858248)*x[1]+(-0.499300337779)*x[2]**o+(0.0471054271112)*x[2]
        arg[2,3,0,0]=(0.754089271004)*x[0]**o+(-0.0240479506036)*x[0]+(-0.0775830745475)*x[1]**o+(0.215564363064)*x[1]+(-0.791969192801)*x[2]**o+(-0.130308630692)*x[2]
        arg[2,3,0,1]=(0.448970570476)*x[0]**o+(0.510346880872)*x[0]+(-0.561996764085)*x[1]**o+(0.217897696493)*x[1]+(-0.0610826665756)*x[2]**o+(0.387896322636)*x[2]
        arg[2,3,1,0]=(0.737635683404)*x[0]**o+(-0.35395540781)*x[0]+(0.0419652573208)*x[1]**o+(-0.519735381528)*x[1]+(0.739523085214)*x[2]**o+(0.808529094094)*x[2]
        arg[2,3,1,1]=(0.551348499194)*x[0]**o+(-0.40145493368)*x[0]+(0.211723169473)*x[1]**o+(-0.762751144824)*x[1]+(-0.17710033067)*x[2]**o+(0.688961224051)*x[2]
        arg[2,3,2,0]=(-0.870721462645)*x[0]**o+(-0.0356869329313)*x[0]+(0.277142920424)*x[1]**o+(-0.154474999666)*x[1]+(0.837001124911)*x[2]**o+(-0.233028214567)*x[2]
        arg[2,3,2,1]=(-0.234260935528)*x[0]**o+(0.913718165996)*x[0]+(0.385678747942)*x[1]**o+(0.237966356277)*x[1]+(0.382072927695)*x[2]**o+(0.627666395757)*x[2]
        arg[2,4,0,0]=(-0.474674316363)*x[0]**o+(-0.575533683959)*x[0]+(0.751489557666)*x[1]**o+(-0.0623565445313)*x[1]+(-0.517274743843)*x[2]**o+(-0.712143034168)*x[2]
        arg[2,4,0,1]=(0.259723799797)*x[0]**o+(0.345952822815)*x[0]+(0.169940774832)*x[1]**o+(-0.185154259609)*x[1]+(0.418430344681)*x[2]**o+(0.861837327531)*x[2]
        arg[2,4,1,0]=(-0.960970748682)*x[0]**o+(0.842706511282)*x[0]+(-0.771779045108)*x[1]**o+(-0.63675621795)*x[1]+(-0.317416556239)*x[2]**o+(0.287317968341)*x[2]
        arg[2,4,1,1]=(-0.753944077832)*x[0]**o+(0.570245260805)*x[0]+(-0.0226797611003)*x[1]**o+(0.0776773843077)*x[1]+(0.629536717673)*x[2]**o+(0.271216337699)*x[2]
        arg[2,4,2,0]=(-0.233304828171)*x[0]**o+(-0.217436697538)*x[0]+(-0.373618121496)*x[1]**o+(-0.342584906659)*x[1]+(0.0114484228954)*x[2]**o+(-0.639753178531)*x[2]
        arg[2,4,2,1]=(0.341373328517)*x[0]**o+(-0.432795268788)*x[0]+(-0.871263113926)*x[1]**o+(0.843590946949)*x[1]+(-0.653058566267)*x[2]**o+(-0.894366240333)*x[2]
        arg[3,0,0,0]=(-0.472652289489)*x[0]**o+(0.697119499826)*x[0]+(-0.195781503945)*x[1]**o+(-0.716872496009)*x[1]+(-0.159070341485)*x[2]**o+(-0.700548071467)*x[2]
        arg[3,0,0,1]=(-0.398674023611)*x[0]**o+(-0.690683017472)*x[0]+(0.957112237189)*x[1]**o+(-0.782702815224)*x[1]+(-0.249336230999)*x[2]**o+(0.22734983387)*x[2]
        arg[3,0,1,0]=(-0.0216721345971)*x[0]**o+(0.283765576696)*x[0]+(-0.35531833417)*x[1]**o+(0.974402352836)*x[1]+(-0.568820213603)*x[2]**o+(0.957610279127)*x[2]
        arg[3,0,1,1]=(0.0606265274442)*x[0]**o+(-0.941169961629)*x[0]+(0.804902933622)*x[1]**o+(-0.857158317629)*x[1]+(-0.227167312547)*x[2]**o+(0.945175823328)*x[2]
        arg[3,0,2,0]=(0.630444608821)*x[0]**o+(-0.192343222551)*x[0]+(0.0342249337232)*x[1]**o+(0.970401334961)*x[1]+(-0.608568046213)*x[2]**o+(-0.539374299133)*x[2]
        arg[3,0,2,1]=(-0.348127940577)*x[0]**o+(-0.895424161569)*x[0]+(0.918173840926)*x[1]**o+(0.99658998821)*x[1]+(-0.28733372377)*x[2]**o+(-0.516441029544)*x[2]
        arg[3,1,0,0]=(0.735069593965)*x[0]**o+(-0.727899981109)*x[0]+(-0.325639355247)*x[1]**o+(0.751064830331)*x[1]+(-0.297126073245)*x[2]**o+(-0.673421779764)*x[2]
        arg[3,1,0,1]=(0.00281719106153)*x[0]**o+(0.246929980679)*x[0]+(-0.48091940116)*x[1]**o+(0.501927059357)*x[1]+(-0.520099802736)*x[2]**o+(-0.902706012118)*x[2]
        arg[3,1,1,0]=(-0.341732637339)*x[0]**o+(-0.169802234575)*x[0]+(0.156725375114)*x[1]**o+(0.739176104936)*x[1]+(-0.374572295196)*x[2]**o+(-0.436641001832)*x[2]
        arg[3,1,1,1]=(0.644746847185)*x[0]**o+(-0.992126325722)*x[0]+(0.551602368714)*x[1]**o+(-0.839306768893)*x[1]+(-0.298981617653)*x[2]**o+(0.089795271605)*x[2]
        arg[3,1,2,0]=(0.382425223801)*x[0]**o+(-0.949095041278)*x[0]+(-0.135997266858)*x[1]**o+(-0.871114033611)*x[1]+(-0.422984170709)*x[2]**o+(-0.698818784989)*x[2]
        arg[3,1,2,1]=(0.630558573276)*x[0]**o+(0.90644556976)*x[0]+(0.512953870249)*x[1]**o+(-0.58514271049)*x[1]+(-0.0587225891088)*x[2]**o+(-0.390796465925)*x[2]
        arg[3,2,0,0]=(-0.404884771697)*x[0]**o+(-0.178144326223)*x[0]+(-0.606503995405)*x[1]**o+(0.190025878248)*x[1]+(0.735831203504)*x[2]**o+(-0.567394607398)*x[2]
        arg[3,2,0,1]=(0.28819895431)*x[0]**o+(0.456573144203)*x[0]+(0.00856899200079)*x[1]**o+(0.547827005333)*x[1]+(0.087428132552)*x[2]**o+(0.759650060552)*x[2]
        arg[3,2,1,0]=(0.949790710961)*x[0]**o+(-0.685602682574)*x[0]+(0.75278809536)*x[1]**o+(-0.876689834021)*x[1]+(0.0116394079709)*x[2]**o+(0.319113513167)*x[2]
        arg[3,2,1,1]=(0.619659549755)*x[0]**o+(-0.397388124185)*x[0]+(0.460679661901)*x[1]**o+(-0.507122241204)*x[1]+(0.985741194076)*x[2]**o+(0.916231863626)*x[2]
        arg[3,2,2,0]=(-0.457269257294)*x[0]**o+(-0.47265466694)*x[0]+(0.900051837969)*x[1]**o+(-0.148802803439)*x[1]+(-0.195540487054)*x[2]**o+(0.0784524130754)*x[2]
        arg[3,2,2,1]=(0.933553130797)*x[0]**o+(0.617362831046)*x[0]+(0.263616954879)*x[1]**o+(-0.0658887625105)*x[1]+(0.48091174024)*x[2]**o+(0.452935484504)*x[2]
        arg[3,3,0,0]=(0.825594594128)*x[0]**o+(0.350203407373)*x[0]+(0.211125321741)*x[1]**o+(0.194914147746)*x[1]+(-0.639432220749)*x[2]**o+(-0.678718852935)*x[2]
        arg[3,3,0,1]=(0.514394313629)*x[0]**o+(-0.595261005308)*x[0]+(-0.0219208527235)*x[1]**o+(-0.77204975709)*x[1]+(-0.483587370025)*x[2]**o+(-0.559464911044)*x[2]
        arg[3,3,1,0]=(0.821240511475)*x[0]**o+(-0.403492177329)*x[0]+(0.486132478046)*x[1]**o+(-0.0187529457547)*x[1]+(0.73209003456)*x[2]**o+(0.226791335797)*x[2]
        arg[3,3,1,1]=(-0.644256768839)*x[0]**o+(0.0372588784686)*x[0]+(0.726561650796)*x[1]**o+(0.518003809017)*x[1]+(0.738146681601)*x[2]**o+(-0.256036433171)*x[2]
        arg[3,3,2,0]=(0.534862520097)*x[0]**o+(0.275559826342)*x[0]+(0.292383677513)*x[1]**o+(-0.448938027415)*x[1]+(0.281053776971)*x[2]**o+(0.0119964402657)*x[2]
        arg[3,3,2,1]=(0.722071427786)*x[0]**o+(0.150280744346)*x[0]+(-0.0354786178164)*x[1]**o+(-0.703984035201)*x[1]+(0.105365795033)*x[2]**o+(-0.556567650379)*x[2]
        arg[3,4,0,0]=(0.188625467698)*x[0]**o+(0.737108753179)*x[0]+(0.481952725951)*x[1]**o+(0.841958412185)*x[1]+(-0.329504392569)*x[2]**o+(0.228456367852)*x[2]
        arg[3,4,0,1]=(0.181430484096)*x[0]**o+(0.307078178179)*x[0]+(0.262079226853)*x[1]**o+(0.111656765153)*x[1]+(0.15340094176)*x[2]**o+(-0.859774252333)*x[2]
        arg[3,4,1,0]=(0.213491785855)*x[0]**o+(-0.479441582203)*x[0]+(0.0527576231613)*x[1]**o+(0.328465118263)*x[1]+(-0.645719217198)*x[2]**o+(-0.550569446193)*x[2]
        arg[3,4,1,1]=(-0.401744411188)*x[0]**o+(-0.626446165761)*x[0]+(-0.191670239416)*x[1]**o+(0.866888407009)*x[1]+(-0.341220740645)*x[2]**o+(-0.742685031762)*x[2]
        arg[3,4,2,0]=(-0.0813611687514)*x[0]**o+(0.318680684889)*x[0]+(-0.780434724843)*x[1]**o+(-0.0902735483921)*x[1]+(0.586108990767)*x[2]**o+(0.934041577436)*x[2]
        arg[3,4,2,1]=(-0.0991425040958)*x[0]**o+(0.99274076773)*x[0]+(0.924248544389)*x[1]**o+(0.290576034321)*x[1]+(0.452104871421)*x[2]**o+(0.774017129246)*x[2]
        ref[0,0,0,0]=(-0.445809185937)/(o+1.)+(-0.11049649315)+(0.480896043196)*0.5**o
        ref[0,0,0,1]=(-0.776476434405)/(o+1.)+(-0.842010629213)+(-0.609632888023)*0.5**o
        ref[0,0,1,0]=(0.182977545138)/(o+1.)+(-0.124558039762)+(0.205065167181)*0.5**o
        ref[0,0,1,1]=(-1.17104760039)/(o+1.)+(0.608297882891)+(0.875716461075)*0.5**o
        ref[0,0,2,0]=(0.647678117252)/(o+1.)+(-0.752248832131)+(0.711372030289)*0.5**o
        ref[0,0,2,1]=(-0.0424453226222)/(o+1.)+(0.152363855976)+(-0.0536842545617)*0.5**o
        ref[0,1,0,0]=(-0.97072557194)/(o+1.)+(0.355747795628)+(-0.710091748251)*0.5**o
        ref[0,1,0,1]=(1.54210036269)/(o+1.)+(-0.0605096710259)+(0.250989366649)*0.5**o
        ref[0,1,1,0]=(1.33375575444)/(o+1.)+(-0.237134583454)+(0.690360096543)*0.5**o
        ref[0,1,1,1]=(0.0771949345448)/(o+1.)+(-0.00507329027461)+(-0.815220933301)*0.5**o
        ref[0,1,2,0]=(-0.149444846314)/(o+1.)+(-0.226886808857)+(0.169442617085)*0.5**o
        ref[0,1,2,1]=(0.114952830564)/(o+1.)+(-0.613038537369)+(-0.110636656112)*0.5**o
        ref[0,2,0,0]=(-0.0135089970172)/(o+1.)+(-0.104741016697)+(0.340661037085)*0.5**o
        ref[0,2,0,1]=(0.877950660854)/(o+1.)+(-0.395230122376)+(0.185282186176)*0.5**o
        ref[0,2,1,0]=(0.247984803771)/(o+1.)+(-0.35022317362)+(0.238772787004)*0.5**o
        ref[0,2,1,1]=(0.545513935627)/(o+1.)+(0.499096411763)+(-0.175884373587)*0.5**o
        ref[0,2,2,0]=(-1.82248899593)/(o+1.)+(0.90641347096)+(-0.615695203188)*0.5**o
        ref[0,2,2,1]=(0.384039454422)/(o+1.)+(-0.418573857307)+(-0.0992379560876)*0.5**o
        ref[0,3,0,0]=(0.401014281541)/(o+1.)+(0.0980709839284)+(0.432415072474)*0.5**o
        ref[0,3,0,1]=(-0.842943301759)/(o+1.)+(0.314943473548)+(-0.656397468061)*0.5**o
        ref[0,3,1,0]=(0.54561755931)/(o+1.)+(0.00554262549843)+(-0.472896985897)*0.5**o
        ref[0,3,1,1]=(0.651968521189)/(o+1.)+(0.534519988855)+(-0.515568063685)*0.5**o
        ref[0,3,2,0]=(1.21411446919)/(o+1.)+(0.334629245453)+(-0.709802317012)*0.5**o
        ref[0,3,2,1]=(1.57603080404)/(o+1.)+(0.123258042212)+(-0.20057625974)*0.5**o
        ref[0,4,0,0]=(-0.318228722361)/(o+1.)+(0.248490822109)+(-0.726921583373)*0.5**o
        ref[0,4,0,1]=(-0.785890130085)/(o+1.)+(-0.445201603538)+(0.765272127757)*0.5**o
        ref[0,4,1,0]=(-0.926447863334)/(o+1.)+(0.111991361885)+(-0.613269202518)*0.5**o
        ref[0,4,1,1]=(1.51953463824)/(o+1.)+(-0.283879690312)+(-0.727485674691)*0.5**o
        ref[0,4,2,0]=(-1.08165630338)/(o+1.)+(0.520653193096)+(-0.663071984573)*0.5**o
        ref[0,4,2,1]=(1.28376782528)/(o+1.)+(0.135152679989)+(0.893396132015)*0.5**o
        ref[1,0,0,0]=(0.12071022058)/(o+1.)+(-0.35786297592)+(-0.0771632829864)*0.5**o
        ref[1,0,0,1]=(-1.72034668123)/(o+1.)+(1.18881923454)+(0.133617787097)*0.5**o
        ref[1,0,1,0]=(-1.7448609294)/(o+1.)+(-0.110381196284)+(0.174277385391)*0.5**o
        ref[1,0,1,1]=(-0.906474149485)/(o+1.)+(-0.164529387192)+(0.795443369588)*0.5**o
        ref[1,0,2,0]=(0.0119437343259)/(o+1.)+(-0.676075658316)+(0.482814141263)*0.5**o
        ref[1,0,2,1]=(0.411591741576)/(o+1.)+(-0.419934815512)+(0.619359374773)*0.5**o
        ref[1,1,0,0]=(0.508884440665)/(o+1.)+(-0.858881203437)+(-0.510375454058)*0.5**o
        ref[1,1,0,1]=(0.519297551522)/(o+1.)+(0.647377411012)+(-0.302705575836)*0.5**o
        ref[1,1,1,0]=(0.101621725999)/(o+1.)+(0.763621416728)+(0.520882033451)*0.5**o
        ref[1,1,1,1]=(0.447372581166)/(o+1.)+(-0.27141635646)+(0.624622427594)*0.5**o
        ref[1,1,2,0]=(1.54807073071)/(o+1.)+(0.865521741121)+(-0.044254701409)*0.5**o
        ref[1,1,2,1]=(-0.954794849015)/(o+1.)+(0.616890655954)+(-0.240571107795)*0.5**o
        ref[1,2,0,0]=(-0.0138637151804)/(o+1.)+(-0.23836886811)+(0.0596937021722)*0.5**o
        ref[1,2,0,1]=(0.587416875871)/(o+1.)+(0.316160501623)+(-0.935541542647)*0.5**o
        ref[1,2,1,0]=(-0.0269069617163)/(o+1.)+(1.16051668573)+(0.276741406646)*0.5**o
        ref[1,2,1,1]=(-1.65286742406)/(o+1.)+(0.626473409767)+(0.828731604537)*0.5**o
        ref[1,2,2,0]=(-0.106399305507)/(o+1.)+(0.156612816333)+(-0.380797583569)*0.5**o
        ref[1,2,2,1]=(-0.0588949726984)/(o+1.)+(-0.666712330202)+(0.257022926473)*0.5**o
        ref[1,3,0,0]=(-0.500235779047)/(o+1.)+(-0.278704142234)+(-0.645340088797)*0.5**o
        ref[1,3,0,1]=(0.100788411199)/(o+1.)+(-0.158633910442)+(0.124132693667)*0.5**o
        ref[1,3,1,0]=(0.824541289962)/(o+1.)+(0.17530886621)+(-0.7660131868)*0.5**o
        ref[1,3,1,1]=(-0.331589329951)/(o+1.)+(0.0509573421542)+(-0.150578257351)*0.5**o
        ref[1,3,2,0]=(-0.224033577887)/(o+1.)+(0.775397193106)+(-0.336661555676)*0.5**o
        ref[1,3,2,1]=(-0.0921229181433)/(o+1.)+(0.15790296452)+(0.165928745462)*0.5**o
        ref[1,4,0,0]=(-1.13149949621)/(o+1.)+(-0.0663729445879)+(0.283586653542)*0.5**o
        ref[1,4,0,1]=(-0.722886434731)/(o+1.)+(0.104888434522)+(-0.772849835334)*0.5**o
        ref[1,4,1,0]=(-1.44885259324)/(o+1.)+(-0.617668613405)+(-0.718524564964)*0.5**o
        ref[1,4,1,1]=(-0.725759098745)/(o+1.)+(-0.519223986923)+(-0.771664154234)*0.5**o
        ref[1,4,2,0]=(0.405592140408)/(o+1.)+(-0.317533868664)+(-0.591902790978)*0.5**o
        ref[1,4,2,1]=(1.64489233298)/(o+1.)+(-0.145877587744)+(0.303567440092)*0.5**o
        ref[2,0,0,0]=(1.35080478817)/(o+1.)+(-0.97319571481)+(0.197574550087)*0.5**o
        ref[2,0,0,1]=(-0.435235416366)/(o+1.)+(-0.0768910013301)+(0.0663499012532)*0.5**o
        ref[2,0,1,0]=(-0.441064969294)/(o+1.)+(-0.407537083031)+(-0.789090971877)*0.5**o
        ref[2,0,1,1]=(-0.672223056216)/(o+1.)+(-0.673709465998)+(0.222873274437)*0.5**o
        ref[2,0,2,0]=(-1.00188202525)/(o+1.)+(0.0497571110368)+(-0.300828039715)*0.5**o
        ref[2,0,2,1]=(-0.755667412756)/(o+1.)+(0.101155281333)+(-0.501507304569)*0.5**o
        ref[2,1,0,0]=(-1.03721245191)/(o+1.)+(0.421970845648)+(-0.809237327867)*0.5**o
        ref[2,1,0,1]=(-0.924064281731)/(o+1.)+(0.748054079897)+(-0.722795722506)*0.5**o
        ref[2,1,1,0]=(-0.0681656049743)/(o+1.)+(-0.401875028515)+(-0.551325611251)*0.5**o
        ref[2,1,1,1]=(-1.43246198564)/(o+1.)+(-0.346563453541)+(0.743453045588)*0.5**o
        ref[2,1,2,0]=(-0.628339309568)/(o+1.)+(0.801336921577)+(-0.033787671958)*0.5**o
        ref[2,1,2,1]=(0.375615094549)/(o+1.)+(0.362201072648)+(0.127121989623)*0.5**o
        ref[2,2,0,0]=(0.264583894127)/(o+1.)+(0.163046887519)+(-0.867530011926)*0.5**o
        ref[2,2,0,1]=(1.11591762161)/(o+1.)+(-0.953567997151)+(-0.00858729113056)*0.5**o
        ref[2,2,1,0]=(0.811633932744)/(o+1.)+(-0.227190467633)+(-0.982123891355)*0.5**o
        ref[2,2,1,1]=(-0.0564577617182)/(o+1.)+(0.240301710247)+(-0.415533190881)*0.5**o
        ref[2,2,2,0]=(0.762093170298)/(o+1.)+(0.072987783836)+(-0.559916632426)*0.5**o
        ref[2,2,2,1]=(0.202809735486)/(o+1.)+(0.537525887878)+(-0.869055045156)*0.5**o
        ref[2,3,0,0]=(-0.869552267348)/(o+1.)+(0.0306038908843)+(0.754089271004)*0.5**o
        ref[2,3,0,1]=(-0.62307943066)/(o+1.)+(0.55807045)+(0.448970570476)*0.5**o
        ref[2,3,1,0]=(0.781488342534)/(o+1.)+(-0.0325808476221)+(0.737635683404)*0.5**o
        ref[2,3,1,1]=(0.0346228388027)/(o+1.)+(-0.237622427226)+(0.551348499194)*0.5**o
        ref[2,3,2,0]=(1.11414404534)/(o+1.)+(-0.211595073582)+(-0.870721462645)*0.5**o
        ref[2,3,2,1]=(0.767751675637)/(o+1.)+(0.889675459015)+(-0.234260935528)*0.5**o
        ref[2,4,0,0]=(0.234214813823)/(o+1.)+(-0.675016631329)+(-0.474674316363)*0.5**o
        ref[2,4,0,1]=(0.588371119514)/(o+1.)+(0.511317945368)+(0.259723799797)*0.5**o
        ref[2,4,1,0]=(-1.08919560135)/(o+1.)+(0.246634130836)+(-0.960970748682)*0.5**o
        ref[2,4,1,1]=(0.606856956573)/(o+1.)+(0.459569491406)+(-0.753944077832)*0.5**o
        ref[2,4,2,0]=(-0.3621696986)/(o+1.)+(-0.599887391364)+(-0.233304828171)*0.5**o
        ref[2,4,2,1]=(-1.52432168019)/(o+1.)+(-0.241785281086)+(0.341373328517)*0.5**o
        ref[3,0,0,0]=(-0.35485184543)/(o+1.)+(-0.360150533825)+(-0.472652289489)*0.5**o
        ref[3,0,0,1]=(0.70777600619)/(o+1.)+(-0.623017999413)+(-0.398674023611)*0.5**o
        ref[3,0,1,0]=(-0.924138547773)/(o+1.)+(1.10788910433)+(-0.0216721345971)*0.5**o
        ref[3,0,1,1]=(0.577735621075)/(o+1.)+(-0.426576227965)+(0.0606265274442)*0.5**o
        ref[3,0,2,0]=(-0.57434311249)/(o+1.)+(0.119341906638)+(0.630444608821)*0.5**o
        ref[3,0,2,1]=(0.630840117156)/(o+1.)+(-0.207637601452)+(-0.348127940577)*0.5**o
        ref[3,1,0,0]=(-0.622765428492)/(o+1.)+(-0.32512846527)+(0.735069593965)*0.5**o
        ref[3,1,0,1]=(-1.0010192039)/(o+1.)+(-0.076924486041)+(0.00281719106153)*0.5**o
        ref[3,1,1,0]=(-0.217846920082)/(o+1.)+(0.0663664342643)+(-0.341732637339)*0.5**o
        ref[3,1,1,1]=(0.25262075106)/(o+1.)+(-0.870818911505)+(0.644746847185)*0.5**o
        ref[3,1,2,0]=(-0.558981437567)/(o+1.)+(-1.25951392994)+(0.382425223801)*0.5**o
        ref[3,1,2,1]=(0.454231281141)/(o+1.)+(-0.034746803327)+(0.630558573276)*0.5**o
        ref[3,2,0,0]=(0.129327208099)/(o+1.)+(-0.277756527686)+(-0.404884771697)*0.5**o
        ref[3,2,0,1]=(0.0959971245528)/(o+1.)+(0.882025105044)+(0.28819895431)*0.5**o
        ref[3,2,1,0]=(0.764427503331)/(o+1.)+(-0.621589501714)+(0.949790710961)*0.5**o
        ref[3,2,1,1]=(1.44642085598)/(o+1.)+(0.00586074911794)+(0.619659549755)*0.5**o
        ref[3,2,2,0]=(0.704511350915)/(o+1.)+(-0.271502528652)+(-0.457269257294)*0.5**o
        ref[3,2,2,1]=(0.744528695119)/(o+1.)+(0.50220477652)+(0.933553130797)*0.5**o
        ref[3,3,0,0]=(-0.428306899008)/(o+1.)+(-0.0668006489082)+(0.825594594128)*0.5**o
        ref[3,3,0,1]=(-0.505508222749)/(o+1.)+(-0.963387836721)+(0.514394313629)*0.5**o
        ref[3,3,1,0]=(1.21822251261)/(o+1.)+(-0.0977268936434)+(0.821240511475)*0.5**o
        ref[3,3,1,1]=(1.4647083324)/(o+1.)+(0.149613127157)+(-0.644256768839)*0.5**o
        ref[3,3,2,0]=(0.573437454483)/(o+1.)+(-0.0806908804035)+(0.534862520097)*0.5**o
        ref[3,3,2,1]=(0.069887177217)/(o+1.)+(-0.555135470617)+(0.722071427786)*0.5**o
        ref[3,4,0,0]=(0.152448333383)/(o+1.)+(0.903761766608)+(0.188625467698)*0.5**o
        ref[3,4,0,1]=(0.415480168613)/(o+1.)+(-0.220519654501)+(0.181430484096)*0.5**o
        ref[3,4,1,0]=(-0.592961594036)/(o+1.)+(-0.350772955066)+(0.213491785855)*0.5**o
        ref[3,4,1,1]=(-0.532890980061)/(o+1.)+(-0.251121395257)+(-0.401744411188)*0.5**o
        ref[3,4,2,0]=(-0.194325734076)/(o+1.)+(0.581224356966)+(-0.0813611687514)*0.5**o
        ref[3,4,2,1]=(1.37635341581)/(o+1.)+(1.02866696565)+(-0.0991425040958)*0.5**o
      res=integrate(arg)
      self.failUnless(isinstance(res,numarray.NumArray),"wrong type of result.")
      self.failUnlessEqual(res.shape,(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.88016247767)*x[0]**o+(0.546409254589)*x[0]+(-0.782935386141)*x[1]**o+(-0.21996752206)*x[1]
        ref=(-0.782935386141)/(o+1.)+(0.163220866264)+(0.88016247767)*0.5**o
      else:
        s=(0.436925914346)*x[0]**o+(0.18630264415)*x[0]+(-0.374230617371)*x[1]**o+(0.331719266581)*x[1]+(-0.327334599603)*x[2]**o+(-0.376893151193)*x[2]
        ref=(-0.701565216974)/(o+1.)+(0.0705643797689)+(0.436925914346)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.0725655727924)*x[0]**o+(-0.539202679596)*x[0]+(0.00383805967589)*x[1]**o+(-0.42164917219)*x[1]
        s[1]=(0.799189397651)*x[0]**o+(0.468822667976)*x[0]+(0.946068596129)*x[1]**o+(-0.75397954631)*x[1]
        ref[0]=(0.00383805967589)/(o+1.)+(-0.480425925893)+(-0.0725655727924)*0.5**o
        ref[1]=(0.946068596129)/(o+1.)+(-0.142578439167)+(0.799189397651)*0.5**o
      else:
        s[0]=(0.94482411471)*x[0]**o+(-0.308967528984)*x[0]+(-0.417912410083)*x[1]**o+(-0.363984940852)*x[1]+(0.991921856553)*x[2]**o+(-0.264144586743)*x[2]
        s[1]=(-0.190159227288)*x[0]**o+(0.774206651681)*x[0]+(-0.585389796317)*x[1]**o+(-0.8203250901)*x[1]+(-0.959196504133)*x[2]**o+(0.118981346607)*x[2]
        ref[0]=(0.57400944647)/(o+1.)+(-0.46854852829)+(0.94482411471)*0.5**o
        ref[1]=(-1.54458630045)/(o+1.)+(0.036431454094)+(-0.190159227288)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.821123722738)*x[0]**o+(-0.953533567845)*x[0]+(0.761401252898)*x[1]**o+(0.560845798718)*x[1]
        s[0,1]=(0.388458475385)*x[0]**o+(0.787499438329)*x[0]+(0.13496554321)*x[1]**o+(0.558370810363)*x[1]
        s[0,2]=(-0.583597257844)*x[0]**o+(-0.203553852077)*x[0]+(0.400123717156)*x[1]**o+(-0.748904505246)*x[1]
        s[0,3]=(0.215629523788)*x[0]**o+(0.380761852867)*x[0]+(-0.656661093703)*x[1]**o+(0.707314164752)*x[1]
        s[0,4]=(-0.945147360815)*x[0]**o+(0.761197937419)*x[0]+(-0.242270565927)*x[1]**o+(0.197444941556)*x[1]
        s[1,0]=(-0.260643768467)*x[0]**o+(-0.429658355574)*x[0]+(0.832795677562)*x[1]**o+(0.0465882509708)*x[1]
        s[1,1]=(0.80280828918)*x[0]**o+(0.824378440768)*x[0]+(-0.0704713499903)*x[1]**o+(0.882600027718)*x[1]
        s[1,2]=(-0.188924905219)*x[0]**o+(-0.532960871866)*x[0]+(0.130210761298)*x[1]**o+(-0.847312599467)*x[1]
        s[1,3]=(-0.637355923048)*x[0]**o+(0.102559784731)*x[0]+(-0.00202798859835)*x[1]**o+(-0.275087027189)*x[1]
        s[1,4]=(-0.677415150613)*x[0]**o+(0.212870653829)*x[0]+(0.60045622057)*x[1]**o+(0.554319358843)*x[1]
        s[2,0]=(-0.758104298178)*x[0]**o+(0.122102590939)*x[0]+(0.82242042837)*x[1]**o+(0.877931466117)*x[1]
        s[2,1]=(0.295560509979)*x[0]**o+(0.0550082286163)*x[0]+(0.28149317542)*x[1]**o+(0.933306020272)*x[1]
        s[2,2]=(0.164458091911)*x[0]**o+(0.895923571884)*x[0]+(-0.89721569291)*x[1]**o+(-0.797286890655)*x[1]
        s[2,3]=(-0.455008349519)*x[0]**o+(-0.950347778241)*x[0]+(-0.52866158871)*x[1]**o+(0.784423551832)*x[1]
        s[2,4]=(0.0404391288743)*x[0]**o+(0.919895028488)*x[0]+(0.14131342368)*x[1]**o+(-0.534436226168)*x[1]
        s[3,0]=(0.313572834288)*x[0]**o+(-0.981579650669)*x[0]+(-0.105890320276)*x[1]**o+(0.184272310362)*x[1]
        s[3,1]=(0.517529943685)*x[0]**o+(-0.225899698465)*x[0]+(0.314725287596)*x[1]**o+(-0.520678188485)*x[1]
        s[3,2]=(0.457697644746)*x[0]**o+(0.580651564264)*x[0]+(0.0819245033577)*x[1]**o+(-0.962585666695)*x[1]
        s[3,3]=(-0.540006520671)*x[0]**o+(0.00341289905337)*x[0]+(-0.75656675994)*x[1]**o+(0.355040790858)*x[1]
        s[3,4]=(0.211995984801)*x[0]**o+(-0.907257558871)*x[0]+(0.736102007034)*x[1]**o+(-0.841283087071)*x[1]
        ref[0,0]=(0.761401252898)/(o+1.)+(-0.196343884564)+(0.821123722738)*0.5**o
        ref[0,1]=(0.13496554321)/(o+1.)+(0.672935124346)+(0.388458475385)*0.5**o
        ref[0,2]=(0.400123717156)/(o+1.)+(-0.476229178662)+(-0.583597257844)*0.5**o
        ref[0,3]=(-0.656661093703)/(o+1.)+(0.544038008809)+(0.215629523788)*0.5**o
        ref[0,4]=(-0.242270565927)/(o+1.)+(0.479321439487)+(-0.945147360815)*0.5**o
        ref[1,0]=(0.832795677562)/(o+1.)+(-0.191535052302)+(-0.260643768467)*0.5**o
        ref[1,1]=(-0.0704713499903)/(o+1.)+(0.853489234243)+(0.80280828918)*0.5**o
        ref[1,2]=(0.130210761298)/(o+1.)+(-0.690136735666)+(-0.188924905219)*0.5**o
        ref[1,3]=(-0.00202798859835)/(o+1.)+(-0.0862636212292)+(-0.637355923048)*0.5**o
        ref[1,4]=(0.60045622057)/(o+1.)+(0.383595006336)+(-0.677415150613)*0.5**o
        ref[2,0]=(0.82242042837)/(o+1.)+(0.500017028528)+(-0.758104298178)*0.5**o
        ref[2,1]=(0.28149317542)/(o+1.)+(0.494157124444)+(0.295560509979)*0.5**o
        ref[2,2]=(-0.89721569291)/(o+1.)+(0.0493183406148)+(0.164458091911)*0.5**o
        ref[2,3]=(-0.52866158871)/(o+1.)+(-0.0829621132044)+(-0.455008349519)*0.5**o
        ref[2,4]=(0.14131342368)/(o+1.)+(0.19272940116)+(0.0404391288743)*0.5**o
        ref[3,0]=(-0.105890320276)/(o+1.)+(-0.398653670153)+(0.313572834288)*0.5**o
        ref[3,1]=(0.314725287596)/(o+1.)+(-0.373288943475)+(0.517529943685)*0.5**o
        ref[3,2]=(0.0819245033577)/(o+1.)+(-0.190967051216)+(0.457697644746)*0.5**o
        ref[3,3]=(-0.75656675994)/(o+1.)+(0.179226844956)+(-0.540006520671)*0.5**o
        ref[3,4]=(0.736102007034)/(o+1.)+(-0.874270322971)+(0.211995984801)*0.5**o
      else:
        s[0,0]=(-0.26796664441)*x[0]**o+(0.412787191224)*x[0]+(0.291586980058)*x[1]**o+(0.363446579326)*x[1]+(-0.925503103962)*x[2]**o+(-0.815680149808)*x[2]
        s[0,1]=(0.816233130972)*x[0]**o+(-0.412368706967)*x[0]+(-0.633601565886)*x[1]**o+(-0.371336006063)*x[1]+(0.296754676336)*x[2]**o+(0.670055343075)*x[2]
        s[0,2]=(0.0115846578221)*x[0]**o+(0.0092074168084)*x[0]+(0.852395533346)*x[1]**o+(-0.536392264791)*x[1]+(-0.937066324616)*x[2]**o+(0.164445148469)*x[2]
        s[0,3]=(0.334112468463)*x[0]**o+(-0.197414532294)*x[0]+(0.32282859646)*x[1]**o+(-0.829489106617)*x[1]+(0.637135896229)*x[2]**o+(-0.385346619948)*x[2]
        s[0,4]=(0.633179246285)*x[0]**o+(-0.775108312054)*x[0]+(-0.0275404480368)*x[1]**o+(-0.119328918403)*x[1]+(0.56571174294)*x[2]**o+(-0.306269532057)*x[2]
        s[1,0]=(-0.440298361388)*x[0]**o+(-0.644698995147)*x[0]+(-0.815801747709)*x[1]**o+(-0.347258269595)*x[1]+(-0.614702701308)*x[2]**o+(0.439358767152)*x[2]
        s[1,1]=(-0.397657154377)*x[0]**o+(0.529856649499)*x[0]+(-0.737187187383)*x[1]**o+(-0.242702727135)*x[1]+(-0.823515970874)*x[2]**o+(0.609907664585)*x[2]
        s[1,2]=(0.438570722796)*x[0]**o+(0.699038412356)*x[0]+(-0.731471431635)*x[1]**o+(0.334652466823)*x[1]+(0.728626361708)*x[2]**o+(0.140706080335)*x[2]
        s[1,3]=(0.445813070034)*x[0]**o+(-0.223359077861)*x[0]+(0.607122403242)*x[1]**o+(0.684390142218)*x[1]+(-0.0448436266022)*x[2]**o+(0.0177789962153)*x[2]
        s[1,4]=(-0.618164233561)*x[0]**o+(0.174313138771)*x[0]+(-0.891694340174)*x[1]**o+(-0.210641679269)*x[1]+(0.961104454395)*x[2]**o+(-0.335141946858)*x[2]
        s[2,0]=(0.824078577041)*x[0]**o+(-0.206045431624)*x[0]+(0.055588699321)*x[1]**o+(0.350116387216)*x[1]+(0.607866274938)*x[2]**o+(0.407638105768)*x[2]
        s[2,1]=(-0.210261210166)*x[0]**o+(-0.0133233759756)*x[0]+(0.801022275664)*x[1]**o+(-0.267209121471)*x[1]+(0.535577530444)*x[2]**o+(-0.541166709451)*x[2]
        s[2,2]=(0.346542013177)*x[0]**o+(0.305602431422)*x[0]+(0.45213719675)*x[1]**o+(0.32765019418)*x[1]+(0.367619644833)*x[2]**o+(0.933760631839)*x[2]
        s[2,3]=(-0.244955187752)*x[0]**o+(-0.645641982024)*x[0]+(0.0261013017433)*x[1]**o+(-0.230403895757)*x[1]+(0.201233200314)*x[2]**o+(-0.783467696033)*x[2]
        s[2,4]=(0.783620590334)*x[0]**o+(0.325268485711)*x[0]+(-0.912841443404)*x[1]**o+(-0.500647833534)*x[1]+(-0.980126267268)*x[2]**o+(-0.425755185755)*x[2]
        s[3,0]=(-0.4690769573)*x[0]**o+(-0.547691242018)*x[0]+(0.996570266539)*x[1]**o+(-0.472334765569)*x[1]+(0.81903298756)*x[2]**o+(-0.654817201284)*x[2]
        s[3,1]=(0.617564682102)*x[0]**o+(-0.991757850114)*x[0]+(-0.34214251344)*x[1]**o+(-0.321397198526)*x[1]+(0.503434489432)*x[2]**o+(0.683522308565)*x[2]
        s[3,2]=(0.999035085465)*x[0]**o+(0.431261164559)*x[0]+(0.660309836881)*x[1]**o+(0.596465902975)*x[1]+(-0.575064993246)*x[2]**o+(-0.290933980474)*x[2]
        s[3,3]=(0.355357213484)*x[0]**o+(-0.638400362695)*x[0]+(0.596482099946)*x[1]**o+(0.861245903515)*x[1]+(0.877992083876)*x[2]**o+(0.221520840799)*x[2]
        s[3,4]=(-0.0280956096914)*x[0]**o+(0.880536602898)*x[0]+(0.00969665494423)*x[1]**o+(-0.182537740984)*x[1]+(0.84927089239)*x[2]**o+(0.11423223273)*x[2]
        ref[0,0]=(-0.633916123904)/(o+1.)+(-0.0197231896285)+(-0.26796664441)*0.5**o
        ref[0,1]=(-0.33684688955)/(o+1.)+(-0.0568246849779)+(0.816233130972)*0.5**o
        ref[0,2]=(-0.0846707912707)/(o+1.)+(-0.181369849757)+(0.0115846578221)*0.5**o
        ref[0,3]=(0.959964492689)/(o+1.)+(-0.70612512943)+(0.334112468463)*0.5**o
        ref[0,4]=(0.538171294903)/(o+1.)+(-0.600353381257)+(0.633179246285)*0.5**o
        ref[1,0]=(-1.43050444902)/(o+1.)+(-0.276299248795)+(-0.440298361388)*0.5**o
        ref[1,1]=(-1.56070315826)/(o+1.)+(0.448530793475)+(-0.397657154377)*0.5**o
        ref[1,2]=(-0.00284506992628)/(o+1.)+(0.587198479757)+(0.438570722796)*0.5**o
        ref[1,3]=(0.56227877664)/(o+1.)+(0.239405030286)+(0.445813070034)*0.5**o
        ref[1,4]=(0.0694101142218)/(o+1.)+(-0.185735243678)+(-0.618164233561)*0.5**o
        ref[2,0]=(0.663454974259)/(o+1.)+(0.27585453068)+(0.824078577041)*0.5**o
        ref[2,1]=(1.33659980611)/(o+1.)+(-0.410849603449)+(-0.210261210166)*0.5**o
        ref[2,2]=(0.819756841583)/(o+1.)+(0.78350662872)+(0.346542013177)*0.5**o
        ref[2,3]=(0.227334502058)/(o+1.)+(-0.829756786907)+(-0.244955187752)*0.5**o
        ref[2,4]=(-1.89296771067)/(o+1.)+(-0.300567266789)+(0.783620590334)*0.5**o
        ref[3,0]=(1.8156032541)/(o+1.)+(-0.837421604436)+(-0.4690769573)*0.5**o
        ref[3,1]=(0.161291975992)/(o+1.)+(-0.314816370037)+(0.617564682102)*0.5**o
        ref[3,2]=(0.0852448436355)/(o+1.)+(0.36839654353)+(0.999035085465)*0.5**o
        ref[3,3]=(1.47447418382)/(o+1.)+(0.222183190809)+(0.355357213484)*0.5**o
        ref[3,4]=(0.858967547335)/(o+1.)+(0.406115547322)+(-0.0280956096914)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.230469008444)*x[0]**o+(0.508027324248)*x[0]+(0.696459735501)*x[1]**o+(-0.195259592119)*x[1]
        s[0,0,1]=(0.135411134228)*x[0]**o+(-0.684964577317)*x[0]+(0.804062624988)*x[1]**o+(0.388383344617)*x[1]
        s[0,1,0]=(-0.965361972117)*x[0]**o+(-0.0740755184742)*x[0]+(0.00222395987317)*x[1]**o+(0.116566925701)*x[1]
        s[0,1,1]=(0.773749135888)*x[0]**o+(-0.236062924811)*x[0]+(0.824300232936)*x[1]**o+(0.58451198061)*x[1]
        s[1,0,0]=(0.213202511915)*x[0]**o+(-0.0164093785777)*x[0]+(-0.152629558111)*x[1]**o+(-0.663542824781)*x[1]
        s[1,0,1]=(-0.446430833827)*x[0]**o+(0.643410978113)*x[0]+(0.35649029144)*x[1]**o+(-0.914705065197)*x[1]
        s[1,1,0]=(0.616559079235)*x[0]**o+(0.347804225396)*x[0]+(-0.733945941231)*x[1]**o+(0.49771373099)*x[1]
        s[1,1,1]=(-0.398631849965)*x[0]**o+(-0.854719511493)*x[0]+(0.501641783941)*x[1]**o+(0.360567791644)*x[1]
        s[2,0,0]=(0.404312756516)*x[0]**o+(0.805967978591)*x[0]+(0.980468298218)*x[1]**o+(0.368530205154)*x[1]
        s[2,0,1]=(0.92908409018)*x[0]**o+(0.984893826849)*x[0]+(-0.706723295076)*x[1]**o+(-0.68485578941)*x[1]
        s[2,1,0]=(-0.395198069725)*x[0]**o+(-0.865731577936)*x[0]+(0.284248647254)*x[1]**o+(0.199510619169)*x[1]
        s[2,1,1]=(-0.383178260681)*x[0]**o+(-0.0753678998731)*x[0]+(0.68853605046)*x[1]**o+(0.693301872966)*x[1]
        s[3,0,0]=(-0.504525570613)*x[0]**o+(-0.295454443098)*x[0]+(-0.85334585793)*x[1]**o+(-0.450742110681)*x[1]
        s[3,0,1]=(0.0306385968872)*x[0]**o+(-0.0918977201143)*x[0]+(-0.106665376273)*x[1]**o+(0.158103530025)*x[1]
        s[3,1,0]=(-0.371403581207)*x[0]**o+(0.662079642408)*x[0]+(0.818746082332)*x[1]**o+(0.601651002406)*x[1]
        s[3,1,1]=(-0.93523720418)*x[0]**o+(0.871800352376)*x[0]+(-0.294513821338)*x[1]**o+(-0.947893176361)*x[1]
        s[4,0,0]=(-0.734908326587)*x[0]**o+(0.481209886891)*x[0]+(0.61811626923)*x[1]**o+(-0.21778354281)*x[1]
        s[4,0,1]=(-0.689233989565)*x[0]**o+(0.1273357199)*x[0]+(0.398820148577)*x[1]**o+(0.538945475692)*x[1]
        s[4,1,0]=(0.885178741071)*x[0]**o+(-0.351046930859)*x[0]+(0.492384326646)*x[1]**o+(0.584584261959)*x[1]
        s[4,1,1]=(-0.561791063188)*x[0]**o+(0.701763941021)*x[0]+(-0.242041214153)*x[1]**o+(0.297044144162)*x[1]
        s[5,0,0]=(-0.487786682467)*x[0]**o+(-0.69717117402)*x[0]+(-0.308038610282)*x[1]**o+(0.966752012177)*x[1]
        s[5,0,1]=(0.26556821402)*x[0]**o+(-0.983047207652)*x[0]+(0.276098865961)*x[1]**o+(0.840073469203)*x[1]
        s[5,1,0]=(-0.152606883933)*x[0]**o+(-0.481720281304)*x[0]+(0.417680077266)*x[1]**o+(-0.882323563007)*x[1]
        s[5,1,1]=(0.0674752363532)*x[0]**o+(0.727094741288)*x[0]+(-0.299947571476)*x[1]**o+(0.391301157504)*x[1]
        ref[0,0,0]=(0.696459735501)/(o+1.)+(0.156383866065)+(0.230469008444)*0.5**o
        ref[0,0,1]=(0.804062624988)/(o+1.)+(-0.14829061635)+(0.135411134228)*0.5**o
        ref[0,1,0]=(0.00222395987317)/(o+1.)+(0.0212457036136)+(-0.965361972117)*0.5**o
        ref[0,1,1]=(0.824300232936)/(o+1.)+(0.174224527899)+(0.773749135888)*0.5**o
        ref[1,0,0]=(-0.152629558111)/(o+1.)+(-0.339976101679)+(0.213202511915)*0.5**o
        ref[1,0,1]=(0.35649029144)/(o+1.)+(-0.135647043542)+(-0.446430833827)*0.5**o
        ref[1,1,0]=(-0.733945941231)/(o+1.)+(0.422758978193)+(0.616559079235)*0.5**o
        ref[1,1,1]=(0.501641783941)/(o+1.)+(-0.247075859924)+(-0.398631849965)*0.5**o
        ref[2,0,0]=(0.980468298218)/(o+1.)+(0.587249091872)+(0.404312756516)*0.5**o
        ref[2,0,1]=(-0.706723295076)/(o+1.)+(0.15001901872)+(0.92908409018)*0.5**o
        ref[2,1,0]=(0.284248647254)/(o+1.)+(-0.333110479383)+(-0.395198069725)*0.5**o
        ref[2,1,1]=(0.68853605046)/(o+1.)+(0.308966986547)+(-0.383178260681)*0.5**o
        ref[3,0,0]=(-0.85334585793)/(o+1.)+(-0.37309827689)+(-0.504525570613)*0.5**o
        ref[3,0,1]=(-0.106665376273)/(o+1.)+(0.0331029049554)+(0.0306385968872)*0.5**o
        ref[3,1,0]=(0.818746082332)/(o+1.)+(0.631865322407)+(-0.371403581207)*0.5**o
        ref[3,1,1]=(-0.294513821338)/(o+1.)+(-0.0380464119924)+(-0.93523720418)*0.5**o
        ref[4,0,0]=(0.61811626923)/(o+1.)+(0.131713172041)+(-0.734908326587)*0.5**o
        ref[4,0,1]=(0.398820148577)/(o+1.)+(0.333140597796)+(-0.689233989565)*0.5**o
        ref[4,1,0]=(0.492384326646)/(o+1.)+(0.11676866555)+(0.885178741071)*0.5**o
        ref[4,1,1]=(-0.242041214153)/(o+1.)+(0.499404042592)+(-0.561791063188)*0.5**o
        ref[5,0,0]=(-0.308038610282)/(o+1.)+(0.134790419079)+(-0.487786682467)*0.5**o
        ref[5,0,1]=(0.276098865961)/(o+1.)+(-0.0714868692245)+(0.26556821402)*0.5**o
        ref[5,1,0]=(0.417680077266)/(o+1.)+(-0.682021922156)+(-0.152606883933)*0.5**o
        ref[5,1,1]=(-0.299947571476)/(o+1.)+(0.559197949396)+(0.0674752363532)*0.5**o
      else:
        s[0,0,0]=(-0.226564859572)*x[0]**o+(0.759975882725)*x[0]+(0.659032148551)*x[1]**o+(0.0807090996868)*x[1]+(-0.586765501877)*x[2]**o+(0.0274224545344)*x[2]
        s[0,0,1]=(0.926463229691)*x[0]**o+(0.134519539954)*x[0]+(0.976918539353)*x[1]**o+(-0.352762024083)*x[1]+(0.132042653159)*x[2]**o+(-0.686161947886)*x[2]
        s[0,1,0]=(0.371916775894)*x[0]**o+(-0.586490002548)*x[0]+(-0.304695527165)*x[1]**o+(0.440748639515)*x[1]+(-0.277758803854)*x[2]**o+(0.933648409631)*x[2]
        s[0,1,1]=(-0.871254388888)*x[0]**o+(-0.373959360688)*x[0]+(0.613060994689)*x[1]**o+(0.261906429329)*x[1]+(-0.0255596243956)*x[2]**o+(-0.912700299076)*x[2]
        s[1,0,0]=(0.0075965229641)*x[0]**o+(-0.977596529897)*x[0]+(0.160602293774)*x[1]**o+(-0.407220178255)*x[1]+(0.722872196439)*x[2]**o+(0.96683722852)*x[2]
        s[1,0,1]=(0.197284854866)*x[0]**o+(0.689180749331)*x[0]+(0.476641393876)*x[1]**o+(-0.575644071726)*x[1]+(-0.988391730968)*x[2]**o+(0.6278575683)*x[2]
        s[1,1,0]=(-0.968464883049)*x[0]**o+(0.415629727234)*x[0]+(0.698016769139)*x[1]**o+(0.967345907027)*x[1]+(0.0278637129728)*x[2]**o+(-0.895746388886)*x[2]
        s[1,1,1]=(-0.240984840545)*x[0]**o+(-0.0680920485806)*x[0]+(-0.159143749001)*x[1]**o+(-0.0595387242977)*x[1]+(0.564402939251)*x[2]**o+(-0.701335469294)*x[2]
        s[2,0,0]=(0.239124234745)*x[0]**o+(-0.86570078201)*x[0]+(-0.331189286269)*x[1]**o+(0.141412115059)*x[1]+(-0.498257980574)*x[2]**o+(-0.560030264671)*x[2]
        s[2,0,1]=(-0.126152295994)*x[0]**o+(0.220733769906)*x[0]+(0.293598600333)*x[1]**o+(0.0232185863704)*x[1]+(-0.277149571127)*x[2]**o+(0.686042508229)*x[2]
        s[2,1,0]=(-0.415700364121)*x[0]**o+(-0.998036555412)*x[0]+(0.932589123491)*x[1]**o+(0.474376426544)*x[1]+(0.868363410527)*x[2]**o+(0.20412367755)*x[2]
        s[2,1,1]=(-0.699650926538)*x[0]**o+(-0.885390927226)*x[0]+(0.315114808594)*x[1]**o+(0.0964378966171)*x[1]+(0.208547711734)*x[2]**o+(-0.234035721141)*x[2]
        s[3,0,0]=(-0.876365887814)*x[0]**o+(-0.809219980908)*x[0]+(-0.956629553931)*x[1]**o+(0.879512507986)*x[1]+(0.263252429544)*x[2]**o+(-0.0839386837172)*x[2]
        s[3,0,1]=(-0.667178396657)*x[0]**o+(-0.16553182711)*x[0]+(0.118512822439)*x[1]**o+(0.855526624871)*x[1]+(0.367375405597)*x[2]**o+(0.809554378159)*x[2]
        s[3,1,0]=(-0.822091423901)*x[0]**o+(0.805358337724)*x[0]+(-0.0169105328354)*x[1]**o+(0.911509787417)*x[1]+(0.201376799793)*x[2]**o+(-0.421841209698)*x[2]
        s[3,1,1]=(-0.924137416522)*x[0]**o+(-0.513720649867)*x[0]+(0.997645049075)*x[1]**o+(0.0427298712226)*x[1]+(0.0973602746566)*x[2]**o+(-0.210094600037)*x[2]
        s[4,0,0]=(-0.900263073705)*x[0]**o+(-0.348978017479)*x[0]+(-0.670123763869)*x[1]**o+(0.842214206909)*x[1]+(0.487852589522)*x[2]**o+(-0.990296977407)*x[2]
        s[4,0,1]=(0.733939716764)*x[0]**o+(0.802871411295)*x[0]+(-0.72554972641)*x[1]**o+(-0.675299974439)*x[1]+(-0.851276375175)*x[2]**o+(0.185926545414)*x[2]
        s[4,1,0]=(-0.00700280887647)*x[0]**o+(-0.588965317678)*x[0]+(-0.709984221808)*x[1]**o+(-0.278713234487)*x[1]+(0.571081276655)*x[2]**o+(-0.226676185948)*x[2]
        s[4,1,1]=(0.227749111196)*x[0]**o+(-0.682960403376)*x[0]+(0.26793708046)*x[1]**o+(-0.366550488255)*x[1]+(-0.888857273365)*x[2]**o+(0.0688817602584)*x[2]
        s[5,0,0]=(-0.125200843744)*x[0]**o+(-0.629160785496)*x[0]+(0.899283261399)*x[1]**o+(0.550308867618)*x[1]+(0.768807415182)*x[2]**o+(0.443292284662)*x[2]
        s[5,0,1]=(-0.0304781411569)*x[0]**o+(-0.560459929762)*x[0]+(0.588807987213)*x[1]**o+(0.330516228598)*x[1]+(-0.620114930397)*x[2]**o+(-0.598508456872)*x[2]
        s[5,1,0]=(0.538580607824)*x[0]**o+(0.0303519877944)*x[0]+(-0.26997035534)*x[1]**o+(0.364935864108)*x[1]+(0.748685142241)*x[2]**o+(0.0962889009161)*x[2]
        s[5,1,1]=(-0.54994010911)*x[0]**o+(0.159394722103)*x[0]+(-0.21371135673)*x[1]**o+(-0.395979383594)*x[1]+(-0.314185117077)*x[2]**o+(-0.204275202783)*x[2]
        ref[0,0,0]=(0.0722666466735)/(o+1.)+(0.434053718473)+(-0.226564859572)*0.5**o
        ref[0,0,1]=(1.10896119251)/(o+1.)+(-0.452202216007)+(0.926463229691)*0.5**o
        ref[0,1,0]=(-0.58245433102)/(o+1.)+(0.393953523299)+(0.371916775894)*0.5**o
        ref[0,1,1]=(0.587501370293)/(o+1.)+(-0.512376615217)+(-0.871254388888)*0.5**o
        ref[1,0,0]=(0.883474490213)/(o+1.)+(-0.208989739816)+(0.0075965229641)*0.5**o
        ref[1,0,1]=(-0.511750337092)/(o+1.)+(0.370697122953)+(0.197284854866)*0.5**o
        ref[1,1,0]=(0.725880482112)/(o+1.)+(0.243614622688)+(-0.968464883049)*0.5**o
        ref[1,1,1]=(0.405259190249)/(o+1.)+(-0.414483121086)+(-0.240984840545)*0.5**o
        ref[2,0,0]=(-0.829447266843)/(o+1.)+(-0.642159465811)+(0.239124234745)*0.5**o
        ref[2,0,1]=(0.0164490292067)/(o+1.)+(0.464997432253)+(-0.126152295994)*0.5**o
        ref[2,1,0]=(1.80095253402)/(o+1.)+(-0.159768225659)+(-0.415700364121)*0.5**o
        ref[2,1,1]=(0.523662520328)/(o+1.)+(-0.511494375875)+(-0.699650926538)*0.5**o
        ref[3,0,0]=(-0.693377124388)/(o+1.)+(-0.00682307831984)+(-0.876365887814)*0.5**o
        ref[3,0,1]=(0.485888228036)/(o+1.)+(0.74977458796)+(-0.667178396657)*0.5**o
        ref[3,1,0]=(0.184466266958)/(o+1.)+(0.647513457721)+(-0.822091423901)*0.5**o
        ref[3,1,1]=(1.09500532373)/(o+1.)+(-0.340542689341)+(-0.924137416522)*0.5**o
        ref[4,0,0]=(-0.182271174347)/(o+1.)+(-0.248530393989)+(-0.900263073705)*0.5**o
        ref[4,0,1]=(-1.57682610159)/(o+1.)+(0.156748991135)+(0.733939716764)*0.5**o
        ref[4,1,0]=(-0.138902945153)/(o+1.)+(-0.547177369056)+(-0.00700280887647)*0.5**o
        ref[4,1,1]=(-0.620920192905)/(o+1.)+(-0.490314565686)+(0.227749111196)*0.5**o
        ref[5,0,0]=(1.66809067658)/(o+1.)+(0.182220183392)+(-0.125200843744)*0.5**o
        ref[5,0,1]=(-0.0313069431837)/(o+1.)+(-0.414226079018)+(-0.0304781411569)*0.5**o
        ref[5,1,0]=(0.478714786901)/(o+1.)+(0.245788376409)+(0.538580607824)*0.5**o
        ref[5,1,1]=(-0.527896473807)/(o+1.)+(-0.220429932137)+(-0.54994010911)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.826151835054)*x[0]**o+(0.778522285868)*x[0]+(-0.798735149387)*x[1]**o+(-0.875242059866)*x[1]
        s[0,0,0,1]=(0.281853758764)*x[0]**o+(-0.194633585298)*x[0]+(-0.559216870357)*x[1]**o+(0.699122025971)*x[1]
        s[0,0,1,0]=(0.734893466243)*x[0]**o+(0.629132659777)*x[0]+(0.147096504378)*x[1]**o+(0.11035713758)*x[1]
        s[0,0,1,1]=(0.928300107915)*x[0]**o+(-0.334284397134)*x[0]+(-0.978653421141)*x[1]**o+(-0.523491002413)*x[1]
        s[0,0,2,0]=(-0.84104720017)*x[0]**o+(-0.977429111913)*x[0]+(0.975786707279)*x[1]**o+(0.202832002651)*x[1]
        s[0,0,2,1]=(0.505216717255)*x[0]**o+(0.893953504598)*x[0]+(-0.478609919678)*x[1]**o+(-0.0960789116423)*x[1]
        s[0,1,0,0]=(-0.588826769132)*x[0]**o+(-0.793581403019)*x[0]+(0.0325820539534)*x[1]**o+(0.479489246372)*x[1]
        s[0,1,0,1]=(0.201705696091)*x[0]**o+(0.807828768455)*x[0]+(0.943593904137)*x[1]**o+(0.805216955013)*x[1]
        s[0,1,1,0]=(0.458858343943)*x[0]**o+(0.687368390273)*x[0]+(0.106488644042)*x[1]**o+(-0.53370113771)*x[1]
        s[0,1,1,1]=(-0.445360193781)*x[0]**o+(-0.0579880476857)*x[0]+(0.164158781184)*x[1]**o+(0.610932454554)*x[1]
        s[0,1,2,0]=(0.631597276525)*x[0]**o+(-0.958557448004)*x[0]+(-0.484354639056)*x[1]**o+(0.151153827438)*x[1]
        s[0,1,2,1]=(-0.742804913722)*x[0]**o+(-0.841835209231)*x[0]+(-0.209463960361)*x[1]**o+(-0.858110011148)*x[1]
        s[0,2,0,0]=(-0.757921024916)*x[0]**o+(0.63659891937)*x[0]+(0.807935626935)*x[1]**o+(0.902142249374)*x[1]
        s[0,2,0,1]=(-0.256981783889)*x[0]**o+(-0.610855048181)*x[0]+(-0.574033583989)*x[1]**o+(0.776282494782)*x[1]
        s[0,2,1,0]=(-0.943218252718)*x[0]**o+(0.516037703505)*x[0]+(0.341543474661)*x[1]**o+(-0.240364780932)*x[1]
        s[0,2,1,1]=(0.792692625218)*x[0]**o+(-0.323976519304)*x[0]+(-0.0146665511353)*x[1]**o+(-0.735190429984)*x[1]
        s[0,2,2,0]=(-0.30799523168)*x[0]**o+(-0.679564713739)*x[0]+(0.459127847422)*x[1]**o+(0.232465201074)*x[1]
        s[0,2,2,1]=(-0.610374384606)*x[0]**o+(-0.953734773788)*x[0]+(0.548484423475)*x[1]**o+(-0.615367713658)*x[1]
        s[0,3,0,0]=(0.657511913357)*x[0]**o+(-0.145435401393)*x[0]+(0.994651694429)*x[1]**o+(0.384878777184)*x[1]
        s[0,3,0,1]=(0.583248456434)*x[0]**o+(-0.187182307545)*x[0]+(0.944791134312)*x[1]**o+(-0.186032769285)*x[1]
        s[0,3,1,0]=(-0.781508935766)*x[0]**o+(0.860022230884)*x[0]+(-0.101044667455)*x[1]**o+(-0.222316103336)*x[1]
        s[0,3,1,1]=(-0.867519386038)*x[0]**o+(0.929281502241)*x[0]+(-0.946297144806)*x[1]**o+(0.817224805708)*x[1]
        s[0,3,2,0]=(-0.281309467001)*x[0]**o+(-0.037739241916)*x[0]+(0.535177813023)*x[1]**o+(-0.729632726113)*x[1]
        s[0,3,2,1]=(-0.860996437102)*x[0]**o+(-0.0283243105523)*x[0]+(0.291253331071)*x[1]**o+(-0.49621519253)*x[1]
        s[0,4,0,0]=(-0.499079353771)*x[0]**o+(0.0512126982011)*x[0]+(-0.264697628051)*x[1]**o+(-0.557092064587)*x[1]
        s[0,4,0,1]=(0.886952704303)*x[0]**o+(0.835576589274)*x[0]+(0.436241831047)*x[1]**o+(0.205000756969)*x[1]
        s[0,4,1,0]=(-0.794113947126)*x[0]**o+(0.272838850139)*x[0]+(0.596844427835)*x[1]**o+(-0.0770378590458)*x[1]
        s[0,4,1,1]=(-0.0741729381021)*x[0]**o+(-0.352184991227)*x[0]+(-0.47050747773)*x[1]**o+(-0.0426137892879)*x[1]
        s[0,4,2,0]=(-0.574730110675)*x[0]**o+(0.72928953398)*x[0]+(0.570813169088)*x[1]**o+(-0.140526724895)*x[1]
        s[0,4,2,1]=(-0.956657753944)*x[0]**o+(0.83653343098)*x[0]+(0.156596161146)*x[1]**o+(0.565547857113)*x[1]
        s[1,0,0,0]=(-0.951078063957)*x[0]**o+(-0.76755461909)*x[0]+(0.889791199852)*x[1]**o+(-0.751303752794)*x[1]
        s[1,0,0,1]=(-0.601689692228)*x[0]**o+(-0.872977808857)*x[0]+(-0.216836641085)*x[1]**o+(-0.141390507272)*x[1]
        s[1,0,1,0]=(0.963503254167)*x[0]**o+(0.881676487866)*x[0]+(0.98286908038)*x[1]**o+(-0.387200882531)*x[1]
        s[1,0,1,1]=(-0.220998216482)*x[0]**o+(-0.942896953922)*x[0]+(-0.784318364616)*x[1]**o+(-0.117636798188)*x[1]
        s[1,0,2,0]=(-0.0629547087136)*x[0]**o+(0.375822895811)*x[0]+(0.297365047085)*x[1]**o+(-0.108671078054)*x[1]
        s[1,0,2,1]=(-0.898579538704)*x[0]**o+(-0.611755404412)*x[0]+(0.8150001419)*x[1]**o+(-0.956535007847)*x[1]
        s[1,1,0,0]=(-0.0983531790455)*x[0]**o+(0.399432233914)*x[0]+(0.455058141159)*x[1]**o+(-0.272367862823)*x[1]
        s[1,1,0,1]=(0.198516567418)*x[0]**o+(-0.599045119583)*x[0]+(-0.660954533474)*x[1]**o+(-0.138080345883)*x[1]
        s[1,1,1,0]=(-0.345947424795)*x[0]**o+(-0.112667218524)*x[0]+(0.389246060633)*x[1]**o+(0.554453113274)*x[1]
        s[1,1,1,1]=(-0.195677951352)*x[0]**o+(-0.926026514503)*x[0]+(0.206735465226)*x[1]**o+(0.789299584752)*x[1]
        s[1,1,2,0]=(0.286674162919)*x[0]**o+(-0.836060882258)*x[0]+(0.728613552854)*x[1]**o+(0.684001924365)*x[1]
        s[1,1,2,1]=(0.462677800728)*x[0]**o+(0.128558178852)*x[0]+(-0.234360929327)*x[1]**o+(-0.0906684049145)*x[1]
        s[1,2,0,0]=(-0.618359459011)*x[0]**o+(0.31224194045)*x[0]+(0.826946704031)*x[1]**o+(-0.383586867066)*x[1]
        s[1,2,0,1]=(0.79180929497)*x[0]**o+(-0.00403790010433)*x[0]+(-0.610232300686)*x[1]**o+(0.655034409375)*x[1]
        s[1,2,1,0]=(-0.454630490901)*x[0]**o+(-0.294433649415)*x[0]+(0.222616002742)*x[1]**o+(-0.880830082688)*x[1]
        s[1,2,1,1]=(-0.358323719668)*x[0]**o+(-0.506159090503)*x[0]+(-0.298070302518)*x[1]**o+(0.670788233813)*x[1]
        s[1,2,2,0]=(-0.953302373475)*x[0]**o+(0.262673942284)*x[0]+(0.293175442678)*x[1]**o+(0.327941364282)*x[1]
        s[1,2,2,1]=(0.0847099318446)*x[0]**o+(-0.378899343492)*x[0]+(-0.656552393979)*x[1]**o+(0.578336235439)*x[1]
        s[1,3,0,0]=(0.0792265074365)*x[0]**o+(-0.703381588828)*x[0]+(0.0644008346021)*x[1]**o+(-0.414604593416)*x[1]
        s[1,3,0,1]=(-0.312474679341)*x[0]**o+(0.117859249242)*x[0]+(-0.712500149358)*x[1]**o+(-0.160567536664)*x[1]
        s[1,3,1,0]=(0.0930078501772)*x[0]**o+(0.235241217821)*x[0]+(-0.74265516534)*x[1]**o+(-0.737722766295)*x[1]
        s[1,3,1,1]=(0.839924906913)*x[0]**o+(0.937666844502)*x[0]+(0.0794334270857)*x[1]**o+(0.863046562296)*x[1]
        s[1,3,2,0]=(0.154200394821)*x[0]**o+(-0.66290218047)*x[0]+(-0.206887854301)*x[1]**o+(0.504705955597)*x[1]
        s[1,3,2,1]=(0.427091397128)*x[0]**o+(0.646434479942)*x[0]+(-0.499236661621)*x[1]**o+(-0.97608178001)*x[1]
        s[1,4,0,0]=(0.993473425442)*x[0]**o+(-0.385478858515)*x[0]+(0.991785227798)*x[1]**o+(-0.317386719533)*x[1]
        s[1,4,0,1]=(0.905969952921)*x[0]**o+(0.580348604986)*x[0]+(-0.549435231471)*x[1]**o+(-0.864673820376)*x[1]
        s[1,4,1,0]=(-0.414114927962)*x[0]**o+(0.192124891008)*x[0]+(0.270145165409)*x[1]**o+(0.984593711748)*x[1]
        s[1,4,1,1]=(-0.537634564837)*x[0]**o+(-0.832898745236)*x[0]+(0.987067570291)*x[1]**o+(-0.829413594749)*x[1]
        s[1,4,2,0]=(0.298204375484)*x[0]**o+(0.595594979515)*x[0]+(0.691510051463)*x[1]**o+(0.404779663287)*x[1]
        s[1,4,2,1]=(0.924136889038)*x[0]**o+(-0.834498479792)*x[0]+(-0.0920482079502)*x[1]**o+(0.653266085415)*x[1]
        s[2,0,0,0]=(-0.623512868124)*x[0]**o+(-0.674266041327)*x[0]+(-0.0496779342723)*x[1]**o+(-0.0576390340208)*x[1]
        s[2,0,0,1]=(-0.675571390646)*x[0]**o+(0.212900825131)*x[0]+(-0.698331157728)*x[1]**o+(0.323039640381)*x[1]
        s[2,0,1,0]=(-0.137713646762)*x[0]**o+(0.678939423651)*x[0]+(0.724413391261)*x[1]**o+(-0.758331483567)*x[1]
        s[2,0,1,1]=(-0.790333229868)*x[0]**o+(0.0388624829814)*x[0]+(-0.163758448345)*x[1]**o+(0.749265467726)*x[1]
        s[2,0,2,0]=(0.401526106126)*x[0]**o+(-0.654255384177)*x[0]+(0.654866937965)*x[1]**o+(0.395353725816)*x[1]
        s[2,0,2,1]=(-0.691391545016)*x[0]**o+(0.576097089046)*x[0]+(-0.351703606836)*x[1]**o+(0.272891465932)*x[1]
        s[2,1,0,0]=(-0.994782416678)*x[0]**o+(0.417827176298)*x[0]+(0.933443347736)*x[1]**o+(0.729641898342)*x[1]
        s[2,1,0,1]=(0.888393462781)*x[0]**o+(0.0669727248876)*x[0]+(0.0751230852899)*x[1]**o+(0.79394522379)*x[1]
        s[2,1,1,0]=(-0.67951464573)*x[0]**o+(-0.398740440509)*x[0]+(-0.200110899369)*x[1]**o+(-0.0313062595594)*x[1]
        s[2,1,1,1]=(0.769634138219)*x[0]**o+(-0.873544326827)*x[0]+(-0.231357242392)*x[1]**o+(0.728827227861)*x[1]
        s[2,1,2,0]=(-0.740242586287)*x[0]**o+(0.779752812047)*x[0]+(-0.935858357069)*x[1]**o+(0.423733076889)*x[1]
        s[2,1,2,1]=(0.0522567442585)*x[0]**o+(-0.196246914879)*x[0]+(0.594009331267)*x[1]**o+(0.390510523467)*x[1]
        s[2,2,0,0]=(-0.202135247802)*x[0]**o+(0.406919371556)*x[0]+(0.336054961442)*x[1]**o+(-0.00656791632921)*x[1]
        s[2,2,0,1]=(-0.18797538396)*x[0]**o+(-0.502138169684)*x[0]+(0.728985032074)*x[1]**o+(-0.851899173542)*x[1]
        s[2,2,1,0]=(-0.1657521328)*x[0]**o+(-0.235483396897)*x[0]+(0.923860896997)*x[1]**o+(-0.534524775419)*x[1]
        s[2,2,1,1]=(0.318366946697)*x[0]**o+(-0.714726079393)*x[0]+(0.625778742556)*x[1]**o+(-0.364822812091)*x[1]
        s[2,2,2,0]=(0.796633973705)*x[0]**o+(0.20378716389)*x[0]+(-0.428464082609)*x[1]**o+(0.414097140984)*x[1]
        s[2,2,2,1]=(0.430909811076)*x[0]**o+(-0.711249875145)*x[0]+(0.234909867943)*x[1]**o+(0.469828473347)*x[1]
        s[2,3,0,0]=(0.0637185370545)*x[0]**o+(-0.347041553087)*x[0]+(-0.415901909163)*x[1]**o+(0.302973266512)*x[1]
        s[2,3,0,1]=(-0.0514048718664)*x[0]**o+(0.577688892083)*x[0]+(-0.847060157535)*x[1]**o+(-0.295910657349)*x[1]
        s[2,3,1,0]=(0.272384814885)*x[0]**o+(-0.457091092283)*x[0]+(0.294803721831)*x[1]**o+(0.863908100714)*x[1]
        s[2,3,1,1]=(-0.171649346026)*x[0]**o+(0.283285517302)*x[0]+(-0.525102967397)*x[1]**o+(0.517875061987)*x[1]
        s[2,3,2,0]=(-0.393961839836)*x[0]**o+(0.594690475758)*x[0]+(0.165742336314)*x[1]**o+(0.655933809047)*x[1]
        s[2,3,2,1]=(-0.911200880858)*x[0]**o+(0.182403795244)*x[0]+(0.489125521474)*x[1]**o+(0.0496056049896)*x[1]
        s[2,4,0,0]=(-0.159105772726)*x[0]**o+(0.625018347934)*x[0]+(-0.0170170509106)*x[1]**o+(0.302248488132)*x[1]
        s[2,4,0,1]=(0.898869898377)*x[0]**o+(-0.172540097096)*x[0]+(0.11416927686)*x[1]**o+(0.465614034585)*x[1]
        s[2,4,1,0]=(-0.72081868999)*x[0]**o+(-0.605232985848)*x[0]+(-0.889107167889)*x[1]**o+(-0.970389096931)*x[1]
        s[2,4,1,1]=(0.566591889778)*x[0]**o+(0.844421879775)*x[0]+(-0.68950638965)*x[1]**o+(-0.555658441668)*x[1]
        s[2,4,2,0]=(-0.677923523128)*x[0]**o+(-0.764792213508)*x[0]+(-0.940720806672)*x[1]**o+(-0.349132395924)*x[1]
        s[2,4,2,1]=(0.511357852175)*x[0]**o+(-0.688298821028)*x[0]+(0.260299341082)*x[1]**o+(-0.172719107959)*x[1]
        s[3,0,0,0]=(0.96250974067)*x[0]**o+(-0.126604059489)*x[0]+(-0.117880197012)*x[1]**o+(-0.914802074674)*x[1]
        s[3,0,0,1]=(0.149007631585)*x[0]**o+(-0.673349488321)*x[0]+(-0.993719500465)*x[1]**o+(-0.598353371432)*x[1]
        s[3,0,1,0]=(-0.808696105441)*x[0]**o+(-0.288375046884)*x[0]+(-0.770109544749)*x[1]**o+(0.830326211908)*x[1]
        s[3,0,1,1]=(-0.156477225552)*x[0]**o+(0.739349262635)*x[0]+(0.364144184522)*x[1]**o+(0.628195257168)*x[1]
        s[3,0,2,0]=(-0.447857061312)*x[0]**o+(0.974956110157)*x[0]+(-0.470610412287)*x[1]**o+(-0.576396903386)*x[1]
        s[3,0,2,1]=(-0.953524211957)*x[0]**o+(0.0172359158991)*x[0]+(-0.587968819301)*x[1]**o+(-0.0404250064791)*x[1]
        s[3,1,0,0]=(-0.438441555817)*x[0]**o+(-0.0863380014049)*x[0]+(-0.651726866234)*x[1]**o+(-0.757302907976)*x[1]
        s[3,1,0,1]=(0.365066315119)*x[0]**o+(0.252165659991)*x[0]+(-0.1682171231)*x[1]**o+(-0.597926603548)*x[1]
        s[3,1,1,0]=(-0.0608091331878)*x[0]**o+(-0.118607423591)*x[0]+(0.572219801453)*x[1]**o+(-0.620635555103)*x[1]
        s[3,1,1,1]=(-0.258140275212)*x[0]**o+(0.106650435513)*x[0]+(-0.739971594229)*x[1]**o+(0.595195330003)*x[1]
        s[3,1,2,0]=(-0.229810808135)*x[0]**o+(-0.891173708591)*x[0]+(0.257932505524)*x[1]**o+(0.561295616991)*x[1]
        s[3,1,2,1]=(-0.579302432005)*x[0]**o+(0.607984452716)*x[0]+(-0.155861940983)*x[1]**o+(0.388572816738)*x[1]
        s[3,2,0,0]=(0.87799491053)*x[0]**o+(0.434743191656)*x[0]+(0.219633220676)*x[1]**o+(-0.515493145923)*x[1]
        s[3,2,0,1]=(-0.855493053888)*x[0]**o+(0.173518924283)*x[0]+(0.0675155754173)*x[1]**o+(-0.700260220492)*x[1]
        s[3,2,1,0]=(-0.412519942294)*x[0]**o+(-0.0114933134972)*x[0]+(0.232846893376)*x[1]**o+(0.272202827241)*x[1]
        s[3,2,1,1]=(0.325402950163)*x[0]**o+(-0.455151259934)*x[0]+(0.88929658634)*x[1]**o+(0.147699225253)*x[1]
        s[3,2,2,0]=(-0.246804489391)*x[0]**o+(0.626746060036)*x[0]+(0.70088034171)*x[1]**o+(-0.492021577395)*x[1]
        s[3,2,2,1]=(0.161987385265)*x[0]**o+(-0.038894607114)*x[0]+(-0.326936847239)*x[1]**o+(0.181111852946)*x[1]
        s[3,3,0,0]=(-0.287388091741)*x[0]**o+(0.516752550941)*x[0]+(-0.941603336187)*x[1]**o+(0.549867040053)*x[1]
        s[3,3,0,1]=(-0.711983817048)*x[0]**o+(-0.257572806886)*x[0]+(-0.441118042147)*x[1]**o+(-0.672544376584)*x[1]
        s[3,3,1,0]=(0.27179221385)*x[0]**o+(0.722679194783)*x[0]+(0.154628962433)*x[1]**o+(0.406406592446)*x[1]
        s[3,3,1,1]=(-0.484359850969)*x[0]**o+(-0.179916115792)*x[0]+(-0.461756438449)*x[1]**o+(-0.484596755972)*x[1]
        s[3,3,2,0]=(0.06709022871)*x[0]**o+(0.79525514856)*x[0]+(0.815544226952)*x[1]**o+(-0.498264422355)*x[1]
        s[3,3,2,1]=(0.843256724396)*x[0]**o+(0.0796294835103)*x[0]+(0.301414364597)*x[1]**o+(0.790478221822)*x[1]
        s[3,4,0,0]=(0.723595119935)*x[0]**o+(-0.757921136678)*x[0]+(-0.823917708581)*x[1]**o+(0.0624785383724)*x[1]
        s[3,4,0,1]=(0.733680579182)*x[0]**o+(-0.383756889549)*x[0]+(0.161828894605)*x[1]**o+(-0.192838756613)*x[1]
        s[3,4,1,0]=(0.147016857318)*x[0]**o+(0.0580828047654)*x[0]+(-0.628782245085)*x[1]**o+(-0.607487083314)*x[1]
        s[3,4,1,1]=(-0.0882094727061)*x[0]**o+(0.790852741583)*x[0]+(0.47412676393)*x[1]**o+(-0.873733941999)*x[1]
        s[3,4,2,0]=(0.0294423769171)*x[0]**o+(0.522861977201)*x[0]+(-0.360682765428)*x[1]**o+(-0.460704794865)*x[1]
        s[3,4,2,1]=(0.143274846749)*x[0]**o+(-0.164306681884)*x[0]+(0.632228849654)*x[1]**o+(-0.488837677105)*x[1]
        ref[0,0,0,0]=(-0.798735149387)/(o+1.)+(-0.0483598869992)+(0.826151835054)*0.5**o
        ref[0,0,0,1]=(-0.559216870357)/(o+1.)+(0.252244220336)+(0.281853758764)*0.5**o
        ref[0,0,1,0]=(0.147096504378)/(o+1.)+(0.369744898679)+(0.734893466243)*0.5**o
        ref[0,0,1,1]=(-0.978653421141)/(o+1.)+(-0.428887699773)+(0.928300107915)*0.5**o
        ref[0,0,2,0]=(0.975786707279)/(o+1.)+(-0.387298554631)+(-0.84104720017)*0.5**o
        ref[0,0,2,1]=(-0.478609919678)/(o+1.)+(0.398937296478)+(0.505216717255)*0.5**o
        ref[0,1,0,0]=(0.0325820539534)/(o+1.)+(-0.157046078324)+(-0.588826769132)*0.5**o
        ref[0,1,0,1]=(0.943593904137)/(o+1.)+(0.806522861734)+(0.201705696091)*0.5**o
        ref[0,1,1,0]=(0.106488644042)/(o+1.)+(0.0768336262816)+(0.458858343943)*0.5**o
        ref[0,1,1,1]=(0.164158781184)/(o+1.)+(0.276472203434)+(-0.445360193781)*0.5**o
        ref[0,1,2,0]=(-0.484354639056)/(o+1.)+(-0.403701810283)+(0.631597276525)*0.5**o
        ref[0,1,2,1]=(-0.209463960361)/(o+1.)+(-0.84997261019)+(-0.742804913722)*0.5**o
        ref[0,2,0,0]=(0.807935626935)/(o+1.)+(0.769370584372)+(-0.757921024916)*0.5**o
        ref[0,2,0,1]=(-0.574033583989)/(o+1.)+(0.0827137233007)+(-0.256981783889)*0.5**o
        ref[0,2,1,0]=(0.341543474661)/(o+1.)+(0.137836461287)+(-0.943218252718)*0.5**o
        ref[0,2,1,1]=(-0.0146665511353)/(o+1.)+(-0.529583474644)+(0.792692625218)*0.5**o
        ref[0,2,2,0]=(0.459127847422)/(o+1.)+(-0.223549756332)+(-0.30799523168)*0.5**o
        ref[0,2,2,1]=(0.548484423475)/(o+1.)+(-0.784551243723)+(-0.610374384606)*0.5**o
        ref[0,3,0,0]=(0.994651694429)/(o+1.)+(0.119721687896)+(0.657511913357)*0.5**o
        ref[0,3,0,1]=(0.944791134312)/(o+1.)+(-0.186607538415)+(0.583248456434)*0.5**o
        ref[0,3,1,0]=(-0.101044667455)/(o+1.)+(0.318853063774)+(-0.781508935766)*0.5**o
        ref[0,3,1,1]=(-0.946297144806)/(o+1.)+(0.873253153974)+(-0.867519386038)*0.5**o
        ref[0,3,2,0]=(0.535177813023)/(o+1.)+(-0.383685984015)+(-0.281309467001)*0.5**o
        ref[0,3,2,1]=(0.291253331071)/(o+1.)+(-0.262269751541)+(-0.860996437102)*0.5**o
        ref[0,4,0,0]=(-0.264697628051)/(o+1.)+(-0.252939683193)+(-0.499079353771)*0.5**o
        ref[0,4,0,1]=(0.436241831047)/(o+1.)+(0.520288673122)+(0.886952704303)*0.5**o
        ref[0,4,1,0]=(0.596844427835)/(o+1.)+(0.0979004955464)+(-0.794113947126)*0.5**o
        ref[0,4,1,1]=(-0.47050747773)/(o+1.)+(-0.197399390257)+(-0.0741729381021)*0.5**o
        ref[0,4,2,0]=(0.570813169088)/(o+1.)+(0.294381404543)+(-0.574730110675)*0.5**o
        ref[0,4,2,1]=(0.156596161146)/(o+1.)+(0.701040644046)+(-0.956657753944)*0.5**o
        ref[1,0,0,0]=(0.889791199852)/(o+1.)+(-0.759429185942)+(-0.951078063957)*0.5**o
        ref[1,0,0,1]=(-0.216836641085)/(o+1.)+(-0.507184158064)+(-0.601689692228)*0.5**o
        ref[1,0,1,0]=(0.98286908038)/(o+1.)+(0.247237802667)+(0.963503254167)*0.5**o
        ref[1,0,1,1]=(-0.784318364616)/(o+1.)+(-0.530266876055)+(-0.220998216482)*0.5**o
        ref[1,0,2,0]=(0.297365047085)/(o+1.)+(0.133575908879)+(-0.0629547087136)*0.5**o
        ref[1,0,2,1]=(0.8150001419)/(o+1.)+(-0.784145206129)+(-0.898579538704)*0.5**o
        ref[1,1,0,0]=(0.455058141159)/(o+1.)+(0.0635321855459)+(-0.0983531790455)*0.5**o
        ref[1,1,0,1]=(-0.660954533474)/(o+1.)+(-0.368562732733)+(0.198516567418)*0.5**o
        ref[1,1,1,0]=(0.389246060633)/(o+1.)+(0.220892947375)+(-0.345947424795)*0.5**o
        ref[1,1,1,1]=(0.206735465226)/(o+1.)+(-0.0683634648758)+(-0.195677951352)*0.5**o
        ref[1,1,2,0]=(0.728613552854)/(o+1.)+(-0.0760294789467)+(0.286674162919)*0.5**o
        ref[1,1,2,1]=(-0.234360929327)/(o+1.)+(0.0189448869689)+(0.462677800728)*0.5**o
        ref[1,2,0,0]=(0.826946704031)/(o+1.)+(-0.035672463308)+(-0.618359459011)*0.5**o
        ref[1,2,0,1]=(-0.610232300686)/(o+1.)+(0.325498254635)+(0.79180929497)*0.5**o
        ref[1,2,1,0]=(0.222616002742)/(o+1.)+(-0.587631866051)+(-0.454630490901)*0.5**o
        ref[1,2,1,1]=(-0.298070302518)/(o+1.)+(0.082314571655)+(-0.358323719668)*0.5**o
        ref[1,2,2,0]=(0.293175442678)/(o+1.)+(0.295307653283)+(-0.953302373475)*0.5**o
        ref[1,2,2,1]=(-0.656552393979)/(o+1.)+(0.0997184459739)+(0.0847099318446)*0.5**o
        ref[1,3,0,0]=(0.0644008346021)/(o+1.)+(-0.558993091122)+(0.0792265074365)*0.5**o
        ref[1,3,0,1]=(-0.712500149358)/(o+1.)+(-0.021354143711)+(-0.312474679341)*0.5**o
        ref[1,3,1,0]=(-0.74265516534)/(o+1.)+(-0.251240774237)+(0.0930078501772)*0.5**o
        ref[1,3,1,1]=(0.0794334270857)/(o+1.)+(0.900356703399)+(0.839924906913)*0.5**o
        ref[1,3,2,0]=(-0.206887854301)/(o+1.)+(-0.0790981124364)+(0.154200394821)*0.5**o
        ref[1,3,2,1]=(-0.499236661621)/(o+1.)+(-0.164823650034)+(0.427091397128)*0.5**o
        ref[1,4,0,0]=(0.991785227798)/(o+1.)+(-0.351432789024)+(0.993473425442)*0.5**o
        ref[1,4,0,1]=(-0.549435231471)/(o+1.)+(-0.142162607695)+(0.905969952921)*0.5**o
        ref[1,4,1,0]=(0.270145165409)/(o+1.)+(0.588359301378)+(-0.414114927962)*0.5**o
        ref[1,4,1,1]=(0.987067570291)/(o+1.)+(-0.831156169992)+(-0.537634564837)*0.5**o
        ref[1,4,2,0]=(0.691510051463)/(o+1.)+(0.500187321401)+(0.298204375484)*0.5**o
        ref[1,4,2,1]=(-0.0920482079502)/(o+1.)+(-0.0906161971883)+(0.924136889038)*0.5**o
        ref[2,0,0,0]=(-0.0496779342723)/(o+1.)+(-0.365952537674)+(-0.623512868124)*0.5**o
        ref[2,0,0,1]=(-0.698331157728)/(o+1.)+(0.267970232756)+(-0.675571390646)*0.5**o
        ref[2,0,1,0]=(0.724413391261)/(o+1.)+(-0.0396960299582)+(-0.137713646762)*0.5**o
        ref[2,0,1,1]=(-0.163758448345)/(o+1.)+(0.394063975354)+(-0.790333229868)*0.5**o
        ref[2,0,2,0]=(0.654866937965)/(o+1.)+(-0.12945082918)+(0.401526106126)*0.5**o
        ref[2,0,2,1]=(-0.351703606836)/(o+1.)+(0.424494277489)+(-0.691391545016)*0.5**o
        ref[2,1,0,0]=(0.933443347736)/(o+1.)+(0.57373453732)+(-0.994782416678)*0.5**o
        ref[2,1,0,1]=(0.0751230852899)/(o+1.)+(0.430458974339)+(0.888393462781)*0.5**o
        ref[2,1,1,0]=(-0.200110899369)/(o+1.)+(-0.215023350034)+(-0.67951464573)*0.5**o
        ref[2,1,1,1]=(-0.231357242392)/(o+1.)+(-0.0723585494832)+(0.769634138219)*0.5**o
        ref[2,1,2,0]=(-0.935858357069)/(o+1.)+(0.601742944468)+(-0.740242586287)*0.5**o
        ref[2,1,2,1]=(0.594009331267)/(o+1.)+(0.0971318042938)+(0.0522567442585)*0.5**o
        ref[2,2,0,0]=(0.336054961442)/(o+1.)+(0.200175727613)+(-0.202135247802)*0.5**o
        ref[2,2,0,1]=(0.728985032074)/(o+1.)+(-0.677018671613)+(-0.18797538396)*0.5**o
        ref[2,2,1,0]=(0.923860896997)/(o+1.)+(-0.385004086158)+(-0.1657521328)*0.5**o
        ref[2,2,1,1]=(0.625778742556)/(o+1.)+(-0.539774445742)+(0.318366946697)*0.5**o
        ref[2,2,2,0]=(-0.428464082609)/(o+1.)+(0.308942152437)+(0.796633973705)*0.5**o
        ref[2,2,2,1]=(0.234909867943)/(o+1.)+(-0.120710700899)+(0.430909811076)*0.5**o
        ref[2,3,0,0]=(-0.415901909163)/(o+1.)+(-0.0220341432872)+(0.0637185370545)*0.5**o
        ref[2,3,0,1]=(-0.847060157535)/(o+1.)+(0.140889117367)+(-0.0514048718664)*0.5**o
        ref[2,3,1,0]=(0.294803721831)/(o+1.)+(0.203408504215)+(0.272384814885)*0.5**o
        ref[2,3,1,1]=(-0.525102967397)/(o+1.)+(0.400580289645)+(-0.171649346026)*0.5**o
        ref[2,3,2,0]=(0.165742336314)/(o+1.)+(0.625312142402)+(-0.393961839836)*0.5**o
        ref[2,3,2,1]=(0.489125521474)/(o+1.)+(0.116004700117)+(-0.911200880858)*0.5**o
        ref[2,4,0,0]=(-0.0170170509106)/(o+1.)+(0.463633418033)+(-0.159105772726)*0.5**o
        ref[2,4,0,1]=(0.11416927686)/(o+1.)+(0.146536968744)+(0.898869898377)*0.5**o
        ref[2,4,1,0]=(-0.889107167889)/(o+1.)+(-0.78781104139)+(-0.72081868999)*0.5**o
        ref[2,4,1,1]=(-0.68950638965)/(o+1.)+(0.144381719054)+(0.566591889778)*0.5**o
        ref[2,4,2,0]=(-0.940720806672)/(o+1.)+(-0.556962304716)+(-0.677923523128)*0.5**o
        ref[2,4,2,1]=(0.260299341082)/(o+1.)+(-0.430508964494)+(0.511357852175)*0.5**o
        ref[3,0,0,0]=(-0.117880197012)/(o+1.)+(-0.520703067081)+(0.96250974067)*0.5**o
        ref[3,0,0,1]=(-0.993719500465)/(o+1.)+(-0.635851429876)+(0.149007631585)*0.5**o
        ref[3,0,1,0]=(-0.770109544749)/(o+1.)+(0.270975582512)+(-0.808696105441)*0.5**o
        ref[3,0,1,1]=(0.364144184522)/(o+1.)+(0.683772259902)+(-0.156477225552)*0.5**o
        ref[3,0,2,0]=(-0.470610412287)/(o+1.)+(0.199279603385)+(-0.447857061312)*0.5**o
        ref[3,0,2,1]=(-0.587968819301)/(o+1.)+(-0.01159454529)+(-0.953524211957)*0.5**o
        ref[3,1,0,0]=(-0.651726866234)/(o+1.)+(-0.42182045469)+(-0.438441555817)*0.5**o
        ref[3,1,0,1]=(-0.1682171231)/(o+1.)+(-0.172880471778)+(0.365066315119)*0.5**o
        ref[3,1,1,0]=(0.572219801453)/(o+1.)+(-0.369621489347)+(-0.0608091331878)*0.5**o
        ref[3,1,1,1]=(-0.739971594229)/(o+1.)+(0.350922882758)+(-0.258140275212)*0.5**o
        ref[3,1,2,0]=(0.257932505524)/(o+1.)+(-0.1649390458)+(-0.229810808135)*0.5**o
        ref[3,1,2,1]=(-0.155861940983)/(o+1.)+(0.498278634727)+(-0.579302432005)*0.5**o
        ref[3,2,0,0]=(0.219633220676)/(o+1.)+(-0.0403749771337)+(0.87799491053)*0.5**o
        ref[3,2,0,1]=(0.0675155754173)/(o+1.)+(-0.263370648105)+(-0.855493053888)*0.5**o
        ref[3,2,1,0]=(0.232846893376)/(o+1.)+(0.130354756872)+(-0.412519942294)*0.5**o
        ref[3,2,1,1]=(0.88929658634)/(o+1.)+(-0.15372601734)+(0.325402950163)*0.5**o
        ref[3,2,2,0]=(0.70088034171)/(o+1.)+(0.0673622413205)+(-0.246804489391)*0.5**o
        ref[3,2,2,1]=(-0.326936847239)/(o+1.)+(0.071108622916)+(0.161987385265)*0.5**o
        ref[3,3,0,0]=(-0.941603336187)/(o+1.)+(0.533309795497)+(-0.287388091741)*0.5**o
        ref[3,3,0,1]=(-0.441118042147)/(o+1.)+(-0.465058591735)+(-0.711983817048)*0.5**o
        ref[3,3,1,0]=(0.154628962433)/(o+1.)+(0.564542893615)+(0.27179221385)*0.5**o
        ref[3,3,1,1]=(-0.461756438449)/(o+1.)+(-0.332256435882)+(-0.484359850969)*0.5**o
        ref[3,3,2,0]=(0.815544226952)/(o+1.)+(0.148495363102)+(0.06709022871)*0.5**o
        ref[3,3,2,1]=(0.301414364597)/(o+1.)+(0.435053852666)+(0.843256724396)*0.5**o
        ref[3,4,0,0]=(-0.823917708581)/(o+1.)+(-0.347721299153)+(0.723595119935)*0.5**o
        ref[3,4,0,1]=(0.161828894605)/(o+1.)+(-0.288297823081)+(0.733680579182)*0.5**o
        ref[3,4,1,0]=(-0.628782245085)/(o+1.)+(-0.274702139274)+(0.147016857318)*0.5**o
        ref[3,4,1,1]=(0.47412676393)/(o+1.)+(-0.0414406002081)+(-0.0882094727061)*0.5**o
        ref[3,4,2,0]=(-0.360682765428)/(o+1.)+(0.0310785911681)+(0.0294423769171)*0.5**o
        ref[3,4,2,1]=(0.632228849654)/(o+1.)+(-0.326572179494)+(0.143274846749)*0.5**o
      else:
        s[0,0,0,0]=(0.356314179645)*x[0]**o+(-0.32357850671)*x[0]+(-0.824656670425)*x[1]**o+(-0.627681417632)*x[1]+(-0.269037662166)*x[2]**o+(-0.506111289647)*x[2]
        s[0,0,0,1]=(0.209589534917)*x[0]**o+(-0.245850334755)*x[0]+(-0.933340495998)*x[1]**o+(-0.091551513676)*x[1]+(-0.903932207206)*x[2]**o+(-0.462176705079)*x[2]
        s[0,0,1,0]=(-0.242847848445)*x[0]**o+(-0.303798875175)*x[0]+(-0.89496979627)*x[1]**o+(-0.442220551)*x[1]+(0.686085734196)*x[2]**o+(-0.422307267905)*x[2]
        s[0,0,1,1]=(0.255545417045)*x[0]**o+(0.0456454977479)*x[0]+(-0.378619350633)*x[1]**o+(0.720981703656)*x[1]+(0.251875164005)*x[2]**o+(-0.220351133411)*x[2]
        s[0,0,2,0]=(-0.962070081459)*x[0]**o+(0.697584448738)*x[0]+(0.855321986438)*x[1]**o+(0.818489831335)*x[1]+(-0.892304050049)*x[2]**o+(0.609699703411)*x[2]
        s[0,0,2,1]=(0.636687005195)*x[0]**o+(-0.4086000867)*x[0]+(-0.0426817477748)*x[1]**o+(-0.842690837453)*x[1]+(-0.704599957019)*x[2]**o+(0.518333776253)*x[2]
        s[0,1,0,0]=(0.521790025796)*x[0]**o+(-0.987699503457)*x[0]+(0.0903316739912)*x[1]**o+(0.307827334512)*x[1]+(-0.401791463687)*x[2]**o+(-0.702368788162)*x[2]
        s[0,1,0,1]=(-0.642544941536)*x[0]**o+(-0.881565606872)*x[0]+(-0.863360075641)*x[1]**o+(0.927565055153)*x[1]+(0.286728291693)*x[2]**o+(0.0652315285371)*x[2]
        s[0,1,1,0]=(0.987946287729)*x[0]**o+(-0.95542434477)*x[0]+(0.876907614088)*x[1]**o+(0.917353337436)*x[1]+(-0.40420250407)*x[2]**o+(-0.984390334421)*x[2]
        s[0,1,1,1]=(-0.848091494031)*x[0]**o+(0.205692942903)*x[0]+(0.804893714353)*x[1]**o+(0.34369751042)*x[1]+(-0.948317185277)*x[2]**o+(-0.937737932921)*x[2]
        s[0,1,2,0]=(-0.411836604088)*x[0]**o+(-0.520147883853)*x[0]+(0.10615721253)*x[1]**o+(0.674921463188)*x[1]+(0.245733286882)*x[2]**o+(-0.653168166924)*x[2]
        s[0,1,2,1]=(0.0397981165279)*x[0]**o+(0.667676059311)*x[0]+(0.720734430282)*x[1]**o+(-0.232075762355)*x[1]+(-0.558842944595)*x[2]**o+(0.39581457339)*x[2]
        s[0,2,0,0]=(-0.043373970003)*x[0]**o+(0.797078438464)*x[0]+(-0.488567358998)*x[1]**o+(0.0955394876958)*x[1]+(0.469780932691)*x[2]**o+(0.665728903694)*x[2]
        s[0,2,0,1]=(0.204098937116)*x[0]**o+(0.16435985408)*x[0]+(-0.245228652593)*x[1]**o+(-0.423628218893)*x[1]+(-0.0691452707964)*x[2]**o+(-0.709704899728)*x[2]
        s[0,2,1,0]=(0.506878702079)*x[0]**o+(0.740560436601)*x[0]+(0.193885598321)*x[1]**o+(0.521852898085)*x[1]+(0.0368080590022)*x[2]**o+(0.986970659964)*x[2]
        s[0,2,1,1]=(-0.261656641804)*x[0]**o+(-0.407521171557)*x[0]+(0.966151887826)*x[1]**o+(-0.918908288322)*x[1]+(-0.370153374393)*x[2]**o+(0.236661704457)*x[2]
        s[0,2,2,0]=(-0.491629682103)*x[0]**o+(-0.593057448837)*x[0]+(-0.022126429921)*x[1]**o+(-0.509356725061)*x[1]+(-0.680259680283)*x[2]**o+(-0.889690558667)*x[2]
        s[0,2,2,1]=(-0.564089634025)*x[0]**o+(0.0574486294037)*x[0]+(0.0578539449865)*x[1]**o+(0.258278489918)*x[1]+(0.174461168842)*x[2]**o+(0.0842548610258)*x[2]
        s[0,3,0,0]=(0.0606363217868)*x[0]**o+(0.160338081583)*x[0]+(-0.0636204375814)*x[1]**o+(0.287489206156)*x[1]+(-0.592019780262)*x[2]**o+(0.508884293667)*x[2]
        s[0,3,0,1]=(-0.702879071079)*x[0]**o+(0.874961299195)*x[0]+(-0.00733354592216)*x[1]**o+(0.0223647905227)*x[1]+(0.956232905909)*x[2]**o+(0.369832655586)*x[2]
        s[0,3,1,0]=(-0.824855043544)*x[0]**o+(-0.529925913352)*x[0]+(-0.0897704543542)*x[1]**o+(0.655124384268)*x[1]+(-0.586221756018)*x[2]**o+(0.104165560368)*x[2]
        s[0,3,1,1]=(-0.890319589507)*x[0]**o+(0.791154767703)*x[0]+(-0.315134766255)*x[1]**o+(-0.384720188852)*x[1]+(0.130920946919)*x[2]**o+(0.894095912396)*x[2]
        s[0,3,2,0]=(0.366123401919)*x[0]**o+(0.806533885372)*x[0]+(-0.579579932468)*x[1]**o+(0.490534769858)*x[1]+(0.250581383716)*x[2]**o+(-0.326970590496)*x[2]
        s[0,3,2,1]=(-0.438035010616)*x[0]**o+(-0.630762254554)*x[0]+(0.0848919367225)*x[1]**o+(-0.872733528687)*x[1]+(-0.465429840653)*x[2]**o+(0.567524409476)*x[2]
        s[0,4,0,0]=(0.319555220189)*x[0]**o+(0.397272010924)*x[0]+(-0.827915669722)*x[1]**o+(-0.0370119836485)*x[1]+(0.232621621392)*x[2]**o+(0.376285172425)*x[2]
        s[0,4,0,1]=(-0.874144853872)*x[0]**o+(0.740754812769)*x[0]+(0.878074282473)*x[1]**o+(-0.168290826137)*x[1]+(-0.0466881676326)*x[2]**o+(0.997360121528)*x[2]
        s[0,4,1,0]=(0.622984208352)*x[0]**o+(-0.60223710711)*x[0]+(-0.684599543294)*x[1]**o+(-0.654758989528)*x[1]+(-0.209806071733)*x[2]**o+(0.0331737697413)*x[2]
        s[0,4,1,1]=(-0.175155841122)*x[0]**o+(-0.73030489546)*x[0]+(0.226809166193)*x[1]**o+(-0.242344848157)*x[1]+(-0.331283539462)*x[2]**o+(-0.392781337615)*x[2]
        s[0,4,2,0]=(0.111634467654)*x[0]**o+(-0.0622591150598)*x[0]+(-0.675485413951)*x[1]**o+(-0.0169689015565)*x[1]+(-0.373014699305)*x[2]**o+(-0.827576200434)*x[2]
        s[0,4,2,1]=(0.769210305419)*x[0]**o+(-0.380741842544)*x[0]+(-0.0136492374016)*x[1]**o+(0.231367701468)*x[1]+(-0.156422804273)*x[2]**o+(0.69522180005)*x[2]
        s[1,0,0,0]=(-0.907821074278)*x[0]**o+(-0.466564046295)*x[0]+(-0.0115096148313)*x[1]**o+(0.682571066758)*x[1]+(-0.188270659989)*x[2]**o+(0.769027925506)*x[2]
        s[1,0,0,1]=(-0.935692950448)*x[0]**o+(0.801782734141)*x[0]+(-0.694482272453)*x[1]**o+(-0.357697785902)*x[1]+(0.604605447034)*x[2]**o+(-0.484488572975)*x[2]
        s[1,0,1,0]=(0.958399972856)*x[0]**o+(0.684229220211)*x[0]+(0.952743494375)*x[1]**o+(0.247944736517)*x[1]+(-0.251674820491)*x[2]**o+(-0.948785335663)*x[2]
        s[1,0,1,1]=(0.480962582731)*x[0]**o+(-0.233075914633)*x[0]+(-0.407820663337)*x[1]**o+(0.74897610034)*x[1]+(0.869138425397)*x[2]**o+(-0.115144267319)*x[2]
        s[1,0,2,0]=(-0.459646484527)*x[0]**o+(-0.42415176628)*x[0]+(0.361277035435)*x[1]**o+(-0.894956929165)*x[1]+(-0.710531250988)*x[2]**o+(-0.0704645482372)*x[2]
        s[1,0,2,1]=(-0.663523285059)*x[0]**o+(0.42693709011)*x[0]+(-0.225209635066)*x[1]**o+(0.505033755104)*x[1]+(-0.612237573846)*x[2]**o+(-0.824405122543)*x[2]
        s[1,1,0,0]=(-0.963081878353)*x[0]**o+(-0.318420605399)*x[0]+(-0.841731614457)*x[1]**o+(0.0524113793424)*x[1]+(0.824353304271)*x[2]**o+(-0.347662639363)*x[2]
        s[1,1,0,1]=(-0.426340341727)*x[0]**o+(-0.621345618708)*x[0]+(-0.599191472774)*x[1]**o+(0.720942014806)*x[1]+(0.699997023602)*x[2]**o+(-0.0401845986151)*x[2]
        s[1,1,1,0]=(0.195081954019)*x[0]**o+(0.404513751671)*x[0]+(-0.691733548084)*x[1]**o+(0.494301087961)*x[1]+(0.660194160561)*x[2]**o+(-0.719750815548)*x[2]
        s[1,1,1,1]=(0.174243105183)*x[0]**o+(-0.490648510315)*x[0]+(-0.921695831048)*x[1]**o+(0.03988622749)*x[1]+(0.600722960619)*x[2]**o+(-0.190758484114)*x[2]
        s[1,1,2,0]=(0.16246409321)*x[0]**o+(-0.861115959612)*x[0]+(-0.813061871575)*x[1]**o+(0.335664223473)*x[1]+(0.0462405018327)*x[2]**o+(-0.187262892401)*x[2]
        s[1,1,2,1]=(0.0961690353732)*x[0]**o+(0.388828620097)*x[0]+(0.108950572002)*x[1]**o+(-0.163688546076)*x[1]+(-0.278121101224)*x[2]**o+(0.612009658813)*x[2]
        s[1,2,0,0]=(-0.641539480622)*x[0]**o+(-0.459587156004)*x[0]+(0.672390673512)*x[1]**o+(-0.306916192961)*x[1]+(-0.350373910022)*x[2]**o+(0.846575285764)*x[2]
        s[1,2,0,1]=(0.305867854526)*x[0]**o+(0.494447320742)*x[0]+(0.325369680551)*x[1]**o+(-0.698268159382)*x[1]+(0.88031161562)*x[2]**o+(0.049240112332)*x[2]
        s[1,2,1,0]=(0.0262323517248)*x[0]**o+(0.165055680035)*x[0]+(0.978941268257)*x[1]**o+(-0.166940249199)*x[1]+(0.169948801883)*x[2]**o+(0.521926242685)*x[2]
        s[1,2,1,1]=(-0.73494826134)*x[0]**o+(-0.908473852515)*x[0]+(0.19661832779)*x[1]**o+(-0.0112732740593)*x[1]+(0.931924432628)*x[2]**o+(-0.433369394703)*x[2]
        s[1,2,2,0]=(-0.405925175898)*x[0]**o+(0.190346680156)*x[0]+(-0.486067244548)*x[1]**o+(-0.745250360184)*x[1]+(0.367855074214)*x[2]**o+(-0.489383863963)*x[2]
        s[1,2,2,1]=(-0.552448017406)*x[0]**o+(-0.10269646845)*x[0]+(0.216638861349)*x[1]**o+(0.285051823646)*x[1]+(-0.230326588392)*x[2]**o+(-0.963919984207)*x[2]
        s[1,3,0,0]=(0.498736551815)*x[0]**o+(0.714104256637)*x[0]+(-0.919467236631)*x[1]**o+(0.435774954621)*x[1]+(0.984691072998)*x[2]**o+(-0.385931573529)*x[2]
        s[1,3,0,1]=(-0.570322022545)*x[0]**o+(-0.431865640646)*x[0]+(-0.670344645547)*x[1]**o+(-0.0350120918436)*x[1]+(-0.574585723354)*x[2]**o+(-0.223611830882)*x[2]
        s[1,3,1,0]=(-0.978507788576)*x[0]**o+(0.692133143224)*x[0]+(-0.914092231492)*x[1]**o+(-0.878609687469)*x[1]+(0.123811943713)*x[2]**o+(0.566089817653)*x[2]
        s[1,3,1,1]=(0.413054411011)*x[0]**o+(0.134306111827)*x[0]+(0.0881588523756)*x[1]**o+(-0.260874928976)*x[1]+(0.59908530007)*x[2]**o+(-0.790312441625)*x[2]
        s[1,3,2,0]=(-0.56020772952)*x[0]**o+(-0.821899156728)*x[0]+(0.657107279954)*x[1]**o+(0.714198844049)*x[1]+(-0.797822774901)*x[2]**o+(-0.683075322516)*x[2]
        s[1,3,2,1]=(-0.784712199154)*x[0]**o+(0.257785308806)*x[0]+(0.668249127767)*x[1]**o+(-0.175010396143)*x[1]+(-0.450998789628)*x[2]**o+(-0.496319680914)*x[2]
        s[1,4,0,0]=(-0.361383889488)*x[0]**o+(-0.507929033088)*x[0]+(0.326087065339)*x[1]**o+(-0.672507245637)*x[1]+(-0.933796910616)*x[2]**o+(-0.964546616709)*x[2]
        s[1,4,0,1]=(-0.359553116054)*x[0]**o+(0.0378595816875)*x[0]+(0.866729184315)*x[1]**o+(-0.109325131607)*x[1]+(-0.436395616824)*x[2]**o+(-0.0250686006967)*x[2]
        s[1,4,1,0]=(-0.822256610634)*x[0]**o+(0.717956881162)*x[0]+(0.325671939606)*x[1]**o+(0.678862239184)*x[1]+(-0.721071141214)*x[2]**o+(0.371297227578)*x[2]
        s[1,4,1,1]=(-0.193864272459)*x[0]**o+(-0.165902167768)*x[0]+(-0.0799495476929)*x[1]**o+(-0.205949634256)*x[1]+(-0.830680911165)*x[2]**o+(-0.152405450656)*x[2]
        s[1,4,2,0]=(0.613697794358)*x[0]**o+(0.912521661263)*x[0]+(-0.00649065024755)*x[1]**o+(-0.215763322626)*x[1]+(-0.263693770435)*x[2]**o+(-0.596480965279)*x[2]
        s[1,4,2,1]=(0.234126882167)*x[0]**o+(0.912840520614)*x[0]+(0.933840609517)*x[1]**o+(0.713211976776)*x[1]+(0.936197279948)*x[2]**o+(-0.293174979732)*x[2]
        s[2,0,0,0]=(0.892309367374)*x[0]**o+(0.633921503439)*x[0]+(0.349595598938)*x[1]**o+(0.461978252492)*x[1]+(-0.711515661832)*x[2]**o+(0.0488550856917)*x[2]
        s[2,0,0,1]=(-0.180492557153)*x[0]**o+(0.56511183613)*x[0]+(-0.665614227144)*x[1]**o+(-0.27485018599)*x[1]+(0.882474739326)*x[2]**o+(0.55427047278)*x[2]
        s[2,0,1,0]=(-0.757743026711)*x[0]**o+(0.940849781783)*x[0]+(-0.269186132914)*x[1]**o+(0.955046584823)*x[1]+(0.378760429217)*x[2]**o+(-0.496548644452)*x[2]
        s[2,0,1,1]=(-0.793137192102)*x[0]**o+(-0.86866411939)*x[0]+(-0.132179169569)*x[1]**o+(0.809599174407)*x[1]+(-0.106002493623)*x[2]**o+(0.109415507767)*x[2]
        s[2,0,2,0]=(0.0272436873719)*x[0]**o+(0.882059697054)*x[0]+(0.195295016692)*x[1]**o+(-0.569734997529)*x[1]+(-0.211564162771)*x[2]**o+(-0.372926144524)*x[2]
        s[2,0,2,1]=(-0.578202088804)*x[0]**o+(-0.466997144939)*x[0]+(0.113612650512)*x[1]**o+(-0.364257850046)*x[1]+(0.260193611289)*x[2]**o+(0.084672789632)*x[2]
        s[2,1,0,0]=(-0.768791448871)*x[0]**o+(-0.0283052260408)*x[0]+(-0.424122141665)*x[1]**o+(-0.568176781664)*x[1]+(0.57776948712)*x[2]**o+(0.974311520873)*x[2]
        s[2,1,0,1]=(-0.868527274026)*x[0]**o+(0.898580042728)*x[0]+(0.293187514185)*x[1]**o+(-0.966501893286)*x[1]+(-0.984906818414)*x[2]**o+(0.385872938659)*x[2]
        s[2,1,1,0]=(0.912855062225)*x[0]**o+(-0.153613990867)*x[0]+(-0.498660070196)*x[1]**o+(0.324379040976)*x[1]+(0.595621093076)*x[2]**o+(0.952723749417)*x[2]
        s[2,1,1,1]=(-0.332918724678)*x[0]**o+(-0.134970034861)*x[0]+(0.0260338270417)*x[1]**o+(0.19534841947)*x[1]+(-0.192624928148)*x[2]**o+(0.351094519153)*x[2]
        s[2,1,2,0]=(-0.130412878953)*x[0]**o+(0.31027939409)*x[0]+(-0.475936742043)*x[1]**o+(-0.304153006832)*x[1]+(-0.293242151796)*x[2]**o+(0.305389900042)*x[2]
        s[2,1,2,1]=(0.701755042286)*x[0]**o+(-0.141745871059)*x[0]+(-0.8205828496)*x[1]**o+(-0.198914354743)*x[1]+(0.785036948065)*x[2]**o+(0.938605909098)*x[2]
        s[2,2,0,0]=(0.551929105975)*x[0]**o+(-0.307038421321)*x[0]+(-0.599015821782)*x[1]**o+(0.0392829428763)*x[1]+(0.000979795616653)*x[2]**o+(-0.674643683481)*x[2]
        s[2,2,0,1]=(0.620978846723)*x[0]**o+(0.440011791598)*x[0]+(0.810951443299)*x[1]**o+(0.99070790399)*x[1]+(0.287374917435)*x[2]**o+(-0.336581470165)*x[2]
        s[2,2,1,0]=(0.772920441549)*x[0]**o+(-0.425704048392)*x[0]+(0.186213730232)*x[1]**o+(-0.69328085038)*x[1]+(-0.496606146226)*x[2]**o+(-0.344844378531)*x[2]
        s[2,2,1,1]=(-0.278910103316)*x[0]**o+(-0.674237998285)*x[0]+(0.83739091668)*x[1]**o+(-0.675256965617)*x[1]+(-0.0220815626466)*x[2]**o+(-0.0600167098977)*x[2]
        s[2,2,2,0]=(0.161601546272)*x[0]**o+(-0.51703043722)*x[0]+(0.192844187688)*x[1]**o+(-0.588393830312)*x[1]+(-0.496441908334)*x[2]**o+(-0.655211307185)*x[2]
        s[2,2,2,1]=(-0.0849641142284)*x[0]**o+(-0.354892880977)*x[0]+(0.990421698189)*x[1]**o+(-0.560596614092)*x[1]+(0.341655795654)*x[2]**o+(0.494914875774)*x[2]
        s[2,3,0,0]=(0.0118611095917)*x[0]**o+(-0.379145547458)*x[0]+(0.443702691226)*x[1]**o+(-0.162411128493)*x[1]+(-0.235962251228)*x[2]**o+(0.647389691482)*x[2]
        s[2,3,0,1]=(0.876617418633)*x[0]**o+(-0.212420835108)*x[0]+(0.931783450145)*x[1]**o+(0.618767260975)*x[1]+(0.865648987862)*x[2]**o+(0.274171020917)*x[2]
        s[2,3,1,0]=(0.0490082163721)*x[0]**o+(-0.719949810351)*x[0]+(0.623252286197)*x[1]**o+(0.797654854976)*x[1]+(-0.688042858141)*x[2]**o+(-0.832375529422)*x[2]
        s[2,3,1,1]=(-0.219830798217)*x[0]**o+(0.404707913477)*x[0]+(0.586989479036)*x[1]**o+(-0.189149824721)*x[1]+(0.439899446736)*x[2]**o+(0.830665884353)*x[2]
        s[2,3,2,0]=(0.176667646979)*x[0]**o+(0.251389955823)*x[0]+(-0.589715137652)*x[1]**o+(0.454775590379)*x[1]+(-0.931971045729)*x[2]**o+(0.688896927587)*x[2]
        s[2,3,2,1]=(0.990217880611)*x[0]**o+(0.813900249046)*x[0]+(0.223918634272)*x[1]**o+(-0.52004580243)*x[1]+(-0.0715278690435)*x[2]**o+(-0.904847118013)*x[2]
        s[2,4,0,0]=(0.64966558184)*x[0]**o+(0.368126307546)*x[0]+(-0.464732694831)*x[1]**o+(0.411720375551)*x[1]+(0.228411933233)*x[2]**o+(0.241400675638)*x[2]
        s[2,4,0,1]=(-0.549913707284)*x[0]**o+(-0.805046099696)*x[0]+(0.0672499044192)*x[1]**o+(-0.443313070041)*x[1]+(0.724365127624)*x[2]**o+(0.796281599759)*x[2]
        s[2,4,1,0]=(-0.849777254443)*x[0]**o+(-0.856417954364)*x[0]+(-0.972865529342)*x[1]**o+(-0.928514101686)*x[1]+(-0.913751924661)*x[2]**o+(-0.988656521899)*x[2]
        s[2,4,1,1]=(-0.911477188787)*x[0]**o+(-0.779986760795)*x[0]+(-0.5389591554)*x[1]**o+(-0.510754176334)*x[1]+(0.897140016867)*x[2]**o+(-0.693629592672)*x[2]
        s[2,4,2,0]=(-0.714385212743)*x[0]**o+(0.335762026267)*x[0]+(-0.402732468944)*x[1]**o+(0.928476377932)*x[1]+(-0.0142181788391)*x[2]**o+(-0.878381714054)*x[2]
        s[2,4,2,1]=(-0.67410120519)*x[0]**o+(-0.958305251297)*x[0]+(-0.380909627066)*x[1]**o+(0.211866670591)*x[1]+(-0.366711818102)*x[2]**o+(0.0984085882283)*x[2]
        s[3,0,0,0]=(0.155086211904)*x[0]**o+(-0.754156385746)*x[0]+(0.0473073793112)*x[1]**o+(0.219578851828)*x[1]+(-0.687387954807)*x[2]**o+(-0.0446886834524)*x[2]
        s[3,0,0,1]=(-0.123628783768)*x[0]**o+(-0.731797394112)*x[0]+(0.603667790885)*x[1]**o+(0.668012714955)*x[1]+(0.992297575688)*x[2]**o+(0.710188099523)*x[2]
        s[3,0,1,0]=(0.142848824593)*x[0]**o+(-0.573105206297)*x[0]+(-0.458611102127)*x[1]**o+(-0.513741139974)*x[1]+(0.184040207705)*x[2]**o+(-0.381655193731)*x[2]
        s[3,0,1,1]=(0.441456662454)*x[0]**o+(0.743195285557)*x[0]+(-0.636813637657)*x[1]**o+(0.579742356597)*x[1]+(-0.100949836318)*x[2]**o+(-0.180042447693)*x[2]
        s[3,0,2,0]=(0.565324561738)*x[0]**o+(-0.734887633464)*x[0]+(-0.70603014663)*x[1]**o+(0.482330325634)*x[1]+(0.0468851802149)*x[2]**o+(0.15022059502)*x[2]
        s[3,0,2,1]=(0.209254635781)*x[0]**o+(0.249109731308)*x[0]+(0.0674776536717)*x[1]**o+(-0.514230929025)*x[1]+(0.209025695623)*x[2]**o+(0.828692252433)*x[2]
        s[3,1,0,0]=(-0.0724637124382)*x[0]**o+(-0.777393915285)*x[0]+(-0.388956221906)*x[1]**o+(0.237031963641)*x[1]+(0.695616762278)*x[2]**o+(-0.990904158717)*x[2]
        s[3,1,0,1]=(0.682394453758)*x[0]**o+(0.971411939071)*x[0]+(0.578523591228)*x[1]**o+(-0.999316997575)*x[1]+(0.967221232651)*x[2]**o+(0.967839631913)*x[2]
        s[3,1,1,0]=(0.790017081833)*x[0]**o+(0.00541365718201)*x[0]+(0.326051127661)*x[1]**o+(-0.0256095948145)*x[1]+(0.723206050948)*x[2]**o+(0.859401412085)*x[2]
        s[3,1,1,1]=(0.632718697794)*x[0]**o+(0.357404127028)*x[0]+(0.74859722663)*x[1]**o+(-0.467286199965)*x[1]+(-0.689766250946)*x[2]**o+(0.143607079021)*x[2]
        s[3,1,2,0]=(0.189165561366)*x[0]**o+(-0.569471633508)*x[0]+(0.827816159248)*x[1]**o+(-0.755414119587)*x[1]+(0.735612525192)*x[2]**o+(0.960576961762)*x[2]
        s[3,1,2,1]=(-0.591990093184)*x[0]**o+(-0.397066100484)*x[0]+(-0.983328257627)*x[1]**o+(0.38188756521)*x[1]+(0.342986157929)*x[2]**o+(-0.654635950498)*x[2]
        s[3,2,0,0]=(-0.539663780822)*x[0]**o+(-0.616950865853)*x[0]+(-0.173236358465)*x[1]**o+(-0.697589613553)*x[1]+(0.881000305923)*x[2]**o+(-0.313131191688)*x[2]
        s[3,2,0,1]=(0.694379614088)*x[0]**o+(0.0482437007544)*x[0]+(-0.752154726269)*x[1]**o+(0.70487516283)*x[1]+(-0.679034313009)*x[2]**o+(-0.759378421017)*x[2]
        s[3,2,1,0]=(0.110285075533)*x[0]**o+(-0.937673509278)*x[0]+(0.588965619655)*x[1]**o+(-0.296106521794)*x[1]+(-0.251861128346)*x[2]**o+(0.0499356188571)*x[2]
        s[3,2,1,1]=(-0.237031027497)*x[0]**o+(-0.555130292547)*x[0]+(0.0266496695782)*x[1]**o+(-0.457831015699)*x[1]+(-0.525100370138)*x[2]**o+(-0.110106658247)*x[2]
        s[3,2,2,0]=(-0.346203985282)*x[0]**o+(0.452969593191)*x[0]+(0.366653289186)*x[1]**o+(-0.431403207447)*x[1]+(0.00416181323958)*x[2]**o+(0.948257819905)*x[2]
        s[3,2,2,1]=(-0.161866645182)*x[0]**o+(-0.223171463142)*x[0]+(0.0335615555403)*x[1]**o+(-0.031701739926)*x[1]+(-0.682660238537)*x[2]**o+(-0.201265341974)*x[2]
        s[3,3,0,0]=(0.600997603354)*x[0]**o+(-0.0794128467746)*x[0]+(0.850816035448)*x[1]**o+(0.987737939576)*x[1]+(0.445092093996)*x[2]**o+(0.209682549773)*x[2]
        s[3,3,0,1]=(-0.281229513599)*x[0]**o+(-0.671047123259)*x[0]+(0.727339757353)*x[1]**o+(0.00116796626742)*x[1]+(0.750903575671)*x[2]**o+(0.688698278099)*x[2]
        s[3,3,1,0]=(0.482788258833)*x[0]**o+(-0.763378332747)*x[0]+(0.958666605693)*x[1]**o+(0.815260251405)*x[1]+(-0.185679132639)*x[2]**o+(-0.978181554387)*x[2]
        s[3,3,1,1]=(0.422342206704)*x[0]**o+(0.92124205703)*x[0]+(0.717119813424)*x[1]**o+(0.358838278821)*x[1]+(-0.905962064034)*x[2]**o+(-0.110063748765)*x[2]
        s[3,3,2,0]=(0.638413147984)*x[0]**o+(0.150065454883)*x[0]+(-0.185782870659)*x[1]**o+(-0.617305598909)*x[1]+(-0.744983914507)*x[2]**o+(-0.557435768794)*x[2]
        s[3,3,2,1]=(-0.373080897783)*x[0]**o+(-0.11883999233)*x[0]+(0.918434263505)*x[1]**o+(0.190498804258)*x[1]+(0.145703720162)*x[2]**o+(0.760937920293)*x[2]
        s[3,4,0,0]=(-0.655458683507)*x[0]**o+(0.181703803374)*x[0]+(0.399180648629)*x[1]**o+(-0.252039523462)*x[1]+(-0.304219626464)*x[2]**o+(0.146502412947)*x[2]
        s[3,4,0,1]=(-0.967498004243)*x[0]**o+(-0.720977530602)*x[0]+(-0.197853229934)*x[1]**o+(-0.206241841259)*x[1]+(-0.842800053665)*x[2]**o+(0.248622158299)*x[2]
        s[3,4,1,0]=(-0.20852177925)*x[0]**o+(0.451565234256)*x[0]+(-0.195228349745)*x[1]**o+(-0.176510706654)*x[1]+(-0.446406234444)*x[2]**o+(-0.391189367221)*x[2]
        s[3,4,1,1]=(-0.0245191385208)*x[0]**o+(-0.4318092516)*x[0]+(0.434565500298)*x[1]**o+(-0.226869925672)*x[1]+(-0.541039601648)*x[2]**o+(-0.661612910117)*x[2]
        s[3,4,2,0]=(0.66840921186)*x[0]**o+(-0.50096681529)*x[0]+(0.584113673029)*x[1]**o+(0.624256279715)*x[1]+(-0.97424822131)*x[2]**o+(-0.436152188081)*x[2]
        s[3,4,2,1]=(-0.524152888193)*x[0]**o+(-0.631030243012)*x[0]+(0.712790078556)*x[1]**o+(0.444287995295)*x[1]+(-0.32562141887)*x[2]**o+(0.999485979189)*x[2]
        ref[0,0,0,0]=(-1.09369433259)/(o+1.)+(-0.728685606995)+(0.356314179645)*0.5**o
        ref[0,0,0,1]=(-1.8372727032)/(o+1.)+(-0.399789276755)+(0.209589534917)*0.5**o
        ref[0,0,1,0]=(-0.208884062074)/(o+1.)+(-0.58416334704)+(-0.242847848445)*0.5**o
        ref[0,0,1,1]=(-0.126744186628)/(o+1.)+(0.273138033997)+(0.255545417045)*0.5**o
        ref[0,0,2,0]=(-0.0369820636107)/(o+1.)+(1.06288699174)+(-0.962070081459)*0.5**o
        ref[0,0,2,1]=(-0.747281704793)/(o+1.)+(-0.36647857395)+(0.636687005195)*0.5**o
        ref[0,1,0,0]=(-0.311459789696)/(o+1.)+(-0.691120478554)+(0.521790025796)*0.5**o
        ref[0,1,0,1]=(-0.576631783947)/(o+1.)+(0.0556154884091)+(-0.642544941536)*0.5**o
        ref[0,1,1,0]=(0.472705110018)/(o+1.)+(-0.511230670877)+(0.987946287729)*0.5**o
        ref[0,1,1,1]=(-0.143423470924)/(o+1.)+(-0.194173739799)+(-0.848091494031)*0.5**o
        ref[0,1,2,0]=(0.351890499412)/(o+1.)+(-0.249197293795)+(-0.411836604088)*0.5**o
        ref[0,1,2,1]=(0.161891485687)/(o+1.)+(0.415707435173)+(0.0397981165279)*0.5**o
        ref[0,2,0,0]=(-0.0187864263063)/(o+1.)+(0.779173414927)+(-0.043373970003)*0.5**o
        ref[0,2,0,1]=(-0.31437392339)/(o+1.)+(-0.48448663227)+(0.204098937116)*0.5**o
        ref[0,2,1,0]=(0.230693657323)/(o+1.)+(1.12469199732)+(0.506878702079)*0.5**o
        ref[0,2,1,1]=(0.595998513433)/(o+1.)+(-0.544883877711)+(-0.261656641804)*0.5**o
        ref[0,2,2,0]=(-0.702386110204)/(o+1.)+(-0.996052366283)+(-0.491629682103)*0.5**o
        ref[0,2,2,1]=(0.232315113828)/(o+1.)+(0.199990990174)+(-0.564089634025)*0.5**o
        ref[0,3,0,0]=(-0.655640217843)/(o+1.)+(0.478355790703)+(0.0606363217868)*0.5**o
        ref[0,3,0,1]=(0.948899359986)/(o+1.)+(0.633579372651)+(-0.702879071079)*0.5**o
        ref[0,3,1,0]=(-0.675992210372)/(o+1.)+(0.114682015642)+(-0.824855043544)*0.5**o
        ref[0,3,1,1]=(-0.184213819336)/(o+1.)+(0.650265245624)+(-0.890319589507)*0.5**o
        ref[0,3,2,0]=(-0.328998548752)/(o+1.)+(0.485049032367)+(0.366123401919)*0.5**o
        ref[0,3,2,1]=(-0.380537903931)/(o+1.)+(-0.467985686882)+(-0.438035010616)*0.5**o
        ref[0,4,0,0]=(-0.59529404833)/(o+1.)+(0.36827259985)+(0.319555220189)*0.5**o
        ref[0,4,0,1]=(0.83138611484)/(o+1.)+(0.78491205408)+(-0.874144853872)*0.5**o
        ref[0,4,1,0]=(-0.894405615027)/(o+1.)+(-0.611911163449)+(0.622984208352)*0.5**o
        ref[0,4,1,1]=(-0.104474373269)/(o+1.)+(-0.682715540615)+(-0.175155841122)*0.5**o
        ref[0,4,2,0]=(-1.04850011326)/(o+1.)+(-0.453402108525)+(0.111634467654)*0.5**o
        ref[0,4,2,1]=(-0.170072041674)/(o+1.)+(0.272923829487)+(0.769210305419)*0.5**o
        ref[1,0,0,0]=(-0.19978027482)/(o+1.)+(0.492517472984)+(-0.907821074278)*0.5**o
        ref[1,0,0,1]=(-0.0898768254184)/(o+1.)+(-0.0202018123679)+(-0.935692950448)*0.5**o
        ref[1,0,1,0]=(0.701068673884)/(o+1.)+(-0.00830568946752)+(0.958399972856)*0.5**o
        ref[1,0,1,1]=(0.46131776206)/(o+1.)+(0.200377959194)+(0.480962582731)*0.5**o
        ref[1,0,2,0]=(-0.349254215553)/(o+1.)+(-0.694786621841)+(-0.459646484527)*0.5**o
        ref[1,0,2,1]=(-0.837447208911)/(o+1.)+(0.0537828613354)+(-0.663523285059)*0.5**o
        ref[1,1,0,0]=(-0.0173783101856)/(o+1.)+(-0.30683593271)+(-0.963081878353)*0.5**o
        ref[1,1,0,1]=(0.100805550828)/(o+1.)+(0.0297058987412)+(-0.426340341727)*0.5**o
        ref[1,1,1,0]=(-0.0315393875231)/(o+1.)+(0.0895320120418)+(0.195081954019)*0.5**o
        ref[1,1,1,1]=(-0.320972870429)/(o+1.)+(-0.320760383469)+(0.174243105183)*0.5**o
        ref[1,1,2,0]=(-0.766821369743)/(o+1.)+(-0.35635731427)+(0.16246409321)*0.5**o
        ref[1,1,2,1]=(-0.169170529222)/(o+1.)+(0.418574866417)+(0.0961690353732)*0.5**o
        ref[1,2,0,0]=(0.32201676349)/(o+1.)+(0.0400359683992)+(-0.641539480622)*0.5**o
        ref[1,2,0,1]=(1.20568129617)/(o+1.)+(-0.0772903631539)+(0.305867854526)*0.5**o
        ref[1,2,1,0]=(1.14889007014)/(o+1.)+(0.26002083676)+(0.0262323517248)*0.5**o
        ref[1,2,1,1]=(1.12854276042)/(o+1.)+(-0.676558260639)+(-0.73494826134)*0.5**o
        ref[1,2,2,0]=(-0.118212170334)/(o+1.)+(-0.522143771996)+(-0.405925175898)*0.5**o
        ref[1,2,2,1]=(-0.013687727043)/(o+1.)+(-0.390782314506)+(-0.552448017406)*0.5**o
        ref[1,3,0,0]=(0.0652238363667)/(o+1.)+(0.381973818864)+(0.498736551815)*0.5**o
        ref[1,3,0,1]=(-1.2449303689)/(o+1.)+(-0.345244781686)+(-0.570322022545)*0.5**o
        ref[1,3,1,0]=(-0.790280287779)/(o+1.)+(0.189806636704)+(-0.978507788576)*0.5**o
        ref[1,3,1,1]=(0.687244152446)/(o+1.)+(-0.458440629387)+(0.413054411011)*0.5**o
        ref[1,3,2,0]=(-0.140715494947)/(o+1.)+(-0.395387817597)+(-0.56020772952)*0.5**o
        ref[1,3,2,1]=(0.217250338139)/(o+1.)+(-0.206772384125)+(-0.784712199154)*0.5**o
        ref[1,4,0,0]=(-0.607709845277)/(o+1.)+(-1.07249144772)+(-0.361383889488)*0.5**o
        ref[1,4,0,1]=(0.430333567491)/(o+1.)+(-0.0482670753081)+(-0.359553116054)*0.5**o
        ref[1,4,1,0]=(-0.395399201609)/(o+1.)+(0.884058173962)+(-0.822256610634)*0.5**o
        ref[1,4,1,1]=(-0.910630458857)/(o+1.)+(-0.26212862634)+(-0.193864272459)*0.5**o
        ref[1,4,2,0]=(-0.270184420683)/(o+1.)+(0.0501386866791)+(0.613697794358)*0.5**o
        ref[1,4,2,1]=(1.87003788947)/(o+1.)+(0.666438758829)+(0.234126882167)*0.5**o
        ref[2,0,0,0]=(-0.361920062895)/(o+1.)+(0.572377420811)+(0.892309367374)*0.5**o
        ref[2,0,0,1]=(0.216860512182)/(o+1.)+(0.42226606146)+(-0.180492557153)*0.5**o
        ref[2,0,1,0]=(0.109574296303)/(o+1.)+(0.699673861077)+(-0.757743026711)*0.5**o
        ref[2,0,1,1]=(-0.238181663192)/(o+1.)+(0.0251752813916)+(-0.793137192102)*0.5**o
        ref[2,0,2,0]=(-0.0162691460785)/(o+1.)+(-0.0303007224997)+(0.0272436873719)*0.5**o
        ref[2,0,2,1]=(0.373806261801)/(o+1.)+(-0.373291102676)+(-0.578202088804)*0.5**o
        ref[2,1,0,0]=(0.153647345455)/(o+1.)+(0.188914756584)+(-0.768791448871)*0.5**o
        ref[2,1,0,1]=(-0.691719304229)/(o+1.)+(0.158975544051)+(-0.868527274026)*0.5**o
        ref[2,1,1,0]=(0.0969610228798)/(o+1.)+(0.561744399763)+(0.912855062225)*0.5**o
        ref[2,1,1,1]=(-0.166591101107)/(o+1.)+(0.205736451881)+(-0.332918724678)*0.5**o
        ref[2,1,2,0]=(-0.769178893839)/(o+1.)+(0.15575814365)+(-0.130412878953)*0.5**o
        ref[2,1,2,1]=(-0.0355459015346)/(o+1.)+(0.298972841648)+(0.701755042286)*0.5**o
        ref[2,2,0,0]=(-0.598036026165)/(o+1.)+(-0.471199580962)+(0.551929105975)*0.5**o
        ref[2,2,0,1]=(1.09832636073)/(o+1.)+(0.547069112712)+(0.620978846723)*0.5**o
        ref[2,2,1,0]=(-0.310392415994)/(o+1.)+(-0.731914638652)+(0.772920441549)*0.5**o
        ref[2,2,1,1]=(0.815309354033)/(o+1.)+(-0.7047558369)+(-0.278910103316)*0.5**o
        ref[2,2,2,0]=(-0.303597720645)/(o+1.)+(-0.880317787358)+(0.161601546272)*0.5**o
        ref[2,2,2,1]=(1.33207749384)/(o+1.)+(-0.210287309648)+(-0.0849641142284)*0.5**o
        ref[2,3,0,0]=(0.207740439998)/(o+1.)+(0.0529165077655)+(0.0118611095917)*0.5**o
        ref[2,3,0,1]=(1.79743243801)/(o+1.)+(0.340258723392)+(0.876617418633)*0.5**o
        ref[2,3,1,0]=(-0.0647905719439)/(o+1.)+(-0.377335242398)+(0.0490082163721)*0.5**o
        ref[2,3,1,1]=(1.02688892577)/(o+1.)+(0.523111986555)+(-0.219830798217)*0.5**o
        ref[2,3,2,0]=(-1.52168618338)/(o+1.)+(0.697531236895)+(0.176667646979)*0.5**o
        ref[2,3,2,1]=(0.152390765229)/(o+1.)+(-0.305496335698)+(0.990217880611)*0.5**o
        ref[2,4,0,0]=(-0.236320761598)/(o+1.)+(0.510623679368)+(0.64966558184)*0.5**o
        ref[2,4,0,1]=(0.791615032044)/(o+1.)+(-0.226038784989)+(-0.549913707284)*0.5**o
        ref[2,4,1,0]=(-1.886617454)/(o+1.)+(-1.38679428897)+(-0.849777254443)*0.5**o
        ref[2,4,1,1]=(0.358180861467)/(o+1.)+(-0.9921852649)+(-0.911477188787)*0.5**o
        ref[2,4,2,0]=(-0.416950647783)/(o+1.)+(0.192928345072)+(-0.714385212743)*0.5**o
        ref[2,4,2,1]=(-0.747621445168)/(o+1.)+(-0.324014996239)+(-0.67410120519)*0.5**o
        ref[3,0,0,0]=(-0.640080575496)/(o+1.)+(-0.289633108685)+(0.155086211904)*0.5**o
        ref[3,0,0,1]=(1.59596536657)/(o+1.)+(0.323201710183)+(-0.123628783768)*0.5**o
        ref[3,0,1,0]=(-0.274570894421)/(o+1.)+(-0.734250770001)+(0.142848824593)*0.5**o
        ref[3,0,1,1]=(-0.737763473975)/(o+1.)+(0.57144759723)+(0.441456662454)*0.5**o
        ref[3,0,2,0]=(-0.659144966415)/(o+1.)+(-0.0511683564048)+(0.565324561738)*0.5**o
        ref[3,0,2,1]=(0.276503349295)/(o+1.)+(0.281785527358)+(0.209254635781)*0.5**o
        ref[3,1,0,0]=(0.306660540372)/(o+1.)+(-0.76563305518)+(-0.0724637124382)*0.5**o
        ref[3,1,0,1]=(1.54574482388)/(o+1.)+(0.469967286704)+(0.682394453758)*0.5**o
        ref[3,1,1,0]=(1.04925717861)/(o+1.)+(0.419602737226)+(0.790017081833)*0.5**o
        ref[3,1,1,1]=(0.0588309756839)/(o+1.)+(0.016862503042)+(0.632718697794)*0.5**o
        ref[3,1,2,0]=(1.56342868444)/(o+1.)+(-0.182154395667)+(0.189165561366)*0.5**o
        ref[3,1,2,1]=(-0.640342099698)/(o+1.)+(-0.334907242886)+(-0.591990093184)*0.5**o
        ref[3,2,0,0]=(0.707763947458)/(o+1.)+(-0.813835835547)+(-0.539663780822)*0.5**o
        ref[3,2,0,1]=(-1.43118903928)/(o+1.)+(-0.00312977871602)+(0.694379614088)*0.5**o
        ref[3,2,1,0]=(0.33710449131)/(o+1.)+(-0.591922206108)+(0.110285075533)*0.5**o
        ref[3,2,1,1]=(-0.49845070056)/(o+1.)+(-0.561533983246)+(-0.237031027497)*0.5**o
        ref[3,2,2,0]=(0.370815102426)/(o+1.)+(0.484912102825)+(-0.346203985282)*0.5**o
        ref[3,2,2,1]=(-0.649098682997)/(o+1.)+(-0.228069272521)+(-0.161866645182)*0.5**o
        ref[3,3,0,0]=(1.29590812944)/(o+1.)+(0.559003821287)+(0.600997603354)*0.5**o
        ref[3,3,0,1]=(1.47824333302)/(o+1.)+(0.00940956055351)+(-0.281229513599)*0.5**o
        ref[3,3,1,0]=(0.772987473054)/(o+1.)+(-0.463149817864)+(0.482788258833)*0.5**o
        ref[3,3,1,1]=(-0.18884225061)/(o+1.)+(0.585008293543)+(0.422342206704)*0.5**o
        ref[3,3,2,0]=(-0.930766785165)/(o+1.)+(-0.51233795641)+(0.638413147984)*0.5**o
        ref[3,3,2,1]=(1.06413798367)/(o+1.)+(0.416298366111)+(-0.373080897783)*0.5**o
        ref[3,4,0,0]=(0.0949610221643)/(o+1.)+(0.0380833464296)+(-0.655458683507)*0.5**o
        ref[3,4,0,1]=(-1.0406532836)/(o+1.)+(-0.339298606781)+(-0.967498004243)*0.5**o
        ref[3,4,1,0]=(-0.641634584189)/(o+1.)+(-0.0580674198095)+(-0.20852177925)*0.5**o
        ref[3,4,1,1]=(-0.10647410135)/(o+1.)+(-0.660146043694)+(-0.0245191385208)*0.5**o
        ref[3,4,2,0]=(-0.390134548281)/(o+1.)+(-0.156431361828)+(0.66840921186)*0.5**o
        ref[3,4,2,1]=(0.387168659686)/(o+1.)+(0.406371865736)+(-0.524152888193)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_Solution_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.353053645706)*x[0]**o+(0.664927675255)*x[0]+(-0.942226663664)*x[1]**o+(0.928445933833)*x[1]
        ref=(-0.942226663664)/(o+1.)+(0.796686804544)+(0.353053645706)*0.5**o
      else:
        s=(-0.488825085875)*x[0]**o+(0.0402522219678)*x[0]+(-0.741198644498)*x[1]**o+(0.683886232761)*x[1]+(0.988205530376)*x[2]**o+(0.448214857867)*x[2]
        ref=(0.247006885878)/(o+1.)+(0.586176656298)+(-0.488825085875)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_Solution_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-0.615767854828)*x[0]**o+(-0.986142825206)*x[0]+(-0.129819716269)*x[1]**o+(0.250395618525)*x[1]
        s[1]=(-0.958601580261)*x[0]**o+(0.991062188074)*x[0]+(-0.644161609496)*x[1]**o+(0.50196388747)*x[1]
        ref[0]=(-0.129819716269)/(o+1.)+(-0.367873603341)+(-0.615767854828)*0.5**o
        ref[1]=(-0.644161609496)/(o+1.)+(0.746513037772)+(-0.958601580261)*0.5**o
      else:
        s[0]=(0.878288543713)*x[0]**o+(-0.0231318363536)*x[0]+(0.800114568351)*x[1]**o+(-0.631838147181)*x[1]+(0.747070597667)*x[2]**o+(-0.73748208859)*x[2]
        s[1]=(-0.393659677321)*x[0]**o+(0.219319690151)*x[0]+(0.579665458601)*x[1]**o+(0.158199277855)*x[1]+(0.347253385647)*x[2]**o+(-0.581467925155)*x[2]
        ref[0]=(1.54718516602)/(o+1.)+(-0.696226036062)+(0.878288543713)*0.5**o
        ref[1]=(0.926918844249)/(o+1.)+(-0.101974478575)+(-0.393659677321)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_Solution_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.387453655624)*x[0]**o+(-0.469658136898)*x[0]+(0.250257043285)*x[1]**o+(0.618837167268)*x[1]
        s[0,1]=(-0.698973184774)*x[0]**o+(0.439366278802)*x[0]+(0.365483171998)*x[1]**o+(-0.596967887336)*x[1]
        s[0,2]=(-0.789327020147)*x[0]**o+(-0.720992513079)*x[0]+(0.254736202401)*x[1]**o+(-0.793036130784)*x[1]
        s[0,3]=(0.401178787667)*x[0]**o+(0.272725219284)*x[0]+(0.406915869496)*x[1]**o+(0.650109741413)*x[1]
        s[0,4]=(0.872851752065)*x[0]**o+(0.247512120353)*x[0]+(-0.849447364813)*x[1]**o+(0.341218375884)*x[1]
        s[1,0]=(-0.686440933718)*x[0]**o+(-0.699753221902)*x[0]+(0.416449038712)*x[1]**o+(0.953196364155)*x[1]
        s[1,1]=(-0.445063641949)*x[0]**o+(0.96357651863)*x[0]+(0.928584143634)*x[1]**o+(0.0134608093458)*x[1]
        s[1,2]=(-0.818205311776)*x[0]**o+(0.270136549223)*x[0]+(-0.684209682916)*x[1]**o+(-0.932729815977)*x[1]
        s[1,3]=(-0.0620403511795)*x[0]**o+(0.059231247402)*x[0]+(-0.688733974701)*x[1]**o+(0.581759221954)*x[1]
        s[1,4]=(-0.592213327841)*x[0]**o+(-0.339248053705)*x[0]+(0.384679583558)*x[1]**o+(-0.244452373913)*x[1]
        s[2,0]=(0.602926131051)*x[0]**o+(0.756963449553)*x[0]+(0.764520163983)*x[1]**o+(0.79924075351)*x[1]
        s[2,1]=(0.134902654892)*x[0]**o+(-0.983297874332)*x[0]+(0.919649726121)*x[1]**o+(0.408073376003)*x[1]
        s[2,2]=(0.806897621747)*x[0]**o+(-0.976625920159)*x[0]+(0.478598025599)*x[1]**o+(0.516714148448)*x[1]
        s[2,3]=(0.507729761378)*x[0]**o+(0.701695604786)*x[0]+(0.888872787083)*x[1]**o+(-0.903571907502)*x[1]
        s[2,4]=(0.171628496764)*x[0]**o+(0.54301146383)*x[0]+(0.463317911232)*x[1]**o+(0.998895766351)*x[1]
        s[3,0]=(0.957039213706)*x[0]**o+(-0.740478587736)*x[0]+(-0.915271935195)*x[1]**o+(0.566376957715)*x[1]
        s[3,1]=(0.187513468884)*x[0]**o+(-0.929127411057)*x[0]+(-0.227725906511)*x[1]**o+(-0.807394073167)*x[1]
        s[3,2]=(-0.947087097369)*x[0]**o+(-0.612267326048)*x[0]+(-0.456362542424)*x[1]**o+(-0.353534087643)*x[1]
        s[3,3]=(0.310532071177)*x[0]**o+(-0.221968959306)*x[0]+(-0.349150016728)*x[1]**o+(-0.509141774122)*x[1]
        s[3,4]=(-0.210845769048)*x[0]**o+(0.193660848384)*x[0]+(0.776869628574)*x[1]**o+(-0.154145417271)*x[1]
        ref[0,0]=(0.250257043285)/(o+1.)+(0.074589515185)+(0.387453655624)*0.5**o
        ref[0,1]=(0.365483171998)/(o+1.)+(-0.0788008042673)+(-0.698973184774)*0.5**o
        ref[0,2]=(0.254736202401)/(o+1.)+(-0.757014321931)+(-0.789327020147)*0.5**o
        ref[0,3]=(0.406915869496)/(o+1.)+(0.461417480349)+(0.401178787667)*0.5**o
        ref[0,4]=(-0.849447364813)/(o+1.)+(0.294365248118)+(0.872851752065)*0.5**o
        ref[1,0]=(0.416449038712)/(o+1.)+(0.126721571126)+(-0.686440933718)*0.5**o
        ref[1,1]=(0.928584143634)/(o+1.)+(0.488518663988)+(-0.445063641949)*0.5**o
        ref[1,2]=(-0.684209682916)/(o+1.)+(-0.331296633377)+(-0.818205311776)*0.5**o
        ref[1,3]=(-0.688733974701)/(o+1.)+(0.320495234678)+(-0.0620403511795)*0.5**o
        ref[1,4]=(0.384679583558)/(o+1.)+(-0.291850213809)+(-0.592213327841)*0.5**o
        ref[2,0]=(0.764520163983)/(o+1.)+(0.778102101531)+(0.602926131051)*0.5**o
        ref[2,1]=(0.919649726121)/(o+1.)+(-0.287612249164)+(0.134902654892)*0.5**o
        ref[2,2]=(0.478598025599)/(o+1.)+(-0.229955885856)+(0.806897621747)*0.5**o
        ref[2,3]=(0.888872787083)/(o+1.)+(-0.100938151358)+(0.507729761378)*0.5**o
        ref[2,4]=(0.463317911232)/(o+1.)+(0.77095361509)+(0.171628496764)*0.5**o
        ref[3,0]=(-0.915271935195)/(o+1.)+(-0.0870508150107)+(0.957039213706)*0.5**o
        ref[3,1]=(-0.227725906511)/(o+1.)+(-0.868260742112)+(0.187513468884)*0.5**o
        ref[3,2]=(-0.456362542424)/(o+1.)+(-0.482900706845)+(-0.947087097369)*0.5**o
        ref[3,3]=(-0.349150016728)/(o+1.)+(-0.365555366714)+(0.310532071177)*0.5**o
        ref[3,4]=(0.776869628574)/(o+1.)+(0.0197577155566)+(-0.210845769048)*0.5**o
      else:
        s[0,0]=(-0.0355854650857)*x[0]**o+(0.508097047577)*x[0]+(-0.559809522597)*x[1]**o+(0.274518262337)*x[1]+(-0.346896675687)*x[2]**o+(-0.820202383679)*x[2]
        s[0,1]=(-0.611401860909)*x[0]**o+(-0.804858756979)*x[0]+(0.792251514945)*x[1]**o+(0.127533284836)*x[1]+(0.96691512797)*x[2]**o+(0.0831709389735)*x[2]
        s[0,2]=(-0.0563416061339)*x[0]**o+(0.0591734952104)*x[0]+(0.992243816319)*x[1]**o+(0.457585067795)*x[1]+(0.248903218205)*x[2]**o+(-0.702938956647)*x[2]
        s[0,3]=(0.66016331397)*x[0]**o+(-0.460404888792)*x[0]+(0.834756895572)*x[1]**o+(-0.723598073525)*x[1]+(0.0804592839349)*x[2]**o+(-0.612859372888)*x[2]
        s[0,4]=(0.948196944613)*x[0]**o+(-0.954326701869)*x[0]+(-0.974120082057)*x[1]**o+(0.57658599582)*x[1]+(0.18517252062)*x[2]**o+(0.404027673976)*x[2]
        s[1,0]=(0.096690428758)*x[0]**o+(-0.335528774766)*x[0]+(0.529021814282)*x[1]**o+(0.0944401555902)*x[1]+(-0.0106293914555)*x[2]**o+(-0.885415125356)*x[2]
        s[1,1]=(-0.187544326204)*x[0]**o+(-0.832847850387)*x[0]+(-0.273330813724)*x[1]**o+(-0.0875781530468)*x[1]+(-0.422135351424)*x[2]**o+(-0.44851049492)*x[2]
        s[1,2]=(-0.416290563688)*x[0]**o+(-0.60796418234)*x[0]+(-0.786874489548)*x[1]**o+(-0.83344429526)*x[1]+(-0.636021842684)*x[2]**o+(0.76569386339)*x[2]
        s[1,3]=(-0.888962254312)*x[0]**o+(0.705830842388)*x[0]+(-0.628888150094)*x[1]**o+(0.699724558139)*x[1]+(-0.407095551825)*x[2]**o+(0.796316782037)*x[2]
        s[1,4]=(0.29031515404)*x[0]**o+(0.896505881191)*x[0]+(-0.314937896718)*x[1]**o+(-0.749045267106)*x[1]+(-0.464412869164)*x[2]**o+(-0.357988323816)*x[2]
        s[2,0]=(0.881903169624)*x[0]**o+(-0.962653173961)*x[0]+(0.826332318664)*x[1]**o+(0.625644776113)*x[1]+(0.330804909101)*x[2]**o+(-0.17772544382)*x[2]
        s[2,1]=(-0.503232182675)*x[0]**o+(-0.957203265575)*x[0]+(0.145865955701)*x[1]**o+(0.0915745220394)*x[1]+(-0.470345130645)*x[2]**o+(0.5949845374)*x[2]
        s[2,2]=(0.72138938011)*x[0]**o+(-0.914048390135)*x[0]+(-0.798916451586)*x[1]**o+(-0.720041081497)*x[1]+(-0.292635838745)*x[2]**o+(0.335321951624)*x[2]
        s[2,3]=(-0.182060346819)*x[0]**o+(0.173777377621)*x[0]+(-0.690798771753)*x[1]**o+(-0.792633276338)*x[1]+(0.691527659288)*x[2]**o+(-0.187507542541)*x[2]
        s[2,4]=(-0.5702456536)*x[0]**o+(0.601033902695)*x[0]+(-0.761437618934)*x[1]**o+(-0.258358320383)*x[1]+(-0.718966730705)*x[2]**o+(0.300570256286)*x[2]
        s[3,0]=(0.445936563031)*x[0]**o+(0.859485429121)*x[0]+(-0.191921809371)*x[1]**o+(-0.552489927682)*x[1]+(0.236031566969)*x[2]**o+(0.224011130312)*x[2]
        s[3,1]=(0.383619361689)*x[0]**o+(0.850743712521)*x[0]+(-0.583234052125)*x[1]**o+(-0.957466724321)*x[1]+(0.117664170019)*x[2]**o+(-0.118273519288)*x[2]
        s[3,2]=(0.32727041247)*x[0]**o+(-0.273021170896)*x[0]+(-0.488888392431)*x[1]**o+(0.924810229071)*x[1]+(0.120181256008)*x[2]**o+(0.292893993789)*x[2]
        s[3,3]=(-0.684680337734)*x[0]**o+(-0.494182942675)*x[0]+(-0.0912106871209)*x[1]**o+(-0.483261802779)*x[1]+(0.743468674518)*x[2]**o+(-0.0453199629827)*x[2]
        s[3,4]=(-0.790516141209)*x[0]**o+(0.939271717684)*x[0]+(0.939581799691)*x[1]**o+(0.961123577915)*x[1]+(0.653210734978)*x[2]**o+(0.245098724735)*x[2]
        ref[0,0]=(-0.906706198284)/(o+1.)+(-0.0187935368825)+(-0.0355854650857)*0.5**o
        ref[0,1]=(1.75916664291)/(o+1.)+(-0.297077266585)+(-0.611401860909)*0.5**o
        ref[0,2]=(1.24114703452)/(o+1.)+(-0.0930901968209)+(-0.0563416061339)*0.5**o
        ref[0,3]=(0.915216179507)/(o+1.)+(-0.898431167602)+(0.66016331397)*0.5**o
        ref[0,4]=(-0.788947561438)/(o+1.)+(0.0131434839635)+(0.948196944613)*0.5**o
        ref[1,0]=(0.518392422826)/(o+1.)+(-0.563251872266)+(0.096690428758)*0.5**o
        ref[1,1]=(-0.695466165148)/(o+1.)+(-0.684468249177)+(-0.187544326204)*0.5**o
        ref[1,2]=(-1.42289633223)/(o+1.)+(-0.337857307105)+(-0.416290563688)*0.5**o
        ref[1,3]=(-1.03598370192)/(o+1.)+(1.10093609128)+(-0.888962254312)*0.5**o
        ref[1,4]=(-0.779350765882)/(o+1.)+(-0.105263854865)+(0.29031515404)*0.5**o
        ref[2,0]=(1.15713722776)/(o+1.)+(-0.257366920834)+(0.881903169624)*0.5**o
        ref[2,1]=(-0.324479174944)/(o+1.)+(-0.135322103068)+(-0.503232182675)*0.5**o
        ref[2,2]=(-1.09155229033)/(o+1.)+(-0.649383760004)+(0.72138938011)*0.5**o
        ref[2,3]=(0.000728887534846)/(o+1.)+(-0.403181720629)+(-0.182060346819)*0.5**o
        ref[2,4]=(-1.48040434964)/(o+1.)+(0.321622919299)+(-0.5702456536)*0.5**o
        ref[3,0]=(0.0441097575979)/(o+1.)+(0.265503315876)+(0.445936563031)*0.5**o
        ref[3,1]=(-0.465569882106)/(o+1.)+(-0.112498265544)+(0.383619361689)*0.5**o
        ref[3,2]=(-0.368707136422)/(o+1.)+(0.472341525982)+(0.32727041247)*0.5**o
        ref[3,3]=(0.652257987397)/(o+1.)+(-0.511382354218)+(-0.684680337734)*0.5**o
        ref[3,4]=(1.59279253467)/(o+1.)+(1.07274701017)+(-0.790516141209)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_Solution_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(0.692838611059)*x[0]**o+(0.701451067887)*x[0]+(-0.958627133469)*x[1]**o+(0.309968446224)*x[1]
        s[0,0,1]=(-0.601729371833)*x[0]**o+(-0.00949649239345)*x[0]+(0.178428915942)*x[1]**o+(-0.378187092112)*x[1]
        s[0,1,0]=(-0.911621902906)*x[0]**o+(0.699730287366)*x[0]+(0.849669560241)*x[1]**o+(-0.24390831078)*x[1]
        s[0,1,1]=(-0.772410377566)*x[0]**o+(-0.775571271165)*x[0]+(0.429781604307)*x[1]**o+(-0.258252436014)*x[1]
        s[1,0,0]=(0.573401470974)*x[0]**o+(0.292621928093)*x[0]+(-0.584549055271)*x[1]**o+(-0.660681435117)*x[1]
        s[1,0,1]=(-0.0867987965936)*x[0]**o+(0.195581072977)*x[0]+(-0.259345214698)*x[1]**o+(-0.431225825128)*x[1]
        s[1,1,0]=(0.170068866316)*x[0]**o+(-0.0665083899809)*x[0]+(0.814824812224)*x[1]**o+(0.278218338402)*x[1]
        s[1,1,1]=(-0.424226747289)*x[0]**o+(-0.0605087462286)*x[0]+(0.72215867299)*x[1]**o+(0.636823345898)*x[1]
        s[2,0,0]=(0.948475744468)*x[0]**o+(-0.256081956766)*x[0]+(-0.265551833564)*x[1]**o+(0.219079882965)*x[1]
        s[2,0,1]=(-0.620771197949)*x[0]**o+(0.203458256679)*x[0]+(-0.950417242448)*x[1]**o+(0.0830268150339)*x[1]
        s[2,1,0]=(-0.392672423199)*x[0]**o+(0.0910137955111)*x[0]+(-0.8417031543)*x[1]**o+(-0.456474678014)*x[1]
        s[2,1,1]=(-0.0312010236388)*x[0]**o+(0.307221450065)*x[0]+(-0.479938290822)*x[1]**o+(-0.689609404462)*x[1]
        s[3,0,0]=(0.124108191486)*x[0]**o+(-0.786546027037)*x[0]+(0.0449572653773)*x[1]**o+(-0.887765762037)*x[1]
        s[3,0,1]=(0.327690655208)*x[0]**o+(-0.651767483905)*x[0]+(-0.14328969555)*x[1]**o+(-0.574417616475)*x[1]
        s[3,1,0]=(0.375233560681)*x[0]**o+(-0.4952402604)*x[0]+(0.419976842971)*x[1]**o+(0.573510110207)*x[1]
        s[3,1,1]=(-0.61513881981)*x[0]**o+(-0.42349537427)*x[0]+(-0.513786717031)*x[1]**o+(-0.656407725495)*x[1]
        s[4,0,0]=(-0.212361872891)*x[0]**o+(-0.274380100495)*x[0]+(-0.115417216962)*x[1]**o+(-0.407361424262)*x[1]
        s[4,0,1]=(-0.26215416052)*x[0]**o+(0.560215913083)*x[0]+(0.949340402876)*x[1]**o+(-0.311511101847)*x[1]
        s[4,1,0]=(0.35481412373)*x[0]**o+(0.55002753014)*x[0]+(-0.427957479742)*x[1]**o+(-0.571074070608)*x[1]
        s[4,1,1]=(0.228369065715)*x[0]**o+(0.34597130297)*x[0]+(-0.099176239601)*x[1]**o+(0.0149309525659)*x[1]
        s[5,0,0]=(-0.230638577613)*x[0]**o+(-0.450379175116)*x[0]+(0.150498069811)*x[1]**o+(-0.26480588837)*x[1]
        s[5,0,1]=(-0.563920707349)*x[0]**o+(-0.678734552317)*x[0]+(0.499409088964)*x[1]**o+(0.636349121568)*x[1]
        s[5,1,0]=(-0.654320489103)*x[0]**o+(-0.759308190818)*x[0]+(0.638645835733)*x[1]**o+(-0.932431876846)*x[1]
        s[5,1,1]=(-0.067089857507)*x[0]**o+(-0.828076668167)*x[0]+(0.329157131175)*x[1]**o+(0.191945408984)*x[1]
        ref[0,0,0]=(-0.958627133469)/(o+1.)+(0.505709757056)+(0.692838611059)*0.5**o
        ref[0,0,1]=(0.178428915942)/(o+1.)+(-0.193841792253)+(-0.601729371833)*0.5**o
        ref[0,1,0]=(0.849669560241)/(o+1.)+(0.227910988293)+(-0.911621902906)*0.5**o
        ref[0,1,1]=(0.429781604307)/(o+1.)+(-0.51691185359)+(-0.772410377566)*0.5**o
        ref[1,0,0]=(-0.584549055271)/(o+1.)+(-0.184029753512)+(0.573401470974)*0.5**o
        ref[1,0,1]=(-0.259345214698)/(o+1.)+(-0.117822376075)+(-0.0867987965936)*0.5**o
        ref[1,1,0]=(0.814824812224)/(o+1.)+(0.10585497421)+(0.170068866316)*0.5**o
        ref[1,1,1]=(0.72215867299)/(o+1.)+(0.288157299835)+(-0.424226747289)*0.5**o
        ref[2,0,0]=(-0.265551833564)/(o+1.)+(-0.0185010369005)+(0.948475744468)*0.5**o
        ref[2,0,1]=(-0.950417242448)/(o+1.)+(0.143242535857)+(-0.620771197949)*0.5**o
        ref[2,1,0]=(-0.8417031543)/(o+1.)+(-0.182730441252)+(-0.392672423199)*0.5**o
        ref[2,1,1]=(-0.479938290822)/(o+1.)+(-0.191193977199)+(-0.0312010236388)*0.5**o
        ref[3,0,0]=(0.0449572653773)/(o+1.)+(-0.837155894537)+(0.124108191486)*0.5**o
        ref[3,0,1]=(-0.14328969555)/(o+1.)+(-0.61309255019)+(0.327690655208)*0.5**o
        ref[3,1,0]=(0.419976842971)/(o+1.)+(0.0391349249035)+(0.375233560681)*0.5**o
        ref[3,1,1]=(-0.513786717031)/(o+1.)+(-0.539951549882)+(-0.61513881981)*0.5**o
        ref[4,0,0]=(-0.115417216962)/(o+1.)+(-0.340870762378)+(-0.212361872891)*0.5**o
        ref[4,0,1]=(0.949340402876)/(o+1.)+(0.124352405618)+(-0.26215416052)*0.5**o
        ref[4,1,0]=(-0.427957479742)/(o+1.)+(-0.0105232702342)+(0.35481412373)*0.5**o
        ref[4,1,1]=(-0.099176239601)/(o+1.)+(0.180451127768)+(0.228369065715)*0.5**o
        ref[5,0,0]=(0.150498069811)/(o+1.)+(-0.357592531743)+(-0.230638577613)*0.5**o
        ref[5,0,1]=(0.499409088964)/(o+1.)+(-0.0211927153744)+(-0.563920707349)*0.5**o
        ref[5,1,0]=(0.638645835733)/(o+1.)+(-0.845870033832)+(-0.654320489103)*0.5**o
        ref[5,1,1]=(0.329157131175)/(o+1.)+(-0.318065629591)+(-0.067089857507)*0.5**o
      else:
        s[0,0,0]=(-0.746527687404)*x[0]**o+(-0.596594966324)*x[0]+(0.2810066152)*x[1]**o+(-0.811343974865)*x[1]+(-0.021161977844)*x[2]**o+(-0.955799066641)*x[2]
        s[0,0,1]=(-0.431368611796)*x[0]**o+(0.209275860867)*x[0]+(-0.744753738662)*x[1]**o+(0.427090838531)*x[1]+(-0.125264890706)*x[2]**o+(0.212116081598)*x[2]
        s[0,1,0]=(-0.262032384111)*x[0]**o+(-0.690463175517)*x[0]+(-0.942716909227)*x[1]**o+(-0.512385399849)*x[1]+(0.0838382201449)*x[2]**o+(-0.645258119863)*x[2]
        s[0,1,1]=(0.528688164571)*x[0]**o+(0.436957291986)*x[0]+(-0.537210963816)*x[1]**o+(-0.857589396313)*x[1]+(-0.748363024129)*x[2]**o+(-0.562281821776)*x[2]
        s[1,0,0]=(0.612146020485)*x[0]**o+(0.732593742961)*x[0]+(-0.0856859718674)*x[1]**o+(0.620805675371)*x[1]+(-0.675276046976)*x[2]**o+(0.768362539829)*x[2]
        s[1,0,1]=(0.953317188148)*x[0]**o+(0.501280748029)*x[0]+(0.613804663039)*x[1]**o+(-0.346135069339)*x[1]+(-0.429549388245)*x[2]**o+(-0.460492494281)*x[2]
        s[1,1,0]=(-0.800228112753)*x[0]**o+(-0.849501214281)*x[0]+(-0.397413958567)*x[1]**o+(0.126586313232)*x[1]+(0.117902029118)*x[2]**o+(-0.163407646867)*x[2]
        s[1,1,1]=(0.814833462883)*x[0]**o+(0.888315382151)*x[0]+(-0.729112863291)*x[1]**o+(-0.990948475544)*x[1]+(-0.407293718484)*x[2]**o+(0.0356918466558)*x[2]
        s[2,0,0]=(0.82229169437)*x[0]**o+(0.346827253309)*x[0]+(-0.747273461294)*x[1]**o+(-0.398145482826)*x[1]+(0.889222392384)*x[2]**o+(0.618983213439)*x[2]
        s[2,0,1]=(-0.829164090486)*x[0]**o+(0.101408063492)*x[0]+(-0.323588772419)*x[1]**o+(-0.513436504297)*x[1]+(0.603168070349)*x[2]**o+(0.469577367849)*x[2]
        s[2,1,0]=(-0.174002172236)*x[0]**o+(0.0457253546329)*x[0]+(0.0680387720249)*x[1]**o+(0.108246528319)*x[1]+(-0.378115826261)*x[2]**o+(0.320064337589)*x[2]
        s[2,1,1]=(0.526364662089)*x[0]**o+(0.715789167446)*x[0]+(0.938035509553)*x[1]**o+(0.811137499085)*x[1]+(0.0343661926035)*x[2]**o+(-0.134159658752)*x[2]
        s[3,0,0]=(-0.391083668074)*x[0]**o+(-0.286558934534)*x[0]+(-0.900015970878)*x[1]**o+(-0.44319367626)*x[1]+(0.97392981229)*x[2]**o+(-0.470626411857)*x[2]
        s[3,0,1]=(-0.733432908462)*x[0]**o+(-0.678130107598)*x[0]+(0.150603930952)*x[1]**o+(-0.598239006862)*x[1]+(-0.768485734549)*x[2]**o+(-0.970399443344)*x[2]
        s[3,1,0]=(-0.247608296411)*x[0]**o+(0.153504414444)*x[0]+(-0.990050628042)*x[1]**o+(-0.274052014666)*x[1]+(-0.614045325729)*x[2]**o+(0.742660852789)*x[2]
        s[3,1,1]=(-0.848161397237)*x[0]**o+(0.0389689968506)*x[0]+(-0.746088757211)*x[1]**o+(0.964788844721)*x[1]+(0.0365840578283)*x[2]**o+(0.0937959359018)*x[2]
        s[4,0,0]=(-0.998118542373)*x[0]**o+(-0.622412978573)*x[0]+(-0.23375496789)*x[1]**o+(0.713065960655)*x[1]+(-0.134547861774)*x[2]**o+(-0.65617589708)*x[2]
        s[4,0,1]=(-0.633127771386)*x[0]**o+(-0.621567651537)*x[0]+(-0.54904676147)*x[1]**o+(-0.868056268787)*x[1]+(0.234405832043)*x[2]**o+(0.737621357594)*x[2]
        s[4,1,0]=(0.862411543309)*x[0]**o+(-0.737128008238)*x[0]+(0.307586357348)*x[1]**o+(0.760442280183)*x[1]+(-0.56282765669)*x[2]**o+(-0.0147875945863)*x[2]
        s[4,1,1]=(0.314415379367)*x[0]**o+(0.626003051386)*x[0]+(0.997284366098)*x[1]**o+(-0.199517448031)*x[1]+(0.375147056596)*x[2]**o+(0.732546433867)*x[2]
        s[5,0,0]=(0.819256041498)*x[0]**o+(0.733896748535)*x[0]+(0.0839088873455)*x[1]**o+(0.515382312439)*x[1]+(-0.0194919927864)*x[2]**o+(0.0318260275007)*x[2]
        s[5,0,1]=(0.940274091937)*x[0]**o+(-0.735201721223)*x[0]+(-0.953504926957)*x[1]**o+(-0.945986665743)*x[1]+(-0.0220685469559)*x[2]**o+(0.622957541524)*x[2]
        s[5,1,0]=(-0.93927853219)*x[0]**o+(-0.886451123487)*x[0]+(0.448010704185)*x[1]**o+(-0.9971779094)*x[1]+(0.782692635361)*x[2]**o+(0.690868313501)*x[2]
        s[5,1,1]=(0.101661872917)*x[0]**o+(0.636433790255)*x[0]+(0.526460976779)*x[1]**o+(-0.603459918432)*x[1]+(0.107035082256)*x[2]**o+(0.252479495202)*x[2]
        ref[0,0,0]=(0.259844637356)/(o+1.)+(-1.18186900391)+(-0.746527687404)*0.5**o
        ref[0,0,1]=(-0.870018629367)/(o+1.)+(0.424241390497)+(-0.431368611796)*0.5**o
        ref[0,1,0]=(-0.858878689082)/(o+1.)+(-0.924053347614)+(-0.262032384111)*0.5**o
        ref[0,1,1]=(-1.28557398794)/(o+1.)+(-0.491456963051)+(0.528688164571)*0.5**o
        ref[1,0,0]=(-0.760962018843)/(o+1.)+(1.06088097908)+(0.612146020485)*0.5**o
        ref[1,0,1]=(0.184255274794)/(o+1.)+(-0.152673407796)+(0.953317188148)*0.5**o
        ref[1,1,0]=(-0.279511929449)/(o+1.)+(-0.443161273958)+(-0.800228112753)*0.5**o
        ref[1,1,1]=(-1.13640658178)/(o+1.)+(-0.0334706233686)+(0.814833462883)*0.5**o
        ref[2,0,0]=(0.14194893109)/(o+1.)+(0.283832491961)+(0.82229169437)*0.5**o
        ref[2,0,1]=(0.27957929793)/(o+1.)+(0.0287744635219)+(-0.829164090486)*0.5**o
        ref[2,1,0]=(-0.310077054236)/(o+1.)+(0.23701811027)+(-0.174002172236)*0.5**o
        ref[2,1,1]=(0.972401702157)/(o+1.)+(0.696383503889)+(0.526364662089)*0.5**o
        ref[3,0,0]=(0.0739138414121)/(o+1.)+(-0.600189511325)+(-0.391083668074)*0.5**o
        ref[3,0,1]=(-0.617881803597)/(o+1.)+(-1.1233842789)+(-0.733432908462)*0.5**o
        ref[3,1,0]=(-1.60409595377)/(o+1.)+(0.311056626283)+(-0.247608296411)*0.5**o
        ref[3,1,1]=(-0.709504699383)/(o+1.)+(0.548776888736)+(-0.848161397237)*0.5**o
        ref[4,0,0]=(-0.368302829664)/(o+1.)+(-0.282761457499)+(-0.998118542373)*0.5**o
        ref[4,0,1]=(-0.314640929426)/(o+1.)+(-0.376001281365)+(-0.633127771386)*0.5**o
        ref[4,1,0]=(-0.255241299343)/(o+1.)+(0.00426333867911)+(0.862411543309)*0.5**o
        ref[4,1,1]=(1.37243142269)/(o+1.)+(0.579516018611)+(0.314415379367)*0.5**o
        ref[5,0,0]=(0.0644168945591)/(o+1.)+(0.640552544238)+(0.819256041498)*0.5**o
        ref[5,0,1]=(-0.975573473912)/(o+1.)+(-0.529115422721)+(0.940274091937)*0.5**o
        ref[5,1,0]=(1.23070333955)/(o+1.)+(-0.596380359693)+(-0.93927853219)*0.5**o
        ref[5,1,1]=(0.633496059035)/(o+1.)+(0.142726683513)+(0.101661872917)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_Solution_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.686834873081)*x[0]**o+(0.894217065974)*x[0]+(0.464807422099)*x[1]**o+(0.117486893484)*x[1]
        s[0,0,0,1]=(0.423267211666)*x[0]**o+(-0.926368250674)*x[0]+(-0.00127389833363)*x[1]**o+(0.644912230378)*x[1]
        s[0,0,1,0]=(0.225761019463)*x[0]**o+(0.941520398103)*x[0]+(0.698674836081)*x[1]**o+(-0.545668525315)*x[1]
        s[0,0,1,1]=(-0.0578569008694)*x[0]**o+(0.886606073204)*x[0]+(-0.943532460794)*x[1]**o+(0.63316605865)*x[1]
        s[0,0,2,0]=(-0.955100804268)*x[0]**o+(-0.197482002011)*x[0]+(0.727953088594)*x[1]**o+(0.842355085503)*x[1]
        s[0,0,2,1]=(0.55641264625)*x[0]**o+(0.26186880746)*x[0]+(0.769897594142)*x[1]**o+(0.630360270402)*x[1]
        s[0,1,0,0]=(0.0417005921153)*x[0]**o+(-0.254303592363)*x[0]+(0.517125320203)*x[1]**o+(0.356198004099)*x[1]
        s[0,1,0,1]=(-0.975918028511)*x[0]**o+(-0.655984560339)*x[0]+(0.00235297753913)*x[1]**o+(-0.111765878548)*x[1]
        s[0,1,1,0]=(-0.16393042329)*x[0]**o+(0.420621371478)*x[0]+(0.367090269805)*x[1]**o+(0.610715442136)*x[1]
        s[0,1,1,1]=(-0.875851967836)*x[0]**o+(-0.816358619616)*x[0]+(0.80277045991)*x[1]**o+(0.717265655871)*x[1]
        s[0,1,2,0]=(0.871764357933)*x[0]**o+(-0.867731309803)*x[0]+(0.410055383976)*x[1]**o+(-0.722483045113)*x[1]
        s[0,1,2,1]=(-0.427119083496)*x[0]**o+(-0.833805789919)*x[0]+(-0.275401454293)*x[1]**o+(0.442220067398)*x[1]
        s[0,2,0,0]=(0.462551904284)*x[0]**o+(-0.0535451795861)*x[0]+(0.270504950569)*x[1]**o+(0.834360806219)*x[1]
        s[0,2,0,1]=(-0.0507590824972)*x[0]**o+(0.26574820566)*x[0]+(0.610544260364)*x[1]**o+(-0.890035786158)*x[1]
        s[0,2,1,0]=(-0.638445791035)*x[0]**o+(-0.305351157409)*x[0]+(0.965223780441)*x[1]**o+(0.982229276343)*x[1]
        s[0,2,1,1]=(-0.731025223911)*x[0]**o+(0.307228768356)*x[0]+(0.645857556893)*x[1]**o+(0.913645113546)*x[1]
        s[0,2,2,0]=(-0.196899050904)*x[0]**o+(0.150588444027)*x[0]+(0.603646143067)*x[1]**o+(0.811245615941)*x[1]
        s[0,2,2,1]=(0.546119342726)*x[0]**o+(0.204141566001)*x[0]+(0.114502748703)*x[1]**o+(-0.698961842363)*x[1]
        s[0,3,0,0]=(-0.0426650685874)*x[0]**o+(-0.335440677298)*x[0]+(-0.174118589494)*x[1]**o+(-0.851843219794)*x[1]
        s[0,3,0,1]=(-0.14536830456)*x[0]**o+(0.505179058635)*x[0]+(-0.942847104809)*x[1]**o+(0.518276559236)*x[1]
        s[0,3,1,0]=(-0.737548624771)*x[0]**o+(0.70571598977)*x[0]+(-0.746943114818)*x[1]**o+(-0.2127583186)*x[1]
        s[0,3,1,1]=(0.360491166663)*x[0]**o+(0.986095817206)*x[0]+(-0.918270622952)*x[1]**o+(0.617678170994)*x[1]
        s[0,3,2,0]=(-0.570338406694)*x[0]**o+(-0.513173501835)*x[0]+(0.572925790394)*x[1]**o+(0.130209822282)*x[1]
        s[0,3,2,1]=(0.112118675411)*x[0]**o+(0.561084973521)*x[0]+(0.598978537086)*x[1]**o+(-0.0313515131555)*x[1]
        s[0,4,0,0]=(-0.971043700474)*x[0]**o+(0.841925646149)*x[0]+(0.858700520274)*x[1]**o+(-0.304258365028)*x[1]
        s[0,4,0,1]=(-0.33210808558)*x[0]**o+(-0.453977822683)*x[0]+(-0.74202650883)*x[1]**o+(0.546471602539)*x[1]
        s[0,4,1,0]=(-0.622155482312)*x[0]**o+(-0.0779995859909)*x[0]+(0.221889403634)*x[1]**o+(0.342594640865)*x[1]
        s[0,4,1,1]=(-0.83327572159)*x[0]**o+(-0.736091414594)*x[0]+(-0.907324696118)*x[1]**o+(0.543711697923)*x[1]
        s[0,4,2,0]=(0.97730521508)*x[0]**o+(0.680289384194)*x[0]+(0.749574300046)*x[1]**o+(-0.279718517953)*x[1]
        s[0,4,2,1]=(-0.188385359119)*x[0]**o+(-0.517585952202)*x[0]+(-0.92321177387)*x[1]**o+(0.794132586536)*x[1]
        s[1,0,0,0]=(-0.691363379735)*x[0]**o+(-0.338291851496)*x[0]+(0.708824882363)*x[1]**o+(-0.154240182249)*x[1]
        s[1,0,0,1]=(0.391349048346)*x[0]**o+(0.10762051179)*x[0]+(0.971913362543)*x[1]**o+(-0.0532019503958)*x[1]
        s[1,0,1,0]=(-0.669458166029)*x[0]**o+(0.353354538692)*x[0]+(-0.441190419207)*x[1]**o+(-0.528430239493)*x[1]
        s[1,0,1,1]=(0.107848426266)*x[0]**o+(-0.076965091351)*x[0]+(0.745243283501)*x[1]**o+(-0.782833446988)*x[1]
        s[1,0,2,0]=(0.364065471931)*x[0]**o+(0.54771360956)*x[0]+(0.565373904163)*x[1]**o+(0.616558822792)*x[1]
        s[1,0,2,1]=(-0.379996842423)*x[0]**o+(0.392499507062)*x[0]+(-0.808821894825)*x[1]**o+(-0.615251700689)*x[1]
        s[1,1,0,0]=(-0.245969602554)*x[0]**o+(0.436762196801)*x[0]+(0.860717658702)*x[1]**o+(0.132856923997)*x[1]
        s[1,1,0,1]=(-0.461963226134)*x[0]**o+(0.620555910148)*x[0]+(-0.119798710079)*x[1]**o+(0.0221208440902)*x[1]
        s[1,1,1,0]=(-0.357540385682)*x[0]**o+(0.35759692542)*x[0]+(-0.542207154591)*x[1]**o+(-0.334151697958)*x[1]
        s[1,1,1,1]=(-0.507609494267)*x[0]**o+(0.298724176211)*x[0]+(-0.689016521358)*x[1]**o+(-0.574923042649)*x[1]
        s[1,1,2,0]=(-0.314205160643)*x[0]**o+(-0.855793612952)*x[0]+(0.245833632085)*x[1]**o+(0.65947369599)*x[1]
        s[1,1,2,1]=(0.92975337751)*x[0]**o+(0.981531336944)*x[0]+(0.889631731534)*x[1]**o+(0.96084291721)*x[1]
        s[1,2,0,0]=(-0.206928230723)*x[0]**o+(-0.0227833929279)*x[0]+(0.910908314307)*x[1]**o+(-0.293206125585)*x[1]
        s[1,2,0,1]=(0.655611121589)*x[0]**o+(-0.363559028874)*x[0]+(0.944323994431)*x[1]**o+(0.675785829867)*x[1]
        s[1,2,1,0]=(0.097163050774)*x[0]**o+(-0.306871139813)*x[0]+(-0.583236391219)*x[1]**o+(0.2082878001)*x[1]
        s[1,2,1,1]=(0.966536588817)*x[0]**o+(0.366298955916)*x[0]+(0.637843032912)*x[1]**o+(0.808769955133)*x[1]
        s[1,2,2,0]=(-0.688421104726)*x[0]**o+(-0.208613716503)*x[0]+(-0.264530414111)*x[1]**o+(-0.869467631827)*x[1]
        s[1,2,2,1]=(0.572370662453)*x[0]**o+(0.0176965600004)*x[0]+(-0.252518792378)*x[1]**o+(-0.696779486832)*x[1]
        s[1,3,0,0]=(-0.23128498)*x[0]**o+(0.0318637329932)*x[0]+(0.477807829207)*x[1]**o+(-0.512393411225)*x[1]
        s[1,3,0,1]=(-0.121822943652)*x[0]**o+(0.264705755391)*x[0]+(-0.477007018414)*x[1]**o+(0.991097887584)*x[1]
        s[1,3,1,0]=(-0.338674627679)*x[0]**o+(0.779182013477)*x[0]+(-0.0510727374236)*x[1]**o+(0.613462237402)*x[1]
        s[1,3,1,1]=(-0.842082566923)*x[0]**o+(0.659487619964)*x[0]+(-0.0616578458759)*x[1]**o+(0.691256407339)*x[1]
        s[1,3,2,0]=(0.462359358829)*x[0]**o+(-0.782666568422)*x[0]+(-0.00922728778114)*x[1]**o+(0.935329586498)*x[1]
        s[1,3,2,1]=(0.0965038514703)*x[0]**o+(0.937329942152)*x[0]+(-0.0289919380082)*x[1]**o+(0.453957829701)*x[1]
        s[1,4,0,0]=(-0.577911003192)*x[0]**o+(0.74727013652)*x[0]+(-0.970205360146)*x[1]**o+(-0.525871518563)*x[1]
        s[1,4,0,1]=(0.0798727685012)*x[0]**o+(0.181295188234)*x[0]+(0.321952537611)*x[1]**o+(-0.702604584966)*x[1]
        s[1,4,1,0]=(-0.132278278329)*x[0]**o+(0.975101058477)*x[0]+(0.236705098567)*x[1]**o+(-0.10937616935)*x[1]
        s[1,4,1,1]=(-0.361402070774)*x[0]**o+(-0.370364725782)*x[0]+(-0.610674940874)*x[1]**o+(-0.0962382083614)*x[1]
        s[1,4,2,0]=(0.813396048857)*x[0]**o+(0.292472923811)*x[0]+(-0.901067471391)*x[1]**o+(0.547614067474)*x[1]
        s[1,4,2,1]=(0.390285391184)*x[0]**o+(-0.385915061071)*x[0]+(-0.0402809003623)*x[1]**o+(-0.988197507151)*x[1]
        s[2,0,0,0]=(-0.249708353038)*x[0]**o+(-0.906354186065)*x[0]+(0.962323825393)*x[1]**o+(0.0966005473089)*x[1]
        s[2,0,0,1]=(0.815655802435)*x[0]**o+(0.59037691594)*x[0]+(-0.913553917647)*x[1]**o+(0.195455032055)*x[1]
        s[2,0,1,0]=(-0.041263589419)*x[0]**o+(-0.722404855046)*x[0]+(0.792396772777)*x[1]**o+(0.980090324531)*x[1]
        s[2,0,1,1]=(0.336059537191)*x[0]**o+(-0.953661694087)*x[0]+(-0.377727072925)*x[1]**o+(-0.00288817417099)*x[1]
        s[2,0,2,0]=(0.0637701377122)*x[0]**o+(0.185264659888)*x[0]+(-0.63229573614)*x[1]**o+(-0.743036413091)*x[1]
        s[2,0,2,1]=(-0.187859444818)*x[0]**o+(-0.513109580827)*x[0]+(-0.649825178883)*x[1]**o+(0.883502750572)*x[1]
        s[2,1,0,0]=(0.87708393158)*x[0]**o+(-0.868702717082)*x[0]+(-0.727725348725)*x[1]**o+(-0.977109996353)*x[1]
        s[2,1,0,1]=(-0.192407804254)*x[0]**o+(0.240131364352)*x[0]+(-0.907681129252)*x[1]**o+(0.558779298439)*x[1]
        s[2,1,1,0]=(0.153001662465)*x[0]**o+(0.795683040566)*x[0]+(0.0438148749584)*x[1]**o+(-0.0621663419181)*x[1]
        s[2,1,1,1]=(0.591374562403)*x[0]**o+(0.0792161473602)*x[0]+(0.692300008749)*x[1]**o+(0.497404274834)*x[1]
        s[2,1,2,0]=(-0.742751457969)*x[0]**o+(0.963865160953)*x[0]+(-0.217320783858)*x[1]**o+(-0.532084042794)*x[1]
        s[2,1,2,1]=(-0.834015860027)*x[0]**o+(0.154439983509)*x[0]+(0.497803852733)*x[1]**o+(0.205893944848)*x[1]
        s[2,2,0,0]=(-0.203653128753)*x[0]**o+(0.240132473537)*x[0]+(-0.655435581477)*x[1]**o+(-0.858878900716)*x[1]
        s[2,2,0,1]=(0.971807071325)*x[0]**o+(-0.373206373801)*x[0]+(0.140960526316)*x[1]**o+(-0.726655373182)*x[1]
        s[2,2,1,0]=(0.36337495614)*x[0]**o+(0.024734800399)*x[0]+(-0.87272068545)*x[1]**o+(-0.342758158473)*x[1]
        s[2,2,1,1]=(0.703205712066)*x[0]**o+(-0.701536561698)*x[0]+(0.849847759033)*x[1]**o+(0.436346580068)*x[1]
        s[2,2,2,0]=(0.814179476293)*x[0]**o+(-0.722566145563)*x[0]+(0.730674735708)*x[1]**o+(0.433386430731)*x[1]
        s[2,2,2,1]=(0.465577907694)*x[0]**o+(-0.0864038816161)*x[0]+(0.927807005045)*x[1]**o+(0.56469159985)*x[1]
        s[2,3,0,0]=(-0.0809501575869)*x[0]**o+(-0.618484411939)*x[0]+(0.737902566912)*x[1]**o+(0.599580560022)*x[1]
        s[2,3,0,1]=(-0.974260986562)*x[0]**o+(0.403417818779)*x[0]+(0.688538873306)*x[1]**o+(0.12462953818)*x[1]
        s[2,3,1,0]=(0.256567297589)*x[0]**o+(0.996662217474)*x[0]+(-0.892476705335)*x[1]**o+(-0.586859542133)*x[1]
        s[2,3,1,1]=(0.600281177478)*x[0]**o+(-0.884090855927)*x[0]+(0.724531635238)*x[1]**o+(-0.16428377776)*x[1]
        s[2,3,2,0]=(-0.316555549763)*x[0]**o+(0.654066898461)*x[0]+(-0.636613154487)*x[1]**o+(-0.0527299937889)*x[1]
        s[2,3,2,1]=(0.509096161125)*x[0]**o+(0.553056557071)*x[0]+(0.241657689068)*x[1]**o+(-0.988729739553)*x[1]
        s[2,4,0,0]=(-0.00190589099569)*x[0]**o+(-0.838680435068)*x[0]+(-0.531592666371)*x[1]**o+(0.26101901932)*x[1]
        s[2,4,0,1]=(0.727384767513)*x[0]**o+(-0.584151796751)*x[0]+(-0.32109862114)*x[1]**o+(-0.440158856065)*x[1]
        s[2,4,1,0]=(-0.190511998024)*x[0]**o+(0.695377622072)*x[0]+(0.815200064372)*x[1]**o+(-0.91046353217)*x[1]
        s[2,4,1,1]=(0.505564114308)*x[0]**o+(-0.139255460306)*x[0]+(0.323832915733)*x[1]**o+(-0.307972664581)*x[1]
        s[2,4,2,0]=(-0.199017289187)*x[0]**o+(-0.748501229072)*x[0]+(-0.378591546965)*x[1]**o+(0.862316455474)*x[1]
        s[2,4,2,1]=(-0.166203292304)*x[0]**o+(-0.0809782096656)*x[0]+(0.0866258209859)*x[1]**o+(0.443578824637)*x[1]
        s[3,0,0,0]=(0.264566793834)*x[0]**o+(0.811278578401)*x[0]+(0.42099538494)*x[1]**o+(0.199600034959)*x[1]
        s[3,0,0,1]=(0.235746402593)*x[0]**o+(-0.921869283354)*x[0]+(-0.566125315231)*x[1]**o+(0.0537623665249)*x[1]
        s[3,0,1,0]=(0.862345276865)*x[0]**o+(0.227476031253)*x[0]+(-0.448144780994)*x[1]**o+(-0.861358696525)*x[1]
        s[3,0,1,1]=(-0.896403179984)*x[0]**o+(0.431197708747)*x[0]+(-0.652497974262)*x[1]**o+(0.104540024804)*x[1]
        s[3,0,2,0]=(0.788731583728)*x[0]**o+(0.570545432128)*x[0]+(-0.455838556745)*x[1]**o+(0.629398526061)*x[1]
        s[3,0,2,1]=(-0.727929054337)*x[0]**o+(0.561826310816)*x[0]+(0.158791540215)*x[1]**o+(0.458507235686)*x[1]
        s[3,1,0,0]=(0.349297794591)*x[0]**o+(-0.179009101281)*x[0]+(-0.0535819231755)*x[1]**o+(-0.153059139984)*x[1]
        s[3,1,0,1]=(-0.759321371341)*x[0]**o+(-0.464845449228)*x[0]+(-0.800973035912)*x[1]**o+(0.905300621325)*x[1]
        s[3,1,1,0]=(-0.597928946862)*x[0]**o+(-0.621215873514)*x[0]+(0.521881881398)*x[1]**o+(0.570001614348)*x[1]
        s[3,1,1,1]=(-0.263124019379)*x[0]**o+(-0.970277462371)*x[0]+(0.445221632359)*x[1]**o+(-0.610952489733)*x[1]
        s[3,1,2,0]=(0.434074902924)*x[0]**o+(-0.34516630325)*x[0]+(0.812893197377)*x[1]**o+(-0.755651456445)*x[1]
        s[3,1,2,1]=(-0.724153308139)*x[0]**o+(-0.111288572288)*x[0]+(-0.40676151673)*x[1]**o+(0.547624797328)*x[1]
        s[3,2,0,0]=(0.915215698154)*x[0]**o+(-0.770595818702)*x[0]+(-0.88668061529)*x[1]**o+(0.37772776152)*x[1]
        s[3,2,0,1]=(-0.456607413762)*x[0]**o+(-0.972000077172)*x[0]+(0.453597269106)*x[1]**o+(-0.535557277591)*x[1]
        s[3,2,1,0]=(-0.428848816409)*x[0]**o+(-0.957711101461)*x[0]+(0.0771381998527)*x[1]**o+(0.578640765452)*x[1]
        s[3,2,1,1]=(-0.488115399257)*x[0]**o+(0.966283881858)*x[0]+(0.786396903927)*x[1]**o+(-0.427389628779)*x[1]
        s[3,2,2,0]=(-0.748108272191)*x[0]**o+(-0.411931818676)*x[0]+(-0.104450005208)*x[1]**o+(-0.548784991612)*x[1]
        s[3,2,2,1]=(-0.288896584199)*x[0]**o+(-0.599403262911)*x[0]+(-0.107194826319)*x[1]**o+(-0.714445846353)*x[1]
        s[3,3,0,0]=(-0.643859183999)*x[0]**o+(0.0290410872689)*x[0]+(0.184456668026)*x[1]**o+(0.62348637013)*x[1]
        s[3,3,0,1]=(-0.258292072759)*x[0]**o+(0.337782506924)*x[0]+(-0.653836797208)*x[1]**o+(-0.373955061219)*x[1]
        s[3,3,1,0]=(-0.659219139805)*x[0]**o+(0.39140958876)*x[0]+(0.684973413357)*x[1]**o+(-0.0642329755552)*x[1]
        s[3,3,1,1]=(-0.649682331365)*x[0]**o+(-0.00281746580006)*x[0]+(0.967988326693)*x[1]**o+(0.895373576808)*x[1]
        s[3,3,2,0]=(-0.0299199232233)*x[0]**o+(0.458695499665)*x[0]+(0.911862994231)*x[1]**o+(-0.748787338345)*x[1]
        s[3,3,2,1]=(0.197795840564)*x[0]**o+(-0.765596541276)*x[0]+(0.121310526207)*x[1]**o+(-0.300366665995)*x[1]
        s[3,4,0,0]=(0.278568700563)*x[0]**o+(-0.81691908238)*x[0]+(0.144475855023)*x[1]**o+(0.104006513674)*x[1]
        s[3,4,0,1]=(-0.608132003655)*x[0]**o+(0.847594429708)*x[0]+(-0.846906570194)*x[1]**o+(0.350085739363)*x[1]
        s[3,4,1,0]=(-0.490163043631)*x[0]**o+(0.929230880519)*x[0]+(-0.599983340725)*x[1]**o+(-0.252289176277)*x[1]
        s[3,4,1,1]=(-0.802228749858)*x[0]**o+(-0.835578269096)*x[0]+(-0.466727935821)*x[1]**o+(0.208416931397)*x[1]
        s[3,4,2,0]=(0.963914397515)*x[0]**o+(0.552034808675)*x[0]+(-0.0529537502248)*x[1]**o+(0.56193543593)*x[1]
        s[3,4,2,1]=(-0.201051432425)*x[0]**o+(0.720512883794)*x[0]+(0.942559524116)*x[1]**o+(-0.660858122132)*x[1]
        ref[0,0,0,0]=(0.464807422099)/(o+1.)+(0.505851979729)+(-0.686834873081)*0.5**o
        ref[0,0,0,1]=(-0.00127389833363)/(o+1.)+(-0.140728010148)+(0.423267211666)*0.5**o
        ref[0,0,1,0]=(0.698674836081)/(o+1.)+(0.197925936394)+(0.225761019463)*0.5**o
        ref[0,0,1,1]=(-0.943532460794)/(o+1.)+(0.759886065927)+(-0.0578569008694)*0.5**o
        ref[0,0,2,0]=(0.727953088594)/(o+1.)+(0.322436541746)+(-0.955100804268)*0.5**o
        ref[0,0,2,1]=(0.769897594142)/(o+1.)+(0.446114538931)+(0.55641264625)*0.5**o
        ref[0,1,0,0]=(0.517125320203)/(o+1.)+(0.0509472058681)+(0.0417005921153)*0.5**o
        ref[0,1,0,1]=(0.00235297753913)/(o+1.)+(-0.383875219444)+(-0.975918028511)*0.5**o
        ref[0,1,1,0]=(0.367090269805)/(o+1.)+(0.515668406807)+(-0.16393042329)*0.5**o
        ref[0,1,1,1]=(0.80277045991)/(o+1.)+(-0.0495464818722)+(-0.875851967836)*0.5**o
        ref[0,1,2,0]=(0.410055383976)/(o+1.)+(-0.795107177458)+(0.871764357933)*0.5**o
        ref[0,1,2,1]=(-0.275401454293)/(o+1.)+(-0.195792861261)+(-0.427119083496)*0.5**o
        ref[0,2,0,0]=(0.270504950569)/(o+1.)+(0.390407813316)+(0.462551904284)*0.5**o
        ref[0,2,0,1]=(0.610544260364)/(o+1.)+(-0.312143790249)+(-0.0507590824972)*0.5**o
        ref[0,2,1,0]=(0.965223780441)/(o+1.)+(0.338439059467)+(-0.638445791035)*0.5**o
        ref[0,2,1,1]=(0.645857556893)/(o+1.)+(0.610436940951)+(-0.731025223911)*0.5**o
        ref[0,2,2,0]=(0.603646143067)/(o+1.)+(0.480917029984)+(-0.196899050904)*0.5**o
        ref[0,2,2,1]=(0.114502748703)/(o+1.)+(-0.247410138181)+(0.546119342726)*0.5**o
        ref[0,3,0,0]=(-0.174118589494)/(o+1.)+(-0.593641948546)+(-0.0426650685874)*0.5**o
        ref[0,3,0,1]=(-0.942847104809)/(o+1.)+(0.511727808935)+(-0.14536830456)*0.5**o
        ref[0,3,1,0]=(-0.746943114818)/(o+1.)+(0.246478835585)+(-0.737548624771)*0.5**o
        ref[0,3,1,1]=(-0.918270622952)/(o+1.)+(0.8018869941)+(0.360491166663)*0.5**o
        ref[0,3,2,0]=(0.572925790394)/(o+1.)+(-0.191481839776)+(-0.570338406694)*0.5**o
        ref[0,3,2,1]=(0.598978537086)/(o+1.)+(0.264866730183)+(0.112118675411)*0.5**o
        ref[0,4,0,0]=(0.858700520274)/(o+1.)+(0.26883364056)+(-0.971043700474)*0.5**o
        ref[0,4,0,1]=(-0.74202650883)/(o+1.)+(0.0462468899283)+(-0.33210808558)*0.5**o
        ref[0,4,1,0]=(0.221889403634)/(o+1.)+(0.132297527437)+(-0.622155482312)*0.5**o
        ref[0,4,1,1]=(-0.907324696118)/(o+1.)+(-0.0961898583351)+(-0.83327572159)*0.5**o
        ref[0,4,2,0]=(0.749574300046)/(o+1.)+(0.200285433121)+(0.97730521508)*0.5**o
        ref[0,4,2,1]=(-0.92321177387)/(o+1.)+(0.138273317167)+(-0.188385359119)*0.5**o
        ref[1,0,0,0]=(0.708824882363)/(o+1.)+(-0.246266016873)+(-0.691363379735)*0.5**o
        ref[1,0,0,1]=(0.971913362543)/(o+1.)+(0.0272092806971)+(0.391349048346)*0.5**o
        ref[1,0,1,0]=(-0.441190419207)/(o+1.)+(-0.0875378504002)+(-0.669458166029)*0.5**o
        ref[1,0,1,1]=(0.745243283501)/(o+1.)+(-0.42989926917)+(0.107848426266)*0.5**o
        ref[1,0,2,0]=(0.565373904163)/(o+1.)+(0.582136216176)+(0.364065471931)*0.5**o
        ref[1,0,2,1]=(-0.808821894825)/(o+1.)+(-0.111376096814)+(-0.379996842423)*0.5**o
        ref[1,1,0,0]=(0.860717658702)/(o+1.)+(0.284809560399)+(-0.245969602554)*0.5**o
        ref[1,1,0,1]=(-0.119798710079)/(o+1.)+(0.321338377119)+(-0.461963226134)*0.5**o
        ref[1,1,1,0]=(-0.542207154591)/(o+1.)+(0.0117226137313)+(-0.357540385682)*0.5**o
        ref[1,1,1,1]=(-0.689016521358)/(o+1.)+(-0.138099433219)+(-0.507609494267)*0.5**o
        ref[1,1,2,0]=(0.245833632085)/(o+1.)+(-0.0981599584809)+(-0.314205160643)*0.5**o
        ref[1,1,2,1]=(0.889631731534)/(o+1.)+(0.971187127077)+(0.92975337751)*0.5**o
        ref[1,2,0,0]=(0.910908314307)/(o+1.)+(-0.157994759256)+(-0.206928230723)*0.5**o
        ref[1,2,0,1]=(0.944323994431)/(o+1.)+(0.156113400497)+(0.655611121589)*0.5**o
        ref[1,2,1,0]=(-0.583236391219)/(o+1.)+(-0.0492916698561)+(0.097163050774)*0.5**o
        ref[1,2,1,1]=(0.637843032912)/(o+1.)+(0.587534455525)+(0.966536588817)*0.5**o
        ref[1,2,2,0]=(-0.264530414111)/(o+1.)+(-0.539040674165)+(-0.688421104726)*0.5**o
        ref[1,2,2,1]=(-0.252518792378)/(o+1.)+(-0.339541463416)+(0.572370662453)*0.5**o
        ref[1,3,0,0]=(0.477807829207)/(o+1.)+(-0.240264839116)+(-0.23128498)*0.5**o
        ref[1,3,0,1]=(-0.477007018414)/(o+1.)+(0.627901821488)+(-0.121822943652)*0.5**o
        ref[1,3,1,0]=(-0.0510727374236)/(o+1.)+(0.69632212544)+(-0.338674627679)*0.5**o
        ref[1,3,1,1]=(-0.0616578458759)/(o+1.)+(0.675372013651)+(-0.842082566923)*0.5**o
        ref[1,3,2,0]=(-0.00922728778114)/(o+1.)+(0.0763315090377)+(0.462359358829)*0.5**o
        ref[1,3,2,1]=(-0.0289919380082)/(o+1.)+(0.695643885927)+(0.0965038514703)*0.5**o
        ref[1,4,0,0]=(-0.970205360146)/(o+1.)+(0.110699308979)+(-0.577911003192)*0.5**o
        ref[1,4,0,1]=(0.321952537611)/(o+1.)+(-0.260654698366)+(0.0798727685012)*0.5**o
        ref[1,4,1,0]=(0.236705098567)/(o+1.)+(0.432862444563)+(-0.132278278329)*0.5**o
        ref[1,4,1,1]=(-0.610674940874)/(o+1.)+(-0.233301467071)+(-0.361402070774)*0.5**o
        ref[1,4,2,0]=(-0.901067471391)/(o+1.)+(0.420043495642)+(0.813396048857)*0.5**o
        ref[1,4,2,1]=(-0.0402809003623)/(o+1.)+(-0.687056284111)+(0.390285391184)*0.5**o
        ref[2,0,0,0]=(0.962323825393)/(o+1.)+(-0.404876819378)+(-0.249708353038)*0.5**o
        ref[2,0,0,1]=(-0.913553917647)/(o+1.)+(0.392915973998)+(0.815655802435)*0.5**o
        ref[2,0,1,0]=(0.792396772777)/(o+1.)+(0.128842734742)+(-0.041263589419)*0.5**o
        ref[2,0,1,1]=(-0.377727072925)/(o+1.)+(-0.478274934129)+(0.336059537191)*0.5**o
        ref[2,0,2,0]=(-0.63229573614)/(o+1.)+(-0.278885876602)+(0.0637701377122)*0.5**o
        ref[2,0,2,1]=(-0.649825178883)/(o+1.)+(0.185196584873)+(-0.187859444818)*0.5**o
        ref[2,1,0,0]=(-0.727725348725)/(o+1.)+(-0.922906356717)+(0.87708393158)*0.5**o
        ref[2,1,0,1]=(-0.907681129252)/(o+1.)+(0.399455331395)+(-0.192407804254)*0.5**o
        ref[2,1,1,0]=(0.0438148749584)/(o+1.)+(0.366758349324)+(0.153001662465)*0.5**o
        ref[2,1,1,1]=(0.692300008749)/(o+1.)+(0.288310211097)+(0.591374562403)*0.5**o
        ref[2,1,2,0]=(-0.217320783858)/(o+1.)+(0.21589055908)+(-0.742751457969)*0.5**o
        ref[2,1,2,1]=(0.497803852733)/(o+1.)+(0.180166964178)+(-0.834015860027)*0.5**o
        ref[2,2,0,0]=(-0.655435581477)/(o+1.)+(-0.30937321359)+(-0.203653128753)*0.5**o
        ref[2,2,0,1]=(0.140960526316)/(o+1.)+(-0.549930873491)+(0.971807071325)*0.5**o
        ref[2,2,1,0]=(-0.87272068545)/(o+1.)+(-0.159011679037)+(0.36337495614)*0.5**o
        ref[2,2,1,1]=(0.849847759033)/(o+1.)+(-0.132594990815)+(0.703205712066)*0.5**o
        ref[2,2,2,0]=(0.730674735708)/(o+1.)+(-0.144589857416)+(0.814179476293)*0.5**o
        ref[2,2,2,1]=(0.927807005045)/(o+1.)+(0.239143859117)+(0.465577907694)*0.5**o
        ref[2,3,0,0]=(0.737902566912)/(o+1.)+(-0.00945192595853)+(-0.0809501575869)*0.5**o
        ref[2,3,0,1]=(0.688538873306)/(o+1.)+(0.26402367848)+(-0.974260986562)*0.5**o
        ref[2,3,1,0]=(-0.892476705335)/(o+1.)+(0.20490133767)+(0.256567297589)*0.5**o
        ref[2,3,1,1]=(0.724531635238)/(o+1.)+(-0.524187316843)+(0.600281177478)*0.5**o
        ref[2,3,2,0]=(-0.636613154487)/(o+1.)+(0.300668452336)+(-0.316555549763)*0.5**o
        ref[2,3,2,1]=(0.241657689068)/(o+1.)+(-0.217836591241)+(0.509096161125)*0.5**o
        ref[2,4,0,0]=(-0.531592666371)/(o+1.)+(-0.288830707874)+(-0.00190589099569)*0.5**o
        ref[2,4,0,1]=(-0.32109862114)/(o+1.)+(-0.512155326408)+(0.727384767513)*0.5**o
        ref[2,4,1,0]=(0.815200064372)/(o+1.)+(-0.107542955049)+(-0.190511998024)*0.5**o
        ref[2,4,1,1]=(0.323832915733)/(o+1.)+(-0.223614062444)+(0.505564114308)*0.5**o
        ref[2,4,2,0]=(-0.378591546965)/(o+1.)+(0.0569076132008)+(-0.199017289187)*0.5**o
        ref[2,4,2,1]=(0.0866258209859)/(o+1.)+(0.181300307486)+(-0.166203292304)*0.5**o
        ref[3,0,0,0]=(0.42099538494)/(o+1.)+(0.50543930668)+(0.264566793834)*0.5**o
        ref[3,0,0,1]=(-0.566125315231)/(o+1.)+(-0.434053458415)+(0.235746402593)*0.5**o
        ref[3,0,1,0]=(-0.448144780994)/(o+1.)+(-0.316941332636)+(0.862345276865)*0.5**o
        ref[3,0,1,1]=(-0.652497974262)/(o+1.)+(0.267868866775)+(-0.896403179984)*0.5**o
        ref[3,0,2,0]=(-0.455838556745)/(o+1.)+(0.599971979095)+(0.788731583728)*0.5**o
        ref[3,0,2,1]=(0.158791540215)/(o+1.)+(0.510166773251)+(-0.727929054337)*0.5**o
        ref[3,1,0,0]=(-0.0535819231755)/(o+1.)+(-0.166034120633)+(0.349297794591)*0.5**o
        ref[3,1,0,1]=(-0.800973035912)/(o+1.)+(0.220227586048)+(-0.759321371341)*0.5**o
        ref[3,1,1,0]=(0.521881881398)/(o+1.)+(-0.025607129583)+(-0.597928946862)*0.5**o
        ref[3,1,1,1]=(0.445221632359)/(o+1.)+(-0.790614976052)+(-0.263124019379)*0.5**o
        ref[3,1,2,0]=(0.812893197377)/(o+1.)+(-0.550408879848)+(0.434074902924)*0.5**o
        ref[3,1,2,1]=(-0.40676151673)/(o+1.)+(0.21816811252)+(-0.724153308139)*0.5**o
        ref[3,2,0,0]=(-0.88668061529)/(o+1.)+(-0.196434028591)+(0.915215698154)*0.5**o
        ref[3,2,0,1]=(0.453597269106)/(o+1.)+(-0.753778677381)+(-0.456607413762)*0.5**o
        ref[3,2,1,0]=(0.0771381998527)/(o+1.)+(-0.189535168005)+(-0.428848816409)*0.5**o
        ref[3,2,1,1]=(0.786396903927)/(o+1.)+(0.26944712654)+(-0.488115399257)*0.5**o
        ref[3,2,2,0]=(-0.104450005208)/(o+1.)+(-0.480358405144)+(-0.748108272191)*0.5**o
        ref[3,2,2,1]=(-0.107194826319)/(o+1.)+(-0.656924554632)+(-0.288896584199)*0.5**o
        ref[3,3,0,0]=(0.184456668026)/(o+1.)+(0.3262637287)+(-0.643859183999)*0.5**o
        ref[3,3,0,1]=(-0.653836797208)/(o+1.)+(-0.0180862771476)+(-0.258292072759)*0.5**o
        ref[3,3,1,0]=(0.684973413357)/(o+1.)+(0.163588306602)+(-0.659219139805)*0.5**o
        ref[3,3,1,1]=(0.967988326693)/(o+1.)+(0.446278055504)+(-0.649682331365)*0.5**o
        ref[3,3,2,0]=(0.911862994231)/(o+1.)+(-0.14504591934)+(-0.0299199232233)*0.5**o
        ref[3,3,2,1]=(0.121310526207)/(o+1.)+(-0.532981603636)+(0.197795840564)*0.5**o
        ref[3,4,0,0]=(0.144475855023)/(o+1.)+(-0.356456284353)+(0.278568700563)*0.5**o
        ref[3,4,0,1]=(-0.846906570194)/(o+1.)+(0.598840084536)+(-0.608132003655)*0.5**o
        ref[3,4,1,0]=(-0.599983340725)/(o+1.)+(0.338470852121)+(-0.490163043631)*0.5**o
        ref[3,4,1,1]=(-0.466727935821)/(o+1.)+(-0.31358066885)+(-0.802228749858)*0.5**o
        ref[3,4,2,0]=(-0.0529537502248)/(o+1.)+(0.556985122302)+(0.963914397515)*0.5**o
        ref[3,4,2,1]=(0.942559524116)/(o+1.)+(0.029827380831)+(-0.201051432425)*0.5**o
      else:
        s[0,0,0,0]=(-0.345724047005)*x[0]**o+(-0.625686769843)*x[0]+(0.783605206054)*x[1]**o+(0.333976064143)*x[1]+(-0.567769956785)*x[2]**o+(-0.275228142751)*x[2]
        s[0,0,0,1]=(0.867013285813)*x[0]**o+(-0.0918669275484)*x[0]+(-0.162282139173)*x[1]**o+(-0.263245701183)*x[1]+(-0.358346293782)*x[2]**o+(0.170233601974)*x[2]
        s[0,0,1,0]=(-0.450333878814)*x[0]**o+(0.122384873389)*x[0]+(0.590676593091)*x[1]**o+(-0.373630926322)*x[1]+(-0.566894605215)*x[2]**o+(0.172738889453)*x[2]
        s[0,0,1,1]=(0.056183164677)*x[0]**o+(0.30593250486)*x[0]+(0.460330185746)*x[1]**o+(0.0649603857353)*x[1]+(0.530774242761)*x[2]**o+(-0.854200502062)*x[2]
        s[0,0,2,0]=(0.49271509708)*x[0]**o+(-0.822365387684)*x[0]+(0.150952101807)*x[1]**o+(-0.833532543948)*x[1]+(0.223699495078)*x[2]**o+(0.407256610259)*x[2]
        s[0,0,2,1]=(0.827558639052)*x[0]**o+(-0.310957726073)*x[0]+(-0.675858834923)*x[1]**o+(0.902788148659)*x[1]+(-0.569665674677)*x[2]**o+(0.971281178693)*x[2]
        s[0,1,0,0]=(-0.272375589027)*x[0]**o+(-0.285740311002)*x[0]+(0.181997544124)*x[1]**o+(-0.658402113041)*x[1]+(-0.278568799963)*x[2]**o+(-0.41754973361)*x[2]
        s[0,1,0,1]=(0.156364531059)*x[0]**o+(0.813560862368)*x[0]+(0.705700363405)*x[1]**o+(-0.817696115885)*x[1]+(-0.205894570429)*x[2]**o+(0.0674942609577)*x[2]
        s[0,1,1,0]=(0.429893143403)*x[0]**o+(-0.965234368002)*x[0]+(-0.974790265682)*x[1]**o+(0.0680256806875)*x[1]+(-0.433563362185)*x[2]**o+(-0.0492745942903)*x[2]
        s[0,1,1,1]=(-0.298098272504)*x[0]**o+(0.869998704901)*x[0]+(-0.18901211086)*x[1]**o+(-0.51577699091)*x[1]+(-0.328314462204)*x[2]**o+(-0.890845857013)*x[2]
        s[0,1,2,0]=(-0.43467847673)*x[0]**o+(-0.147481947495)*x[0]+(-0.542466755031)*x[1]**o+(-0.495418577682)*x[1]+(-0.2950922494)*x[2]**o+(-0.937573117558)*x[2]
        s[0,1,2,1]=(0.58285783575)*x[0]**o+(-0.902747768997)*x[0]+(-0.639055427646)*x[1]**o+(0.964665499733)*x[1]+(0.797615111504)*x[2]**o+(0.751347091591)*x[2]
        s[0,2,0,0]=(-0.53571726132)*x[0]**o+(-0.26462757313)*x[0]+(-0.456233906167)*x[1]**o+(0.881775957626)*x[1]+(-0.00514091075029)*x[2]**o+(-0.933937418957)*x[2]
        s[0,2,0,1]=(0.651527417402)*x[0]**o+(0.236630784815)*x[0]+(0.932958220915)*x[1]**o+(-0.819866395436)*x[1]+(0.253538518366)*x[2]**o+(-0.0163262782643)*x[2]
        s[0,2,1,0]=(0.452240733592)*x[0]**o+(0.450162809474)*x[0]+(0.699968406858)*x[1]**o+(0.164739887321)*x[1]+(-0.834564901207)*x[2]**o+(0.0249125503308)*x[2]
        s[0,2,1,1]=(-0.227907378794)*x[0]**o+(0.887204637473)*x[0]+(-0.514717641924)*x[1]**o+(0.911423718912)*x[1]+(0.876658247977)*x[2]**o+(-0.371520030414)*x[2]
        s[0,2,2,0]=(0.619773382249)*x[0]**o+(0.541760616441)*x[0]+(0.788185482567)*x[1]**o+(0.0250030620125)*x[1]+(0.163917412766)*x[2]**o+(0.191995043846)*x[2]
        s[0,2,2,1]=(-0.690898841846)*x[0]**o+(-0.708275716521)*x[0]+(-0.164538994288)*x[1]**o+(-0.803752886405)*x[1]+(-0.814464457618)*x[2]**o+(-0.910750603852)*x[2]
        s[0,3,0,0]=(0.752428867688)*x[0]**o+(0.911742295221)*x[0]+(-0.223242212004)*x[1]**o+(-0.757553597062)*x[1]+(-0.473559676565)*x[2]**o+(-0.827199094093)*x[2]
        s[0,3,0,1]=(0.300816669101)*x[0]**o+(-0.199692557045)*x[0]+(0.0825396055332)*x[1]**o+(-0.0693834001394)*x[1]+(-0.382683371052)*x[2]**o+(-0.0699997449306)*x[2]
        s[0,3,1,0]=(-0.370042079378)*x[0]**o+(-0.884622307688)*x[0]+(0.264943777413)*x[1]**o+(0.404099727226)*x[1]+(0.374755570635)*x[2]**o+(0.588241231168)*x[2]
        s[0,3,1,1]=(0.289583633117)*x[0]**o+(0.449941678672)*x[0]+(-0.353365382802)*x[1]**o+(0.515120940717)*x[1]+(0.740445432416)*x[2]**o+(-0.879930463576)*x[2]
        s[0,3,2,0]=(-0.347713282112)*x[0]**o+(-0.162259810338)*x[0]+(-0.696042768288)*x[1]**o+(-0.162202814362)*x[1]+(0.716572044832)*x[2]**o+(0.50377518734)*x[2]
        s[0,3,2,1]=(0.292567121826)*x[0]**o+(-0.76570190516)*x[0]+(0.0867231138296)*x[1]**o+(0.306479775529)*x[1]+(-0.377616255939)*x[2]**o+(0.232957710694)*x[2]
        s[0,4,0,0]=(0.73220485775)*x[0]**o+(-0.159793133992)*x[0]+(-0.377832723802)*x[1]**o+(-0.756658738359)*x[1]+(0.96057353991)*x[2]**o+(0.411157040033)*x[2]
        s[0,4,0,1]=(-0.331390253762)*x[0]**o+(-0.560289084334)*x[0]+(-0.827417830024)*x[1]**o+(0.719380560747)*x[1]+(-0.822147291472)*x[2]**o+(0.860119669443)*x[2]
        s[0,4,1,0]=(-0.505838817009)*x[0]**o+(-0.879628389565)*x[0]+(0.488746892572)*x[1]**o+(0.613837247188)*x[1]+(-0.154303229874)*x[2]**o+(0.00570279899539)*x[2]
        s[0,4,1,1]=(-0.122955617948)*x[0]**o+(-0.953071253159)*x[0]+(0.844003480214)*x[1]**o+(-0.746851086453)*x[1]+(-0.108832545758)*x[2]**o+(0.434183611414)*x[2]
        s[0,4,2,0]=(0.789617751574)*x[0]**o+(0.760644604676)*x[0]+(0.909793043646)*x[1]**o+(-0.279682873326)*x[1]+(0.700690761413)*x[2]**o+(-0.760237637314)*x[2]
        s[0,4,2,1]=(-0.882408865196)*x[0]**o+(0.328073069067)*x[0]+(0.858835691096)*x[1]**o+(0.650470359577)*x[1]+(-0.8717493079)*x[2]**o+(-0.177563387753)*x[2]
        s[1,0,0,0]=(-0.0500679538311)*x[0]**o+(-0.137932236517)*x[0]+(-0.742651074891)*x[1]**o+(-0.427978749091)*x[1]+(0.0361372113862)*x[2]**o+(-0.558139606192)*x[2]
        s[1,0,0,1]=(-0.00386321275167)*x[0]**o+(-0.51227499671)*x[0]+(-0.295080251306)*x[1]**o+(-0.326209704618)*x[1]+(-0.705968952206)*x[2]**o+(-0.848585657427)*x[2]
        s[1,0,1,0]=(0.173864935883)*x[0]**o+(0.148289460355)*x[0]+(0.40615421494)*x[1]**o+(-0.715315862741)*x[1]+(0.455318023779)*x[2]**o+(-0.539497210174)*x[2]
        s[1,0,1,1]=(-0.0628270158133)*x[0]**o+(-0.659218788396)*x[0]+(-0.0956661811574)*x[1]**o+(0.980329463956)*x[1]+(0.0114144009766)*x[2]**o+(-0.827594275845)*x[2]
        s[1,0,2,0]=(0.696208347195)*x[0]**o+(0.0807576571591)*x[0]+(0.998089746929)*x[1]**o+(0.177352400068)*x[1]+(0.685074203515)*x[2]**o+(-0.0635353733634)*x[2]
        s[1,0,2,1]=(-0.0223157590993)*x[0]**o+(0.559991238653)*x[0]+(0.548345826656)*x[1]**o+(-0.741886839548)*x[1]+(0.114218185947)*x[2]**o+(0.825638317499)*x[2]
        s[1,1,0,0]=(0.163206474973)*x[0]**o+(0.254896515732)*x[0]+(0.447114620799)*x[1]**o+(-0.563952237815)*x[1]+(0.57961770388)*x[2]**o+(0.0819856064889)*x[2]
        s[1,1,0,1]=(-0.328504704157)*x[0]**o+(0.0868460228579)*x[0]+(0.816944360875)*x[1]**o+(-0.697748850943)*x[1]+(-0.809725796641)*x[2]**o+(0.932721918575)*x[2]
        s[1,1,1,0]=(-0.287904638148)*x[0]**o+(-0.013943513773)*x[0]+(-0.54196693436)*x[1]**o+(-0.388084049637)*x[1]+(-0.702953342435)*x[2]**o+(-0.830664911774)*x[2]
        s[1,1,1,1]=(0.684091346652)*x[0]**o+(0.806375097652)*x[0]+(0.476003712147)*x[1]**o+(-0.864998508113)*x[1]+(-0.497254896777)*x[2]**o+(0.781872111446)*x[2]
        s[1,1,2,0]=(-0.844264089035)*x[0]**o+(-0.679014107829)*x[0]+(-0.198479658612)*x[1]**o+(0.375191314697)*x[1]+(-0.575465869392)*x[2]**o+(0.530364062529)*x[2]
        s[1,1,2,1]=(0.676323957189)*x[0]**o+(-0.501144179827)*x[0]+(-0.962137734649)*x[1]**o+(-0.356432667657)*x[1]+(-0.940336010235)*x[2]**o+(-0.236428299429)*x[2]
        s[1,2,0,0]=(0.355428925779)*x[0]**o+(0.274208957908)*x[0]+(-0.932593631234)*x[1]**o+(-0.376131921686)*x[1]+(0.286983572479)*x[2]**o+(-0.330880385128)*x[2]
        s[1,2,0,1]=(0.266570372333)*x[0]**o+(0.921388865301)*x[0]+(-0.1720476903)*x[1]**o+(0.998284527237)*x[1]+(0.0238473892294)*x[2]**o+(0.854216047199)*x[2]
        s[1,2,1,0]=(0.441558473549)*x[0]**o+(0.373044064317)*x[0]+(0.649370981178)*x[1]**o+(0.510194580982)*x[1]+(0.371823975996)*x[2]**o+(0.665301207824)*x[2]
        s[1,2,1,1]=(0.754004050836)*x[0]**o+(0.50557389845)*x[0]+(-0.251967535648)*x[1]**o+(0.704262653029)*x[1]+(0.645159509055)*x[2]**o+(0.183884331443)*x[2]
        s[1,2,2,0]=(-0.0673953798558)*x[0]**o+(0.708470323283)*x[0]+(-0.817934961085)*x[1]**o+(0.270394037097)*x[1]+(0.761348716495)*x[2]**o+(0.265483378874)*x[2]
        s[1,2,2,1]=(0.569853744398)*x[0]**o+(0.612861422857)*x[0]+(0.655472955979)*x[1]**o+(-0.387384090661)*x[1]+(0.026712723359)*x[2]**o+(0.504626498333)*x[2]
        s[1,3,0,0]=(-0.706312246902)*x[0]**o+(-0.309993808911)*x[0]+(0.25462597295)*x[1]**o+(-0.709061516294)*x[1]+(0.886706821135)*x[2]**o+(0.946960487449)*x[2]
        s[1,3,0,1]=(0.315339476547)*x[0]**o+(0.706694261286)*x[0]+(0.536483540093)*x[1]**o+(0.420431748645)*x[1]+(-0.401936712588)*x[2]**o+(-0.0303951289428)*x[2]
        s[1,3,1,0]=(-0.830759344331)*x[0]**o+(-0.0138001332539)*x[0]+(0.684117354857)*x[1]**o+(-0.521483470147)*x[1]+(0.261449467808)*x[2]**o+(0.81578910141)*x[2]
        s[1,3,1,1]=(0.218558430087)*x[0]**o+(0.117511078171)*x[0]+(-0.367757102068)*x[1]**o+(-0.301875631785)*x[1]+(-0.933013656177)*x[2]**o+(0.517230809269)*x[2]
        s[1,3,2,0]=(-0.273720099467)*x[0]**o+(-0.00869721580633)*x[0]+(-0.796835310998)*x[1]**o+(0.587901955041)*x[1]+(-0.664296869655)*x[2]**o+(-0.896980337429)*x[2]
        s[1,3,2,1]=(-0.068913139717)*x[0]**o+(0.656400342524)*x[0]+(0.855587799259)*x[1]**o+(0.876438035564)*x[1]+(-0.0622439736181)*x[2]**o+(-0.0977398744709)*x[2]
        s[1,4,0,0]=(0.427481073197)*x[0]**o+(0.20467745629)*x[0]+(-0.125277072461)*x[1]**o+(0.274783610604)*x[1]+(-0.384842532213)*x[2]**o+(0.790482142388)*x[2]
        s[1,4,0,1]=(0.723515401941)*x[0]**o+(-0.0529425602105)*x[0]+(-0.818443886494)*x[1]**o+(0.786875708369)*x[1]+(-0.747927140569)*x[2]**o+(-0.731906020242)*x[2]
        s[1,4,1,0]=(0.9774352561)*x[0]**o+(0.0769002693408)*x[0]+(-0.576964776525)*x[1]**o+(-0.313768570439)*x[1]+(-0.896910128278)*x[2]**o+(-0.280920538425)*x[2]
        s[1,4,1,1]=(0.138312702528)*x[0]**o+(-0.458814456032)*x[0]+(0.163241743373)*x[1]**o+(-0.803420897174)*x[1]+(-0.140886706823)*x[2]**o+(-0.14390608176)*x[2]
        s[1,4,2,0]=(0.529048827233)*x[0]**o+(-0.0554100800212)*x[0]+(0.456015489421)*x[1]**o+(0.422262108301)*x[1]+(-0.313743004281)*x[2]**o+(-0.13975864585)*x[2]
        s[1,4,2,1]=(0.838760174947)*x[0]**o+(-0.223195641306)*x[0]+(0.191058937589)*x[1]**o+(-0.0383799908705)*x[1]+(-0.123273771781)*x[2]**o+(0.375902823133)*x[2]
        s[2,0,0,0]=(-0.376325501997)*x[0]**o+(-0.999695820134)*x[0]+(0.145774433039)*x[1]**o+(0.0848795062374)*x[1]+(-0.789276953104)*x[2]**o+(-0.936604606234)*x[2]
        s[2,0,0,1]=(-0.393633363986)*x[0]**o+(0.122599807309)*x[0]+(-0.308578856774)*x[1]**o+(-0.123177461702)*x[1]+(-0.135481435454)*x[2]**o+(0.583777567706)*x[2]
        s[2,0,1,0]=(-0.573207876072)*x[0]**o+(-0.194869976915)*x[0]+(0.611265046543)*x[1]**o+(0.218225055561)*x[1]+(-0.88953645988)*x[2]**o+(0.314028438499)*x[2]
        s[2,0,1,1]=(0.82764053208)*x[0]**o+(0.408293655023)*x[0]+(-0.158898571521)*x[1]**o+(0.557257506806)*x[1]+(0.22438907333)*x[2]**o+(-0.616052713022)*x[2]
        s[2,0,2,0]=(0.680002851599)*x[0]**o+(-0.833669903036)*x[0]+(0.0182560742948)*x[1]**o+(-0.401224011261)*x[1]+(-0.601050104604)*x[2]**o+(0.354512589668)*x[2]
        s[2,0,2,1]=(-0.99533923296)*x[0]**o+(-0.252792558615)*x[0]+(-0.417436606414)*x[1]**o+(-0.905526797068)*x[1]+(-0.323384139739)*x[2]**o+(0.217030918198)*x[2]
        s[2,1,0,0]=(-0.757427161409)*x[0]**o+(-0.0463730910958)*x[0]+(0.44512589496)*x[1]**o+(0.545180882409)*x[1]+(0.78683574265)*x[2]**o+(-0.684406722817)*x[2]
        s[2,1,0,1]=(-0.61819592214)*x[0]**o+(-0.797609085554)*x[0]+(0.983105716733)*x[1]**o+(0.322191127831)*x[1]+(0.453981669947)*x[2]**o+(-0.909192167062)*x[2]
        s[2,1,1,0]=(-0.898119938157)*x[0]**o+(0.311855250372)*x[0]+(0.505532351296)*x[1]**o+(0.139215174265)*x[1]+(0.772001036932)*x[2]**o+(-0.225670248604)*x[2]
        s[2,1,1,1]=(0.0316457581752)*x[0]**o+(-0.488943159802)*x[0]+(-0.773453487185)*x[1]**o+(0.815697082082)*x[1]+(0.206189975058)*x[2]**o+(-0.575428943874)*x[2]
        s[2,1,2,0]=(0.319688798055)*x[0]**o+(-0.0695712382178)*x[0]+(0.689876574974)*x[1]**o+(0.190028248325)*x[1]+(-0.766718072759)*x[2]**o+(-0.52180809158)*x[2]
        s[2,1,2,1]=(-0.865578912594)*x[0]**o+(0.460194992238)*x[0]+(-0.0025880450282)*x[1]**o+(-0.400524494504)*x[1]+(0.417535391073)*x[2]**o+(-0.0342670929868)*x[2]
        s[2,2,0,0]=(0.421599950602)*x[0]**o+(0.266747809147)*x[0]+(-0.169043748241)*x[1]**o+(-0.164542032135)*x[1]+(0.555070565368)*x[2]**o+(-0.0217786140345)*x[2]
        s[2,2,0,1]=(-0.625527951515)*x[0]**o+(-0.998518258266)*x[0]+(-0.0978678841265)*x[1]**o+(0.00726403245479)*x[1]+(-0.210296926513)*x[2]**o+(0.0169357807292)*x[2]
        s[2,2,1,0]=(-0.927097383803)*x[0]**o+(0.142344498674)*x[0]+(-0.565097374968)*x[1]**o+(-0.19883325806)*x[1]+(-0.409577428899)*x[2]**o+(-0.433045796687)*x[2]
        s[2,2,1,1]=(0.0900116992509)*x[0]**o+(0.907232745809)*x[0]+(0.164351943946)*x[1]**o+(0.831012029454)*x[1]+(0.659298356625)*x[2]**o+(0.658166177134)*x[2]
        s[2,2,2,0]=(-0.468765776872)*x[0]**o+(-0.56578531156)*x[0]+(-0.515309324035)*x[1]**o+(-0.891192406798)*x[1]+(-0.229751474081)*x[2]**o+(0.861043357121)*x[2]
        s[2,2,2,1]=(-0.102463609474)*x[0]**o+(0.795582169816)*x[0]+(0.473799689371)*x[1]**o+(-0.624789163959)*x[1]+(-0.120758299241)*x[2]**o+(-0.790110725507)*x[2]
        s[2,3,0,0]=(-0.61205272187)*x[0]**o+(-0.40060893961)*x[0]+(-0.789664972057)*x[1]**o+(0.515295029759)*x[1]+(-0.0475219131724)*x[2]**o+(-0.148006363455)*x[2]
        s[2,3,0,1]=(-0.866234572657)*x[0]**o+(-0.980788916374)*x[0]+(0.110830262867)*x[1]**o+(0.76938462126)*x[1]+(0.338028197458)*x[2]**o+(0.695510468586)*x[2]
        s[2,3,1,0]=(-0.61195493774)*x[0]**o+(0.418983087999)*x[0]+(0.698112113863)*x[1]**o+(-0.961155169263)*x[1]+(-0.237690733199)*x[2]**o+(0.160246107308)*x[2]
        s[2,3,1,1]=(0.186790790362)*x[0]**o+(0.726925157226)*x[0]+(-0.876208560721)*x[1]**o+(0.684333403771)*x[1]+(0.859789784415)*x[2]**o+(0.180765658997)*x[2]
        s[2,3,2,0]=(-0.107447528726)*x[0]**o+(0.23776834378)*x[0]+(0.203151310439)*x[1]**o+(0.939282834891)*x[1]+(-0.739341306594)*x[2]**o+(0.526784359658)*x[2]
        s[2,3,2,1]=(-0.659583948903)*x[0]**o+(-0.876524913083)*x[0]+(-0.140502393442)*x[1]**o+(0.220988067839)*x[1]+(-0.315594035706)*x[2]**o+(-0.337007362379)*x[2]
        s[2,4,0,0]=(0.824520364974)*x[0]**o+(-0.0700628701349)*x[0]+(-0.337899096069)*x[1]**o+(-0.969230762171)*x[1]+(0.451483693063)*x[2]**o+(0.560376952474)*x[2]
        s[2,4,0,1]=(0.19676925667)*x[0]**o+(-0.509702667102)*x[0]+(-0.560085912439)*x[1]**o+(0.850131177282)*x[1]+(0.0209473113715)*x[2]**o+(-0.524835181986)*x[2]
        s[2,4,1,0]=(0.696459080737)*x[0]**o+(-0.0300420621411)*x[0]+(0.872376074883)*x[1]**o+(0.721784659413)*x[1]+(0.0469660828352)*x[2]**o+(0.848375867902)*x[2]
        s[2,4,1,1]=(-0.0300055784957)*x[0]**o+(0.86110892248)*x[0]+(-0.0372850528438)*x[1]**o+(-0.626675690839)*x[1]+(-0.96746918975)*x[2]**o+(-0.118288468609)*x[2]
        s[2,4,2,0]=(-0.773844175596)*x[0]**o+(0.97042325748)*x[0]+(-0.709105396658)*x[1]**o+(-0.436388373122)*x[1]+(-0.841519653893)*x[2]**o+(-0.661541598363)*x[2]
        s[2,4,2,1]=(-0.289904092026)*x[0]**o+(0.838224779606)*x[0]+(0.272732151891)*x[1]**o+(-0.789836453998)*x[1]+(0.574134239472)*x[2]**o+(-0.196980303288)*x[2]
        s[3,0,0,0]=(0.921207531349)*x[0]**o+(-0.944820675428)*x[0]+(-0.632934426248)*x[1]**o+(-0.986209890868)*x[1]+(0.889736953978)*x[2]**o+(0.308722225546)*x[2]
        s[3,0,0,1]=(-0.349795723275)*x[0]**o+(-0.748469735322)*x[0]+(-0.581786511254)*x[1]**o+(0.696378145052)*x[1]+(0.619384687507)*x[2]**o+(-0.0953346757601)*x[2]
        s[3,0,1,0]=(0.539616405472)*x[0]**o+(-0.265315341201)*x[0]+(0.042248150432)*x[1]**o+(-0.115847796714)*x[1]+(-0.217838196299)*x[2]**o+(-0.0631408906436)*x[2]
        s[3,0,1,1]=(-0.823978915895)*x[0]**o+(-0.608867256385)*x[0]+(0.446515851959)*x[1]**o+(0.531432611215)*x[1]+(0.689019079647)*x[2]**o+(-0.0317787775133)*x[2]
        s[3,0,2,0]=(0.347425369617)*x[0]**o+(-0.739691856701)*x[0]+(-0.398130284368)*x[1]**o+(0.108805616885)*x[1]+(-0.0912940693547)*x[2]**o+(0.117214641864)*x[2]
        s[3,0,2,1]=(-0.383805789854)*x[0]**o+(-0.0456422576844)*x[0]+(0.533382056608)*x[1]**o+(-0.218226601069)*x[1]+(-0.676716489399)*x[2]**o+(-0.00199666729435)*x[2]
        s[3,1,0,0]=(-0.372478384483)*x[0]**o+(0.586299542288)*x[0]+(-0.454391251107)*x[1]**o+(0.0882830261313)*x[1]+(-0.623432789013)*x[2]**o+(0.218598634148)*x[2]
        s[3,1,0,1]=(0.578294223191)*x[0]**o+(-0.355620351739)*x[0]+(0.231898319431)*x[1]**o+(0.423862975521)*x[1]+(0.646375025433)*x[2]**o+(-0.213634599835)*x[2]
        s[3,1,1,0]=(0.0525838616186)*x[0]**o+(0.118311802828)*x[0]+(0.548544020336)*x[1]**o+(0.584362580997)*x[1]+(-0.234381266126)*x[2]**o+(-0.845553660597)*x[2]
        s[3,1,1,1]=(-0.677671170669)*x[0]**o+(-0.290465667864)*x[0]+(-0.0167835285288)*x[1]**o+(-0.100024088985)*x[1]+(-0.150243328686)*x[2]**o+(0.679119492133)*x[2]
        s[3,1,2,0]=(-0.121237844262)*x[0]**o+(-0.458196712924)*x[0]+(0.963853129183)*x[1]**o+(-0.211094701554)*x[1]+(0.868445433817)*x[2]**o+(0.902283926176)*x[2]
        s[3,1,2,1]=(0.504161603066)*x[0]**o+(-0.190472686354)*x[0]+(-0.0917827193891)*x[1]**o+(-0.352839230228)*x[1]+(-0.353813861163)*x[2]**o+(0.230960874753)*x[2]
        s[3,2,0,0]=(-0.34790984999)*x[0]**o+(-0.395507825603)*x[0]+(-0.6489230899)*x[1]**o+(0.712401749209)*x[1]+(-0.0821476018477)*x[2]**o+(0.690431614802)*x[2]
        s[3,2,0,1]=(-0.557444127335)*x[0]**o+(-0.834050224977)*x[0]+(-0.22666297073)*x[1]**o+(0.405731464147)*x[1]+(-0.671211465442)*x[2]**o+(-0.644382670803)*x[2]
        s[3,2,1,0]=(0.965420676359)*x[0]**o+(-0.228764004519)*x[0]+(-0.859916958223)*x[1]**o+(-0.452756903956)*x[1]+(-0.973849033231)*x[2]**o+(-0.24133735483)*x[2]
        s[3,2,1,1]=(-0.950755375408)*x[0]**o+(-0.851938171221)*x[0]+(0.0181318395336)*x[1]**o+(-0.499474780924)*x[1]+(0.910360613628)*x[2]**o+(0.199314643801)*x[2]
        s[3,2,2,0]=(0.339657614739)*x[0]**o+(0.145101826319)*x[0]+(0.0477774162796)*x[1]**o+(-0.883319372262)*x[1]+(0.297676781475)*x[2]**o+(0.375455002664)*x[2]
        s[3,2,2,1]=(0.427508981997)*x[0]**o+(0.735804891833)*x[0]+(-0.941349025764)*x[1]**o+(-0.848431716981)*x[1]+(0.878538549993)*x[2]**o+(0.0726603284636)*x[2]
        s[3,3,0,0]=(-0.973352015556)*x[0]**o+(0.836731359075)*x[0]+(0.665815761101)*x[1]**o+(0.255531920855)*x[1]+(0.782674767576)*x[2]**o+(-0.570574483199)*x[2]
        s[3,3,0,1]=(0.950365830796)*x[0]**o+(0.421946061345)*x[0]+(0.905170182227)*x[1]**o+(0.613401792858)*x[1]+(-0.442076185783)*x[2]**o+(-0.484925057701)*x[2]
        s[3,3,1,0]=(-0.00222827033475)*x[0]**o+(-0.531682094474)*x[0]+(0.458841364479)*x[1]**o+(-0.655184028959)*x[1]+(-0.22086141276)*x[2]**o+(-0.813839980108)*x[2]
        s[3,3,1,1]=(0.887884370757)*x[0]**o+(-0.0538573388546)*x[0]+(0.927878694132)*x[1]**o+(0.471741834858)*x[1]+(-0.313646320846)*x[2]**o+(0.311547715614)*x[2]
        s[3,3,2,0]=(-0.0214623472154)*x[0]**o+(-0.444460344328)*x[0]+(0.0788294611308)*x[1]**o+(0.41576519959)*x[1]+(-0.778008962903)*x[2]**o+(0.900765472759)*x[2]
        s[3,3,2,1]=(0.949491478772)*x[0]**o+(-0.471010680081)*x[0]+(-0.876305371565)*x[1]**o+(-0.120079570893)*x[1]+(0.0947323737758)*x[2]**o+(-0.361392549886)*x[2]
        s[3,4,0,0]=(0.354489762998)*x[0]**o+(-0.425422633745)*x[0]+(-0.566692257139)*x[1]**o+(0.504748998989)*x[1]+(0.226102951066)*x[2]**o+(-0.744917446958)*x[2]
        s[3,4,0,1]=(0.552196121696)*x[0]**o+(0.533127640573)*x[0]+(-0.147082768815)*x[1]**o+(-0.801997447891)*x[1]+(0.104711977816)*x[2]**o+(0.99454944575)*x[2]
        s[3,4,1,0]=(0.839982844034)*x[0]**o+(-0.779008776044)*x[0]+(-0.561078679707)*x[1]**o+(-0.0519865292547)*x[1]+(-0.566301067503)*x[2]**o+(-0.267957119508)*x[2]
        s[3,4,1,1]=(0.78962834926)*x[0]**o+(-0.93892858306)*x[0]+(-0.114227870549)*x[1]**o+(0.420485886976)*x[1]+(0.974178392694)*x[2]**o+(-0.421944523239)*x[2]
        s[3,4,2,0]=(-0.882936934355)*x[0]**o+(-0.441556030186)*x[0]+(0.0681795049997)*x[1]**o+(0.731317357905)*x[1]+(-0.965801964833)*x[2]**o+(-0.319270469244)*x[2]
        s[3,4,2,1]=(0.342579062975)*x[0]**o+(0.23386981431)*x[0]+(-0.571662448793)*x[1]**o+(-0.257739898874)*x[1]+(0.176906895006)*x[2]**o+(0.892856914788)*x[2]
        ref[0,0,0,0]=(0.215835249268)/(o+1.)+(-0.283469424226)+(-0.345724047005)*0.5**o
        ref[0,0,0,1]=(-0.520628432955)/(o+1.)+(-0.0924395133784)+(0.867013285813)*0.5**o
        ref[0,0,1,0]=(0.0237819878764)/(o+1.)+(-0.0392535817398)+(-0.450333878814)*0.5**o
        ref[0,0,1,1]=(0.991104428507)/(o+1.)+(-0.241653805734)+(0.056183164677)*0.5**o
        ref[0,0,2,0]=(0.374651596885)/(o+1.)+(-0.624320660687)+(0.49271509708)*0.5**o
        ref[0,0,2,1]=(-1.2455245096)/(o+1.)+(0.781555800639)+(0.827558639052)*0.5**o
        ref[0,1,0,0]=(-0.0965712558395)/(o+1.)+(-0.680846078827)+(-0.272375589027)*0.5**o
        ref[0,1,0,1]=(0.499805792977)/(o+1.)+(0.0316795037204)+(0.156364531059)*0.5**o
        ref[0,1,1,0]=(-1.40835362787)/(o+1.)+(-0.473241640802)+(0.429893143403)*0.5**o
        ref[0,1,1,1]=(-0.517326573063)/(o+1.)+(-0.268312071511)+(-0.298098272504)*0.5**o
        ref[0,1,2,0]=(-0.837559004431)/(o+1.)+(-0.790236821368)+(-0.43467847673)*0.5**o
        ref[0,1,2,1]=(0.158559683859)/(o+1.)+(0.406632411163)+(0.58285783575)*0.5**o
        ref[0,2,0,0]=(-0.461374816917)/(o+1.)+(-0.158394517231)+(-0.53571726132)*0.5**o
        ref[0,2,0,1]=(1.18649673928)/(o+1.)+(-0.299780944442)+(0.651527417402)*0.5**o
        ref[0,2,1,0]=(-0.13459649435)/(o+1.)+(0.319907623563)+(0.452240733592)*0.5**o
        ref[0,2,1,1]=(0.361940606053)/(o+1.)+(0.713554162985)+(-0.227907378794)*0.5**o
        ref[0,2,2,0]=(0.952102895333)/(o+1.)+(0.37937936115)+(0.619773382249)*0.5**o
        ref[0,2,2,1]=(-0.979003451906)/(o+1.)+(-1.21138960339)+(-0.690898841846)*0.5**o
        ref[0,3,0,0]=(-0.696801888569)/(o+1.)+(-0.336505197967)+(0.752428867688)*0.5**o
        ref[0,3,0,1]=(-0.300143765518)/(o+1.)+(-0.169537851057)+(0.300816669101)*0.5**o
        ref[0,3,1,0]=(0.639699348048)/(o+1.)+(0.0538593253528)+(-0.370042079378)*0.5**o
        ref[0,3,1,1]=(0.387080049614)/(o+1.)+(0.0425660779061)+(0.289583633117)*0.5**o
        ref[0,3,2,0]=(0.0205292765437)/(o+1.)+(0.0896562813201)+(-0.347713282112)*0.5**o
        ref[0,3,2,1]=(-0.29089314211)/(o+1.)+(-0.113132209469)+(0.292567121826)*0.5**o
        ref[0,4,0,0]=(0.582740816108)/(o+1.)+(-0.252647416159)+(0.73220485775)*0.5**o
        ref[0,4,0,1]=(-1.6495651215)/(o+1.)+(0.509605572928)+(-0.331390253762)*0.5**o
        ref[0,4,1,0]=(0.334443662697)/(o+1.)+(-0.130044171691)+(-0.505838817009)*0.5**o
        ref[0,4,1,1]=(0.735170934456)/(o+1.)+(-0.632869364099)+(-0.122955617948)*0.5**o
        ref[0,4,2,0]=(1.61048380506)/(o+1.)+(-0.139637952982)+(0.789617751574)*0.5**o
        ref[0,4,2,1]=(-0.012913616804)/(o+1.)+(0.400490020446)+(-0.882408865196)*0.5**o
        ref[1,0,0,0]=(-0.706513863505)/(o+1.)+(-0.5620252959)+(-0.0500679538311)*0.5**o
        ref[1,0,0,1]=(-1.00104920351)/(o+1.)+(-0.843535179378)+(-0.00386321275167)*0.5**o
        ref[1,0,1,0]=(0.861472238719)/(o+1.)+(-0.55326180628)+(0.173864935883)*0.5**o
        ref[1,0,1,1]=(-0.0842517801808)/(o+1.)+(-0.253241800142)+(-0.0628270158133)*0.5**o
        ref[1,0,2,0]=(1.68316395044)/(o+1.)+(0.097287341932)+(0.696208347195)*0.5**o
        ref[1,0,2,1]=(0.662564012602)/(o+1.)+(0.321871358302)+(-0.0223157590993)*0.5**o
        ref[1,1,0,0]=(1.02673232468)/(o+1.)+(-0.113535057797)+(0.163206474973)*0.5**o
        ref[1,1,0,1]=(0.00721856423403)/(o+1.)+(0.160909545245)+(-0.328504704157)*0.5**o
        ref[1,1,1,0]=(-1.24492027679)/(o+1.)+(-0.616346237592)+(-0.287904638148)*0.5**o
        ref[1,1,1,1]=(-0.0212511846297)/(o+1.)+(0.361624350493)+(0.684091346652)*0.5**o
        ref[1,1,2,0]=(-0.773945528004)/(o+1.)+(0.113270634698)+(-0.844264089035)*0.5**o
        ref[1,1,2,1]=(-1.90247374488)/(o+1.)+(-0.547002573456)+(0.676323957189)*0.5**o
        ref[1,2,0,0]=(-0.645610058755)/(o+1.)+(-0.216401674453)+(0.355428925779)*0.5**o
        ref[1,2,0,1]=(-0.148200301071)/(o+1.)+(1.38694471987)+(0.266570372333)*0.5**o
        ref[1,2,1,0]=(1.02119495717)/(o+1.)+(0.774269926562)+(0.441558473549)*0.5**o
        ref[1,2,1,1]=(0.393191973407)/(o+1.)+(0.696860441461)+(0.754004050836)*0.5**o
        ref[1,2,2,0]=(-0.0565862445904)/(o+1.)+(0.622173869627)+(-0.0673953798558)*0.5**o
        ref[1,2,2,1]=(0.682185679338)/(o+1.)+(0.365051915264)+(0.569853744398)*0.5**o
        ref[1,3,0,0]=(1.14133279409)/(o+1.)+(-0.0360474188784)+(-0.706312246902)*0.5**o
        ref[1,3,0,1]=(0.134546827505)/(o+1.)+(0.548365440494)+(0.315339476547)*0.5**o
        ref[1,3,1,0]=(0.945566822665)/(o+1.)+(0.140252749005)+(-0.830759344331)*0.5**o
        ref[1,3,1,1]=(-1.30077075824)/(o+1.)+(0.166433127827)+(0.218558430087)*0.5**o
        ref[1,3,2,0]=(-1.46113218065)/(o+1.)+(-0.158887799097)+(-0.273720099467)*0.5**o
        ref[1,3,2,1]=(0.793343825641)/(o+1.)+(0.717549251808)+(-0.068913139717)*0.5**o
        ref[1,4,0,0]=(-0.510119604674)/(o+1.)+(0.634971604641)+(0.427481073197)*0.5**o
        ref[1,4,0,1]=(-1.56637102706)/(o+1.)+(0.00101356395823)+(0.723515401941)*0.5**o
        ref[1,4,1,0]=(-1.4738749048)/(o+1.)+(-0.258894419762)+(0.9774352561)*0.5**o
        ref[1,4,1,1]=(0.0223550365494)/(o+1.)+(-0.703070717483)+(0.138312702528)*0.5**o
        ref[1,4,2,0]=(0.14227248514)/(o+1.)+(0.113546691215)+(0.529048827233)*0.5**o
        ref[1,4,2,1]=(0.0677851658086)/(o+1.)+(0.0571635954781)+(0.838760174947)*0.5**o
        ref[2,0,0,0]=(-0.643502520065)/(o+1.)+(-0.925710460066)+(-0.376325501997)*0.5**o
        ref[2,0,0,1]=(-0.444060292228)/(o+1.)+(0.291599956656)+(-0.393633363986)*0.5**o
        ref[2,0,1,0]=(-0.278271413338)/(o+1.)+(0.168691758573)+(-0.573207876072)*0.5**o
        ref[2,0,1,1]=(0.0654905018086)/(o+1.)+(0.174749224404)+(0.82764053208)*0.5**o
        ref[2,0,2,0]=(-0.582794030309)/(o+1.)+(-0.440190662315)+(0.680002851599)*0.5**o
        ref[2,0,2,1]=(-0.740820746153)/(o+1.)+(-0.470644218743)+(-0.99533923296)*0.5**o
        ref[2,1,0,0]=(1.23196163761)/(o+1.)+(-0.0927994657521)+(-0.757427161409)*0.5**o
        ref[2,1,0,1]=(1.43708738668)/(o+1.)+(-0.692305062393)+(-0.61819592214)*0.5**o
        ref[2,1,1,0]=(1.27753338823)/(o+1.)+(0.112700088017)+(-0.898119938157)*0.5**o
        ref[2,1,1,1]=(-0.567263512127)/(o+1.)+(-0.124337510797)+(0.0316457581752)*0.5**o
        ref[2,1,2,0]=(-0.0768414977849)/(o+1.)+(-0.200675540737)+(0.319688798055)*0.5**o
        ref[2,1,2,1]=(0.414947346045)/(o+1.)+(0.0127017023739)+(-0.865578912594)*0.5**o
        ref[2,2,0,0]=(0.386026817127)/(o+1.)+(0.0402135814888)+(0.421599950602)*0.5**o
        ref[2,2,0,1]=(-0.30816481064)/(o+1.)+(-0.487159222541)+(-0.625527951515)*0.5**o
        ref[2,2,1,0]=(-0.974674803867)/(o+1.)+(-0.244767278037)+(-0.927097383803)*0.5**o
        ref[2,2,1,1]=(0.82365030057)/(o+1.)+(1.1982054762)+(0.0900116992509)*0.5**o
        ref[2,2,2,0]=(-0.745060798116)/(o+1.)+(-0.297967180618)+(-0.468765776872)*0.5**o
        ref[2,2,2,1]=(0.353041390129)/(o+1.)+(-0.309658859825)+(-0.102463609474)*0.5**o
        ref[2,3,0,0]=(-0.83718688523)/(o+1.)+(-0.0166601366533)+(-0.61205272187)*0.5**o
        ref[2,3,0,1]=(0.448858460325)/(o+1.)+(0.242053086736)+(-0.866234572657)*0.5**o
        ref[2,3,1,0]=(0.460421380665)/(o+1.)+(-0.190962986978)+(-0.61195493774)*0.5**o
        ref[2,3,1,1]=(-0.0164187763059)/(o+1.)+(0.796012109997)+(0.186790790362)*0.5**o
        ref[2,3,2,0]=(-0.536189996155)/(o+1.)+(0.851917769165)+(-0.107447528726)*0.5**o
        ref[2,3,2,1]=(-0.456096429148)/(o+1.)+(-0.496272103811)+(-0.659583948903)*0.5**o
        ref[2,4,0,0]=(0.113584596994)/(o+1.)+(-0.239458339916)+(0.824520364974)*0.5**o
        ref[2,4,0,1]=(-0.539138601067)/(o+1.)+(-0.0922033359031)+(0.19676925667)*0.5**o
        ref[2,4,1,0]=(0.919342157718)/(o+1.)+(0.770059232587)+(0.696459080737)*0.5**o
        ref[2,4,1,1]=(-1.00475424259)/(o+1.)+(0.0580723815159)+(-0.0300055784957)*0.5**o
        ref[2,4,2,0]=(-1.55062505055)/(o+1.)+(-0.0637533570027)+(-0.773844175596)*0.5**o
        ref[2,4,2,1]=(0.846866391363)/(o+1.)+(-0.0742959888403)+(-0.289904092026)*0.5**o
        ref[3,0,0,0]=(0.25680252773)/(o+1.)+(-0.811154170375)+(0.921207531349)*0.5**o
        ref[3,0,0,1]=(0.037598176253)/(o+1.)+(-0.0737131330151)+(-0.349795723275)*0.5**o
        ref[3,0,1,0]=(-0.175590045867)/(o+1.)+(-0.222152014279)+(0.539616405472)*0.5**o
        ref[3,0,1,1]=(1.13553493161)/(o+1.)+(-0.0546067113414)+(-0.823978915895)*0.5**o
        ref[3,0,2,0]=(-0.489424353723)/(o+1.)+(-0.256835798975)+(0.347425369617)*0.5**o
        ref[3,0,2,1]=(-0.143334432791)/(o+1.)+(-0.132932763024)+(-0.383805789854)*0.5**o
        ref[3,1,0,0]=(-1.07782404012)/(o+1.)+(0.446590601283)+(-0.372478384483)*0.5**o
        ref[3,1,0,1]=(0.878273344865)/(o+1.)+(-0.0726959880264)+(0.578294223191)*0.5**o
        ref[3,1,1,0]=(0.314162754211)/(o+1.)+(-0.0714396383864)+(0.0525838616186)*0.5**o
        ref[3,1,1,1]=(-0.167026857215)/(o+1.)+(0.144314867642)+(-0.677671170669)*0.5**o
        ref[3,1,2,0]=(1.832298563)/(o+1.)+(0.116496255849)+(-0.121237844262)*0.5**o
        ref[3,1,2,1]=(-0.445596580552)/(o+1.)+(-0.156175520914)+(0.504161603066)*0.5**o
        ref[3,2,0,0]=(-0.731070691747)/(o+1.)+(0.503662769204)+(-0.34790984999)*0.5**o
        ref[3,2,0,1]=(-0.897874436171)/(o+1.)+(-0.536350715816)+(-0.557444127335)*0.5**o
        ref[3,2,1,0]=(-1.83376599145)/(o+1.)+(-0.461429131652)+(0.965420676359)*0.5**o
        ref[3,2,1,1]=(0.928492453162)/(o+1.)+(-0.576049154172)+(-0.950755375408)*0.5**o
        ref[3,2,2,0]=(0.345454197754)/(o+1.)+(-0.181381271639)+(0.339657614739)*0.5**o
        ref[3,2,2,1]=(-0.0628104757709)/(o+1.)+(-0.0199832483422)+(0.427508981997)*0.5**o
        ref[3,3,0,0]=(1.44849052868)/(o+1.)+(0.260844398365)+(-0.973352015556)*0.5**o
        ref[3,3,0,1]=(0.463093996444)/(o+1.)+(0.275211398251)+(0.950365830796)*0.5**o
        ref[3,3,1,0]=(0.237979951719)/(o+1.)+(-1.00035305177)+(-0.00222827033475)*0.5**o
        ref[3,3,1,1]=(0.614232373286)/(o+1.)+(0.364716105808)+(0.887884370757)*0.5**o
        ref[3,3,2,0]=(-0.699179501772)/(o+1.)+(0.436035164011)+(-0.0214623472154)*0.5**o
        ref[3,3,2,1]=(-0.781572997789)/(o+1.)+(-0.47624140043)+(0.949491478772)*0.5**o
        ref[3,4,0,0]=(-0.340589306073)/(o+1.)+(-0.332795540857)+(0.354489762998)*0.5**o
        ref[3,4,0,1]=(-0.0423707909991)/(o+1.)+(0.362839819216)+(0.552196121696)*0.5**o
        ref[3,4,1,0]=(-1.12737974721)/(o+1.)+(-0.549476212403)+(0.839982844034)*0.5**o
        ref[3,4,1,1]=(0.859950522145)/(o+1.)+(-0.470193609661)+(0.78962834926)*0.5**o
        ref[3,4,2,0]=(-0.897622459834)/(o+1.)+(-0.0147545707622)+(-0.882936934355)*0.5**o
        ref[3,4,2,1]=(-0.394755553787)/(o+1.)+(0.434493415112)+(0.342579062975)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(-0.0123111028353)*x[0]+(-1.54593060503)*x[1]
        ref=(-0.883444958139)/(o+1.)+(-0.0326056141412)+(-0.609585521441)*0.5**o
      else:
        s=(0.465974344755)*x[0]+(-0.406015068796)*x[1]+(0.217033091571)*x[2]
        ref=(-0.964783366814)/(o+1.)+(0.787210317182)+(-0.332644900019)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(-1.01806458946)*x[0]+(-0.84209500794)*x[1]
        s[1]=(-0.372739669691)*x[0]+(0.123203057686)*x[1]
        ref[0]=(-0.910310319387)/(o+1.)+(-0.35457604)+(-0.240697198017)*0.5**o
        ref[1]=(0.817182634856)/(o+1.)+(-0.752992097502)+(0.439264948143)*0.5**o
      else:
        s[0]=(-0.262859740698)*x[0]+(0.398827301114)*x[1]+(-0.0121863377176)*x[2]
        s[1]=(0.533472917947)*x[0]+(-0.654130540619)*x[1]+(-0.155059686066)*x[2]
        ref[0]=(0.173661143447)/(o+1.)+(-0.0377591573443)+(0.0256383939398)*0.5**o
        ref[1]=(-1.0263552046)/(o+1.)+(0.265270569058)+(0.220096757743)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.0355078592116)*x[0]+(-1.45322051958)*x[1]
        s[0,1]=(0.940649610535)*x[0]+(1.03783851181)*x[1]
        s[0,2]=(-0.285465603086)*x[0]+(-1.0279436539)*x[1]
        s[0,3]=(-1.05683604808)*x[0]+(-0.606790848933)*x[1]
        s[0,4]=(0.155725423448)*x[0]+(-0.0350991646899)*x[1]
        s[1,0]=(0.288671804193)*x[0]+(0.427933920845)*x[1]
        s[1,1]=(-0.0117065079514)*x[0]+(0.96117958225)*x[1]
        s[1,2]=(0.209419996754)*x[0]+(0.21574344987)*x[1]
        s[1,3]=(0.885781216051)*x[0]+(-0.68144471245)*x[1]
        s[1,4]=(-1.08228199466)*x[0]+(-0.155862749309)*x[1]
        s[2,0]=(-0.680644329614)*x[0]+(-1.38778484373)*x[1]
        s[2,1]=(0.0400929370385)*x[0]+(0.415428765055)*x[1]
        s[2,2]=(-1.20113508704)*x[0]+(-0.876683252298)*x[1]
        s[2,3]=(-0.312684596061)*x[0]+(-0.70367059229)*x[1]
        s[2,4]=(0.214059442951)*x[0]+(1.42513598809)*x[1]
        s[3,0]=(-0.24713062126)*x[0]+(1.02991464042)*x[1]
        s[3,1]=(-0.83089702409)*x[0]+(0.587925745944)*x[1]
        s[3,2]=(0.950881339072)*x[0]+(0.051413472076)*x[1]
        s[3,3]=(0.182953617513)*x[0]+(0.94052327152)*x[1]
        s[3,4]=(-0.387816734481)*x[0]+(0.366589363018)*x[1]
        ref[0,0]=(-0.563896045541)/(o+1.)+(-0.436916928584)+(0.0200172423412)*0.5**o
        ref[0,1]=(0.583712973931)/(o+1.)+(0.277276607579)+(0.84022193326)*0.5**o
        ref[0,2]=(-0.381794683559)/(o+1.)+(-0.29471407057)+(-0.342186432287)*0.5**o
        ref[0,3]=(0.0937197621552)/(o+1.)+(-0.417759182193)+(-0.921828294785)*0.5**o
        ref[0,4]=(-0.00732587396541)/(o+1.)+(0.282507495385)+(-0.437062858047)*0.5**o
        ref[1,0]=(0.656328782568)/(o+1.)+(0.105444180081)+(-0.150611417692)*0.5**o
        ref[1,1]=(0.0862490471738)/(o+1.)+(-0.0358008007742)+(0.934825628673)*0.5**o
        ref[1,2]=(-0.681994265679)/(o+1.)+(0.52707424273)+(0.053009226843)*0.5**o
        ref[1,3]=(0.162048053458)/(o+1.)+(-0.131185707156)+(0.304659864456)*0.5**o
        ref[1,4]=(-0.321375806412)/(o+1.)+(-0.12650756243)+(-0.663753812697)*0.5**o
        ref[2,0]=(-0.706054805711)/(o+1.)+(-0.805432593593)+(0.248490819557)*0.5**o
        ref[2,1]=(0.587809899116)/(o+1.)+(-0.0542554861756)+(-0.0237772246706)*0.5**o
        ref[2,2]=(0.044861811334)/(o+1.)+(-0.933527479587)+(-0.255625191498)*0.5**o
        ref[2,3]=(0.0752678267397)/(o+1.)+(-0.281993375709)+(-0.527636263672)*0.5**o
        ref[2,4]=(0.684054536011)/(o+1.)+(0.209350429588)+(0.536440035851)*0.5**o
        ref[3,0]=(0.827817530316)/(o+1.)+(-0.211443979463)+(0.37785444777)*0.5**o
        ref[3,1]=(-0.410871022592)/(o+1.)+(0.0530892951706)+(0.061721154105)*0.5**o
        ref[3,2]=(0.199285164042)/(o+1.)+(0.122582366509)+(0.557844914088)*0.5**o
        ref[3,3]=(0.195462635242)/(o+1.)+(0.027388051617)+(0.873238150557)*0.5**o
        ref[3,4]=(0.231128200422)/(o+1.)+(0.0245220097267)+(-0.301399591338)*0.5**o
      else:
        s[0,0]=(0.995116002112)*x[0]+(0.591812853606)*x[1]+(0.436070205257)*x[2]
        s[0,1]=(-0.118607336615)*x[0]+(0.594691767995)*x[1]+(-0.56002370897)*x[2]
        s[0,2]=(1.14520644838)*x[0]+(0.18460040375)*x[1]+(-0.960923519429)*x[2]
        s[0,3]=(0.392881958399)*x[0]+(-1.48738000894)*x[1]+(1.04349887295)*x[2]
        s[0,4]=(0.232444347548)*x[0]+(-0.83025700349)*x[1]+(0.612703936854)*x[2]
        s[1,0]=(0.190581558342)*x[0]+(-0.619707808792)*x[1]+(1.05804982356)*x[2]
        s[1,1]=(-0.42811715218)*x[0]+(-0.447035862369)*x[1]+(-1.24096539043)*x[2]
        s[1,2]=(0.200357664023)*x[0]+(-0.936410127129)*x[1]+(0.750394727948)*x[2]
        s[1,3]=(-0.612730981377)*x[0]+(-0.653699725295)*x[1]+(0.0015189792328)*x[2]
        s[1,4]=(0.288644454156)*x[0]+(0.93337277237)*x[1]+(-0.602600880867)*x[2]
        s[2,0]=(-1.17236877273)*x[0]+(1.45496830635)*x[1]+(-1.12383998094)*x[2]
        s[2,1]=(-0.232230799241)*x[0]+(0.415001155159)*x[1]+(-0.60248885989)*x[2]
        s[2,2]=(-0.83830117983)*x[0]+(0.192640431036)*x[1]+(1.43556749653)*x[2]
        s[2,3]=(0.973424823298)*x[0]+(0.369914981625)*x[1]+(-1.40643757872)*x[2]
        s[2,4]=(-0.458923994338)*x[0]+(-1.04785209961)*x[1]+(-0.592533584766)*x[2]
        s[3,0]=(0.545327477107)*x[0]+(1.9382915447)*x[1]+(1.47179032667)*x[2]
        s[3,1]=(-0.415696009498)*x[0]+(-0.594177620783)*x[1]+(-1.35108058064)*x[2]
        s[3,2]=(0.831178664645)*x[0]+(-0.0275877269769)*x[1]+(0.302241965885)*x[2]
        s[3,3]=(-0.360815522042)*x[0]+(-0.826462125533)*x[1]+(0.530840397679)*x[2]
        s[3,4]=(0.135928452703)*x[0]+(-1.51122126726)*x[1]+(1.6120424041)*x[2]
        ref[0,0]=(1.24742647646)/(o+1.)+(0.269060816234)+(0.237450952046)*0.5**o
        ref[0,1]=(1.12585957806)/(o+1.)+(-0.755828198463)+(0.301857541273)*0.5**o
        ref[0,2]=(-0.435989664675)/(o+1.)+(0.295471183049)+(0.213930631278)*0.5**o
        ref[0,3]=(-0.488921466935)/(o+1.)+(0.294480448259)+(-0.151038607178)*0.5**o
        ref[0,4]=(0.516230612817)/(o+1.)+(-0.0787984362944)+(-0.343742459316)*0.5**o
        ref[1,0]=(-0.492183705773)/(o+1.)+(0.501230271461)+(0.118646735962)*0.5**o
        ref[1,1]=(-1.43995574312)/(o+1.)+(-0.28437529362)+(-0.107412074623)*0.5**o
        ref[1,2]=(-0.101017880825)/(o+1.)+(0.28028462641)+(-0.445209107154)*0.5**o
        ref[1,3]=(0.128471434955)/(o+1.)+(-0.384371968608)+(-0.62463922518)*0.5**o
        ref[1,4]=(-0.0918241851534)/(o+1.)+(-0.0317649881343)+(0.774770507081)*0.5**o
        ref[2,0]=(0.221291051677)/(o+1.)+(-0.302519614649)+(-0.457492269704)*0.5**o
        ref[2,1]=(0.100276041699)/(o+1.)+(-0.387935114184)+(0.255875682695)*0.5**o
        ref[2,2]=(0.67334801807)/(o+1.)+(0.363637415491)+(-0.610716101317)*0.5**o
        ref[2,3]=(-0.101257531168)/(o+1.)+(-0.225887466089)+(0.48993468955)*0.5**o
        ref[2,4]=(-0.451085705642)/(o+1.)+(-0.415483032516)+(-0.817257908036)*0.5**o
        ref[3,0]=(1.87076639925)/(o+1.)+(1.20828670015)+(-0.331930451075)*0.5**o
        ref[3,1]=(-1.43689409978)/(o+1.)+(0.0171611774403)+(-0.958382466017)*0.5**o
        ref[3,2]=(0.146538702473)/(o+1.)+(0.391890493041)+(0.175513214998)*0.5**o
        ref[3,3]=(-0.122934034211)/(o+1.)+(0.140609173665)+(-0.814721563016)*0.5**o
        ref[3,4]=(0.223164895319)/(o+1.)+(-0.31244215916)+(0.638469012551)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.35078097593)*x[0]+(0.306926522015)*x[1]
        s[0,0,1]=(-0.803534689121)*x[0]+(-0.0602880575367)*x[1]
        s[0,1,0]=(-0.903470951227)*x[0]+(0.374123966765)*x[1]
        s[0,1,1]=(-1.18641387512)*x[0]+(0.273430931834)*x[1]
        s[1,0,0]=(0.493295479958)*x[0]+(1.54668330013)*x[1]
        s[1,0,1]=(-1.27848534954)*x[0]+(0.0588492485708)*x[1]
        s[1,1,0]=(-1.42953381447)*x[0]+(0.717393314307)*x[1]
        s[1,1,1]=(-0.467730806598)*x[0]+(-0.0117815181086)*x[1]
        s[2,0,0]=(-0.602626661024)*x[0]+(0.533324435346)*x[1]
        s[2,0,1]=(-0.904855697799)*x[0]+(1.09112846759)*x[1]
        s[2,1,0]=(1.20360337188)*x[0]+(1.23097020284)*x[1]
        s[2,1,1]=(0.0885447539403)*x[0]+(0.405387510263)*x[1]
        s[3,0,0]=(-0.730436778413)*x[0]+(0.416740386984)*x[1]
        s[3,0,1]=(-1.04126166563)*x[0]+(0.41753641298)*x[1]
        s[3,1,0]=(-0.271195830488)*x[0]+(-0.11575841172)*x[1]
        s[3,1,1]=(1.16100889666)*x[0]+(-0.233929048364)*x[1]
        s[4,0,0]=(0.664549807695)*x[0]+(0.224807977257)*x[1]
        s[4,0,1]=(-0.796935211563)*x[0]+(0.365917637053)*x[1]
        s[4,1,0]=(0.0401977690429)*x[0]+(-0.612500495333)*x[1]
        s[4,1,1]=(-0.115172707709)*x[0]+(-0.280626474812)*x[1]
        s[5,0,0]=(0.844835935845)*x[0]+(-1.19344222698)*x[1]
        s[5,0,1]=(-1.81553680308)*x[0]+(-1.66095998384)*x[1]
        s[5,1,0]=(0.761230206372)*x[0]+(0.547313314376)*x[1]
        s[5,1,1]=(-0.246895651321)*x[0]+(0.391870038086)*x[1]
        ref[0,0,0]=(-0.600965801098)/(o+1.)+(0.338185808482)+(-0.119260269781)*0.5**o
        ref[0,0,1]=(-0.224867141426)/(o+1.)+(-0.334457471517)+(0.0299593378011)*0.5**o
        ref[0,1,0]=(0.0129821011627)/(o+1.)+(-0.0950564992708)+(-0.352216087084)*0.5**o
        ref[0,1,1]=(0.0332057375276)/(o+1.)+(-0.0551431610872)+(-0.835902358643)*0.5**o
        ref[1,0,0]=(0.553424856182)/(o+1.)+(0.848186123918)+(-0.209818323927)*0.5**o
        ref[1,0,1]=(-0.75127641037)/(o+1.)+(-0.0481529718983)+(-0.372053746804)*0.5**o
        ref[1,1,0]=(-0.218691700126)/(o+1.)+(0.0665842087159)+(-0.626617217469)*0.5**o
        ref[1,1,1]=(-0.751752416764)/(o+1.)+(0.165004967668)+(-0.0577698432779)*0.5**o
        ref[2,0,0]=(-0.0172781449053)/(o+1.)+(-0.197949307988)+(0.343874535203)*0.5**o
        ref[2,0,1]=(0.499625949394)/(o+1.)+(-0.0639621511173)+(-0.185428877371)*0.5**o
        ref[2,1,0]=(0.965002845499)/(o+1.)+(0.296405176523)+(0.87676037618)*0.5**o
        ref[2,1,1]=(0.571427043323)/(o+1.)+(0.355568778058)+(-0.788632335234)*0.5**o
        ref[3,0,0]=(0.643869395266)/(o+1.)+(-0.248603098629)+(-0.460359589438)*0.5**o
        ref[3,0,1]=(0.847552650465)/(o+1.)+(-0.471374980899)+(-0.528527941319)*0.5**o
        ref[3,1,0]=(0.792482290139)/(o+1.)+(-0.288835326975)+(-0.601765878397)*0.5**o
        ref[3,1,1]=(0.674315208514)/(o+1.)+(-0.301924186259)+(0.8566130123)*0.5**o
        ref[4,0,0]=(0.14482725218)/(o+1.)+(0.123667770392)+(0.497194991988)*0.5**o
        ref[4,0,1]=(0.207166197869)/(o+1.)+(-0.00140080206462)+(-0.63538216825)*0.5**o
        ref[4,1,0]=(0.134064796438)/(o+1.)+(-0.583980524751)+(0.461593526773)*0.5**o
        ref[4,1,1]=(0.329865203686)/(o+1.)+(-0.0277930553577)+(-0.670078275492)*0.5**o
        ref[5,0,0]=(-0.671043415594)/(o+1.)+(-0.0772895763368)+(0.477016277134)*0.5**o
        ref[5,0,1]=(-0.863660332362)/(o+1.)+(-0.862182891111)+(-0.888470672335)*0.5**o
        ref[5,1,0]=(0.734550839405)/(o+1.)+(-0.00320324272275)+(0.580399166789)*0.5**o
        ref[5,1,1]=(-0.186529971258)/(o+1.)+(0.409102503591)+(-0.486700649159)*0.5**o
      else:
        s[0,0,0]=(1.49896775273)*x[0]+(-1.78250968743)*x[1]+(1.41503337092)*x[2]
        s[0,0,1]=(-0.643818266916)*x[0]+(-0.375134170105)*x[1]+(0.650514899885)*x[2]
        s[0,1,0]=(-0.0528798419185)*x[0]+(0.665778795831)*x[1]+(1.21069663928)*x[2]
        s[0,1,1]=(-1.45464226351)*x[0]+(-0.19467401007)*x[1]+(0.442665314437)*x[2]
        s[1,0,0]=(-0.836797292596)*x[0]+(-0.0542158346848)*x[1]+(-0.54209479287)*x[2]
        s[1,0,1]=(-1.09189713442)*x[0]+(1.03696758011)*x[1]+(0.0722113737424)*x[2]
        s[1,1,0]=(-0.493099825558)*x[0]+(-0.914461955024)*x[1]+(1.50580577272)*x[2]
        s[1,1,1]=(-0.702256378373)*x[0]+(-1.55374444057)*x[1]+(0.187304514552)*x[2]
        s[2,0,0]=(-0.924126823838)*x[0]+(-1.20470503473)*x[1]+(-0.702166397011)*x[2]
        s[2,0,1]=(1.04661135244)*x[0]+(0.995774871402)*x[1]+(0.912661077993)*x[2]
        s[2,1,0]=(0.0694812274474)*x[0]+(-0.384400463672)*x[1]+(-1.27290008863)*x[2]
        s[2,1,1]=(-0.196348771836)*x[0]+(0.314419668134)*x[1]+(-0.147174148507)*x[2]
        s[3,0,0]=(0.555982166527)*x[0]+(1.26542592993)*x[1]+(1.94075238034)*x[2]
        s[3,0,1]=(-0.15925841434)*x[0]+(0.235963126853)*x[1]+(1.01719057653)*x[2]
        s[3,1,0]=(1.8766116496)*x[0]+(0.0416539079261)*x[1]+(0.692631820852)*x[2]
        s[3,1,1]=(-1.60594678123)*x[0]+(0.418185984317)*x[1]+(1.00380643717)*x[2]
        s[4,0,0]=(-0.496656665568)*x[0]+(-0.519100502539)*x[1]+(-0.402964765219)*x[2]
        s[4,0,1]=(0.810723701732)*x[0]+(-0.9121518445)*x[1]+(0.0693075114891)*x[2]
        s[4,1,0]=(-1.38980929277)*x[0]+(-0.135080762705)*x[1]+(-0.708040071312)*x[2]
        s[4,1,1]=(0.0366128814416)*x[0]+(-0.598343408328)*x[1]+(-1.05172726191)*x[2]
        s[5,0,0]=(0.626645586525)*x[0]+(0.368702379272)*x[1]+(1.06419625419)*x[2]
        s[5,0,1]=(0.823542930912)*x[0]+(-0.397291307792)*x[1]+(1.47677515709)*x[2]
        s[5,1,0]=(1.0044323164)*x[0]+(-0.400460024166)*x[1]+(0.0881220069594)*x[2]
        s[5,1,1]=(0.841418294962)*x[0]+(0.448350914459)*x[1]+(-0.535982888316)*x[2]
        ref[0,0,0]=(0.0352781393333)/(o+1.)+(0.227326591212)+(0.64156011446)*0.5**o
        ref[0,0,1]=(-0.122693252863)/(o+1.)+(-0.221154887636)+(0.196565490999)*0.5**o
        ref[0,1,0]=(0.784542061966)/(o+1.)+(0.731576295626)+(-0.424099060024)*0.5**o
        ref[0,1,1]=(0.118776006377)/(o+1.)+(-0.423066319495)+(-0.479294326528)*0.5**o
        ref[1,0,0]=(1.18086837157)/(o+1.)+(-1.14308640082)+(-0.327803490075)*0.5**o
        ref[1,0,1]=(1.11878511573)/(o+1.)+(-0.427948355911)+(-0.245606584475)*0.5**o
        ref[1,1,0]=(-0.256395599928)/(o+1.)+(0.22748609258)+(-0.100332593094)*0.5**o
        ref[1,1,1]=(-0.192853498607)/(o+1.)+(-0.925785926894)+(-0.0242709519946)*0.5**o
        ref[2,0,0]=(-0.415752649176)/(o+1.)+(-1.14572035003)+(-0.123804906338)*0.5**o
        ref[2,0,1]=(0.384199373535)/(o+1.)+(0.843162532691)+(0.884522862915)*0.5**o
        ref[2,1,0]=(-0.229595030341)/(o+1.)+(-1.14751601921)+(0.936807743902)*0.5**o
        ref[2,1,1]=(0.267255066685)/(o+1.)+(-0.491644195523)+(0.686930072154)*0.5**o
        ref[3,0,0]=(1.68424865452)/(o+1.)+(0.955116898624)+(0.167678025029)*0.5**o
        ref[3,0,1]=(0.0034339126924)/(o+1.)+(0.718824562093)+(-0.347187747836)*0.5**o
        ref[3,1,0]=(1.62164005566)/(o+1.)+(0.0562907078128)+(0.876675907094)*0.5**o
        ref[3,1,1]=(0.472424872079)/(o+1.)+(0.0308594354746)+(-0.718098102775)*0.5**o
        ref[4,0,0]=(-0.0285810697935)/(o+1.)+(-0.525693855415)+(-0.338753152702)*0.5**o
        ref[4,0,1]=(0.303057697082)/(o+1.)+(-0.350175453973)+(0.365172579586)*0.5**o
        ref[4,1,0]=(-1.04637813553)/(o+1.)+(-0.308024248014)+(-0.57050349523)*0.5**o
        ref[4,1,1]=(-0.500793745646)/(o+1.)+(-0.424344892355)+(-0.26397425844)*0.5**o
        ref[5,0,0]=(0.365122763119)/(o+1.)+(0.568706597744)+(0.557008261376)*0.5**o
        ref[5,0,1]=(0.510379226755)/(o+1.)+(0.436754108223)+(0.519139337008)*0.5**o
        ref[5,1,0]=(-0.200129774692)/(o+1.)+(0.274983568325)+(0.342256937234)*0.5**o
        ref[5,1,1]=(0.566120139584)/(o+1.)+(-0.312318326061)+(0.812302833644)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(-0.36635416566)*x[0]+(0.454278450476)*x[1]
        s[0,0,0,1]=(0.449553060759)*x[0]+(-0.226772438798)*x[1]
        s[0,0,1,0]=(0.648343714053)*x[0]+(0.233007941149)*x[1]
        s[0,0,1,1]=(-0.135283076943)*x[0]+(1.61027554283)*x[1]
        s[0,0,2,0]=(0.619161973877)*x[0]+(-0.112220917964)*x[1]
        s[0,0,2,1]=(0.857902398581)*x[0]+(1.51928597673)*x[1]
        s[0,1,0,0]=(0.331827670107)*x[0]+(1.40775973855)*x[1]
        s[0,1,0,1]=(0.421840987115)*x[0]+(0.118563659741)*x[1]
        s[0,1,1,0]=(0.447268593931)*x[0]+(0.484984994669)*x[1]
        s[0,1,1,1]=(-0.189018546367)*x[0]+(0.467542988869)*x[1]
        s[0,1,2,0]=(0.466123494496)*x[0]+(-0.713267013868)*x[1]
        s[0,1,2,1]=(1.14105709142)*x[0]+(-0.134715682223)*x[1]
        s[0,2,0,0]=(0.871597208182)*x[0]+(-1.49080786854)*x[1]
        s[0,2,0,1]=(-0.94888847468)*x[0]+(0.0275999018363)*x[1]
        s[0,2,1,0]=(0.77534514887)*x[0]+(1.67162256756)*x[1]
        s[0,2,1,1]=(-0.786790506628)*x[0]+(-0.0692869424346)*x[1]
        s[0,2,2,0]=(1.78371863881)*x[0]+(-0.0481919137551)*x[1]
        s[0,2,2,1]=(-0.992074926087)*x[0]+(-1.02372593432)*x[1]
        s[0,3,0,0]=(0.113042447336)*x[0]+(-0.0790352303856)*x[1]
        s[0,3,0,1]=(1.12030253557)*x[0]+(0.393484268041)*x[1]
        s[0,3,1,0]=(0.379936292181)*x[0]+(-1.53869802379)*x[1]
        s[0,3,1,1]=(-0.191443496207)*x[0]+(0.563534464341)*x[1]
        s[0,3,2,0]=(0.104758691419)*x[0]+(-0.99439187659)*x[1]
        s[0,3,2,1]=(-0.479774987108)*x[0]+(-0.142765773584)*x[1]
        s[0,4,0,0]=(-1.50474690932)*x[0]+(-0.507691997905)*x[1]
        s[0,4,0,1]=(-0.78875103976)*x[0]+(0.132625919742)*x[1]
        s[0,4,1,0]=(-0.692847502554)*x[0]+(0.437815890612)*x[1]
        s[0,4,1,1]=(-0.808194455413)*x[0]+(0.376369555557)*x[1]
        s[0,4,2,0]=(0.919158598696)*x[0]+(-1.18391426084)*x[1]
        s[0,4,2,1]=(0.42374001855)*x[0]+(0.812305143875)*x[1]
        s[1,0,0,0]=(0.218364606199)*x[0]+(-1.40515806247)*x[1]
        s[1,0,0,1]=(-0.351603222911)*x[0]+(1.45105178061)*x[1]
        s[1,0,1,0]=(1.39849984972)*x[0]+(-1.35867734934)*x[1]
        s[1,0,1,1]=(-0.00360307599185)*x[0]+(0.246277359726)*x[1]
        s[1,0,2,0]=(0.514944968042)*x[0]+(0.428253029894)*x[1]
        s[1,0,2,1]=(-0.786120897197)*x[0]+(0.920810959626)*x[1]
        s[1,1,0,0]=(-0.602179171574)*x[0]+(0.515213890072)*x[1]
        s[1,1,0,1]=(-0.0861102153588)*x[0]+(0.477359706262)*x[1]
        s[1,1,1,0]=(-0.688164903151)*x[0]+(-0.313549483397)*x[1]
        s[1,1,1,1]=(-0.429990373791)*x[0]+(-0.0543708786137)*x[1]
        s[1,1,2,0]=(-0.39223682603)*x[0]+(0.796504408378)*x[1]
        s[1,1,2,1]=(-1.69046328113)*x[0]+(-0.344952802268)*x[1]
        s[1,2,0,0]=(-0.528152430512)*x[0]+(-0.269147355)*x[1]
        s[1,2,0,1]=(-1.68741664082)*x[0]+(0.568028242365)*x[1]
        s[1,2,1,0]=(-0.076694122635)*x[0]+(0.512745790897)*x[1]
        s[1,2,1,1]=(-0.738719294653)*x[0]+(1.72566985283)*x[1]
        s[1,2,2,0]=(0.679026798185)*x[0]+(-0.766391547753)*x[1]
        s[1,2,2,1]=(-1.7766436376)*x[0]+(-0.626962152238)*x[1]
        s[1,3,0,0]=(-0.0629592766364)*x[0]+(-0.602623643371)*x[1]
        s[1,3,0,1]=(1.46050982285)*x[0]+(-1.29912311111)*x[1]
        s[1,3,1,0]=(0.565052310821)*x[0]+(0.451146130683)*x[1]
        s[1,3,1,1]=(-1.72352086869)*x[0]+(-0.729969658338)*x[1]
        s[1,3,2,0]=(-0.699562180077)*x[0]+(0.785838373001)*x[1]
        s[1,3,2,1]=(0.0504742963364)*x[0]+(-0.856596707973)*x[1]
        s[1,4,0,0]=(-0.220685313017)*x[0]+(1.49415344926)*x[1]
        s[1,4,0,1]=(0.965835473202)*x[0]+(-0.664523896748)*x[1]
        s[1,4,1,0]=(-0.643560593026)*x[0]+(-1.06826452446)*x[1]
        s[1,4,1,1]=(-0.347993256951)*x[0]+(0.240926576999)*x[1]
        s[1,4,2,0]=(-0.666305003293)*x[0]+(1.5567540195)*x[1]
        s[1,4,2,1]=(0.752122481773)*x[0]+(-0.940078899457)*x[1]
        s[2,0,0,0]=(-0.428935565836)*x[0]+(-0.471904780642)*x[1]
        s[2,0,0,1]=(0.157225979958)*x[0]+(-0.707126471203)*x[1]
        s[2,0,1,0]=(-0.127873936162)*x[0]+(-1.01452234653)*x[1]
        s[2,0,1,1]=(-1.43314905378)*x[0]+(1.09406218538)*x[1]
        s[2,0,2,0]=(0.125475529763)*x[0]+(-0.144317966895)*x[1]
        s[2,0,2,1]=(0.781409858349)*x[0]+(-0.27747495012)*x[1]
        s[2,1,0,0]=(-1.21917608112)*x[0]+(-0.785716389383)*x[1]
        s[2,1,0,1]=(-0.26082261117)*x[0]+(-0.376402142009)*x[1]
        s[2,1,1,0]=(-0.125232448715)*x[0]+(0.261783624866)*x[1]
        s[2,1,1,1]=(-1.25985888818)*x[0]+(-0.0711437757878)*x[1]
        s[2,1,2,0]=(-0.300629742217)*x[0]+(-0.46939686121)*x[1]
        s[2,1,2,1]=(-1.77973256304)*x[0]+(0.713178700308)*x[1]
        s[2,2,0,0]=(-0.900064650204)*x[0]+(0.507949604762)*x[1]
        s[2,2,0,1]=(-0.885252734166)*x[0]+(-0.154018162942)*x[1]
        s[2,2,1,0]=(-0.7944479569)*x[0]+(1.77390521085)*x[1]
        s[2,2,1,1]=(1.1725888609)*x[0]+(0.662244216625)*x[1]
        s[2,2,2,0]=(-0.236310280848)*x[0]+(-0.542661345078)*x[1]
        s[2,2,2,1]=(1.15526522118)*x[0]+(0.0247167490822)*x[1]
        s[2,3,0,0]=(0.175989767802)*x[0]+(1.43963679604)*x[1]
        s[2,3,0,1]=(-0.692773425778)*x[0]+(-0.297594800061)*x[1]
        s[2,3,1,0]=(-0.847486832282)*x[0]+(0.0810250645286)*x[1]
        s[2,3,1,1]=(-0.681973624741)*x[0]+(-1.24971452577)*x[1]
        s[2,3,2,0]=(-1.06756371509)*x[0]+(0.977349108627)*x[1]
        s[2,3,2,1]=(0.846764513647)*x[0]+(-0.547998096826)*x[1]
        s[2,4,0,0]=(0.634255041776)*x[0]+(0.339363455414)*x[1]
        s[2,4,0,1]=(-1.39093420159)*x[0]+(0.716421880025)*x[1]
        s[2,4,1,0]=(0.257472890363)*x[0]+(-0.197982551362)*x[1]
        s[2,4,1,1]=(-0.45529259808)*x[0]+(-0.761148165674)*x[1]
        s[2,4,2,0]=(0.955343907343)*x[0]+(-1.29615358423)*x[1]
        s[2,4,2,1]=(0.362935017626)*x[0]+(1.25503750319)*x[1]
        s[3,0,0,0]=(0.179219886497)*x[0]+(1.78329032848)*x[1]
        s[3,0,0,1]=(0.43735751276)*x[0]+(0.0403938192717)*x[1]
        s[3,0,1,0]=(1.11478662344)*x[0]+(-0.240063001264)*x[1]
        s[3,0,1,1]=(0.172583585916)*x[0]+(0.506428670417)*x[1]
        s[3,0,2,0]=(1.33494651584)*x[0]+(0.781224884171)*x[1]
        s[3,0,2,1]=(0.0432954454652)*x[0]+(-0.68034279444)*x[1]
        s[3,1,0,0]=(-0.856892482415)*x[0]+(0.836687116891)*x[1]
        s[3,1,0,1]=(0.487431626464)*x[0]+(-0.148084918499)*x[1]
        s[3,1,1,0]=(0.331122282784)*x[0]+(-1.38429248259)*x[1]
        s[3,1,1,1]=(-0.215232051361)*x[0]+(0.537089578691)*x[1]
        s[3,1,2,0]=(1.24485548633)*x[0]+(0.509639847837)*x[1]
        s[3,1,2,1]=(-0.321450199534)*x[0]+(0.211384054649)*x[1]
        s[3,2,0,0]=(0.355385603273)*x[0]+(0.928139739798)*x[1]
        s[3,2,0,1]=(0.927589198094)*x[0]+(1.38324753996)*x[1]
        s[3,2,1,0]=(-1.16347040084)*x[0]+(-0.351854201414)*x[1]
        s[3,2,1,1]=(0.717488068131)*x[0]+(-0.0977120861443)*x[1]
        s[3,2,2,0]=(-0.799786558433)*x[0]+(0.829503505995)*x[1]
        s[3,2,2,1]=(1.37899235577)*x[0]+(-1.77910476445)*x[1]
        s[3,3,0,0]=(0.763361907215)*x[0]+(-0.861336281243)*x[1]
        s[3,3,0,1]=(0.476903208654)*x[0]+(0.903897305941)*x[1]
        s[3,3,1,0]=(1.60374028575)*x[0]+(-0.315620315575)*x[1]
        s[3,3,1,1]=(0.972809255696)*x[0]+(0.363233068227)*x[1]
        s[3,3,2,0]=(0.602799894079)*x[0]+(1.20772970348)*x[1]
        s[3,3,2,1]=(-0.000443665606339)*x[0]+(-1.6279763946)*x[1]
        s[3,4,0,0]=(-1.26676161275)*x[0]+(0.148063159145)*x[1]
        s[3,4,0,1]=(0.322891919608)*x[0]+(-1.08096025287)*x[1]
        s[3,4,1,0]=(-0.0944277709182)*x[0]+(-0.824212826197)*x[1]
        s[3,4,1,1]=(1.13530096846)*x[0]+(0.217321895058)*x[1]
        s[3,4,2,0]=(1.25663262459)*x[0]+(-0.308861390599)*x[1]
        s[3,4,2,1]=(-0.379182493224)*x[0]+(0.331110509538)*x[1]
        ref[0,0,0,0]=(0.408958259232)/(o+1.)+(0.247137449101)+(-0.815308872619)*0.5**o
        ref[0,0,0,1]=(0.13228131757)/(o+1.)+(0.165819155398)+(-0.241139006405)*0.5**o
        ref[0,0,1,0]=(0.128399251556)/(o+1.)+(0.371321245227)+(0.0103099131928)*0.5**o
        ref[0,0,1,1]=(0.966281299065)/(o+1.)+(0.381611325047)+(-0.254511483272)*0.5**o
        ref[0,0,2,0]=(-0.200167961434)/(o+1.)+(-0.0928181112535)+(0.892745239853)*0.5**o
        ref[0,0,2,1]=(0.830787814329)/(o+1.)+(0.314595496988)+(0.917209567011)*0.5**o
        ref[0,1,0,0]=(0.612992604133)/(o+1.)+(0.66241770717)+(-0.19824060982)*0.5**o
        ref[0,1,0,1]=(-0.0163161609645)/(o+1.)+(0.2025662158)+(0.151588376221)*0.5**o
        ref[0,1,1,0]=(-0.126917561445)/(o+1.)+(0.630548380093)+(-0.201925610142)*0.5**o
        ref[0,1,1,1]=(0.819096391825)/(o+1.)+(-0.370043224043)+(0.199514498764)*0.5**o
        ref[0,1,2,0]=(-0.96777130286)/(o+1.)+(0.367817797326)+(-0.0150078111633)*0.5**o
        ref[0,1,2,1]=(0.045654631235)/(o+1.)+(0.396367346781)+(0.167952084398)*0.5**o
        ref[0,2,0,0]=(-0.784765277575)/(o+1.)+(-0.298358907675)+(0.762272432566)*0.5**o
        ref[0,2,0,1]=(0.386572441281)/(o+1.)+(-0.51566858578)+(-0.276523842565)*0.5**o
        ref[0,2,1,0]=(0.680861847658)/(o+1.)+(0.740328104187)+(0.285449660402)*0.5**o
        ref[0,2,1,1]=(0.325836705829)/(o+1.)+(-0.49316269795)+(-0.195588758992)*0.5**o
        ref[0,2,2,0]=(0.783589269167)/(o+1.)+(0.0810542535881)+(0.789828948707)*0.5**o
        ref[0,2,2,1]=(-0.370218192335)/(o+1.)+(-0.608350209702)+(-0.428882248665)*0.5**o
        ref[0,3,0,0]=(0.188865301872)/(o+1.)+(-0.465976959809)+(0.777095834696)*0.5**o
        ref[0,3,0,1]=(0.764156203059)/(o+1.)+(-0.0928154457191)+(0.935261491991)*0.5**o
        ref[0,3,1,0]=(-0.689450927985)/(o+1.)+(-0.664550854911)+(0.8597909062)*0.5**o
        ref[0,3,1,1]=(0.555793140817)/(o+1.)+(0.142885227944)+(-0.469472628571)*0.5**o
        ref[0,3,2,0]=(-0.625798760976)/(o+1.)+(-0.499725272457)+(0.735616120719)*0.5**o
        ref[0,3,2,1]=(-0.907491695474)/(o+1.)+(0.385181050937)+(-0.485411167091)*0.5**o
        ref[0,4,0,0]=(-0.879336661239)/(o+1.)+(-0.205953419637)+(-0.721195406712)*0.5**o
        ref[0,4,0,1]=(0.86693894952)/(o+1.)+(-0.819677383073)+(0.11629069661)*0.5**o
        ref[0,4,1,0]=(-0.310289123464)/(o+1.)+(0.401826760004)+(-0.748396008487)*0.5**o
        ref[0,4,1,1]=(0.931547956812)/(o+1.)+(-0.740019832824)+(0.116666808981)*0.5**o
        ref[0,4,2,0]=(-0.847165088314)/(o+1.)+(-0.124403947896)+(0.831217321961)*0.5**o
        ref[0,4,2,1]=(0.177734973756)/(o+1.)+(0.441537508054)+(0.175235172561)*0.5**o
        ref[1,0,0,0]=(-0.542365809895)/(o+1.)+(-0.0827972838196)+(-0.478833078736)*0.5**o
        ref[1,0,0,1]=(0.844666854947)/(o+1.)+(0.498180748967)+(-0.741579795179)*0.5**o
        ref[1,0,1,0]=(-0.491126713824)/(o+1.)+(0.0335621009267)+(0.463825012354)*0.5**o
        ref[1,0,1,1]=(-0.309670980539)/(o+1.)+(0.472409867826)+(-0.392474471379)*0.5**o
        ref[1,0,2,0]=(0.278634540091)/(o+1.)+(-0.121141274647)+(0.906846007138)*0.5**o
        ref[1,0,2,1]=(-0.00603476025805)/(o+1.)+(0.182935877942)+(-0.225146933197)*0.5**o
        ref[1,1,0,0]=(0.580918965968)/(o+1.)+(0.0504878873855)+(-0.768860022241)*0.5**o
        ref[1,1,0,1]=(0.631736797799)/(o+1.)+(-0.537539597912)+(0.834591888928)*0.5**o
        ref[1,1,1,0]=(0.291226625025)/(o+1.)+(-0.703641010727)+(0.11434100988)*0.5**o
        ref[1,1,1,1]=(-0.909671911939)/(o+1.)+(0.237461939347)+(-0.0496132191606)*0.5**o
        ref[1,1,2,0]=(0.21073170992)/(o+1.)+(0.325715980645)+(-0.457896088863)*0.5**o
        ref[1,1,2,1]=(-0.725096486574)/(o+1.)+(-0.296742654874)+(-0.716834287076)*0.5**o
        ref[1,2,0,0]=(-0.164851515918)/(o+1.)+(-0.100676749276)+(-0.431094771042)*0.5**o
        ref[1,2,0,1]=(0.294840872181)/(o+1.)+(-0.329953166746)+(-0.754322937148)*0.5**o
        ref[1,2,1,0]=(0.341767621978)/(o+1.)+(0.400623115147)+(-0.70696218401)*0.5**o
        ref[1,2,1,1]=(0.821671220024)/(o+1.)+(0.193132433528)+(-0.220985528909)*0.5**o
        ref[1,2,2,0]=(-0.135508676597)/(o+1.)+(-0.38093100269)+(0.81000593241)*0.5**o
        ref[1,2,2,1]=(0.101637058171)/(o+1.)+(-0.771937440463)+(-0.961367967078)*0.5**o
        ref[1,3,0,0]=(-0.354951988253)/(o+1.)+(-0.41833260094)+(0.526034270126)*0.5**o
        ref[1,3,0,1]=(-0.461724677474)/(o+1.)+(-0.082145170992)+(0.787401731204)*0.5**o
        ref[1,3,1,0]=(0.681652074623)/(o+1.)+(-0.127199759209)+(0.5889458853)*0.5**o
        ref[1,3,1,1]=(-0.816769655641)/(o+1.)+(-0.382750879464)+(-0.871219112459)*0.5**o
        ref[1,3,2,0]=(0.549856768471)/(o+1.)+(-0.136659604755)+(-0.190261366036)*0.5**o
        ref[1,3,2,1]=(-0.298435559802)/(o+1.)+(-0.364033867566)+(0.220380883298)*0.5**o
        ref[1,4,0,0]=(0.692982064919)/(o+1.)+(0.445763556713)+(-0.311041042098)*0.5**o
        ref[1,4,0,1]=(-0.0284802774195)/(o+1.)+(0.173564544909)+(-0.0173372359445)*0.5**o
        ref[1,4,1,0]=(-0.521190661286)/(o+1.)+(-0.19266811161)+(-0.805298232979)*0.5**o
        ref[1,4,1,1]=(-0.344391605752)/(o+1.)+(0.344434513106)+(-0.451544100412)*0.5**o
        ref[1,4,2,0]=(0.590871123139)/(o+1.)+(0.123309088073)+(0.0529597169219)*0.5**o
        ref[1,4,2,1]=(-0.00996351412971)/(o+1.)+(-0.328705279006)+(0.479417654458)*0.5**o
        ref[2,0,0,0]=(0.220674489827)/(o+1.)+(-0.618024232079)+(0.114533627854)*0.5**o
        ref[2,0,0,1]=(-0.0844798976424)/(o+1.)+(0.070811636225)+(-0.607043866052)*0.5**o
        ref[2,0,1,0]=(-0.445683449242)/(o+1.)+(-0.113440437004)+(-0.469831959437)*0.5**o
        ref[2,0,1,1]=(0.271633369975)/(o+1.)+(0.132535807211)+(-0.875791852797)*0.5**o
        ref[2,0,2,0]=(0.649542525852)/(o+1.)+(0.0590165361575)+(-0.786418035298)*0.5**o
        ref[2,0,2,1]=(-0.317621366014)/(o+1.)+(0.329998426635)+(0.161559420974)*0.5**o
        ref[2,1,0,0]=(-0.835806177468)/(o+1.)+(-0.214223776118)+(-0.7406387408)*0.5**o
        ref[2,1,0,1]=(0.429741516432)/(o+1.)+(-0.552565623152)+(0.0381649766927)*0.5**o
        ref[2,1,1,0]=(-0.0472916937886)/(o+1.)+(-0.00552013887145)+(0.194883147682)*0.5**o
        ref[2,1,1,1]=(-0.199584048679)/(o+1.)+(-0.27639819939)+(-0.578622216512)*0.5**o
        ref[2,1,2,0]=(-0.941086888016)/(o+1.)+(-0.0385375072603)+(0.24813529911)*0.5**o
        ref[2,1,2,1]=(-0.0868737022971)/(o+1.)+(-0.0970507102796)+(-0.785578739872)*0.5**o
        ref[2,2,0,0]=(-0.202279119459)/(o+1.)+(-0.0839554337907)+(-0.0219250584016)*0.5**o
        ref[2,2,0,1]=(-0.184000614671)/(o+1.)+(-0.477928353442)+(0.100586424448)*0.5**o
        ref[2,2,1,0]=(0.927675340201)/(o+1.)+(0.0186691089268)+(0.0144436958933)*0.5**o
        ref[2,2,1,1]=(0.304792611717)/(o+1.)+(0.459166286092)+(0.611707893628)*0.5**o
        ref[2,2,2,0]=(0.0815687138062)/(o+1.)+(-0.768726979684)+(0.676913619635)*0.5**o
        ref[2,2,2,1]=(0.849269282518)/(o+1.)+(-0.25478410885)+(0.840280905449)*0.5**o
        ref[2,3,0,0]=(0.820793959083)/(o+1.)+(0.575169789593)+(-0.355506974424)*0.5**o
        ref[2,3,0,1]=(0.283603638973)/(o+1.)+(-0.335480628352)+(-0.603010608107)*0.5**o
        ref[2,3,1,0]=(-0.381013144765)/(o+1.)+(0.190974767434)+(-0.767398157855)*0.5**o
        ref[2,3,1,1]=(-0.773551356194)/(o+1.)+(-0.620890671367)+(0.0836445484134)*0.5**o
        ref[2,3,2,0]=(0.570212356041)/(o+1.)+(-0.289714757955)+(-0.0809974465983)*0.5**o
        ref[2,3,2,1]=(0.21581143181)/(o+1.)+(-0.415400501134)+(0.913755987278)*0.5**o
        ref[2,4,0,0]=(0.323568653669)/(o+1.)+(0.0799583453359)+(0.490133152849)*0.5**o
        ref[2,4,0,1]=(0.532408915634)/(o+1.)+(-0.115548404995)+(-0.97582442721)*0.5**o
        ref[2,4,1,0]=(-0.82114168932)/(o+1.)+(0.702564400414)+(-0.524496772508)*0.5**o
        ref[2,4,1,1]=(-0.479224200985)/(o+1.)+(-0.49364246599)+(0.25006836921)*0.5**o
        ref[2,4,2,0]=(-0.389740913016)/(o+1.)+(-0.0884282111182)+(0.225787658364)*0.5**o
        ref[2,4,2,1]=(0.508843816312)/(o+1.)+(0.17685868642)+(0.755411331668)*0.5**o
        ref[3,0,0,0]=(0.954468971244)/(o+1.)+(0.671012220464)+(-0.333983197198)*0.5**o
        ref[3,0,0,1]=(-0.312850718368)/(o+1.)+(-0.0723748107028)+(0.935351671806)*0.5**o
        ref[3,0,1,0]=(0.0640122675963)/(o+1.)+(0.220683721613)+(0.36934391135)*0.5**o
        ref[3,0,1,1]=(0.855735115439)/(o+1.)+(-0.366272230844)+(0.555821602582)*0.5**o
        ref[3,0,2,0]=(0.0417837662591)/(o+1.)+(0.556307682679)+(0.961772268394)*0.5**o
        ref[3,0,2,1]=(-0.928375029285)/(o+1.)+(-0.133425494561)+(0.558178669432)*0.5**o
        ref[3,1,0,0]=(0.610808931498)/(o+1.)+(-0.00371515949037)+(-0.623583978041)*0.5**o
        ref[3,1,0,1]=(-0.274141402005)/(o+1.)+(0.180852020544)+(0.251784068882)*0.5**o
        ref[3,1,1,0]=(-0.481032880244)/(o+1.)+(-0.705203882431)+(0.838270445302)*0.5**o
        ref[3,1,1,1]=(0.389002730435)/(o+1.)+(0.371327956101)+(-0.809801115307)*0.5**o
        ref[3,1,2,0]=(-0.217052039031)/(o+1.)+(0.504898297656)+(0.961750777882)*0.5**o
        ref[3,1,2,1]=(0.983589747751)/(o+1.)+(-0.768560013671)+(0.443464134708)*0.5**o
        ref[3,2,0,0]=(0.0850720894356)/(o+1.)+(0.295360321829)+(0.607732609977)*0.5**o
        ref[3,2,0,1]=(0.812866987322)/(o+1.)+(0.672388816065)+(0.153192118599)*0.5**o
        ref[3,2,1,0]=(-0.947419039593)/(o+1.)+(-0.179746473508)+(-0.208412615647)*0.5**o
        ref[3,2,1,1]=(-0.694332599484)/(o+1.)+(0.574069301711)+(0.165969978048)*0.5**o
        ref[3,2,2,0]=(0.746797880687)/(o+1.)+(0.0731831278015)+(-0.863447188728)*0.5**o
        ref[3,2,2,1]=(-0.9955274799)/(o+1.)+(-0.100141136686)+(0.795697344588)*0.5**o
        ref[3,3,0,0]=(-0.874362496111)/(o+1.)+(0.185559038089)+(0.405270045904)*0.5**o
        ref[3,3,0,1]=(0.557583002677)/(o+1.)+(0.556451155279)+(-0.28968479864)*0.5**o
        ref[3,3,1,0]=(0.435966507789)/(o+1.)+(0.00561393027505)+(0.840925601832)*0.5**o
        ref[3,3,1,1]=(-0.277310702324)/(o+1.)+(0.808938926899)+(-0.00452482755147)*0.5**o
        ref[3,3,2,0]=(0.878069034303)/(o+1.)+(0.0250230902204)+(0.882414382818)*0.5**o
        ref[3,3,2,1]=(-0.953670613054)/(o+1.)+(-0.626136165517)+(0.577522883879)*0.5**o
        ref[3,4,0,0]=(-0.0572166464991)/(o+1.)+(-0.195764673671)+(-0.669952459767)*0.5**o
        ref[3,4,0,1]=(-0.611801368818)/(o+1.)+(0.23313248955)+(-0.612531943539)*0.5**o
        ref[3,4,1,0]=(0.0451584859358)/(o+1.)+(-0.693097871519)+(0.422396659987)*0.5**o
        ref[3,4,1,1]=(0.0616735716897)/(o+1.)+(0.360358324628)+(0.57023264257)*0.5**o
        ref[3,4,2,0]=(0.404353246317)/(o+1.)+(0.02838608211)+(0.486645823449)*0.5**o
        ref[3,4,2,1]=(0.0039199584997)/(o+1.)+(0.344800813187)+(-0.741593568559)*0.5**o
      else:
        s[0,0,0,0]=(-0.00215071746669)*x[0]+(-0.332788203774)*x[1]+(-1.01240104354)*x[2]
        s[0,0,0,1]=(0.534102846033)*x[0]+(0.432162550346)*x[1]+(0.382807104545)*x[2]
        s[0,0,1,0]=(-0.774071131493)*x[0]+(0.174280314187)*x[1]+(0.235599208299)*x[2]
        s[0,0,1,1]=(1.66560900439)*x[0]+(1.38276801197)*x[1]+(0.451912961751)*x[2]
        s[0,0,2,0]=(-0.308642285607)*x[0]+(0.925763055269)*x[1]+(1.30533127575)*x[2]
        s[0,0,2,1]=(-0.15617828399)*x[0]+(-0.405834652149)*x[1]+(-0.846888299486)*x[2]
        s[0,1,0,0]=(-0.0743207250799)*x[0]+(-0.0831917437929)*x[1]+(-1.78311394968)*x[2]
        s[0,1,0,1]=(1.24178762381)*x[0]+(-0.121417608169)*x[1]+(0.0528284855272)*x[2]
        s[0,1,1,0]=(-1.14437209159)*x[0]+(0.0618138540822)*x[1]+(0.19124990065)*x[2]
        s[0,1,1,1]=(0.854246128467)*x[0]+(1.56688838996)*x[1]+(1.30424035038)*x[2]
        s[0,1,2,0]=(1.3184765993)*x[0]+(-1.40883832059)*x[1]+(0.832393276179)*x[2]
        s[0,1,2,1]=(-1.1625604886)*x[0]+(-0.104956544515)*x[1]+(-1.52389901089)*x[2]
        s[0,2,0,0]=(-0.106003547387)*x[0]+(0.852941663718)*x[1]+(0.24003638122)*x[2]
        s[0,2,0,1]=(0.892312082297)*x[0]+(-0.156996856451)*x[1]+(-1.2674975556)*x[2]
        s[0,2,1,0]=(0.0300043771968)*x[0]+(-0.848942993281)*x[1]+(-0.322425526609)*x[2]
        s[0,2,1,1]=(-0.361971760465)*x[0]+(1.89870303113)*x[1]+(0.861574517617)*x[2]
        s[0,2,2,0]=(0.97819437229)*x[0]+(-0.132714911288)*x[1]+(-0.957702168325)*x[2]
        s[0,2,2,1]=(0.588644003365)*x[0]+(-0.568265700558)*x[1]+(0.150521572866)*x[2]
        s[0,3,0,0]=(0.700807304996)*x[0]+(-1.14422226798)*x[1]+(0.587223436541)*x[2]
        s[0,3,0,1]=(-0.862702931786)*x[0]+(0.423016472206)*x[1]+(-0.555427243683)*x[2]
        s[0,3,1,0]=(0.574966038173)*x[0]+(-0.487199028698)*x[1]+(-0.32389521042)*x[2]
        s[0,3,1,1]=(0.130862033386)*x[0]+(0.42056248135)*x[1]+(0.925321527155)*x[2]
        s[0,3,2,0]=(-0.735071923108)*x[0]+(-0.528993360596)*x[1]+(0.485622476133)*x[2]
        s[0,3,2,1]=(0.126763646072)*x[0]+(0.0323222279682)*x[1]+(1.42515358228)*x[2]
        s[0,4,0,0]=(-0.334189936412)*x[0]+(0.14123257798)*x[1]+(-0.487379116976)*x[2]
        s[0,4,0,1]=(-0.528967405148)*x[0]+(-0.0622502130673)*x[1]+(-1.22107834734)*x[2]
        s[0,4,1,0]=(-1.67869230303)*x[0]+(-0.427809293008)*x[1]+(0.35027727689)*x[2]
        s[0,4,1,1]=(-1.3023324224)*x[0]+(0.364963594938)*x[1]+(1.25798740064)*x[2]
        s[0,4,2,0]=(0.789575151987)*x[0]+(-1.08985193505)*x[1]+(0.286072474971)*x[2]
        s[0,4,2,1]=(0.0321971599533)*x[0]+(1.64269617809)*x[1]+(0.448773378519)*x[2]
        s[1,0,0,0]=(-0.206961758788)*x[0]+(0.188339936734)*x[1]+(-1.36499979129)*x[2]
        s[1,0,0,1]=(-0.439106473295)*x[0]+(-1.35694867727)*x[1]+(0.17565861577)*x[2]
        s[1,0,1,0]=(0.754962041339)*x[0]+(0.377298691237)*x[1]+(-0.225684064888)*x[2]
        s[1,0,1,1]=(-0.164606093877)*x[0]+(-1.12165840203)*x[1]+(0.475143697931)*x[2]
        s[1,0,2,0]=(-0.563561093763)*x[0]+(-0.605592098451)*x[1]+(-0.382814067375)*x[2]
        s[1,0,2,1]=(-0.529311859218)*x[0]+(-0.440753365779)*x[1]+(-0.213919010047)*x[2]
        s[1,1,0,0]=(-0.381937118975)*x[0]+(0.115015087)*x[1]+(-1.58208233129)*x[2]
        s[1,1,0,1]=(-0.898803250164)*x[0]+(1.21794054101)*x[1]+(0.000708470416828)*x[2]
        s[1,1,1,0]=(0.417980628363)*x[0]+(-0.89943521283)*x[1]+(1.18981658848)*x[2]
        s[1,1,1,1]=(0.400600150308)*x[0]+(1.59168041332)*x[1]+(0.526855874334)*x[2]
        s[1,1,2,0]=(-0.658036770065)*x[0]+(0.903572546571)*x[1]+(-0.0322095817377)*x[2]
        s[1,1,2,1]=(-0.487427224544)*x[0]+(0.25991247483)*x[1]+(1.71801479005)*x[2]
        s[1,2,0,0]=(-1.23648267242)*x[0]+(-1.14397314877)*x[1]+(1.51420721169)*x[2]
        s[1,2,0,1]=(1.76604962545)*x[0]+(0.183730664401)*x[1]+(0.119413404231)*x[2]
        s[1,2,1,0]=(-0.371372970825)*x[0]+(1.67376148418)*x[1]+(-1.4673890303)*x[2]
        s[1,2,1,1]=(-1.05767796861)*x[0]+(1.57674524903)*x[1]+(0.907317505281)*x[2]
        s[1,2,2,0]=(-0.560171709945)*x[0]+(0.932731419096)*x[1]+(-1.34845422611)*x[2]
        s[1,2,2,1]=(0.299743316165)*x[0]+(1.27560261018)*x[1]+(-0.835084977966)*x[2]
        s[1,3,0,0]=(-0.255337437533)*x[0]+(-0.597132326112)*x[1]+(-0.136201264537)*x[2]
        s[1,3,0,1]=(0.593835766145)*x[0]+(-0.799771329645)*x[1]+(-0.980158768361)*x[2]
        s[1,3,1,0]=(1.38678662193)*x[0]+(0.145756993166)*x[1]+(-0.687830261701)*x[2]
        s[1,3,1,1]=(-0.535937612709)*x[0]+(-0.0191554551358)*x[1]+(0.360231645604)*x[2]
        s[1,3,2,0]=(0.464446491173)*x[0]+(0.601115829679)*x[1]+(-1.23243462932)*x[2]
        s[1,3,2,1]=(-1.00252524049)*x[0]+(0.38542247592)*x[1]+(-0.786817371152)*x[2]
        s[1,4,0,0]=(0.127520587286)*x[0]+(0.0193180871908)*x[1]+(0.443880703635)*x[2]
        s[1,4,0,1]=(0.459087583966)*x[0]+(-0.0133413082011)*x[1]+(-0.469574441754)*x[2]
        s[1,4,1,0]=(-0.0408745863162)*x[0]+(-0.450729520372)*x[1]+(0.49494190957)*x[2]
        s[1,4,1,1]=(0.698205417361)*x[0]+(0.475698414334)*x[1]+(-0.738661347545)*x[2]
        s[1,4,2,0]=(1.20797915788)*x[0]+(-0.132247786402)*x[1]+(-0.282227294584)*x[2]
        s[1,4,2,1]=(-0.76998141325)*x[0]+(-0.0677377690684)*x[1]+(-0.0836477753317)*x[2]
        s[2,0,0,0]=(-1.10579544966)*x[0]+(1.40458332668)*x[1]+(0.666829139108)*x[2]
        s[2,0,0,1]=(0.316772911983)*x[0]+(-0.722315825552)*x[1]+(-0.420491453418)*x[2]
        s[2,0,1,0]=(1.28978684389)*x[0]+(-1.31024104856)*x[1]+(-0.909892235182)*x[2]
        s[2,0,1,1]=(0.516882102505)*x[0]+(0.137837613805)*x[1]+(-0.0746054680439)*x[2]
        s[2,0,2,0]=(-0.684536226359)*x[0]+(1.26314901343)*x[1]+(-0.80088731126)*x[2]
        s[2,0,2,1]=(1.04894156753)*x[0]+(-0.292514668329)*x[1]+(0.189452265734)*x[2]
        s[2,1,0,0]=(-1.89697799819)*x[0]+(0.842415025171)*x[1]+(1.50175587499)*x[2]
        s[2,1,0,1]=(-0.132472949872)*x[0]+(0.755809155321)*x[1]+(1.4210576902)*x[2]
        s[2,1,1,0]=(-1.20812267424)*x[0]+(0.776283189748)*x[1]+(0.466844337822)*x[2]
        s[2,1,1,1]=(-0.545404145415)*x[0]+(0.630064653938)*x[1]+(0.416024592778)*x[2]
        s[2,1,2,0]=(-1.25450160322)*x[0]+(0.712099345608)*x[1]+(-1.40448708108)*x[2]
        s[2,1,2,1]=(0.8675638655)*x[0]+(-0.694288742412)*x[1]+(0.423917775454)*x[2]
        s[2,2,0,0]=(0.611369389916)*x[0]+(-0.282854928933)*x[1]+(0.421814371036)*x[2]
        s[2,2,0,1]=(0.87143261059)*x[0]+(0.626319549038)*x[1]+(-0.247486033705)*x[2]
        s[2,2,1,0]=(-1.09640818879)*x[0]+(-0.625440705278)*x[1]+(1.06488909366)*x[2]
        s[2,2,1,1]=(-1.63825859868)*x[0]+(0.243702450075)*x[1]+(0.37689118934)*x[2]
        s[2,2,2,0]=(1.14554562168)*x[0]+(-0.656545182621)*x[1]+(0.122881381407)*x[2]
        s[2,2,2,1]=(1.04057428387)*x[0]+(0.605147014643)*x[1]+(-0.0624571196862)*x[2]
        s[2,3,0,0]=(-0.687211572887)*x[0]+(-1.33387647369)*x[1]+(1.56461600602)*x[2]
        s[2,3,0,1]=(-0.439360840188)*x[0]+(-0.175050010481)*x[1]+(-0.493088639437)*x[2]
        s[2,3,1,0]=(1.01647468205)*x[0]+(1.607854298)*x[1]+(0.154041122248)*x[2]
        s[2,3,1,1]=(-1.17279615871)*x[0]+(0.265464982509)*x[1]+(0.536445292976)*x[2]
        s[2,3,2,0]=(-0.370774714547)*x[0]+(-0.140305952222)*x[1]+(-0.27755251782)*x[2]
        s[2,3,2,1]=(-0.601589093641)*x[0]+(-0.0914485078099)*x[1]+(-0.246092622851)*x[2]
        s[2,4,0,0]=(1.16222773615)*x[0]+(-1.0556446667)*x[1]+(1.18749640554)*x[2]
        s[2,4,0,1]=(0.441185917779)*x[0]+(0.106062084171)*x[1]+(-0.150699537615)*x[2]
        s[2,4,1,0]=(1.24765736189)*x[0]+(-1.28446862056)*x[1]+(-1.15581931924)*x[2]
        s[2,4,1,1]=(0.751269018864)*x[0]+(1.03373528238)*x[1]+(0.953542233964)*x[2]
        s[2,4,2,0]=(-0.507055271742)*x[0]+(-0.139767333963)*x[1]+(0.369122007484)*x[2]
        s[2,4,2,1]=(1.75708904398)*x[0]+(0.229784892513)*x[1]+(0.138439119614)*x[2]
        s[3,0,0,0]=(0.488579497744)*x[0]+(0.227848351934)*x[1]+(-0.503567606843)*x[2]
        s[3,0,0,1]=(1.48513008903)*x[0]+(0.0119808614235)*x[1]+(0.50138290689)*x[2]
        s[3,0,1,0]=(1.89811058679)*x[0]+(0.936442809385)*x[1]+(0.618927531336)*x[2]
        s[3,0,1,1]=(0.520596564131)*x[0]+(-1.34097734027)*x[1]+(-1.24288925352)*x[2]
        s[3,0,2,0]=(-1.22679833631)*x[0]+(0.946723115385)*x[1]+(-0.444825501575)*x[2]
        s[3,0,2,1]=(-0.786039767784)*x[0]+(1.01276854439)*x[1]+(0.868428470305)*x[2]
        s[3,1,0,0]=(-1.14928294841)*x[0]+(1.83212625566)*x[1]+(-0.131295307828)*x[2]
        s[3,1,0,1]=(0.530939875091)*x[0]+(-0.00936464244878)*x[1]+(-0.54397285021)*x[2]
        s[3,1,1,0]=(0.776394250264)*x[0]+(-0.0432924713397)*x[1]+(-0.48992936123)*x[2]
        s[3,1,1,1]=(-0.295285841654)*x[0]+(1.60838322278)*x[1]+(-0.822857254214)*x[2]
        s[3,1,2,0]=(-0.445325691811)*x[0]+(0.143992033055)*x[1]+(-0.562336605856)*x[2]
        s[3,1,2,1]=(-0.424042508176)*x[0]+(-0.119602696473)*x[1]+(0.50936759192)*x[2]
        s[3,2,0,0]=(0.0376712305683)*x[0]+(-0.127442186223)*x[1]+(-0.98477458245)*x[2]
        s[3,2,0,1]=(-0.964194007245)*x[0]+(-0.951386585236)*x[1]+(-0.376434083193)*x[2]
        s[3,2,1,0]=(-0.645708363662)*x[0]+(0.729523237957)*x[1]+(-0.815980951689)*x[2]
        s[3,2,1,1]=(1.54280019708)*x[0]+(0.347142929119)*x[1]+(0.117050155931)*x[2]
        s[3,2,2,0]=(-0.70653056148)*x[0]+(0.658564301815)*x[1]+(1.5766896863)*x[2]
        s[3,2,2,1]=(1.28238648298)*x[0]+(0.415173079215)*x[1]+(1.25492135064)*x[2]
        s[3,3,0,0]=(-0.907422225702)*x[0]+(0.354252510498)*x[1]+(-0.617733757576)*x[2]
        s[3,3,0,1]=(-0.687653032786)*x[0]+(0.166147005719)*x[1]+(0.0668202207665)*x[2]
        s[3,3,1,0]=(-0.515227984328)*x[0]+(-1.20687483216)*x[1]+(0.325703771711)*x[2]
        s[3,3,1,1]=(-0.239992988401)*x[0]+(-0.625429153195)*x[1]+(-0.987302012149)*x[2]
        s[3,3,2,0]=(0.48686562504)*x[0]+(-0.687077509478)*x[1]+(0.630530432518)*x[2]
        s[3,3,2,1]=(0.575785040914)*x[0]+(0.978122193974)*x[1]+(0.0753481784122)*x[2]
        s[3,4,0,0]=(-0.201304266512)*x[0]+(-0.563373770577)*x[1]+(-0.0445045378284)*x[2]
        s[3,4,0,1]=(0.348899505512)*x[0]+(-0.983874875078)*x[1]+(0.561390754019)*x[2]
        s[3,4,1,0]=(0.687251502909)*x[0]+(0.806428209931)*x[1]+(-0.848431263257)*x[2]
        s[3,4,1,1]=(-0.0690481011866)*x[0]+(-0.637464706806)*x[1]+(1.32335195878)*x[2]
        s[3,4,2,0]=(0.640286948745)*x[0]+(-1.44112416361)*x[1]+(-0.724716414365)*x[2]
        s[3,4,2,1]=(-0.967100763601)*x[0]+(0.0347001879437)*x[1]+(-0.888183629447)*x[2]
        ref[0,0,0,0]=(-1.47634692775)/(o+1.)+(0.413823374944)+(-0.69863978692)*0.5**o
        ref[0,0,0,1]=(0.467438056347)/(o+1.)+(-0.049348895708)+(0.980332235993)*0.5**o
        ref[0,0,1,0]=(0.0324608468542)/(o+1.)+(0.227219571463)+(-0.851091598789)*0.5**o
        ref[0,0,1,1]=(1.24663216229)/(o+1.)+(0.680736038169)+(0.892185739473)*0.5**o
        ref[0,0,2,0]=(1.04128811669)/(o+1.)+(0.801526892617)+(-0.721889856517)*0.5**o
        ref[0,0,2,1]=(-1.57019640933)/(o+1.)+(-0.0149100811556)+(0.191115336015)*0.5**o
        ref[0,1,0,0]=(-1.06234362705)/(o+1.)+(-0.881380501065)+(0.88447821062)*0.5**o
        ref[0,1,0,1]=(0.267287676352)/(o+1.)+(0.0934259729578)+(0.719058878904)*0.5**o
        ref[0,1,1,0]=(-0.83257335756)/(o+1.)+(0.056558158197)+(-0.171851295688)*0.5**o
        ref[0,1,1,1]=(1.59747135641)/(o+1.)+(1.00837611714)+(0.111151278122)*0.5**o
        ref[0,1,2,0]=(0.181694306894)/(o+1.)+(-0.0366161862313)+(0.633569620457)*0.5**o
        ref[0,1,2,1]=(-0.116206059658)/(o+1.)+(-1.20967709253)+(-0.255855799289)*0.5**o
        ref[0,2,0,0]=(0.615063090083)/(o+1.)+(-0.0944203632267)+(0.560752133921)*0.5**o
        ref[0,2,0,1]=(-1.68718452323)/(o+1.)+(0.415922156486)+(0.323157880499)*0.5**o
        ref[0,2,1,0]=(-1.38436480215)/(o+1.)+(0.514201265835)+(-0.785401872214)*0.5**o
        ref[0,2,1,1]=(1.07260243754)/(o+1.)+(1.03208581185)+(-0.738468272962)*0.5**o
        ref[0,2,2,0]=(-0.619469154652)/(o+1.)+(0.156513881249)+(0.19421868483)*0.5**o
        ref[0,2,2,1]=(0.742851517381)/(o+1.)+(-0.577857666542)+(0.583763691375)*0.5**o
        ref[0,3,0,0]=(-0.0209287146839)/(o+1.)+(-0.0417684031135)+(0.248273994472)*0.5**o
        ref[0,3,0,1]=(-0.876757092127)/(o+1.)+(0.156654815475)+(-0.431666242085)*0.5**o
        ref[0,3,1,0]=(-1.40731912274)/(o+1.)+(0.295731262157)+(0.579728397479)*0.5**o
        ref[0,3,1,1]=(0.766713725705)/(o+1.)+(0.520952712789)+(-0.331873109391)*0.5**o
        ref[0,3,2,0]=(-1.37493161295)/(o+1.)+(0.626269025128)+(-0.656049244875)*0.5**o
        ref[0,3,2,1]=(0.738828256274)/(o+1.)+(0.299922102653)+(0.245566994744)*0.5**o
        ref[0,4,0,0]=(-0.220320428485)/(o+1.)+(-0.381104395776)+(0.30219274463)*0.5**o
        ref[0,4,0,1]=(-1.71138026305)/(o+1.)+(0.0858133974006)+(-0.272542497315)*0.5**o
        ref[0,4,1,0]=(-0.0512711854771)/(o+1.)+(-0.398429115874)+(-0.908094901926)*0.5**o
        ref[0,4,1,1]=(0.775088175251)/(o+1.)+(0.153496176444)+(-0.76146195497)*0.5**o
        ref[0,4,2,0]=(-0.188892896681)/(o+1.)+(-0.212757962174)+(0.600204512934)*0.5**o
        ref[0,4,2,1]=(0.786135983408)/(o+1.)+(0.709443217024)+(-0.0813557008918)*0.5**o
        ref[1,0,0,0]=(-0.682877215956)/(o+1.)+(0.0430800979484)+(-0.786904593287)*0.5**o
        ref[1,0,0,1]=(-0.209743447547)/(o+1.)+(-0.529335530226)+(-0.351982026793)*0.5**o
        ref[1,0,1,0]=(1.7467904951)/(o+1.)+(-0.522734985482)+(0.205256143552)*0.5**o
        ref[1,0,1,1]=(-0.681949654071)/(o+1.)+(0.430192257885)+(-0.989555659669)*0.5**o
        ref[1,0,2,0]=(0.00559076557551)/(o+1.)+(-0.355981322114)+(-0.845595380938)*0.5**o
        ref[1,0,2,1]=(-1.0795557316)/(o+1.)+(0.433501713489)+(-0.971431930418)*0.5**o
        ref[1,1,0,0]=(-1.41228679449)/(o+1.)+(0.0214610301511)+(-0.47963962908)*0.5**o
        ref[1,1,0,1]=(0.675271467105)/(o+1.)+(0.258295057037)+(-0.872015819915)*0.5**o
        ref[1,1,1,0]=(-0.0723449260888)/(o+1.)+(0.642648455626)+(-0.504589981145)*0.5**o
        ref[1,1,1,1]=(1.69082429043)/(o+1.)+(0.351194447364)+(0.125923252805)*0.5**o
        ref[1,1,2,0]=(1.04100385874)/(o+1.)+(-0.253396731491)+(-0.320884200985)*0.5**o
        ref[1,1,2,1]=(1.44000111068)/(o+1.)+(0.167426476075)+(-0.284354022497)*0.5**o
        ref[1,2,0,0]=(0.762931449029)/(o+1.)+(-0.397841053459)+(-0.833497951611)*0.5**o
        ref[1,2,0,1]=(-0.353193148804)/(o+1.)+(0.729759415974)+(0.962868010939)*0.5**o
        ref[1,2,1,0]=(-0.0142626154573)/(o+1.)+(0.205452893539)+(-0.561643688565)*0.5**o
        ref[1,2,1,1]=(1.31669689043)/(o+1.)+(0.322616901969)+(-0.535545908666)*0.5**o
        ref[1,2,2,0]=(-0.720144981522)/(o+1.)+(-0.253513298251)+(0.251277061063)*0.5**o
        ref[1,2,2,1]=(0.171627338105)/(o+1.)+(0.304508788985)+(-0.0403839677009)*0.5**o
        ref[1,3,0,0]=(-0.385245021569)/(o+1.)+(0.0533837214678)+(-0.710193449549)*0.5**o
        ref[1,3,0,1]=(-1.66770468862)/(o+1.)+(0.0386999300625)+(0.404210496633)*0.5**o
        ref[1,3,1,0]=(0.1536232451)/(o+1.)+(-0.114369222402)+(0.919828553095)*0.5**o
        ref[1,3,1,1]=(0.279969861456)/(o+1.)+(0.199789198624)+(-0.874409680945)*0.5**o
        ref[1,3,2,0]=(-0.29883793799)/(o+1.)+(-0.179133605171)+(0.490232839865)*0.5**o
        ref[1,3,2,1]=(-0.20045707503)/(o+1.)+(-0.419654937503)+(-0.364153185689)*0.5**o
        ref[1,4,0,0]=(0.328269609451)/(o+1.)+(0.0976736768568)+(0.0671024149466)*0.5**o
        ref[1,4,0,1]=(0.70998344827)/(o+1.)+(-0.831520044753)+(0.929228475247)*0.5**o
        ref[1,4,1,0]=(1.14467737453)/(o+1.)+(-0.309242254267)+(-0.522855063115)*0.5**o
        ref[1,4,1,1]=(0.386397027677)/(o+1.)+(-0.152706345419)+(0.354258147311)*0.5**o
        ref[1,4,2,0]=(0.565989417809)/(o+1.)+(-0.0912836510331)+(0.410081961152)*0.5**o
        ref[1,4,2,1]=(-0.108228050157)/(o+1.)+(-0.382022658574)+(-0.0490935903447)*0.5**o
        ref[2,0,0,0]=(1.30816654656)/(o+1.)+(0.218850490887)+(-0.780250512205)*0.5**o
        ref[2,0,0,1]=(-0.072210934601)/(o+1.)+(-0.376572060485)+(-0.000679311415873)*0.5**o
        ref[2,0,1,0]=(-1.03731005117)/(o+1.)+(-0.369008331776)+(0.844980274869)*0.5**o
        ref[2,0,1,1]=(-0.37673073433)/(o+1.)+(0.147779920342)+(0.661285141912)*0.5**o
        ref[2,0,2,0]=(-0.126456722513)/(o+1.)+(-0.173173731574)+(0.250529661474)*0.5**o
        ref[2,0,2,1]=(0.269921444109)/(o+1.)+(0.256112039487)+(0.163733641849)*0.5**o
        ref[2,1,0,0]=(1.02033624645)/(o+1.)+(0.162073420045)+(-0.897290184569)*0.5**o
        ref[2,1,0,1]=(0.673075377238)/(o+1.)+(0.377904898438)+(0.615508721534)*0.5**o
        ref[2,1,1,0]=(-0.536750510163)/(o+1.)+(0.687164638156)+(-0.802573912815)*0.5**o
        ref[2,1,1,1]=(1.39522327504)/(o+1.)+(-0.168020484927)+(-0.558497203882)*0.5**o
        ref[2,1,2,0]=(-1.21446181317)/(o+1.)+(-0.219360528348)+(-0.293706468828)*0.5**o
        ref[2,1,2,1]=(0.352877691113)/(o+1.)+(0.0397286675094)+(0.16485787241)*0.5**o
        ref[2,2,0,0]=(-0.927761522597)/(o+1.)+(1.03238921925)+(-0.386688083878)*0.5**o
        ref[2,2,0,1]=(0.875914163347)/(o+1.)+(-0.0805989643579)+(0.535549891292)*0.5**o
        ref[2,2,1,0]=(-0.268027052879)/(o+1.)+(0.24501270411)+(-0.878958155751)*0.5**o
        ref[2,2,1,1]=(0.579267469532)/(o+1.)+(-0.419360478349)+(-0.758211472099)*0.5**o
        ref[2,2,2,0]=(-0.407532480549)/(o+1.)+(0.0236731772421)+(0.972067946527)*0.5**o
        ref[2,2,2,1]=(-0.848446514529)/(o+1.)+(0.986605187547)+(0.458500318263)*0.5**o
        ref[2,3,0,0]=(0.0139531165204)/(o+1.)+(0.0612674782454)+(-0.592960113562)*0.5**o
        ref[2,3,0,1]=(-0.434410189326)/(o+1.)+(0.0699472934754)+(-0.81298388773)*0.5**o
        ref[2,3,1,0]=(1.51687712753)/(o+1.)+(0.29518962448)+(0.671113725811)*0.5**o
        ref[2,3,1,1]=(-0.825018275156)/(o+1.)+(0.348395434187)+(-0.242658476441)*0.5**o
        ref[2,3,2,0]=(-0.129038376537)/(o+1.)+(0.0407049218889)+(-0.74100465183)*0.5**o
        ref[2,3,2,1]=(-0.61436863216)/(o+1.)+(0.0569955443553)+(-0.438752680853)*0.5**o
        ref[2,4,0,0]=(-0.186811568504)/(o+1.)+(0.324468688913)+(0.831953665661)*0.5**o
        ref[2,4,0,1]=(1.01471089788)/(o+1.)+(-0.404804936557)+(0.191447439569)*0.5**o
        ref[2,4,1,0]=(-0.833336708992)/(o+1.)+(-0.465420260939)+(0.571546652968)*0.5**o
        ref[2,4,1,1]=(1.48092456289)/(o+1.)+(0.548316338846)+(0.16098929463)*0.5**o
        ref[2,4,2,0]=(-1.20254311473)/(o+1.)+(0.778023417549)+(-0.631204318592)*0.5**o
        ref[2,4,2,1]=(0.672521404448)/(o+1.)+(0.265167920765)+(0.922455810129)*0.5**o
        ref[3,0,0,0]=(-0.400146773167)/(o+1.)+(0.151226335458)+(0.310554345086)*0.5**o
        ref[3,0,0,1]=(0.580039994556)/(o+1.)+(0.287523081772)+(0.843407699243)*0.5**o
        ref[3,0,1,0]=(0.930972332962)/(o+1.)+(0.768302886889)+(0.985902820768)*0.5**o
        ref[3,0,1,1]=(-0.991140747279)/(o+1.)+(-0.914680203238)+(0.757231124095)*0.5**o
        ref[3,0,2,0]=(-0.458287257967)/(o+1.)+(0.237995705359)+(-0.742604875255)*0.5**o
        ref[3,0,2,1]=(1.14385326779)/(o+1.)+(0.243645854371)+(-0.535987729627)*0.5**o
        ref[3,1,0,0]=(0.322354058507)/(o+1.)+(0.341162149011)+(-0.453130357106)*0.5**o
        ref[3,1,0,1]=(-1.78201691527)/(o+1.)+(1.04199074308)+(-0.324362188462)*0.5**o
        ref[3,1,1,0]=(-0.0578982797037)/(o+1.)+(-0.110933167998)+(0.522937033394)*0.5**o
        ref[3,1,1,1]=(-0.276009095212)/(o+1.)+(0.517113652949)+(-0.267978083771)*0.5**o
        ref[3,1,2,0]=(-0.023345636799)/(o+1.)+(-0.66878791133)+(0.497251194848)*0.5**o
        ref[3,1,2,1]=(1.2604140706)/(o+1.)+(-0.878310666552)+(0.461929649774)*0.5**o
        ref[3,2,0,0]=(-0.00211014675007)/(o+1.)+(-0.814091029436)+(0.555746667517)*0.5**o
        ref[3,2,0,1]=(-1.07650025357)/(o+1.)+(-0.26199073554)+(-0.691532951025)*0.5**o
        ref[3,2,1,0]=(-0.0770650645465)/(o+1.)+(-0.307619169254)+(-0.0398626743392)*0.5**o
        ref[3,2,1,1]=(1.12398638253)/(o+1.)+(-0.00626411324864)+(0.895535126103)*0.5**o
        ref[3,2,2,0]=(0.822758496096)/(o+1.)+(0.448681597953)+(-0.191398265373)*0.5**o
        ref[3,2,2,1]=(1.38402514586)/(o+1.)+(0.489672391609)+(0.589110983761)*0.5**o
        ref[3,3,0,0]=(0.626837013941)/(o+1.)+(-0.698370737203)+(-0.400999012316)*0.5**o
        ref[3,3,0,1]=(-0.819551723109)/(o+1.)+(0.588359566557)+(-0.811853216306)*0.5**o
        ref[3,3,1,0]=(-0.472944922304)/(o+1.)+(0.024839136659)+(-0.973132395795)*0.5**o
        ref[3,3,1,1]=(-0.674351724226)/(o+1.)+(-0.596697469314)+(0.0150225091087)*0.5**o
        ref[3,3,2,0]=(-0.653245573198)/(o+1.)+(0.590003731898)+(-0.0964433425189)*0.5**o
        ref[3,3,2,1]=(1.15741134315)/(o+1.)+(-0.128540702232)+(0.728925474609)*0.5**o
        ref[3,4,0,0]=(-0.745079746498)/(o+1.)+(-0.313462120963)+(0.562821413507)*0.5**o
        ref[3,4,0,1]=(-0.585232841208)/(o+1.)+(0.464633596697)+(-0.417618967733)*0.5**o
        ref[3,4,1,0]=(0.792309614109)/(o+1.)+(-0.478065247211)+(0.809069329896)*0.5**o
        ref[3,4,1,1]=(0.0536562315177)/(o+1.)+(-0.128980351611)+(0.821143622493)*0.5**o
        ref[3,4,2,0]=(-1.20913408459)/(o+1.)+(-0.144016051074)+(-0.0283874424941)*0.5**o
        ref[3,4,2,1]=(-1.12139150964)/(o+1.)+(-0.135856270303)+(-0.427480154859)*0.5**o
      res=integrate(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_FunctionOnContactOne_rank0(self):
      """
      tests integral of rank 0 Symbol on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Symbol(shape=())
      s=Data(0,(),w)
      if dim==2:
        s=(0.0457734760303)*x[0]**o+(0.469200083987)*x[0]+(0.871163132136)*x[1]**o+(-0.848809543077)*x[1]
        ref=(0.871163132136)/(o+1.)+(-0.189804729545)+(0.0457734760303)*0.5**o
      else:
        s=(-0.217546543734)*x[0]**o+(-0.296791310389)*x[0]+(0.295478793948)*x[1]**o+(0.355506997608)*x[1]+(-0.173745407638)*x[2]**o+(0.733848286432)*x[2]
        ref=(0.12173338631)/(o+1.)+(0.396281986825)+(-0.217546543734)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_FunctionOnContactOne_rank1(self):
      """
      tests integral of rank 1 Symbol on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,))
      s=Data(0,(2,),w)
      ref=numarray.zeros((2,),numarray.Float)
      if dim==2:
        s[0]=(0.375635683415)*x[0]**o+(-0.367500579656)*x[0]+(0.0137704362217)*x[1]**o+(-0.861006616375)*x[1]
        s[1]=(-0.787660325374)*x[0]**o+(0.114019988756)*x[0]+(0.120533570643)*x[1]**o+(0.619732700586)*x[1]
        ref[0]=(0.0137704362217)/(o+1.)+(-0.614253598016)+(0.375635683415)*0.5**o
        ref[1]=(0.120533570643)/(o+1.)+(0.366876344671)+(-0.787660325374)*0.5**o
      else:
        s[0]=(-0.496247804966)*x[0]**o+(-0.717417759132)*x[0]+(-0.89565067445)*x[1]**o+(0.382056160402)*x[1]+(0.994707732251)*x[2]**o+(0.988370997667)*x[2]
        s[1]=(0.274829833844)*x[0]**o+(0.699113046456)*x[0]+(-0.780626603094)*x[1]**o+(0.00719416836835)*x[1]+(0.0771370370478)*x[2]**o+(-0.883519240597)*x[2]
        ref[0]=(0.0990570578009)/(o+1.)+(0.326504699469)+(-0.496247804966)*0.5**o
        ref[1]=(-0.703489566047)/(o+1.)+(-0.0886060128866)+(0.274829833844)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_FunctionOnContactOne_rank2(self):
      """
      tests integral of rank 2 Symbol on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5))
      s=Data(0,(4, 5),w)
      ref=numarray.zeros((4, 5),numarray.Float)
      if dim==2:
        s[0,0]=(0.997138766521)*x[0]**o+(-0.553379306564)*x[0]+(-0.234324119126)*x[1]**o+(-0.355669375308)*x[1]
        s[0,1]=(-0.0722078180457)*x[0]**o+(0.29155764813)*x[0]+(0.30568465631)*x[1]**o+(-0.977462121264)*x[1]
        s[0,2]=(0.0627729453295)*x[0]**o+(0.522234421268)*x[0]+(-0.265521199465)*x[1]**o+(0.0773272883492)*x[1]
        s[0,3]=(0.120580856562)*x[0]**o+(-0.576605249922)*x[0]+(-0.515839258724)*x[1]**o+(0.364676391176)*x[1]
        s[0,4]=(-0.369132454849)*x[0]**o+(-0.304739979654)*x[0]+(0.731091855933)*x[1]**o+(0.312380588453)*x[1]
        s[1,0]=(-0.277744449846)*x[0]**o+(0.963258283702)*x[0]+(0.0646683091177)*x[1]**o+(0.508336130337)*x[1]
        s[1,1]=(0.879838558141)*x[0]**o+(-0.575726599149)*x[0]+(-0.770954127597)*x[1]**o+(-0.29742399168)*x[1]
        s[1,2]=(0.105461068455)*x[0]**o+(0.325901606009)*x[0]+(-0.787936986763)*x[1]**o+(0.275010392849)*x[1]
        s[1,3]=(0.634687837213)*x[0]**o+(0.449318030603)*x[0]+(0.113843972437)*x[1]**o+(0.135522890516)*x[1]
        s[1,4]=(-0.447823860246)*x[0]**o+(-0.980688332644)*x[0]+(0.791824549606)*x[1]**o+(-0.171760132019)*x[1]
        s[2,0]=(0.61803013069)*x[0]**o+(-0.539345725331)*x[0]+(0.552856742671)*x[1]**o+(0.760667455882)*x[1]
        s[2,1]=(0.707626098607)*x[0]**o+(0.682940904637)*x[0]+(-0.057070815024)*x[1]**o+(-0.889583848012)*x[1]
        s[2,2]=(0.0226275928114)*x[0]**o+(-0.58368440817)*x[0]+(0.503278007027)*x[1]**o+(0.607225060945)*x[1]
        s[2,3]=(-0.643463757169)*x[0]**o+(0.166312879954)*x[0]+(0.889781254515)*x[1]**o+(-0.820343616323)*x[1]
        s[2,4]=(-0.920378124042)*x[0]**o+(-0.879688658227)*x[0]+(0.578052078637)*x[1]**o+(0.895382276619)*x[1]
        s[3,0]=(-0.748327596968)*x[0]**o+(-0.613914500566)*x[0]+(-0.0478077540856)*x[1]**o+(-0.838510710621)*x[1]
        s[3,1]=(-0.831715563374)*x[0]**o+(0.177460645482)*x[0]+(-0.19690401481)*x[1]**o+(-0.180828782822)*x[1]
        s[3,2]=(0.0692984740547)*x[0]**o+(-0.798996415727)*x[0]+(-0.193350054474)*x[1]**o+(-0.160594229856)*x[1]
        s[3,3]=(0.989346428804)*x[0]**o+(0.285816940366)*x[0]+(-0.296547093918)*x[1]**o+(-0.0529210232469)*x[1]
        s[3,4]=(0.24851689771)*x[0]**o+(0.452794657799)*x[0]+(-0.555079559)*x[1]**o+(-0.336250468184)*x[1]
        ref[0,0]=(-0.234324119126)/(o+1.)+(-0.454524340936)+(0.997138766521)*0.5**o
        ref[0,1]=(0.30568465631)/(o+1.)+(-0.342952236567)+(-0.0722078180457)*0.5**o
        ref[0,2]=(-0.265521199465)/(o+1.)+(0.299780854808)+(0.0627729453295)*0.5**o
        ref[0,3]=(-0.515839258724)/(o+1.)+(-0.105964429373)+(0.120580856562)*0.5**o
        ref[0,4]=(0.731091855933)/(o+1.)+(0.00382030439927)+(-0.369132454849)*0.5**o
        ref[1,0]=(0.0646683091177)/(o+1.)+(0.73579720702)+(-0.277744449846)*0.5**o
        ref[1,1]=(-0.770954127597)/(o+1.)+(-0.436575295414)+(0.879838558141)*0.5**o
        ref[1,2]=(-0.787936986763)/(o+1.)+(0.300455999429)+(0.105461068455)*0.5**o
        ref[1,3]=(0.113843972437)/(o+1.)+(0.292420460559)+(0.634687837213)*0.5**o
        ref[1,4]=(0.791824549606)/(o+1.)+(-0.576224232331)+(-0.447823860246)*0.5**o
        ref[2,0]=(0.552856742671)/(o+1.)+(0.110660865275)+(0.61803013069)*0.5**o
        ref[2,1]=(-0.057070815024)/(o+1.)+(-0.103321471687)+(0.707626098607)*0.5**o
        ref[2,2]=(0.503278007027)/(o+1.)+(0.0117703263876)+(0.0226275928114)*0.5**o
        ref[2,3]=(0.889781254515)/(o+1.)+(-0.327015368185)+(-0.643463757169)*0.5**o
        ref[2,4]=(0.578052078637)/(o+1.)+(0.00784680919582)+(-0.920378124042)*0.5**o
        ref[3,0]=(-0.0478077540856)/(o+1.)+(-0.726212605594)+(-0.748327596968)*0.5**o
        ref[3,1]=(-0.19690401481)/(o+1.)+(-0.00168406867019)+(-0.831715563374)*0.5**o
        ref[3,2]=(-0.193350054474)/(o+1.)+(-0.479795322792)+(0.0692984740547)*0.5**o
        ref[3,3]=(-0.296547093918)/(o+1.)+(0.11644795856)+(0.989346428804)*0.5**o
        ref[3,4]=(-0.555079559)/(o+1.)+(0.0582720948078)+(0.24851689771)*0.5**o
      else:
        s[0,0]=(-0.885439150233)*x[0]**o+(-0.0707651237907)*x[0]+(-0.0221938474237)*x[1]**o+(-0.657402959688)*x[1]+(0.492040451029)*x[2]**o+(-0.500851664471)*x[2]
        s[0,1]=(-0.915950017556)*x[0]**o+(-0.223230342138)*x[0]+(0.251513308151)*x[1]**o+(0.340647147217)*x[1]+(0.785842086262)*x[2]**o+(-0.375289319286)*x[2]
        s[0,2]=(0.0171536999294)*x[0]**o+(0.187222850003)*x[0]+(0.923344343515)*x[1]**o+(0.919899906728)*x[1]+(0.330573465731)*x[2]**o+(0.12075255513)*x[2]
        s[0,3]=(-0.490667671112)*x[0]**o+(0.4056039259)*x[0]+(-0.955154570277)*x[1]**o+(0.986366754754)*x[1]+(-0.853519593222)*x[2]**o+(-0.825901616105)*x[2]
        s[0,4]=(-0.253213854519)*x[0]**o+(-0.401738411717)*x[0]+(0.872412916488)*x[1]**o+(-0.00224326832344)*x[1]+(0.480217592874)*x[2]**o+(0.144994806066)*x[2]
        s[1,0]=(0.131992177305)*x[0]**o+(0.788963820881)*x[0]+(-0.0198901140504)*x[1]**o+(0.731616952503)*x[1]+(0.59309950089)*x[2]**o+(0.694630924739)*x[2]
        s[1,1]=(0.88075735692)*x[0]**o+(0.678228523078)*x[0]+(-0.682632234228)*x[1]**o+(-0.888294066081)*x[1]+(-0.302130074515)*x[2]**o+(-0.539380276098)*x[2]
        s[1,2]=(0.371868372987)*x[0]**o+(0.287766535066)*x[0]+(0.0885117264942)*x[1]**o+(0.249213255154)*x[1]+(-0.0473853043874)*x[2]**o+(0.345934167493)*x[2]
        s[1,3]=(-0.580406999101)*x[0]**o+(0.762553897732)*x[0]+(0.498019309339)*x[1]**o+(-0.275962658061)*x[1]+(-0.232793721572)*x[2]**o+(-0.404455792741)*x[2]
        s[1,4]=(-0.193670730589)*x[0]**o+(0.107221166466)*x[0]+(-0.253421260284)*x[1]**o+(-0.630230774271)*x[1]+(0.569627074227)*x[2]**o+(-0.471574680318)*x[2]
        s[2,0]=(-0.734235834531)*x[0]**o+(-0.0769718054424)*x[0]+(0.337185508531)*x[1]**o+(-0.695399200032)*x[1]+(0.670045013654)*x[2]**o+(0.602223461093)*x[2]
        s[2,1]=(0.40853552724)*x[0]**o+(-0.109296862931)*x[0]+(-0.898346018309)*x[1]**o+(0.797317601123)*x[1]+(-0.243636906258)*x[2]**o+(-0.7404427898)*x[2]
        s[2,2]=(-0.300099773564)*x[0]**o+(0.391661796552)*x[0]+(0.081340069378)*x[1]**o+(-0.540467785776)*x[1]+(0.609927398687)*x[2]**o+(0.342702876243)*x[2]
        s[2,3]=(-0.795553246099)*x[0]**o+(0.12091791031)*x[0]+(-0.358760047024)*x[1]**o+(0.00992547080721)*x[1]+(-0.776142821278)*x[2]**o+(0.960839850387)*x[2]
        s[2,4]=(0.0312887697988)*x[0]**o+(0.192922412706)*x[0]+(0.930373533919)*x[1]**o+(0.565991224895)*x[1]+(-0.620790693282)*x[2]**o+(-0.0894617381169)*x[2]
        s[3,0]=(0.58118631126)*x[0]**o+(0.0951313787407)*x[0]+(-0.481475099458)*x[1]**o+(-0.844977136281)*x[1]+(-0.505637296865)*x[2]**o+(-0.117240523527)*x[2]
        s[3,1]=(0.0560022697918)*x[0]**o+(-0.667387267392)*x[0]+(0.18270168123)*x[1]**o+(0.820389934276)*x[1]+(0.541891208803)*x[2]**o+(-0.813083374651)*x[2]
        s[3,2]=(-0.217967373894)*x[0]**o+(0.0740362777592)*x[0]+(-0.532958237386)*x[1]**o+(0.254923920582)*x[1]+(0.0983414559274)*x[2]**o+(-0.330473156862)*x[2]
        s[3,3]=(-0.51343561245)*x[0]**o+(-0.314818156795)*x[0]+(0.349539891727)*x[1]**o+(0.182246887466)*x[1]+(0.378368043277)*x[2]**o+(0.394897385803)*x[2]
        s[3,4]=(-0.440074964176)*x[0]**o+(0.644345562557)*x[0]+(0.157396506088)*x[1]**o+(-0.446161901195)*x[1]+(0.0406752725721)*x[2]**o+(0.00497105229147)*x[2]
        ref[0,0]=(0.469846603605)/(o+1.)+(-0.614509873975)+(-0.885439150233)*0.5**o
        ref[0,1]=(1.03735539441)/(o+1.)+(-0.128936257103)+(-0.915950017556)*0.5**o
        ref[0,2]=(1.25391780925)/(o+1.)+(0.613937655931)+(0.0171536999294)*0.5**o
        ref[0,3]=(-1.8086741635)/(o+1.)+(0.283034532275)+(-0.490667671112)*0.5**o
        ref[0,4]=(1.35263050936)/(o+1.)+(-0.129493436987)+(-0.253213854519)*0.5**o
        ref[1,0]=(0.57320938684)/(o+1.)+(1.10760584906)+(0.131992177305)*0.5**o
        ref[1,1]=(-0.984762308743)/(o+1.)+(-0.37472290955)+(0.88075735692)*0.5**o
        ref[1,2]=(0.0411264221069)/(o+1.)+(0.441456978856)+(0.371868372987)*0.5**o
        ref[1,3]=(0.265225587768)/(o+1.)+(0.0410677234649)+(-0.580406999101)*0.5**o
        ref[1,4]=(0.316205813942)/(o+1.)+(-0.497292144061)+(-0.193670730589)*0.5**o
        ref[2,0]=(1.00723052218)/(o+1.)+(-0.0850737721911)+(-0.734235834531)*0.5**o
        ref[2,1]=(-1.14198292457)/(o+1.)+(-0.0262110258043)+(0.40853552724)*0.5**o
        ref[2,2]=(0.691267468065)/(o+1.)+(0.0969484435098)+(-0.300099773564)*0.5**o
        ref[2,3]=(-1.1349028683)/(o+1.)+(0.545841615752)+(-0.795553246099)*0.5**o
        ref[2,4]=(0.309582840637)/(o+1.)+(0.334725949742)+(0.0312887697988)*0.5**o
        ref[3,0]=(-0.987112396323)/(o+1.)+(-0.433543140534)+(0.58118631126)*0.5**o
        ref[3,1]=(0.724592890033)/(o+1.)+(-0.330040353884)+(0.0560022697918)*0.5**o
        ref[3,2]=(-0.434616781458)/(o+1.)+(-0.000756479260437)+(-0.217967373894)*0.5**o
        ref[3,3]=(0.727907935004)/(o+1.)+(0.131163058237)+(-0.51343561245)*0.5**o
        ref[3,4]=(0.19807177866)/(o+1.)+(0.101577356827)+(-0.440074964176)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_FunctionOnContactOne_rank3(self):
      """
      tests integral of rank 3 Symbol on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2))
      s=Data(0,(6, 2, 2),w)
      ref=numarray.zeros((6, 2, 2),numarray.Float)
      if dim==2:
        s[0,0,0]=(-0.0899144489202)*x[0]**o+(-0.939343727238)*x[0]+(-0.838709152888)*x[1]**o+(-0.695938051041)*x[1]
        s[0,0,1]=(0.0915399473414)*x[0]**o+(-0.088933669169)*x[0]+(0.569689228579)*x[1]**o+(0.52563406191)*x[1]
        s[0,1,0]=(-0.0755502530652)*x[0]**o+(0.224201529435)*x[0]+(-0.0936878789524)*x[1]**o+(0.678476395607)*x[1]
        s[0,1,1]=(-0.722700224525)*x[0]**o+(-0.428992070285)*x[0]+(-0.967545686857)*x[1]**o+(0.339344032355)*x[1]
        s[1,0,0]=(-0.807565232378)*x[0]**o+(-0.389243328274)*x[0]+(-0.188155419411)*x[1]**o+(0.801573366554)*x[1]
        s[1,0,1]=(-0.217662099148)*x[0]**o+(0.0709316329807)*x[0]+(0.240070973919)*x[1]**o+(0.0450329893887)*x[1]
        s[1,1,0]=(-0.211774876096)*x[0]**o+(-0.585658640262)*x[0]+(0.772212206058)*x[1]**o+(0.471350730303)*x[1]
        s[1,1,1]=(-0.251097154538)*x[0]**o+(-0.936636380186)*x[0]+(-0.29953620509)*x[1]**o+(-0.7023587162)*x[1]
        s[2,0,0]=(-0.226008179803)*x[0]**o+(0.11175986541)*x[0]+(-0.815791532209)*x[1]**o+(0.661034404078)*x[1]
        s[2,0,1]=(-0.347375034321)*x[0]**o+(-0.38889482021)*x[0]+(-0.298497991695)*x[1]**o+(0.905510136504)*x[1]
        s[2,1,0]=(-0.414130770151)*x[0]**o+(0.00845860563915)*x[0]+(-0.622228227201)*x[1]**o+(0.239872393913)*x[1]
        s[2,1,1]=(0.985892855782)*x[0]**o+(-0.601178096316)*x[0]+(-0.671498979354)*x[1]**o+(0.600179658495)*x[1]
        s[3,0,0]=(-0.547441466002)*x[0]**o+(-0.390199968809)*x[0]+(0.356244378791)*x[1]**o+(-0.91693977081)*x[1]
        s[3,0,1]=(-0.317803998398)*x[0]**o+(-0.212192581141)*x[0]+(0.942307305401)*x[1]**o+(-0.528247885421)*x[1]
        s[3,1,0]=(-0.269300473712)*x[0]**o+(-0.806351998808)*x[0]+(-0.437943014771)*x[1]**o+(0.308252458482)*x[1]
        s[3,1,1]=(0.0826330889069)*x[0]**o+(0.357329175375)*x[0]+(-0.866644131299)*x[1]**o+(-0.993298142744)*x[1]
        s[4,0,0]=(0.478312250921)*x[0]**o+(0.949219183322)*x[0]+(-0.408977166217)*x[1]**o+(0.525189299992)*x[1]
        s[4,0,1]=(-0.221152804907)*x[0]**o+(0.683685107755)*x[0]+(-0.878859546858)*x[1]**o+(0.313936907822)*x[1]
        s[4,1,0]=(-0.361901807816)*x[0]**o+(0.473080571341)*x[0]+(0.0726134206382)*x[1]**o+(-0.552823213053)*x[1]
        s[4,1,1]=(-0.729188028594)*x[0]**o+(0.742375152366)*x[0]+(-0.11559899139)*x[1]**o+(-0.408146075502)*x[1]
        s[5,0,0]=(0.492678269676)*x[0]**o+(0.683105631523)*x[0]+(-0.0108127700464)*x[1]**o+(-0.0516040293712)*x[1]
        s[5,0,1]=(-0.0972486870808)*x[0]**o+(-0.354724382566)*x[0]+(0.383281344894)*x[1]**o+(0.547336907663)*x[1]
        s[5,1,0]=(0.442321568121)*x[0]**o+(-0.776464559839)*x[0]+(0.00851654852488)*x[1]**o+(-0.0830181237664)*x[1]
        s[5,1,1]=(-0.723222258936)*x[0]**o+(-0.294417512199)*x[0]+(-0.141223730539)*x[1]**o+(-0.757548646984)*x[1]
        ref[0,0,0]=(-0.838709152888)/(o+1.)+(-0.81764088914)+(-0.0899144489202)*0.5**o
        ref[0,0,1]=(0.569689228579)/(o+1.)+(0.21835019637)+(0.0915399473414)*0.5**o
        ref[0,1,0]=(-0.0936878789524)/(o+1.)+(0.451338962521)+(-0.0755502530652)*0.5**o
        ref[0,1,1]=(-0.967545686857)/(o+1.)+(-0.0448240189648)+(-0.722700224525)*0.5**o
        ref[1,0,0]=(-0.188155419411)/(o+1.)+(0.20616501914)+(-0.807565232378)*0.5**o
        ref[1,0,1]=(0.240070973919)/(o+1.)+(0.0579823111847)+(-0.217662099148)*0.5**o
        ref[1,1,0]=(0.772212206058)/(o+1.)+(-0.0571539549792)+(-0.211774876096)*0.5**o
        ref[1,1,1]=(-0.29953620509)/(o+1.)+(-0.819497548193)+(-0.251097154538)*0.5**o
        ref[2,0,0]=(-0.815791532209)/(o+1.)+(0.386397134744)+(-0.226008179803)*0.5**o
        ref[2,0,1]=(-0.298497991695)/(o+1.)+(0.258307658147)+(-0.347375034321)*0.5**o
        ref[2,1,0]=(-0.622228227201)/(o+1.)+(0.124165499776)+(-0.414130770151)*0.5**o
        ref[2,1,1]=(-0.671498979354)/(o+1.)+(-0.000499218910338)+(0.985892855782)*0.5**o
        ref[3,0,0]=(0.356244378791)/(o+1.)+(-0.653569869809)+(-0.547441466002)*0.5**o
        ref[3,0,1]=(0.942307305401)/(o+1.)+(-0.370220233281)+(-0.317803998398)*0.5**o
        ref[3,1,0]=(-0.437943014771)/(o+1.)+(-0.249049770163)+(-0.269300473712)*0.5**o
        ref[3,1,1]=(-0.866644131299)/(o+1.)+(-0.317984483685)+(0.0826330889069)*0.5**o
        ref[4,0,0]=(-0.408977166217)/(o+1.)+(0.737204241657)+(0.478312250921)*0.5**o
        ref[4,0,1]=(-0.878859546858)/(o+1.)+(0.498811007788)+(-0.221152804907)*0.5**o
        ref[4,1,0]=(0.0726134206382)/(o+1.)+(-0.0398713208557)+(-0.361901807816)*0.5**o
        ref[4,1,1]=(-0.11559899139)/(o+1.)+(0.167114538432)+(-0.729188028594)*0.5**o
        ref[5,0,0]=(-0.0108127700464)/(o+1.)+(0.315750801076)+(0.492678269676)*0.5**o
        ref[5,0,1]=(0.383281344894)/(o+1.)+(0.0963062625484)+(-0.0972486870808)*0.5**o
        ref[5,1,0]=(0.00851654852488)/(o+1.)+(-0.429741341803)+(0.442321568121)*0.5**o
        ref[5,1,1]=(-0.141223730539)/(o+1.)+(-0.525983079592)+(-0.723222258936)*0.5**o
      else:
        s[0,0,0]=(0.242677714297)*x[0]**o+(-0.400213939273)*x[0]+(0.406302331134)*x[1]**o+(0.0334900110197)*x[1]+(0.386616491205)*x[2]**o+(0.0312866694695)*x[2]
        s[0,0,1]=(-0.656430796333)*x[0]**o+(-0.563403496155)*x[0]+(0.364261714172)*x[1]**o+(0.967871502294)*x[1]+(-0.172721573545)*x[2]**o+(0.338588840536)*x[2]
        s[0,1,0]=(-0.204331459058)*x[0]**o+(-0.445139554107)*x[0]+(0.75436650149)*x[1]**o+(-0.932237793601)*x[1]+(0.767285047485)*x[2]**o+(-0.447011217796)*x[2]
        s[0,1,1]=(0.117575733479)*x[0]**o+(-0.474180475568)*x[0]+(0.259955578397)*x[1]**o+(-0.988666169557)*x[1]+(-0.773227945982)*x[2]**o+(-0.228748677163)*x[2]
        s[1,0,0]=(-0.885708131129)*x[0]**o+(0.255910330816)*x[0]+(-0.160503663494)*x[1]**o+(0.444458737043)*x[1]+(0.501800660641)*x[2]**o+(-0.403629782618)*x[2]
        s[1,0,1]=(-0.302400007694)*x[0]**o+(0.0508740505816)*x[0]+(0.149935410009)*x[1]**o+(-0.333426355106)*x[1]+(-0.83475153405)*x[2]**o+(-0.180357923768)*x[2]
        s[1,1,0]=(0.0405056122891)*x[0]**o+(-0.679078314383)*x[0]+(-0.630686479421)*x[1]**o+(0.882857130415)*x[1]+(-0.880049081361)*x[2]**o+(0.894022667917)*x[2]
        s[1,1,1]=(0.987734368607)*x[0]**o+(0.202787820601)*x[0]+(0.201427368636)*x[1]**o+(-0.888074805769)*x[1]+(-0.00577238788728)*x[2]**o+(-0.852216657415)*x[2]
        s[2,0,0]=(0.0784793303496)*x[0]**o+(0.525537564231)*x[0]+(-0.743068512178)*x[1]**o+(-0.96875188044)*x[1]+(0.598270641364)*x[2]**o+(-0.738260965829)*x[2]
        s[2,0,1]=(0.0371151946549)*x[0]**o+(0.834712924788)*x[0]+(0.831916271847)*x[1]**o+(0.986042089018)*x[1]+(-0.271258489529)*x[2]**o+(-0.0270137352729)*x[2]
        s[2,1,0]=(-0.610486701052)*x[0]**o+(0.747490812106)*x[0]+(-0.137581460043)*x[1]**o+(0.764360090052)*x[1]+(-0.992754974221)*x[2]**o+(-0.170181357609)*x[2]
        s[2,1,1]=(0.0760419308376)*x[0]**o+(-0.610739481473)*x[0]+(0.268671321666)*x[1]**o+(0.556159088599)*x[1]+(0.16105750649)*x[2]**o+(0.168476671552)*x[2]
        s[3,0,0]=(0.332144310632)*x[0]**o+(0.645502258606)*x[0]+(-0.303557252905)*x[1]**o+(-0.992657076111)*x[1]+(-0.367089118757)*x[2]**o+(-0.755868370964)*x[2]
        s[3,0,1]=(-0.538228335462)*x[0]**o+(0.853705065724)*x[0]+(-0.608592283692)*x[1]**o+(0.29533491918)*x[1]+(0.226379502601)*x[2]**o+(-0.20850693991)*x[2]
        s[3,1,0]=(-0.33389690791)*x[0]**o+(-0.804233206619)*x[0]+(0.787650315768)*x[1]**o+(-0.333017031742)*x[1]+(-0.803108583785)*x[2]**o+(-0.450538082625)*x[2]
        s[3,1,1]=(0.491492662254)*x[0]**o+(0.171534400605)*x[0]+(-0.777282924417)*x[1]**o+(-0.572907396269)*x[1]+(0.785138934858)*x[2]**o+(-0.436325021186)*x[2]
        s[4,0,0]=(0.247706032995)*x[0]**o+(0.905275953458)*x[0]+(0.0609169269224)*x[1]**o+(-0.256774805033)*x[1]+(0.998972177574)*x[2]**o+(-0.868940150916)*x[2]
        s[4,0,1]=(0.118732551906)*x[0]**o+(-0.622269538749)*x[0]+(0.118525354684)*x[1]**o+(-0.849217003233)*x[1]+(0.685082692712)*x[2]**o+(-0.230753706424)*x[2]
        s[4,1,0]=(-0.590456775201)*x[0]**o+(0.631958889331)*x[0]+(-0.0714558191005)*x[1]**o+(-0.336225807259)*x[1]+(0.896478419817)*x[2]**o+(0.376282690958)*x[2]
        s[4,1,1]=(0.437488625548)*x[0]**o+(0.883207845535)*x[0]+(0.594979146)*x[1]**o+(-0.627687609281)*x[1]+(0.9812267289)*x[2]**o+(0.571200283614)*x[2]
        s[5,0,0]=(-0.4090238662)*x[0]**o+(-0.712922930229)*x[0]+(-0.356126501112)*x[1]**o+(0.362147566863)*x[1]+(0.164164629436)*x[2]**o+(0.85169934858)*x[2]
        s[5,0,1]=(0.137560590284)*x[0]**o+(0.00568020697538)*x[0]+(-0.176059142701)*x[1]**o+(0.386227905303)*x[1]+(-0.823564872242)*x[2]**o+(-0.956332461174)*x[2]
        s[5,1,0]=(-0.719767553566)*x[0]**o+(-0.595774805843)*x[0]+(-0.783953676642)*x[1]**o+(0.686259147413)*x[1]+(-0.254758248118)*x[2]**o+(0.574267022665)*x[2]
        s[5,1,1]=(-0.321911973511)*x[0]**o+(-0.336478066213)*x[0]+(-0.777795569678)*x[1]**o+(0.896311892021)*x[1]+(-0.516413038874)*x[2]**o+(-0.786093273801)*x[2]
        ref[0,0,0]=(0.792918822339)/(o+1.)+(-0.167718629392)+(0.242677714297)*0.5**o
        ref[0,0,1]=(0.191540140628)/(o+1.)+(0.371528423337)+(-0.656430796333)*0.5**o
        ref[0,1,0]=(1.52165154897)/(o+1.)+(-0.912194282752)+(-0.204331459058)*0.5**o
        ref[0,1,1]=(-0.513272367585)/(o+1.)+(-0.845797661144)+(0.117575733479)*0.5**o
        ref[1,0,0]=(0.341296997147)/(o+1.)+(0.148369642621)+(-0.885708131129)*0.5**o
        ref[1,0,1]=(-0.684816124041)/(o+1.)+(-0.231455114146)+(-0.302400007694)*0.5**o
        ref[1,1,0]=(-1.51073556078)/(o+1.)+(0.548900741975)+(0.0405056122891)*0.5**o
        ref[1,1,1]=(0.195654980748)/(o+1.)+(-0.768751821292)+(0.987734368607)*0.5**o
        ref[2,0,0]=(-0.144797870814)/(o+1.)+(-0.590737641019)+(0.0784793303496)*0.5**o
        ref[2,0,1]=(0.560657782318)/(o+1.)+(0.896870639267)+(0.0371151946549)*0.5**o
        ref[2,1,0]=(-1.13033643426)/(o+1.)+(0.670834772275)+(-0.610486701052)*0.5**o
        ref[2,1,1]=(0.429728828155)/(o+1.)+(0.0569481393388)+(0.0760419308376)*0.5**o
        ref[3,0,0]=(-0.670646371662)/(o+1.)+(-0.551511594234)+(0.332144310632)*0.5**o
        ref[3,0,1]=(-0.382212781091)/(o+1.)+(0.470266522497)+(-0.538228335462)*0.5**o
        ref[3,1,0]=(-0.0154582680178)/(o+1.)+(-0.793894160493)+(-0.33389690791)*0.5**o
        ref[3,1,1]=(0.00785601044065)/(o+1.)+(-0.418849008425)+(0.491492662254)*0.5**o
        ref[4,0,0]=(1.0598891045)/(o+1.)+(-0.110219501245)+(0.247706032995)*0.5**o
        ref[4,0,1]=(0.803608047396)/(o+1.)+(-0.851120124203)+(0.118732551906)*0.5**o
        ref[4,1,0]=(0.825022600717)/(o+1.)+(0.336007886515)+(-0.590456775201)*0.5**o
        ref[4,1,1]=(1.5762058749)/(o+1.)+(0.413360259934)+(0.437488625548)*0.5**o
        ref[5,0,0]=(-0.191961871676)/(o+1.)+(0.250461992607)+(-0.4090238662)*0.5**o
        ref[5,0,1]=(-0.999624014943)/(o+1.)+(-0.282212174448)+(0.137560590284)*0.5**o
        ref[5,1,0]=(-1.03871192476)/(o+1.)+(0.332375682117)+(-0.719767553566)*0.5**o
        ref[5,1,1]=(-1.29420860855)/(o+1.)+(-0.113129723997)+(-0.321911973511)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_integrate_onFunctionOnContactOne_fromSymbol_FunctionOnContactOne_rank4(self):
      """
      tests integral of rank 4 Symbol on the FunctionOnContactOne

      assumptions: FunctionOnContactOne(self.domain) exists
                   self.domain supports integral on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      w=FunctionOnContactOne(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5, 3, 2))
      s=Data(0,(4, 5, 3, 2),w)
      ref=numarray.zeros((4, 5, 3, 2),numarray.Float)
      if dim==2:
        s[0,0,0,0]=(0.245364066984)*x[0]**o+(-0.0501894287161)*x[0]+(0.666238426788)*x[1]**o+(0.136096078492)*x[1]
        s[0,0,0,1]=(0.716203034408)*x[0]**o+(-0.816588231639)*x[0]+(0.800426762254)*x[1]**o+(-0.182765397296)*x[1]
        s[0,0,1,0]=(0.122659986993)*x[0]**o+(-0.00208237425405)*x[0]+(-0.347405577261)*x[1]**o+(0.0376630412624)*x[1]
        s[0,0,1,1]=(0.791965912204)*x[0]**o+(0.935296430194)*x[0]+(0.330494636783)*x[1]**o+(0.990030993503)*x[1]
        s[0,0,2,0]=(0.761523262625)*x[0]**o+(0.47673649822)*x[0]+(-0.814581462689)*x[1]**o+(0.172965644708)*x[1]
        s[0,0,2,1]=(0.384651054435)*x[0]**o+(-0.723316715392)*x[0]+(0.349412253363)*x[1]**o+(-0.687923947756)*x[1]
        s[0,1,0,0]=(0.114523224402)*x[0]**o+(0.0462112886306)*x[0]+(-0.770917205125)*x[1]**o+(-0.251081721462)*x[1]
        s[0,1,0,1]=(0.697263286229)*x[0]**o+(-0.0252158836846)*x[0]+(0.933694211325)*x[1]**o+(0.650498198726)*x[1]
        s[0,1,1,0]=(-0.215924750352)*x[0]**o+(0.97660438665)*x[0]+(0.358477857654)*x[1]**o+(-0.603580756297)*x[1]
        s[0,1,1,1]=(0.642382357196)*x[0]**o+(0.891810567307)*x[0]+(0.839137774823)*x[1]**o+(-0.492580774398)*x[1]
        s[0,1,2,0]=(-0.260657110217)*x[0]**o+(-0.71383748794)*x[0]+(0.846765712381)*x[1]**o+(-0.686699503594)*x[1]
        s[0,1,2,1]=(0.733925405267)*x[0]**o+(-0.318186624057)*x[0]+(-0.690232848808)*x[1]**o+(0.941086052943)*x[1]
        s[0,2,0,0]=(0.230747459963)*x[0]**o+(0.873973601431)*x[0]+(0.0114100757165)*x[1]**o+(-0.172280871128)*x[1]
        s[0,2,0,1]=(0.191593969982)*x[0]**o+(-0.275332585321)*x[0]+(-0.403823163425)*x[1]**o+(0.765493218693)*x[1]
        s[0,2,1,0]=(-0.954865298124)*x[0]**o+(-0.840274453058)*x[0]+(-0.575828297224)*x[1]**o+(0.543288135427)*x[1]
        s[0,2,1,1]=(-0.304205093844)*x[0]**o+(0.366868842463)*x[0]+(0.950680046864)*x[1]**o+(0.644901674439)*x[1]
        s[0,2,2,0]=(-0.46074924128)*x[0]**o+(-0.100058859295)*x[0]+(-0.172613322727)*x[1]**o+(-0.10169890762)*x[1]
        s[0,2,2,1]=(0.119499701836)*x[0]**o+(-0.301349539686)*x[0]+(0.0936397977601)*x[1]**o+(0.361269456081)*x[1]
        s[0,3,0,0]=(-0.525741080321)*x[0]**o+(-0.680808261787)*x[0]+(0.0553816248689)*x[1]**o+(0.478185322022)*x[1]
        s[0,3,0,1]=(-0.241502398998)*x[0]**o+(0.831483674337)*x[0]+(-0.862336855278)*x[1]**o+(0.847378846767)*x[1]
        s[0,3,1,0]=(0.925044786414)*x[0]**o+(-0.20650710731)*x[0]+(-0.459505697865)*x[1]**o+(0.322417326119)*x[1]
        s[0,3,1,1]=(0.571196115307)*x[0]**o+(0.0591802893515)*x[0]+(0.880717796832)*x[1]**o+(0.813021896995)*x[1]
        s[0,3,2,0]=(-0.878805794321)*x[0]**o+(-0.404133715278)*x[0]+(-0.538866339841)*x[1]**o+(-0.51964634727)*x[1]
        s[0,3,2,1]=(0.968894119383)*x[0]**o+(0.535010672206)*x[0]+(-0.543638502129)*x[1]**o+(-0.0775549893758)*x[1]
        s[0,4,0,0]=(-0.473571740079)*x[0]**o+(0.981704155322)*x[0]+(-0.732685132335)*x[1]**o+(0.151201399401)*x[1]
        s[0,4,0,1]=(0.107676577578)*x[0]**o+(-0.0898161469871)*x[0]+(-0.243173822645)*x[1]**o+(0.425562025311)*x[1]
        s[0,4,1,0]=(-0.912740962221)*x[0]**o+(-0.307527338956)*x[0]+(-0.482823172795)*x[1]**o+(-0.836767222685)*x[1]
        s[0,4,1,1]=(-0.106203879274)*x[0]**o+(0.0999297363975)*x[0]+(0.605357795695)*x[1]**o+(-0.864222319735)*x[1]
        s[0,4,2,0]=(0.587529237973)*x[0]**o+(0.140953847793)*x[0]+(0.64759005987)*x[1]**o+(-0.0275484404904)*x[1]
        s[0,4,2,1]=(0.482928938234)*x[0]**o+(0.775154595317)*x[0]+(0.898533268559)*x[1]**o+(-0.238327086159)*x[1]
        s[1,0,0,0]=(-0.574069031279)*x[0]**o+(-0.59623538758)*x[0]+(0.388920605463)*x[1]**o+(-0.994406853141)*x[1]
        s[1,0,0,1]=(0.939040505856)*x[0]**o+(-0.038754823699)*x[0]+(-0.279256974829)*x[1]**o+(-0.890808737563)*x[1]
        s[1,0,1,0]=(-0.944753068273)*x[0]**o+(-0.696943036951)*x[0]+(-0.220060979436)*x[1]**o+(0.223607800841)*x[1]
        s[1,0,1,1]=(-0.390329725129)*x[0]**o+(-0.262404608658)*x[0]+(-0.421100034358)*x[1]**o+(0.922126389343)*x[1]
        s[1,0,2,0]=(-0.7832351829)*x[0]**o+(-0.155019228142)*x[0]+(-0.316428480376)*x[1]**o+(0.604192200421)*x[1]
        s[1,0,2,1]=(0.414384140175)*x[0]**o+(-0.000244010932926)*x[0]+(-0.46577339251)*x[1]**o+(0.869470477908)*x[1]
        s[1,1,0,0]=(-0.571703274446)*x[0]**o+(-0.897490452042)*x[0]+(0.151601513312)*x[1]**o+(-0.820411349281)*x[1]
        s[1,1,0,1]=(0.883610930016)*x[0]**o+(0.430543960795)*x[0]+(0.174748731929)*x[1]**o+(-0.346504921967)*x[1]
        s[1,1,1,0]=(-0.965747586125)*x[0]**o+(0.652587346149)*x[0]+(-0.454627455637)*x[1]**o+(-0.126065048744)*x[1]
        s[1,1,1,1]=(-0.778723024919)*x[0]**o+(-0.352555666852)*x[0]+(0.378393901391)*x[1]**o+(-0.393622640877)*x[1]
        s[1,1,2,0]=(0.785822593379)*x[0]**o+(0.374891382708)*x[0]+(-0.993366900714)*x[1]**o+(-0.406778939882)*x[1]
        s[1,1,2,1]=(0.238887912688)*x[0]**o+(-0.668847103585)*x[0]+(0.422750071837)*x[1]**o+(0.290969707905)*x[1]
        s[1,2,0,0]=(0.306452161355)*x[0]**o+(0.0845930872771)*x[0]+(0.288188272131)*x[1]**o+(0.611272197726)*x[1]
        s[1,2,0,1]=(0.535104365658)*x[0]**o+(-0.868361395667)*x[0]+(-0.557799747963)*x[1]**o+(0.189710523839)*x[1]
        s[1,2,1,0]=(0.653062501973)*x[0]**o+(-0.980469515167)*x[0]+(-0.126034299636)*x[1]**o+(-0.702252714095)*x[1]
        s[1,2,1,1]=(0.193513872604)*x[0]**o+(0.716250857589)*x[0]+(0.532447219707)*x[1]**o+(0.0396611049339)*x[1]
        s[1,2,2,0]=(0.471722480056)*x[0]**o+(-0.386703912908)*x[0]+(0.508907147346)*x[1]**o+(-0.431622849878)*x[1]
        s[1,2,2,1]=(0.145178046285)*x[0]**o+(-0.0110222671767)*x[0]+(-0.793600779578)*x[1]**o+(0.482117912584)*x[1]
        s[1,3,0,0]=(0.883901734656)*x[0]**o+(0.252857222204)*x[0]+(-0.349615695314)*x[1]**o+(-0.831352541736)*x[1]
        s[1,3,0,1]=(-0.439872366735)*x[0]**o+(0.855050596466)*x[0]+(-0.892859579327)*x[1]**o+(-0.499483379044)*x[1]
        s[1,3,1,0]=(-0.310902411804)*x[0]**o+(0.909694833553)*x[0]+(0.432470372195)*x[1]**o+(-0.181254854143)*x[1]
        s[1,3,1,1]=(-0.457038984067)*x[0]**o+(-0.932819775606)*x[0]+(-0.0215549839659)*x[1]**o+(-0.724030992167)*x[1]
        s[1,3,2,0]=(-0.307363570855)*x[0]**o+(-0.53814730682)*x[0]+(-0.0248867951466)*x[1]**o+(0.230518328746)*x[1]
        s[1,3,2,1]=(0.303121965084)*x[0]**o+(-0.493904339796)*x[0]+(0.917168913893)*x[1]**o+(0.169108758838)*x[1]
        s[1,4,0,0]=(-0.713672877707)*x[0]**o+(0.850083130815)*x[0]+(0.859962057023)*x[1]**o+(0.154568816707)*x[1]
        s[1,4,0,1]=(-0.708070236639)*x[0]**o+(0.264936920001)*x[0]+(0.376600276672)*x[1]**o+(0.880588901929)*x[1]
        s[1,4,1,0]=(0.203382859429)*x[0]**o+(0.834221276526)*x[0]+(-0.271980968262)*x[1]**o+(0.840406001263)*x[1]
        s[1,4,1,1]=(-0.610374454703)*x[0]**o+(-0.299939554248)*x[0]+(-0.876972535039)*x[1]**o+(0.613391714781)*x[1]
        s[1,4,2,0]=(-0.131008373859)*x[0]**o+(0.564430441667)*x[0]+(0.512449401496)*x[1]**o+(-0.072742245846)*x[1]
        s[1,4,2,1]=(0.994369815068)*x[0]**o+(0.214403792021)*x[0]+(-0.731489669807)*x[1]**o+(-0.778494326982)*x[1]
        s[2,0,0,0]=(0.687813573864)*x[0]**o+(-0.342489594146)*x[0]+(-0.092041610109)*x[1]**o+(-0.388723275983)*x[1]
        s[2,0,0,1]=(-0.889705548572)*x[0]**o+(-0.962296902814)*x[0]+(0.284484113765)*x[1]**o+(-0.312781157642)*x[1]
        s[2,0,1,0]=(-0.0691392356773)*x[0]**o+(0.391307995277)*x[0]+(-0.343166268962)*x[1]**o+(-0.100528288088)*x[1]
        s[2,0,1,1]=(-0.767504390408)*x[0]**o+(0.44775317228)*x[0]+(0.00928458441193)*x[1]**o+(0.481385818795)*x[1]
        s[2,0,2,0]=(0.151265878662)*x[0]**o+(0.934060057849)*x[0]+(0.772262051249)*x[1]**o+(0.0303447230092)*x[1]
        s[2,0,2,1]=(0.638051378377)*x[0]**o+(0.795393839494)*x[0]+(0.812739684548)*x[1]**o+(0.683335661484)*x[1]
        s[2,1,0,0]=(0.699425983168)*x[0]**o+(-0.113127267833)*x[0]+(0.753464652023)*x[1]**o+(-0.860186623524)*x[1]
        s[2,1,0,1]=(-0.228981326624)*x[0]**o+(-0.144953596548)*x[0]+(-0.028962291177)*x[1]**o+(0.274475259334)*x[1]
        s[2,1,1,0]=(0.436232377097)*x[0]**o+(0.851458153457)*x[0]+(0.449876871146)*x[1]**o+(0.929900037818)*x[1]
        s[2,1,1,1]=(0.108152697095)*x[0]**o+(0.701445596547)*x[0]+(0.857688044529)*x[1]**o+(-0.32024176733)*x[1]
        s[2,1,2,0]=(0.776899779272)*x[0]**o+(-0.77488067334)*x[0]+(0.515979568236)*x[1]**o+(0.60407405593)*x[1]
        s[2,1,2,1]=(0.486236495643)*x[0]**o+(0.759871578074)*x[0]+(0.320690937285)*x[1]**o+(-0.178307017545)*x[1]
        s[2,2,0,0]=(-0.2834031779)*x[0]**o+(-0.99059970496)*x[0]+(-0.951630400835)*x[1]**o+(-0.822318070375)*x[1]
        s[2,2,0,1]=(-0.246680973215)*x[0]**o+(0.895886965624)*x[0]+(0.331676331677)*x[1]**o+(0.275149795318)*x[1]
        s[2,2,1,0]=(0.682460024363)*x[0]**o+(-0.191950621609)*x[0]+(0.998873537117)*x[1]**o+(-0.62286471982)*x[1]
        s[2,2,1,1]=(0.371007993444)*x[0]**o+(0.75354844415)*x[0]+(0.231689506568)*x[1]**o+(0.319850912994)*x[1]
        s[2,2,2,0]=(0.273036358499)*x[0]**o+(-0.365860549733)*x[0]+(-0.255255520802)*x[1]**o+(-0.856177999361)*x[1]
        s[2,2,2,1]=(-0.829888508727)*x[0]**o+(-0.869979484799)*x[0]+(0.0422078078521)*x[1]**o+(-0.225105932622)*x[1]
        s[2,3,0,0]=(-0.901686992463)*x[0]**o+(0.52317892576)*x[0]+(0.450664578307)*x[1]**o+(0.539264486669)*x[1]
        s[2,3,0,1]=(-0.146310214982)*x[0]**o+(-0.866238792091)*x[0]+(-0.411575583885)*x[1]**o+(-0.767910846528)*x[1]
        s[2,3,1,0]=(0.796379240086)*x[0]**o+(-0.941611444233)*x[0]+(0.457329256522)*x[1]**o+(-0.205094413155)*x[1]
        s[2,3,1,1]=(0.00162132693744)*x[0]**o+(0.809781891022)*x[0]+(-0.521975026805)*x[1]**o+(-0.832935611569)*x[1]
        s[2,3,2,0]=(0.85913616245)*x[0]**o+(-0.97226394808)*x[0]+(-0.958220202856)*x[1]**o+(-0.838570412967)*x[1]
        s[2,3,2,1]=(-0.394075398541)*x[0]**o+(0.363958258657)*x[0]+(-0.0245518988658)*x[1]**o+(-0.0641697369324)*x[1]
        s[2,4,0,0]=(0.53874901568)*x[0]**o+(0.381652052125)*x[0]+(-0.569006390059)*x[1]**o+(0.803939044804)*x[1]
        s[2,4,0,1]=(-0.161281051202)*x[0]**o+(-0.29794326221)*x[0]+(-0.975738807839)*x[1]**o+(-0.365943217167)*x[1]
        s[2,4,1,0]=(0.937384486165)*x[0]**o+(-0.111220331573)*x[0]+(-0.705253089868)*x[1]**o+(-0.0964593740972)*x[1]
        s[2,4,1,1]=(-0.801537343551)*x[0]**o+(-0.0721007760916)*x[0]+(-0.858896629841)*x[1]**o+(0.893882022578)*x[1]
        s[2,4,2,0]=(-0.386195011979)*x[0]**o+(-0.7171939977)*x[0]+(-0.291590089274)*x[1]**o+(0.653160575582)*x[1]
        s[2,4,2,1]=(0.15418789046)*x[0]**o+(-0.337070580033)*x[0]+(-0.826397574623)*x[1]**o+(-0.492621231443)*x[1]
        s[3,0,0,0]=(0.208187397837)*x[0]**o+(-0.941176621475)*x[0]+(-0.553746758603)*x[1]**o+(0.298235037771)*x[1]
        s[3,0,0,1]=(-0.608160638828)*x[0]**o+(0.969633806238)*x[0]+(0.594884783145)*x[1]**o+(0.256426888478)*x[1]
        s[3,0,1,0]=(0.156268978359)*x[0]**o+(-0.618114287912)*x[0]+(-0.736845954486)*x[1]**o+(0.578007765377)*x[1]
        s[3,0,1,1]=(0.0779253738219)*x[0]**o+(0.487197266572)*x[0]+(0.712697073421)*x[1]**o+(-0.333683256167)*x[1]
        s[3,0,2,0]=(-0.432372166788)*x[0]**o+(-0.670271358766)*x[0]+(-0.187482013069)*x[1]**o+(0.177483210094)*x[1]
        s[3,0,2,1]=(0.893891903718)*x[0]**o+(0.0668637308586)*x[0]+(-0.434296768839)*x[1]**o+(-0.297584773434)*x[1]
        s[3,1,0,0]=(-0.226039889634)*x[0]**o+(0.0244084275305)*x[0]+(0.0904503965701)*x[1]**o+(0.826411056795)*x[1]
        s[3,1,0,1]=(0.605633212937)*x[0]**o+(0.69508670693)*x[0]+(0.317716807233)*x[1]**o+(-0.71784966885)*x[1]
        s[3,1,1,0]=(0.697916267298)*x[0]**o+(-0.766126387311)*x[0]+(0.679356018736)*x[1]**o+(0.814149484578)*x[1]
        s[3,1,1,1]=(0.495275603887)*x[0]**o+(0.92183314391)*x[0]+(0.0319182837637)*x[1]**o+(0.550197566786)*x[1]
        s[3,1,2,0]=(-0.549402940272)*x[0]**o+(0.16459055678)*x[0]+(0.6282270637)*x[1]**o+(-0.19466468363)*x[1]
        s[3,1,2,1]=(0.722507137464)*x[0]**o+(0.0201257259776)*x[0]+(0.864760483197)*x[1]**o+(-0.70699130253)*x[1]
        s[3,2,0,0]=(-0.911053389534)*x[0]**o+(0.242037718776)*x[0]+(0.296048767645)*x[1]**o+(-0.786412484197)*x[1]
        s[3,2,0,1]=(-0.278556298185)*x[0]**o+(-0.330948724575)*x[0]+(-0.808707884082)*x[1]**o+(0.649152363362)*x[1]
        s[3,2,1,0]=(0.527331068218)*x[0]**o+(0.535793375918)*x[0]+(0.0173164046642)*x[1]**o+(0.673124828911)*x[1]
        s[3,2,1,1]=(-0.122860429792)*x[0]**o+(-0.33128580821)*x[0]+(-0.875323756482)*x[1]**o+(-0.404630192101)*x[1]
        s[3,2,2,0]=(0.396517792786)*x[0]**o+(-0.992046803715)*x[0]+(0.994743180916)*x[1]**o+(-0.355368679756)*x[1]
        s[3,2,2,1]=(0.988551628034)*x[0]**o+(-0.248207320263)*x[0]+(-0.536981937311)*x[1]**o+(-0.832557705835)*x[1]
        s[3,3,0,0]=(-0.687076681329)*x[0]**o+(0.301843762611)*x[0]+(0.0261628413994)*x[1]**o+(0.257680047964)*x[1]
        s[3,3,0,1]=(-0.0679744087296)*x[0]**o+(-0.388391714998)*x[0]+(-0.305536788937)*x[1]**o+(0.813610001342)*x[1]
        s[3,3,1,0]=(0.520286217752)*x[0]**o+(0.787102883932)*x[0]+(-0.443820422756)*x[1]**o+(0.348550770428)*x[1]
        s[3,3,1,1]=(-0.403687854392)*x[0]**o+(0.224198640317)*x[0]+(0.908268189821)*x[1]**o+(-0.0189418862158)*x[1]
        s[3,3,2,0]=(0.106397622508)*x[0]**o+(0.408482462665)*x[0]+(-0.189398394495)*x[1]**o+(0.892444309304)*x[1]
        s[3,3,2,1]=(-0.158875590567)*x[0]**o+(0.659863215048)*x[0]+(-0.116276105024)*x[1]**o+(-0.435483985612)*x[1]
        s[3,4,0,0]=(-0.00526118581715)*x[0]**o+(0.390573315765)*x[0]+(-0.865881629704)*x[1]**o+(0.188788198915)*x[1]
        s[3,4,0,1]=(0.457024238224)*x[0]**o+(-0.142788838274)*x[0]+(0.514831683476)*x[1]**o+(0.645719634512)*x[1]
        s[3,4,1,0]=(-0.221092754553)*x[0]**o+(0.42876217463)*x[0]+(-0.0146700209904)*x[1]**o+(-0.558199901549)*x[1]
        s[3,4,1,1]=(-0.0854320790552)*x[0]**o+(0.495872652018)*x[0]+(-0.307890759071)*x[1]**o+(-0.80450589936)*x[1]
        s[3,4,2,0]=(0.390350106853)*x[0]**o+(-0.469202978344)*x[0]+(0.21377496022)*x[1]**o+(-0.83671140107)*x[1]
        s[3,4,2,1]=(-0.248241865193)*x[0]**o+(-0.0543747795217)*x[0]+(-0.946132717359)*x[1]**o+(0.72654761542)*x[1]
        ref[0,0,0,0]=(0.666238426788)/(o+1.)+(0.0429533248881)+(0.245364066984)*0.5**o
        ref[0,0,0,1]=(0.800426762254)/(o+1.)+(-0.499676814468)+(0.716203034408)*0.5**o
        ref[0,0,1,0]=(-0.347405577261)/(o+1.)+(0.0177903335042)+(0.122659986993)*0.5**o
        ref[0,0,1,1]=(0.330494636783)/(o+1.)+(0.962663711849)+(0.791965912204)*0.5**o
        ref[0,0,2,0]=(-0.814581462689)/(o+1.)+(0.324851071464)+(0.761523262625)*0.5**o
        ref[0,0,2,1]=(0.349412253363)/(o+1.)+(-0.705620331574)+(0.384651054435)*0.5**o
        ref[0,1,0,0]=(-0.770917205125)/(o+1.)+(-0.102435216416)+(0.114523224402)*0.5**o
        ref[0,1,0,1]=(0.933694211325)/(o+1.)+(0.312641157521)+(0.697263286229)*0.5**o
        ref[0,1,1,0]=(0.358477857654)/(o+1.)+(0.186511815176)+(-0.215924750352)*0.5**o
        ref[0,1,1,1]=(0.839137774823)/(o+1.)+(0.199614896454)+(0.642382357196)*0.5**o
        ref[0,1,2,0]=(0.846765712381)/(o+1.)+(-0.700268495767)+(-0.260657110217)*0.5**o
        ref[0,1,2,1]=(-0.690232848808)/(o+1.)+(0.311449714443)+(0.733925405267)*0.5**o
        ref[0,2,0,0]=(0.0114100757165)/(o+1.)+(0.350846365151)+(0.230747459963)*0.5**o
        ref[0,2,0,1]=(-0.403823163425)/(o+1.)+(0.245080316686)+(0.191593969982)*0.5**o
        ref[0,2,1,0]=(-0.575828297224)/(o+1.)+(-0.148493158816)+(-0.954865298124)*0.5**o
        ref[0,2,1,1]=(0.950680046864)/(o+1.)+(0.505885258451)+(-0.304205093844)*0.5**o
        ref[0,2,2,0]=(-0.172613322727)/(o+1.)+(-0.100878883458)+(-0.46074924128)*0.5**o
        ref[0,2,2,1]=(0.0936397977601)/(o+1.)+(0.0299599581971)+(0.119499701836)*0.5**o
        ref[0,3,0,0]=(0.0553816248689)/(o+1.)+(-0.101311469882)+(-0.525741080321)*0.5**o
        ref[0,3,0,1]=(-0.862336855278)/(o+1.)+(0.839431260552)+(-0.241502398998)*0.5**o
        ref[0,3,1,0]=(-0.459505697865)/(o+1.)+(0.0579551094043)+(0.925044786414)*0.5**o
        ref[0,3,1,1]=(0.880717796832)/(o+1.)+(0.436101093173)+(0.571196115307)*0.5**o
        ref[0,3,2,0]=(-0.538866339841)/(o+1.)+(-0.461890031274)+(-0.878805794321)*0.5**o
        ref[0,3,2,1]=(-0.543638502129)/(o+1.)+(0.228727841415)+(0.968894119383)*0.5**o
        ref[0,4,0,0]=(-0.732685132335)/(o+1.)+(0.566452777361)+(-0.473571740079)*0.5**o
        ref[0,4,0,1]=(-0.243173822645)/(o+1.)+(0.167872939162)+(0.107676577578)*0.5**o
        ref[0,4,1,0]=(-0.482823172795)/(o+1.)+(-0.572147280821)+(-0.912740962221)*0.5**o
        ref[0,4,1,1]=(0.605357795695)/(o+1.)+(-0.382146291669)+(-0.106203879274)*0.5**o
        ref[0,4,2,0]=(0.64759005987)/(o+1.)+(0.0567027036512)+(0.587529237973)*0.5**o
        ref[0,4,2,1]=(0.898533268559)/(o+1.)+(0.268413754579)+(0.482928938234)*0.5**o
        ref[1,0,0,0]=(0.388920605463)/(o+1.)+(-0.795321120361)+(-0.574069031279)*0.5**o
        ref[1,0,0,1]=(-0.279256974829)/(o+1.)+(-0.464781780631)+(0.939040505856)*0.5**o
        ref[1,0,1,0]=(-0.220060979436)/(o+1.)+(-0.236667618055)+(-0.944753068273)*0.5**o
        ref[1,0,1,1]=(-0.421100034358)/(o+1.)+(0.329860890342)+(-0.390329725129)*0.5**o
        ref[1,0,2,0]=(-0.316428480376)/(o+1.)+(0.22458648614)+(-0.7832351829)*0.5**o
        ref[1,0,2,1]=(-0.46577339251)/(o+1.)+(0.434613233487)+(0.414384140175)*0.5**o
        ref[1,1,0,0]=(0.151601513312)/(o+1.)+(-0.858950900661)+(-0.571703274446)*0.5**o
        ref[1,1,0,1]=(0.174748731929)/(o+1.)+(0.0420195194137)+(0.883610930016)*0.5**o
        ref[1,1,1,0]=(-0.454627455637)/(o+1.)+(0.263261148702)+(-0.965747586125)*0.5**o
        ref[1,1,1,1]=(0.378393901391)/(o+1.)+(-0.373089153865)+(-0.778723024919)*0.5**o
        ref[1,1,2,0]=(-0.993366900714)/(o+1.)+(-0.0159437785867)+(0.785822593379)*0.5**o
        ref[1,1,2,1]=(0.422750071837)/(o+1.)+(-0.18893869784)+(0.238887912688)*0.5**o
        ref[1,2,0,0]=(0.288188272131)/(o+1.)+(0.347932642501)+(0.306452161355)*0.5**o
        ref[1,2,0,1]=(-0.557799747963)/(o+1.)+(-0.339325435914)+(0.535104365658)*0.5**o
        ref[1,2,1,0]=(-0.126034299636)/(o+1.)+(-0.841361114631)+(0.653062501973)*0.5**o
        ref[1,2,1,1]=(0.532447219707)/(o+1.)+(0.377955981261)+(0.193513872604)*0.5**o
        ref[1,2,2,0]=(0.508907147346)/(o+1.)+(-0.409163381393)+(0.471722480056)*0.5**o
        ref[1,2,2,1]=(-0.793600779578)/(o+1.)+(0.235547822704)+(0.145178046285)*0.5**o
        ref[1,3,0,0]=(-0.349615695314)/(o+1.)+(-0.289247659766)+(0.883901734656)*0.5**o
        ref[1,3,0,1]=(-0.892859579327)/(o+1.)+(0.177783608711)+(-0.439872366735)*0.5**o
        ref[1,3,1,0]=(0.432470372195)/(o+1.)+(0.364219989705)+(-0.310902411804)*0.5**o
        ref[1,3,1,1]=(-0.0215549839659)/(o+1.)+(-0.828425383886)+(-0.457038984067)*0.5**o
        ref[1,3,2,0]=(-0.0248867951466)/(o+1.)+(-0.153814489037)+(-0.307363570855)*0.5**o
        ref[1,3,2,1]=(0.917168913893)/(o+1.)+(-0.162397790479)+(0.303121965084)*0.5**o
        ref[1,4,0,0]=(0.859962057023)/(o+1.)+(0.502325973761)+(-0.713672877707)*0.5**o
        ref[1,4,0,1]=(0.376600276672)/(o+1.)+(0.572762910965)+(-0.708070236639)*0.5**o
        ref[1,4,1,0]=(-0.271980968262)/(o+1.)+(0.837313638895)+(0.203382859429)*0.5**o
        ref[1,4,1,1]=(-0.876972535039)/(o+1.)+(0.156726080267)+(-0.610374454703)*0.5**o
        ref[1,4,2,0]=(0.512449401496)/(o+1.)+(0.245844097911)+(-0.131008373859)*0.5**o
        ref[1,4,2,1]=(-0.731489669807)/(o+1.)+(-0.28204526748)+(0.994369815068)*0.5**o
        ref[2,0,0,0]=(-0.092041610109)/(o+1.)+(-0.365606435065)+(0.687813573864)*0.5**o
        ref[2,0,0,1]=(0.284484113765)/(o+1.)+(-0.637539030228)+(-0.889705548572)*0.5**o
        ref[2,0,1,0]=(-0.343166268962)/(o+1.)+(0.145389853595)+(-0.0691392356773)*0.5**o
        ref[2,0,1,1]=(0.00928458441193)/(o+1.)+(0.464569495537)+(-0.767504390408)*0.5**o
        ref[2,0,2,0]=(0.772262051249)/(o+1.)+(0.482202390429)+(0.151265878662)*0.5**o
        ref[2,0,2,1]=(0.812739684548)/(o+1.)+(0.739364750489)+(0.638051378377)*0.5**o
        ref[2,1,0,0]=(0.753464652023)/(o+1.)+(-0.486656945678)+(0.699425983168)*0.5**o
        ref[2,1,0,1]=(-0.028962291177)/(o+1.)+(0.0647608313931)+(-0.228981326624)*0.5**o
        ref[2,1,1,0]=(0.449876871146)/(o+1.)+(0.890679095638)+(0.436232377097)*0.5**o
        ref[2,1,1,1]=(0.857688044529)/(o+1.)+(0.190601914609)+(0.108152697095)*0.5**o
        ref[2,1,2,0]=(0.515979568236)/(o+1.)+(-0.0854033087054)+(0.776899779272)*0.5**o
        ref[2,1,2,1]=(0.320690937285)/(o+1.)+(0.290782280265)+(0.486236495643)*0.5**o
        ref[2,2,0,0]=(-0.951630400835)/(o+1.)+(-0.906458887668)+(-0.2834031779)*0.5**o
        ref[2,2,0,1]=(0.331676331677)/(o+1.)+(0.585518380471)+(-0.246680973215)*0.5**o
        ref[2,2,1,0]=(0.998873537117)/(o+1.)+(-0.407407670715)+(0.682460024363)*0.5**o
        ref[2,2,1,1]=(0.231689506568)/(o+1.)+(0.536699678572)+(0.371007993444)*0.5**o
        ref[2,2,2,0]=(-0.255255520802)/(o+1.)+(-0.611019274547)+(0.273036358499)*0.5**o
        ref[2,2,2,1]=(0.0422078078521)/(o+1.)+(-0.54754270871)+(-0.829888508727)*0.5**o
        ref[2,3,0,0]=(0.450664578307)/(o+1.)+(0.531221706214)+(-0.901686992463)*0.5**o
        ref[2,3,0,1]=(-0.411575583885)/(o+1.)+(-0.81707481931)+(-0.146310214982)*0.5**o
        ref[2,3,1,0]=(0.457329256522)/(o+1.)+(-0.573352928694)+(0.796379240086)*0.5**o
        ref[2,3,1,1]=(-0.521975026805)/(o+1.)+(-0.0115768602733)+(0.00162132693744)*0.5**o
        ref[2,3,2,0]=(-0.958220202856)/(o+1.)+(-0.905417180523)+(0.85913616245)*0.5**o
        ref[2,3,2,1]=(-0.0245518988658)/(o+1.)+(0.149894260862)+(-0.394075398541)*0.5**o
        ref[2,4,0,0]=(-0.569006390059)/(o+1.)+(0.592795548465)+(0.53874901568)*0.5**o
        ref[2,4,0,1]=(-0.975738807839)/(o+1.)+(-0.331943239689)+(-0.161281051202)*0.5**o
        ref[2,4,1,0]=(-0.705253089868)/(o+1.)+(-0.103839852835)+(0.937384486165)*0.5**o
        ref[2,4,1,1]=(-0.858896629841)/(o+1.)+(0.410890623243)+(-0.801537343551)*0.5**o
        ref[2,4,2,0]=(-0.291590089274)/(o+1.)+(-0.032016711059)+(-0.386195011979)*0.5**o
        ref[2,4,2,1]=(-0.826397574623)/(o+1.)+(-0.414845905738)+(0.15418789046)*0.5**o
        ref[3,0,0,0]=(-0.553746758603)/(o+1.)+(-0.321470791852)+(0.208187397837)*0.5**o
        ref[3,0,0,1]=(0.594884783145)/(o+1.)+(0.613030347358)+(-0.608160638828)*0.5**o
        ref[3,0,1,0]=(-0.736845954486)/(o+1.)+(-0.0200532612677)+(0.156268978359)*0.5**o
        ref[3,0,1,1]=(0.712697073421)/(o+1.)+(0.0767570052027)+(0.0779253738219)*0.5**o
        ref[3,0,2,0]=(-0.187482013069)/(o+1.)+(-0.246394074336)+(-0.432372166788)*0.5**o
        ref[3,0,2,1]=(-0.434296768839)/(o+1.)+(-0.115360521288)+(0.893891903718)*0.5**o
        ref[3,1,0,0]=(0.0904503965701)/(o+1.)+(0.425409742163)+(-0.226039889634)*0.5**o
        ref[3,1,0,1]=(0.317716807233)/(o+1.)+(-0.0113814809604)+(0.605633212937)*0.5**o
        ref[3,1,1,0]=(0.679356018736)/(o+1.)+(0.0240115486338)+(0.697916267298)*0.5**o
        ref[3,1,1,1]=(0.0319182837637)/(o+1.)+(0.736015355348)+(0.495275603887)*0.5**o
        ref[3,1,2,0]=(0.6282270637)/(o+1.)+(-0.015037063425)+(-0.549402940272)*0.5**o
        ref[3,1,2,1]=(0.864760483197)/(o+1.)+(-0.343432788276)+(0.722507137464)*0.5**o
        ref[3,2,0,0]=(0.296048767645)/(o+1.)+(-0.272187382711)+(-0.911053389534)*0.5**o
        ref[3,2,0,1]=(-0.808707884082)/(o+1.)+(0.159101819394)+(-0.278556298185)*0.5**o
        ref[3,2,1,0]=(0.0173164046642)/(o+1.)+(0.604459102415)+(0.527331068218)*0.5**o
        ref[3,2,1,1]=(-0.875323756482)/(o+1.)+(-0.367958000155)+(-0.122860429792)*0.5**o
        ref[3,2,2,0]=(0.994743180916)/(o+1.)+(-0.673707741736)+(0.396517792786)*0.5**o
        ref[3,2,2,1]=(-0.536981937311)/(o+1.)+(-0.540382513049)+(0.988551628034)*0.5**o
        ref[3,3,0,0]=(0.0261628413994)/(o+1.)+(0.279761905288)+(-0.687076681329)*0.5**o
        ref[3,3,0,1]=(-0.305536788937)/(o+1.)+(0.212609143172)+(-0.0679744087296)*0.5**o
        ref[3,3,1,0]=(-0.443820422756)/(o+1.)+(0.56782682718)+(0.520286217752)*0.5**o
        ref[3,3,1,1]=(0.908268189821)/(o+1.)+(0.10262837705)+(-0.403687854392)*0.5**o
        ref[3,3,2,0]=(-0.189398394495)/(o+1.)+(0.650463385984)+(0.106397622508)*0.5**o
        ref[3,3,2,1]=(-0.116276105024)/(o+1.)+(0.112189614718)+(-0.158875590567)*0.5**o
        ref[3,4,0,0]=(-0.865881629704)/(o+1.)+(0.28968075734)+(-0.00526118581715)*0.5**o
        ref[3,4,0,1]=(0.514831683476)/(o+1.)+(0.251465398119)+(0.457024238224)*0.5**o
        ref[3,4,1,0]=(-0.0146700209904)/(o+1.)+(-0.0647188634597)+(-0.221092754553)*0.5**o
        ref[3,4,1,1]=(-0.307890759071)/(o+1.)+(-0.154316623671)+(-0.0854320790552)*0.5**o
        ref[3,4,2,0]=(0.21377496022)/(o+1.)+(-0.652957189707)+(0.390350106853)*0.5**o
        ref[3,4,2,1]=(-0.946132717359)/(o+1.)+(0.336086417949)+(-0.248241865193)*0.5**o
      else:
        s[0,0,0,0]=(-0.210183765573)*x[0]**o+(0.259610104977)*x[0]+(0.840819899605)*x[1]**o+(-0.103339866116)*x[1]+(0.737406932578)*x[2]**o+(0.712156905811)*x[2]
        s[0,0,0,1]=(-0.323968020416)*x[0]**o+(-0.876969115567)*x[0]+(-0.906271643259)*x[1]**o+(-0.366737699368)*x[1]+(0.367538667762)*x[2]**o+(0.80273967237)*x[2]
        s[0,0,1,0]=(0.467518636672)*x[0]**o+(0.684316475842)*x[0]+(-0.948313733183)*x[1]**o+(-0.768576249031)*x[1]+(-0.169935408354)*x[2]**o+(-0.747881358075)*x[2]
        s[0,0,1,1]=(0.976876531867)*x[0]**o+(0.561100376553)*x[0]+(0.450819300656)*x[1]**o+(-0.0490235546318)*x[1]+(-0.698776567424)*x[2]**o+(-0.01350381399)*x[2]
        s[0,0,2,0]=(-0.552336862133)*x[0]**o+(-0.564574791577)*x[0]+(0.95546748665)*x[1]**o+(-0.211505026053)*x[1]+(-0.224770603639)*x[2]**o+(0.498420086189)*x[2]
        s[0,0,2,1]=(0.110734087997)*x[0]**o+(0.256257276464)*x[0]+(-0.682963863817)*x[1]**o+(-0.832585277356)*x[1]+(-0.0216621586129)*x[2]**o+(0.171233268331)*x[2]
        s[0,1,0,0]=(0.979769828626)*x[0]**o+(-0.918534054584)*x[0]+(-0.770334932534)*x[1]**o+(-0.266282551716)*x[1]+(-0.528515244986)*x[2]**o+(0.452232798522)*x[2]
        s[0,1,0,1]=(0.184115163182)*x[0]**o+(0.0372768333589)*x[0]+(0.0697681712771)*x[1]**o+(0.650340145402)*x[1]+(0.89670654092)*x[2]**o+(0.0666608228764)*x[2]
        s[0,1,1,0]=(0.0822751335539)*x[0]**o+(-0.145731529462)*x[0]+(-0.804584197287)*x[1]**o+(-0.367596869981)*x[1]+(-0.819068186934)*x[2]**o+(-0.761154318012)*x[2]
        s[0,1,1,1]=(0.672877076993)*x[0]**o+(-0.060901199793)*x[0]+(-0.334248974895)*x[1]**o+(-0.872695915274)*x[1]+(0.246713393819)*x[2]**o+(-0.819057815971)*x[2]
        s[0,1,2,0]=(0.968772211014)*x[0]**o+(0.71842819735)*x[0]+(-0.0772702390821)*x[1]**o+(-0.338266585527)*x[1]+(-0.506850093136)*x[2]**o+(0.707040138867)*x[2]
        s[0,1,2,1]=(-0.804147712129)*x[0]**o+(0.48962140515)*x[0]+(-0.247303878423)*x[1]**o+(0.889311125721)*x[1]+(0.457530011837)*x[2]**o+(-0.721486338348)*x[2]
        s[0,2,0,0]=(0.140474174736)*x[0]**o+(-0.0453977330632)*x[0]+(0.9083497372)*x[1]**o+(-0.719356277596)*x[1]+(0.72748037113)*x[2]**o+(-0.0518197409882)*x[2]
        s[0,2,0,1]=(-0.0758350230998)*x[0]**o+(-0.367910921003)*x[0]+(-0.118137700915)*x[1]**o+(0.620139843753)*x[1]+(0.648111986033)*x[2]**o+(-0.250478603635)*x[2]
        s[0,2,1,0]=(0.128776260898)*x[0]**o+(0.772839138201)*x[0]+(0.667219128346)*x[1]**o+(-0.291604907274)*x[1]+(0.976574302911)*x[2]**o+(-0.60715514616)*x[2]
        s[0,2,1,1]=(-0.85960053799)*x[0]**o+(0.421741754709)*x[0]+(0.137156504307)*x[1]**o+(0.31044942099)*x[1]+(-0.0607312333184)*x[2]**o+(-0.371068928897)*x[2]
        s[0,2,2,0]=(0.703498831008)*x[0]**o+(0.351119263938)*x[0]+(0.0238555242548)*x[1]**o+(0.709263994991)*x[1]+(-0.822927451312)*x[2]**o+(0.289556375179)*x[2]
        s[0,2,2,1]=(-0.285309117139)*x[0]**o+(0.13890400764)*x[0]+(-0.604129730872)*x[1]**o+(-0.0821311416855)*x[1]+(-0.731018609109)*x[2]**o+(0.529525274631)*x[2]
        s[0,3,0,0]=(0.641292392051)*x[0]**o+(0.41865118466)*x[0]+(0.963763232952)*x[1]**o+(0.290032616399)*x[1]+(-0.506676751351)*x[2]**o+(-0.895169772311)*x[2]
        s[0,3,0,1]=(-0.616101594244)*x[0]**o+(0.791759779662)*x[0]+(0.690427410929)*x[1]**o+(0.970117852706)*x[1]+(-0.813314826297)*x[2]**o+(0.637157627363)*x[2]
        s[0,3,1,0]=(0.973134693253)*x[0]**o+(-0.294894425912)*x[0]+(-0.342056908291)*x[1]**o+(-0.569749335695)*x[1]+(0.402640595819)*x[2]**o+(0.132057879818)*x[2]
        s[0,3,1,1]=(-0.785989986755)*x[0]**o+(-0.319383158643)*x[0]+(0.875111156622)*x[1]**o+(0.607783276248)*x[1]+(0.522924160022)*x[2]**o+(-0.963598048032)*x[2]
        s[0,3,2,0]=(0.367812735951)*x[0]**o+(-0.687977977398)*x[0]+(-0.787244484503)*x[1]**o+(0.240728636869)*x[1]+(-0.974034052698)*x[2]**o+(-0.810505857708)*x[2]
        s[0,3,2,1]=(-0.661827774609)*x[0]**o+(0.569720489249)*x[0]+(-0.0944794378735)*x[1]**o+(-0.793223846926)*x[1]+(0.54128448366)*x[2]**o+(-0.893409198606)*x[2]
        s[0,4,0,0]=(0.259245470871)*x[0]**o+(-0.226239257386)*x[0]+(-0.308196311787)*x[1]**o+(-0.23628967322)*x[1]+(0.547994188289)*x[2]**o+(-0.671911794405)*x[2]
        s[0,4,0,1]=(-0.00101716691769)*x[0]**o+(-0.509353224753)*x[0]+(0.592369934948)*x[1]**o+(-0.632019867229)*x[1]+(-0.890240436074)*x[2]**o+(0.895675476663)*x[2]
        s[0,4,1,0]=(0.960337962272)*x[0]**o+(0.555794125077)*x[0]+(0.993174576462)*x[1]**o+(-0.772336499274)*x[1]+(0.0103297090652)*x[2]**o+(0.118606584111)*x[2]
        s[0,4,1,1]=(0.0420511106146)*x[0]**o+(-0.758220545738)*x[0]+(-0.119140693961)*x[1]**o+(0.0775988947583)*x[1]+(0.828731522222)*x[2]**o+(-0.762715251326)*x[2]
        s[0,4,2,0]=(0.549182098853)*x[0]**o+(0.36156976435)*x[0]+(-0.152823474029)*x[1]**o+(-0.315519239615)*x[1]+(0.577553409367)*x[2]**o+(0.467722402358)*x[2]
        s[0,4,2,1]=(0.117551959782)*x[0]**o+(0.850326589959)*x[0]+(0.881226923201)*x[1]**o+(-0.659482296116)*x[1]+(0.618324879901)*x[2]**o+(0.720404333688)*x[2]
        s[1,0,0,0]=(-0.761147885924)*x[0]**o+(0.802435468296)*x[0]+(0.794658337218)*x[1]**o+(0.0458609096746)*x[1]+(0.603568994654)*x[2]**o+(-0.543591666298)*x[2]
        s[1,0,0,1]=(-0.568265516859)*x[0]**o+(-0.217464502958)*x[0]+(0.945091213325)*x[1]**o+(0.701546510287)*x[1]+(0.218015344978)*x[2]**o+(-0.296437711896)*x[2]
        s[1,0,1,0]=(0.131167263333)*x[0]**o+(0.443503731963)*x[0]+(0.936129884208)*x[1]**o+(0.731105012686)*x[1]+(0.886062834899)*x[2]**o+(0.949880973913)*x[2]
        s[1,0,1,1]=(-0.324713526984)*x[0]**o+(0.525830634904)*x[0]+(0.258554314238)*x[1]**o+(-0.206218826462)*x[1]+(0.945107982827)*x[2]**o+(0.301738246936)*x[2]
        s[1,0,2,0]=(-0.0983483498843)*x[0]**o+(-0.107666500098)*x[0]+(0.572563468846)*x[1]**o+(-0.877027769074)*x[1]+(0.0499191410048)*x[2]**o+(0.78320557846)*x[2]
        s[1,0,2,1]=(-0.0549251955703)*x[0]**o+(-0.684098254591)*x[0]+(0.974543898137)*x[1]**o+(0.572617020679)*x[1]+(-0.745704992018)*x[2]**o+(0.694741262801)*x[2]
        s[1,1,0,0]=(0.140734267352)*x[0]**o+(0.684555621818)*x[0]+(-0.988693128074)*x[1]**o+(0.663988019213)*x[1]+(0.207716488749)*x[2]**o+(-0.218440531714)*x[2]
        s[1,1,0,1]=(0.906718149076)*x[0]**o+(-0.823295142671)*x[0]+(0.599921015401)*x[1]**o+(0.712671366397)*x[1]+(0.560173956846)*x[2]**o+(-0.583700172601)*x[2]
        s[1,1,1,0]=(0.412161237427)*x[0]**o+(0.449013323323)*x[0]+(-0.422313884483)*x[1]**o+(-0.856352846316)*x[1]+(-0.131018950683)*x[2]**o+(-0.113127977867)*x[2]
        s[1,1,1,1]=(0.342974599199)*x[0]**o+(0.918991859784)*x[0]+(-0.380736598315)*x[1]**o+(-0.844001076048)*x[1]+(0.103584145435)*x[2]**o+(-0.0224438802577)*x[2]
        s[1,1,2,0]=(0.405298238411)*x[0]**o+(-0.0260196814125)*x[0]+(0.192953354082)*x[1]**o+(-0.768884750367)*x[1]+(-0.898989048123)*x[2]**o+(-0.625718514351)*x[2]
        s[1,1,2,1]=(-0.679709121137)*x[0]**o+(0.829310202601)*x[0]+(0.488556797655)*x[1]**o+(-0.546577821454)*x[1]+(0.215139403299)*x[2]**o+(-0.597837941999)*x[2]
        s[1,2,0,0]=(-0.763765181249)*x[0]**o+(0.471498461874)*x[0]+(-0.0657374404825)*x[1]**o+(-0.990465192866)*x[1]+(0.755407325384)*x[2]**o+(-0.725455335361)*x[2]
        s[1,2,0,1]=(-0.707293534802)*x[0]**o+(0.741579146085)*x[0]+(-0.827571233981)*x[1]**o+(-0.924507469851)*x[1]+(-0.11981466602)*x[2]**o+(-0.227349968773)*x[2]
        s[1,2,1,0]=(0.02761949765)*x[0]**o+(0.23242129234)*x[0]+(-0.744337789362)*x[1]**o+(-0.69986289257)*x[1]+(0.284991295889)*x[2]**o+(-0.82971704627)*x[2]
        s[1,2,1,1]=(-0.399349607364)*x[0]**o+(0.681805497713)*x[0]+(0.50892365528)*x[1]**o+(-0.24206992271)*x[1]+(-0.864035697056)*x[2]**o+(0.311678612996)*x[2]
        s[1,2,2,0]=(0.900552977578)*x[0]**o+(0.352782843752)*x[0]+(0.343335797615)*x[1]**o+(0.12459367011)*x[1]+(-0.78722966105)*x[2]**o+(0.0289887373712)*x[2]
        s[1,2,2,1]=(-0.231556056016)*x[0]**o+(-0.454277914592)*x[0]+(-0.723413876928)*x[1]**o+(-0.167712035756)*x[1]+(0.297646282013)*x[2]**o+(0.142123612721)*x[2]
        s[1,3,0,0]=(-0.753062984495)*x[0]**o+(0.834144701924)*x[0]+(0.198694009378)*x[1]**o+(-0.522412387399)*x[1]+(-0.823293930133)*x[2]**o+(-0.875699299314)*x[2]
        s[1,3,0,1]=(0.810523164741)*x[0]**o+(-0.363171422715)*x[0]+(-0.0125819806617)*x[1]**o+(-0.461550939044)*x[1]+(-0.0610628843793)*x[2]**o+(0.792146078844)*x[2]
        s[1,3,1,0]=(-0.435427701923)*x[0]**o+(0.0485485027059)*x[0]+(-0.533976468056)*x[1]**o+(0.907837942847)*x[1]+(-0.70993588953)*x[2]**o+(0.707193663015)*x[2]
        s[1,3,1,1]=(-0.647252848948)*x[0]**o+(0.889142781795)*x[0]+(-0.625573458304)*x[1]**o+(0.40306299061)*x[1]+(0.0918220173097)*x[2]**o+(0.563306928169)*x[2]
        s[1,3,2,0]=(-0.607331889118)*x[0]**o+(0.812730322666)*x[0]+(0.555953335767)*x[1]**o+(0.661784189166)*x[1]+(0.391287509324)*x[2]**o+(-0.916911048454)*x[2]
        s[1,3,2,1]=(-0.484392978469)*x[0]**o+(-0.541102106822)*x[0]+(-0.245428871935)*x[1]**o+(0.278664918051)*x[1]+(-0.955672198176)*x[2]**o+(-0.548226453411)*x[2]
        s[1,4,0,0]=(0.503702684537)*x[0]**o+(0.233988182801)*x[0]+(-0.093833060394)*x[1]**o+(-0.167779518637)*x[1]+(-0.224463708091)*x[2]**o+(-0.710844655028)*x[2]
        s[1,4,0,1]=(0.255645379803)*x[0]**o+(-0.319588660935)*x[0]+(-0.156476801364)*x[1]**o+(0.764377089178)*x[1]+(0.766935604368)*x[2]**o+(-0.157460600111)*x[2]
        s[1,4,1,0]=(0.15831529726)*x[0]**o+(-0.922418423102)*x[0]+(0.561598779551)*x[1]**o+(-0.745598205601)*x[1]+(-0.694388851252)*x[2]**o+(-0.247051354544)*x[2]
        s[1,4,1,1]=(-0.547080506797)*x[0]**o+(-0.814888293172)*x[0]+(0.122207354764)*x[1]**o+(-0.489157382765)*x[1]+(-0.165490463352)*x[2]**o+(-0.114446229543)*x[2]
        s[1,4,2,0]=(-0.369250635169)*x[0]**o+(0.423782722049)*x[0]+(0.968680330397)*x[1]**o+(0.28815964147)*x[1]+(-0.143666599619)*x[2]**o+(0.499469160546)*x[2]
        s[1,4,2,1]=(0.843010459592)*x[0]**o+(0.676625633805)*x[0]+(-0.635607829653)*x[1]**o+(-0.760424296046)*x[1]+(0.457005234774)*x[2]**o+(-0.102642224679)*x[2]
        s[2,0,0,0]=(-0.416783290665)*x[0]**o+(-0.0326686788419)*x[0]+(-0.144394865356)*x[1]**o+(-0.911119053945)*x[1]+(-0.55810658213)*x[2]**o+(0.40998976988)*x[2]
        s[2,0,0,1]=(0.513962651738)*x[0]**o+(-0.998965858933)*x[0]+(0.917310302297)*x[1]**o+(-0.92170256086)*x[1]+(-0.832148513501)*x[2]**o+(-0.551050270978)*x[2]
        s[2,0,1,0]=(0.431543077341)*x[0]**o+(0.042920807321)*x[0]+(-0.143174202064)*x[1]**o+(0.90359005289)*x[1]+(-0.732368795811)*x[2]**o+(-0.0689734110721)*x[2]
        s[2,0,1,1]=(-0.167337582492)*x[0]**o+(-0.685847720118)*x[0]+(-0.574599145898)*x[1]**o+(0.685408949158)*x[1]+(0.583748780479)*x[2]**o+(0.494510625069)*x[2]
        s[2,0,2,0]=(0.76364604242)*x[0]**o+(-0.432951084836)*x[0]+(0.425205211657)*x[1]**o+(-0.879037059825)*x[1]+(-0.013713147532)*x[2]**o+(0.569703973439)*x[2]
        s[2,0,2,1]=(-0.656200752037)*x[0]**o+(0.0808097604648)*x[0]+(0.503360202878)*x[1]**o+(0.487461964251)*x[1]+(-0.405721164154)*x[2]**o+(0.126364295441)*x[2]
        s[2,1,0,0]=(-0.168286367707)*x[0]**o+(0.497189264604)*x[0]+(0.309898214306)*x[1]**o+(-0.51880727488)*x[1]+(0.518790399303)*x[2]**o+(0.401150188648)*x[2]
        s[2,1,0,1]=(0.573088756891)*x[0]**o+(-0.528498236574)*x[0]+(-0.866435772203)*x[1]**o+(-0.0338712475717)*x[1]+(0.869338257704)*x[2]**o+(0.276166855245)*x[2]
        s[2,1,1,0]=(-0.200994668199)*x[0]**o+(-0.227638621809)*x[0]+(-0.243755130686)*x[1]**o+(0.983124311993)*x[1]+(0.834307124674)*x[2]**o+(0.191048093109)*x[2]
        s[2,1,1,1]=(0.423677882618)*x[0]**o+(0.451735240848)*x[0]+(0.417686763179)*x[1]**o+(0.766280670471)*x[1]+(-0.829023066103)*x[2]**o+(-0.780956171089)*x[2]
        s[2,1,2,0]=(0.640928997042)*x[0]**o+(0.671670205561)*x[0]+(0.14746453586)*x[1]**o+(-0.744942640395)*x[1]+(0.936412384681)*x[2]**o+(-0.797412536669)*x[2]
        s[2,1,2,1]=(-0.730418336064)*x[0]**o+(-0.912540120589)*x[0]+(0.31782754852)*x[1]**o+(-0.476487014675)*x[1]+(-0.166085203325)*x[2]**o+(-0.592216218131)*x[2]
        s[2,2,0,0]=(0.373430973034)*x[0]**o+(-0.569005417932)*x[0]+(0.33244882787)*x[1]**o+(-0.348297838584)*x[1]+(-0.903746783477)*x[2]**o+(0.976129823909)*x[2]
        s[2,2,0,1]=(-0.384047362737)*x[0]**o+(-0.268433421634)*x[0]+(-0.838287069736)*x[1]**o+(0.537590839064)*x[1]+(-0.871855225879)*x[2]**o+(0.772511342839)*x[2]
        s[2,2,1,0]=(-0.978119189005)*x[0]**o+(-0.121978949728)*x[0]+(-0.329862921919)*x[1]**o+(-0.709859714296)*x[1]+(0.330028081384)*x[2]**o+(-0.0970288297589)*x[2]
        s[2,2,1,1]=(-0.666661297789)*x[0]**o+(-0.480759645285)*x[0]+(-0.344863683771)*x[1]**o+(0.385174072898)*x[1]+(-0.40458447828)*x[2]**o+(0.81018598482)*x[2]
        s[2,2,2,0]=(-0.419553660247)*x[0]**o+(-0.96154803369)*x[0]+(-0.979914830867)*x[1]**o+(0.802474237871)*x[1]+(-0.273952110245)*x[2]**o+(-0.273921739584)*x[2]
        s[2,2,2,1]=(0.204828260085)*x[0]**o+(-0.207525741758)*x[0]+(-0.157511344538)*x[1]**o+(-0.242922426999)*x[1]+(0.750045639114)*x[2]**o+(0.625828940704)*x[2]
        s[2,3,0,0]=(-0.433426692328)*x[0]**o+(0.546111969738)*x[0]+(0.380856694436)*x[1]**o+(-0.33958919138)*x[1]+(-0.612713564248)*x[2]**o+(-0.468136706051)*x[2]
        s[2,3,0,1]=(-0.753353152037)*x[0]**o+(0.898355698117)*x[0]+(-0.748796477533)*x[1]**o+(-0.84014959853)*x[1]+(0.00222130390134)*x[2]**o+(0.892747426493)*x[2]
        s[2,3,1,0]=(-0.770467840127)*x[0]**o+(-0.365528437394)*x[0]+(0.823481948409)*x[1]**o+(0.688841559491)*x[1]+(0.399335743364)*x[2]**o+(-0.11069734561)*x[2]
        s[2,3,1,1]=(-0.490969508319)*x[0]**o+(0.516182950326)*x[0]+(-0.729563968179)*x[1]**o+(-0.738386155156)*x[1]+(0.646183209813)*x[2]**o+(0.319822004437)*x[2]
        s[2,3,2,0]=(-0.719374773896)*x[0]**o+(0.227265715278)*x[0]+(-0.378942759956)*x[1]**o+(-0.0227600257348)*x[1]+(-0.319915586734)*x[2]**o+(0.901101476715)*x[2]
        s[2,3,2,1]=(-0.514878672798)*x[0]**o+(-0.496279665164)*x[0]+(0.301404632426)*x[1]**o+(0.408945490654)*x[1]+(0.993826467678)*x[2]**o+(0.466263681916)*x[2]
        s[2,4,0,0]=(0.163562057356)*x[0]**o+(0.653997800691)*x[0]+(0.0851835561474)*x[1]**o+(0.940843692093)*x[1]+(0.047617990547)*x[2]**o+(-0.859043423533)*x[2]
        s[2,4,0,1]=(0.634549693325)*x[0]**o+(0.914675769662)*x[0]+(-0.172241120744)*x[1]**o+(0.534043363834)*x[1]+(-0.655408958703)*x[2]**o+(0.688624822376)*x[2]
        s[2,4,1,0]=(0.330425495069)*x[0]**o+(0.686177305834)*x[0]+(0.752515146248)*x[1]**o+(-0.552696418525)*x[1]+(-0.955945706288)*x[2]**o+(0.470133484592)*x[2]
        s[2,4,1,1]=(0.106341453568)*x[0]**o+(-0.531668585129)*x[0]+(-0.520032286959)*x[1]**o+(-0.738038080149)*x[1]+(0.525162627468)*x[2]**o+(-0.655104090288)*x[2]
        s[2,4,2,0]=(0.994443804198)*x[0]**o+(0.510472126015)*x[0]+(0.902454289513)*x[1]**o+(-0.191032483827)*x[1]+(-0.871408191409)*x[2]**o+(0.547124971054)*x[2]
        s[2,4,2,1]=(0.113561397179)*x[0]**o+(-0.505522632919)*x[0]+(0.30818367646)*x[1]**o+(-0.00465438758811)*x[1]+(0.594009196981)*x[2]**o+(-0.226939247299)*x[2]
        s[3,0,0,0]=(-0.463635004027)*x[0]**o+(-0.473760265395)*x[0]+(0.878709353532)*x[1]**o+(0.0947459582975)*x[1]+(0.0219625500089)*x[2]**o+(0.784199705647)*x[2]
        s[3,0,0,1]=(0.676123626258)*x[0]**o+(-0.718629965972)*x[0]+(0.955205674618)*x[1]**o+(0.706290464564)*x[1]+(-0.604943464128)*x[2]**o+(0.694623387198)*x[2]
        s[3,0,1,0]=(-0.304361833494)*x[0]**o+(-0.658618417297)*x[0]+(0.171679811142)*x[1]**o+(0.995668711479)*x[1]+(-0.0331315333318)*x[2]**o+(-0.425870682329)*x[2]
        s[3,0,1,1]=(0.307231747905)*x[0]**o+(0.0052926672705)*x[0]+(-0.0603771488434)*x[1]**o+(0.201207904112)*x[1]+(0.769253259019)*x[2]**o+(0.809891168107)*x[2]
        s[3,0,2,0]=(-0.130591836024)*x[0]**o+(-0.0929104424471)*x[0]+(0.702701120328)*x[1]**o+(0.79105646679)*x[1]+(0.279504582566)*x[2]**o+(-0.0685634410467)*x[2]
        s[3,0,2,1]=(-0.576303721224)*x[0]**o+(0.996201825902)*x[0]+(0.415602469244)*x[1]**o+(-0.51130556243)*x[1]+(0.924720232267)*x[2]**o+(-0.653996834451)*x[2]
        s[3,1,0,0]=(-0.798641869619)*x[0]**o+(-0.474090853446)*x[0]+(-0.597109245363)*x[1]**o+(0.441151246969)*x[1]+(-0.460726722134)*x[2]**o+(0.129538461429)*x[2]
        s[3,1,0,1]=(-0.00692013378255)*x[0]**o+(0.12877226476)*x[0]+(-0.357533404018)*x[1]**o+(-0.389134623739)*x[1]+(0.0387875396629)*x[2]**o+(-0.81001355285)*x[2]
        s[3,1,1,0]=(0.975364017255)*x[0]**o+(0.0184628364974)*x[0]+(0.738788422118)*x[1]**o+(-0.897723661125)*x[1]+(0.342855398212)*x[2]**o+(0.766278709935)*x[2]
        s[3,1,1,1]=(0.103423718636)*x[0]**o+(0.264183054502)*x[0]+(-0.413231981251)*x[1]**o+(0.50816929065)*x[1]+(0.717301020458)*x[2]**o+(0.863858366933)*x[2]
        s[3,1,2,0]=(0.0547068997542)*x[0]**o+(-0.0697197526742)*x[0]+(0.560106582056)*x[1]**o+(0.914213149957)*x[1]+(-0.357975004563)*x[2]**o+(0.138675813902)*x[2]
        s[3,1,2,1]=(0.236730250658)*x[0]**o+(0.835033750765)*x[0]+(-0.408412262014)*x[1]**o+(0.707762870875)*x[1]+(-0.381638364848)*x[2]**o+(-0.237912635268)*x[2]
        s[3,2,0,0]=(0.388806525405)*x[0]**o+(0.434371077714)*x[0]+(-0.637939265061)*x[1]**o+(0.869903625445)*x[1]+(0.751102627943)*x[2]**o+(-0.591787739898)*x[2]
        s[3,2,0,1]=(-0.328460151904)*x[0]**o+(-0.469089195258)*x[0]+(0.189752113153)*x[1]**o+(-0.223739735753)*x[1]+(0.90243464478)*x[2]**o+(0.393444417035)*x[2]
        s[3,2,1,0]=(-0.350954406466)*x[0]**o+(0.222756398721)*x[0]+(0.881035791552)*x[1]**o+(-0.601290867644)*x[1]+(-0.845027376811)*x[2]**o+(-0.658344721797)*x[2]
        s[3,2,1,1]=(-0.804545424944)*x[0]**o+(0.723106876602)*x[0]+(-0.710610485987)*x[1]**o+(0.616671752141)*x[1]+(0.255075132475)*x[2]**o+(-0.344194652837)*x[2]
        s[3,2,2,0]=(0.867664525177)*x[0]**o+(-0.584510407392)*x[0]+(-0.50466882786)*x[1]**o+(-0.976134817563)*x[1]+(-0.0741803228365)*x[2]**o+(-0.816773953701)*x[2]
        s[3,2,2,1]=(0.997671019163)*x[0]**o+(-0.0614667721506)*x[0]+(-0.978519383696)*x[1]**o+(0.0645671450044)*x[1]+(0.465596917785)*x[2]**o+(-0.279520773991)*x[2]
        s[3,3,0,0]=(-0.564960743631)*x[0]**o+(0.923212123601)*x[0]+(0.42281995555)*x[1]**o+(-0.701296001463)*x[1]+(0.791187577221)*x[2]**o+(-0.665209151969)*x[2]
        s[3,3,0,1]=(0.872459084593)*x[0]**o+(-0.14974585293)*x[0]+(0.257403669429)*x[1]**o+(-0.236794230318)*x[1]+(-0.458881609061)*x[2]**o+(0.614204776708)*x[2]
        s[3,3,1,0]=(-0.256375661857)*x[0]**o+(-0.0451909988296)*x[0]+(-0.38620807221)*x[1]**o+(0.905631567256)*x[1]+(-0.293636725178)*x[2]**o+(-0.522921339974)*x[2]
        s[3,3,1,1]=(-0.649399488997)*x[0]**o+(-0.92131361011)*x[0]+(0.228306527968)*x[1]**o+(0.914959459994)*x[1]+(-0.689881365519)*x[2]**o+(0.769874183342)*x[2]
        s[3,3,2,0]=(0.237419242359)*x[0]**o+(-0.578361971709)*x[0]+(-0.63121773371)*x[1]**o+(0.446149460264)*x[1]+(-0.975635743387)*x[2]**o+(-0.0926780614368)*x[2]
        s[3,3,2,1]=(0.898298006002)*x[0]**o+(0.738210632094)*x[0]+(0.954104559567)*x[1]**o+(-0.0586956189155)*x[1]+(-0.197544744403)*x[2]**o+(-0.458321606749)*x[2]
        s[3,4,0,0]=(0.152469131812)*x[0]**o+(0.636503984792)*x[0]+(0.634624949432)*x[1]**o+(-0.191145041451)*x[1]+(-0.586391727404)*x[2]**o+(0.470501756725)*x[2]
        s[3,4,0,1]=(-0.902280446763)*x[0]**o+(0.276584347986)*x[0]+(0.627059019624)*x[1]**o+(0.256966014366)*x[1]+(0.993138399883)*x[2]**o+(0.444820746069)*x[2]
        s[3,4,1,0]=(0.226692588742)*x[0]**o+(-0.462068747651)*x[0]+(0.243555291569)*x[1]**o+(-0.913735726033)*x[1]+(0.149578352207)*x[2]**o+(-0.330136710272)*x[2]
        s[3,4,1,1]=(0.99435141349)*x[0]**o+(0.0799718813232)*x[0]+(0.191619055132)*x[1]**o+(0.85076051922)*x[1]+(0.111360148299)*x[2]**o+(-0.683082083045)*x[2]
        s[3,4,2,0]=(-0.574679864968)*x[0]**o+(-0.836650014193)*x[0]+(-0.548132149017)*x[1]**o+(-0.255129120741)*x[1]+(0.639700961749)*x[2]**o+(0.932732223318)*x[2]
        s[3,4,2,1]=(0.670125652473)*x[0]**o+(-0.717633581197)*x[0]+(-0.908717470386)*x[1]**o+(0.420401361995)*x[1]+(-0.93231135796)*x[2]**o+(0.820828865038)*x[2]
        ref[0,0,0,0]=(1.57822683218)/(o+1.)+(0.434213572336)+(-0.210183765573)*0.5**o
        ref[0,0,0,1]=(-0.538732975497)/(o+1.)+(-0.220483571283)+(-0.323968020416)*0.5**o
        ref[0,0,1,0]=(-1.11824914154)/(o+1.)+(-0.416070565632)+(0.467518636672)*0.5**o
        ref[0,0,1,1]=(-0.247957266768)/(o+1.)+(0.249286503966)+(0.976876531867)*0.5**o
        ref[0,0,2,0]=(0.730696883011)/(o+1.)+(-0.13882986572)+(-0.552336862133)*0.5**o
        ref[0,0,2,1]=(-0.70462602243)/(o+1.)+(-0.20254736628)+(0.110734087997)*0.5**o
        ref[0,1,0,0]=(-1.29885017752)/(o+1.)+(-0.366291903889)+(0.979769828626)*0.5**o
        ref[0,1,0,1]=(0.966474712198)/(o+1.)+(0.377138900819)+(0.184115163182)*0.5**o
        ref[0,1,1,0]=(-1.62365238422)/(o+1.)+(-0.637241358728)+(0.0822751335539)*0.5**o
        ref[0,1,1,1]=(-0.0875355810752)/(o+1.)+(-0.876327465519)+(0.672877076993)*0.5**o
        ref[0,1,2,0]=(-0.584120332218)/(o+1.)+(0.543600875345)+(0.968772211014)*0.5**o
        ref[0,1,2,1]=(0.210226133414)/(o+1.)+(0.328723096261)+(-0.804147712129)*0.5**o
        ref[0,2,0,0]=(1.63583010833)/(o+1.)+(-0.408286875823)+(0.140474174736)*0.5**o
        ref[0,2,0,1]=(0.529974285118)/(o+1.)+(0.000875159557622)+(-0.0758350230998)*0.5**o
        ref[0,2,1,0]=(1.64379343126)/(o+1.)+(-0.0629604576161)+(0.128776260898)*0.5**o
        ref[0,2,1,1]=(0.0764252709887)/(o+1.)+(0.180561123401)+(-0.85960053799)*0.5**o
        ref[0,2,2,0]=(-0.799071927058)/(o+1.)+(0.674969817054)+(0.703498831008)*0.5**o
        ref[0,2,2,1]=(-1.33514833998)/(o+1.)+(0.293149070293)+(-0.285309117139)*0.5**o
        ref[0,3,0,0]=(0.457086481601)/(o+1.)+(-0.0932429856258)+(0.641292392051)*0.5**o
        ref[0,3,0,1]=(-0.122887415369)/(o+1.)+(1.19951762987)+(-0.616101594244)*0.5**o
        ref[0,3,1,0]=(0.0605836875282)/(o+1.)+(-0.366292940894)+(0.973134693253)*0.5**o
        ref[0,3,1,1]=(1.39803531664)/(o+1.)+(-0.337598965213)+(-0.785989986755)*0.5**o
        ref[0,3,2,0]=(-1.7612785372)/(o+1.)+(-0.628877599118)+(0.367812735951)*0.5**o
        ref[0,3,2,1]=(0.446805045787)/(o+1.)+(-0.558456278141)+(-0.661827774609)*0.5**o
        ref[0,4,0,0]=(0.239797876502)/(o+1.)+(-0.567220362506)+(0.259245470871)*0.5**o
        ref[0,4,0,1]=(-0.297870501125)/(o+1.)+(-0.12284880766)+(-0.00101716691769)*0.5**o
        ref[0,4,1,0]=(1.00350428553)/(o+1.)+(-0.0489678950431)+(0.960337962272)*0.5**o
        ref[0,4,1,1]=(0.709590828261)/(o+1.)+(-0.721668451153)+(0.0420511106146)*0.5**o
        ref[0,4,2,0]=(0.424729935338)/(o+1.)+(0.256886463547)+(0.549182098853)*0.5**o
        ref[0,4,2,1]=(1.4995518031)/(o+1.)+(0.455624313765)+(0.117551959782)*0.5**o
        ref[1,0,0,0]=(1.39822733187)/(o+1.)+(0.152352355836)+(-0.761147885924)*0.5**o
        ref[1,0,0,1]=(1.1631065583)/(o+1.)+(0.0938221477164)+(-0.568265516859)*0.5**o
        ref[1,0,1,0]=(1.82219271911)/(o+1.)+(1.06224485928)+(0.131167263333)*0.5**o
        ref[1,0,1,1]=(1.20366229707)/(o+1.)+(0.310675027689)+(-0.324713526984)*0.5**o
        ref[1,0,2,0]=(0.622482609851)/(o+1.)+(-0.100744345356)+(-0.0983483498843)*0.5**o
        ref[1,0,2,1]=(0.228838906118)/(o+1.)+(0.291630014445)+(-0.0549251955703)*0.5**o
        ref[1,1,0,0]=(-0.780976639325)/(o+1.)+(0.565051554659)+(0.140734267352)*0.5**o
        ref[1,1,0,1]=(1.16009497225)/(o+1.)+(-0.347161974437)+(0.906718149076)*0.5**o
        ref[1,1,1,0]=(-0.553332835166)/(o+1.)+(-0.26023375043)+(0.412161237427)*0.5**o
        ref[1,1,1,1]=(-0.277152452881)/(o+1.)+(0.026273451739)+(0.342974599199)*0.5**o
        ref[1,1,2,0]=(-0.706035694041)/(o+1.)+(-0.710311473065)+(0.405298238411)*0.5**o
        ref[1,1,2,1]=(0.703696200954)/(o+1.)+(-0.157552780426)+(-0.679709121137)*0.5**o
        ref[1,2,0,0]=(0.689669884901)/(o+1.)+(-0.622211033177)+(-0.763765181249)*0.5**o
        ref[1,2,0,1]=(-0.947385900002)/(o+1.)+(-0.20513914627)+(-0.707293534802)*0.5**o
        ref[1,2,1,0]=(-0.459346493473)/(o+1.)+(-0.64857932325)+(0.02761949765)*0.5**o
        ref[1,2,1,1]=(-0.355112041776)/(o+1.)+(0.375707094)+(-0.399349607364)*0.5**o
        ref[1,2,2,0]=(-0.443893863435)/(o+1.)+(0.253182625616)+(0.900552977578)*0.5**o
        ref[1,2,2,1]=(-0.425767594915)/(o+1.)+(-0.239933168814)+(-0.231556056016)*0.5**o
        ref[1,3,0,0]=(-0.624599920754)/(o+1.)+(-0.281983492394)+(-0.753062984495)*0.5**o
        ref[1,3,0,1]=(-0.073644865041)/(o+1.)+(-0.0162881414573)+(0.810523164741)*0.5**o
        ref[1,3,1,0]=(-1.24391235759)/(o+1.)+(0.831790054284)+(-0.435427701923)*0.5**o
        ref[1,3,1,1]=(-0.533751440995)/(o+1.)+(0.927756350287)+(-0.647252848948)*0.5**o
        ref[1,3,2,0]=(0.94724084509)/(o+1.)+(0.278801731688)+(-0.607331889118)*0.5**o
        ref[1,3,2,1]=(-1.20110107011)/(o+1.)+(-0.405331821091)+(-0.484392978469)*0.5**o
        ref[1,4,0,0]=(-0.318296768485)/(o+1.)+(-0.322317995432)+(0.503702684537)*0.5**o
        ref[1,4,0,1]=(0.610458803004)/(o+1.)+(0.143663914066)+(0.255645379803)*0.5**o
        ref[1,4,1,0]=(-0.1327900717)/(o+1.)+(-0.957533991624)+(0.15831529726)*0.5**o
        ref[1,4,1,1]=(-0.0432831085882)/(o+1.)+(-0.70924595274)+(-0.547080506797)*0.5**o
        ref[1,4,2,0]=(0.825013730779)/(o+1.)+(0.605705762033)+(-0.369250635169)*0.5**o
        ref[1,4,2,1]=(-0.17860259488)/(o+1.)+(-0.09322044346)+(0.843010459592)*0.5**o
        ref[2,0,0,0]=(-0.702501447486)/(o+1.)+(-0.266898981454)+(-0.416783290665)*0.5**o
        ref[2,0,0,1]=(0.0851617887959)/(o+1.)+(-1.23585934539)+(0.513962651738)*0.5**o
        ref[2,0,1,0]=(-0.875542997875)/(o+1.)+(0.43876872457)+(0.431543077341)*0.5**o
        ref[2,0,1,1]=(0.00914963458101)/(o+1.)+(0.247035927055)+(-0.167337582492)*0.5**o
        ref[2,0,2,0]=(0.411492064125)/(o+1.)+(-0.371142085611)+(0.76364604242)*0.5**o
        ref[2,0,2,1]=(0.0976390387239)/(o+1.)+(0.347318010078)+(-0.656200752037)*0.5**o
        ref[2,1,0,0]=(0.828688613609)/(o+1.)+(0.189766089186)+(-0.168286367707)*0.5**o
        ref[2,1,0,1]=(0.00290248550037)/(o+1.)+(-0.143101314451)+(0.573088756891)*0.5**o
        ref[2,1,1,0]=(0.590551993988)/(o+1.)+(0.473266891646)+(-0.200994668199)*0.5**o
        ref[2,1,1,1]=(-0.411336302924)/(o+1.)+(0.218529870115)+(0.423677882618)*0.5**o
        ref[2,1,2,0]=(1.08387692054)/(o+1.)+(-0.435342485751)+(0.640928997042)*0.5**o
        ref[2,1,2,1]=(0.151742345195)/(o+1.)+(-0.990621676697)+(-0.730418336064)*0.5**o
        ref[2,2,0,0]=(-0.571297955608)/(o+1.)+(0.0294132836968)+(0.373430973034)*0.5**o
        ref[2,2,0,1]=(-1.71014229561)/(o+1.)+(0.520834380134)+(-0.384047362737)*0.5**o
        ref[2,2,1,0]=(0.000165159465638)/(o+1.)+(-0.464433746891)+(-0.978119189005)*0.5**o
        ref[2,2,1,1]=(-0.749448162051)/(o+1.)+(0.357300206217)+(-0.666661297789)*0.5**o
        ref[2,2,2,0]=(-1.25386694111)/(o+1.)+(-0.216497767701)+(-0.419553660247)*0.5**o
        ref[2,2,2,1]=(0.592534294577)/(o+1.)+(0.0876903859733)+(0.204828260085)*0.5**o
        ref[2,3,0,0]=(-0.231856869811)/(o+1.)+(-0.130806963846)+(-0.433426692328)*0.5**o
        ref[2,3,0,1]=(-0.746575173632)/(o+1.)+(0.47547676304)+(-0.753353152037)*0.5**o
        ref[2,3,1,0]=(1.22281769177)/(o+1.)+(0.106307888243)+(-0.770467840127)*0.5**o
        ref[2,3,1,1]=(-0.0833807583658)/(o+1.)+(0.0488093998039)+(-0.490969508319)*0.5**o
        ref[2,3,2,0]=(-0.69885834669)/(o+1.)+(0.552803583129)+(-0.719374773896)*0.5**o
        ref[2,3,2,1]=(1.2952311001)/(o+1.)+(0.189464753703)+(-0.514878672798)*0.5**o
        ref[2,4,0,0]=(0.132801546694)/(o+1.)+(0.367899034626)+(0.163562057356)*0.5**o
        ref[2,4,0,1]=(-0.827650079446)/(o+1.)+(1.06867197794)+(0.634549693325)*0.5**o
        ref[2,4,1,0]=(-0.20343056004)/(o+1.)+(0.301807185951)+(0.330425495069)*0.5**o
        ref[2,4,1,1]=(0.00513034050895)/(o+1.)+(-0.962405377783)+(0.106341453568)*0.5**o
        ref[2,4,2,0]=(0.0310460981037)/(o+1.)+(0.433282306621)+(0.994443804198)*0.5**o
        ref[2,4,2,1]=(0.902192873442)/(o+1.)+(-0.368558133903)+(0.113561397179)*0.5**o
        ref[3,0,0,0]=(0.900671903541)/(o+1.)+(0.202592699275)+(-0.463635004027)*0.5**o
        ref[3,0,0,1]=(0.35026221049)/(o+1.)+(0.341141942895)+(0.676123626258)*0.5**o
        ref[3,0,1,0]=(0.138548277811)/(o+1.)+(-0.0444101940734)+(-0.304361833494)*0.5**o
        ref[3,0,1,1]=(0.708876110175)/(o+1.)+(0.508195869745)+(0.307231747905)*0.5**o
        ref[3,0,2,0]=(0.982205702893)/(o+1.)+(0.314791291648)+(-0.130591836024)*0.5**o
        ref[3,0,2,1]=(1.34032270151)/(o+1.)+(-0.0845502854893)+(-0.576303721224)*0.5**o
        ref[3,1,0,0]=(-1.0578359675)/(o+1.)+(0.0482994274758)+(-0.798641869619)*0.5**o
        ref[3,1,0,1]=(-0.318745864355)/(o+1.)+(-0.535187955914)+(-0.00692013378255)*0.5**o
        ref[3,1,1,0]=(1.08164382033)/(o+1.)+(-0.0564910573463)+(0.975364017255)*0.5**o
        ref[3,1,1,1]=(0.304069039206)/(o+1.)+(0.818105356043)+(0.103423718636)*0.5**o
        ref[3,1,2,0]=(0.202131577493)/(o+1.)+(0.491584605592)+(0.0547068997542)*0.5**o
        ref[3,1,2,1]=(-0.790050626862)/(o+1.)+(0.652441993186)+(0.236730250658)*0.5**o
        ref[3,2,0,0]=(0.113163362881)/(o+1.)+(0.356243481631)+(0.388806525405)*0.5**o
        ref[3,2,0,1]=(1.09218675793)/(o+1.)+(-0.149692256988)+(-0.328460151904)*0.5**o
        ref[3,2,1,0]=(0.0360084147411)/(o+1.)+(-0.51843959536)+(-0.350954406466)*0.5**o
        ref[3,2,1,1]=(-0.455535353512)/(o+1.)+(0.497791987953)+(-0.804545424944)*0.5**o
        ref[3,2,2,0]=(-0.578849150697)/(o+1.)+(-1.18870958933)+(0.867664525177)*0.5**o
        ref[3,2,2,1]=(-0.51292246591)/(o+1.)+(-0.138210200569)+(0.997671019163)*0.5**o
        ref[3,3,0,0]=(1.21400753277)/(o+1.)+(-0.221646514915)+(-0.564960743631)*0.5**o
        ref[3,3,0,1]=(-0.201477939631)/(o+1.)+(0.113832346729)+(0.872459084593)*0.5**o
        ref[3,3,1,0]=(-0.679844797388)/(o+1.)+(0.168759614226)+(-0.256375661857)*0.5**o
        ref[3,3,1,1]=(-0.461574837551)/(o+1.)+(0.381760016613)+(-0.649399488997)*0.5**o
        ref[3,3,2,0]=(-1.6068534771)/(o+1.)+(-0.112445286441)+(0.237419242359)*0.5**o
        ref[3,3,2,1]=(0.756559815164)/(o+1.)+(0.110596703215)+(0.898298006002)*0.5**o
        ref[3,4,0,0]=(0.0482332220277)/(o+1.)+(0.457930350033)+(0.152469131812)*0.5**o
        ref[3,4,0,1]=(1.62019741951)/(o+1.)+(0.48918555421)+(-0.902280446763)*0.5**o
        ref[3,4,1,0]=(0.393133643776)/(o+1.)+(-0.852970591978)+(0.226692588742)*0.5**o
        ref[3,4,1,1]=(0.30297920343)/(o+1.)+(0.123825158749)+(0.99435141349)*0.5**o
        ref[3,4,2,0]=(0.0915688127321)/(o+1.)+(-0.0795234558081)+(-0.574679864968)*0.5**o
        ref[3,4,2,1]=(-1.84102882835)/(o+1.)+(0.261798322918)+(0.670125652473)*0.5**o
      res=integrate(arg)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5, 3, 2),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.260967575068)*x[0]**o+(-0.456559015376)*x[0]+(0.663023090785)*x[1]**o+(-0.000383723402374)*x[1]
        ref[0]=o*(0.260967575068)*x_ref[0]**(o-1)+(-0.456559015376)
        ref[1]=o*(0.663023090785)*x_ref[1]**(o-1)+(-0.000383723402374)
      else:
        arg=(-0.679453642968)*x[0]**o+(-0.836558889087)*x[0]+(0.938200435255)*x[1]**o+(-0.368159735907)*x[1]+(-0.0546850112561)*x[2]**o+(0.931986983035)*x[2]
        ref[0]=o*(-0.679453642968)*x_ref[0]**(o-1)+(-0.836558889087)
        ref[1]=o*(0.938200435255)*x_ref[1]**(o-1)+(-0.368159735907)
        ref[2]=o*(-0.0546850112561)*x_ref[2]**(o-1)+(0.931986983035)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(0.221278607378)*x[0]**o+(-0.25051444588)*x[0]+(0.752161895582)*x[1]**o+(0.662434618125)*x[1]
        arg[1]=(0.984829669888)*x[0]**o+(0.00500258390598)*x[0]+(-0.292523259369)*x[1]**o+(-0.238277884466)*x[1]
        ref[0,0]=o*(0.221278607378)*x_ref[0]**(o-1)+(-0.25051444588)
        ref[0,1]=o*(0.752161895582)*x_ref[1]**(o-1)+(0.662434618125)
        ref[1,0]=o*(0.984829669888)*x_ref[0]**(o-1)+(0.00500258390598)
        ref[1,1]=o*(-0.292523259369)*x_ref[1]**(o-1)+(-0.238277884466)
      else:
        arg[0]=(0.815886350601)*x[0]**o+(-0.41721938077)*x[0]+(0.478358181839)*x[1]**o+(-0.458860964588)*x[1]+(0.575706872631)*x[2]**o+(-0.965426161177)*x[2]
        arg[1]=(-0.159203003073)*x[0]**o+(-0.985356409774)*x[0]+(0.504125935966)*x[1]**o+(0.703505637664)*x[1]+(-0.480016288837)*x[2]**o+(0.544400209204)*x[2]
        ref[0,0]=o*(0.815886350601)*x_ref[0]**(o-1)+(-0.41721938077)
        ref[0,1]=o*(0.478358181839)*x_ref[1]**(o-1)+(-0.458860964588)
        ref[0,2]=o*(0.575706872631)*x_ref[2]**(o-1)+(-0.965426161177)
        ref[1,0]=o*(-0.159203003073)*x_ref[0]**(o-1)+(-0.985356409774)
        ref[1,1]=o*(0.504125935966)*x_ref[1]**(o-1)+(0.703505637664)
        ref[1,2]=o*(-0.480016288837)*x_ref[2]**(o-1)+(0.544400209204)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(-0.722004066753)*x[0]**o+(-0.911439550186)*x[0]+(0.0793361579222)*x[1]**o+(0.958526722957)*x[1]
        arg[0,1]=(-0.0237328054252)*x[0]**o+(0.832621528642)*x[0]+(0.168484408262)*x[1]**o+(-0.181293214021)*x[1]
        arg[0,2]=(0.0284992392733)*x[0]**o+(0.884411090784)*x[0]+(-0.615596355135)*x[1]**o+(-0.564819619851)*x[1]
        arg[0,3]=(0.37408647134)*x[0]**o+(-0.177901551674)*x[0]+(-0.466165048356)*x[1]**o+(-0.278511961588)*x[1]
        arg[0,4]=(-0.24695435531)*x[0]**o+(-0.624082916034)*x[0]+(-0.343849543401)*x[1]**o+(0.661610450445)*x[1]
        arg[1,0]=(-0.176271330569)*x[0]**o+(-0.661612282712)*x[0]+(-0.937163166613)*x[1]**o+(0.376473179587)*x[1]
        arg[1,1]=(0.964111839461)*x[0]**o+(0.576837069403)*x[0]+(-0.718562476684)*x[1]**o+(0.154883495525)*x[1]
        arg[1,2]=(-0.771556809734)*x[0]**o+(0.720054023732)*x[0]+(-0.390732462938)*x[1]**o+(-0.484359019049)*x[1]
        arg[1,3]=(0.565910084656)*x[0]**o+(0.69105192657)*x[0]+(-0.449408955892)*x[1]**o+(-0.789780518242)*x[1]
        arg[1,4]=(0.602485034177)*x[0]**o+(-0.345139282323)*x[0]+(-0.951334152921)*x[1]**o+(-0.478700081579)*x[1]
        arg[2,0]=(0.00114729937901)*x[0]**o+(0.295356090995)*x[0]+(0.982261544035)*x[1]**o+(0.357076141518)*x[1]
        arg[2,1]=(0.653029330145)*x[0]**o+(-0.0178804068723)*x[0]+(-0.0238303862422)*x[1]**o+(0.983033975535)*x[1]
        arg[2,2]=(0.680878878444)*x[0]**o+(-0.404330541218)*x[0]+(0.856544883866)*x[1]**o+(0.71899071821)*x[1]
        arg[2,3]=(0.0674687202072)*x[0]**o+(-0.748990717637)*x[0]+(0.185597242309)*x[1]**o+(0.623849127358)*x[1]
        arg[2,4]=(0.302869699915)*x[0]**o+(-0.852621552847)*x[0]+(0.115557112172)*x[1]**o+(-0.0827214208715)*x[1]
        arg[3,0]=(0.0929072570643)*x[0]**o+(0.533152382923)*x[0]+(-0.0913754984708)*x[1]**o+(-0.25865969337)*x[1]
        arg[3,1]=(-0.794799886368)*x[0]**o+(-0.865263962776)*x[0]+(0.441343356932)*x[1]**o+(-0.541975483415)*x[1]
        arg[3,2]=(0.261341948686)*x[0]**o+(0.378142729621)*x[0]+(0.0556054089673)*x[1]**o+(-0.854195169318)*x[1]
        arg[3,3]=(0.177222467454)*x[0]**o+(-0.400820197499)*x[0]+(0.88513075927)*x[1]**o+(0.0420082325044)*x[1]
        arg[3,4]=(0.307178422145)*x[0]**o+(-0.203765349758)*x[0]+(-0.546052990937)*x[1]**o+(-0.960312136292)*x[1]
        ref[0,0,0]=o*(-0.722004066753)*x_ref[0]**(o-1)+(-0.911439550186)
        ref[0,0,1]=o*(0.0793361579222)*x_ref[1]**(o-1)+(0.958526722957)
        ref[0,1,0]=o*(-0.0237328054252)*x_ref[0]**(o-1)+(0.832621528642)
        ref[0,1,1]=o*(0.168484408262)*x_ref[1]**(o-1)+(-0.181293214021)
        ref[0,2,0]=o*(0.0284992392733)*x_ref[0]**(o-1)+(0.884411090784)
        ref[0,2,1]=o*(-0.615596355135)*x_ref[1]**(o-1)+(-0.564819619851)
        ref[0,3,0]=o*(0.37408647134)*x_ref[0]**(o-1)+(-0.177901551674)
        ref[0,3,1]=o*(-0.466165048356)*x_ref[1]**(o-1)+(-0.278511961588)
        ref[0,4,0]=o*(-0.24695435531)*x_ref[0]**(o-1)+(-0.624082916034)
        ref[0,4,1]=o*(-0.343849543401)*x_ref[1]**(o-1)+(0.661610450445)
        ref[1,0,0]=o*(-0.176271330569)*x_ref[0]**(o-1)+(-0.661612282712)
        ref[1,0,1]=o*(-0.937163166613)*x_ref[1]**(o-1)+(0.376473179587)
        ref[1,1,0]=o*(0.964111839461)*x_ref[0]**(o-1)+(0.576837069403)
        ref[1,1,1]=o*(-0.718562476684)*x_ref[1]**(o-1)+(0.154883495525)
        ref[1,2,0]=o*(-0.771556809734)*x_ref[0]**(o-1)+(0.720054023732)
        ref[1,2,1]=o*(-0.390732462938)*x_ref[1]**(o-1)+(-0.484359019049)
        ref[1,3,0]=o*(0.565910084656)*x_ref[0]**(o-1)+(0.69105192657)
        ref[1,3,1]=o*(-0.449408955892)*x_ref[1]**(o-1)+(-0.789780518242)
        ref[1,4,0]=o*(0.602485034177)*x_ref[0]**(o-1)+(-0.345139282323)
        ref[1,4,1]=o*(-0.951334152921)*x_ref[1]**(o-1)+(-0.478700081579)
        ref[2,0,0]=o*(0.00114729937901)*x_ref[0]**(o-1)+(0.295356090995)
        ref[2,0,1]=o*(0.982261544035)*x_ref[1]**(o-1)+(0.357076141518)
        ref[2,1,0]=o*(0.653029330145)*x_ref[0]**(o-1)+(-0.0178804068723)
        ref[2,1,1]=o*(-0.0238303862422)*x_ref[1]**(o-1)+(0.983033975535)
        ref[2,2,0]=o*(0.680878878444)*x_ref[0]**(o-1)+(-0.404330541218)
        ref[2,2,1]=o*(0.856544883866)*x_ref[1]**(o-1)+(0.71899071821)
        ref[2,3,0]=o*(0.0674687202072)*x_ref[0]**(o-1)+(-0.748990717637)
        ref[2,3,1]=o*(0.185597242309)*x_ref[1]**(o-1)+(0.623849127358)
        ref[2,4,0]=o*(0.302869699915)*x_ref[0]**(o-1)+(-0.852621552847)
        ref[2,4,1]=o*(0.115557112172)*x_ref[1]**(o-1)+(-0.0827214208715)
        ref[3,0,0]=o*(0.0929072570643)*x_ref[0]**(o-1)+(0.533152382923)
        ref[3,0,1]=o*(-0.0913754984708)*x_ref[1]**(o-1)+(-0.25865969337)
        ref[3,1,0]=o*(-0.794799886368)*x_ref[0]**(o-1)+(-0.865263962776)
        ref[3,1,1]=o*(0.441343356932)*x_ref[1]**(o-1)+(-0.541975483415)
        ref[3,2,0]=o*(0.261341948686)*x_ref[0]**(o-1)+(0.378142729621)
        ref[3,2,1]=o*(0.0556054089673)*x_ref[1]**(o-1)+(-0.854195169318)
        ref[3,3,0]=o*(0.177222467454)*x_ref[0]**(o-1)+(-0.400820197499)
        ref[3,3,1]=o*(0.88513075927)*x_ref[1]**(o-1)+(0.0420082325044)
        ref[3,4,0]=o*(0.307178422145)*x_ref[0]**(o-1)+(-0.203765349758)
        ref[3,4,1]=o*(-0.546052990937)*x_ref[1]**(o-1)+(-0.960312136292)
      else:
        arg[0,0]=(0.767891828291)*x[0]**o+(-0.0840162180616)*x[0]+(-0.942354055114)*x[1]**o+(-0.458324281794)*x[1]+(-0.837589052489)*x[2]**o+(-0.49741065871)*x[2]
        arg[0,1]=(-0.770574732815)*x[0]**o+(0.949362675967)*x[0]+(0.334062389906)*x[1]**o+(0.589134582043)*x[1]+(0.611876443107)*x[2]**o+(-0.476746595186)*x[2]
        arg[0,2]=(-0.113076234857)*x[0]**o+(0.207116555982)*x[0]+(-0.434423505296)*x[1]**o+(0.582451788291)*x[1]+(-0.858451242875)*x[2]**o+(-0.229934112115)*x[2]
        arg[0,3]=(0.55494281628)*x[0]**o+(0.53116989281)*x[0]+(0.150549353151)*x[1]**o+(0.70886785918)*x[1]+(-0.148436740612)*x[2]**o+(0.755584812901)*x[2]
        arg[0,4]=(0.0855991607862)*x[0]**o+(0.509120320151)*x[0]+(-0.303374431746)*x[1]**o+(0.1813545791)*x[1]+(-0.0434667822132)*x[2]**o+(0.395447849194)*x[2]
        arg[1,0]=(-0.779720617706)*x[0]**o+(0.730668258583)*x[0]+(-0.0315884698035)*x[1]**o+(-0.0929845369431)*x[1]+(0.0853332239352)*x[2]**o+(0.303372304789)*x[2]
        arg[1,1]=(-0.687021672626)*x[0]**o+(-0.380139153436)*x[0]+(-0.624774641851)*x[1]**o+(0.331833510141)*x[1]+(-0.747115143343)*x[2]**o+(-0.901384102505)*x[2]
        arg[1,2]=(-0.0528543338921)*x[0]**o+(-0.683764012224)*x[0]+(0.498886779776)*x[1]**o+(-0.396777215862)*x[1]+(0.777051418657)*x[2]**o+(-0.786345142641)*x[2]
        arg[1,3]=(-0.823112017253)*x[0]**o+(0.278818264102)*x[0]+(-0.79372160065)*x[1]**o+(0.254044599609)*x[1]+(-0.372925254827)*x[2]**o+(-0.85054008508)*x[2]
        arg[1,4]=(-0.247156845703)*x[0]**o+(-0.944335229412)*x[0]+(-0.572532409179)*x[1]**o+(0.289091364421)*x[1]+(0.848874739954)*x[2]**o+(0.705098999827)*x[2]
        arg[2,0]=(0.0958493700534)*x[0]**o+(-0.334070579338)*x[0]+(-0.74117408785)*x[1]**o+(0.0609646344894)*x[1]+(-0.328888690751)*x[2]**o+(-0.0430772626841)*x[2]
        arg[2,1]=(0.846871401827)*x[0]**o+(0.379912211333)*x[0]+(-0.197881866966)*x[1]**o+(-0.551498190852)*x[1]+(0.416977164384)*x[2]**o+(0.09398324743)*x[2]
        arg[2,2]=(0.737261473925)*x[0]**o+(0.696028328637)*x[0]+(-0.735110324145)*x[1]**o+(0.949453963809)*x[1]+(-0.894722167055)*x[2]**o+(-0.16124057159)*x[2]
        arg[2,3]=(0.267556059297)*x[0]**o+(-0.633581895464)*x[0]+(-0.176232065927)*x[1]**o+(0.98533106984)*x[1]+(0.404671434387)*x[2]**o+(0.343560595562)*x[2]
        arg[2,4]=(0.502981833324)*x[0]**o+(0.716659442696)*x[0]+(-0.349106283426)*x[1]**o+(0.0726954534053)*x[1]+(0.468516366697)*x[2]**o+(0.328926164383)*x[2]
        arg[3,0]=(0.846509624251)*x[0]**o+(-0.34161660121)*x[0]+(0.25149102353)*x[1]**o+(-0.0130496471853)*x[1]+(-0.556826239055)*x[2]**o+(0.774658667066)*x[2]
        arg[3,1]=(-0.0777319662414)*x[0]**o+(0.992622365536)*x[0]+(0.720504365851)*x[1]**o+(0.0701085839568)*x[1]+(0.475573965193)*x[2]**o+(0.402599619829)*x[2]
        arg[3,2]=(-0.311228599853)*x[0]**o+(-0.732684576916)*x[0]+(0.308213192232)*x[1]**o+(-0.131325871896)*x[1]+(0.964631653839)*x[2]**o+(-0.600646614776)*x[2]
        arg[3,3]=(0.656589254036)*x[0]**o+(-0.275449493207)*x[0]+(-0.611075965309)*x[1]**o+(-0.460879628412)*x[1]+(-0.820861932527)*x[2]**o+(0.424066222721)*x[2]
        arg[3,4]=(0.303269333663)*x[0]**o+(-0.745774722275)*x[0]+(0.82933539351)*x[1]**o+(-0.295464064484)*x[1]+(0.818135297647)*x[2]**o+(-0.989600307642)*x[2]
        ref[0,0,0]=o*(0.767891828291)*x_ref[0]**(o-1)+(-0.0840162180616)
        ref[0,0,1]=o*(-0.942354055114)*x_ref[1]**(o-1)+(-0.458324281794)
        ref[0,0,2]=o*(-0.837589052489)*x_ref[2]**(o-1)+(-0.49741065871)
        ref[0,1,0]=o*(-0.770574732815)*x_ref[0]**(o-1)+(0.949362675967)
        ref[0,1,1]=o*(0.334062389906)*x_ref[1]**(o-1)+(0.589134582043)
        ref[0,1,2]=o*(0.611876443107)*x_ref[2]**(o-1)+(-0.476746595186)
        ref[0,2,0]=o*(-0.113076234857)*x_ref[0]**(o-1)+(0.207116555982)
        ref[0,2,1]=o*(-0.434423505296)*x_ref[1]**(o-1)+(0.582451788291)
        ref[0,2,2]=o*(-0.858451242875)*x_ref[2]**(o-1)+(-0.229934112115)
        ref[0,3,0]=o*(0.55494281628)*x_ref[0]**(o-1)+(0.53116989281)
        ref[0,3,1]=o*(0.150549353151)*x_ref[1]**(o-1)+(0.70886785918)
        ref[0,3,2]=o*(-0.148436740612)*x_ref[2]**(o-1)+(0.755584812901)
        ref[0,4,0]=o*(0.0855991607862)*x_ref[0]**(o-1)+(0.509120320151)
        ref[0,4,1]=o*(-0.303374431746)*x_ref[1]**(o-1)+(0.1813545791)
        ref[0,4,2]=o*(-0.0434667822132)*x_ref[2]**(o-1)+(0.395447849194)
        ref[1,0,0]=o*(-0.779720617706)*x_ref[0]**(o-1)+(0.730668258583)
        ref[1,0,1]=o*(-0.0315884698035)*x_ref[1]**(o-1)+(-0.0929845369431)
        ref[1,0,2]=o*(0.0853332239352)*x_ref[2]**(o-1)+(0.303372304789)
        ref[1,1,0]=o*(-0.687021672626)*x_ref[0]**(o-1)+(-0.380139153436)
        ref[1,1,1]=o*(-0.624774641851)*x_ref[1]**(o-1)+(0.331833510141)
        ref[1,1,2]=o*(-0.747115143343)*x_ref[2]**(o-1)+(-0.901384102505)
        ref[1,2,0]=o*(-0.0528543338921)*x_ref[0]**(o-1)+(-0.683764012224)
        ref[1,2,1]=o*(0.498886779776)*x_ref[1]**(o-1)+(-0.396777215862)
        ref[1,2,2]=o*(0.777051418657)*x_ref[2]**(o-1)+(-0.786345142641)
        ref[1,3,0]=o*(-0.823112017253)*x_ref[0]**(o-1)+(0.278818264102)
        ref[1,3,1]=o*(-0.79372160065)*x_ref[1]**(o-1)+(0.254044599609)
        ref[1,3,2]=o*(-0.372925254827)*x_ref[2]**(o-1)+(-0.85054008508)
        ref[1,4,0]=o*(-0.247156845703)*x_ref[0]**(o-1)+(-0.944335229412)
        ref[1,4,1]=o*(-0.572532409179)*x_ref[1]**(o-1)+(0.289091364421)
        ref[1,4,2]=o*(0.848874739954)*x_ref[2]**(o-1)+(0.705098999827)
        ref[2,0,0]=o*(0.0958493700534)*x_ref[0]**(o-1)+(-0.334070579338)
        ref[2,0,1]=o*(-0.74117408785)*x_ref[1]**(o-1)+(0.0609646344894)
        ref[2,0,2]=o*(-0.328888690751)*x_ref[2]**(o-1)+(-0.0430772626841)
        ref[2,1,0]=o*(0.846871401827)*x_ref[0]**(o-1)+(0.379912211333)
        ref[2,1,1]=o*(-0.197881866966)*x_ref[1]**(o-1)+(-0.551498190852)
        ref[2,1,2]=o*(0.416977164384)*x_ref[2]**(o-1)+(0.09398324743)
        ref[2,2,0]=o*(0.737261473925)*x_ref[0]**(o-1)+(0.696028328637)
        ref[2,2,1]=o*(-0.735110324145)*x_ref[1]**(o-1)+(0.949453963809)
        ref[2,2,2]=o*(-0.894722167055)*x_ref[2]**(o-1)+(-0.16124057159)
        ref[2,3,0]=o*(0.267556059297)*x_ref[0]**(o-1)+(-0.633581895464)
        ref[2,3,1]=o*(-0.176232065927)*x_ref[1]**(o-1)+(0.98533106984)
        ref[2,3,2]=o*(0.404671434387)*x_ref[2]**(o-1)+(0.343560595562)
        ref[2,4,0]=o*(0.502981833324)*x_ref[0]**(o-1)+(0.716659442696)
        ref[2,4,1]=o*(-0.349106283426)*x_ref[1]**(o-1)+(0.0726954534053)
        ref[2,4,2]=o*(0.468516366697)*x_ref[2]**(o-1)+(0.328926164383)
        ref[3,0,0]=o*(0.846509624251)*x_ref[0]**(o-1)+(-0.34161660121)
        ref[3,0,1]=o*(0.25149102353)*x_ref[1]**(o-1)+(-0.0130496471853)
        ref[3,0,2]=o*(-0.556826239055)*x_ref[2]**(o-1)+(0.774658667066)
        ref[3,1,0]=o*(-0.0777319662414)*x_ref[0]**(o-1)+(0.992622365536)
        ref[3,1,1]=o*(0.720504365851)*x_ref[1]**(o-1)+(0.0701085839568)
        ref[3,1,2]=o*(0.475573965193)*x_ref[2]**(o-1)+(0.402599619829)
        ref[3,2,0]=o*(-0.311228599853)*x_ref[0]**(o-1)+(-0.732684576916)
        ref[3,2,1]=o*(0.308213192232)*x_ref[1]**(o-1)+(-0.131325871896)
        ref[3,2,2]=o*(0.964631653839)*x_ref[2]**(o-1)+(-0.600646614776)
        ref[3,3,0]=o*(0.656589254036)*x_ref[0]**(o-1)+(-0.275449493207)
        ref[3,3,1]=o*(-0.611075965309)*x_ref[1]**(o-1)+(-0.460879628412)
        ref[3,3,2]=o*(-0.820861932527)*x_ref[2]**(o-1)+(0.424066222721)
        ref[3,4,0]=o*(0.303269333663)*x_ref[0]**(o-1)+(-0.745774722275)
        ref[3,4,1]=o*(0.82933539351)*x_ref[1]**(o-1)+(-0.295464064484)
        ref[3,4,2]=o*(0.818135297647)*x_ref[2]**(o-1)+(-0.989600307642)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Data on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(-0.572693829631)*x[0]**o+(0.583556749477)*x[0]+(0.22594627003)*x[1]**o+(0.0199162626119)*x[1]
        arg[0,0,1]=(0.196266833125)*x[0]**o+(0.544824498113)*x[0]+(0.150736772157)*x[1]**o+(0.362174902716)*x[1]
        arg[0,1,0]=(0.169481539273)*x[0]**o+(0.0355504217105)*x[0]+(-0.156746013218)*x[1]**o+(0.879476257954)*x[1]
        arg[0,1,1]=(0.824826637612)*x[0]**o+(-0.732645177858)*x[0]+(0.732873648361)*x[1]**o+(-0.40090515696)*x[1]
        arg[1,0,0]=(0.77348720999)*x[0]**o+(0.229475702878)*x[0]+(0.686324947328)*x[1]**o+(0.313197971717)*x[1]
        arg[1,0,1]=(-0.966626441904)*x[0]**o+(0.989778282376)*x[0]+(0.0447214020611)*x[1]**o+(0.439337525343)*x[1]
        arg[1,1,0]=(-0.774806567769)*x[0]**o+(0.634591112025)*x[0]+(0.797720133135)*x[1]**o+(0.579137230562)*x[1]
        arg[1,1,1]=(-0.118703583742)*x[0]**o+(0.482822282284)*x[0]+(0.141839968056)*x[1]**o+(0.916615496002)*x[1]
        arg[2,0,0]=(0.7419378407)*x[0]**o+(0.754978933397)*x[0]+(-0.839586800033)*x[1]**o+(-0.525830008753)*x[1]
        arg[2,0,1]=(-0.855040380309)*x[0]**o+(0.423661210447)*x[0]+(0.538277902172)*x[1]**o+(0.127617006384)*x[1]
        arg[2,1,0]=(0.107349578938)*x[0]**o+(0.697738123598)*x[0]+(0.862106802027)*x[1]**o+(-0.829827651082)*x[1]
        arg[2,1,1]=(-0.970208311818)*x[0]**o+(0.806698181512)*x[0]+(-0.374007524144)*x[1]**o+(-0.0600501198736)*x[1]
        arg[3,0,0]=(0.223312188411)*x[0]**o+(-0.130776319489)*x[0]+(0.616021313401)*x[1]**o+(-0.552848902138)*x[1]
        arg[3,0,1]=(-0.461837450406)*x[0]**o+(-0.895912538242)*x[0]+(0.477606324718)*x[1]**o+(0.220148409572)*x[1]
        arg[3,1,0]=(0.0783005249695)*x[0]**o+(-0.762350707337)*x[0]+(0.616470467018)*x[1]**o+(-0.154358859634)*x[1]
        arg[3,1,1]=(-0.604945998091)*x[0]**o+(0.23801834237)*x[0]+(0.500666300529)*x[1]**o+(0.709482270038)*x[1]
        arg[4,0,0]=(0.746627054515)*x[0]**o+(0.550282853502)*x[0]+(-0.223527434147)*x[1]**o+(-0.291559486198)*x[1]
        arg[4,0,1]=(0.512462457431)*x[0]**o+(0.0908594735188)*x[0]+(-0.888862229845)*x[1]**o+(-0.969985508695)*x[1]
        arg[4,1,0]=(0.606213701819)*x[0]**o+(0.147049558356)*x[0]+(-0.0365908849884)*x[1]**o+(-0.584510320466)*x[1]
        arg[4,1,1]=(-0.110180223906)*x[0]**o+(-0.83442554862)*x[0]+(-0.0516097061459)*x[1]**o+(-0.155615857347)*x[1]
        arg[5,0,0]=(0.603753207781)*x[0]**o+(0.302032475639)*x[0]+(-0.68719165993)*x[1]**o+(-0.375829665239)*x[1]
        arg[5,0,1]=(-0.599357977805)*x[0]**o+(0.562486062075)*x[0]+(0.102714751356)*x[1]**o+(-0.114179799185)*x[1]
        arg[5,1,0]=(0.874756501256)*x[0]**o+(0.550416007969)*x[0]+(0.669721605367)*x[1]**o+(0.24372600222)*x[1]
        arg[5,1,1]=(0.651356889701)*x[0]**o+(0.178366196323)*x[0]+(0.762268544189)*x[1]**o+(0.515014711815)*x[1]
        ref[0,0,0,0]=o*(-0.572693829631)*x_ref[0]**(o-1)+(0.583556749477)
        ref[0,0,0,1]=o*(0.22594627003)*x_ref[1]**(o-1)+(0.0199162626119)
        ref[0,0,1,0]=o*(0.196266833125)*x_ref[0]**(o-1)+(0.544824498113)
        ref[0,0,1,1]=o*(0.150736772157)*x_ref[1]**(o-1)+(0.362174902716)
        ref[0,1,0,0]=o*(0.169481539273)*x_ref[0]**(o-1)+(0.0355504217105)
        ref[0,1,0,1]=o*(-0.156746013218)*x_ref[1]**(o-1)+(0.879476257954)
        ref[0,1,1,0]=o*(0.824826637612)*x_ref[0]**(o-1)+(-0.732645177858)
        ref[0,1,1,1]=o*(0.732873648361)*x_ref[1]**(o-1)+(-0.40090515696)
        ref[1,0,0,0]=o*(0.77348720999)*x_ref[0]**(o-1)+(0.229475702878)
        ref[1,0,0,1]=o*(0.686324947328)*x_ref[1]**(o-1)+(0.313197971717)
        ref[1,0,1,0]=o*(-0.966626441904)*x_ref[0]**(o-1)+(0.989778282376)
        ref[1,0,1,1]=o*(0.0447214020611)*x_ref[1]**(o-1)+(0.439337525343)
        ref[1,1,0,0]=o*(-0.774806567769)*x_ref[0]**(o-1)+(0.634591112025)
        ref[1,1,0,1]=o*(0.797720133135)*x_ref[1]**(o-1)+(0.579137230562)
        ref[1,1,1,0]=o*(-0.118703583742)*x_ref[0]**(o-1)+(0.482822282284)
        ref[1,1,1,1]=o*(0.141839968056)*x_ref[1]**(o-1)+(0.916615496002)
        ref[2,0,0,0]=o*(0.7419378407)*x_ref[0]**(o-1)+(0.754978933397)
        ref[2,0,0,1]=o*(-0.839586800033)*x_ref[1]**(o-1)+(-0.525830008753)
        ref[2,0,1,0]=o*(-0.855040380309)*x_ref[0]**(o-1)+(0.423661210447)
        ref[2,0,1,1]=o*(0.538277902172)*x_ref[1]**(o-1)+(0.127617006384)
        ref[2,1,0,0]=o*(0.107349578938)*x_ref[0]**(o-1)+(0.697738123598)
        ref[2,1,0,1]=o*(0.862106802027)*x_ref[1]**(o-1)+(-0.829827651082)
        ref[2,1,1,0]=o*(-0.970208311818)*x_ref[0]**(o-1)+(0.806698181512)
        ref[2,1,1,1]=o*(-0.374007524144)*x_ref[1]**(o-1)+(-0.0600501198736)
        ref[3,0,0,0]=o*(0.223312188411)*x_ref[0]**(o-1)+(-0.130776319489)
        ref[3,0,0,1]=o*(0.616021313401)*x_ref[1]**(o-1)+(-0.552848902138)
        ref[3,0,1,0]=o*(-0.461837450406)*x_ref[0]**(o-1)+(-0.895912538242)
        ref[3,0,1,1]=o*(0.477606324718)*x_ref[1]**(o-1)+(0.220148409572)
        ref[3,1,0,0]=o*(0.0783005249695)*x_ref[0]**(o-1)+(-0.762350707337)
        ref[3,1,0,1]=o*(0.616470467018)*x_ref[1]**(o-1)+(-0.154358859634)
        ref[3,1,1,0]=o*(-0.604945998091)*x_ref[0]**(o-1)+(0.23801834237)
        ref[3,1,1,1]=o*(0.500666300529)*x_ref[1]**(o-1)+(0.709482270038)
        ref[4,0,0,0]=o*(0.746627054515)*x_ref[0]**(o-1)+(0.550282853502)
        ref[4,0,0,1]=o*(-0.223527434147)*x_ref[1]**(o-1)+(-0.291559486198)
        ref[4,0,1,0]=o*(0.512462457431)*x_ref[0]**(o-1)+(0.0908594735188)
        ref[4,0,1,1]=o*(-0.888862229845)*x_ref[1]**(o-1)+(-0.969985508695)
        ref[4,1,0,0]=o*(0.606213701819)*x_ref[0]**(o-1)+(0.147049558356)
        ref[4,1,0,1]=o*(-0.0365908849884)*x_ref[1]**(o-1)+(-0.584510320466)
        ref[4,1,1,0]=o*(-0.110180223906)*x_ref[0]**(o-1)+(-0.83442554862)
        ref[4,1,1,1]=o*(-0.0516097061459)*x_ref[1]**(o-1)+(-0.155615857347)
        ref[5,0,0,0]=o*(0.603753207781)*x_ref[0]**(o-1)+(0.302032475639)
        ref[5,0,0,1]=o*(-0.68719165993)*x_ref[1]**(o-1)+(-0.375829665239)
        ref[5,0,1,0]=o*(-0.599357977805)*x_ref[0]**(o-1)+(0.562486062075)
        ref[5,0,1,1]=o*(0.102714751356)*x_ref[1]**(o-1)+(-0.114179799185)
        ref[5,1,0,0]=o*(0.874756501256)*x_ref[0]**(o-1)+(0.550416007969)
        ref[5,1,0,1]=o*(0.669721605367)*x_ref[1]**(o-1)+(0.24372600222)
        ref[5,1,1,0]=o*(0.651356889701)*x_ref[0]**(o-1)+(0.178366196323)
        ref[5,1,1,1]=o*(0.762268544189)*x_ref[1]**(o-1)+(0.515014711815)
      else:
        arg[0,0,0]=(-0.634739027866)*x[0]**o+(-0.696370463772)*x[0]+(0.503815931458)*x[1]**o+(-0.457824888032)*x[1]+(0.655074800235)*x[2]**o+(-0.456111009206)*x[2]
        arg[0,0,1]=(-0.533710147141)*x[0]**o+(-0.0814085290298)*x[0]+(-0.0894565935545)*x[1]**o+(-0.3775655102)*x[1]+(-0.134051544262)*x[2]**o+(0.000713749886013)*x[2]
        arg[0,1,0]=(-0.64394535332)*x[0]**o+(0.430741797171)*x[0]+(0.985157009863)*x[1]**o+(-0.655331266432)*x[1]+(-0.436629135988)*x[2]**o+(-0.404480211702)*x[2]
        arg[0,1,1]=(-0.0858143551662)*x[0]**o+(0.0452769288327)*x[0]+(0.930452744895)*x[1]**o+(-0.877149214078)*x[1]+(0.675472222413)*x[2]**o+(0.917497654616)*x[2]
        arg[1,0,0]=(0.88346309442)*x[0]**o+(0.892116796676)*x[0]+(0.22765643526)*x[1]**o+(-0.934442833938)*x[1]+(0.0781755340006)*x[2]**o+(0.106009847768)*x[2]
        arg[1,0,1]=(0.20824563298)*x[0]**o+(0.613584602599)*x[0]+(-0.482386438919)*x[1]**o+(-0.155840561301)*x[1]+(0.817890842096)*x[2]**o+(0.798519843541)*x[2]
        arg[1,1,0]=(-0.915853569389)*x[0]**o+(0.573041720657)*x[0]+(0.236967108991)*x[1]**o+(0.421805849528)*x[1]+(-0.576407564364)*x[2]**o+(0.0709741076428)*x[2]
        arg[1,1,1]=(0.530417188741)*x[0]**o+(0.872073272277)*x[0]+(-0.21047376763)*x[1]**o+(0.88490064655)*x[1]+(0.523085602451)*x[2]**o+(-0.926133382905)*x[2]
        arg[2,0,0]=(-0.974186019136)*x[0]**o+(-0.332433414417)*x[0]+(-0.500938330608)*x[1]**o+(-0.113188574497)*x[1]+(0.228656301416)*x[2]**o+(-0.375756425313)*x[2]
        arg[2,0,1]=(0.246057421673)*x[0]**o+(0.231587929687)*x[0]+(0.398413883486)*x[1]**o+(-0.390998026525)*x[1]+(0.273401149062)*x[2]**o+(-0.296142647578)*x[2]
        arg[2,1,0]=(0.283717204372)*x[0]**o+(-0.545852417255)*x[0]+(-0.616345461169)*x[1]**o+(-0.705051061202)*x[1]+(0.664377876346)*x[2]**o+(0.338382503272)*x[2]
        arg[2,1,1]=(-0.433297970157)*x[0]**o+(-0.716600154712)*x[0]+(0.836194932687)*x[1]**o+(0.0903372116119)*x[1]+(0.113374499353)*x[2]**o+(-0.588810627425)*x[2]
        arg[3,0,0]=(0.404388255474)*x[0]**o+(0.521816615546)*x[0]+(-0.0976581170689)*x[1]**o+(-0.678563989037)*x[1]+(0.550953471125)*x[2]**o+(-0.668793844235)*x[2]
        arg[3,0,1]=(-0.66023047868)*x[0]**o+(0.822794930168)*x[0]+(-0.284215677966)*x[1]**o+(-0.779237447318)*x[1]+(-0.191727752719)*x[2]**o+(-0.748596484262)*x[2]
        arg[3,1,0]=(-0.0610807571905)*x[0]**o+(0.044623781518)*x[0]+(0.851226664753)*x[1]**o+(0.921090244094)*x[1]+(0.494414571241)*x[2]**o+(-0.473831333684)*x[2]
        arg[3,1,1]=(0.54651807228)*x[0]**o+(-0.580525990778)*x[0]+(-0.822936606301)*x[1]**o+(-0.0169562878937)*x[1]+(-0.732219249555)*x[2]**o+(-0.435156155008)*x[2]
        arg[4,0,0]=(0.830021032139)*x[0]**o+(0.976836986062)*x[0]+(0.534162405111)*x[1]**o+(-0.286292103539)*x[1]+(0.820276894761)*x[2]**o+(0.245897387706)*x[2]
        arg[4,0,1]=(0.362201493311)*x[0]**o+(-0.186328147108)*x[0]+(-0.91611458572)*x[1]**o+(-0.965258904175)*x[1]+(0.61850292372)*x[2]**o+(0.410229835478)*x[2]
        arg[4,1,0]=(0.0726313013515)*x[0]**o+(-0.974714544914)*x[0]+(0.46313543268)*x[1]**o+(0.100486704072)*x[1]+(-0.149124857233)*x[2]**o+(0.455733236337)*x[2]
        arg[4,1,1]=(-0.875220220201)*x[0]**o+(-0.416152301789)*x[0]+(-0.0145627466423)*x[1]**o+(0.267856009119)*x[1]+(-0.604260174049)*x[2]**o+(0.689107997051)*x[2]
        arg[5,0,0]=(0.196182127971)*x[0]**o+(0.337209503833)*x[0]+(0.595342239158)*x[1]**o+(0.507423300857)*x[1]+(0.934760469389)*x[2]**o+(-0.198686443328)*x[2]
        arg[5,0,1]=(0.77210909967)*x[0]**o+(-0.310778136545)*x[0]+(0.512326103142)*x[1]**o+(-0.501056206243)*x[1]+(0.98755961257)*x[2]**o+(-0.658414340038)*x[2]
        arg[5,1,0]=(0.375277702198)*x[0]**o+(-0.603850047717)*x[0]+(0.677227868069)*x[1]**o+(-0.784640615159)*x[1]+(0.177350721639)*x[2]**o+(0.241053657333)*x[2]
        arg[5,1,1]=(-0.368625522736)*x[0]**o+(0.196977476909)*x[0]+(-0.582451887206)*x[1]**o+(0.598240904158)*x[1]+(0.102240230796)*x[2]**o+(0.487322529158)*x[2]
        ref[0,0,0,0]=o*(-0.634739027866)*x_ref[0]**(o-1)+(-0.696370463772)
        ref[0,0,0,1]=o*(0.503815931458)*x_ref[1]**(o-1)+(-0.457824888032)
        ref[0,0,0,2]=o*(0.655074800235)*x_ref[2]**(o-1)+(-0.456111009206)
        ref[0,0,1,0]=o*(-0.533710147141)*x_ref[0]**(o-1)+(-0.0814085290298)
        ref[0,0,1,1]=o*(-0.0894565935545)*x_ref[1]**(o-1)+(-0.3775655102)
        ref[0,0,1,2]=o*(-0.134051544262)*x_ref[2]**(o-1)+(0.000713749886013)
        ref[0,1,0,0]=o*(-0.64394535332)*x_ref[0]**(o-1)+(0.430741797171)
        ref[0,1,0,1]=o*(0.985157009863)*x_ref[1]**(o-1)+(-0.655331266432)
        ref[0,1,0,2]=o*(-0.436629135988)*x_ref[2]**(o-1)+(-0.404480211702)
        ref[0,1,1,0]=o*(-0.0858143551662)*x_ref[0]**(o-1)+(0.0452769288327)
        ref[0,1,1,1]=o*(0.930452744895)*x_ref[1]**(o-1)+(-0.877149214078)
        ref[0,1,1,2]=o*(0.675472222413)*x_ref[2]**(o-1)+(0.917497654616)
        ref[1,0,0,0]=o*(0.88346309442)*x_ref[0]**(o-1)+(0.892116796676)
        ref[1,0,0,1]=o*(0.22765643526)*x_ref[1]**(o-1)+(-0.934442833938)
        ref[1,0,0,2]=o*(0.0781755340006)*x_ref[2]**(o-1)+(0.106009847768)
        ref[1,0,1,0]=o*(0.20824563298)*x_ref[0]**(o-1)+(0.613584602599)
        ref[1,0,1,1]=o*(-0.482386438919)*x_ref[1]**(o-1)+(-0.155840561301)
        ref[1,0,1,2]=o*(0.817890842096)*x_ref[2]**(o-1)+(0.798519843541)
        ref[1,1,0,0]=o*(-0.915853569389)*x_ref[0]**(o-1)+(0.573041720657)
        ref[1,1,0,1]=o*(0.236967108991)*x_ref[1]**(o-1)+(0.421805849528)
        ref[1,1,0,2]=o*(-0.576407564364)*x_ref[2]**(o-1)+(0.0709741076428)
        ref[1,1,1,0]=o*(0.530417188741)*x_ref[0]**(o-1)+(0.872073272277)
        ref[1,1,1,1]=o*(-0.21047376763)*x_ref[1]**(o-1)+(0.88490064655)
        ref[1,1,1,2]=o*(0.523085602451)*x_ref[2]**(o-1)+(-0.926133382905)
        ref[2,0,0,0]=o*(-0.974186019136)*x_ref[0]**(o-1)+(-0.332433414417)
        ref[2,0,0,1]=o*(-0.500938330608)*x_ref[1]**(o-1)+(-0.113188574497)
        ref[2,0,0,2]=o*(0.228656301416)*x_ref[2]**(o-1)+(-0.375756425313)
        ref[2,0,1,0]=o*(0.246057421673)*x_ref[0]**(o-1)+(0.231587929687)
        ref[2,0,1,1]=o*(0.398413883486)*x_ref[1]**(o-1)+(-0.390998026525)
        ref[2,0,1,2]=o*(0.273401149062)*x_ref[2]**(o-1)+(-0.296142647578)
        ref[2,1,0,0]=o*(0.283717204372)*x_ref[0]**(o-1)+(-0.545852417255)
        ref[2,1,0,1]=o*(-0.616345461169)*x_ref[1]**(o-1)+(-0.705051061202)
        ref[2,1,0,2]=o*(0.664377876346)*x_ref[2]**(o-1)+(0.338382503272)
        ref[2,1,1,0]=o*(-0.433297970157)*x_ref[0]**(o-1)+(-0.716600154712)
        ref[2,1,1,1]=o*(0.836194932687)*x_ref[1]**(o-1)+(0.0903372116119)
        ref[2,1,1,2]=o*(0.113374499353)*x_ref[2]**(o-1)+(-0.588810627425)
        ref[3,0,0,0]=o*(0.404388255474)*x_ref[0]**(o-1)+(0.521816615546)
        ref[3,0,0,1]=o*(-0.0976581170689)*x_ref[1]**(o-1)+(-0.678563989037)
        ref[3,0,0,2]=o*(0.550953471125)*x_ref[2]**(o-1)+(-0.668793844235)
        ref[3,0,1,0]=o*(-0.66023047868)*x_ref[0]**(o-1)+(0.822794930168)
        ref[3,0,1,1]=o*(-0.284215677966)*x_ref[1]**(o-1)+(-0.779237447318)
        ref[3,0,1,2]=o*(-0.191727752719)*x_ref[2]**(o-1)+(-0.748596484262)
        ref[3,1,0,0]=o*(-0.0610807571905)*x_ref[0]**(o-1)+(0.044623781518)
        ref[3,1,0,1]=o*(0.851226664753)*x_ref[1]**(o-1)+(0.921090244094)
        ref[3,1,0,2]=o*(0.494414571241)*x_ref[2]**(o-1)+(-0.473831333684)
        ref[3,1,1,0]=o*(0.54651807228)*x_ref[0]**(o-1)+(-0.580525990778)
        ref[3,1,1,1]=o*(-0.822936606301)*x_ref[1]**(o-1)+(-0.0169562878937)
        ref[3,1,1,2]=o*(-0.732219249555)*x_ref[2]**(o-1)+(-0.435156155008)
        ref[4,0,0,0]=o*(0.830021032139)*x_ref[0]**(o-1)+(0.976836986062)
        ref[4,0,0,1]=o*(0.534162405111)*x_ref[1]**(o-1)+(-0.286292103539)
        ref[4,0,0,2]=o*(0.820276894761)*x_ref[2]**(o-1)+(0.245897387706)
        ref[4,0,1,0]=o*(0.362201493311)*x_ref[0]**(o-1)+(-0.186328147108)
        ref[4,0,1,1]=o*(-0.91611458572)*x_ref[1]**(o-1)+(-0.965258904175)
        ref[4,0,1,2]=o*(0.61850292372)*x_ref[2]**(o-1)+(0.410229835478)
        ref[4,1,0,0]=o*(0.0726313013515)*x_ref[0]**(o-1)+(-0.974714544914)
        ref[4,1,0,1]=o*(0.46313543268)*x_ref[1]**(o-1)+(0.100486704072)
        ref[4,1,0,2]=o*(-0.149124857233)*x_ref[2]**(o-1)+(0.455733236337)
        ref[4,1,1,0]=o*(-0.875220220201)*x_ref[0]**(o-1)+(-0.416152301789)
        ref[4,1,1,1]=o*(-0.0145627466423)*x_ref[1]**(o-1)+(0.267856009119)
        ref[4,1,1,2]=o*(-0.604260174049)*x_ref[2]**(o-1)+(0.689107997051)
        ref[5,0,0,0]=o*(0.196182127971)*x_ref[0]**(o-1)+(0.337209503833)
        ref[5,0,0,1]=o*(0.595342239158)*x_ref[1]**(o-1)+(0.507423300857)
        ref[5,0,0,2]=o*(0.934760469389)*x_ref[2]**(o-1)+(-0.198686443328)
        ref[5,0,1,0]=o*(0.77210909967)*x_ref[0]**(o-1)+(-0.310778136545)
        ref[5,0,1,1]=o*(0.512326103142)*x_ref[1]**(o-1)+(-0.501056206243)
        ref[5,0,1,2]=o*(0.98755961257)*x_ref[2]**(o-1)+(-0.658414340038)
        ref[5,1,0,0]=o*(0.375277702198)*x_ref[0]**(o-1)+(-0.603850047717)
        ref[5,1,0,1]=o*(0.677227868069)*x_ref[1]**(o-1)+(-0.784640615159)
        ref[5,1,0,2]=o*(0.177350721639)*x_ref[2]**(o-1)+(0.241053657333)
        ref[5,1,1,0]=o*(-0.368625522736)*x_ref[0]**(o-1)+(0.196977476909)
        ref[5,1,1,1]=o*(-0.582451887206)*x_ref[1]**(o-1)+(0.598240904158)
        ref[5,1,1,2]=o*(0.102240230796)*x_ref[2]**(o-1)+(0.487322529158)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_Solution_rank0(self):
      """
      tests gradient for rank 0 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.851643614423)*x[0]**o+(-0.77638754265)*x[0]+(-0.216746360457)*x[1]**o+(-0.117807364973)*x[1]
        ref[0]=o*(0.851643614423)*x_ref[0]**(o-1)+(-0.77638754265)
        ref[1]=o*(-0.216746360457)*x_ref[1]**(o-1)+(-0.117807364973)
      else:
        arg=(0.846271449213)*x[0]**o+(0.895578416904)*x[0]+(-0.518297490388)*x[1]**o+(0.272255265951)*x[1]+(0.537822992528)*x[2]**o+(0.74226977002)*x[2]
        ref[0]=o*(0.846271449213)*x_ref[0]**(o-1)+(0.895578416904)
        ref[1]=o*(-0.518297490388)*x_ref[1]**(o-1)+(0.272255265951)
        ref[2]=o*(0.537822992528)*x_ref[2]**(o-1)+(0.74226977002)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_Solution_rank1(self):
      """
      tests gradient for rank 1 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(0.365601318395)*x[0]**o+(0.295624555802)*x[0]+(0.540618182217)*x[1]**o+(0.0458416078386)*x[1]
        arg[1]=(0.332276039998)*x[0]**o+(0.422606936253)*x[0]+(-0.221603594854)*x[1]**o+(0.879863420258)*x[1]
        ref[0,0]=o*(0.365601318395)*x_ref[0]**(o-1)+(0.295624555802)
        ref[0,1]=o*(0.540618182217)*x_ref[1]**(o-1)+(0.0458416078386)
        ref[1,0]=o*(0.332276039998)*x_ref[0]**(o-1)+(0.422606936253)
        ref[1,1]=o*(-0.221603594854)*x_ref[1]**(o-1)+(0.879863420258)
      else:
        arg[0]=(-0.258072277129)*x[0]**o+(-0.833085462518)*x[0]+(-0.124240965858)*x[1]**o+(-0.121853073047)*x[1]+(-0.877974471569)*x[2]**o+(0.929660451331)*x[2]
        arg[1]=(0.306520203535)*x[0]**o+(0.635444320723)*x[0]+(-0.766579509915)*x[1]**o+(-0.381189007175)*x[1]+(-0.76608952351)*x[2]**o+(0.00718583364881)*x[2]
        ref[0,0]=o*(-0.258072277129)*x_ref[0]**(o-1)+(-0.833085462518)
        ref[0,1]=o*(-0.124240965858)*x_ref[1]**(o-1)+(-0.121853073047)
        ref[0,2]=o*(-0.877974471569)*x_ref[2]**(o-1)+(0.929660451331)
        ref[1,0]=o*(0.306520203535)*x_ref[0]**(o-1)+(0.635444320723)
        ref[1,1]=o*(-0.766579509915)*x_ref[1]**(o-1)+(-0.381189007175)
        ref[1,2]=o*(-0.76608952351)*x_ref[2]**(o-1)+(0.00718583364881)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_Solution_rank2(self):
      """
      tests gradient for rank 2 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.403088506806)*x[0]**o+(-0.436942773988)*x[0]+(-0.0594011537346)*x[1]**o+(0.855063195595)*x[1]
        arg[0,1]=(-0.516992303892)*x[0]**o+(-0.132586737299)*x[0]+(-0.854639239618)*x[1]**o+(0.241200454455)*x[1]
        arg[0,2]=(-0.373941155498)*x[0]**o+(0.933328225549)*x[0]+(-0.986870460316)*x[1]**o+(-0.051265908773)*x[1]
        arg[0,3]=(-0.175701653328)*x[0]**o+(-0.726542005356)*x[0]+(-0.553505635409)*x[1]**o+(-0.199806969718)*x[1]
        arg[0,4]=(-0.750832127973)*x[0]**o+(0.404511387161)*x[0]+(0.874423404897)*x[1]**o+(0.35360129734)*x[1]
        arg[1,0]=(-0.000191271001285)*x[0]**o+(-0.319365399066)*x[0]+(0.398444976089)*x[1]**o+(-0.966391658006)*x[1]
        arg[1,1]=(-0.58562890965)*x[0]**o+(-0.623992315262)*x[0]+(-0.913704774126)*x[1]**o+(0.910305409081)*x[1]
        arg[1,2]=(-0.480491011401)*x[0]**o+(-0.387015926056)*x[0]+(0.845826744282)*x[1]**o+(0.380626980034)*x[1]
        arg[1,3]=(-0.284167706438)*x[0]**o+(0.730574128045)*x[0]+(0.823389953051)*x[1]**o+(0.59483032515)*x[1]
        arg[1,4]=(-0.545147810354)*x[0]**o+(-0.632923743497)*x[0]+(0.619596244096)*x[1]**o+(-0.816596365827)*x[1]
        arg[2,0]=(0.161289895106)*x[0]**o+(0.435472177094)*x[0]+(0.125591455076)*x[1]**o+(0.0207320895937)*x[1]
        arg[2,1]=(0.639457164801)*x[0]**o+(0.2631408826)*x[0]+(0.00255095677899)*x[1]**o+(0.732164720004)*x[1]
        arg[2,2]=(-0.152014092979)*x[0]**o+(0.347024615036)*x[0]+(0.94212294017)*x[1]**o+(0.173939724203)*x[1]
        arg[2,3]=(-0.0324872553975)*x[0]**o+(-0.969492827039)*x[0]+(-0.830876162378)*x[1]**o+(0.601308513636)*x[1]
        arg[2,4]=(0.932999309515)*x[0]**o+(0.0320937041249)*x[0]+(-0.354492894455)*x[1]**o+(-0.752837146132)*x[1]
        arg[3,0]=(0.995147840382)*x[0]**o+(-0.276974278934)*x[0]+(0.905272259272)*x[1]**o+(-0.433178159448)*x[1]
        arg[3,1]=(-0.291708633096)*x[0]**o+(-0.542000555721)*x[0]+(0.372404748364)*x[1]**o+(0.23140215774)*x[1]
        arg[3,2]=(0.88604771071)*x[0]**o+(-0.753078356803)*x[0]+(-0.265302521749)*x[1]**o+(-0.948898850214)*x[1]
        arg[3,3]=(-0.429496844082)*x[0]**o+(0.0731695917195)*x[0]+(0.291387878783)*x[1]**o+(-0.078863825039)*x[1]
        arg[3,4]=(-0.0067999635984)*x[0]**o+(0.488018496019)*x[0]+(-0.875646054486)*x[1]**o+(0.629803284064)*x[1]
        ref[0,0,0]=o*(0.403088506806)*x_ref[0]**(o-1)+(-0.436942773988)
        ref[0,0,1]=o*(-0.0594011537346)*x_ref[1]**(o-1)+(0.855063195595)
        ref[0,1,0]=o*(-0.516992303892)*x_ref[0]**(o-1)+(-0.132586737299)
        ref[0,1,1]=o*(-0.854639239618)*x_ref[1]**(o-1)+(0.241200454455)
        ref[0,2,0]=o*(-0.373941155498)*x_ref[0]**(o-1)+(0.933328225549)
        ref[0,2,1]=o*(-0.986870460316)*x_ref[1]**(o-1)+(-0.051265908773)
        ref[0,3,0]=o*(-0.175701653328)*x_ref[0]**(o-1)+(-0.726542005356)
        ref[0,3,1]=o*(-0.553505635409)*x_ref[1]**(o-1)+(-0.199806969718)
        ref[0,4,0]=o*(-0.750832127973)*x_ref[0]**(o-1)+(0.404511387161)
        ref[0,4,1]=o*(0.874423404897)*x_ref[1]**(o-1)+(0.35360129734)
        ref[1,0,0]=o*(-0.000191271001285)*x_ref[0]**(o-1)+(-0.319365399066)
        ref[1,0,1]=o*(0.398444976089)*x_ref[1]**(o-1)+(-0.966391658006)
        ref[1,1,0]=o*(-0.58562890965)*x_ref[0]**(o-1)+(-0.623992315262)
        ref[1,1,1]=o*(-0.913704774126)*x_ref[1]**(o-1)+(0.910305409081)
        ref[1,2,0]=o*(-0.480491011401)*x_ref[0]**(o-1)+(-0.387015926056)
        ref[1,2,1]=o*(0.845826744282)*x_ref[1]**(o-1)+(0.380626980034)
        ref[1,3,0]=o*(-0.284167706438)*x_ref[0]**(o-1)+(0.730574128045)
        ref[1,3,1]=o*(0.823389953051)*x_ref[1]**(o-1)+(0.59483032515)
        ref[1,4,0]=o*(-0.545147810354)*x_ref[0]**(o-1)+(-0.632923743497)
        ref[1,4,1]=o*(0.619596244096)*x_ref[1]**(o-1)+(-0.816596365827)
        ref[2,0,0]=o*(0.161289895106)*x_ref[0]**(o-1)+(0.435472177094)
        ref[2,0,1]=o*(0.125591455076)*x_ref[1]**(o-1)+(0.0207320895937)
        ref[2,1,0]=o*(0.639457164801)*x_ref[0]**(o-1)+(0.2631408826)
        ref[2,1,1]=o*(0.00255095677899)*x_ref[1]**(o-1)+(0.732164720004)
        ref[2,2,0]=o*(-0.152014092979)*x_ref[0]**(o-1)+(0.347024615036)
        ref[2,2,1]=o*(0.94212294017)*x_ref[1]**(o-1)+(0.173939724203)
        ref[2,3,0]=o*(-0.0324872553975)*x_ref[0]**(o-1)+(-0.969492827039)
        ref[2,3,1]=o*(-0.830876162378)*x_ref[1]**(o-1)+(0.601308513636)
        ref[2,4,0]=o*(0.932999309515)*x_ref[0]**(o-1)+(0.0320937041249)
        ref[2,4,1]=o*(-0.354492894455)*x_ref[1]**(o-1)+(-0.752837146132)
        ref[3,0,0]=o*(0.995147840382)*x_ref[0]**(o-1)+(-0.276974278934)
        ref[3,0,1]=o*(0.905272259272)*x_ref[1]**(o-1)+(-0.433178159448)
        ref[3,1,0]=o*(-0.291708633096)*x_ref[0]**(o-1)+(-0.542000555721)
        ref[3,1,1]=o*(0.372404748364)*x_ref[1]**(o-1)+(0.23140215774)
        ref[3,2,0]=o*(0.88604771071)*x_ref[0]**(o-1)+(-0.753078356803)
        ref[3,2,1]=o*(-0.265302521749)*x_ref[1]**(o-1)+(-0.948898850214)
        ref[3,3,0]=o*(-0.429496844082)*x_ref[0]**(o-1)+(0.0731695917195)
        ref[3,3,1]=o*(0.291387878783)*x_ref[1]**(o-1)+(-0.078863825039)
        ref[3,4,0]=o*(-0.0067999635984)*x_ref[0]**(o-1)+(0.488018496019)
        ref[3,4,1]=o*(-0.875646054486)*x_ref[1]**(o-1)+(0.629803284064)
      else:
        arg[0,0]=(-0.512668741406)*x[0]**o+(-0.73142104842)*x[0]+(0.489050993226)*x[1]**o+(0.771941571419)*x[1]+(-0.538092512577)*x[2]**o+(-0.457812389328)*x[2]
        arg[0,1]=(0.258566436386)*x[0]**o+(-0.572006860118)*x[0]+(-0.0370305840623)*x[1]**o+(0.328810934717)*x[1]+(-0.652873123265)*x[2]**o+(0.734929914374)*x[2]
        arg[0,2]=(-0.228462027625)*x[0]**o+(-0.873359484139)*x[0]+(0.902575701641)*x[1]**o+(0.428758160478)*x[1]+(-0.377042847702)*x[2]**o+(-0.161364604019)*x[2]
        arg[0,3]=(0.31338185054)*x[0]**o+(0.973849539932)*x[0]+(-0.403569231167)*x[1]**o+(-0.110026269257)*x[1]+(0.603101392345)*x[2]**o+(0.499232034173)*x[2]
        arg[0,4]=(0.468416317974)*x[0]**o+(-0.0154203909264)*x[0]+(0.409228888268)*x[1]**o+(0.358886480877)*x[1]+(-0.00677343401301)*x[2]**o+(-0.0567153195302)*x[2]
        arg[1,0]=(0.614929795628)*x[0]**o+(0.54911679279)*x[0]+(0.527138394555)*x[1]**o+(-0.84070465171)*x[1]+(0.421928294706)*x[2]**o+(-0.871734463848)*x[2]
        arg[1,1]=(-0.498770327357)*x[0]**o+(0.294610855431)*x[0]+(-0.815129074288)*x[1]**o+(0.395332176796)*x[1]+(-0.555947305527)*x[2]**o+(-0.623550814988)*x[2]
        arg[1,2]=(-0.369404109593)*x[0]**o+(-0.662927702362)*x[0]+(0.886789099892)*x[1]**o+(-0.815728539359)*x[1]+(-0.843861162574)*x[2]**o+(-0.510039607856)*x[2]
        arg[1,3]=(-0.747305678574)*x[0]**o+(0.350337618157)*x[0]+(0.313491051893)*x[1]**o+(-0.554840960712)*x[1]+(-0.259760094369)*x[2]**o+(0.904246223768)*x[2]
        arg[1,4]=(0.485859115418)*x[0]**o+(-0.751900240375)*x[0]+(-0.233384727142)*x[1]**o+(-0.466677891749)*x[1]+(-0.771311310708)*x[2]**o+(0.380515497846)*x[2]
        arg[2,0]=(0.628529887016)*x[0]**o+(0.778810609149)*x[0]+(-0.95647127374)*x[1]**o+(-0.887895309984)*x[1]+(-0.926017554164)*x[2]**o+(0.0922106889932)*x[2]
        arg[2,1]=(-0.981382750453)*x[0]**o+(0.858805367823)*x[0]+(-0.202352133378)*x[1]**o+(0.527229765084)*x[1]+(-0.0862956097426)*x[2]**o+(-0.76269735579)*x[2]
        arg[2,2]=(0.591276459941)*x[0]**o+(0.554086306469)*x[0]+(-0.175045397917)*x[1]**o+(0.319542375346)*x[1]+(0.328810955576)*x[2]**o+(-0.245381809232)*x[2]
        arg[2,3]=(-0.826436985287)*x[0]**o+(-0.931352535769)*x[0]+(-0.480801956568)*x[1]**o+(0.830773509938)*x[1]+(0.157556801982)*x[2]**o+(0.982505166946)*x[2]
        arg[2,4]=(-0.0992736644463)*x[0]**o+(-0.147525710611)*x[0]+(-0.723322157973)*x[1]**o+(0.0527438662093)*x[1]+(-0.338847227522)*x[2]**o+(-0.704585609897)*x[2]
        arg[3,0]=(-0.45250460769)*x[0]**o+(-0.323299292565)*x[0]+(-0.435540041421)*x[1]**o+(0.418330181239)*x[1]+(0.526739853977)*x[2]**o+(-0.00513414974056)*x[2]
        arg[3,1]=(0.289534600598)*x[0]**o+(0.467498987256)*x[0]+(0.27851903721)*x[1]**o+(0.908249187588)*x[1]+(-0.84695489717)*x[2]**o+(-0.799372710877)*x[2]
        arg[3,2]=(0.00338011092566)*x[0]**o+(0.819216072868)*x[0]+(0.115437140937)*x[1]**o+(0.0968835984948)*x[1]+(-0.633253222581)*x[2]**o+(-0.0224890801282)*x[2]
        arg[3,3]=(0.578331574145)*x[0]**o+(0.328247456626)*x[0]+(-0.725914955131)*x[1]**o+(-0.863562766028)*x[1]+(-0.283057959979)*x[2]**o+(-0.521563360583)*x[2]
        arg[3,4]=(0.345725352698)*x[0]**o+(0.614912618718)*x[0]+(-0.218084952915)*x[1]**o+(-0.629514485943)*x[1]+(-0.207605980168)*x[2]**o+(-0.0950042458608)*x[2]
        ref[0,0,0]=o*(-0.512668741406)*x_ref[0]**(o-1)+(-0.73142104842)
        ref[0,0,1]=o*(0.489050993226)*x_ref[1]**(o-1)+(0.771941571419)
        ref[0,0,2]=o*(-0.538092512577)*x_ref[2]**(o-1)+(-0.457812389328)
        ref[0,1,0]=o*(0.258566436386)*x_ref[0]**(o-1)+(-0.572006860118)
        ref[0,1,1]=o*(-0.0370305840623)*x_ref[1]**(o-1)+(0.328810934717)
        ref[0,1,2]=o*(-0.652873123265)*x_ref[2]**(o-1)+(0.734929914374)
        ref[0,2,0]=o*(-0.228462027625)*x_ref[0]**(o-1)+(-0.873359484139)
        ref[0,2,1]=o*(0.902575701641)*x_ref[1]**(o-1)+(0.428758160478)
        ref[0,2,2]=o*(-0.377042847702)*x_ref[2]**(o-1)+(-0.161364604019)
        ref[0,3,0]=o*(0.31338185054)*x_ref[0]**(o-1)+(0.973849539932)
        ref[0,3,1]=o*(-0.403569231167)*x_ref[1]**(o-1)+(-0.110026269257)
        ref[0,3,2]=o*(0.603101392345)*x_ref[2]**(o-1)+(0.499232034173)
        ref[0,4,0]=o*(0.468416317974)*x_ref[0]**(o-1)+(-0.0154203909264)
        ref[0,4,1]=o*(0.409228888268)*x_ref[1]**(o-1)+(0.358886480877)
        ref[0,4,2]=o*(-0.00677343401301)*x_ref[2]**(o-1)+(-0.0567153195302)
        ref[1,0,0]=o*(0.614929795628)*x_ref[0]**(o-1)+(0.54911679279)
        ref[1,0,1]=o*(0.527138394555)*x_ref[1]**(o-1)+(-0.84070465171)
        ref[1,0,2]=o*(0.421928294706)*x_ref[2]**(o-1)+(-0.871734463848)
        ref[1,1,0]=o*(-0.498770327357)*x_ref[0]**(o-1)+(0.294610855431)
        ref[1,1,1]=o*(-0.815129074288)*x_ref[1]**(o-1)+(0.395332176796)
        ref[1,1,2]=o*(-0.555947305527)*x_ref[2]**(o-1)+(-0.623550814988)
        ref[1,2,0]=o*(-0.369404109593)*x_ref[0]**(o-1)+(-0.662927702362)
        ref[1,2,1]=o*(0.886789099892)*x_ref[1]**(o-1)+(-0.815728539359)
        ref[1,2,2]=o*(-0.843861162574)*x_ref[2]**(o-1)+(-0.510039607856)
        ref[1,3,0]=o*(-0.747305678574)*x_ref[0]**(o-1)+(0.350337618157)
        ref[1,3,1]=o*(0.313491051893)*x_ref[1]**(o-1)+(-0.554840960712)
        ref[1,3,2]=o*(-0.259760094369)*x_ref[2]**(o-1)+(0.904246223768)
        ref[1,4,0]=o*(0.485859115418)*x_ref[0]**(o-1)+(-0.751900240375)
        ref[1,4,1]=o*(-0.233384727142)*x_ref[1]**(o-1)+(-0.466677891749)
        ref[1,4,2]=o*(-0.771311310708)*x_ref[2]**(o-1)+(0.380515497846)
        ref[2,0,0]=o*(0.628529887016)*x_ref[0]**(o-1)+(0.778810609149)
        ref[2,0,1]=o*(-0.95647127374)*x_ref[1]**(o-1)+(-0.887895309984)
        ref[2,0,2]=o*(-0.926017554164)*x_ref[2]**(o-1)+(0.0922106889932)
        ref[2,1,0]=o*(-0.981382750453)*x_ref[0]**(o-1)+(0.858805367823)
        ref[2,1,1]=o*(-0.202352133378)*x_ref[1]**(o-1)+(0.527229765084)
        ref[2,1,2]=o*(-0.0862956097426)*x_ref[2]**(o-1)+(-0.76269735579)
        ref[2,2,0]=o*(0.591276459941)*x_ref[0]**(o-1)+(0.554086306469)
        ref[2,2,1]=o*(-0.175045397917)*x_ref[1]**(o-1)+(0.319542375346)
        ref[2,2,2]=o*(0.328810955576)*x_ref[2]**(o-1)+(-0.245381809232)
        ref[2,3,0]=o*(-0.826436985287)*x_ref[0]**(o-1)+(-0.931352535769)
        ref[2,3,1]=o*(-0.480801956568)*x_ref[1]**(o-1)+(0.830773509938)
        ref[2,3,2]=o*(0.157556801982)*x_ref[2]**(o-1)+(0.982505166946)
        ref[2,4,0]=o*(-0.0992736644463)*x_ref[0]**(o-1)+(-0.147525710611)
        ref[2,4,1]=o*(-0.723322157973)*x_ref[1]**(o-1)+(0.0527438662093)
        ref[2,4,2]=o*(-0.338847227522)*x_ref[2]**(o-1)+(-0.704585609897)
        ref[3,0,0]=o*(-0.45250460769)*x_ref[0]**(o-1)+(-0.323299292565)
        ref[3,0,1]=o*(-0.435540041421)*x_ref[1]**(o-1)+(0.418330181239)
        ref[3,0,2]=o*(0.526739853977)*x_ref[2]**(o-1)+(-0.00513414974056)
        ref[3,1,0]=o*(0.289534600598)*x_ref[0]**(o-1)+(0.467498987256)
        ref[3,1,1]=o*(0.27851903721)*x_ref[1]**(o-1)+(0.908249187588)
        ref[3,1,2]=o*(-0.84695489717)*x_ref[2]**(o-1)+(-0.799372710877)
        ref[3,2,0]=o*(0.00338011092566)*x_ref[0]**(o-1)+(0.819216072868)
        ref[3,2,1]=o*(0.115437140937)*x_ref[1]**(o-1)+(0.0968835984948)
        ref[3,2,2]=o*(-0.633253222581)*x_ref[2]**(o-1)+(-0.0224890801282)
        ref[3,3,0]=o*(0.578331574145)*x_ref[0]**(o-1)+(0.328247456626)
        ref[3,3,1]=o*(-0.725914955131)*x_ref[1]**(o-1)+(-0.863562766028)
        ref[3,3,2]=o*(-0.283057959979)*x_ref[2]**(o-1)+(-0.521563360583)
        ref[3,4,0]=o*(0.345725352698)*x_ref[0]**(o-1)+(0.614912618718)
        ref[3,4,1]=o*(-0.218084952915)*x_ref[1]**(o-1)+(-0.629514485943)
        ref[3,4,2]=o*(-0.207605980168)*x_ref[2]**(o-1)+(-0.0950042458608)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_Solution_rank3(self):
      """
      tests gradient for rank 3 Data on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(-0.353390112117)*x[0]**o+(0.121267964347)*x[0]+(0.095925646757)*x[1]**o+(-0.00141503525661)*x[1]
        arg[0,0,1]=(0.610556742471)*x[0]**o+(0.542948343923)*x[0]+(0.124762431991)*x[1]**o+(0.00216142978003)*x[1]
        arg[0,1,0]=(0.261559018753)*x[0]**o+(-0.881689419767)*x[0]+(-0.009352418091)*x[1]**o+(0.333357441723)*x[1]
        arg[0,1,1]=(-0.25379927884)*x[0]**o+(-0.124076833523)*x[0]+(-0.167690772835)*x[1]**o+(0.89804632709)*x[1]
        arg[1,0,0]=(-0.39353207502)*x[0]**o+(0.838815579522)*x[0]+(0.829467918805)*x[1]**o+(0.614403367394)*x[1]
        arg[1,0,1]=(-0.698946975112)*x[0]**o+(-0.551313390457)*x[0]+(0.965127390549)*x[1]**o+(-0.819660095397)*x[1]
        arg[1,1,0]=(-0.656237793952)*x[0]**o+(0.727261124295)*x[0]+(0.602446266985)*x[1]**o+(-0.320796826351)*x[1]
        arg[1,1,1]=(0.111875111713)*x[0]**o+(0.000360626785094)*x[0]+(-0.802516890555)*x[1]**o+(0.420759758492)*x[1]
        arg[2,0,0]=(-0.421920068352)*x[0]**o+(-0.022970702876)*x[0]+(-0.0257219638216)*x[1]**o+(-0.36544576073)*x[1]
        arg[2,0,1]=(-0.459431228769)*x[0]**o+(0.150702477357)*x[0]+(-0.869898945031)*x[1]**o+(0.261651620176)*x[1]
        arg[2,1,0]=(-0.866165026127)*x[0]**o+(0.149307656472)*x[0]+(-0.270058622191)*x[1]**o+(0.0873163553474)*x[1]
        arg[2,1,1]=(-0.871128617394)*x[0]**o+(-0.774356000237)*x[0]+(0.337383167457)*x[1]**o+(-0.453335744484)*x[1]
        arg[3,0,0]=(0.404195477481)*x[0]**o+(-0.350041445198)*x[0]+(-0.583794909281)*x[1]**o+(-0.895439618872)*x[1]
        arg[3,0,1]=(0.693567867164)*x[0]**o+(0.989642722856)*x[0]+(0.814104467522)*x[1]**o+(-0.126302588221)*x[1]
        arg[3,1,0]=(0.935509747673)*x[0]**o+(0.0104612091188)*x[0]+(0.304974305936)*x[1]**o+(0.658660310426)*x[1]
        arg[3,1,1]=(0.677420202064)*x[0]**o+(-0.160834685914)*x[0]+(0.241578146196)*x[1]**o+(-0.182223867353)*x[1]
        arg[4,0,0]=(-0.908542015864)*x[0]**o+(0.125595344482)*x[0]+(-0.396864254557)*x[1]**o+(0.408182849245)*x[1]
        arg[4,0,1]=(0.436101221257)*x[0]**o+(0.946667075656)*x[0]+(-0.293523459017)*x[1]**o+(0.363130416513)*x[1]
        arg[4,1,0]=(0.583416010605)*x[0]**o+(0.531883961319)*x[0]+(-0.418905217485)*x[1]**o+(0.271442034667)*x[1]
        arg[4,1,1]=(-0.708766397827)*x[0]**o+(0.0266251980073)*x[0]+(-0.0929293524384)*x[1]**o+(-0.661095295605)*x[1]
        arg[5,0,0]=(0.693424423443)*x[0]**o+(-0.201539674621)*x[0]+(-0.221922493999)*x[1]**o+(-0.218359043699)*x[1]
        arg[5,0,1]=(-0.478707796293)*x[0]**o+(0.791533578559)*x[0]+(0.280213321002)*x[1]**o+(-0.60809908629)*x[1]
        arg[5,1,0]=(-0.517992572451)*x[0]**o+(0.591995363281)*x[0]+(0.480220427965)*x[1]**o+(0.134542063762)*x[1]
        arg[5,1,1]=(0.415861674391)*x[0]**o+(0.773614372731)*x[0]+(-0.984515861984)*x[1]**o+(0.971916685266)*x[1]
        ref[0,0,0,0]=o*(-0.353390112117)*x_ref[0]**(o-1)+(0.121267964347)
        ref[0,0,0,1]=o*(0.095925646757)*x_ref[1]**(o-1)+(-0.00141503525661)
        ref[0,0,1,0]=o*(0.610556742471)*x_ref[0]**(o-1)+(0.542948343923)
        ref[0,0,1,1]=o*(0.124762431991)*x_ref[1]**(o-1)+(0.00216142978003)
        ref[0,1,0,0]=o*(0.261559018753)*x_ref[0]**(o-1)+(-0.881689419767)
        ref[0,1,0,1]=o*(-0.009352418091)*x_ref[1]**(o-1)+(0.333357441723)
        ref[0,1,1,0]=o*(-0.25379927884)*x_ref[0]**(o-1)+(-0.124076833523)
        ref[0,1,1,1]=o*(-0.167690772835)*x_ref[1]**(o-1)+(0.89804632709)
        ref[1,0,0,0]=o*(-0.39353207502)*x_ref[0]**(o-1)+(0.838815579522)
        ref[1,0,0,1]=o*(0.829467918805)*x_ref[1]**(o-1)+(0.614403367394)
        ref[1,0,1,0]=o*(-0.698946975112)*x_ref[0]**(o-1)+(-0.551313390457)
        ref[1,0,1,1]=o*(0.965127390549)*x_ref[1]**(o-1)+(-0.819660095397)
        ref[1,1,0,0]=o*(-0.656237793952)*x_ref[0]**(o-1)+(0.727261124295)
        ref[1,1,0,1]=o*(0.602446266985)*x_ref[1]**(o-1)+(-0.320796826351)
        ref[1,1,1,0]=o*(0.111875111713)*x_ref[0]**(o-1)+(0.000360626785094)
        ref[1,1,1,1]=o*(-0.802516890555)*x_ref[1]**(o-1)+(0.420759758492)
        ref[2,0,0,0]=o*(-0.421920068352)*x_ref[0]**(o-1)+(-0.022970702876)
        ref[2,0,0,1]=o*(-0.0257219638216)*x_ref[1]**(o-1)+(-0.36544576073)
        ref[2,0,1,0]=o*(-0.459431228769)*x_ref[0]**(o-1)+(0.150702477357)
        ref[2,0,1,1]=o*(-0.869898945031)*x_ref[1]**(o-1)+(0.261651620176)
        ref[2,1,0,0]=o*(-0.866165026127)*x_ref[0]**(o-1)+(0.149307656472)
        ref[2,1,0,1]=o*(-0.270058622191)*x_ref[1]**(o-1)+(0.0873163553474)
        ref[2,1,1,0]=o*(-0.871128617394)*x_ref[0]**(o-1)+(-0.774356000237)
        ref[2,1,1,1]=o*(0.337383167457)*x_ref[1]**(o-1)+(-0.453335744484)
        ref[3,0,0,0]=o*(0.404195477481)*x_ref[0]**(o-1)+(-0.350041445198)
        ref[3,0,0,1]=o*(-0.583794909281)*x_ref[1]**(o-1)+(-0.895439618872)
        ref[3,0,1,0]=o*(0.693567867164)*x_ref[0]**(o-1)+(0.989642722856)
        ref[3,0,1,1]=o*(0.814104467522)*x_ref[1]**(o-1)+(-0.126302588221)
        ref[3,1,0,0]=o*(0.935509747673)*x_ref[0]**(o-1)+(0.0104612091188)
        ref[3,1,0,1]=o*(0.304974305936)*x_ref[1]**(o-1)+(0.658660310426)
        ref[3,1,1,0]=o*(0.677420202064)*x_ref[0]**(o-1)+(-0.160834685914)
        ref[3,1,1,1]=o*(0.241578146196)*x_ref[1]**(o-1)+(-0.182223867353)
        ref[4,0,0,0]=o*(-0.908542015864)*x_ref[0]**(o-1)+(0.125595344482)
        ref[4,0,0,1]=o*(-0.396864254557)*x_ref[1]**(o-1)+(0.408182849245)
        ref[4,0,1,0]=o*(0.436101221257)*x_ref[0]**(o-1)+(0.946667075656)
        ref[4,0,1,1]=o*(-0.293523459017)*x_ref[1]**(o-1)+(0.363130416513)
        ref[4,1,0,0]=o*(0.583416010605)*x_ref[0]**(o-1)+(0.531883961319)
        ref[4,1,0,1]=o*(-0.418905217485)*x_ref[1]**(o-1)+(0.271442034667)
        ref[4,1,1,0]=o*(-0.708766397827)*x_ref[0]**(o-1)+(0.0266251980073)
        ref[4,1,1,1]=o*(-0.0929293524384)*x_ref[1]**(o-1)+(-0.661095295605)
        ref[5,0,0,0]=o*(0.693424423443)*x_ref[0]**(o-1)+(-0.201539674621)
        ref[5,0,0,1]=o*(-0.221922493999)*x_ref[1]**(o-1)+(-0.218359043699)
        ref[5,0,1,0]=o*(-0.478707796293)*x_ref[0]**(o-1)+(0.791533578559)
        ref[5,0,1,1]=o*(0.280213321002)*x_ref[1]**(o-1)+(-0.60809908629)
        ref[5,1,0,0]=o*(-0.517992572451)*x_ref[0]**(o-1)+(0.591995363281)
        ref[5,1,0,1]=o*(0.480220427965)*x_ref[1]**(o-1)+(0.134542063762)
        ref[5,1,1,0]=o*(0.415861674391)*x_ref[0]**(o-1)+(0.773614372731)
        ref[5,1,1,1]=o*(-0.984515861984)*x_ref[1]**(o-1)+(0.971916685266)
      else:
        arg[0,0,0]=(0.157678109652)*x[0]**o+(-0.939095069874)*x[0]+(0.340072659801)*x[1]**o+(0.806723712633)*x[1]+(0.0175654201162)*x[2]**o+(-0.695887679405)*x[2]
        arg[0,0,1]=(0.148444957808)*x[0]**o+(0.769780554196)*x[0]+(-0.999778710821)*x[1]**o+(0.765998508134)*x[1]+(0.489498280892)*x[2]**o+(0.272011172233)*x[2]
        arg[0,1,0]=(-0.78853623669)*x[0]**o+(-0.889333747099)*x[0]+(0.897684283327)*x[1]**o+(0.878046029595)*x[1]+(-0.355566201991)*x[2]**o+(-0.656187599294)*x[2]
        arg[0,1,1]=(-0.903496685895)*x[0]**o+(0.335762730702)*x[0]+(0.264330545204)*x[1]**o+(-0.369300150725)*x[1]+(0.00819339769162)*x[2]**o+(0.0466274018566)*x[2]
        arg[1,0,0]=(0.490893502666)*x[0]**o+(0.853253169019)*x[0]+(-0.706120536551)*x[1]**o+(-0.810665092749)*x[1]+(0.877124690496)*x[2]**o+(-0.663316848595)*x[2]
        arg[1,0,1]=(-0.897301110118)*x[0]**o+(-0.571577796347)*x[0]+(-0.00912216314091)*x[1]**o+(0.479091266837)*x[1]+(-0.951994896347)*x[2]**o+(0.293801256264)*x[2]
        arg[1,1,0]=(-0.0843442242335)*x[0]**o+(0.436592099426)*x[0]+(-0.961835284742)*x[1]**o+(0.453758903497)*x[1]+(0.759916173417)*x[2]**o+(-0.356674191439)*x[2]
        arg[1,1,1]=(0.368337095889)*x[0]**o+(-0.180552461333)*x[0]+(-0.814727889141)*x[1]**o+(-0.226678543654)*x[1]+(0.629233877979)*x[2]**o+(0.934452743806)*x[2]
        arg[2,0,0]=(0.335801632975)*x[0]**o+(0.4853793666)*x[0]+(-0.603075878381)*x[1]**o+(-0.464873655094)*x[1]+(-0.304107114487)*x[2]**o+(0.768564020927)*x[2]
        arg[2,0,1]=(-0.843867260693)*x[0]**o+(-0.758493294188)*x[0]+(0.801820428023)*x[1]**o+(0.0909753752871)*x[1]+(-0.208134327922)*x[2]**o+(0.343325582627)*x[2]
        arg[2,1,0]=(-0.143364423799)*x[0]**o+(-0.191201452642)*x[0]+(0.356480498629)*x[1]**o+(0.0853546566948)*x[1]+(0.234781870759)*x[2]**o+(-0.702906217789)*x[2]
        arg[2,1,1]=(0.81324792898)*x[0]**o+(0.565754643122)*x[0]+(-0.0246314241495)*x[1]**o+(-0.83548496516)*x[1]+(0.730246143504)*x[2]**o+(-0.835539994852)*x[2]
        arg[3,0,0]=(0.877992836393)*x[0]**o+(-0.137135423487)*x[0]+(0.534511286076)*x[1]**o+(-0.0584370047297)*x[1]+(-0.0497236607574)*x[2]**o+(0.408414670632)*x[2]
        arg[3,0,1]=(-0.959771372305)*x[0]**o+(0.587216149992)*x[0]+(-0.873216249139)*x[1]**o+(0.0703350087653)*x[1]+(0.452900901257)*x[2]**o+(-0.180788315472)*x[2]
        arg[3,1,0]=(0.477701526969)*x[0]**o+(0.16165566827)*x[0]+(0.219901428845)*x[1]**o+(-0.0816687269195)*x[1]+(-0.379553348394)*x[2]**o+(-0.764672519612)*x[2]
        arg[3,1,1]=(0.274518799686)*x[0]**o+(0.945009722336)*x[0]+(-0.979787014238)*x[1]**o+(0.587704213162)*x[1]+(0.7959640984)*x[2]**o+(-0.0811112488533)*x[2]
        arg[4,0,0]=(-0.579121056378)*x[0]**o+(0.971799195206)*x[0]+(-0.646271217985)*x[1]**o+(0.369751123548)*x[1]+(0.792425864156)*x[2]**o+(-0.170799235786)*x[2]
        arg[4,0,1]=(0.0939380562355)*x[0]**o+(0.857041359029)*x[0]+(-0.379025882204)*x[1]**o+(-0.571968622949)*x[1]+(-0.156853183697)*x[2]**o+(0.643214485063)*x[2]
        arg[4,1,0]=(-0.715210364871)*x[0]**o+(0.150341666571)*x[0]+(0.325165277323)*x[1]**o+(-0.322744240034)*x[1]+(-0.622094139461)*x[2]**o+(-0.830479146327)*x[2]
        arg[4,1,1]=(-0.697109424406)*x[0]**o+(-0.730318259042)*x[0]+(-0.135119012822)*x[1]**o+(0.410502029229)*x[1]+(0.547987909743)*x[2]**o+(0.144877544254)*x[2]
        arg[5,0,0]=(0.787147597087)*x[0]**o+(-0.528180541295)*x[0]+(-0.251578089108)*x[1]**o+(-0.170766337864)*x[1]+(-0.123341129221)*x[2]**o+(-0.815622069347)*x[2]
        arg[5,0,1]=(0.193873484005)*x[0]**o+(0.270190252915)*x[0]+(0.807946985621)*x[1]**o+(0.184522999461)*x[1]+(0.97429597406)*x[2]**o+(0.532931028021)*x[2]
        arg[5,1,0]=(0.555644676015)*x[0]**o+(-0.225593442089)*x[0]+(0.877869009767)*x[1]**o+(-0.750894245506)*x[1]+(0.888501611997)*x[2]**o+(-0.84027021889)*x[2]
        arg[5,1,1]=(0.76909422867)*x[0]**o+(0.406697645173)*x[0]+(-0.233710263631)*x[1]**o+(-0.432942345121)*x[1]+(0.270484113666)*x[2]**o+(0.707302418115)*x[2]
        ref[0,0,0,0]=o*(0.157678109652)*x_ref[0]**(o-1)+(-0.939095069874)
        ref[0,0,0,1]=o*(0.340072659801)*x_ref[1]**(o-1)+(0.806723712633)
        ref[0,0,0,2]=o*(0.0175654201162)*x_ref[2]**(o-1)+(-0.695887679405)
        ref[0,0,1,0]=o*(0.148444957808)*x_ref[0]**(o-1)+(0.769780554196)
        ref[0,0,1,1]=o*(-0.999778710821)*x_ref[1]**(o-1)+(0.765998508134)
        ref[0,0,1,2]=o*(0.489498280892)*x_ref[2]**(o-1)+(0.272011172233)
        ref[0,1,0,0]=o*(-0.78853623669)*x_ref[0]**(o-1)+(-0.889333747099)
        ref[0,1,0,1]=o*(0.897684283327)*x_ref[1]**(o-1)+(0.878046029595)
        ref[0,1,0,2]=o*(-0.355566201991)*x_ref[2]**(o-1)+(-0.656187599294)
        ref[0,1,1,0]=o*(-0.903496685895)*x_ref[0]**(o-1)+(0.335762730702)
        ref[0,1,1,1]=o*(0.264330545204)*x_ref[1]**(o-1)+(-0.369300150725)
        ref[0,1,1,2]=o*(0.00819339769162)*x_ref[2]**(o-1)+(0.0466274018566)
        ref[1,0,0,0]=o*(0.490893502666)*x_ref[0]**(o-1)+(0.853253169019)
        ref[1,0,0,1]=o*(-0.706120536551)*x_ref[1]**(o-1)+(-0.810665092749)
        ref[1,0,0,2]=o*(0.877124690496)*x_ref[2]**(o-1)+(-0.663316848595)
        ref[1,0,1,0]=o*(-0.897301110118)*x_ref[0]**(o-1)+(-0.571577796347)
        ref[1,0,1,1]=o*(-0.00912216314091)*x_ref[1]**(o-1)+(0.479091266837)
        ref[1,0,1,2]=o*(-0.951994896347)*x_ref[2]**(o-1)+(0.293801256264)
        ref[1,1,0,0]=o*(-0.0843442242335)*x_ref[0]**(o-1)+(0.436592099426)
        ref[1,1,0,1]=o*(-0.961835284742)*x_ref[1]**(o-1)+(0.453758903497)
        ref[1,1,0,2]=o*(0.759916173417)*x_ref[2]**(o-1)+(-0.356674191439)
        ref[1,1,1,0]=o*(0.368337095889)*x_ref[0]**(o-1)+(-0.180552461333)
        ref[1,1,1,1]=o*(-0.814727889141)*x_ref[1]**(o-1)+(-0.226678543654)
        ref[1,1,1,2]=o*(0.629233877979)*x_ref[2]**(o-1)+(0.934452743806)
        ref[2,0,0,0]=o*(0.335801632975)*x_ref[0]**(o-1)+(0.4853793666)
        ref[2,0,0,1]=o*(-0.603075878381)*x_ref[1]**(o-1)+(-0.464873655094)
        ref[2,0,0,2]=o*(-0.304107114487)*x_ref[2]**(o-1)+(0.768564020927)
        ref[2,0,1,0]=o*(-0.843867260693)*x_ref[0]**(o-1)+(-0.758493294188)
        ref[2,0,1,1]=o*(0.801820428023)*x_ref[1]**(o-1)+(0.0909753752871)
        ref[2,0,1,2]=o*(-0.208134327922)*x_ref[2]**(o-1)+(0.343325582627)
        ref[2,1,0,0]=o*(-0.143364423799)*x_ref[0]**(o-1)+(-0.191201452642)
        ref[2,1,0,1]=o*(0.356480498629)*x_ref[1]**(o-1)+(0.0853546566948)
        ref[2,1,0,2]=o*(0.234781870759)*x_ref[2]**(o-1)+(-0.702906217789)
        ref[2,1,1,0]=o*(0.81324792898)*x_ref[0]**(o-1)+(0.565754643122)
        ref[2,1,1,1]=o*(-0.0246314241495)*x_ref[1]**(o-1)+(-0.83548496516)
        ref[2,1,1,2]=o*(0.730246143504)*x_ref[2]**(o-1)+(-0.835539994852)
        ref[3,0,0,0]=o*(0.877992836393)*x_ref[0]**(o-1)+(-0.137135423487)
        ref[3,0,0,1]=o*(0.534511286076)*x_ref[1]**(o-1)+(-0.0584370047297)
        ref[3,0,0,2]=o*(-0.0497236607574)*x_ref[2]**(o-1)+(0.408414670632)
        ref[3,0,1,0]=o*(-0.959771372305)*x_ref[0]**(o-1)+(0.587216149992)
        ref[3,0,1,1]=o*(-0.873216249139)*x_ref[1]**(o-1)+(0.0703350087653)
        ref[3,0,1,2]=o*(0.452900901257)*x_ref[2]**(o-1)+(-0.180788315472)
        ref[3,1,0,0]=o*(0.477701526969)*x_ref[0]**(o-1)+(0.16165566827)
        ref[3,1,0,1]=o*(0.219901428845)*x_ref[1]**(o-1)+(-0.0816687269195)
        ref[3,1,0,2]=o*(-0.379553348394)*x_ref[2]**(o-1)+(-0.764672519612)
        ref[3,1,1,0]=o*(0.274518799686)*x_ref[0]**(o-1)+(0.945009722336)
        ref[3,1,1,1]=o*(-0.979787014238)*x_ref[1]**(o-1)+(0.587704213162)
        ref[3,1,1,2]=o*(0.7959640984)*x_ref[2]**(o-1)+(-0.0811112488533)
        ref[4,0,0,0]=o*(-0.579121056378)*x_ref[0]**(o-1)+(0.971799195206)
        ref[4,0,0,1]=o*(-0.646271217985)*x_ref[1]**(o-1)+(0.369751123548)
        ref[4,0,0,2]=o*(0.792425864156)*x_ref[2]**(o-1)+(-0.170799235786)
        ref[4,0,1,0]=o*(0.0939380562355)*x_ref[0]**(o-1)+(0.857041359029)
        ref[4,0,1,1]=o*(-0.379025882204)*x_ref[1]**(o-1)+(-0.571968622949)
        ref[4,0,1,2]=o*(-0.156853183697)*x_ref[2]**(o-1)+(0.643214485063)
        ref[4,1,0,0]=o*(-0.715210364871)*x_ref[0]**(o-1)+(0.150341666571)
        ref[4,1,0,1]=o*(0.325165277323)*x_ref[1]**(o-1)+(-0.322744240034)
        ref[4,1,0,2]=o*(-0.622094139461)*x_ref[2]**(o-1)+(-0.830479146327)
        ref[4,1,1,0]=o*(-0.697109424406)*x_ref[0]**(o-1)+(-0.730318259042)
        ref[4,1,1,1]=o*(-0.135119012822)*x_ref[1]**(o-1)+(0.410502029229)
        ref[4,1,1,2]=o*(0.547987909743)*x_ref[2]**(o-1)+(0.144877544254)
        ref[5,0,0,0]=o*(0.787147597087)*x_ref[0]**(o-1)+(-0.528180541295)
        ref[5,0,0,1]=o*(-0.251578089108)*x_ref[1]**(o-1)+(-0.170766337864)
        ref[5,0,0,2]=o*(-0.123341129221)*x_ref[2]**(o-1)+(-0.815622069347)
        ref[5,0,1,0]=o*(0.193873484005)*x_ref[0]**(o-1)+(0.270190252915)
        ref[5,0,1,1]=o*(0.807946985621)*x_ref[1]**(o-1)+(0.184522999461)
        ref[5,0,1,2]=o*(0.97429597406)*x_ref[2]**(o-1)+(0.532931028021)
        ref[5,1,0,0]=o*(0.555644676015)*x_ref[0]**(o-1)+(-0.225593442089)
        ref[5,1,0,1]=o*(0.877869009767)*x_ref[1]**(o-1)+(-0.750894245506)
        ref[5,1,0,2]=o*(0.888501611997)*x_ref[2]**(o-1)+(-0.84027021889)
        ref[5,1,1,0]=o*(0.76909422867)*x_ref[0]**(o-1)+(0.406697645173)
        ref[5,1,1,1]=o*(-0.233710263631)*x_ref[1]**(o-1)+(-0.432942345121)
        ref[5,1,1,2]=o*(0.270484113666)*x_ref[2]**(o-1)+(0.707302418115)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.390595923727)*x[0]+(0.870359886354)*x[1]
        ref[0]=(0.390595923727)
        ref[1]=(0.870359886354)
      else:
        arg=(1.4237066625)*x[0]+(0.191112329766)*x[1]+(0.342817637558)*x[2]
        ref[0]=(1.4237066625)
        ref[1]=(0.191112329766)
        ref[2]=(0.342817637558)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(1.24969786007)*x[0]+(-0.503239623541)*x[1]
        arg[1]=(0.00152786815487)*x[0]+(0.486128960541)*x[1]
        ref[0,0]=(1.24969786007)
        ref[0,1]=(-0.503239623541)
        ref[1,0]=(0.00152786815487)
        ref[1,1]=(0.486128960541)
      else:
        arg[0]=(1.16486019581)*x[0]+(-0.244560585954)*x[1]+(1.11539615819)*x[2]
        arg[1]=(-0.831039160237)*x[0]+(0.822276239005)*x[1]+(0.421468778379)*x[2]
        ref[0,0]=(1.16486019581)
        ref[0,1]=(-0.244560585954)
        ref[0,2]=(1.11539615819)
        ref[1,0]=(-0.831039160237)
        ref[1,1]=(0.822276239005)
        ref[1,2]=(0.421468778379)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.189442592013)*x[0]+(-1.60645028651)*x[1]
        arg[0,1]=(0.0100077079631)*x[0]+(-1.17387880858)*x[1]
        arg[0,2]=(0.0275548120659)*x[0]+(0.653617350295)*x[1]
        arg[0,3]=(0.05829133816)*x[0]+(-0.373563514457)*x[1]
        arg[0,4]=(0.779779569696)*x[0]+(-1.26967503826)*x[1]
        arg[1,0]=(-1.76287668803)*x[0]+(1.09016960913)*x[1]
        arg[1,1]=(-0.37217349459)*x[0]+(-0.241280622851)*x[1]
        arg[1,2]=(-0.590745342582)*x[0]+(0.258098534691)*x[1]
        arg[1,3]=(0.481754329217)*x[0]+(1.9686931184)*x[1]
        arg[1,4]=(1.62318899699)*x[0]+(-0.634644801985)*x[1]
        arg[2,0]=(-0.0113400901549)*x[0]+(0.448967376428)*x[1]
        arg[2,1]=(0.0239277722956)*x[0]+(0.248367174694)*x[1]
        arg[2,2]=(1.23484142782)*x[0]+(-0.408724357055)*x[1]
        arg[2,3]=(0.115412214024)*x[0]+(0.721349239053)*x[1]
        arg[2,4]=(-1.58878458768)*x[0]+(-0.297328738789)*x[1]
        arg[3,0]=(-0.536715000453)*x[0]+(-0.0610624173989)*x[1]
        arg[3,1]=(-0.365981795847)*x[0]+(0.710935216782)*x[1]
        arg[3,2]=(1.1343806743)*x[0]+(-1.12662285264)*x[1]
        arg[3,3]=(-1.56463302165)*x[0]+(0.701651939794)*x[1]
        arg[3,4]=(1.38464443939)*x[0]+(-0.389328824078)*x[1]
        ref[0,0,0]=(0.189442592013)
        ref[0,0,1]=(-1.60645028651)
        ref[0,1,0]=(0.0100077079631)
        ref[0,1,1]=(-1.17387880858)
        ref[0,2,0]=(0.0275548120659)
        ref[0,2,1]=(0.653617350295)
        ref[0,3,0]=(0.05829133816)
        ref[0,3,1]=(-0.373563514457)
        ref[0,4,0]=(0.779779569696)
        ref[0,4,1]=(-1.26967503826)
        ref[1,0,0]=(-1.76287668803)
        ref[1,0,1]=(1.09016960913)
        ref[1,1,0]=(-0.37217349459)
        ref[1,1,1]=(-0.241280622851)
        ref[1,2,0]=(-0.590745342582)
        ref[1,2,1]=(0.258098534691)
        ref[1,3,0]=(0.481754329217)
        ref[1,3,1]=(1.9686931184)
        ref[1,4,0]=(1.62318899699)
        ref[1,4,1]=(-0.634644801985)
        ref[2,0,0]=(-0.0113400901549)
        ref[2,0,1]=(0.448967376428)
        ref[2,1,0]=(0.0239277722956)
        ref[2,1,1]=(0.248367174694)
        ref[2,2,0]=(1.23484142782)
        ref[2,2,1]=(-0.408724357055)
        ref[2,3,0]=(0.115412214024)
        ref[2,3,1]=(0.721349239053)
        ref[2,4,0]=(-1.58878458768)
        ref[2,4,1]=(-0.297328738789)
        ref[3,0,0]=(-0.536715000453)
        ref[3,0,1]=(-0.0610624173989)
        ref[3,1,0]=(-0.365981795847)
        ref[3,1,1]=(0.710935216782)
        ref[3,2,0]=(1.1343806743)
        ref[3,2,1]=(-1.12662285264)
        ref[3,3,0]=(-1.56463302165)
        ref[3,3,1]=(0.701651939794)
        ref[3,4,0]=(1.38464443939)
        ref[3,4,1]=(-0.389328824078)
      else:
        arg[0,0]=(-0.0712739739657)*x[0]+(-0.876441668189)*x[1]+(0.0470586478107)*x[2]
        arg[0,1]=(0.162070750778)*x[0]+(-0.672482005621)*x[1]+(-1.03342931552)*x[2]
        arg[0,2]=(1.06895949733)*x[0]+(-1.10495954108)*x[1]+(-0.689435346922)*x[2]
        arg[0,3]=(-1.64208651194)*x[0]+(0.957715915835)*x[1]+(-0.693562002749)*x[2]
        arg[0,4]=(0.438930190966)*x[0]+(-0.696372759112)*x[1]+(-0.158769579398)*x[2]
        arg[1,0]=(-0.953682332409)*x[0]+(-1.06837831005)*x[1]+(1.19564302893)*x[2]
        arg[1,1]=(0.277654186276)*x[0]+(-0.4746702788)*x[1]+(0.173080688542)*x[2]
        arg[1,2]=(-0.0080483840277)*x[0]+(-0.606889636532)*x[1]+(-0.124482488485)*x[2]
        arg[1,3]=(1.6007700604)*x[0]+(-0.375573101659)*x[1]+(-0.0476989341458)*x[2]
        arg[1,4]=(-0.797213964765)*x[0]+(-1.71649956799)*x[1]+(-0.661820920574)*x[2]
        arg[2,0]=(-0.32770535636)*x[0]+(0.705676452368)*x[1]+(0.0527214815247)*x[2]
        arg[2,1]=(-0.279796835093)*x[0]+(-0.277264709729)*x[1]+(0.278447243546)*x[2]
        arg[2,2]=(-0.633674196984)*x[0]+(-0.0772663082858)*x[1]+(0.973414222834)*x[2]
        arg[2,3]=(0.0946037203409)*x[0]+(-0.556948102801)*x[1]+(0.521264798082)*x[2]
        arg[2,4]=(0.566962914588)*x[0]+(-0.942523827817)*x[1]+(-0.216364192998)*x[2]
        arg[3,0]=(-0.839702033371)*x[0]+(-1.54418367928)*x[1]+(-0.184693363932)*x[2]
        arg[3,1]=(-0.509575652351)*x[0]+(0.0710239576211)*x[1]+(0.758695521775)*x[2]
        arg[3,2]=(0.465980018625)*x[0]+(-0.907796828587)*x[1]+(1.00785361438)*x[2]
        arg[3,3]=(0.778181969842)*x[0]+(-1.45634928421)*x[1]+(1.20377448321)*x[2]
        arg[3,4]=(1.53649652976)*x[0]+(-0.769556905214)*x[1]+(0.736590460805)*x[2]
        ref[0,0,0]=(-0.0712739739657)
        ref[0,0,1]=(-0.876441668189)
        ref[0,0,2]=(0.0470586478107)
        ref[0,1,0]=(0.162070750778)
        ref[0,1,1]=(-0.672482005621)
        ref[0,1,2]=(-1.03342931552)
        ref[0,2,0]=(1.06895949733)
        ref[0,2,1]=(-1.10495954108)
        ref[0,2,2]=(-0.689435346922)
        ref[0,3,0]=(-1.64208651194)
        ref[0,3,1]=(0.957715915835)
        ref[0,3,2]=(-0.693562002749)
        ref[0,4,0]=(0.438930190966)
        ref[0,4,1]=(-0.696372759112)
        ref[0,4,2]=(-0.158769579398)
        ref[1,0,0]=(-0.953682332409)
        ref[1,0,1]=(-1.06837831005)
        ref[1,0,2]=(1.19564302893)
        ref[1,1,0]=(0.277654186276)
        ref[1,1,1]=(-0.4746702788)
        ref[1,1,2]=(0.173080688542)
        ref[1,2,0]=(-0.0080483840277)
        ref[1,2,1]=(-0.606889636532)
        ref[1,2,2]=(-0.124482488485)
        ref[1,3,0]=(1.6007700604)
        ref[1,3,1]=(-0.375573101659)
        ref[1,3,2]=(-0.0476989341458)
        ref[1,4,0]=(-0.797213964765)
        ref[1,4,1]=(-1.71649956799)
        ref[1,4,2]=(-0.661820920574)
        ref[2,0,0]=(-0.32770535636)
        ref[2,0,1]=(0.705676452368)
        ref[2,0,2]=(0.0527214815247)
        ref[2,1,0]=(-0.279796835093)
        ref[2,1,1]=(-0.277264709729)
        ref[2,1,2]=(0.278447243546)
        ref[2,2,0]=(-0.633674196984)
        ref[2,2,1]=(-0.0772663082858)
        ref[2,2,2]=(0.973414222834)
        ref[2,3,0]=(0.0946037203409)
        ref[2,3,1]=(-0.556948102801)
        ref[2,3,2]=(0.521264798082)
        ref[2,4,0]=(0.566962914588)
        ref[2,4,1]=(-0.942523827817)
        ref[2,4,2]=(-0.216364192998)
        ref[3,0,0]=(-0.839702033371)
        ref[3,0,1]=(-1.54418367928)
        ref[3,0,2]=(-0.184693363932)
        ref[3,1,0]=(-0.509575652351)
        ref[3,1,1]=(0.0710239576211)
        ref[3,1,2]=(0.758695521775)
        ref[3,2,0]=(0.465980018625)
        ref[3,2,1]=(-0.907796828587)
        ref[3,2,2]=(1.00785361438)
        ref[3,3,0]=(0.778181969842)
        ref[3,3,1]=(-1.45634928421)
        ref[3,3,2]=(1.20377448321)
        ref[3,4,0]=(1.53649652976)
        ref[3,4,1]=(-0.769556905214)
        ref[3,4,2]=(0.736590460805)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromData_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Data on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(1.39942183968)*x[0]+(0.930250163424)*x[1]
        arg[0,0,1]=(0.784529427298)*x[0]+(0.701356076527)*x[1]
        arg[0,1,0]=(0.555731012919)*x[0]+(0.344587262019)*x[1]
        arg[0,1,1]=(-0.276715609625)*x[0]+(-1.11338983237)*x[1]
        arg[1,0,0]=(-0.769761090097)*x[0]+(0.992057132466)*x[1]
        arg[1,0,1]=(-0.551932009885)*x[0]+(0.838811831137)*x[1]
        arg[1,1,0]=(-0.0342537649661)*x[0]+(-0.121298284661)*x[1]
        arg[1,1,1]=(-0.520900867)*x[0]+(0.332690359269)*x[1]
        arg[2,0,0]=(-0.11096511324)*x[0]+(1.5033138393)*x[1]
        arg[2,0,1]=(0.42710234817)*x[0]+(1.69083527833)*x[1]
        arg[2,1,0]=(-0.721628841933)*x[0]+(-0.142173751601)*x[1]
        arg[2,1,1]=(1.60406199163)*x[0]+(0.641129401426)*x[1]
        arg[3,0,0]=(-0.731738224766)*x[0]+(-0.900425804879)*x[1]
        arg[3,0,1]=(0.691108140204)*x[0]+(1.34043965547)*x[1]
        arg[3,1,0]=(0.0588648299821)*x[0]+(1.39496787747)*x[1]
        arg[3,1,1]=(0.308498671612)*x[0]+(-0.382011042003)*x[1]
        arg[4,0,0]=(0.267730803561)*x[0]+(1.76842225328)*x[1]
        arg[4,0,1]=(0.817593687794)*x[0]+(0.563964345071)*x[1]
        arg[4,1,0]=(-0.081090160095)*x[0]+(0.52343934951)*x[1]
        arg[4,1,1]=(-1.02492946795)*x[0]+(-0.725641086216)*x[1]
        arg[5,0,0]=(-0.294202699958)*x[0]+(0.288095939599)*x[1]
        arg[5,0,1]=(0.110479098614)*x[0]+(-0.113972943318)*x[1]
        arg[5,1,0]=(0.772912536924)*x[0]+(-0.883345081065)*x[1]
        arg[5,1,1]=(-0.17097935184)*x[0]+(0.645719745504)*x[1]
        ref[0,0,0,0]=(1.39942183968)
        ref[0,0,0,1]=(0.930250163424)
        ref[0,0,1,0]=(0.784529427298)
        ref[0,0,1,1]=(0.701356076527)
        ref[0,1,0,0]=(0.555731012919)
        ref[0,1,0,1]=(0.344587262019)
        ref[0,1,1,0]=(-0.276715609625)
        ref[0,1,1,1]=(-1.11338983237)
        ref[1,0,0,0]=(-0.769761090097)
        ref[1,0,0,1]=(0.992057132466)
        ref[1,0,1,0]=(-0.551932009885)
        ref[1,0,1,1]=(0.838811831137)
        ref[1,1,0,0]=(-0.0342537649661)
        ref[1,1,0,1]=(-0.121298284661)
        ref[1,1,1,0]=(-0.520900867)
        ref[1,1,1,1]=(0.332690359269)
        ref[2,0,0,0]=(-0.11096511324)
        ref[2,0,0,1]=(1.5033138393)
        ref[2,0,1,0]=(0.42710234817)
        ref[2,0,1,1]=(1.69083527833)
        ref[2,1,0,0]=(-0.721628841933)
        ref[2,1,0,1]=(-0.142173751601)
        ref[2,1,1,0]=(1.60406199163)
        ref[2,1,1,1]=(0.641129401426)
        ref[3,0,0,0]=(-0.731738224766)
        ref[3,0,0,1]=(-0.900425804879)
        ref[3,0,1,0]=(0.691108140204)
        ref[3,0,1,1]=(1.34043965547)
        ref[3,1,0,0]=(0.0588648299821)
        ref[3,1,0,1]=(1.39496787747)
        ref[3,1,1,0]=(0.308498671612)
        ref[3,1,1,1]=(-0.382011042003)
        ref[4,0,0,0]=(0.267730803561)
        ref[4,0,0,1]=(1.76842225328)
        ref[4,0,1,0]=(0.817593687794)
        ref[4,0,1,1]=(0.563964345071)
        ref[4,1,0,0]=(-0.081090160095)
        ref[4,1,0,1]=(0.52343934951)
        ref[4,1,1,0]=(-1.02492946795)
        ref[4,1,1,1]=(-0.725641086216)
        ref[5,0,0,0]=(-0.294202699958)
        ref[5,0,0,1]=(0.288095939599)
        ref[5,0,1,0]=(0.110479098614)
        ref[5,0,1,1]=(-0.113972943318)
        ref[5,1,0,0]=(0.772912536924)
        ref[5,1,0,1]=(-0.883345081065)
        ref[5,1,1,0]=(-0.17097935184)
        ref[5,1,1,1]=(0.645719745504)
      else:
        arg[0,0,0]=(1.30850237165)*x[0]+(-0.0995793053275)*x[1]+(0.787886140134)*x[2]
        arg[0,0,1]=(-1.50381324493)*x[0]+(1.26609518824)*x[1]+(-0.520747554357)*x[2]
        arg[0,1,0]=(1.29770238108)*x[0]+(-1.46648704595)*x[1]+(-0.917683003599)*x[2]
        arg[0,1,1]=(-1.13525521581)*x[0]+(1.13359501358)*x[1]+(-0.222600272477)*x[2]
        arg[1,0,0]=(0.0106829054463)*x[0]+(-0.00676483709573)*x[1]+(0.109412126311)*x[2]
        arg[1,0,1]=(0.0246128795814)*x[0]+(-0.356585346511)*x[1]+(0.479157114293)*x[2]
        arg[1,1,0]=(0.541787350557)*x[0]+(-0.594934006419)*x[1]+(0.464164867381)*x[2]
        arg[1,1,1]=(-1.12100758712)*x[0]+(1.22017329117)*x[1]+(0.417565754303)*x[2]
        arg[2,0,0]=(-0.902343328228)*x[0]+(-0.118486423959)*x[1]+(0.983457082831)*x[2]
        arg[2,0,1]=(-1.32314473272)*x[0]+(1.09473600277)*x[1]+(0.526840449987)*x[2]
        arg[2,1,0]=(1.02149157674)*x[0]+(0.6830798576)*x[1]+(-0.694642330424)*x[2]
        arg[2,1,1]=(0.471980048259)*x[0]+(1.43051661856)*x[1]+(-0.591151392642)*x[2]
        arg[3,0,0]=(-0.207925182408)*x[0]+(0.644497833444)*x[1]+(0.0356376370926)*x[2]
        arg[3,0,1]=(1.91147142951)*x[0]+(-0.872318227607)*x[1]+(0.714610341379)*x[2]
        arg[3,1,0]=(-0.197729735501)*x[0]+(0.812673023114)*x[1]+(0.637138094981)*x[2]
        arg[3,1,1]=(0.103430412074)*x[0]+(0.69310435757)*x[1]+(1.54404820552)*x[2]
        arg[4,0,0]=(1.04427320711)*x[0]+(-0.655287212961)*x[1]+(0.674873379725)*x[2]
        arg[4,0,1]=(0.0300148606336)*x[0]+(-0.336581334229)*x[1]+(-0.26036930034)*x[2]
        arg[4,1,0]=(0.338077518919)*x[0]+(-0.965310125748)*x[1]+(1.66372736241)*x[2]
        arg[4,1,1]=(-0.417143696516)*x[0]+(-0.764906477186)*x[1]+(-0.406563170367)*x[2]
        arg[5,0,0]=(-0.894638979617)*x[0]+(-1.03496915396)*x[1]+(0.102679227173)*x[2]
        arg[5,0,1]=(0.777823649077)*x[0]+(0.138595909746)*x[1]+(0.570318195247)*x[2]
        arg[5,1,0]=(0.387449776869)*x[0]+(0.782752492387)*x[1]+(0.175162039427)*x[2]
        arg[5,1,1]=(-0.467369934942)*x[0]+(0.343929304184)*x[1]+(0.42227012208)*x[2]
        ref[0,0,0,0]=(1.30850237165)
        ref[0,0,0,1]=(-0.0995793053275)
        ref[0,0,0,2]=(0.787886140134)
        ref[0,0,1,0]=(-1.50381324493)
        ref[0,0,1,1]=(1.26609518824)
        ref[0,0,1,2]=(-0.520747554357)
        ref[0,1,0,0]=(1.29770238108)
        ref[0,1,0,1]=(-1.46648704595)
        ref[0,1,0,2]=(-0.917683003599)
        ref[0,1,1,0]=(-1.13525521581)
        ref[0,1,1,1]=(1.13359501358)
        ref[0,1,1,2]=(-0.222600272477)
        ref[1,0,0,0]=(0.0106829054463)
        ref[1,0,0,1]=(-0.00676483709573)
        ref[1,0,0,2]=(0.109412126311)
        ref[1,0,1,0]=(0.0246128795814)
        ref[1,0,1,1]=(-0.356585346511)
        ref[1,0,1,2]=(0.479157114293)
        ref[1,1,0,0]=(0.541787350557)
        ref[1,1,0,1]=(-0.594934006419)
        ref[1,1,0,2]=(0.464164867381)
        ref[1,1,1,0]=(-1.12100758712)
        ref[1,1,1,1]=(1.22017329117)
        ref[1,1,1,2]=(0.417565754303)
        ref[2,0,0,0]=(-0.902343328228)
        ref[2,0,0,1]=(-0.118486423959)
        ref[2,0,0,2]=(0.983457082831)
        ref[2,0,1,0]=(-1.32314473272)
        ref[2,0,1,1]=(1.09473600277)
        ref[2,0,1,2]=(0.526840449987)
        ref[2,1,0,0]=(1.02149157674)
        ref[2,1,0,1]=(0.6830798576)
        ref[2,1,0,2]=(-0.694642330424)
        ref[2,1,1,0]=(0.471980048259)
        ref[2,1,1,1]=(1.43051661856)
        ref[2,1,1,2]=(-0.591151392642)
        ref[3,0,0,0]=(-0.207925182408)
        ref[3,0,0,1]=(0.644497833444)
        ref[3,0,0,2]=(0.0356376370926)
        ref[3,0,1,0]=(1.91147142951)
        ref[3,0,1,1]=(-0.872318227607)
        ref[3,0,1,2]=(0.714610341379)
        ref[3,1,0,0]=(-0.197729735501)
        ref[3,1,0,1]=(0.812673023114)
        ref[3,1,0,2]=(0.637138094981)
        ref[3,1,1,0]=(0.103430412074)
        ref[3,1,1,1]=(0.69310435757)
        ref[3,1,1,2]=(1.54404820552)
        ref[4,0,0,0]=(1.04427320711)
        ref[4,0,0,1]=(-0.655287212961)
        ref[4,0,0,2]=(0.674873379725)
        ref[4,0,1,0]=(0.0300148606336)
        ref[4,0,1,1]=(-0.336581334229)
        ref[4,0,1,2]=(-0.26036930034)
        ref[4,1,0,0]=(0.338077518919)
        ref[4,1,0,1]=(-0.965310125748)
        ref[4,1,0,2]=(1.66372736241)
        ref[4,1,1,0]=(-0.417143696516)
        ref[4,1,1,1]=(-0.764906477186)
        ref[4,1,1,2]=(-0.406563170367)
        ref[5,0,0,0]=(-0.894638979617)
        ref[5,0,0,1]=(-1.03496915396)
        ref[5,0,0,2]=(0.102679227173)
        ref[5,0,1,0]=(0.777823649077)
        ref[5,0,1,1]=(0.138595909746)
        ref[5,0,1,2]=(0.570318195247)
        ref[5,1,0,0]=(0.387449776869)
        ref[5,1,0,1]=(0.782752492387)
        ref[5,1,0,2]=(0.175162039427)
        ref[5,1,1,0]=(-0.467369934942)
        ref[5,1,1,1]=(0.343929304184)
        ref[5,1,1,2]=(0.42227012208)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(-0.662618392141)*x[0]**o+(-0.42617914202)*x[0]+(-0.419315426864)*x[1]**o+(-0.63613129268)*x[1]
        ref[0]=o*(-0.662618392141)*x_ref[0]**(o-1)+(-0.42617914202)
        ref[1]=o*(-0.419315426864)*x_ref[1]**(o-1)+(-0.63613129268)
      else:
        s=(-0.762028198747)*x[0]**o+(0.14263183612)*x[0]+(0.185743923374)*x[1]**o+(-0.75903441887)*x[1]+(0.77116503084)*x[2]**o+(0.404561994654)*x[2]
        ref[0]=o*(-0.762028198747)*x_ref[0]**(o-1)+(0.14263183612)
        ref[1]=o*(0.185743923374)*x_ref[1]**(o-1)+(-0.75903441887)
        ref[2]=o*(0.77116503084)*x_ref[2]**(o-1)+(0.404561994654)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(0.876893099705)*x[0]**o+(-0.177079224798)*x[0]+(-0.527304645017)*x[1]**o+(-0.0349448735698)*x[1]
        s[1]=(-0.534225377579)*x[0]**o+(-0.280049692517)*x[0]+(0.912290702798)*x[1]**o+(-0.236862709157)*x[1]
        ref[0,0]=o*(0.876893099705)*x_ref[0]**(o-1)+(-0.177079224798)
        ref[0,1]=o*(-0.527304645017)*x_ref[1]**(o-1)+(-0.0349448735698)
        ref[1,0]=o*(-0.534225377579)*x_ref[0]**(o-1)+(-0.280049692517)
        ref[1,1]=o*(0.912290702798)*x_ref[1]**(o-1)+(-0.236862709157)
      else:
        s[0]=(-0.254550799071)*x[0]**o+(0.163641443345)*x[0]+(0.224143736485)*x[1]**o+(0.536806485124)*x[1]+(0.195320362214)*x[2]**o+(-0.0914207464578)*x[2]
        s[1]=(0.708798134546)*x[0]**o+(-0.572385005996)*x[0]+(-0.28510012443)*x[1]**o+(-0.305494018321)*x[1]+(-0.944999853945)*x[2]**o+(0.690936294379)*x[2]
        ref[0,0]=o*(-0.254550799071)*x_ref[0]**(o-1)+(0.163641443345)
        ref[0,1]=o*(0.224143736485)*x_ref[1]**(o-1)+(0.536806485124)
        ref[0,2]=o*(0.195320362214)*x_ref[2]**(o-1)+(-0.0914207464578)
        ref[1,0]=o*(0.708798134546)*x_ref[0]**(o-1)+(-0.572385005996)
        ref[1,1]=o*(-0.28510012443)*x_ref[1]**(o-1)+(-0.305494018321)
        ref[1,2]=o*(-0.944999853945)*x_ref[2]**(o-1)+(0.690936294379)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.555539333621)*x[0]**o+(0.568177319612)*x[0]+(-0.515690028057)*x[1]**o+(0.293250590603)*x[1]
        s[0,1]=(0.7906503945)*x[0]**o+(-0.167319950519)*x[0]+(-0.554762741045)*x[1]**o+(-0.669125892384)*x[1]
        s[0,2]=(-0.309865666451)*x[0]**o+(0.419499273794)*x[0]+(-0.563409144055)*x[1]**o+(0.734002122712)*x[1]
        s[0,3]=(-0.93657260436)*x[0]**o+(0.586601294944)*x[0]+(-0.0753458445127)*x[1]**o+(-0.429871038581)*x[1]
        s[0,4]=(-0.198003364647)*x[0]**o+(-0.76482793062)*x[0]+(-0.125188294649)*x[1]**o+(0.385219545236)*x[1]
        s[1,0]=(-0.179923035467)*x[0]**o+(0.962110768245)*x[0]+(0.422898666863)*x[1]**o+(-0.92193819062)*x[1]
        s[1,1]=(-0.490610670554)*x[0]**o+(-0.876474842232)*x[0]+(-0.870535201491)*x[1]**o+(-0.208576590799)*x[1]
        s[1,2]=(0.625747905975)*x[0]**o+(0.766151918225)*x[0]+(-0.865271283252)*x[1]**o+(-0.984130648049)*x[1]
        s[1,3]=(0.21674453499)*x[0]**o+(0.74684159223)*x[0]+(0.968938733366)*x[1]**o+(-0.980174574707)*x[1]
        s[1,4]=(0.15542486304)*x[0]**o+(-0.288729546241)*x[0]+(0.780533404805)*x[1]**o+(0.201416001866)*x[1]
        s[2,0]=(0.353102047108)*x[0]**o+(-0.388306135155)*x[0]+(0.837210776206)*x[1]**o+(0.775323252612)*x[1]
        s[2,1]=(-0.407280915312)*x[0]**o+(-0.53768541262)*x[0]+(0.893214604403)*x[1]**o+(-0.69705043663)*x[1]
        s[2,2]=(-0.447169656337)*x[0]**o+(0.728088534193)*x[0]+(0.0485994009494)*x[1]**o+(-0.503223824878)*x[1]
        s[2,3]=(-0.19757745902)*x[0]**o+(-0.627533475183)*x[0]+(0.962502499281)*x[1]**o+(0.859404568594)*x[1]
        s[2,4]=(-0.796987077625)*x[0]**o+(0.0568885495838)*x[0]+(0.84204928286)*x[1]**o+(0.521081919225)*x[1]
        s[3,0]=(-0.310704277911)*x[0]**o+(0.768329284718)*x[0]+(0.348908427651)*x[1]**o+(0.403870270277)*x[1]
        s[3,1]=(0.655277014208)*x[0]**o+(-0.770568143234)*x[0]+(0.101447715545)*x[1]**o+(0.525372367142)*x[1]
        s[3,2]=(-0.450815491992)*x[0]**o+(0.267341563784)*x[0]+(0.666360532863)*x[1]**o+(0.25468870732)*x[1]
        s[3,3]=(-0.448798233791)*x[0]**o+(0.825032894501)*x[0]+(0.0555349523209)*x[1]**o+(0.168286007255)*x[1]
        s[3,4]=(-0.260484305029)*x[0]**o+(0.265463408379)*x[0]+(0.147356758821)*x[1]**o+(-0.916280010272)*x[1]
        ref[0,0,0]=o*(-0.555539333621)*x_ref[0]**(o-1)+(0.568177319612)
        ref[0,0,1]=o*(-0.515690028057)*x_ref[1]**(o-1)+(0.293250590603)
        ref[0,1,0]=o*(0.7906503945)*x_ref[0]**(o-1)+(-0.167319950519)
        ref[0,1,1]=o*(-0.554762741045)*x_ref[1]**(o-1)+(-0.669125892384)
        ref[0,2,0]=o*(-0.309865666451)*x_ref[0]**(o-1)+(0.419499273794)
        ref[0,2,1]=o*(-0.563409144055)*x_ref[1]**(o-1)+(0.734002122712)
        ref[0,3,0]=o*(-0.93657260436)*x_ref[0]**(o-1)+(0.586601294944)
        ref[0,3,1]=o*(-0.0753458445127)*x_ref[1]**(o-1)+(-0.429871038581)
        ref[0,4,0]=o*(-0.198003364647)*x_ref[0]**(o-1)+(-0.76482793062)
        ref[0,4,1]=o*(-0.125188294649)*x_ref[1]**(o-1)+(0.385219545236)
        ref[1,0,0]=o*(-0.179923035467)*x_ref[0]**(o-1)+(0.962110768245)
        ref[1,0,1]=o*(0.422898666863)*x_ref[1]**(o-1)+(-0.92193819062)
        ref[1,1,0]=o*(-0.490610670554)*x_ref[0]**(o-1)+(-0.876474842232)
        ref[1,1,1]=o*(-0.870535201491)*x_ref[1]**(o-1)+(-0.208576590799)
        ref[1,2,0]=o*(0.625747905975)*x_ref[0]**(o-1)+(0.766151918225)
        ref[1,2,1]=o*(-0.865271283252)*x_ref[1]**(o-1)+(-0.984130648049)
        ref[1,3,0]=o*(0.21674453499)*x_ref[0]**(o-1)+(0.74684159223)
        ref[1,3,1]=o*(0.968938733366)*x_ref[1]**(o-1)+(-0.980174574707)
        ref[1,4,0]=o*(0.15542486304)*x_ref[0]**(o-1)+(-0.288729546241)
        ref[1,4,1]=o*(0.780533404805)*x_ref[1]**(o-1)+(0.201416001866)
        ref[2,0,0]=o*(0.353102047108)*x_ref[0]**(o-1)+(-0.388306135155)
        ref[2,0,1]=o*(0.837210776206)*x_ref[1]**(o-1)+(0.775323252612)
        ref[2,1,0]=o*(-0.407280915312)*x_ref[0]**(o-1)+(-0.53768541262)
        ref[2,1,1]=o*(0.893214604403)*x_ref[1]**(o-1)+(-0.69705043663)
        ref[2,2,0]=o*(-0.447169656337)*x_ref[0]**(o-1)+(0.728088534193)
        ref[2,2,1]=o*(0.0485994009494)*x_ref[1]**(o-1)+(-0.503223824878)
        ref[2,3,0]=o*(-0.19757745902)*x_ref[0]**(o-1)+(-0.627533475183)
        ref[2,3,1]=o*(0.962502499281)*x_ref[1]**(o-1)+(0.859404568594)
        ref[2,4,0]=o*(-0.796987077625)*x_ref[0]**(o-1)+(0.0568885495838)
        ref[2,4,1]=o*(0.84204928286)*x_ref[1]**(o-1)+(0.521081919225)
        ref[3,0,0]=o*(-0.310704277911)*x_ref[0]**(o-1)+(0.768329284718)
        ref[3,0,1]=o*(0.348908427651)*x_ref[1]**(o-1)+(0.403870270277)
        ref[3,1,0]=o*(0.655277014208)*x_ref[0]**(o-1)+(-0.770568143234)
        ref[3,1,1]=o*(0.101447715545)*x_ref[1]**(o-1)+(0.525372367142)
        ref[3,2,0]=o*(-0.450815491992)*x_ref[0]**(o-1)+(0.267341563784)
        ref[3,2,1]=o*(0.666360532863)*x_ref[1]**(o-1)+(0.25468870732)
        ref[3,3,0]=o*(-0.448798233791)*x_ref[0]**(o-1)+(0.825032894501)
        ref[3,3,1]=o*(0.0555349523209)*x_ref[1]**(o-1)+(0.168286007255)
        ref[3,4,0]=o*(-0.260484305029)*x_ref[0]**(o-1)+(0.265463408379)
        ref[3,4,1]=o*(0.147356758821)*x_ref[1]**(o-1)+(-0.916280010272)
      else:
        s[0,0]=(0.344242828216)*x[0]**o+(0.491144523585)*x[0]+(-0.92238663597)*x[1]**o+(0.655901250824)*x[1]+(0.683755311378)*x[2]**o+(-0.499214028484)*x[2]
        s[0,1]=(0.246950598177)*x[0]**o+(0.690983811313)*x[0]+(0.0441182184921)*x[1]**o+(-0.236074195046)*x[1]+(-0.365664761621)*x[2]**o+(0.406464337338)*x[2]
        s[0,2]=(-0.327739540606)*x[0]**o+(-0.96200067317)*x[0]+(-0.634811990063)*x[1]**o+(-0.0028455698091)*x[1]+(-0.773566753548)*x[2]**o+(-0.944614851063)*x[2]
        s[0,3]=(-0.423726389514)*x[0]**o+(0.930379169254)*x[0]+(0.551259733694)*x[1]**o+(-0.277405976565)*x[1]+(0.429454682659)*x[2]**o+(0.665041921999)*x[2]
        s[0,4]=(-0.808919025592)*x[0]**o+(0.527988478329)*x[0]+(0.598427398457)*x[1]**o+(-0.740120252678)*x[1]+(-0.57495557526)*x[2]**o+(-0.09358843573)*x[2]
        s[1,0]=(0.139579066196)*x[0]**o+(0.64838866949)*x[0]+(-0.310649190227)*x[1]**o+(-0.947998845563)*x[1]+(0.15735741361)*x[2]**o+(0.521031688881)*x[2]
        s[1,1]=(0.3564671327)*x[0]**o+(0.44368001644)*x[0]+(-0.867803053218)*x[1]**o+(-0.808576642073)*x[1]+(0.164399621384)*x[2]**o+(-0.929324362594)*x[2]
        s[1,2]=(-0.719971382108)*x[0]**o+(-0.509264166588)*x[0]+(0.880679383007)*x[1]**o+(0.150377261228)*x[1]+(-0.695573153702)*x[2]**o+(-0.504859578896)*x[2]
        s[1,3]=(0.19999237262)*x[0]**o+(0.301010290809)*x[0]+(-0.761383660349)*x[1]**o+(-0.943121991098)*x[1]+(-0.824426064219)*x[2]**o+(-0.288809145407)*x[2]
        s[1,4]=(0.0209332296639)*x[0]**o+(-0.745572124803)*x[0]+(0.649794969638)*x[1]**o+(0.997896690337)*x[1]+(0.245116895509)*x[2]**o+(0.934427411594)*x[2]
        s[2,0]=(-0.415649481447)*x[0]**o+(0.967011773751)*x[0]+(0.850275812024)*x[1]**o+(0.368460051013)*x[1]+(-0.895648484555)*x[2]**o+(-0.748318156303)*x[2]
        s[2,1]=(0.822253194356)*x[0]**o+(-0.209207542819)*x[0]+(-0.323961739942)*x[1]**o+(-0.108506915189)*x[1]+(0.39419174146)*x[2]**o+(-0.880778942413)*x[2]
        s[2,2]=(0.730106025416)*x[0]**o+(-0.0921212828406)*x[0]+(-0.0790190498056)*x[1]**o+(0.456083884786)*x[1]+(-0.226537921015)*x[2]**o+(0.293694285152)*x[2]
        s[2,3]=(-0.978825730702)*x[0]**o+(-0.914905098143)*x[0]+(-0.110991764399)*x[1]**o+(-0.144744770355)*x[1]+(0.625189542344)*x[2]**o+(0.804751738687)*x[2]
        s[2,4]=(0.862409094298)*x[0]**o+(-0.953204890595)*x[0]+(-0.66083629488)*x[1]**o+(0.892835328867)*x[1]+(-0.724419944382)*x[2]**o+(-0.352952976454)*x[2]
        s[3,0]=(0.518573942986)*x[0]**o+(0.525366624319)*x[0]+(-0.184521233411)*x[1]**o+(-0.577732664805)*x[1]+(0.194495181041)*x[2]**o+(-0.651069449215)*x[2]
        s[3,1]=(-0.900134328609)*x[0]**o+(-0.502594184837)*x[0]+(0.972006928979)*x[1]**o+(-0.58560991354)*x[1]+(0.423531955361)*x[2]**o+(-0.149983453241)*x[2]
        s[3,2]=(-0.949776951808)*x[0]**o+(-0.557083489688)*x[0]+(-0.860426216679)*x[1]**o+(0.740745372034)*x[1]+(-0.770598389143)*x[2]**o+(0.576226272811)*x[2]
        s[3,3]=(0.947181609851)*x[0]**o+(0.624290827777)*x[0]+(0.163876818237)*x[1]**o+(-0.881648295139)*x[1]+(0.460250347501)*x[2]**o+(0.278384518072)*x[2]
        s[3,4]=(-0.235115463614)*x[0]**o+(-0.608162950212)*x[0]+(-0.942527781961)*x[1]**o+(-0.473027994027)*x[1]+(0.784701664346)*x[2]**o+(0.67497154466)*x[2]
        ref[0,0,0]=o*(0.344242828216)*x_ref[0]**(o-1)+(0.491144523585)
        ref[0,0,1]=o*(-0.92238663597)*x_ref[1]**(o-1)+(0.655901250824)
        ref[0,0,2]=o*(0.683755311378)*x_ref[2]**(o-1)+(-0.499214028484)
        ref[0,1,0]=o*(0.246950598177)*x_ref[0]**(o-1)+(0.690983811313)
        ref[0,1,1]=o*(0.0441182184921)*x_ref[1]**(o-1)+(-0.236074195046)
        ref[0,1,2]=o*(-0.365664761621)*x_ref[2]**(o-1)+(0.406464337338)
        ref[0,2,0]=o*(-0.327739540606)*x_ref[0]**(o-1)+(-0.96200067317)
        ref[0,2,1]=o*(-0.634811990063)*x_ref[1]**(o-1)+(-0.0028455698091)
        ref[0,2,2]=o*(-0.773566753548)*x_ref[2]**(o-1)+(-0.944614851063)
        ref[0,3,0]=o*(-0.423726389514)*x_ref[0]**(o-1)+(0.930379169254)
        ref[0,3,1]=o*(0.551259733694)*x_ref[1]**(o-1)+(-0.277405976565)
        ref[0,3,2]=o*(0.429454682659)*x_ref[2]**(o-1)+(0.665041921999)
        ref[0,4,0]=o*(-0.808919025592)*x_ref[0]**(o-1)+(0.527988478329)
        ref[0,4,1]=o*(0.598427398457)*x_ref[1]**(o-1)+(-0.740120252678)
        ref[0,4,2]=o*(-0.57495557526)*x_ref[2]**(o-1)+(-0.09358843573)
        ref[1,0,0]=o*(0.139579066196)*x_ref[0]**(o-1)+(0.64838866949)
        ref[1,0,1]=o*(-0.310649190227)*x_ref[1]**(o-1)+(-0.947998845563)
        ref[1,0,2]=o*(0.15735741361)*x_ref[2]**(o-1)+(0.521031688881)
        ref[1,1,0]=o*(0.3564671327)*x_ref[0]**(o-1)+(0.44368001644)
        ref[1,1,1]=o*(-0.867803053218)*x_ref[1]**(o-1)+(-0.808576642073)
        ref[1,1,2]=o*(0.164399621384)*x_ref[2]**(o-1)+(-0.929324362594)
        ref[1,2,0]=o*(-0.719971382108)*x_ref[0]**(o-1)+(-0.509264166588)
        ref[1,2,1]=o*(0.880679383007)*x_ref[1]**(o-1)+(0.150377261228)
        ref[1,2,2]=o*(-0.695573153702)*x_ref[2]**(o-1)+(-0.504859578896)
        ref[1,3,0]=o*(0.19999237262)*x_ref[0]**(o-1)+(0.301010290809)
        ref[1,3,1]=o*(-0.761383660349)*x_ref[1]**(o-1)+(-0.943121991098)
        ref[1,3,2]=o*(-0.824426064219)*x_ref[2]**(o-1)+(-0.288809145407)
        ref[1,4,0]=o*(0.0209332296639)*x_ref[0]**(o-1)+(-0.745572124803)
        ref[1,4,1]=o*(0.649794969638)*x_ref[1]**(o-1)+(0.997896690337)
        ref[1,4,2]=o*(0.245116895509)*x_ref[2]**(o-1)+(0.934427411594)
        ref[2,0,0]=o*(-0.415649481447)*x_ref[0]**(o-1)+(0.967011773751)
        ref[2,0,1]=o*(0.850275812024)*x_ref[1]**(o-1)+(0.368460051013)
        ref[2,0,2]=o*(-0.895648484555)*x_ref[2]**(o-1)+(-0.748318156303)
        ref[2,1,0]=o*(0.822253194356)*x_ref[0]**(o-1)+(-0.209207542819)
        ref[2,1,1]=o*(-0.323961739942)*x_ref[1]**(o-1)+(-0.108506915189)
        ref[2,1,2]=o*(0.39419174146)*x_ref[2]**(o-1)+(-0.880778942413)
        ref[2,2,0]=o*(0.730106025416)*x_ref[0]**(o-1)+(-0.0921212828406)
        ref[2,2,1]=o*(-0.0790190498056)*x_ref[1]**(o-1)+(0.456083884786)
        ref[2,2,2]=o*(-0.226537921015)*x_ref[2]**(o-1)+(0.293694285152)
        ref[2,3,0]=o*(-0.978825730702)*x_ref[0]**(o-1)+(-0.914905098143)
        ref[2,3,1]=o*(-0.110991764399)*x_ref[1]**(o-1)+(-0.144744770355)
        ref[2,3,2]=o*(0.625189542344)*x_ref[2]**(o-1)+(0.804751738687)
        ref[2,4,0]=o*(0.862409094298)*x_ref[0]**(o-1)+(-0.953204890595)
        ref[2,4,1]=o*(-0.66083629488)*x_ref[1]**(o-1)+(0.892835328867)
        ref[2,4,2]=o*(-0.724419944382)*x_ref[2]**(o-1)+(-0.352952976454)
        ref[3,0,0]=o*(0.518573942986)*x_ref[0]**(o-1)+(0.525366624319)
        ref[3,0,1]=o*(-0.184521233411)*x_ref[1]**(o-1)+(-0.577732664805)
        ref[3,0,2]=o*(0.194495181041)*x_ref[2]**(o-1)+(-0.651069449215)
        ref[3,1,0]=o*(-0.900134328609)*x_ref[0]**(o-1)+(-0.502594184837)
        ref[3,1,1]=o*(0.972006928979)*x_ref[1]**(o-1)+(-0.58560991354)
        ref[3,1,2]=o*(0.423531955361)*x_ref[2]**(o-1)+(-0.149983453241)
        ref[3,2,0]=o*(-0.949776951808)*x_ref[0]**(o-1)+(-0.557083489688)
        ref[3,2,1]=o*(-0.860426216679)*x_ref[1]**(o-1)+(0.740745372034)
        ref[3,2,2]=o*(-0.770598389143)*x_ref[2]**(o-1)+(0.576226272811)
        ref[3,3,0]=o*(0.947181609851)*x_ref[0]**(o-1)+(0.624290827777)
        ref[3,3,1]=o*(0.163876818237)*x_ref[1]**(o-1)+(-0.881648295139)
        ref[3,3,2]=o*(0.460250347501)*x_ref[2]**(o-1)+(0.278384518072)
        ref[3,4,0]=o*(-0.235115463614)*x_ref[0]**(o-1)+(-0.608162950212)
        ref[3,4,1]=o*(-0.942527781961)*x_ref[1]**(o-1)+(-0.473027994027)
        ref[3,4,2]=o*(0.784701664346)*x_ref[2]**(o-1)+(0.67497154466)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Symbol on the Function

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(-0.19873307647)*x[0]**o+(-0.402324928722)*x[0]+(0.78581260176)*x[1]**o+(0.855692742935)*x[1]
        s[0,0,1]=(-0.976563405673)*x[0]**o+(0.100149365141)*x[0]+(0.630689651275)*x[1]**o+(0.601727769629)*x[1]
        s[0,1,0]=(-0.832835486573)*x[0]**o+(0.0671587043511)*x[0]+(-0.610210594342)*x[1]**o+(-0.436026877569)*x[1]
        s[0,1,1]=(0.292942538448)*x[0]**o+(0.0385459359421)*x[0]+(0.790299248934)*x[1]**o+(-0.319413494032)*x[1]
        s[1,0,0]=(0.58698003273)*x[0]**o+(0.613088892876)*x[0]+(0.552617483007)*x[1]**o+(0.720306398451)*x[1]
        s[1,0,1]=(0.955352789796)*x[0]**o+(0.174378913925)*x[0]+(-0.0314000136685)*x[1]**o+(0.959578237088)*x[1]
        s[1,1,0]=(0.281022820802)*x[0]**o+(0.326052665369)*x[0]+(-0.492525348509)*x[1]**o+(-0.466634839923)*x[1]
        s[1,1,1]=(0.479963735062)*x[0]**o+(-0.779437072555)*x[0]+(-0.208397089582)*x[1]**o+(-0.303640352239)*x[1]
        s[2,0,0]=(0.434668114042)*x[0]**o+(0.0691902144608)*x[0]+(-0.177103703295)*x[1]**o+(0.91338709789)*x[1]
        s[2,0,1]=(-0.476825738275)*x[0]**o+(0.819380857167)*x[0]+(-0.661832108828)*x[1]**o+(0.873879046431)*x[1]
        s[2,1,0]=(0.30919914009)*x[0]**o+(-0.0366057876782)*x[0]+(-0.966956881285)*x[1]**o+(-0.829788683577)*x[1]
        s[2,1,1]=(-0.168382165296)*x[0]**o+(-0.682198962507)*x[0]+(0.190572223366)*x[1]**o+(-0.667568574676)*x[1]
        s[3,0,0]=(0.668658559933)*x[0]**o+(-0.253060573754)*x[0]+(-0.864766645952)*x[1]**o+(-0.714197991697)*x[1]
        s[3,0,1]=(0.538191340464)*x[0]**o+(0.806266803991)*x[0]+(0.437103643795)*x[1]**o+(0.972593986026)*x[1]
        s[3,1,0]=(-0.120672797742)*x[0]**o+(0.840236886959)*x[0]+(-0.279061306399)*x[1]**o+(0.119529093461)*x[1]
        s[3,1,1]=(-0.405723067833)*x[0]**o+(-0.964291783264)*x[0]+(0.201561553981)*x[1]**o+(0.882148297909)*x[1]
        s[4,0,0]=(-0.501360654417)*x[0]**o+(-0.977210439162)*x[0]+(0.0742786636276)*x[1]**o+(-0.831462191269)*x[1]
        s[4,0,1]=(-0.354758190164)*x[0]**o+(0.737302507124)*x[0]+(-0.221806769305)*x[1]**o+(-0.0261943694435)*x[1]
        s[4,1,0]=(-0.921367050665)*x[0]**o+(-0.77028348328)*x[0]+(-0.799765110774)*x[1]**o+(-0.708684233564)*x[1]
        s[4,1,1]=(-0.764817738089)*x[0]**o+(0.13308831245)*x[0]+(-0.0835084988678)*x[1]**o+(0.181328374835)*x[1]
        s[5,0,0]=(0.0795012634978)*x[0]**o+(0.527681277019)*x[0]+(-0.0656230383346)*x[1]**o+(0.0884801523765)*x[1]
        s[5,0,1]=(-0.316260178996)*x[0]**o+(-0.372232635711)*x[0]+(0.868288352534)*x[1]**o+(0.22823979163)*x[1]
        s[5,1,0]=(0.655698586327)*x[0]**o+(-0.734551617528)*x[0]+(-0.627595993352)*x[1]**o+(0.485738750199)*x[1]
        s[5,1,1]=(-0.522687357394)*x[0]**o+(-0.232523849025)*x[0]+(0.559349644178)*x[1]**o+(-0.640468984193)*x[1]
        ref[0,0,0,0]=o*(-0.19873307647)*x_ref[0]**(o-1)+(-0.402324928722)
        ref[0,0,0,1]=o*(0.78581260176)*x_ref[1]**(o-1)+(0.855692742935)
        ref[0,0,1,0]=o*(-0.976563405673)*x_ref[0]**(o-1)+(0.100149365141)
        ref[0,0,1,1]=o*(0.630689651275)*x_ref[1]**(o-1)+(0.601727769629)
        ref[0,1,0,0]=o*(-0.832835486573)*x_ref[0]**(o-1)+(0.0671587043511)
        ref[0,1,0,1]=o*(-0.610210594342)*x_ref[1]**(o-1)+(-0.436026877569)
        ref[0,1,1,0]=o*(0.292942538448)*x_ref[0]**(o-1)+(0.0385459359421)
        ref[0,1,1,1]=o*(0.790299248934)*x_ref[1]**(o-1)+(-0.319413494032)
        ref[1,0,0,0]=o*(0.58698003273)*x_ref[0]**(o-1)+(0.613088892876)
        ref[1,0,0,1]=o*(0.552617483007)*x_ref[1]**(o-1)+(0.720306398451)
        ref[1,0,1,0]=o*(0.955352789796)*x_ref[0]**(o-1)+(0.174378913925)
        ref[1,0,1,1]=o*(-0.0314000136685)*x_ref[1]**(o-1)+(0.959578237088)
        ref[1,1,0,0]=o*(0.281022820802)*x_ref[0]**(o-1)+(0.326052665369)
        ref[1,1,0,1]=o*(-0.492525348509)*x_ref[1]**(o-1)+(-0.466634839923)
        ref[1,1,1,0]=o*(0.479963735062)*x_ref[0]**(o-1)+(-0.779437072555)
        ref[1,1,1,1]=o*(-0.208397089582)*x_ref[1]**(o-1)+(-0.303640352239)
        ref[2,0,0,0]=o*(0.434668114042)*x_ref[0]**(o-1)+(0.0691902144608)
        ref[2,0,0,1]=o*(-0.177103703295)*x_ref[1]**(o-1)+(0.91338709789)
        ref[2,0,1,0]=o*(-0.476825738275)*x_ref[0]**(o-1)+(0.819380857167)
        ref[2,0,1,1]=o*(-0.661832108828)*x_ref[1]**(o-1)+(0.873879046431)
        ref[2,1,0,0]=o*(0.30919914009)*x_ref[0]**(o-1)+(-0.0366057876782)
        ref[2,1,0,1]=o*(-0.966956881285)*x_ref[1]**(o-1)+(-0.829788683577)
        ref[2,1,1,0]=o*(-0.168382165296)*x_ref[0]**(o-1)+(-0.682198962507)
        ref[2,1,1,1]=o*(0.190572223366)*x_ref[1]**(o-1)+(-0.667568574676)
        ref[3,0,0,0]=o*(0.668658559933)*x_ref[0]**(o-1)+(-0.253060573754)
        ref[3,0,0,1]=o*(-0.864766645952)*x_ref[1]**(o-1)+(-0.714197991697)
        ref[3,0,1,0]=o*(0.538191340464)*x_ref[0]**(o-1)+(0.806266803991)
        ref[3,0,1,1]=o*(0.437103643795)*x_ref[1]**(o-1)+(0.972593986026)
        ref[3,1,0,0]=o*(-0.120672797742)*x_ref[0]**(o-1)+(0.840236886959)
        ref[3,1,0,1]=o*(-0.279061306399)*x_ref[1]**(o-1)+(0.119529093461)
        ref[3,1,1,0]=o*(-0.405723067833)*x_ref[0]**(o-1)+(-0.964291783264)
        ref[3,1,1,1]=o*(0.201561553981)*x_ref[1]**(o-1)+(0.882148297909)
        ref[4,0,0,0]=o*(-0.501360654417)*x_ref[0]**(o-1)+(-0.977210439162)
        ref[4,0,0,1]=o*(0.0742786636276)*x_ref[1]**(o-1)+(-0.831462191269)
        ref[4,0,1,0]=o*(-0.354758190164)*x_ref[0]**(o-1)+(0.737302507124)
        ref[4,0,1,1]=o*(-0.221806769305)*x_ref[1]**(o-1)+(-0.0261943694435)
        ref[4,1,0,0]=o*(-0.921367050665)*x_ref[0]**(o-1)+(-0.77028348328)
        ref[4,1,0,1]=o*(-0.799765110774)*x_ref[1]**(o-1)+(-0.708684233564)
        ref[4,1,1,0]=o*(-0.764817738089)*x_ref[0]**(o-1)+(0.13308831245)
        ref[4,1,1,1]=o*(-0.0835084988678)*x_ref[1]**(o-1)+(0.181328374835)
        ref[5,0,0,0]=o*(0.0795012634978)*x_ref[0]**(o-1)+(0.527681277019)
        ref[5,0,0,1]=o*(-0.0656230383346)*x_ref[1]**(o-1)+(0.0884801523765)
        ref[5,0,1,0]=o*(-0.316260178996)*x_ref[0]**(o-1)+(-0.372232635711)
        ref[5,0,1,1]=o*(0.868288352534)*x_ref[1]**(o-1)+(0.22823979163)
        ref[5,1,0,0]=o*(0.655698586327)*x_ref[0]**(o-1)+(-0.734551617528)
        ref[5,1,0,1]=o*(-0.627595993352)*x_ref[1]**(o-1)+(0.485738750199)
        ref[5,1,1,0]=o*(-0.522687357394)*x_ref[0]**(o-1)+(-0.232523849025)
        ref[5,1,1,1]=o*(0.559349644178)*x_ref[1]**(o-1)+(-0.640468984193)
      else:
        s[0,0,0]=(-0.252254362053)*x[0]**o+(-0.73201258434)*x[0]+(0.129279219807)*x[1]**o+(0.739511847421)*x[1]+(-0.335757163655)*x[2]**o+(0.645975465365)*x[2]
        s[0,0,1]=(-0.735055416054)*x[0]**o+(-0.392972979059)*x[0]+(-0.400312505739)*x[1]**o+(-0.431371712491)*x[1]+(0.570395624547)*x[2]**o+(0.138472351049)*x[2]
        s[0,1,0]=(-0.000809920184319)*x[0]**o+(0.39610549699)*x[0]+(0.46183657032)*x[1]**o+(-0.90835208084)*x[1]+(0.359160987844)*x[2]**o+(0.63185061127)*x[2]
        s[0,1,1]=(0.627804065013)*x[0]**o+(-0.616378680528)*x[0]+(-0.623715533085)*x[1]**o+(-0.457832375425)*x[1]+(-0.274712768232)*x[2]**o+(0.425333514519)*x[2]
        s[1,0,0]=(-0.901107526813)*x[0]**o+(0.0680326855019)*x[0]+(-0.24023047937)*x[1]**o+(0.33244773534)*x[1]+(0.649715117184)*x[2]**o+(-0.832757442484)*x[2]
        s[1,0,1]=(0.419698786285)*x[0]**o+(-0.929558931125)*x[0]+(-0.211068611062)*x[1]**o+(-0.308568292995)*x[1]+(-0.302460643894)*x[2]**o+(-0.792090369968)*x[2]
        s[1,1,0]=(-0.350071906565)*x[0]**o+(0.915476959141)*x[0]+(0.511206427652)*x[1]**o+(0.925740134945)*x[1]+(-0.163642337237)*x[2]**o+(0.466249765823)*x[2]
        s[1,1,1]=(-0.00679707570295)*x[0]**o+(-0.20076295244)*x[0]+(0.264205579203)*x[1]**o+(-0.411292187293)*x[1]+(-0.934377917835)*x[2]**o+(0.634215851155)*x[2]
        s[2,0,0]=(-0.324841664958)*x[0]**o+(-0.956529004217)*x[0]+(-0.918338753073)*x[1]**o+(0.626923365653)*x[1]+(-0.799444332565)*x[2]**o+(-0.0695464844552)*x[2]
        s[2,0,1]=(0.506623201982)*x[0]**o+(-0.149035848663)*x[0]+(-0.238527222625)*x[1]**o+(0.179414470428)*x[1]+(-0.830587331222)*x[2]**o+(-0.771223952622)*x[2]
        s[2,1,0]=(-0.600971886655)*x[0]**o+(0.578997478246)*x[0]+(0.307807603149)*x[1]**o+(-0.187632470569)*x[1]+(0.715704085441)*x[2]**o+(0.666008020335)*x[2]
        s[2,1,1]=(-0.927640726378)*x[0]**o+(-0.615258128661)*x[0]+(0.0458637924464)*x[1]**o+(0.316776923148)*x[1]+(-0.816443096595)*x[2]**o+(0.586050614098)*x[2]
        s[3,0,0]=(0.0116773788954)*x[0]**o+(-0.450016183617)*x[0]+(-0.722050331425)*x[1]**o+(-0.752741628658)*x[1]+(0.0807023425045)*x[2]**o+(-0.888353661711)*x[2]
        s[3,0,1]=(0.774410128748)*x[0]**o+(0.00319037654241)*x[0]+(-0.872810066503)*x[1]**o+(-0.667066572773)*x[1]+(0.87558896843)*x[2]**o+(-0.691829241879)*x[2]
        s[3,1,0]=(-0.81762346888)*x[0]**o+(0.117005969026)*x[0]+(-0.745835352632)*x[1]**o+(-0.162993479637)*x[1]+(0.259977485657)*x[2]**o+(-0.4154446656)*x[2]
        s[3,1,1]=(0.0202189083822)*x[0]**o+(0.276300397225)*x[0]+(-0.473252990801)*x[1]**o+(0.139373130343)*x[1]+(0.236401212883)*x[2]**o+(0.250980379862)*x[2]
        s[4,0,0]=(0.114221091454)*x[0]**o+(0.956199921345)*x[0]+(0.920335553649)*x[1]**o+(0.953720056733)*x[1]+(-0.869205945463)*x[2]**o+(-0.702596947421)*x[2]
        s[4,0,1]=(0.242788249724)*x[0]**o+(0.484618105306)*x[0]+(-0.0856836792276)*x[1]**o+(0.314175782784)*x[1]+(-0.462603325333)*x[2]**o+(-0.527952799625)*x[2]
        s[4,1,0]=(0.124168860106)*x[0]**o+(-0.846086223242)*x[0]+(-0.536186421788)*x[1]**o+(-0.103140610306)*x[1]+(-0.115670483732)*x[2]**o+(0.771594201067)*x[2]
        s[4,1,1]=(0.649717322503)*x[0]**o+(0.911557314842)*x[0]+(-0.498767014909)*x[1]**o+(0.647065328805)*x[1]+(0.722903839932)*x[2]**o+(0.514148167148)*x[2]
        s[5,0,0]=(-0.380297540184)*x[0]**o+(-0.485514278978)*x[0]+(0.785198036928)*x[1]**o+(-0.0846164275939)*x[1]+(-0.252406925767)*x[2]**o+(-0.223499486716)*x[2]
        s[5,0,1]=(-0.184173490174)*x[0]**o+(0.569523639256)*x[0]+(-0.294243155077)*x[1]**o+(-0.323071302538)*x[1]+(0.661442924711)*x[2]**o+(0.640705614167)*x[2]
        s[5,1,0]=(0.110804523334)*x[0]**o+(-0.933148550901)*x[0]+(-0.664439117013)*x[1]**o+(-0.33712595594)*x[1]+(0.0561563633834)*x[2]**o+(-0.728089270393)*x[2]
        s[5,1,1]=(-0.474826954962)*x[0]**o+(0.953336718849)*x[0]+(0.616224037612)*x[1]**o+(0.596223200958)*x[1]+(-0.790460006091)*x[2]**o+(0.580623251887)*x[2]
        ref[0,0,0,0]=o*(-0.252254362053)*x_ref[0]**(o-1)+(-0.73201258434)
        ref[0,0,0,1]=o*(0.129279219807)*x_ref[1]**(o-1)+(0.739511847421)
        ref[0,0,0,2]=o*(-0.335757163655)*x_ref[2]**(o-1)+(0.645975465365)
        ref[0,0,1,0]=o*(-0.735055416054)*x_ref[0]**(o-1)+(-0.392972979059)
        ref[0,0,1,1]=o*(-0.400312505739)*x_ref[1]**(o-1)+(-0.431371712491)
        ref[0,0,1,2]=o*(0.570395624547)*x_ref[2]**(o-1)+(0.138472351049)
        ref[0,1,0,0]=o*(-0.000809920184319)*x_ref[0]**(o-1)+(0.39610549699)
        ref[0,1,0,1]=o*(0.46183657032)*x_ref[1]**(o-1)+(-0.90835208084)
        ref[0,1,0,2]=o*(0.359160987844)*x_ref[2]**(o-1)+(0.63185061127)
        ref[0,1,1,0]=o*(0.627804065013)*x_ref[0]**(o-1)+(-0.616378680528)
        ref[0,1,1,1]=o*(-0.623715533085)*x_ref[1]**(o-1)+(-0.457832375425)
        ref[0,1,1,2]=o*(-0.274712768232)*x_ref[2]**(o-1)+(0.425333514519)
        ref[1,0,0,0]=o*(-0.901107526813)*x_ref[0]**(o-1)+(0.0680326855019)
        ref[1,0,0,1]=o*(-0.24023047937)*x_ref[1]**(o-1)+(0.33244773534)
        ref[1,0,0,2]=o*(0.649715117184)*x_ref[2]**(o-1)+(-0.832757442484)
        ref[1,0,1,0]=o*(0.419698786285)*x_ref[0]**(o-1)+(-0.929558931125)
        ref[1,0,1,1]=o*(-0.211068611062)*x_ref[1]**(o-1)+(-0.308568292995)
        ref[1,0,1,2]=o*(-0.302460643894)*x_ref[2]**(o-1)+(-0.792090369968)
        ref[1,1,0,0]=o*(-0.350071906565)*x_ref[0]**(o-1)+(0.915476959141)
        ref[1,1,0,1]=o*(0.511206427652)*x_ref[1]**(o-1)+(0.925740134945)
        ref[1,1,0,2]=o*(-0.163642337237)*x_ref[2]**(o-1)+(0.466249765823)
        ref[1,1,1,0]=o*(-0.00679707570295)*x_ref[0]**(o-1)+(-0.20076295244)
        ref[1,1,1,1]=o*(0.264205579203)*x_ref[1]**(o-1)+(-0.411292187293)
        ref[1,1,1,2]=o*(-0.934377917835)*x_ref[2]**(o-1)+(0.634215851155)
        ref[2,0,0,0]=o*(-0.324841664958)*x_ref[0]**(o-1)+(-0.956529004217)
        ref[2,0,0,1]=o*(-0.918338753073)*x_ref[1]**(o-1)+(0.626923365653)
        ref[2,0,0,2]=o*(-0.799444332565)*x_ref[2]**(o-1)+(-0.0695464844552)
        ref[2,0,1,0]=o*(0.506623201982)*x_ref[0]**(o-1)+(-0.149035848663)
        ref[2,0,1,1]=o*(-0.238527222625)*x_ref[1]**(o-1)+(0.179414470428)
        ref[2,0,1,2]=o*(-0.830587331222)*x_ref[2]**(o-1)+(-0.771223952622)
        ref[2,1,0,0]=o*(-0.600971886655)*x_ref[0]**(o-1)+(0.578997478246)
        ref[2,1,0,1]=o*(0.307807603149)*x_ref[1]**(o-1)+(-0.187632470569)
        ref[2,1,0,2]=o*(0.715704085441)*x_ref[2]**(o-1)+(0.666008020335)
        ref[2,1,1,0]=o*(-0.927640726378)*x_ref[0]**(o-1)+(-0.615258128661)
        ref[2,1,1,1]=o*(0.0458637924464)*x_ref[1]**(o-1)+(0.316776923148)
        ref[2,1,1,2]=o*(-0.816443096595)*x_ref[2]**(o-1)+(0.586050614098)
        ref[3,0,0,0]=o*(0.0116773788954)*x_ref[0]**(o-1)+(-0.450016183617)
        ref[3,0,0,1]=o*(-0.722050331425)*x_ref[1]**(o-1)+(-0.752741628658)
        ref[3,0,0,2]=o*(0.0807023425045)*x_ref[2]**(o-1)+(-0.888353661711)
        ref[3,0,1,0]=o*(0.774410128748)*x_ref[0]**(o-1)+(0.00319037654241)
        ref[3,0,1,1]=o*(-0.872810066503)*x_ref[1]**(o-1)+(-0.667066572773)
        ref[3,0,1,2]=o*(0.87558896843)*x_ref[2]**(o-1)+(-0.691829241879)
        ref[3,1,0,0]=o*(-0.81762346888)*x_ref[0]**(o-1)+(0.117005969026)
        ref[3,1,0,1]=o*(-0.745835352632)*x_ref[1]**(o-1)+(-0.162993479637)
        ref[3,1,0,2]=o*(0.259977485657)*x_ref[2]**(o-1)+(-0.4154446656)
        ref[3,1,1,0]=o*(0.0202189083822)*x_ref[0]**(o-1)+(0.276300397225)
        ref[3,1,1,1]=o*(-0.473252990801)*x_ref[1]**(o-1)+(0.139373130343)
        ref[3,1,1,2]=o*(0.236401212883)*x_ref[2]**(o-1)+(0.250980379862)
        ref[4,0,0,0]=o*(0.114221091454)*x_ref[0]**(o-1)+(0.956199921345)
        ref[4,0,0,1]=o*(0.920335553649)*x_ref[1]**(o-1)+(0.953720056733)
        ref[4,0,0,2]=o*(-0.869205945463)*x_ref[2]**(o-1)+(-0.702596947421)
        ref[4,0,1,0]=o*(0.242788249724)*x_ref[0]**(o-1)+(0.484618105306)
        ref[4,0,1,1]=o*(-0.0856836792276)*x_ref[1]**(o-1)+(0.314175782784)
        ref[4,0,1,2]=o*(-0.462603325333)*x_ref[2]**(o-1)+(-0.527952799625)
        ref[4,1,0,0]=o*(0.124168860106)*x_ref[0]**(o-1)+(-0.846086223242)
        ref[4,1,0,1]=o*(-0.536186421788)*x_ref[1]**(o-1)+(-0.103140610306)
        ref[4,1,0,2]=o*(-0.115670483732)*x_ref[2]**(o-1)+(0.771594201067)
        ref[4,1,1,0]=o*(0.649717322503)*x_ref[0]**(o-1)+(0.911557314842)
        ref[4,1,1,1]=o*(-0.498767014909)*x_ref[1]**(o-1)+(0.647065328805)
        ref[4,1,1,2]=o*(0.722903839932)*x_ref[2]**(o-1)+(0.514148167148)
        ref[5,0,0,0]=o*(-0.380297540184)*x_ref[0]**(o-1)+(-0.485514278978)
        ref[5,0,0,1]=o*(0.785198036928)*x_ref[1]**(o-1)+(-0.0846164275939)
        ref[5,0,0,2]=o*(-0.252406925767)*x_ref[2]**(o-1)+(-0.223499486716)
        ref[5,0,1,0]=o*(-0.184173490174)*x_ref[0]**(o-1)+(0.569523639256)
        ref[5,0,1,1]=o*(-0.294243155077)*x_ref[1]**(o-1)+(-0.323071302538)
        ref[5,0,1,2]=o*(0.661442924711)*x_ref[2]**(o-1)+(0.640705614167)
        ref[5,1,0,0]=o*(0.110804523334)*x_ref[0]**(o-1)+(-0.933148550901)
        ref[5,1,0,1]=o*(-0.664439117013)*x_ref[1]**(o-1)+(-0.33712595594)
        ref[5,1,0,2]=o*(0.0561563633834)*x_ref[2]**(o-1)+(-0.728089270393)
        ref[5,1,1,0]=o*(-0.474826954962)*x_ref[0]**(o-1)+(0.953336718849)
        ref[5,1,1,1]=o*(0.616224037612)*x_ref[1]**(o-1)+(0.596223200958)
        ref[5,1,1,2]=o*(-0.790460006091)*x_ref[2]**(o-1)+(0.580623251887)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_Solution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(-0.661534580714)*x[0]**o+(0.108482570281)*x[0]+(0.930475222346)*x[1]**o+(-0.560831828628)*x[1]
        ref[0]=o*(-0.661534580714)*x_ref[0]**(o-1)+(0.108482570281)
        ref[1]=o*(0.930475222346)*x_ref[1]**(o-1)+(-0.560831828628)
      else:
        s=(0.661787087481)*x[0]**o+(0.789038424245)*x[0]+(-0.172842194551)*x[1]**o+(-0.313156164165)*x[1]+(-0.521097764776)*x[2]**o+(0.879698074812)*x[2]
        ref[0]=o*(0.661787087481)*x_ref[0]**(o-1)+(0.789038424245)
        ref[1]=o*(-0.172842194551)*x_ref[1]**(o-1)+(-0.313156164165)
        ref[2]=o*(-0.521097764776)*x_ref[2]**(o-1)+(0.879698074812)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_Solution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-0.190630799823)*x[0]**o+(0.235686163485)*x[0]+(0.568780014934)*x[1]**o+(0.869208291526)*x[1]
        s[1]=(-0.637753770052)*x[0]**o+(-0.184551176704)*x[0]+(0.678386051731)*x[1]**o+(0.103311313677)*x[1]
        ref[0,0]=o*(-0.190630799823)*x_ref[0]**(o-1)+(0.235686163485)
        ref[0,1]=o*(0.568780014934)*x_ref[1]**(o-1)+(0.869208291526)
        ref[1,0]=o*(-0.637753770052)*x_ref[0]**(o-1)+(-0.184551176704)
        ref[1,1]=o*(0.678386051731)*x_ref[1]**(o-1)+(0.103311313677)
      else:
        s[0]=(0.65617389354)*x[0]**o+(-0.41233134159)*x[0]+(-0.471086791763)*x[1]**o+(0.399070328851)*x[1]+(-0.30038453779)*x[2]**o+(0.637544697206)*x[2]
        s[1]=(0.0974925575768)*x[0]**o+(0.968900636228)*x[0]+(-0.386954772478)*x[1]**o+(0.234655265071)*x[1]+(0.755549468261)*x[2]**o+(-0.119269665245)*x[2]
        ref[0,0]=o*(0.65617389354)*x_ref[0]**(o-1)+(-0.41233134159)
        ref[0,1]=o*(-0.471086791763)*x_ref[1]**(o-1)+(0.399070328851)
        ref[0,2]=o*(-0.30038453779)*x_ref[2]**(o-1)+(0.637544697206)
        ref[1,0]=o*(0.0974925575768)*x_ref[0]**(o-1)+(0.968900636228)
        ref[1,1]=o*(-0.386954772478)*x_ref[1]**(o-1)+(0.234655265071)
        ref[1,2]=o*(0.755549468261)*x_ref[2]**(o-1)+(-0.119269665245)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_Solution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.300429908481)*x[0]**o+(-0.550176774021)*x[0]+(0.313544523598)*x[1]**o+(0.191557196291)*x[1]
        s[0,1]=(0.00116867375625)*x[0]**o+(0.126481551395)*x[0]+(-0.525739733277)*x[1]**o+(0.628228355029)*x[1]
        s[0,2]=(-0.790055765486)*x[0]**o+(-0.118003096828)*x[0]+(-0.620290760565)*x[1]**o+(-0.460021810788)*x[1]
        s[0,3]=(0.800717644254)*x[0]**o+(-0.685505835346)*x[0]+(-0.382046994517)*x[1]**o+(-0.765159598284)*x[1]
        s[0,4]=(-0.295987131319)*x[0]**o+(-0.0324335264934)*x[0]+(-0.583454515945)*x[1]**o+(-0.137940341278)*x[1]
        s[1,0]=(-0.186271508459)*x[0]**o+(-0.0457260753159)*x[0]+(-0.83853233149)*x[1]**o+(0.730348417106)*x[1]
        s[1,1]=(-0.678758709357)*x[0]**o+(-0.352619765194)*x[0]+(0.850836393219)*x[1]**o+(-0.749995270113)*x[1]
        s[1,2]=(0.598004774999)*x[0]**o+(-0.764313433057)*x[0]+(-0.892691377674)*x[1]**o+(0.436164793316)*x[1]
        s[1,3]=(-0.114398805139)*x[0]**o+(0.170882318781)*x[0]+(-0.159446706481)*x[1]**o+(0.168268554115)*x[1]
        s[1,4]=(0.245440053023)*x[0]**o+(-0.391101810385)*x[0]+(-0.0621967792961)*x[1]**o+(-0.25914597073)*x[1]
        s[2,0]=(0.758930908002)*x[0]**o+(-0.137399611576)*x[0]+(-0.524730401698)*x[1]**o+(-0.68595790282)*x[1]
        s[2,1]=(-0.956320437139)*x[0]**o+(-0.741920593412)*x[0]+(0.470411496813)*x[1]**o+(-0.912492685238)*x[1]
        s[2,2]=(0.386762534234)*x[0]**o+(0.297029046975)*x[0]+(-0.999949621409)*x[1]**o+(-0.273952756751)*x[1]
        s[2,3]=(-0.137635508969)*x[0]**o+(0.0502825343025)*x[0]+(-0.856424864287)*x[1]**o+(0.501432472431)*x[1]
        s[2,4]=(0.927974425929)*x[0]**o+(-0.602904477506)*x[0]+(0.766583044002)*x[1]**o+(0.070024577589)*x[1]
        s[3,0]=(0.336864984737)*x[0]**o+(0.0974502498452)*x[0]+(-0.820387387723)*x[1]**o+(0.022457213421)*x[1]
        s[3,1]=(0.879517107747)*x[0]**o+(0.267883865556)*x[0]+(-0.795732666749)*x[1]**o+(0.81701302209)*x[1]
        s[3,2]=(-0.971853752113)*x[0]**o+(0.210482589767)*x[0]+(0.422058370831)*x[1]**o+(-0.0945771197357)*x[1]
        s[3,3]=(0.0130393893213)*x[0]**o+(0.331617264696)*x[0]+(-0.0460157855829)*x[1]**o+(0.513357385084)*x[1]
        s[3,4]=(-0.466291714481)*x[0]**o+(0.877178907345)*x[0]+(0.356001871079)*x[1]**o+(-0.755177274311)*x[1]
        ref[0,0,0]=o*(-0.300429908481)*x_ref[0]**(o-1)+(-0.550176774021)
        ref[0,0,1]=o*(0.313544523598)*x_ref[1]**(o-1)+(0.191557196291)
        ref[0,1,0]=o*(0.00116867375625)*x_ref[0]**(o-1)+(0.126481551395)
        ref[0,1,1]=o*(-0.525739733277)*x_ref[1]**(o-1)+(0.628228355029)
        ref[0,2,0]=o*(-0.790055765486)*x_ref[0]**(o-1)+(-0.118003096828)
        ref[0,2,1]=o*(-0.620290760565)*x_ref[1]**(o-1)+(-0.460021810788)
        ref[0,3,0]=o*(0.800717644254)*x_ref[0]**(o-1)+(-0.685505835346)
        ref[0,3,1]=o*(-0.382046994517)*x_ref[1]**(o-1)+(-0.765159598284)
        ref[0,4,0]=o*(-0.295987131319)*x_ref[0]**(o-1)+(-0.0324335264934)
        ref[0,4,1]=o*(-0.583454515945)*x_ref[1]**(o-1)+(-0.137940341278)
        ref[1,0,0]=o*(-0.186271508459)*x_ref[0]**(o-1)+(-0.0457260753159)
        ref[1,0,1]=o*(-0.83853233149)*x_ref[1]**(o-1)+(0.730348417106)
        ref[1,1,0]=o*(-0.678758709357)*x_ref[0]**(o-1)+(-0.352619765194)
        ref[1,1,1]=o*(0.850836393219)*x_ref[1]**(o-1)+(-0.749995270113)
        ref[1,2,0]=o*(0.598004774999)*x_ref[0]**(o-1)+(-0.764313433057)
        ref[1,2,1]=o*(-0.892691377674)*x_ref[1]**(o-1)+(0.436164793316)
        ref[1,3,0]=o*(-0.114398805139)*x_ref[0]**(o-1)+(0.170882318781)
        ref[1,3,1]=o*(-0.159446706481)*x_ref[1]**(o-1)+(0.168268554115)
        ref[1,4,0]=o*(0.245440053023)*x_ref[0]**(o-1)+(-0.391101810385)
        ref[1,4,1]=o*(-0.0621967792961)*x_ref[1]**(o-1)+(-0.25914597073)
        ref[2,0,0]=o*(0.758930908002)*x_ref[0]**(o-1)+(-0.137399611576)
        ref[2,0,1]=o*(-0.524730401698)*x_ref[1]**(o-1)+(-0.68595790282)
        ref[2,1,0]=o*(-0.956320437139)*x_ref[0]**(o-1)+(-0.741920593412)
        ref[2,1,1]=o*(0.470411496813)*x_ref[1]**(o-1)+(-0.912492685238)
        ref[2,2,0]=o*(0.386762534234)*x_ref[0]**(o-1)+(0.297029046975)
        ref[2,2,1]=o*(-0.999949621409)*x_ref[1]**(o-1)+(-0.273952756751)
        ref[2,3,0]=o*(-0.137635508969)*x_ref[0]**(o-1)+(0.0502825343025)
        ref[2,3,1]=o*(-0.856424864287)*x_ref[1]**(o-1)+(0.501432472431)
        ref[2,4,0]=o*(0.927974425929)*x_ref[0]**(o-1)+(-0.602904477506)
        ref[2,4,1]=o*(0.766583044002)*x_ref[1]**(o-1)+(0.070024577589)
        ref[3,0,0]=o*(0.336864984737)*x_ref[0]**(o-1)+(0.0974502498452)
        ref[3,0,1]=o*(-0.820387387723)*x_ref[1]**(o-1)+(0.022457213421)
        ref[3,1,0]=o*(0.879517107747)*x_ref[0]**(o-1)+(0.267883865556)
        ref[3,1,1]=o*(-0.795732666749)*x_ref[1]**(o-1)+(0.81701302209)
        ref[3,2,0]=o*(-0.971853752113)*x_ref[0]**(o-1)+(0.210482589767)
        ref[3,2,1]=o*(0.422058370831)*x_ref[1]**(o-1)+(-0.0945771197357)
        ref[3,3,0]=o*(0.0130393893213)*x_ref[0]**(o-1)+(0.331617264696)
        ref[3,3,1]=o*(-0.0460157855829)*x_ref[1]**(o-1)+(0.513357385084)
        ref[3,4,0]=o*(-0.466291714481)*x_ref[0]**(o-1)+(0.877178907345)
        ref[3,4,1]=o*(0.356001871079)*x_ref[1]**(o-1)+(-0.755177274311)
      else:
        s[0,0]=(-0.582848481634)*x[0]**o+(-0.799173040171)*x[0]+(-0.402728303622)*x[1]**o+(-0.294649773058)*x[1]+(-0.248183917161)*x[2]**o+(-0.182025430599)*x[2]
        s[0,1]=(0.421723448079)*x[0]**o+(-0.881083512259)*x[0]+(-0.411609580693)*x[1]**o+(-0.60866119666)*x[1]+(0.447246876403)*x[2]**o+(-0.566693550375)*x[2]
        s[0,2]=(0.676859700236)*x[0]**o+(-0.0721141912983)*x[0]+(-0.930202067587)*x[1]**o+(-0.779660291535)*x[1]+(-0.846576347271)*x[2]**o+(0.182815431369)*x[2]
        s[0,3]=(0.640898585384)*x[0]**o+(0.133026195724)*x[0]+(-0.264924898824)*x[1]**o+(0.984926461364)*x[1]+(-0.366473159006)*x[2]**o+(-0.893150501229)*x[2]
        s[0,4]=(-0.0617160479105)*x[0]**o+(-0.781163890754)*x[0]+(0.482406386837)*x[1]**o+(0.242984596118)*x[1]+(0.387455073331)*x[2]**o+(0.713852275793)*x[2]
        s[1,0]=(-0.261960056141)*x[0]**o+(0.289706307634)*x[0]+(0.33502315284)*x[1]**o+(0.373867353003)*x[1]+(0.988176700778)*x[2]**o+(0.821674109963)*x[2]
        s[1,1]=(-0.564538779546)*x[0]**o+(0.512720259636)*x[0]+(0.519794117449)*x[1]**o+(0.140310457627)*x[1]+(-0.987992481444)*x[2]**o+(-0.658619677691)*x[2]
        s[1,2]=(-0.94468459827)*x[0]**o+(-0.59503451145)*x[0]+(0.638928053728)*x[1]**o+(-0.426823410254)*x[1]+(0.698221019291)*x[2]**o+(0.584939961146)*x[2]
        s[1,3]=(-0.736608632072)*x[0]**o+(0.121237394007)*x[0]+(0.965644483539)*x[1]**o+(-0.69597048224)*x[1]+(-0.131814696207)*x[2]**o+(0.218156302554)*x[2]
        s[1,4]=(-0.68564146602)*x[0]**o+(-0.613073625086)*x[0]+(-0.480606344797)*x[1]**o+(0.305215204518)*x[1]+(-0.932537843561)*x[2]**o+(0.753998778964)*x[2]
        s[2,0]=(0.149366204787)*x[0]**o+(0.518985565336)*x[0]+(-0.108643244187)*x[1]**o+(-0.133769184691)*x[1]+(-0.91950647261)*x[2]**o+(-0.165713076313)*x[2]
        s[2,1]=(0.377574358299)*x[0]**o+(-0.881166371065)*x[0]+(0.859757091349)*x[1]**o+(-0.571419705867)*x[1]+(0.688875894062)*x[2]**o+(-0.475017852628)*x[2]
        s[2,2]=(-0.293556901343)*x[0]**o+(-0.21565327941)*x[0]+(-0.661622857503)*x[1]**o+(-0.822811400487)*x[1]+(0.773358448616)*x[2]**o+(0.687967954749)*x[2]
        s[2,3]=(-0.0678537895443)*x[0]**o+(-0.620817206574)*x[0]+(0.195444962807)*x[1]**o+(-0.802482456128)*x[1]+(0.839892027886)*x[2]**o+(0.53033825313)*x[2]
        s[2,4]=(-0.174133277232)*x[0]**o+(-0.11357878673)*x[0]+(0.896953765213)*x[1]**o+(-0.111411131996)*x[1]+(-0.911590351769)*x[2]**o+(-0.867631474956)*x[2]
        s[3,0]=(0.619809270826)*x[0]**o+(0.234416234461)*x[0]+(-0.265703869206)*x[1]**o+(-0.179792194117)*x[1]+(0.650878614932)*x[2]**o+(0.832933790635)*x[2]
        s[3,1]=(-0.464423972484)*x[0]**o+(-0.0792284263184)*x[0]+(0.591682473906)*x[1]**o+(-0.69612265297)*x[1]+(-0.847084735807)*x[2]**o+(0.406411159143)*x[2]
        s[3,2]=(-0.206502883044)*x[0]**o+(0.266143672088)*x[0]+(0.742487243777)*x[1]**o+(0.652888436702)*x[1]+(-0.638601136445)*x[2]**o+(-0.411202594715)*x[2]
        s[3,3]=(0.749860017366)*x[0]**o+(0.0712552207004)*x[0]+(0.932270746555)*x[1]**o+(-0.743243258158)*x[1]+(0.77742513611)*x[2]**o+(-0.0951940129286)*x[2]
        s[3,4]=(-0.736329018198)*x[0]**o+(-0.346737131331)*x[0]+(0.15155322637)*x[1]**o+(0.209410136584)*x[1]+(-0.283669919947)*x[2]**o+(-0.736677347286)*x[2]
        ref[0,0,0]=o*(-0.582848481634)*x_ref[0]**(o-1)+(-0.799173040171)
        ref[0,0,1]=o*(-0.402728303622)*x_ref[1]**(o-1)+(-0.294649773058)
        ref[0,0,2]=o*(-0.248183917161)*x_ref[2]**(o-1)+(-0.182025430599)
        ref[0,1,0]=o*(0.421723448079)*x_ref[0]**(o-1)+(-0.881083512259)
        ref[0,1,1]=o*(-0.411609580693)*x_ref[1]**(o-1)+(-0.60866119666)
        ref[0,1,2]=o*(0.447246876403)*x_ref[2]**(o-1)+(-0.566693550375)
        ref[0,2,0]=o*(0.676859700236)*x_ref[0]**(o-1)+(-0.0721141912983)
        ref[0,2,1]=o*(-0.930202067587)*x_ref[1]**(o-1)+(-0.779660291535)
        ref[0,2,2]=o*(-0.846576347271)*x_ref[2]**(o-1)+(0.182815431369)
        ref[0,3,0]=o*(0.640898585384)*x_ref[0]**(o-1)+(0.133026195724)
        ref[0,3,1]=o*(-0.264924898824)*x_ref[1]**(o-1)+(0.984926461364)
        ref[0,3,2]=o*(-0.366473159006)*x_ref[2]**(o-1)+(-0.893150501229)
        ref[0,4,0]=o*(-0.0617160479105)*x_ref[0]**(o-1)+(-0.781163890754)
        ref[0,4,1]=o*(0.482406386837)*x_ref[1]**(o-1)+(0.242984596118)
        ref[0,4,2]=o*(0.387455073331)*x_ref[2]**(o-1)+(0.713852275793)
        ref[1,0,0]=o*(-0.261960056141)*x_ref[0]**(o-1)+(0.289706307634)
        ref[1,0,1]=o*(0.33502315284)*x_ref[1]**(o-1)+(0.373867353003)
        ref[1,0,2]=o*(0.988176700778)*x_ref[2]**(o-1)+(0.821674109963)
        ref[1,1,0]=o*(-0.564538779546)*x_ref[0]**(o-1)+(0.512720259636)
        ref[1,1,1]=o*(0.519794117449)*x_ref[1]**(o-1)+(0.140310457627)
        ref[1,1,2]=o*(-0.987992481444)*x_ref[2]**(o-1)+(-0.658619677691)
        ref[1,2,0]=o*(-0.94468459827)*x_ref[0]**(o-1)+(-0.59503451145)
        ref[1,2,1]=o*(0.638928053728)*x_ref[1]**(o-1)+(-0.426823410254)
        ref[1,2,2]=o*(0.698221019291)*x_ref[2]**(o-1)+(0.584939961146)
        ref[1,3,0]=o*(-0.736608632072)*x_ref[0]**(o-1)+(0.121237394007)
        ref[1,3,1]=o*(0.965644483539)*x_ref[1]**(o-1)+(-0.69597048224)
        ref[1,3,2]=o*(-0.131814696207)*x_ref[2]**(o-1)+(0.218156302554)
        ref[1,4,0]=o*(-0.68564146602)*x_ref[0]**(o-1)+(-0.613073625086)
        ref[1,4,1]=o*(-0.480606344797)*x_ref[1]**(o-1)+(0.305215204518)
        ref[1,4,2]=o*(-0.932537843561)*x_ref[2]**(o-1)+(0.753998778964)
        ref[2,0,0]=o*(0.149366204787)*x_ref[0]**(o-1)+(0.518985565336)
        ref[2,0,1]=o*(-0.108643244187)*x_ref[1]**(o-1)+(-0.133769184691)
        ref[2,0,2]=o*(-0.91950647261)*x_ref[2]**(o-1)+(-0.165713076313)
        ref[2,1,0]=o*(0.377574358299)*x_ref[0]**(o-1)+(-0.881166371065)
        ref[2,1,1]=o*(0.859757091349)*x_ref[1]**(o-1)+(-0.571419705867)
        ref[2,1,2]=o*(0.688875894062)*x_ref[2]**(o-1)+(-0.475017852628)
        ref[2,2,0]=o*(-0.293556901343)*x_ref[0]**(o-1)+(-0.21565327941)
        ref[2,2,1]=o*(-0.661622857503)*x_ref[1]**(o-1)+(-0.822811400487)
        ref[2,2,2]=o*(0.773358448616)*x_ref[2]**(o-1)+(0.687967954749)
        ref[2,3,0]=o*(-0.0678537895443)*x_ref[0]**(o-1)+(-0.620817206574)
        ref[2,3,1]=o*(0.195444962807)*x_ref[1]**(o-1)+(-0.802482456128)
        ref[2,3,2]=o*(0.839892027886)*x_ref[2]**(o-1)+(0.53033825313)
        ref[2,4,0]=o*(-0.174133277232)*x_ref[0]**(o-1)+(-0.11357878673)
        ref[2,4,1]=o*(0.896953765213)*x_ref[1]**(o-1)+(-0.111411131996)
        ref[2,4,2]=o*(-0.911590351769)*x_ref[2]**(o-1)+(-0.867631474956)
        ref[3,0,0]=o*(0.619809270826)*x_ref[0]**(o-1)+(0.234416234461)
        ref[3,0,1]=o*(-0.265703869206)*x_ref[1]**(o-1)+(-0.179792194117)
        ref[3,0,2]=o*(0.650878614932)*x_ref[2]**(o-1)+(0.832933790635)
        ref[3,1,0]=o*(-0.464423972484)*x_ref[0]**(o-1)+(-0.0792284263184)
        ref[3,1,1]=o*(0.591682473906)*x_ref[1]**(o-1)+(-0.69612265297)
        ref[3,1,2]=o*(-0.847084735807)*x_ref[2]**(o-1)+(0.406411159143)
        ref[3,2,0]=o*(-0.206502883044)*x_ref[0]**(o-1)+(0.266143672088)
        ref[3,2,1]=o*(0.742487243777)*x_ref[1]**(o-1)+(0.652888436702)
        ref[3,2,2]=o*(-0.638601136445)*x_ref[2]**(o-1)+(-0.411202594715)
        ref[3,3,0]=o*(0.749860017366)*x_ref[0]**(o-1)+(0.0712552207004)
        ref[3,3,1]=o*(0.932270746555)*x_ref[1]**(o-1)+(-0.743243258158)
        ref[3,3,2]=o*(0.77742513611)*x_ref[2]**(o-1)+(-0.0951940129286)
        ref[3,4,0]=o*(-0.736329018198)*x_ref[0]**(o-1)+(-0.346737131331)
        ref[3,4,1]=o*(0.15155322637)*x_ref[1]**(o-1)+(0.209410136584)
        ref[3,4,2]=o*(-0.283669919947)*x_ref[2]**(o-1)+(-0.736677347286)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_Solution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the Function

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(0.285489768558)*x[0]**o+(-0.814169283089)*x[0]+(-0.146214432938)*x[1]**o+(0.971176476923)*x[1]
        s[0,0,1]=(0.796197012783)*x[0]**o+(0.138854173842)*x[0]+(0.911141134854)*x[1]**o+(0.24230493445)*x[1]
        s[0,1,0]=(0.335306616869)*x[0]**o+(-0.346373461144)*x[0]+(0.485198289812)*x[1]**o+(-0.557460170056)*x[1]
        s[0,1,1]=(-0.202832958777)*x[0]**o+(0.202612852038)*x[0]+(-0.382959990066)*x[1]**o+(0.982713356847)*x[1]
        s[1,0,0]=(-0.732852201528)*x[0]**o+(-0.52380849964)*x[0]+(-0.423867496739)*x[1]**o+(-0.476139964916)*x[1]
        s[1,0,1]=(0.730537196604)*x[0]**o+(0.782053455575)*x[0]+(-0.496379081802)*x[1]**o+(-0.610796298113)*x[1]
        s[1,1,0]=(-0.518151715463)*x[0]**o+(0.466253389588)*x[0]+(0.792730016645)*x[1]**o+(-0.0928866491573)*x[1]
        s[1,1,1]=(0.721737904289)*x[0]**o+(0.662197543309)*x[0]+(0.402567060485)*x[1]**o+(-0.0537539240196)*x[1]
        s[2,0,0]=(0.264010742903)*x[0]**o+(-0.209394534976)*x[0]+(0.901338534988)*x[1]**o+(0.751548611498)*x[1]
        s[2,0,1]=(0.255790620214)*x[0]**o+(0.979495958037)*x[0]+(-0.00862935506386)*x[1]**o+(0.472608624671)*x[1]
        s[2,1,0]=(0.348157499697)*x[0]**o+(-0.489084366673)*x[0]+(-0.797020984331)*x[1]**o+(0.850642513227)*x[1]
        s[2,1,1]=(0.619156982334)*x[0]**o+(-0.871389250139)*x[0]+(0.838613332974)*x[1]**o+(0.865428066011)*x[1]
        s[3,0,0]=(-0.498572545085)*x[0]**o+(0.26752755104)*x[0]+(-0.742506202612)*x[1]**o+(-0.867811055537)*x[1]
        s[3,0,1]=(-0.469062081737)*x[0]**o+(-0.896231281785)*x[0]+(-0.0537944852375)*x[1]**o+(-0.566775495197)*x[1]
        s[3,1,0]=(0.960466927125)*x[0]**o+(-0.790015287315)*x[0]+(-0.249364909212)*x[1]**o+(0.55000656331)*x[1]
        s[3,1,1]=(0.107190484709)*x[0]**o+(0.206656185528)*x[0]+(0.445355269686)*x[1]**o+(0.177791381802)*x[1]
        s[4,0,0]=(0.926353234834)*x[0]**o+(0.0187238838755)*x[0]+(-0.0335895202391)*x[1]**o+(0.396027343683)*x[1]
        s[4,0,1]=(-0.122883815734)*x[0]**o+(0.114014252654)*x[0]+(0.390958937743)*x[1]**o+(0.743802098345)*x[1]
        s[4,1,0]=(0.0434615831789)*x[0]**o+(-0.0061546333485)*x[0]+(-0.941682112962)*x[1]**o+(0.546094645223)*x[1]
        s[4,1,1]=(-0.876438895739)*x[0]**o+(-0.307842960731)*x[0]+(-0.958906847802)*x[1]**o+(-0.698921900635)*x[1]
        s[5,0,0]=(-0.0294848627519)*x[0]**o+(-0.108277485049)*x[0]+(0.653184058519)*x[1]**o+(0.268533892275)*x[1]
        s[5,0,1]=(0.0643758658725)*x[0]**o+(0.403982947726)*x[0]+(-0.966297836476)*x[1]**o+(-0.934899934913)*x[1]
        s[5,1,0]=(-0.354834560075)*x[0]**o+(-0.641982491187)*x[0]+(0.231470813627)*x[1]**o+(0.597773058655)*x[1]
        s[5,1,1]=(0.457345532548)*x[0]**o+(0.930909964958)*x[0]+(-0.190821688076)*x[1]**o+(0.763332121356)*x[1]
        ref[0,0,0,0]=o*(0.285489768558)*x_ref[0]**(o-1)+(-0.814169283089)
        ref[0,0,0,1]=o*(-0.146214432938)*x_ref[1]**(o-1)+(0.971176476923)
        ref[0,0,1,0]=o*(0.796197012783)*x_ref[0]**(o-1)+(0.138854173842)
        ref[0,0,1,1]=o*(0.911141134854)*x_ref[1]**(o-1)+(0.24230493445)
        ref[0,1,0,0]=o*(0.335306616869)*x_ref[0]**(o-1)+(-0.346373461144)
        ref[0,1,0,1]=o*(0.485198289812)*x_ref[1]**(o-1)+(-0.557460170056)
        ref[0,1,1,0]=o*(-0.202832958777)*x_ref[0]**(o-1)+(0.202612852038)
        ref[0,1,1,1]=o*(-0.382959990066)*x_ref[1]**(o-1)+(0.982713356847)
        ref[1,0,0,0]=o*(-0.732852201528)*x_ref[0]**(o-1)+(-0.52380849964)
        ref[1,0,0,1]=o*(-0.423867496739)*x_ref[1]**(o-1)+(-0.476139964916)
        ref[1,0,1,0]=o*(0.730537196604)*x_ref[0]**(o-1)+(0.782053455575)
        ref[1,0,1,1]=o*(-0.496379081802)*x_ref[1]**(o-1)+(-0.610796298113)
        ref[1,1,0,0]=o*(-0.518151715463)*x_ref[0]**(o-1)+(0.466253389588)
        ref[1,1,0,1]=o*(0.792730016645)*x_ref[1]**(o-1)+(-0.0928866491573)
        ref[1,1,1,0]=o*(0.721737904289)*x_ref[0]**(o-1)+(0.662197543309)
        ref[1,1,1,1]=o*(0.402567060485)*x_ref[1]**(o-1)+(-0.0537539240196)
        ref[2,0,0,0]=o*(0.264010742903)*x_ref[0]**(o-1)+(-0.209394534976)
        ref[2,0,0,1]=o*(0.901338534988)*x_ref[1]**(o-1)+(0.751548611498)
        ref[2,0,1,0]=o*(0.255790620214)*x_ref[0]**(o-1)+(0.979495958037)
        ref[2,0,1,1]=o*(-0.00862935506386)*x_ref[1]**(o-1)+(0.472608624671)
        ref[2,1,0,0]=o*(0.348157499697)*x_ref[0]**(o-1)+(-0.489084366673)
        ref[2,1,0,1]=o*(-0.797020984331)*x_ref[1]**(o-1)+(0.850642513227)
        ref[2,1,1,0]=o*(0.619156982334)*x_ref[0]**(o-1)+(-0.871389250139)
        ref[2,1,1,1]=o*(0.838613332974)*x_ref[1]**(o-1)+(0.865428066011)
        ref[3,0,0,0]=o*(-0.498572545085)*x_ref[0]**(o-1)+(0.26752755104)
        ref[3,0,0,1]=o*(-0.742506202612)*x_ref[1]**(o-1)+(-0.867811055537)
        ref[3,0,1,0]=o*(-0.469062081737)*x_ref[0]**(o-1)+(-0.896231281785)
        ref[3,0,1,1]=o*(-0.0537944852375)*x_ref[1]**(o-1)+(-0.566775495197)
        ref[3,1,0,0]=o*(0.960466927125)*x_ref[0]**(o-1)+(-0.790015287315)
        ref[3,1,0,1]=o*(-0.249364909212)*x_ref[1]**(o-1)+(0.55000656331)
        ref[3,1,1,0]=o*(0.107190484709)*x_ref[0]**(o-1)+(0.206656185528)
        ref[3,1,1,1]=o*(0.445355269686)*x_ref[1]**(o-1)+(0.177791381802)
        ref[4,0,0,0]=o*(0.926353234834)*x_ref[0]**(o-1)+(0.0187238838755)
        ref[4,0,0,1]=o*(-0.0335895202391)*x_ref[1]**(o-1)+(0.396027343683)
        ref[4,0,1,0]=o*(-0.122883815734)*x_ref[0]**(o-1)+(0.114014252654)
        ref[4,0,1,1]=o*(0.390958937743)*x_ref[1]**(o-1)+(0.743802098345)
        ref[4,1,0,0]=o*(0.0434615831789)*x_ref[0]**(o-1)+(-0.0061546333485)
        ref[4,1,0,1]=o*(-0.941682112962)*x_ref[1]**(o-1)+(0.546094645223)
        ref[4,1,1,0]=o*(-0.876438895739)*x_ref[0]**(o-1)+(-0.307842960731)
        ref[4,1,1,1]=o*(-0.958906847802)*x_ref[1]**(o-1)+(-0.698921900635)
        ref[5,0,0,0]=o*(-0.0294848627519)*x_ref[0]**(o-1)+(-0.108277485049)
        ref[5,0,0,1]=o*(0.653184058519)*x_ref[1]**(o-1)+(0.268533892275)
        ref[5,0,1,0]=o*(0.0643758658725)*x_ref[0]**(o-1)+(0.403982947726)
        ref[5,0,1,1]=o*(-0.966297836476)*x_ref[1]**(o-1)+(-0.934899934913)
        ref[5,1,0,0]=o*(-0.354834560075)*x_ref[0]**(o-1)+(-0.641982491187)
        ref[5,1,0,1]=o*(0.231470813627)*x_ref[1]**(o-1)+(0.597773058655)
        ref[5,1,1,0]=o*(0.457345532548)*x_ref[0]**(o-1)+(0.930909964958)
        ref[5,1,1,1]=o*(-0.190821688076)*x_ref[1]**(o-1)+(0.763332121356)
      else:
        s[0,0,0]=(0.0799106193628)*x[0]**o+(-0.385218529142)*x[0]+(0.423551372182)*x[1]**o+(-0.357661802001)*x[1]+(0.523815428088)*x[2]**o+(-0.867664901871)*x[2]
        s[0,0,1]=(-0.223298613593)*x[0]**o+(-0.563675059615)*x[0]+(0.854553636152)*x[1]**o+(0.00619936897032)*x[1]+(-0.168119043675)*x[2]**o+(-0.959967076262)*x[2]
        s[0,1,0]=(-0.538044222292)*x[0]**o+(0.519685043014)*x[0]+(-0.351144688067)*x[1]**o+(0.887365493845)*x[1]+(0.801566727487)*x[2]**o+(0.571280510487)*x[2]
        s[0,1,1]=(0.784344723309)*x[0]**o+(-0.0907512562255)*x[0]+(-0.24324080888)*x[1]**o+(-0.199412485507)*x[1]+(0.642344630349)*x[2]**o+(-0.735616137201)*x[2]
        s[1,0,0]=(-0.880206903193)*x[0]**o+(-0.749123123033)*x[0]+(0.104561575813)*x[1]**o+(-0.647441987473)*x[1]+(0.182201321281)*x[2]**o+(0.0102973222322)*x[2]
        s[1,0,1]=(0.915893198392)*x[0]**o+(-0.612952390562)*x[0]+(0.803094622661)*x[1]**o+(-0.140410725667)*x[1]+(-0.247855770678)*x[2]**o+(0.399254178737)*x[2]
        s[1,1,0]=(0.818321238866)*x[0]**o+(0.214893239645)*x[0]+(0.909338463913)*x[1]**o+(0.855186366612)*x[1]+(-0.835375145102)*x[2]**o+(-0.807936215386)*x[2]
        s[1,1,1]=(0.257588723885)*x[0]**o+(-0.952059092336)*x[0]+(-0.28964814303)*x[1]**o+(0.0129418032921)*x[1]+(0.854165719561)*x[2]**o+(0.16196867256)*x[2]
        s[2,0,0]=(-0.291805757446)*x[0]**o+(0.609410741859)*x[0]+(0.541295607728)*x[1]**o+(-0.220049109439)*x[1]+(0.773352330852)*x[2]**o+(-0.0999084978714)*x[2]
        s[2,0,1]=(-0.094477913729)*x[0]**o+(-0.764264730185)*x[0]+(-0.671804542061)*x[1]**o+(0.368646822044)*x[1]+(0.448237271807)*x[2]**o+(0.565106260459)*x[2]
        s[2,1,0]=(-0.240257182637)*x[0]**o+(0.859112706839)*x[0]+(-0.575504060232)*x[1]**o+(-0.611929236978)*x[1]+(0.675448692587)*x[2]**o+(0.31890080218)*x[2]
        s[2,1,1]=(-0.39222652102)*x[0]**o+(0.677458518423)*x[0]+(-0.412612361541)*x[1]**o+(-0.374686862277)*x[1]+(-0.737213784962)*x[2]**o+(-0.486920606866)*x[2]
        s[3,0,0]=(0.635190942363)*x[0]**o+(-0.330731024263)*x[0]+(-0.690112375174)*x[1]**o+(-0.446491601534)*x[1]+(-0.748307399262)*x[2]**o+(-0.578747596175)*x[2]
        s[3,0,1]=(-0.419848395854)*x[0]**o+(-0.31014199789)*x[0]+(0.818235061383)*x[1]**o+(0.0547944058433)*x[1]+(0.855573639674)*x[2]**o+(-0.740418501951)*x[2]
        s[3,1,0]=(-0.0448849811136)*x[0]**o+(-0.337048179302)*x[0]+(-0.504885976058)*x[1]**o+(-0.445450937517)*x[1]+(0.567028111275)*x[2]**o+(0.123980108452)*x[2]
        s[3,1,1]=(-0.438038042566)*x[0]**o+(-0.427397249753)*x[0]+(0.574195396827)*x[1]**o+(0.824799756958)*x[1]+(-0.886957824366)*x[2]**o+(-0.192557581967)*x[2]
        s[4,0,0]=(0.961581428919)*x[0]**o+(-0.666268681241)*x[0]+(0.916527151658)*x[1]**o+(0.879372699554)*x[1]+(-0.648140763963)*x[2]**o+(-0.692256048468)*x[2]
        s[4,0,1]=(-0.162077276705)*x[0]**o+(-0.306833194309)*x[0]+(0.611399808831)*x[1]**o+(-0.508477663404)*x[1]+(-0.380712354501)*x[2]**o+(0.490458516352)*x[2]
        s[4,1,0]=(-0.64539443571)*x[0]**o+(-0.570490580768)*x[0]+(-0.612017756646)*x[1]**o+(0.979359105468)*x[1]+(0.901671131984)*x[2]**o+(-0.57388809992)*x[2]
        s[4,1,1]=(0.0239934065942)*x[0]**o+(0.358848963609)*x[0]+(-0.262596433728)*x[1]**o+(0.966612108153)*x[1]+(0.048144124831)*x[2]**o+(0.106585203917)*x[2]
        s[5,0,0]=(-0.894844992009)*x[0]**o+(-0.991143708359)*x[0]+(-0.719802159076)*x[1]**o+(0.609678198738)*x[1]+(0.934875984305)*x[2]**o+(0.210728029537)*x[2]
        s[5,0,1]=(-0.0669111311933)*x[0]**o+(-0.145495535442)*x[0]+(-0.988259077226)*x[1]**o+(-0.736349726987)*x[1]+(-0.164335654094)*x[2]**o+(-0.364166925171)*x[2]
        s[5,1,0]=(-0.279004883801)*x[0]**o+(0.96466483765)*x[0]+(-0.445599169347)*x[1]**o+(0.866248162976)*x[1]+(0.13706485262)*x[2]**o+(-0.78704568071)*x[2]
        s[5,1,1]=(0.452358514637)*x[0]**o+(-0.456298799376)*x[0]+(0.80484494772)*x[1]**o+(-0.949154901869)*x[1]+(-0.106819359297)*x[2]**o+(-0.710983814219)*x[2]
        ref[0,0,0,0]=o*(0.0799106193628)*x_ref[0]**(o-1)+(-0.385218529142)
        ref[0,0,0,1]=o*(0.423551372182)*x_ref[1]**(o-1)+(-0.357661802001)
        ref[0,0,0,2]=o*(0.523815428088)*x_ref[2]**(o-1)+(-0.867664901871)
        ref[0,0,1,0]=o*(-0.223298613593)*x_ref[0]**(o-1)+(-0.563675059615)
        ref[0,0,1,1]=o*(0.854553636152)*x_ref[1]**(o-1)+(0.00619936897032)
        ref[0,0,1,2]=o*(-0.168119043675)*x_ref[2]**(o-1)+(-0.959967076262)
        ref[0,1,0,0]=o*(-0.538044222292)*x_ref[0]**(o-1)+(0.519685043014)
        ref[0,1,0,1]=o*(-0.351144688067)*x_ref[1]**(o-1)+(0.887365493845)
        ref[0,1,0,2]=o*(0.801566727487)*x_ref[2]**(o-1)+(0.571280510487)
        ref[0,1,1,0]=o*(0.784344723309)*x_ref[0]**(o-1)+(-0.0907512562255)
        ref[0,1,1,1]=o*(-0.24324080888)*x_ref[1]**(o-1)+(-0.199412485507)
        ref[0,1,1,2]=o*(0.642344630349)*x_ref[2]**(o-1)+(-0.735616137201)
        ref[1,0,0,0]=o*(-0.880206903193)*x_ref[0]**(o-1)+(-0.749123123033)
        ref[1,0,0,1]=o*(0.104561575813)*x_ref[1]**(o-1)+(-0.647441987473)
        ref[1,0,0,2]=o*(0.182201321281)*x_ref[2]**(o-1)+(0.0102973222322)
        ref[1,0,1,0]=o*(0.915893198392)*x_ref[0]**(o-1)+(-0.612952390562)
        ref[1,0,1,1]=o*(0.803094622661)*x_ref[1]**(o-1)+(-0.140410725667)
        ref[1,0,1,2]=o*(-0.247855770678)*x_ref[2]**(o-1)+(0.399254178737)
        ref[1,1,0,0]=o*(0.818321238866)*x_ref[0]**(o-1)+(0.214893239645)
        ref[1,1,0,1]=o*(0.909338463913)*x_ref[1]**(o-1)+(0.855186366612)
        ref[1,1,0,2]=o*(-0.835375145102)*x_ref[2]**(o-1)+(-0.807936215386)
        ref[1,1,1,0]=o*(0.257588723885)*x_ref[0]**(o-1)+(-0.952059092336)
        ref[1,1,1,1]=o*(-0.28964814303)*x_ref[1]**(o-1)+(0.0129418032921)
        ref[1,1,1,2]=o*(0.854165719561)*x_ref[2]**(o-1)+(0.16196867256)
        ref[2,0,0,0]=o*(-0.291805757446)*x_ref[0]**(o-1)+(0.609410741859)
        ref[2,0,0,1]=o*(0.541295607728)*x_ref[1]**(o-1)+(-0.220049109439)
        ref[2,0,0,2]=o*(0.773352330852)*x_ref[2]**(o-1)+(-0.0999084978714)
        ref[2,0,1,0]=o*(-0.094477913729)*x_ref[0]**(o-1)+(-0.764264730185)
        ref[2,0,1,1]=o*(-0.671804542061)*x_ref[1]**(o-1)+(0.368646822044)
        ref[2,0,1,2]=o*(0.448237271807)*x_ref[2]**(o-1)+(0.565106260459)
        ref[2,1,0,0]=o*(-0.240257182637)*x_ref[0]**(o-1)+(0.859112706839)
        ref[2,1,0,1]=o*(-0.575504060232)*x_ref[1]**(o-1)+(-0.611929236978)
        ref[2,1,0,2]=o*(0.675448692587)*x_ref[2]**(o-1)+(0.31890080218)
        ref[2,1,1,0]=o*(-0.39222652102)*x_ref[0]**(o-1)+(0.677458518423)
        ref[2,1,1,1]=o*(-0.412612361541)*x_ref[1]**(o-1)+(-0.374686862277)
        ref[2,1,1,2]=o*(-0.737213784962)*x_ref[2]**(o-1)+(-0.486920606866)
        ref[3,0,0,0]=o*(0.635190942363)*x_ref[0]**(o-1)+(-0.330731024263)
        ref[3,0,0,1]=o*(-0.690112375174)*x_ref[1]**(o-1)+(-0.446491601534)
        ref[3,0,0,2]=o*(-0.748307399262)*x_ref[2]**(o-1)+(-0.578747596175)
        ref[3,0,1,0]=o*(-0.419848395854)*x_ref[0]**(o-1)+(-0.31014199789)
        ref[3,0,1,1]=o*(0.818235061383)*x_ref[1]**(o-1)+(0.0547944058433)
        ref[3,0,1,2]=o*(0.855573639674)*x_ref[2]**(o-1)+(-0.740418501951)
        ref[3,1,0,0]=o*(-0.0448849811136)*x_ref[0]**(o-1)+(-0.337048179302)
        ref[3,1,0,1]=o*(-0.504885976058)*x_ref[1]**(o-1)+(-0.445450937517)
        ref[3,1,0,2]=o*(0.567028111275)*x_ref[2]**(o-1)+(0.123980108452)
        ref[3,1,1,0]=o*(-0.438038042566)*x_ref[0]**(o-1)+(-0.427397249753)
        ref[3,1,1,1]=o*(0.574195396827)*x_ref[1]**(o-1)+(0.824799756958)
        ref[3,1,1,2]=o*(-0.886957824366)*x_ref[2]**(o-1)+(-0.192557581967)
        ref[4,0,0,0]=o*(0.961581428919)*x_ref[0]**(o-1)+(-0.666268681241)
        ref[4,0,0,1]=o*(0.916527151658)*x_ref[1]**(o-1)+(0.879372699554)
        ref[4,0,0,2]=o*(-0.648140763963)*x_ref[2]**(o-1)+(-0.692256048468)
        ref[4,0,1,0]=o*(-0.162077276705)*x_ref[0]**(o-1)+(-0.306833194309)
        ref[4,0,1,1]=o*(0.611399808831)*x_ref[1]**(o-1)+(-0.508477663404)
        ref[4,0,1,2]=o*(-0.380712354501)*x_ref[2]**(o-1)+(0.490458516352)
        ref[4,1,0,0]=o*(-0.64539443571)*x_ref[0]**(o-1)+(-0.570490580768)
        ref[4,1,0,1]=o*(-0.612017756646)*x_ref[1]**(o-1)+(0.979359105468)
        ref[4,1,0,2]=o*(0.901671131984)*x_ref[2]**(o-1)+(-0.57388809992)
        ref[4,1,1,0]=o*(0.0239934065942)*x_ref[0]**(o-1)+(0.358848963609)
        ref[4,1,1,1]=o*(-0.262596433728)*x_ref[1]**(o-1)+(0.966612108153)
        ref[4,1,1,2]=o*(0.048144124831)*x_ref[2]**(o-1)+(0.106585203917)
        ref[5,0,0,0]=o*(-0.894844992009)*x_ref[0]**(o-1)+(-0.991143708359)
        ref[5,0,0,1]=o*(-0.719802159076)*x_ref[1]**(o-1)+(0.609678198738)
        ref[5,0,0,2]=o*(0.934875984305)*x_ref[2]**(o-1)+(0.210728029537)
        ref[5,0,1,0]=o*(-0.0669111311933)*x_ref[0]**(o-1)+(-0.145495535442)
        ref[5,0,1,1]=o*(-0.988259077226)*x_ref[1]**(o-1)+(-0.736349726987)
        ref[5,0,1,2]=o*(-0.164335654094)*x_ref[2]**(o-1)+(-0.364166925171)
        ref[5,1,0,0]=o*(-0.279004883801)*x_ref[0]**(o-1)+(0.96466483765)
        ref[5,1,0,1]=o*(-0.445599169347)*x_ref[1]**(o-1)+(0.866248162976)
        ref[5,1,0,2]=o*(0.13706485262)*x_ref[2]**(o-1)+(-0.78704568071)
        ref[5,1,1,0]=o*(0.452358514637)*x_ref[0]**(o-1)+(-0.456298799376)
        ref[5,1,1,1]=o*(0.80484494772)*x_ref[1]**(o-1)+(-0.949154901869)
        ref[5,1,1,2]=o*(-0.106819359297)*x_ref[2]**(o-1)+(-0.710983814219)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(-0.495552973369)*x[0]+(0.874390589312)*x[1]
        ref[0]=(-0.495552973369)
        ref[1]=(0.874390589312)
      else:
        s=(-0.354636799848)*x[0]+(0.555572828684)*x[1]+(-0.270947199201)*x[2]
        ref[0]=(-0.354636799848)
        ref[1]=(0.555572828684)
        ref[2]=(-0.270947199201)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-0.187161756695)*x[0]+(-0.776766204086)*x[1]
        s[1]=(0.724774116602)*x[0]+(0.446775762856)*x[1]
        ref[0,0]=(-0.187161756695)
        ref[0,1]=(-0.776766204086)
        ref[1,0]=(0.724774116602)
        ref[1,1]=(0.446775762856)
      else:
        s[0]=(-0.0251530250542)*x[0]+(-1.23786881883)*x[1]+(1.1819624619)*x[2]
        s[1]=(0.801009266263)*x[0]+(-0.210512005637)*x[1]+(-1.42548669085)*x[2]
        ref[0,0]=(-0.0251530250542)
        ref[0,1]=(-1.23786881883)
        ref[0,2]=(1.1819624619)
        ref[1,0]=(0.801009266263)
        ref[1,1]=(-0.210512005637)
        ref[1,2]=(-1.42548669085)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.105140628344)*x[0]+(0.681061911151)*x[1]
        s[0,1]=(1.12568473028)*x[0]+(-0.142806409661)*x[1]
        s[0,2]=(-0.709551703126)*x[0]+(0.470204858155)*x[1]
        s[0,3]=(-0.457889995297)*x[0]+(0.119831077838)*x[1]
        s[0,4]=(-0.137584694085)*x[0]+(-0.815364572262)*x[1]
        s[1,0]=(-0.747275494188)*x[0]+(0.419390416238)*x[1]
        s[1,1]=(-0.55554960963)*x[0]+(1.68766532296)*x[1]
        s[1,2]=(0.0380274635555)*x[0]+(0.903518514201)*x[1]
        s[1,3]=(1.30478047839)*x[0]+(0.576658405128)*x[1]
        s[1,4]=(-0.786884541126)*x[0]+(0.481365349672)*x[1]
        s[2,0]=(1.30445628093)*x[0]+(1.06765714413)*x[1]
        s[2,1]=(0.7269884164)*x[0]+(-1.34914325614)*x[1]
        s[2,2]=(-0.827940783305)*x[0]+(1.05409369275)*x[1]
        s[2,3]=(0.57117918118)*x[0]+(-0.857074951332)*x[1]
        s[2,4]=(0.808649779643)*x[0]+(-0.746017104416)*x[1]
        s[3,0]=(1.06443222736)*x[0]+(-0.458402762622)*x[1]
        s[3,1]=(-0.328990411524)*x[0]+(1.10697234223)*x[1]
        s[3,2]=(-0.0777059446026)*x[0]+(1.04837766698)*x[1]
        s[3,3]=(0.0542117671967)*x[0]+(-1.24129430221)*x[1]
        s[3,4]=(0.176491870492)*x[0]+(0.310238631995)*x[1]
        ref[0,0,0]=(-0.105140628344)
        ref[0,0,1]=(0.681061911151)
        ref[0,1,0]=(1.12568473028)
        ref[0,1,1]=(-0.142806409661)
        ref[0,2,0]=(-0.709551703126)
        ref[0,2,1]=(0.470204858155)
        ref[0,3,0]=(-0.457889995297)
        ref[0,3,1]=(0.119831077838)
        ref[0,4,0]=(-0.137584694085)
        ref[0,4,1]=(-0.815364572262)
        ref[1,0,0]=(-0.747275494188)
        ref[1,0,1]=(0.419390416238)
        ref[1,1,0]=(-0.55554960963)
        ref[1,1,1]=(1.68766532296)
        ref[1,2,0]=(0.0380274635555)
        ref[1,2,1]=(0.903518514201)
        ref[1,3,0]=(1.30478047839)
        ref[1,3,1]=(0.576658405128)
        ref[1,4,0]=(-0.786884541126)
        ref[1,4,1]=(0.481365349672)
        ref[2,0,0]=(1.30445628093)
        ref[2,0,1]=(1.06765714413)
        ref[2,1,0]=(0.7269884164)
        ref[2,1,1]=(-1.34914325614)
        ref[2,2,0]=(-0.827940783305)
        ref[2,2,1]=(1.05409369275)
        ref[2,3,0]=(0.57117918118)
        ref[2,3,1]=(-0.857074951332)
        ref[2,4,0]=(0.808649779643)
        ref[2,4,1]=(-0.746017104416)
        ref[3,0,0]=(1.06443222736)
        ref[3,0,1]=(-0.458402762622)
        ref[3,1,0]=(-0.328990411524)
        ref[3,1,1]=(1.10697234223)
        ref[3,2,0]=(-0.0777059446026)
        ref[3,2,1]=(1.04837766698)
        ref[3,3,0]=(0.0542117671967)
        ref[3,3,1]=(-1.24129430221)
        ref[3,4,0]=(0.176491870492)
        ref[3,4,1]=(0.310238631995)
      else:
        s[0,0]=(-0.835695322993)*x[0]+(0.168930135561)*x[1]+(-1.47180800481)*x[2]
        s[0,1]=(0.2001836256)*x[0]+(1.27356263599)*x[1]+(1.07485276442)*x[2]
        s[0,2]=(-0.178446572149)*x[0]+(-0.420078906939)*x[1]+(0.535633192895)*x[2]
        s[0,3]=(-0.0910549937921)*x[0]+(0.594316242371)*x[1]+(-1.06833005008)*x[2]
        s[0,4]=(0.722857786921)*x[0]+(-0.332473817629)*x[1]+(0.79883607252)*x[2]
        s[1,0]=(-1.02192468444)*x[0]+(1.2735296387)*x[1]+(-1.34574119314)*x[2]
        s[1,1]=(-1.20222077943)*x[0]+(0.180006226359)*x[1]+(0.582580396324)*x[2]
        s[1,2]=(0.292773497866)*x[0]+(0.503071430702)*x[1]+(1.25357442113)*x[2]
        s[1,3]=(-0.579871204353)*x[0]+(0.143994355108)*x[1]+(0.50466279341)*x[2]
        s[1,4]=(1.00530781493)*x[0]+(-0.646038982555)*x[1]+(0.315868158577)*x[2]
        s[2,0]=(0.0109517370271)*x[0]+(-1.27094713044)*x[1]+(0.647777134752)*x[2]
        s[2,1]=(0.615504753112)*x[0]+(0.479866346157)*x[1]+(1.72115593961)*x[2]
        s[2,2]=(-0.307778323155)*x[0]+(0.307520362533)*x[1]+(0.0061507801029)*x[2]
        s[2,3]=(-0.901393000596)*x[0]+(0.912379707397)*x[1]+(-0.0683825966669)*x[2]
        s[2,4]=(0.558642962243)*x[0]+(0.650906862857)*x[1]+(-1.44796931057)*x[2]
        s[3,0]=(1.08498680281)*x[0]+(-1.28372501216)*x[1]+(-1.27799790624)*x[2]
        s[3,1]=(0.45408516398)*x[0]+(-0.950068476479)*x[1]+(0.634133482831)*x[2]
        s[3,2]=(0.824015492184)*x[0]+(0.148535318857)*x[1]+(0.10609796765)*x[2]
        s[3,3]=(1.14342153343)*x[0]+(-0.0689548622931)*x[1]+(-0.166489981522)*x[2]
        s[3,4]=(0.995987765181)*x[0]+(0.915359249488)*x[1]+(-0.583052373261)*x[2]
        ref[0,0,0]=(-0.835695322993)
        ref[0,0,1]=(0.168930135561)
        ref[0,0,2]=(-1.47180800481)
        ref[0,1,0]=(0.2001836256)
        ref[0,1,1]=(1.27356263599)
        ref[0,1,2]=(1.07485276442)
        ref[0,2,0]=(-0.178446572149)
        ref[0,2,1]=(-0.420078906939)
        ref[0,2,2]=(0.535633192895)
        ref[0,3,0]=(-0.0910549937921)
        ref[0,3,1]=(0.594316242371)
        ref[0,3,2]=(-1.06833005008)
        ref[0,4,0]=(0.722857786921)
        ref[0,4,1]=(-0.332473817629)
        ref[0,4,2]=(0.79883607252)
        ref[1,0,0]=(-1.02192468444)
        ref[1,0,1]=(1.2735296387)
        ref[1,0,2]=(-1.34574119314)
        ref[1,1,0]=(-1.20222077943)
        ref[1,1,1]=(0.180006226359)
        ref[1,1,2]=(0.582580396324)
        ref[1,2,0]=(0.292773497866)
        ref[1,2,1]=(0.503071430702)
        ref[1,2,2]=(1.25357442113)
        ref[1,3,0]=(-0.579871204353)
        ref[1,3,1]=(0.143994355108)
        ref[1,3,2]=(0.50466279341)
        ref[1,4,0]=(1.00530781493)
        ref[1,4,1]=(-0.646038982555)
        ref[1,4,2]=(0.315868158577)
        ref[2,0,0]=(0.0109517370271)
        ref[2,0,1]=(-1.27094713044)
        ref[2,0,2]=(0.647777134752)
        ref[2,1,0]=(0.615504753112)
        ref[2,1,1]=(0.479866346157)
        ref[2,1,2]=(1.72115593961)
        ref[2,2,0]=(-0.307778323155)
        ref[2,2,1]=(0.307520362533)
        ref[2,2,2]=(0.0061507801029)
        ref[2,3,0]=(-0.901393000596)
        ref[2,3,1]=(0.912379707397)
        ref[2,3,2]=(-0.0683825966669)
        ref[2,4,0]=(0.558642962243)
        ref[2,4,1]=(0.650906862857)
        ref[2,4,2]=(-1.44796931057)
        ref[3,0,0]=(1.08498680281)
        ref[3,0,1]=(-1.28372501216)
        ref[3,0,2]=(-1.27799790624)
        ref[3,1,0]=(0.45408516398)
        ref[3,1,1]=(-0.950068476479)
        ref[3,1,2]=(0.634133482831)
        ref[3,2,0]=(0.824015492184)
        ref[3,2,1]=(0.148535318857)
        ref[3,2,2]=(0.10609796765)
        ref[3,3,0]=(1.14342153343)
        ref[3,3,1]=(-0.0689548622931)
        ref[3,3,2]=(-0.166489981522)
        ref[3,4,0]=(0.995987765181)
        ref[3,4,1]=(0.915359249488)
        ref[3,4,2]=(-0.583052373261)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunction_fromSymbol_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the Function

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on Function
      """
      o=1
      dim=self.domain.getDim()
      w_ref=Function(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(0.116652834373)*x[0]+(1.4681512344)*x[1]
        s[0,0,1]=(1.89418390988)*x[0]+(-0.548065006619)*x[1]
        s[0,1,0]=(-0.07602392145)*x[0]+(0.0796515016952)*x[1]
        s[0,1,1]=(1.50333606195)*x[0]+(-0.211673198103)*x[1]
        s[1,0,0]=(0.172419295955)*x[0]+(-0.586603468045)*x[1]
        s[1,0,1]=(0.212952657549)*x[0]+(-0.100672655087)*x[1]
        s[1,1,0]=(-1.11939406352)*x[0]+(-0.589882254225)*x[1]
        s[1,1,1]=(0.318138253303)*x[0]+(0.409850277983)*x[1]
        s[2,0,0]=(-0.0669759465557)*x[0]+(0.525669761096)*x[1]
        s[2,0,1]=(0.349019390883)*x[0]+(0.154604501057)*x[1]
        s[2,1,0]=(1.95277106546)*x[0]+(0.495701766483)*x[1]
        s[2,1,1]=(-0.0986210008015)*x[0]+(1.12636829398)*x[1]
        s[3,0,0]=(0.971837535878)*x[0]+(-0.738253595188)*x[1]
        s[3,0,1]=(0.0314513203112)*x[0]+(-1.16646217783)*x[1]
        s[3,1,0]=(0.485751127243)*x[0]+(-0.340178033471)*x[1]
        s[3,1,1]=(0.408742867205)*x[0]+(0.151827789426)*x[1]
        s[4,0,0]=(-0.0134678971538)*x[0]+(0.884924133141)*x[1]
        s[4,0,1]=(-0.66899222691)*x[0]+(-0.959185584071)*x[1]
        s[4,1,0]=(1.05311767886)*x[0]+(0.64093792324)*x[1]
        s[4,1,1]=(0.562875594668)*x[0]+(0.539525481691)*x[1]
        s[5,0,0]=(0.310908751279)*x[0]+(0.497074267163)*x[1]
        s[5,0,1]=(-0.804186513465)*x[0]+(0.329762438933)*x[1]
        s[5,1,0]=(-0.946808260459)*x[0]+(-0.00260213368693)*x[1]
        s[5,1,1]=(0.63415870202)*x[0]+(1.38103994652)*x[1]
        ref[0,0,0,0]=(0.116652834373)
        ref[0,0,0,1]=(1.4681512344)
        ref[0,0,1,0]=(1.89418390988)
        ref[0,0,1,1]=(-0.548065006619)
        ref[0,1,0,0]=(-0.07602392145)
        ref[0,1,0,1]=(0.0796515016952)
        ref[0,1,1,0]=(1.50333606195)
        ref[0,1,1,1]=(-0.211673198103)
        ref[1,0,0,0]=(0.172419295955)
        ref[1,0,0,1]=(-0.586603468045)
        ref[1,0,1,0]=(0.212952657549)
        ref[1,0,1,1]=(-0.100672655087)
        ref[1,1,0,0]=(-1.11939406352)
        ref[1,1,0,1]=(-0.589882254225)
        ref[1,1,1,0]=(0.318138253303)
        ref[1,1,1,1]=(0.409850277983)
        ref[2,0,0,0]=(-0.0669759465557)
        ref[2,0,0,1]=(0.525669761096)
        ref[2,0,1,0]=(0.349019390883)
        ref[2,0,1,1]=(0.154604501057)
        ref[2,1,0,0]=(1.95277106546)
        ref[2,1,0,1]=(0.495701766483)
        ref[2,1,1,0]=(-0.0986210008015)
        ref[2,1,1,1]=(1.12636829398)
        ref[3,0,0,0]=(0.971837535878)
        ref[3,0,0,1]=(-0.738253595188)
        ref[3,0,1,0]=(0.0314513203112)
        ref[3,0,1,1]=(-1.16646217783)
        ref[3,1,0,0]=(0.485751127243)
        ref[3,1,0,1]=(-0.340178033471)
        ref[3,1,1,0]=(0.408742867205)
        ref[3,1,1,1]=(0.151827789426)
        ref[4,0,0,0]=(-0.0134678971538)
        ref[4,0,0,1]=(0.884924133141)
        ref[4,0,1,0]=(-0.66899222691)
        ref[4,0,1,1]=(-0.959185584071)
        ref[4,1,0,0]=(1.05311767886)
        ref[4,1,0,1]=(0.64093792324)
        ref[4,1,1,0]=(0.562875594668)
        ref[4,1,1,1]=(0.539525481691)
        ref[5,0,0,0]=(0.310908751279)
        ref[5,0,0,1]=(0.497074267163)
        ref[5,0,1,0]=(-0.804186513465)
        ref[5,0,1,1]=(0.329762438933)
        ref[5,1,0,0]=(-0.946808260459)
        ref[5,1,0,1]=(-0.00260213368693)
        ref[5,1,1,0]=(0.63415870202)
        ref[5,1,1,1]=(1.38103994652)
      else:
        s[0,0,0]=(-0.0840260391925)*x[0]+(0.385117859595)*x[1]+(1.36354425949)*x[2]
        s[0,0,1]=(0.682480367755)*x[0]+(-0.658980348414)*x[1]+(-0.129734588977)*x[2]
        s[0,1,0]=(-0.213790105123)*x[0]+(-0.774270821015)*x[1]+(0.160024784274)*x[2]
        s[0,1,1]=(-1.02270895286)*x[0]+(1.02607310825)*x[1]+(0.35056114816)*x[2]
        s[1,0,0]=(0.201792116067)*x[0]+(0.223564282304)*x[1]+(0.986785519545)*x[2]
        s[1,0,1]=(0.250819712775)*x[0]+(0.287643279417)*x[1]+(0.18295590528)*x[2]
        s[1,1,0]=(-1.47569225207)*x[0]+(-0.886933933801)*x[1]+(0.525380474082)*x[2]
        s[1,1,1]=(0.680401800239)*x[0]+(1.36155081028)*x[1]+(-1.76198171789)*x[2]
        s[2,0,0]=(-0.784439188011)*x[0]+(-0.797291895631)*x[1]+(-0.425550387518)*x[2]
        s[2,0,1]=(1.62016996989)*x[0]+(1.02824549576)*x[1]+(-0.157995046652)*x[2]
        s[2,1,0]=(-0.437412344413)*x[0]+(0.97005624264)*x[1]+(-0.321998550341)*x[2]
        s[2,1,1]=(0.473879660993)*x[0]+(0.483144823024)*x[1]+(0.168449443711)*x[2]
        s[3,0,0]=(-1.59822104736)*x[0]+(-1.24012649834)*x[1]+(0.695408081789)*x[2]
        s[3,0,1]=(0.827901715486)*x[0]+(-0.230621260402)*x[1]+(-0.789726238476)*x[2]
        s[3,1,0]=(-0.279064257268)*x[0]+(-1.35315417734)*x[1]+(0.593090655629)*x[2]
        s[3,1,1]=(0.387685237641)*x[0]+(1.60258880823)*x[1]+(-1.10088045432)*x[2]
        s[4,0,0]=(0.771374132686)*x[0]+(0.530393756307)*x[1]+(-0.366697715551)*x[2]
        s[4,0,1]=(-0.182374799863)*x[0]+(-0.125579433837)*x[1]+(-1.2028145445)*x[2]
        s[4,1,0]=(-0.208766654808)*x[0]+(0.645251941741)*x[1]+(-0.534068338041)*x[2]
        s[4,1,1]=(-0.064786779421)*x[0]+(0.0354509511326)*x[1]+(-1.32632049137)*x[2]
        s[5,0,0]=(0.833438445425)*x[0]+(0.770186199496)*x[1]+(0.112178380686)*x[2]
        s[5,0,1]=(1.36614714953)*x[0]+(-0.367243359207)*x[1]+(0.812867174908)*x[2]
        s[5,1,0]=(0.0359079603828)*x[0]+(0.622094474303)*x[1]+(-0.33137187739)*x[2]
        s[5,1,1]=(-0.479714378899)*x[0]+(-0.959098499695)*x[1]+(0.843889761479)*x[2]
        ref[0,0,0,0]=(-0.0840260391925)
        ref[0,0,0,1]=(0.385117859595)
        ref[0,0,0,2]=(1.36354425949)
        ref[0,0,1,0]=(0.682480367755)
        ref[0,0,1,1]=(-0.658980348414)
        ref[0,0,1,2]=(-0.129734588977)
        ref[0,1,0,0]=(-0.213790105123)
        ref[0,1,0,1]=(-0.774270821015)
        ref[0,1,0,2]=(0.160024784274)
        ref[0,1,1,0]=(-1.02270895286)
        ref[0,1,1,1]=(1.02607310825)
        ref[0,1,1,2]=(0.35056114816)
        ref[1,0,0,0]=(0.201792116067)
        ref[1,0,0,1]=(0.223564282304)
        ref[1,0,0,2]=(0.986785519545)
        ref[1,0,1,0]=(0.250819712775)
        ref[1,0,1,1]=(0.287643279417)
        ref[1,0,1,2]=(0.18295590528)
        ref[1,1,0,0]=(-1.47569225207)
        ref[1,1,0,1]=(-0.886933933801)
        ref[1,1,0,2]=(0.525380474082)
        ref[1,1,1,0]=(0.680401800239)
        ref[1,1,1,1]=(1.36155081028)
        ref[1,1,1,2]=(-1.76198171789)
        ref[2,0,0,0]=(-0.784439188011)
        ref[2,0,0,1]=(-0.797291895631)
        ref[2,0,0,2]=(-0.425550387518)
        ref[2,0,1,0]=(1.62016996989)
        ref[2,0,1,1]=(1.02824549576)
        ref[2,0,1,2]=(-0.157995046652)
        ref[2,1,0,0]=(-0.437412344413)
        ref[2,1,0,1]=(0.97005624264)
        ref[2,1,0,2]=(-0.321998550341)
        ref[2,1,1,0]=(0.473879660993)
        ref[2,1,1,1]=(0.483144823024)
        ref[2,1,1,2]=(0.168449443711)
        ref[3,0,0,0]=(-1.59822104736)
        ref[3,0,0,1]=(-1.24012649834)
        ref[3,0,0,2]=(0.695408081789)
        ref[3,0,1,0]=(0.827901715486)
        ref[3,0,1,1]=(-0.230621260402)
        ref[3,0,1,2]=(-0.789726238476)
        ref[3,1,0,0]=(-0.279064257268)
        ref[3,1,0,1]=(-1.35315417734)
        ref[3,1,0,2]=(0.593090655629)
        ref[3,1,1,0]=(0.387685237641)
        ref[3,1,1,1]=(1.60258880823)
        ref[3,1,1,2]=(-1.10088045432)
        ref[4,0,0,0]=(0.771374132686)
        ref[4,0,0,1]=(0.530393756307)
        ref[4,0,0,2]=(-0.366697715551)
        ref[4,0,1,0]=(-0.182374799863)
        ref[4,0,1,1]=(-0.125579433837)
        ref[4,0,1,2]=(-1.2028145445)
        ref[4,1,0,0]=(-0.208766654808)
        ref[4,1,0,1]=(0.645251941741)
        ref[4,1,0,2]=(-0.534068338041)
        ref[4,1,1,0]=(-0.064786779421)
        ref[4,1,1,1]=(0.0354509511326)
        ref[4,1,1,2]=(-1.32632049137)
        ref[5,0,0,0]=(0.833438445425)
        ref[5,0,0,1]=(0.770186199496)
        ref[5,0,0,2]=(0.112178380686)
        ref[5,0,1,0]=(1.36614714953)
        ref[5,0,1,1]=(-0.367243359207)
        ref[5,0,1,2]=(0.812867174908)
        ref[5,1,0,0]=(0.0359079603828)
        ref[5,1,0,1]=(0.622094474303)
        ref[5,1,0,2]=(-0.33137187739)
        ref[5,1,1,0]=(-0.479714378899)
        ref[5,1,1,1]=(-0.959098499695)
        ref[5,1,1,2]=(0.843889761479)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.741017463552)*x[0]**o+(0.665549604887)*x[0]+(-0.294688627656)*x[1]**o+(-0.188608956137)*x[1]
        ref[0]=o*(0.741017463552)*x_ref[0]**(o-1)+(0.665549604887)
        ref[1]=o*(-0.294688627656)*x_ref[1]**(o-1)+(-0.188608956137)
      else:
        arg=(-0.182264095574)*x[0]**o+(0.388884343071)*x[0]+(0.0250471058578)*x[1]**o+(0.242724421847)*x[1]+(-0.863568419189)*x[2]**o+(-0.797427046061)*x[2]
        ref[0]=o*(-0.182264095574)*x_ref[0]**(o-1)+(0.388884343071)
        ref[1]=o*(0.0250471058578)*x_ref[1]**(o-1)+(0.242724421847)
        ref[2]=o*(-0.863568419189)*x_ref[2]**(o-1)+(-0.797427046061)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(-0.566748845779)*x[0]**o+(0.284156548246)*x[0]+(0.213805183732)*x[1]**o+(0.887833417271)*x[1]
        arg[1]=(-0.935376067943)*x[0]**o+(0.31417056704)*x[0]+(0.157729703937)*x[1]**o+(0.781264180355)*x[1]
        ref[0,0]=o*(-0.566748845779)*x_ref[0]**(o-1)+(0.284156548246)
        ref[0,1]=o*(0.213805183732)*x_ref[1]**(o-1)+(0.887833417271)
        ref[1,0]=o*(-0.935376067943)*x_ref[0]**(o-1)+(0.31417056704)
        ref[1,1]=o*(0.157729703937)*x_ref[1]**(o-1)+(0.781264180355)
      else:
        arg[0]=(0.787106597246)*x[0]**o+(0.0477259256332)*x[0]+(0.0657839729355)*x[1]**o+(-0.367242386854)*x[1]+(0.638047637996)*x[2]**o+(0.292293368262)*x[2]
        arg[1]=(0.325241621537)*x[0]**o+(-0.995465871567)*x[0]+(-0.589833259992)*x[1]**o+(0.252602994164)*x[1]+(0.271544628727)*x[2]**o+(0.401222388174)*x[2]
        ref[0,0]=o*(0.787106597246)*x_ref[0]**(o-1)+(0.0477259256332)
        ref[0,1]=o*(0.0657839729355)*x_ref[1]**(o-1)+(-0.367242386854)
        ref[0,2]=o*(0.638047637996)*x_ref[2]**(o-1)+(0.292293368262)
        ref[1,0]=o*(0.325241621537)*x_ref[0]**(o-1)+(-0.995465871567)
        ref[1,1]=o*(-0.589833259992)*x_ref[1]**(o-1)+(0.252602994164)
        ref[1,2]=o*(0.271544628727)*x_ref[2]**(o-1)+(0.401222388174)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(-0.535138548297)*x[0]**o+(0.320793182084)*x[0]+(-0.363556615611)*x[1]**o+(0.80028981928)*x[1]
        arg[0,1]=(0.50712290341)*x[0]**o+(0.0696582374725)*x[0]+(-0.565430065964)*x[1]**o+(0.840341269012)*x[1]
        arg[0,2]=(0.222608517758)*x[0]**o+(0.0741096149609)*x[0]+(-0.926916099396)*x[1]**o+(0.840471681255)*x[1]
        arg[0,3]=(-0.0729061065831)*x[0]**o+(-0.361006912293)*x[0]+(-0.796381694915)*x[1]**o+(-0.87399027927)*x[1]
        arg[0,4]=(0.946982642563)*x[0]**o+(0.776871793528)*x[0]+(0.906858449271)*x[1]**o+(0.23076439514)*x[1]
        arg[1,0]=(-0.121641842365)*x[0]**o+(0.755274749862)*x[0]+(-0.905815080361)*x[1]**o+(-0.27711865979)*x[1]
        arg[1,1]=(0.870675475328)*x[0]**o+(0.000245820302085)*x[0]+(0.990534371185)*x[1]**o+(-0.0132722523111)*x[1]
        arg[1,2]=(0.665375098591)*x[0]**o+(0.602779210152)*x[0]+(0.112732227406)*x[1]**o+(0.973600268944)*x[1]
        arg[1,3]=(-0.760686885095)*x[0]**o+(-0.993893837808)*x[0]+(-0.279242757928)*x[1]**o+(0.0970216781461)*x[1]
        arg[1,4]=(-0.326265155118)*x[0]**o+(-0.302971035826)*x[0]+(-0.991053864037)*x[1]**o+(-0.787776341406)*x[1]
        arg[2,0]=(-0.798558123695)*x[0]**o+(-0.648773673567)*x[0]+(0.911336567339)*x[1]**o+(0.525888531875)*x[1]
        arg[2,1]=(0.334481967771)*x[0]**o+(0.559633318828)*x[0]+(-0.738361234791)*x[1]**o+(0.863808627657)*x[1]
        arg[2,2]=(-0.660270802705)*x[0]**o+(-0.500800405285)*x[0]+(0.250991213972)*x[1]**o+(-0.855371865339)*x[1]
        arg[2,3]=(0.573495152924)*x[0]**o+(0.841810214664)*x[0]+(0.816402403997)*x[1]**o+(0.871435278968)*x[1]
        arg[2,4]=(0.00700234490903)*x[0]**o+(0.609696655384)*x[0]+(-0.908261420109)*x[1]**o+(-0.0469518512659)*x[1]
        arg[3,0]=(-0.78381944233)*x[0]**o+(0.547849085605)*x[0]+(-0.481333073199)*x[1]**o+(-0.100496681813)*x[1]
        arg[3,1]=(0.53995869966)*x[0]**o+(-0.503303606531)*x[0]+(0.783394329024)*x[1]**o+(0.989828473603)*x[1]
        arg[3,2]=(0.723590003109)*x[0]**o+(-0.75511396868)*x[0]+(0.249651386017)*x[1]**o+(0.545636109436)*x[1]
        arg[3,3]=(-0.126863462818)*x[0]**o+(0.553295312002)*x[0]+(-0.286155398085)*x[1]**o+(0.425889110789)*x[1]
        arg[3,4]=(-0.970069386779)*x[0]**o+(0.457400568855)*x[0]+(-0.245839304835)*x[1]**o+(-0.463000940469)*x[1]
        ref[0,0,0]=o*(-0.535138548297)*x_ref[0]**(o-1)+(0.320793182084)
        ref[0,0,1]=o*(-0.363556615611)*x_ref[1]**(o-1)+(0.80028981928)
        ref[0,1,0]=o*(0.50712290341)*x_ref[0]**(o-1)+(0.0696582374725)
        ref[0,1,1]=o*(-0.565430065964)*x_ref[1]**(o-1)+(0.840341269012)
        ref[0,2,0]=o*(0.222608517758)*x_ref[0]**(o-1)+(0.0741096149609)
        ref[0,2,1]=o*(-0.926916099396)*x_ref[1]**(o-1)+(0.840471681255)
        ref[0,3,0]=o*(-0.0729061065831)*x_ref[0]**(o-1)+(-0.361006912293)
        ref[0,3,1]=o*(-0.796381694915)*x_ref[1]**(o-1)+(-0.87399027927)
        ref[0,4,0]=o*(0.946982642563)*x_ref[0]**(o-1)+(0.776871793528)
        ref[0,4,1]=o*(0.906858449271)*x_ref[1]**(o-1)+(0.23076439514)
        ref[1,0,0]=o*(-0.121641842365)*x_ref[0]**(o-1)+(0.755274749862)
        ref[1,0,1]=o*(-0.905815080361)*x_ref[1]**(o-1)+(-0.27711865979)
        ref[1,1,0]=o*(0.870675475328)*x_ref[0]**(o-1)+(0.000245820302085)
        ref[1,1,1]=o*(0.990534371185)*x_ref[1]**(o-1)+(-0.0132722523111)
        ref[1,2,0]=o*(0.665375098591)*x_ref[0]**(o-1)+(0.602779210152)
        ref[1,2,1]=o*(0.112732227406)*x_ref[1]**(o-1)+(0.973600268944)
        ref[1,3,0]=o*(-0.760686885095)*x_ref[0]**(o-1)+(-0.993893837808)
        ref[1,3,1]=o*(-0.279242757928)*x_ref[1]**(o-1)+(0.0970216781461)
        ref[1,4,0]=o*(-0.326265155118)*x_ref[0]**(o-1)+(-0.302971035826)
        ref[1,4,1]=o*(-0.991053864037)*x_ref[1]**(o-1)+(-0.787776341406)
        ref[2,0,0]=o*(-0.798558123695)*x_ref[0]**(o-1)+(-0.648773673567)
        ref[2,0,1]=o*(0.911336567339)*x_ref[1]**(o-1)+(0.525888531875)
        ref[2,1,0]=o*(0.334481967771)*x_ref[0]**(o-1)+(0.559633318828)
        ref[2,1,1]=o*(-0.738361234791)*x_ref[1]**(o-1)+(0.863808627657)
        ref[2,2,0]=o*(-0.660270802705)*x_ref[0]**(o-1)+(-0.500800405285)
        ref[2,2,1]=o*(0.250991213972)*x_ref[1]**(o-1)+(-0.855371865339)
        ref[2,3,0]=o*(0.573495152924)*x_ref[0]**(o-1)+(0.841810214664)
        ref[2,3,1]=o*(0.816402403997)*x_ref[1]**(o-1)+(0.871435278968)
        ref[2,4,0]=o*(0.00700234490903)*x_ref[0]**(o-1)+(0.609696655384)
        ref[2,4,1]=o*(-0.908261420109)*x_ref[1]**(o-1)+(-0.0469518512659)
        ref[3,0,0]=o*(-0.78381944233)*x_ref[0]**(o-1)+(0.547849085605)
        ref[3,0,1]=o*(-0.481333073199)*x_ref[1]**(o-1)+(-0.100496681813)
        ref[3,1,0]=o*(0.53995869966)*x_ref[0]**(o-1)+(-0.503303606531)
        ref[3,1,1]=o*(0.783394329024)*x_ref[1]**(o-1)+(0.989828473603)
        ref[3,2,0]=o*(0.723590003109)*x_ref[0]**(o-1)+(-0.75511396868)
        ref[3,2,1]=o*(0.249651386017)*x_ref[1]**(o-1)+(0.545636109436)
        ref[3,3,0]=o*(-0.126863462818)*x_ref[0]**(o-1)+(0.553295312002)
        ref[3,3,1]=o*(-0.286155398085)*x_ref[1]**(o-1)+(0.425889110789)
        ref[3,4,0]=o*(-0.970069386779)*x_ref[0]**(o-1)+(0.457400568855)
        ref[3,4,1]=o*(-0.245839304835)*x_ref[1]**(o-1)+(-0.463000940469)
      else:
        arg[0,0]=(-0.0252675874258)*x[0]**o+(-0.998043629662)*x[0]+(-0.956603187221)*x[1]**o+(-0.642113208329)*x[1]+(-0.59687133215)*x[2]**o+(-0.222380006695)*x[2]
        arg[0,1]=(0.540057023826)*x[0]**o+(0.660021105706)*x[0]+(-0.0847035816563)*x[1]**o+(0.734935147879)*x[1]+(0.895080236848)*x[2]**o+(0.759076168225)*x[2]
        arg[0,2]=(0.208276460123)*x[0]**o+(-0.842726599314)*x[0]+(0.514146640689)*x[1]**o+(-0.931115443386)*x[1]+(-0.427990918054)*x[2]**o+(-0.0944702225036)*x[2]
        arg[0,3]=(-0.669873393665)*x[0]**o+(-0.164211687812)*x[0]+(0.257292402022)*x[1]**o+(0.788249196864)*x[1]+(-0.0160232742588)*x[2]**o+(0.593261720532)*x[2]
        arg[0,4]=(0.574685018662)*x[0]**o+(-0.404093341935)*x[0]+(-0.613704015926)*x[1]**o+(-0.388769512229)*x[1]+(0.65014059769)*x[2]**o+(0.796497720581)*x[2]
        arg[1,0]=(0.579425469692)*x[0]**o+(0.706786266065)*x[0]+(-0.489805412824)*x[1]**o+(0.412673120993)*x[1]+(-0.261487328773)*x[2]**o+(0.323016314178)*x[2]
        arg[1,1]=(-0.406115852457)*x[0]**o+(-0.320011474154)*x[0]+(0.83353566302)*x[1]**o+(-0.770757586792)*x[1]+(-0.497021878205)*x[2]**o+(-0.108546214912)*x[2]
        arg[1,2]=(-0.799159182698)*x[0]**o+(0.221424788319)*x[0]+(0.882092644719)*x[1]**o+(0.25804039903)*x[1]+(-0.788642442802)*x[2]**o+(-0.434293659417)*x[2]
        arg[1,3]=(-0.453596867354)*x[0]**o+(-0.855684542333)*x[0]+(0.421257402196)*x[1]**o+(0.162268279507)*x[1]+(-0.618396236314)*x[2]**o+(-0.650684413266)*x[2]
        arg[1,4]=(-0.464749011522)*x[0]**o+(-0.050661862641)*x[0]+(-0.7554290975)*x[1]**o+(-0.213826578781)*x[1]+(-0.536460109672)*x[2]**o+(-0.441490452069)*x[2]
        arg[2,0]=(0.335438338384)*x[0]**o+(-0.598515232086)*x[0]+(0.396958696838)*x[1]**o+(0.712094780848)*x[1]+(0.0112487672163)*x[2]**o+(-0.106361601342)*x[2]
        arg[2,1]=(0.157333767552)*x[0]**o+(0.763247557186)*x[0]+(0.454047596703)*x[1]**o+(0.874633696245)*x[1]+(0.80992740886)*x[2]**o+(-0.465565575276)*x[2]
        arg[2,2]=(-0.668932235683)*x[0]**o+(0.99055962791)*x[0]+(-0.473440344595)*x[1]**o+(-0.694789559356)*x[1]+(-0.337501506478)*x[2]**o+(-0.552461610916)*x[2]
        arg[2,3]=(-0.174040039098)*x[0]**o+(0.878604594327)*x[0]+(-0.488684761288)*x[1]**o+(-0.225626690649)*x[1]+(0.307550460093)*x[2]**o+(0.279172145442)*x[2]
        arg[2,4]=(0.771496476361)*x[0]**o+(-0.528231004311)*x[0]+(0.318620411204)*x[1]**o+(-0.831636376644)*x[1]+(-0.23477599759)*x[2]**o+(0.452986258707)*x[2]
        arg[3,0]=(0.689878836595)*x[0]**o+(-0.723887531161)*x[0]+(0.906077469738)*x[1]**o+(-0.729986756151)*x[1]+(0.860506345609)*x[2]**o+(-0.437203511895)*x[2]
        arg[3,1]=(0.867909616506)*x[0]**o+(-0.0480808079676)*x[0]+(-0.439925732789)*x[1]**o+(-0.753945614279)*x[1]+(-0.0015149141551)*x[2]**o+(-0.465559525628)*x[2]
        arg[3,2]=(0.915231983332)*x[0]**o+(0.77428136852)*x[0]+(0.902598621987)*x[1]**o+(-0.49204288782)*x[1]+(0.77362022057)*x[2]**o+(0.872135547313)*x[2]
        arg[3,3]=(0.274436414079)*x[0]**o+(-0.291721638943)*x[0]+(0.202501119852)*x[1]**o+(0.911330931145)*x[1]+(-0.61382801878)*x[2]**o+(0.386704897682)*x[2]
        arg[3,4]=(-0.0258695378217)*x[0]**o+(0.263046110195)*x[0]+(-0.162461126288)*x[1]**o+(-0.123570278155)*x[1]+(0.598012400912)*x[2]**o+(0.769951340801)*x[2]
        ref[0,0,0]=o*(-0.0252675874258)*x_ref[0]**(o-1)+(-0.998043629662)
        ref[0,0,1]=o*(-0.956603187221)*x_ref[1]**(o-1)+(-0.642113208329)
        ref[0,0,2]=o*(-0.59687133215)*x_ref[2]**(o-1)+(-0.222380006695)
        ref[0,1,0]=o*(0.540057023826)*x_ref[0]**(o-1)+(0.660021105706)
        ref[0,1,1]=o*(-0.0847035816563)*x_ref[1]**(o-1)+(0.734935147879)
        ref[0,1,2]=o*(0.895080236848)*x_ref[2]**(o-1)+(0.759076168225)
        ref[0,2,0]=o*(0.208276460123)*x_ref[0]**(o-1)+(-0.842726599314)
        ref[0,2,1]=o*(0.514146640689)*x_ref[1]**(o-1)+(-0.931115443386)
        ref[0,2,2]=o*(-0.427990918054)*x_ref[2]**(o-1)+(-0.0944702225036)
        ref[0,3,0]=o*(-0.669873393665)*x_ref[0]**(o-1)+(-0.164211687812)
        ref[0,3,1]=o*(0.257292402022)*x_ref[1]**(o-1)+(0.788249196864)
        ref[0,3,2]=o*(-0.0160232742588)*x_ref[2]**(o-1)+(0.593261720532)
        ref[0,4,0]=o*(0.574685018662)*x_ref[0]**(o-1)+(-0.404093341935)
        ref[0,4,1]=o*(-0.613704015926)*x_ref[1]**(o-1)+(-0.388769512229)
        ref[0,4,2]=o*(0.65014059769)*x_ref[2]**(o-1)+(0.796497720581)
        ref[1,0,0]=o*(0.579425469692)*x_ref[0]**(o-1)+(0.706786266065)
        ref[1,0,1]=o*(-0.489805412824)*x_ref[1]**(o-1)+(0.412673120993)
        ref[1,0,2]=o*(-0.261487328773)*x_ref[2]**(o-1)+(0.323016314178)
        ref[1,1,0]=o*(-0.406115852457)*x_ref[0]**(o-1)+(-0.320011474154)
        ref[1,1,1]=o*(0.83353566302)*x_ref[1]**(o-1)+(-0.770757586792)
        ref[1,1,2]=o*(-0.497021878205)*x_ref[2]**(o-1)+(-0.108546214912)
        ref[1,2,0]=o*(-0.799159182698)*x_ref[0]**(o-1)+(0.221424788319)
        ref[1,2,1]=o*(0.882092644719)*x_ref[1]**(o-1)+(0.25804039903)
        ref[1,2,2]=o*(-0.788642442802)*x_ref[2]**(o-1)+(-0.434293659417)
        ref[1,3,0]=o*(-0.453596867354)*x_ref[0]**(o-1)+(-0.855684542333)
        ref[1,3,1]=o*(0.421257402196)*x_ref[1]**(o-1)+(0.162268279507)
        ref[1,3,2]=o*(-0.618396236314)*x_ref[2]**(o-1)+(-0.650684413266)
        ref[1,4,0]=o*(-0.464749011522)*x_ref[0]**(o-1)+(-0.050661862641)
        ref[1,4,1]=o*(-0.7554290975)*x_ref[1]**(o-1)+(-0.213826578781)
        ref[1,4,2]=o*(-0.536460109672)*x_ref[2]**(o-1)+(-0.441490452069)
        ref[2,0,0]=o*(0.335438338384)*x_ref[0]**(o-1)+(-0.598515232086)
        ref[2,0,1]=o*(0.396958696838)*x_ref[1]**(o-1)+(0.712094780848)
        ref[2,0,2]=o*(0.0112487672163)*x_ref[2]**(o-1)+(-0.106361601342)
        ref[2,1,0]=o*(0.157333767552)*x_ref[0]**(o-1)+(0.763247557186)
        ref[2,1,1]=o*(0.454047596703)*x_ref[1]**(o-1)+(0.874633696245)
        ref[2,1,2]=o*(0.80992740886)*x_ref[2]**(o-1)+(-0.465565575276)
        ref[2,2,0]=o*(-0.668932235683)*x_ref[0]**(o-1)+(0.99055962791)
        ref[2,2,1]=o*(-0.473440344595)*x_ref[1]**(o-1)+(-0.694789559356)
        ref[2,2,2]=o*(-0.337501506478)*x_ref[2]**(o-1)+(-0.552461610916)
        ref[2,3,0]=o*(-0.174040039098)*x_ref[0]**(o-1)+(0.878604594327)
        ref[2,3,1]=o*(-0.488684761288)*x_ref[1]**(o-1)+(-0.225626690649)
        ref[2,3,2]=o*(0.307550460093)*x_ref[2]**(o-1)+(0.279172145442)
        ref[2,4,0]=o*(0.771496476361)*x_ref[0]**(o-1)+(-0.528231004311)
        ref[2,4,1]=o*(0.318620411204)*x_ref[1]**(o-1)+(-0.831636376644)
        ref[2,4,2]=o*(-0.23477599759)*x_ref[2]**(o-1)+(0.452986258707)
        ref[3,0,0]=o*(0.689878836595)*x_ref[0]**(o-1)+(-0.723887531161)
        ref[3,0,1]=o*(0.906077469738)*x_ref[1]**(o-1)+(-0.729986756151)
        ref[3,0,2]=o*(0.860506345609)*x_ref[2]**(o-1)+(-0.437203511895)
        ref[3,1,0]=o*(0.867909616506)*x_ref[0]**(o-1)+(-0.0480808079676)
        ref[3,1,1]=o*(-0.439925732789)*x_ref[1]**(o-1)+(-0.753945614279)
        ref[3,1,2]=o*(-0.0015149141551)*x_ref[2]**(o-1)+(-0.465559525628)
        ref[3,2,0]=o*(0.915231983332)*x_ref[0]**(o-1)+(0.77428136852)
        ref[3,2,1]=o*(0.902598621987)*x_ref[1]**(o-1)+(-0.49204288782)
        ref[3,2,2]=o*(0.77362022057)*x_ref[2]**(o-1)+(0.872135547313)
        ref[3,3,0]=o*(0.274436414079)*x_ref[0]**(o-1)+(-0.291721638943)
        ref[3,3,1]=o*(0.202501119852)*x_ref[1]**(o-1)+(0.911330931145)
        ref[3,3,2]=o*(-0.61382801878)*x_ref[2]**(o-1)+(0.386704897682)
        ref[3,4,0]=o*(-0.0258695378217)*x_ref[0]**(o-1)+(0.263046110195)
        ref[3,4,1]=o*(-0.162461126288)*x_ref[1]**(o-1)+(-0.123570278155)
        ref[3,4,2]=o*(0.598012400912)*x_ref[2]**(o-1)+(0.769951340801)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(-0.301542954432)*x[0]**o+(-0.126029003998)*x[0]+(-0.408561086014)*x[1]**o+(0.090642210886)*x[1]
        arg[0,0,1]=(0.456052591865)*x[0]**o+(0.624896766511)*x[0]+(0.87137087467)*x[1]**o+(-0.296114354421)*x[1]
        arg[0,1,0]=(0.370833001032)*x[0]**o+(-0.700862384031)*x[0]+(-0.276076372016)*x[1]**o+(-0.820884025764)*x[1]
        arg[0,1,1]=(0.550805148631)*x[0]**o+(-0.628825647329)*x[0]+(0.906362219793)*x[1]**o+(0.093148354989)*x[1]
        arg[1,0,0]=(-0.80347190678)*x[0]**o+(-0.112285193049)*x[0]+(-0.703090064994)*x[1]**o+(0.738893806856)*x[1]
        arg[1,0,1]=(0.716113817265)*x[0]**o+(-0.403563175278)*x[0]+(-0.545474326725)*x[1]**o+(-0.085377932579)*x[1]
        arg[1,1,0]=(0.0151945295253)*x[0]**o+(0.419681120006)*x[0]+(0.605889120207)*x[1]**o+(0.94921670969)*x[1]
        arg[1,1,1]=(0.330888675781)*x[0]**o+(0.536336632067)*x[0]+(0.130243661103)*x[1]**o+(0.249581698903)*x[1]
        arg[2,0,0]=(-0.94168189216)*x[0]**o+(0.42899125004)*x[0]+(0.104206704223)*x[1]**o+(0.992451993183)*x[1]
        arg[2,0,1]=(-0.557898869487)*x[0]**o+(-0.0387050073802)*x[0]+(-0.880396260326)*x[1]**o+(-0.649734782543)*x[1]
        arg[2,1,0]=(0.0362873703011)*x[0]**o+(0.641116555832)*x[0]+(-0.878565186806)*x[1]**o+(-0.305825058029)*x[1]
        arg[2,1,1]=(0.926144430868)*x[0]**o+(0.207902756992)*x[0]+(-0.823834000424)*x[1]**o+(0.541980766739)*x[1]
        arg[3,0,0]=(-0.497934527226)*x[0]**o+(0.904514339359)*x[0]+(0.0627382682436)*x[1]**o+(-0.886845257384)*x[1]
        arg[3,0,1]=(0.458163004678)*x[0]**o+(-0.890966354569)*x[0]+(0.779511556433)*x[1]**o+(0.911407858547)*x[1]
        arg[3,1,0]=(0.643197533583)*x[0]**o+(-0.445952483015)*x[0]+(-0.491648538422)*x[1]**o+(-0.339803793944)*x[1]
        arg[3,1,1]=(0.564910446806)*x[0]**o+(-0.251342703228)*x[0]+(-0.102526510378)*x[1]**o+(0.989034603428)*x[1]
        arg[4,0,0]=(0.0728812877818)*x[0]**o+(-0.160839673847)*x[0]+(0.078039622926)*x[1]**o+(-0.778740146006)*x[1]
        arg[4,0,1]=(-0.848970759855)*x[0]**o+(0.83795370612)*x[0]+(-0.652802628253)*x[1]**o+(0.570900978851)*x[1]
        arg[4,1,0]=(0.492154273484)*x[0]**o+(-0.138488354185)*x[0]+(0.269142955069)*x[1]**o+(-0.849995493706)*x[1]
        arg[4,1,1]=(0.945032529684)*x[0]**o+(0.611284327327)*x[0]+(0.549856083886)*x[1]**o+(0.347585489606)*x[1]
        arg[5,0,0]=(0.481456547858)*x[0]**o+(0.238848312219)*x[0]+(-0.5849679413)*x[1]**o+(-0.749140400072)*x[1]
        arg[5,0,1]=(0.27081490311)*x[0]**o+(-0.101642948148)*x[0]+(0.31847076679)*x[1]**o+(0.192182993758)*x[1]
        arg[5,1,0]=(-0.873348151897)*x[0]**o+(-0.613499952221)*x[0]+(0.54087826152)*x[1]**o+(-0.269096416524)*x[1]
        arg[5,1,1]=(-0.803277233859)*x[0]**o+(-0.714237882827)*x[0]+(-0.205544031812)*x[1]**o+(0.188144864673)*x[1]
        ref[0,0,0,0]=o*(-0.301542954432)*x_ref[0]**(o-1)+(-0.126029003998)
        ref[0,0,0,1]=o*(-0.408561086014)*x_ref[1]**(o-1)+(0.090642210886)
        ref[0,0,1,0]=o*(0.456052591865)*x_ref[0]**(o-1)+(0.624896766511)
        ref[0,0,1,1]=o*(0.87137087467)*x_ref[1]**(o-1)+(-0.296114354421)
        ref[0,1,0,0]=o*(0.370833001032)*x_ref[0]**(o-1)+(-0.700862384031)
        ref[0,1,0,1]=o*(-0.276076372016)*x_ref[1]**(o-1)+(-0.820884025764)
        ref[0,1,1,0]=o*(0.550805148631)*x_ref[0]**(o-1)+(-0.628825647329)
        ref[0,1,1,1]=o*(0.906362219793)*x_ref[1]**(o-1)+(0.093148354989)
        ref[1,0,0,0]=o*(-0.80347190678)*x_ref[0]**(o-1)+(-0.112285193049)
        ref[1,0,0,1]=o*(-0.703090064994)*x_ref[1]**(o-1)+(0.738893806856)
        ref[1,0,1,0]=o*(0.716113817265)*x_ref[0]**(o-1)+(-0.403563175278)
        ref[1,0,1,1]=o*(-0.545474326725)*x_ref[1]**(o-1)+(-0.085377932579)
        ref[1,1,0,0]=o*(0.0151945295253)*x_ref[0]**(o-1)+(0.419681120006)
        ref[1,1,0,1]=o*(0.605889120207)*x_ref[1]**(o-1)+(0.94921670969)
        ref[1,1,1,0]=o*(0.330888675781)*x_ref[0]**(o-1)+(0.536336632067)
        ref[1,1,1,1]=o*(0.130243661103)*x_ref[1]**(o-1)+(0.249581698903)
        ref[2,0,0,0]=o*(-0.94168189216)*x_ref[0]**(o-1)+(0.42899125004)
        ref[2,0,0,1]=o*(0.104206704223)*x_ref[1]**(o-1)+(0.992451993183)
        ref[2,0,1,0]=o*(-0.557898869487)*x_ref[0]**(o-1)+(-0.0387050073802)
        ref[2,0,1,1]=o*(-0.880396260326)*x_ref[1]**(o-1)+(-0.649734782543)
        ref[2,1,0,0]=o*(0.0362873703011)*x_ref[0]**(o-1)+(0.641116555832)
        ref[2,1,0,1]=o*(-0.878565186806)*x_ref[1]**(o-1)+(-0.305825058029)
        ref[2,1,1,0]=o*(0.926144430868)*x_ref[0]**(o-1)+(0.207902756992)
        ref[2,1,1,1]=o*(-0.823834000424)*x_ref[1]**(o-1)+(0.541980766739)
        ref[3,0,0,0]=o*(-0.497934527226)*x_ref[0]**(o-1)+(0.904514339359)
        ref[3,0,0,1]=o*(0.0627382682436)*x_ref[1]**(o-1)+(-0.886845257384)
        ref[3,0,1,0]=o*(0.458163004678)*x_ref[0]**(o-1)+(-0.890966354569)
        ref[3,0,1,1]=o*(0.779511556433)*x_ref[1]**(o-1)+(0.911407858547)
        ref[3,1,0,0]=o*(0.643197533583)*x_ref[0]**(o-1)+(-0.445952483015)
        ref[3,1,0,1]=o*(-0.491648538422)*x_ref[1]**(o-1)+(-0.339803793944)
        ref[3,1,1,0]=o*(0.564910446806)*x_ref[0]**(o-1)+(-0.251342703228)
        ref[3,1,1,1]=o*(-0.102526510378)*x_ref[1]**(o-1)+(0.989034603428)
        ref[4,0,0,0]=o*(0.0728812877818)*x_ref[0]**(o-1)+(-0.160839673847)
        ref[4,0,0,1]=o*(0.078039622926)*x_ref[1]**(o-1)+(-0.778740146006)
        ref[4,0,1,0]=o*(-0.848970759855)*x_ref[0]**(o-1)+(0.83795370612)
        ref[4,0,1,1]=o*(-0.652802628253)*x_ref[1]**(o-1)+(0.570900978851)
        ref[4,1,0,0]=o*(0.492154273484)*x_ref[0]**(o-1)+(-0.138488354185)
        ref[4,1,0,1]=o*(0.269142955069)*x_ref[1]**(o-1)+(-0.849995493706)
        ref[4,1,1,0]=o*(0.945032529684)*x_ref[0]**(o-1)+(0.611284327327)
        ref[4,1,1,1]=o*(0.549856083886)*x_ref[1]**(o-1)+(0.347585489606)
        ref[5,0,0,0]=o*(0.481456547858)*x_ref[0]**(o-1)+(0.238848312219)
        ref[5,0,0,1]=o*(-0.5849679413)*x_ref[1]**(o-1)+(-0.749140400072)
        ref[5,0,1,0]=o*(0.27081490311)*x_ref[0]**(o-1)+(-0.101642948148)
        ref[5,0,1,1]=o*(0.31847076679)*x_ref[1]**(o-1)+(0.192182993758)
        ref[5,1,0,0]=o*(-0.873348151897)*x_ref[0]**(o-1)+(-0.613499952221)
        ref[5,1,0,1]=o*(0.54087826152)*x_ref[1]**(o-1)+(-0.269096416524)
        ref[5,1,1,0]=o*(-0.803277233859)*x_ref[0]**(o-1)+(-0.714237882827)
        ref[5,1,1,1]=o*(-0.205544031812)*x_ref[1]**(o-1)+(0.188144864673)
      else:
        arg[0,0,0]=(-0.639251981322)*x[0]**o+(-0.115972267818)*x[0]+(0.491134645863)*x[1]**o+(0.345343639029)*x[1]+(-0.663597762251)*x[2]**o+(-0.328150609455)*x[2]
        arg[0,0,1]=(-0.76280151252)*x[0]**o+(0.933789965647)*x[0]+(-0.117386438957)*x[1]**o+(0.738801880577)*x[1]+(-0.823759196233)*x[2]**o+(-0.591225057134)*x[2]
        arg[0,1,0]=(-0.515479158328)*x[0]**o+(-0.498840147412)*x[0]+(-0.07870152457)*x[1]**o+(0.240823897179)*x[1]+(-0.529483054724)*x[2]**o+(0.957444878465)*x[2]
        arg[0,1,1]=(0.659163197783)*x[0]**o+(-0.987017484017)*x[0]+(0.316073196672)*x[1]**o+(-0.858184573568)*x[1]+(-0.324909144593)*x[2]**o+(-0.89624674398)*x[2]
        arg[1,0,0]=(0.582390600104)*x[0]**o+(-0.808724939916)*x[0]+(-0.204186916478)*x[1]**o+(0.63212764696)*x[1]+(-0.272947627588)*x[2]**o+(-0.133369751815)*x[2]
        arg[1,0,1]=(-0.955892141909)*x[0]**o+(0.915832405494)*x[0]+(-0.823428836636)*x[1]**o+(-0.527176552593)*x[1]+(-0.439872810771)*x[2]**o+(0.282431362763)*x[2]
        arg[1,1,0]=(0.269192050139)*x[0]**o+(0.304289733459)*x[0]+(-0.252137123064)*x[1]**o+(0.159346881758)*x[1]+(-0.875713938743)*x[2]**o+(-0.804681982204)*x[2]
        arg[1,1,1]=(0.100159906585)*x[0]**o+(0.652670710888)*x[0]+(-0.0471177296503)*x[1]**o+(0.15344212377)*x[1]+(0.162356023341)*x[2]**o+(0.242855769737)*x[2]
        arg[2,0,0]=(-0.0214334988311)*x[0]**o+(0.444654672491)*x[0]+(0.235478960156)*x[1]**o+(0.62191559883)*x[1]+(0.124531773653)*x[2]**o+(-0.603748942811)*x[2]
        arg[2,0,1]=(-0.00696114124898)*x[0]**o+(-0.350635993795)*x[0]+(0.766513244466)*x[1]**o+(-0.99996024111)*x[1]+(0.976036637033)*x[2]**o+(0.00703160282837)*x[2]
        arg[2,1,0]=(-0.210499708873)*x[0]**o+(-0.763641982769)*x[0]+(0.435435481771)*x[1]**o+(0.0886400511888)*x[1]+(0.540913993886)*x[2]**o+(-0.864904989707)*x[2]
        arg[2,1,1]=(0.609017357846)*x[0]**o+(-0.681305727596)*x[0]+(-0.291763309802)*x[1]**o+(0.12465245807)*x[1]+(-0.265362499082)*x[2]**o+(-0.978509447338)*x[2]
        arg[3,0,0]=(0.622861389608)*x[0]**o+(-0.341108338962)*x[0]+(0.908588438318)*x[1]**o+(-0.583012719535)*x[1]+(0.33513654797)*x[2]**o+(-0.835513934636)*x[2]
        arg[3,0,1]=(0.164841305439)*x[0]**o+(-0.622242302911)*x[0]+(-0.0469305037163)*x[1]**o+(-0.859517953063)*x[1]+(-0.112485630662)*x[2]**o+(0.31475831421)*x[2]
        arg[3,1,0]=(-0.177913851996)*x[0]**o+(0.74607750787)*x[0]+(-0.188838634745)*x[1]**o+(-0.803617744529)*x[1]+(0.18839438068)*x[2]**o+(-0.857696671728)*x[2]
        arg[3,1,1]=(0.485172697497)*x[0]**o+(-0.554750723313)*x[0]+(-0.59838039994)*x[1]**o+(-0.83177053032)*x[1]+(0.655490277067)*x[2]**o+(0.0645924856059)*x[2]
        arg[4,0,0]=(0.900678166492)*x[0]**o+(-0.485573346705)*x[0]+(0.0108149783491)*x[1]**o+(0.982616024342)*x[1]+(-0.374371784319)*x[2]**o+(-0.825014166204)*x[2]
        arg[4,0,1]=(0.682753472393)*x[0]**o+(0.810927347906)*x[0]+(-0.128780174224)*x[1]**o+(0.514607304836)*x[1]+(0.606285011416)*x[2]**o+(-0.691191486471)*x[2]
        arg[4,1,0]=(0.0103661338625)*x[0]**o+(0.184111752707)*x[0]+(-0.270751890504)*x[1]**o+(0.207351712222)*x[1]+(-0.366280871535)*x[2]**o+(-0.638450092731)*x[2]
        arg[4,1,1]=(-0.111302974207)*x[0]**o+(-0.520252159917)*x[0]+(-0.911197545741)*x[1]**o+(-0.779732160528)*x[1]+(-0.443379349795)*x[2]**o+(-0.783540988384)*x[2]
        arg[5,0,0]=(0.319701766792)*x[0]**o+(-0.953929305858)*x[0]+(-0.783942145061)*x[1]**o+(0.687992583635)*x[1]+(0.873868267323)*x[2]**o+(-0.204836707955)*x[2]
        arg[5,0,1]=(-0.240340717622)*x[0]**o+(-0.799598459684)*x[0]+(-0.827096078861)*x[1]**o+(0.229071234102)*x[1]+(0.309197705487)*x[2]**o+(-0.286088934882)*x[2]
        arg[5,1,0]=(-0.0926450319507)*x[0]**o+(0.638985747884)*x[0]+(0.604913216138)*x[1]**o+(-0.364251815312)*x[1]+(-0.47971664069)*x[2]**o+(-0.20655528518)*x[2]
        arg[5,1,1]=(0.418341452333)*x[0]**o+(0.430002851684)*x[0]+(0.624025385599)*x[1]**o+(0.338601201629)*x[1]+(0.0900364406242)*x[2]**o+(0.193533337073)*x[2]
        ref[0,0,0,0]=o*(-0.639251981322)*x_ref[0]**(o-1)+(-0.115972267818)
        ref[0,0,0,1]=o*(0.491134645863)*x_ref[1]**(o-1)+(0.345343639029)
        ref[0,0,0,2]=o*(-0.663597762251)*x_ref[2]**(o-1)+(-0.328150609455)
        ref[0,0,1,0]=o*(-0.76280151252)*x_ref[0]**(o-1)+(0.933789965647)
        ref[0,0,1,1]=o*(-0.117386438957)*x_ref[1]**(o-1)+(0.738801880577)
        ref[0,0,1,2]=o*(-0.823759196233)*x_ref[2]**(o-1)+(-0.591225057134)
        ref[0,1,0,0]=o*(-0.515479158328)*x_ref[0]**(o-1)+(-0.498840147412)
        ref[0,1,0,1]=o*(-0.07870152457)*x_ref[1]**(o-1)+(0.240823897179)
        ref[0,1,0,2]=o*(-0.529483054724)*x_ref[2]**(o-1)+(0.957444878465)
        ref[0,1,1,0]=o*(0.659163197783)*x_ref[0]**(o-1)+(-0.987017484017)
        ref[0,1,1,1]=o*(0.316073196672)*x_ref[1]**(o-1)+(-0.858184573568)
        ref[0,1,1,2]=o*(-0.324909144593)*x_ref[2]**(o-1)+(-0.89624674398)
        ref[1,0,0,0]=o*(0.582390600104)*x_ref[0]**(o-1)+(-0.808724939916)
        ref[1,0,0,1]=o*(-0.204186916478)*x_ref[1]**(o-1)+(0.63212764696)
        ref[1,0,0,2]=o*(-0.272947627588)*x_ref[2]**(o-1)+(-0.133369751815)
        ref[1,0,1,0]=o*(-0.955892141909)*x_ref[0]**(o-1)+(0.915832405494)
        ref[1,0,1,1]=o*(-0.823428836636)*x_ref[1]**(o-1)+(-0.527176552593)
        ref[1,0,1,2]=o*(-0.439872810771)*x_ref[2]**(o-1)+(0.282431362763)
        ref[1,1,0,0]=o*(0.269192050139)*x_ref[0]**(o-1)+(0.304289733459)
        ref[1,1,0,1]=o*(-0.252137123064)*x_ref[1]**(o-1)+(0.159346881758)
        ref[1,1,0,2]=o*(-0.875713938743)*x_ref[2]**(o-1)+(-0.804681982204)
        ref[1,1,1,0]=o*(0.100159906585)*x_ref[0]**(o-1)+(0.652670710888)
        ref[1,1,1,1]=o*(-0.0471177296503)*x_ref[1]**(o-1)+(0.15344212377)
        ref[1,1,1,2]=o*(0.162356023341)*x_ref[2]**(o-1)+(0.242855769737)
        ref[2,0,0,0]=o*(-0.0214334988311)*x_ref[0]**(o-1)+(0.444654672491)
        ref[2,0,0,1]=o*(0.235478960156)*x_ref[1]**(o-1)+(0.62191559883)
        ref[2,0,0,2]=o*(0.124531773653)*x_ref[2]**(o-1)+(-0.603748942811)
        ref[2,0,1,0]=o*(-0.00696114124898)*x_ref[0]**(o-1)+(-0.350635993795)
        ref[2,0,1,1]=o*(0.766513244466)*x_ref[1]**(o-1)+(-0.99996024111)
        ref[2,0,1,2]=o*(0.976036637033)*x_ref[2]**(o-1)+(0.00703160282837)
        ref[2,1,0,0]=o*(-0.210499708873)*x_ref[0]**(o-1)+(-0.763641982769)
        ref[2,1,0,1]=o*(0.435435481771)*x_ref[1]**(o-1)+(0.0886400511888)
        ref[2,1,0,2]=o*(0.540913993886)*x_ref[2]**(o-1)+(-0.864904989707)
        ref[2,1,1,0]=o*(0.609017357846)*x_ref[0]**(o-1)+(-0.681305727596)
        ref[2,1,1,1]=o*(-0.291763309802)*x_ref[1]**(o-1)+(0.12465245807)
        ref[2,1,1,2]=o*(-0.265362499082)*x_ref[2]**(o-1)+(-0.978509447338)
        ref[3,0,0,0]=o*(0.622861389608)*x_ref[0]**(o-1)+(-0.341108338962)
        ref[3,0,0,1]=o*(0.908588438318)*x_ref[1]**(o-1)+(-0.583012719535)
        ref[3,0,0,2]=o*(0.33513654797)*x_ref[2]**(o-1)+(-0.835513934636)
        ref[3,0,1,0]=o*(0.164841305439)*x_ref[0]**(o-1)+(-0.622242302911)
        ref[3,0,1,1]=o*(-0.0469305037163)*x_ref[1]**(o-1)+(-0.859517953063)
        ref[3,0,1,2]=o*(-0.112485630662)*x_ref[2]**(o-1)+(0.31475831421)
        ref[3,1,0,0]=o*(-0.177913851996)*x_ref[0]**(o-1)+(0.74607750787)
        ref[3,1,0,1]=o*(-0.188838634745)*x_ref[1]**(o-1)+(-0.803617744529)
        ref[3,1,0,2]=o*(0.18839438068)*x_ref[2]**(o-1)+(-0.857696671728)
        ref[3,1,1,0]=o*(0.485172697497)*x_ref[0]**(o-1)+(-0.554750723313)
        ref[3,1,1,1]=o*(-0.59838039994)*x_ref[1]**(o-1)+(-0.83177053032)
        ref[3,1,1,2]=o*(0.655490277067)*x_ref[2]**(o-1)+(0.0645924856059)
        ref[4,0,0,0]=o*(0.900678166492)*x_ref[0]**(o-1)+(-0.485573346705)
        ref[4,0,0,1]=o*(0.0108149783491)*x_ref[1]**(o-1)+(0.982616024342)
        ref[4,0,0,2]=o*(-0.374371784319)*x_ref[2]**(o-1)+(-0.825014166204)
        ref[4,0,1,0]=o*(0.682753472393)*x_ref[0]**(o-1)+(0.810927347906)
        ref[4,0,1,1]=o*(-0.128780174224)*x_ref[1]**(o-1)+(0.514607304836)
        ref[4,0,1,2]=o*(0.606285011416)*x_ref[2]**(o-1)+(-0.691191486471)
        ref[4,1,0,0]=o*(0.0103661338625)*x_ref[0]**(o-1)+(0.184111752707)
        ref[4,1,0,1]=o*(-0.270751890504)*x_ref[1]**(o-1)+(0.207351712222)
        ref[4,1,0,2]=o*(-0.366280871535)*x_ref[2]**(o-1)+(-0.638450092731)
        ref[4,1,1,0]=o*(-0.111302974207)*x_ref[0]**(o-1)+(-0.520252159917)
        ref[4,1,1,1]=o*(-0.911197545741)*x_ref[1]**(o-1)+(-0.779732160528)
        ref[4,1,1,2]=o*(-0.443379349795)*x_ref[2]**(o-1)+(-0.783540988384)
        ref[5,0,0,0]=o*(0.319701766792)*x_ref[0]**(o-1)+(-0.953929305858)
        ref[5,0,0,1]=o*(-0.783942145061)*x_ref[1]**(o-1)+(0.687992583635)
        ref[5,0,0,2]=o*(0.873868267323)*x_ref[2]**(o-1)+(-0.204836707955)
        ref[5,0,1,0]=o*(-0.240340717622)*x_ref[0]**(o-1)+(-0.799598459684)
        ref[5,0,1,1]=o*(-0.827096078861)*x_ref[1]**(o-1)+(0.229071234102)
        ref[5,0,1,2]=o*(0.309197705487)*x_ref[2]**(o-1)+(-0.286088934882)
        ref[5,1,0,0]=o*(-0.0926450319507)*x_ref[0]**(o-1)+(0.638985747884)
        ref[5,1,0,1]=o*(0.604913216138)*x_ref[1]**(o-1)+(-0.364251815312)
        ref[5,1,0,2]=o*(-0.47971664069)*x_ref[2]**(o-1)+(-0.20655528518)
        ref[5,1,1,0]=o*(0.418341452333)*x_ref[0]**(o-1)+(0.430002851684)
        ref[5,1,1,1]=o*(0.624025385599)*x_ref[1]**(o-1)+(0.338601201629)
        ref[5,1,1,2]=o*(0.0900364406242)*x_ref[2]**(o-1)+(0.193533337073)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_Solution_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.828412007781)*x[0]**o+(0.392494008682)*x[0]+(0.424780018344)*x[1]**o+(-0.75790685259)*x[1]
        ref[0]=o*(0.828412007781)*x_ref[0]**(o-1)+(0.392494008682)
        ref[1]=o*(0.424780018344)*x_ref[1]**(o-1)+(-0.75790685259)
      else:
        arg=(0.0243949626425)*x[0]**o+(0.99040714323)*x[0]+(0.455478130443)*x[1]**o+(-0.917504050554)*x[1]+(-0.642882027126)*x[2]**o+(-0.0751962677977)*x[2]
        ref[0]=o*(0.0243949626425)*x_ref[0]**(o-1)+(0.99040714323)
        ref[1]=o*(0.455478130443)*x_ref[1]**(o-1)+(-0.917504050554)
        ref[2]=o*(-0.642882027126)*x_ref[2]**(o-1)+(-0.0751962677977)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_Solution_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(-0.107613645086)*x[0]**o+(-0.942156383662)*x[0]+(0.294425370324)*x[1]**o+(-0.177019031098)*x[1]
        arg[1]=(-0.120283674295)*x[0]**o+(-0.0644985036825)*x[0]+(-0.818412208612)*x[1]**o+(-0.375335380433)*x[1]
        ref[0,0]=o*(-0.107613645086)*x_ref[0]**(o-1)+(-0.942156383662)
        ref[0,1]=o*(0.294425370324)*x_ref[1]**(o-1)+(-0.177019031098)
        ref[1,0]=o*(-0.120283674295)*x_ref[0]**(o-1)+(-0.0644985036825)
        ref[1,1]=o*(-0.818412208612)*x_ref[1]**(o-1)+(-0.375335380433)
      else:
        arg[0]=(-0.888739890088)*x[0]**o+(0.874877363684)*x[0]+(-0.104101311962)*x[1]**o+(-0.124590333446)*x[1]+(-0.311645832684)*x[2]**o+(-0.249470325769)*x[2]
        arg[1]=(0.680288601947)*x[0]**o+(0.0595361804285)*x[0]+(-0.477099840976)*x[1]**o+(-0.695340106154)*x[1]+(-0.371044873416)*x[2]**o+(-0.442877128189)*x[2]
        ref[0,0]=o*(-0.888739890088)*x_ref[0]**(o-1)+(0.874877363684)
        ref[0,1]=o*(-0.104101311962)*x_ref[1]**(o-1)+(-0.124590333446)
        ref[0,2]=o*(-0.311645832684)*x_ref[2]**(o-1)+(-0.249470325769)
        ref[1,0]=o*(0.680288601947)*x_ref[0]**(o-1)+(0.0595361804285)
        ref[1,1]=o*(-0.477099840976)*x_ref[1]**(o-1)+(-0.695340106154)
        ref[1,2]=o*(-0.371044873416)*x_ref[2]**(o-1)+(-0.442877128189)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_Solution_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.0237486351119)*x[0]**o+(0.751375149587)*x[0]+(0.0776560601509)*x[1]**o+(-0.363340006998)*x[1]
        arg[0,1]=(0.129612138219)*x[0]**o+(0.377878821946)*x[0]+(0.166470268672)*x[1]**o+(-0.0442064974104)*x[1]
        arg[0,2]=(0.692350462477)*x[0]**o+(-0.439155965586)*x[0]+(0.655583353562)*x[1]**o+(0.3753639938)*x[1]
        arg[0,3]=(-0.909698820615)*x[0]**o+(0.382887632024)*x[0]+(-0.108821308794)*x[1]**o+(0.330111344773)*x[1]
        arg[0,4]=(-0.694552793316)*x[0]**o+(-0.38920298235)*x[0]+(0.174040833682)*x[1]**o+(-0.41756882346)*x[1]
        arg[1,0]=(-0.194901264915)*x[0]**o+(-0.325546767846)*x[0]+(0.507614203136)*x[1]**o+(-0.964255763976)*x[1]
        arg[1,1]=(-0.634480793567)*x[0]**o+(0.787029027123)*x[0]+(-0.067769912764)*x[1]**o+(0.439969554037)*x[1]
        arg[1,2]=(-0.59461925815)*x[0]**o+(-0.799215148911)*x[0]+(-0.286848861016)*x[1]**o+(-0.0274325066994)*x[1]
        arg[1,3]=(0.564664310607)*x[0]**o+(-0.00188717695265)*x[0]+(0.984042638249)*x[1]**o+(-0.524339915306)*x[1]
        arg[1,4]=(-0.673190201485)*x[0]**o+(0.149574403846)*x[0]+(0.667179612419)*x[1]**o+(-0.279377079395)*x[1]
        arg[2,0]=(0.270490028978)*x[0]**o+(0.498901404478)*x[0]+(0.485707956493)*x[1]**o+(-0.340861889384)*x[1]
        arg[2,1]=(-0.785952730285)*x[0]**o+(0.514446635701)*x[0]+(0.925557655147)*x[1]**o+(0.616971745561)*x[1]
        arg[2,2]=(0.788196502068)*x[0]**o+(0.651461860731)*x[0]+(0.160564742956)*x[1]**o+(-0.681831134057)*x[1]
        arg[2,3]=(0.892258488111)*x[0]**o+(0.752252063583)*x[0]+(0.853514779349)*x[1]**o+(-0.181884189513)*x[1]
        arg[2,4]=(-0.824886296933)*x[0]**o+(0.211931432354)*x[0]+(0.924362197939)*x[1]**o+(0.036482432278)*x[1]
        arg[3,0]=(-0.0616004277583)*x[0]**o+(-0.77338193907)*x[0]+(-0.966899521855)*x[1]**o+(-0.395764830291)*x[1]
        arg[3,1]=(-0.607976110595)*x[0]**o+(-0.448875768616)*x[0]+(-0.414034580078)*x[1]**o+(0.185483819416)*x[1]
        arg[3,2]=(-0.918071244524)*x[0]**o+(0.924225885038)*x[0]+(0.418000509852)*x[1]**o+(0.431330768344)*x[1]
        arg[3,3]=(0.897504318738)*x[0]**o+(0.66265738089)*x[0]+(0.720830604485)*x[1]**o+(-0.713433930025)*x[1]
        arg[3,4]=(0.526823069245)*x[0]**o+(-0.255965317744)*x[0]+(-0.326371546564)*x[1]**o+(-0.436881501009)*x[1]
        ref[0,0,0]=o*(0.0237486351119)*x_ref[0]**(o-1)+(0.751375149587)
        ref[0,0,1]=o*(0.0776560601509)*x_ref[1]**(o-1)+(-0.363340006998)
        ref[0,1,0]=o*(0.129612138219)*x_ref[0]**(o-1)+(0.377878821946)
        ref[0,1,1]=o*(0.166470268672)*x_ref[1]**(o-1)+(-0.0442064974104)
        ref[0,2,0]=o*(0.692350462477)*x_ref[0]**(o-1)+(-0.439155965586)
        ref[0,2,1]=o*(0.655583353562)*x_ref[1]**(o-1)+(0.3753639938)
        ref[0,3,0]=o*(-0.909698820615)*x_ref[0]**(o-1)+(0.382887632024)
        ref[0,3,1]=o*(-0.108821308794)*x_ref[1]**(o-1)+(0.330111344773)
        ref[0,4,0]=o*(-0.694552793316)*x_ref[0]**(o-1)+(-0.38920298235)
        ref[0,4,1]=o*(0.174040833682)*x_ref[1]**(o-1)+(-0.41756882346)
        ref[1,0,0]=o*(-0.194901264915)*x_ref[0]**(o-1)+(-0.325546767846)
        ref[1,0,1]=o*(0.507614203136)*x_ref[1]**(o-1)+(-0.964255763976)
        ref[1,1,0]=o*(-0.634480793567)*x_ref[0]**(o-1)+(0.787029027123)
        ref[1,1,1]=o*(-0.067769912764)*x_ref[1]**(o-1)+(0.439969554037)
        ref[1,2,0]=o*(-0.59461925815)*x_ref[0]**(o-1)+(-0.799215148911)
        ref[1,2,1]=o*(-0.286848861016)*x_ref[1]**(o-1)+(-0.0274325066994)
        ref[1,3,0]=o*(0.564664310607)*x_ref[0]**(o-1)+(-0.00188717695265)
        ref[1,3,1]=o*(0.984042638249)*x_ref[1]**(o-1)+(-0.524339915306)
        ref[1,4,0]=o*(-0.673190201485)*x_ref[0]**(o-1)+(0.149574403846)
        ref[1,4,1]=o*(0.667179612419)*x_ref[1]**(o-1)+(-0.279377079395)
        ref[2,0,0]=o*(0.270490028978)*x_ref[0]**(o-1)+(0.498901404478)
        ref[2,0,1]=o*(0.485707956493)*x_ref[1]**(o-1)+(-0.340861889384)
        ref[2,1,0]=o*(-0.785952730285)*x_ref[0]**(o-1)+(0.514446635701)
        ref[2,1,1]=o*(0.925557655147)*x_ref[1]**(o-1)+(0.616971745561)
        ref[2,2,0]=o*(0.788196502068)*x_ref[0]**(o-1)+(0.651461860731)
        ref[2,2,1]=o*(0.160564742956)*x_ref[1]**(o-1)+(-0.681831134057)
        ref[2,3,0]=o*(0.892258488111)*x_ref[0]**(o-1)+(0.752252063583)
        ref[2,3,1]=o*(0.853514779349)*x_ref[1]**(o-1)+(-0.181884189513)
        ref[2,4,0]=o*(-0.824886296933)*x_ref[0]**(o-1)+(0.211931432354)
        ref[2,4,1]=o*(0.924362197939)*x_ref[1]**(o-1)+(0.036482432278)
        ref[3,0,0]=o*(-0.0616004277583)*x_ref[0]**(o-1)+(-0.77338193907)
        ref[3,0,1]=o*(-0.966899521855)*x_ref[1]**(o-1)+(-0.395764830291)
        ref[3,1,0]=o*(-0.607976110595)*x_ref[0]**(o-1)+(-0.448875768616)
        ref[3,1,1]=o*(-0.414034580078)*x_ref[1]**(o-1)+(0.185483819416)
        ref[3,2,0]=o*(-0.918071244524)*x_ref[0]**(o-1)+(0.924225885038)
        ref[3,2,1]=o*(0.418000509852)*x_ref[1]**(o-1)+(0.431330768344)
        ref[3,3,0]=o*(0.897504318738)*x_ref[0]**(o-1)+(0.66265738089)
        ref[3,3,1]=o*(0.720830604485)*x_ref[1]**(o-1)+(-0.713433930025)
        ref[3,4,0]=o*(0.526823069245)*x_ref[0]**(o-1)+(-0.255965317744)
        ref[3,4,1]=o*(-0.326371546564)*x_ref[1]**(o-1)+(-0.436881501009)
      else:
        arg[0,0]=(-0.66471814098)*x[0]**o+(0.417241001417)*x[0]+(-0.228677853733)*x[1]**o+(-0.706946716128)*x[1]+(0.977168565988)*x[2]**o+(-0.0293128613918)*x[2]
        arg[0,1]=(-0.161577085067)*x[0]**o+(0.86957667281)*x[0]+(-0.246783815579)*x[1]**o+(0.495318651008)*x[1]+(-0.500962203485)*x[2]**o+(0.903521194042)*x[2]
        arg[0,2]=(0.0764824142976)*x[0]**o+(-0.0831710166954)*x[0]+(0.538063052387)*x[1]**o+(0.472451075914)*x[1]+(-0.354702552367)*x[2]**o+(-0.820126246007)*x[2]
        arg[0,3]=(-0.286219487301)*x[0]**o+(0.561959250696)*x[0]+(-0.65668352495)*x[1]**o+(-0.276560290133)*x[1]+(-0.500866980002)*x[2]**o+(0.71188245613)*x[2]
        arg[0,4]=(-0.13704169085)*x[0]**o+(0.107954139186)*x[0]+(0.498233399424)*x[1]**o+(-0.201539549426)*x[1]+(-0.889578977028)*x[2]**o+(0.33670078332)*x[2]
        arg[1,0]=(0.411075168668)*x[0]**o+(-0.982783292982)*x[0]+(0.919652087888)*x[1]**o+(0.657917523808)*x[1]+(-0.220747064163)*x[2]**o+(-0.65863499098)*x[2]
        arg[1,1]=(0.978122893048)*x[0]**o+(-0.638310308996)*x[0]+(-0.182955841813)*x[1]**o+(0.386322350256)*x[1]+(0.0238129376001)*x[2]**o+(0.415141411589)*x[2]
        arg[1,2]=(-0.410102590894)*x[0]**o+(-0.0527422034609)*x[0]+(0.218532590216)*x[1]**o+(0.338645963161)*x[1]+(-0.559262295901)*x[2]**o+(0.00154425206109)*x[2]
        arg[1,3]=(-0.509603507286)*x[0]**o+(0.220014659177)*x[0]+(-0.850244819031)*x[1]**o+(0.851103142912)*x[1]+(0.485740207202)*x[2]**o+(0.625073715619)*x[2]
        arg[1,4]=(-0.990056784415)*x[0]**o+(0.822920800823)*x[0]+(-0.310061384265)*x[1]**o+(-0.337394401914)*x[1]+(0.139776472055)*x[2]**o+(0.615477120599)*x[2]
        arg[2,0]=(0.434733128443)*x[0]**o+(-0.23992608444)*x[0]+(0.532847685888)*x[1]**o+(0.641963266518)*x[1]+(-0.421857805771)*x[2]**o+(0.385408885641)*x[2]
        arg[2,1]=(0.502146118236)*x[0]**o+(-0.476835388064)*x[0]+(-0.676891574566)*x[1]**o+(0.713401740075)*x[1]+(0.220183315534)*x[2]**o+(-0.863327755288)*x[2]
        arg[2,2]=(-0.694614904655)*x[0]**o+(-0.881664834998)*x[0]+(0.318605270866)*x[1]**o+(0.55884249433)*x[1]+(0.286031997395)*x[2]**o+(-0.947477517785)*x[2]
        arg[2,3]=(-0.046201338948)*x[0]**o+(-0.316456331808)*x[0]+(0.968975602807)*x[1]**o+(0.549024517551)*x[1]+(-0.473260734234)*x[2]**o+(0.889462696171)*x[2]
        arg[2,4]=(0.316754513953)*x[0]**o+(0.43553288512)*x[0]+(0.962932728727)*x[1]**o+(0.887900662435)*x[1]+(-0.235820939423)*x[2]**o+(0.947057541177)*x[2]
        arg[3,0]=(-0.835914763446)*x[0]**o+(-0.488811438785)*x[0]+(-0.573283060197)*x[1]**o+(0.963078263225)*x[1]+(0.601345307969)*x[2]**o+(-0.185658285596)*x[2]
        arg[3,1]=(0.597606596118)*x[0]**o+(0.0839878651552)*x[0]+(0.0836232765815)*x[1]**o+(0.594866612681)*x[1]+(-0.361174348867)*x[2]**o+(0.701364726038)*x[2]
        arg[3,2]=(-0.172328462662)*x[0]**o+(-0.856154059105)*x[0]+(0.533657669403)*x[1]**o+(-0.305657234912)*x[1]+(0.828787414246)*x[2]**o+(0.993286809537)*x[2]
        arg[3,3]=(0.181845363409)*x[0]**o+(0.184210025662)*x[0]+(-0.538269933964)*x[1]**o+(0.731384195858)*x[1]+(0.900272670238)*x[2]**o+(-0.152731605913)*x[2]
        arg[3,4]=(0.812640675362)*x[0]**o+(-0.330495179989)*x[0]+(0.455533774723)*x[1]**o+(0.32100819695)*x[1]+(-0.332730198093)*x[2]**o+(-0.692589097458)*x[2]
        ref[0,0,0]=o*(-0.66471814098)*x_ref[0]**(o-1)+(0.417241001417)
        ref[0,0,1]=o*(-0.228677853733)*x_ref[1]**(o-1)+(-0.706946716128)
        ref[0,0,2]=o*(0.977168565988)*x_ref[2]**(o-1)+(-0.0293128613918)
        ref[0,1,0]=o*(-0.161577085067)*x_ref[0]**(o-1)+(0.86957667281)
        ref[0,1,1]=o*(-0.246783815579)*x_ref[1]**(o-1)+(0.495318651008)
        ref[0,1,2]=o*(-0.500962203485)*x_ref[2]**(o-1)+(0.903521194042)
        ref[0,2,0]=o*(0.0764824142976)*x_ref[0]**(o-1)+(-0.0831710166954)
        ref[0,2,1]=o*(0.538063052387)*x_ref[1]**(o-1)+(0.472451075914)
        ref[0,2,2]=o*(-0.354702552367)*x_ref[2]**(o-1)+(-0.820126246007)
        ref[0,3,0]=o*(-0.286219487301)*x_ref[0]**(o-1)+(0.561959250696)
        ref[0,3,1]=o*(-0.65668352495)*x_ref[1]**(o-1)+(-0.276560290133)
        ref[0,3,2]=o*(-0.500866980002)*x_ref[2]**(o-1)+(0.71188245613)
        ref[0,4,0]=o*(-0.13704169085)*x_ref[0]**(o-1)+(0.107954139186)
        ref[0,4,1]=o*(0.498233399424)*x_ref[1]**(o-1)+(-0.201539549426)
        ref[0,4,2]=o*(-0.889578977028)*x_ref[2]**(o-1)+(0.33670078332)
        ref[1,0,0]=o*(0.411075168668)*x_ref[0]**(o-1)+(-0.982783292982)
        ref[1,0,1]=o*(0.919652087888)*x_ref[1]**(o-1)+(0.657917523808)
        ref[1,0,2]=o*(-0.220747064163)*x_ref[2]**(o-1)+(-0.65863499098)
        ref[1,1,0]=o*(0.978122893048)*x_ref[0]**(o-1)+(-0.638310308996)
        ref[1,1,1]=o*(-0.182955841813)*x_ref[1]**(o-1)+(0.386322350256)
        ref[1,1,2]=o*(0.0238129376001)*x_ref[2]**(o-1)+(0.415141411589)
        ref[1,2,0]=o*(-0.410102590894)*x_ref[0]**(o-1)+(-0.0527422034609)
        ref[1,2,1]=o*(0.218532590216)*x_ref[1]**(o-1)+(0.338645963161)
        ref[1,2,2]=o*(-0.559262295901)*x_ref[2]**(o-1)+(0.00154425206109)
        ref[1,3,0]=o*(-0.509603507286)*x_ref[0]**(o-1)+(0.220014659177)
        ref[1,3,1]=o*(-0.850244819031)*x_ref[1]**(o-1)+(0.851103142912)
        ref[1,3,2]=o*(0.485740207202)*x_ref[2]**(o-1)+(0.625073715619)
        ref[1,4,0]=o*(-0.990056784415)*x_ref[0]**(o-1)+(0.822920800823)
        ref[1,4,1]=o*(-0.310061384265)*x_ref[1]**(o-1)+(-0.337394401914)
        ref[1,4,2]=o*(0.139776472055)*x_ref[2]**(o-1)+(0.615477120599)
        ref[2,0,0]=o*(0.434733128443)*x_ref[0]**(o-1)+(-0.23992608444)
        ref[2,0,1]=o*(0.532847685888)*x_ref[1]**(o-1)+(0.641963266518)
        ref[2,0,2]=o*(-0.421857805771)*x_ref[2]**(o-1)+(0.385408885641)
        ref[2,1,0]=o*(0.502146118236)*x_ref[0]**(o-1)+(-0.476835388064)
        ref[2,1,1]=o*(-0.676891574566)*x_ref[1]**(o-1)+(0.713401740075)
        ref[2,1,2]=o*(0.220183315534)*x_ref[2]**(o-1)+(-0.863327755288)
        ref[2,2,0]=o*(-0.694614904655)*x_ref[0]**(o-1)+(-0.881664834998)
        ref[2,2,1]=o*(0.318605270866)*x_ref[1]**(o-1)+(0.55884249433)
        ref[2,2,2]=o*(0.286031997395)*x_ref[2]**(o-1)+(-0.947477517785)
        ref[2,3,0]=o*(-0.046201338948)*x_ref[0]**(o-1)+(-0.316456331808)
        ref[2,3,1]=o*(0.968975602807)*x_ref[1]**(o-1)+(0.549024517551)
        ref[2,3,2]=o*(-0.473260734234)*x_ref[2]**(o-1)+(0.889462696171)
        ref[2,4,0]=o*(0.316754513953)*x_ref[0]**(o-1)+(0.43553288512)
        ref[2,4,1]=o*(0.962932728727)*x_ref[1]**(o-1)+(0.887900662435)
        ref[2,4,2]=o*(-0.235820939423)*x_ref[2]**(o-1)+(0.947057541177)
        ref[3,0,0]=o*(-0.835914763446)*x_ref[0]**(o-1)+(-0.488811438785)
        ref[3,0,1]=o*(-0.573283060197)*x_ref[1]**(o-1)+(0.963078263225)
        ref[3,0,2]=o*(0.601345307969)*x_ref[2]**(o-1)+(-0.185658285596)
        ref[3,1,0]=o*(0.597606596118)*x_ref[0]**(o-1)+(0.0839878651552)
        ref[3,1,1]=o*(0.0836232765815)*x_ref[1]**(o-1)+(0.594866612681)
        ref[3,1,2]=o*(-0.361174348867)*x_ref[2]**(o-1)+(0.701364726038)
        ref[3,2,0]=o*(-0.172328462662)*x_ref[0]**(o-1)+(-0.856154059105)
        ref[3,2,1]=o*(0.533657669403)*x_ref[1]**(o-1)+(-0.305657234912)
        ref[3,2,2]=o*(0.828787414246)*x_ref[2]**(o-1)+(0.993286809537)
        ref[3,3,0]=o*(0.181845363409)*x_ref[0]**(o-1)+(0.184210025662)
        ref[3,3,1]=o*(-0.538269933964)*x_ref[1]**(o-1)+(0.731384195858)
        ref[3,3,2]=o*(0.900272670238)*x_ref[2]**(o-1)+(-0.152731605913)
        ref[3,4,0]=o*(0.812640675362)*x_ref[0]**(o-1)+(-0.330495179989)
        ref[3,4,1]=o*(0.455533774723)*x_ref[1]**(o-1)+(0.32100819695)
        ref[3,4,2]=o*(-0.332730198093)*x_ref[2]**(o-1)+(-0.692589097458)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_Solution_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.253396883727)*x[0]**o+(0.491235248599)*x[0]+(-0.468734602938)*x[1]**o+(0.730479725967)*x[1]
        arg[0,0,1]=(0.344036208598)*x[0]**o+(-0.394302857752)*x[0]+(-0.608765577652)*x[1]**o+(-0.564065946953)*x[1]
        arg[0,1,0]=(-0.84520693538)*x[0]**o+(0.934285247148)*x[0]+(0.0841237910789)*x[1]**o+(0.455488803423)*x[1]
        arg[0,1,1]=(0.484027534363)*x[0]**o+(-0.374633264234)*x[0]+(-0.0665482018417)*x[1]**o+(0.528984445833)*x[1]
        arg[1,0,0]=(-0.470188044426)*x[0]**o+(-0.328178128746)*x[0]+(0.67571857307)*x[1]**o+(0.116985630247)*x[1]
        arg[1,0,1]=(0.986586449605)*x[0]**o+(-0.25691197068)*x[0]+(0.755235660838)*x[1]**o+(0.211004338524)*x[1]
        arg[1,1,0]=(-0.569322712396)*x[0]**o+(0.900009729013)*x[0]+(0.748881276361)*x[1]**o+(0.850464087662)*x[1]
        arg[1,1,1]=(0.625042758036)*x[0]**o+(-0.72757111333)*x[0]+(-0.986053078492)*x[1]**o+(-0.633517003425)*x[1]
        arg[2,0,0]=(-0.716192724085)*x[0]**o+(-0.23327162426)*x[0]+(0.206440629344)*x[1]**o+(0.816324161671)*x[1]
        arg[2,0,1]=(-0.803679553386)*x[0]**o+(0.445433027195)*x[0]+(-0.111465589792)*x[1]**o+(-0.109772986088)*x[1]
        arg[2,1,0]=(0.374386571048)*x[0]**o+(-0.317187375606)*x[0]+(0.133248401591)*x[1]**o+(-0.971347533424)*x[1]
        arg[2,1,1]=(-0.48476474399)*x[0]**o+(0.979379654323)*x[0]+(0.371437992948)*x[1]**o+(-0.110228097225)*x[1]
        arg[3,0,0]=(0.37507701433)*x[0]**o+(0.451375135714)*x[0]+(0.228204578568)*x[1]**o+(0.0935454426192)*x[1]
        arg[3,0,1]=(-0.322375030256)*x[0]**o+(-0.0412650889525)*x[0]+(0.23495348361)*x[1]**o+(-0.704960519241)*x[1]
        arg[3,1,0]=(-0.478413043796)*x[0]**o+(0.373637701709)*x[0]+(0.346845166424)*x[1]**o+(0.00492075723836)*x[1]
        arg[3,1,1]=(0.0753795682919)*x[0]**o+(0.51446748543)*x[0]+(-0.337079735899)*x[1]**o+(0.976335320865)*x[1]
        arg[4,0,0]=(0.173293972121)*x[0]**o+(0.78972296986)*x[0]+(-0.518624390388)*x[1]**o+(-0.587962330417)*x[1]
        arg[4,0,1]=(0.747393467297)*x[0]**o+(0.940132823774)*x[0]+(-0.292996377712)*x[1]**o+(0.980334604245)*x[1]
        arg[4,1,0]=(-0.836497499117)*x[0]**o+(0.625161912911)*x[0]+(0.978929091652)*x[1]**o+(-0.676430396031)*x[1]
        arg[4,1,1]=(-0.195907406253)*x[0]**o+(-0.388427741642)*x[0]+(0.233500679929)*x[1]**o+(0.535047073421)*x[1]
        arg[5,0,0]=(0.983591245443)*x[0]**o+(-0.356589240979)*x[0]+(0.328974933764)*x[1]**o+(-0.875152262477)*x[1]
        arg[5,0,1]=(0.901430256705)*x[0]**o+(0.74247442514)*x[0]+(0.189211012786)*x[1]**o+(0.930520401277)*x[1]
        arg[5,1,0]=(-0.319591878243)*x[0]**o+(0.174836571432)*x[0]+(0.953875085784)*x[1]**o+(-0.51684941838)*x[1]
        arg[5,1,1]=(-0.916869714992)*x[0]**o+(0.121572609124)*x[0]+(0.791850838139)*x[1]**o+(-0.588663035087)*x[1]
        ref[0,0,0,0]=o*(0.253396883727)*x_ref[0]**(o-1)+(0.491235248599)
        ref[0,0,0,1]=o*(-0.468734602938)*x_ref[1]**(o-1)+(0.730479725967)
        ref[0,0,1,0]=o*(0.344036208598)*x_ref[0]**(o-1)+(-0.394302857752)
        ref[0,0,1,1]=o*(-0.608765577652)*x_ref[1]**(o-1)+(-0.564065946953)
        ref[0,1,0,0]=o*(-0.84520693538)*x_ref[0]**(o-1)+(0.934285247148)
        ref[0,1,0,1]=o*(0.0841237910789)*x_ref[1]**(o-1)+(0.455488803423)
        ref[0,1,1,0]=o*(0.484027534363)*x_ref[0]**(o-1)+(-0.374633264234)
        ref[0,1,1,1]=o*(-0.0665482018417)*x_ref[1]**(o-1)+(0.528984445833)
        ref[1,0,0,0]=o*(-0.470188044426)*x_ref[0]**(o-1)+(-0.328178128746)
        ref[1,0,0,1]=o*(0.67571857307)*x_ref[1]**(o-1)+(0.116985630247)
        ref[1,0,1,0]=o*(0.986586449605)*x_ref[0]**(o-1)+(-0.25691197068)
        ref[1,0,1,1]=o*(0.755235660838)*x_ref[1]**(o-1)+(0.211004338524)
        ref[1,1,0,0]=o*(-0.569322712396)*x_ref[0]**(o-1)+(0.900009729013)
        ref[1,1,0,1]=o*(0.748881276361)*x_ref[1]**(o-1)+(0.850464087662)
        ref[1,1,1,0]=o*(0.625042758036)*x_ref[0]**(o-1)+(-0.72757111333)
        ref[1,1,1,1]=o*(-0.986053078492)*x_ref[1]**(o-1)+(-0.633517003425)
        ref[2,0,0,0]=o*(-0.716192724085)*x_ref[0]**(o-1)+(-0.23327162426)
        ref[2,0,0,1]=o*(0.206440629344)*x_ref[1]**(o-1)+(0.816324161671)
        ref[2,0,1,0]=o*(-0.803679553386)*x_ref[0]**(o-1)+(0.445433027195)
        ref[2,0,1,1]=o*(-0.111465589792)*x_ref[1]**(o-1)+(-0.109772986088)
        ref[2,1,0,0]=o*(0.374386571048)*x_ref[0]**(o-1)+(-0.317187375606)
        ref[2,1,0,1]=o*(0.133248401591)*x_ref[1]**(o-1)+(-0.971347533424)
        ref[2,1,1,0]=o*(-0.48476474399)*x_ref[0]**(o-1)+(0.979379654323)
        ref[2,1,1,1]=o*(0.371437992948)*x_ref[1]**(o-1)+(-0.110228097225)
        ref[3,0,0,0]=o*(0.37507701433)*x_ref[0]**(o-1)+(0.451375135714)
        ref[3,0,0,1]=o*(0.228204578568)*x_ref[1]**(o-1)+(0.0935454426192)
        ref[3,0,1,0]=o*(-0.322375030256)*x_ref[0]**(o-1)+(-0.0412650889525)
        ref[3,0,1,1]=o*(0.23495348361)*x_ref[1]**(o-1)+(-0.704960519241)
        ref[3,1,0,0]=o*(-0.478413043796)*x_ref[0]**(o-1)+(0.373637701709)
        ref[3,1,0,1]=o*(0.346845166424)*x_ref[1]**(o-1)+(0.00492075723836)
        ref[3,1,1,0]=o*(0.0753795682919)*x_ref[0]**(o-1)+(0.51446748543)
        ref[3,1,1,1]=o*(-0.337079735899)*x_ref[1]**(o-1)+(0.976335320865)
        ref[4,0,0,0]=o*(0.173293972121)*x_ref[0]**(o-1)+(0.78972296986)
        ref[4,0,0,1]=o*(-0.518624390388)*x_ref[1]**(o-1)+(-0.587962330417)
        ref[4,0,1,0]=o*(0.747393467297)*x_ref[0]**(o-1)+(0.940132823774)
        ref[4,0,1,1]=o*(-0.292996377712)*x_ref[1]**(o-1)+(0.980334604245)
        ref[4,1,0,0]=o*(-0.836497499117)*x_ref[0]**(o-1)+(0.625161912911)
        ref[4,1,0,1]=o*(0.978929091652)*x_ref[1]**(o-1)+(-0.676430396031)
        ref[4,1,1,0]=o*(-0.195907406253)*x_ref[0]**(o-1)+(-0.388427741642)
        ref[4,1,1,1]=o*(0.233500679929)*x_ref[1]**(o-1)+(0.535047073421)
        ref[5,0,0,0]=o*(0.983591245443)*x_ref[0]**(o-1)+(-0.356589240979)
        ref[5,0,0,1]=o*(0.328974933764)*x_ref[1]**(o-1)+(-0.875152262477)
        ref[5,0,1,0]=o*(0.901430256705)*x_ref[0]**(o-1)+(0.74247442514)
        ref[5,0,1,1]=o*(0.189211012786)*x_ref[1]**(o-1)+(0.930520401277)
        ref[5,1,0,0]=o*(-0.319591878243)*x_ref[0]**(o-1)+(0.174836571432)
        ref[5,1,0,1]=o*(0.953875085784)*x_ref[1]**(o-1)+(-0.51684941838)
        ref[5,1,1,0]=o*(-0.916869714992)*x_ref[0]**(o-1)+(0.121572609124)
        ref[5,1,1,1]=o*(0.791850838139)*x_ref[1]**(o-1)+(-0.588663035087)
      else:
        arg[0,0,0]=(-0.513971266383)*x[0]**o+(-0.117127749421)*x[0]+(-0.551292004692)*x[1]**o+(-0.268920693702)*x[1]+(0.0872538366694)*x[2]**o+(0.855491592762)*x[2]
        arg[0,0,1]=(0.156425207213)*x[0]**o+(-0.299808724719)*x[0]+(0.827383156334)*x[1]**o+(-0.594506082498)*x[1]+(-0.289589281068)*x[2]**o+(0.559159349352)*x[2]
        arg[0,1,0]=(-0.925822763448)*x[0]**o+(0.518052108584)*x[0]+(-0.774761536373)*x[1]**o+(-0.0329613155479)*x[1]+(0.957805160206)*x[2]**o+(0.0606445544683)*x[2]
        arg[0,1,1]=(-0.337663244379)*x[0]**o+(-0.634947360886)*x[0]+(0.232117517887)*x[1]**o+(-0.534317817241)*x[1]+(0.554880796818)*x[2]**o+(-0.3101266685)*x[2]
        arg[1,0,0]=(-0.888548906608)*x[0]**o+(0.517747675888)*x[0]+(-0.614381113253)*x[1]**o+(-0.757891891198)*x[1]+(0.618261909378)*x[2]**o+(-0.0853347346644)*x[2]
        arg[1,0,1]=(-0.686920109418)*x[0]**o+(0.000673193523604)*x[0]+(0.251800447271)*x[1]**o+(-0.105619412646)*x[1]+(0.00990847148242)*x[2]**o+(0.861798595402)*x[2]
        arg[1,1,0]=(0.170484209485)*x[0]**o+(-0.620257643847)*x[0]+(0.057743430303)*x[1]**o+(0.0640298192279)*x[1]+(0.0757100493935)*x[2]**o+(-0.414863410391)*x[2]
        arg[1,1,1]=(-0.714807290039)*x[0]**o+(-0.562420622765)*x[0]+(0.788769732877)*x[1]**o+(-0.472413621829)*x[1]+(-0.466159435785)*x[2]**o+(-0.476510555737)*x[2]
        arg[2,0,0]=(0.875340499144)*x[0]**o+(-0.598283854175)*x[0]+(0.206593884126)*x[1]**o+(-0.987568956833)*x[1]+(0.666527095968)*x[2]**o+(-0.352753155564)*x[2]
        arg[2,0,1]=(0.677005187408)*x[0]**o+(0.760176905882)*x[0]+(-0.0863648949101)*x[1]**o+(-0.607384058071)*x[1]+(-0.117434466077)*x[2]**o+(-0.670292588633)*x[2]
        arg[2,1,0]=(0.888629811684)*x[0]**o+(0.35826389662)*x[0]+(0.00390435387028)*x[1]**o+(-0.0937518531166)*x[1]+(-0.365569888759)*x[2]**o+(0.380035526283)*x[2]
        arg[2,1,1]=(0.138275666033)*x[0]**o+(-0.437710809963)*x[0]+(0.773451227027)*x[1]**o+(0.834016138485)*x[1]+(0.847339165612)*x[2]**o+(-0.417687340903)*x[2]
        arg[3,0,0]=(-0.298714836243)*x[0]**o+(-0.268961434956)*x[0]+(0.232096942083)*x[1]**o+(-0.455570990604)*x[1]+(-0.294542554349)*x[2]**o+(-0.37112817156)*x[2]
        arg[3,0,1]=(0.0903365333358)*x[0]**o+(0.338265717129)*x[0]+(-0.755237281599)*x[1]**o+(-0.608535543682)*x[1]+(0.812136572153)*x[2]**o+(-0.146674314466)*x[2]
        arg[3,1,0]=(0.159422014459)*x[0]**o+(0.899761817668)*x[0]+(0.467507279621)*x[1]**o+(0.47028740641)*x[1]+(-0.905453092566)*x[2]**o+(0.325443171334)*x[2]
        arg[3,1,1]=(0.706113787474)*x[0]**o+(0.411358047385)*x[0]+(0.710178001185)*x[1]**o+(-0.248170072927)*x[1]+(0.2228478152)*x[2]**o+(-0.6845238748)*x[2]
        arg[4,0,0]=(-0.810987300482)*x[0]**o+(-0.20061683347)*x[0]+(-0.362480203096)*x[1]**o+(0.23493442788)*x[1]+(-0.0262576869803)*x[2]**o+(0.40114062378)*x[2]
        arg[4,0,1]=(-0.0377982138529)*x[0]**o+(-0.844585963856)*x[0]+(-0.94360590097)*x[1]**o+(-0.775666510211)*x[1]+(-0.484314539768)*x[2]**o+(0.472661289406)*x[2]
        arg[4,1,0]=(0.579937359489)*x[0]**o+(0.384020744083)*x[0]+(-0.303096661906)*x[1]**o+(-0.0640353004314)*x[1]+(0.693425296881)*x[2]**o+(0.410980796125)*x[2]
        arg[4,1,1]=(0.152139667717)*x[0]**o+(-0.49610371397)*x[0]+(-0.884008900347)*x[1]**o+(-0.364570486388)*x[1]+(0.126918854811)*x[2]**o+(0.409453971802)*x[2]
        arg[5,0,0]=(0.409834559571)*x[0]**o+(-0.347724104753)*x[0]+(-0.263327417846)*x[1]**o+(0.18147743546)*x[1]+(-0.399848371177)*x[2]**o+(0.928317631431)*x[2]
        arg[5,0,1]=(-0.686702422025)*x[0]**o+(-0.918530462662)*x[0]+(0.478936304167)*x[1]**o+(-0.641691106861)*x[1]+(-0.582780732375)*x[2]**o+(0.30255037752)*x[2]
        arg[5,1,0]=(0.50568688101)*x[0]**o+(0.378682510558)*x[0]+(0.59801824354)*x[1]**o+(-0.316028163905)*x[1]+(-0.554966057648)*x[2]**o+(0.637313154931)*x[2]
        arg[5,1,1]=(0.300318472719)*x[0]**o+(-0.794010312167)*x[0]+(-0.314402790698)*x[1]**o+(0.991870648498)*x[1]+(0.949603731589)*x[2]**o+(-0.302054056398)*x[2]
        ref[0,0,0,0]=o*(-0.513971266383)*x_ref[0]**(o-1)+(-0.117127749421)
        ref[0,0,0,1]=o*(-0.551292004692)*x_ref[1]**(o-1)+(-0.268920693702)
        ref[0,0,0,2]=o*(0.0872538366694)*x_ref[2]**(o-1)+(0.855491592762)
        ref[0,0,1,0]=o*(0.156425207213)*x_ref[0]**(o-1)+(-0.299808724719)
        ref[0,0,1,1]=o*(0.827383156334)*x_ref[1]**(o-1)+(-0.594506082498)
        ref[0,0,1,2]=o*(-0.289589281068)*x_ref[2]**(o-1)+(0.559159349352)
        ref[0,1,0,0]=o*(-0.925822763448)*x_ref[0]**(o-1)+(0.518052108584)
        ref[0,1,0,1]=o*(-0.774761536373)*x_ref[1]**(o-1)+(-0.0329613155479)
        ref[0,1,0,2]=o*(0.957805160206)*x_ref[2]**(o-1)+(0.0606445544683)
        ref[0,1,1,0]=o*(-0.337663244379)*x_ref[0]**(o-1)+(-0.634947360886)
        ref[0,1,1,1]=o*(0.232117517887)*x_ref[1]**(o-1)+(-0.534317817241)
        ref[0,1,1,2]=o*(0.554880796818)*x_ref[2]**(o-1)+(-0.3101266685)
        ref[1,0,0,0]=o*(-0.888548906608)*x_ref[0]**(o-1)+(0.517747675888)
        ref[1,0,0,1]=o*(-0.614381113253)*x_ref[1]**(o-1)+(-0.757891891198)
        ref[1,0,0,2]=o*(0.618261909378)*x_ref[2]**(o-1)+(-0.0853347346644)
        ref[1,0,1,0]=o*(-0.686920109418)*x_ref[0]**(o-1)+(0.000673193523604)
        ref[1,0,1,1]=o*(0.251800447271)*x_ref[1]**(o-1)+(-0.105619412646)
        ref[1,0,1,2]=o*(0.00990847148242)*x_ref[2]**(o-1)+(0.861798595402)
        ref[1,1,0,0]=o*(0.170484209485)*x_ref[0]**(o-1)+(-0.620257643847)
        ref[1,1,0,1]=o*(0.057743430303)*x_ref[1]**(o-1)+(0.0640298192279)
        ref[1,1,0,2]=o*(0.0757100493935)*x_ref[2]**(o-1)+(-0.414863410391)
        ref[1,1,1,0]=o*(-0.714807290039)*x_ref[0]**(o-1)+(-0.562420622765)
        ref[1,1,1,1]=o*(0.788769732877)*x_ref[1]**(o-1)+(-0.472413621829)
        ref[1,1,1,2]=o*(-0.466159435785)*x_ref[2]**(o-1)+(-0.476510555737)
        ref[2,0,0,0]=o*(0.875340499144)*x_ref[0]**(o-1)+(-0.598283854175)
        ref[2,0,0,1]=o*(0.206593884126)*x_ref[1]**(o-1)+(-0.987568956833)
        ref[2,0,0,2]=o*(0.666527095968)*x_ref[2]**(o-1)+(-0.352753155564)
        ref[2,0,1,0]=o*(0.677005187408)*x_ref[0]**(o-1)+(0.760176905882)
        ref[2,0,1,1]=o*(-0.0863648949101)*x_ref[1]**(o-1)+(-0.607384058071)
        ref[2,0,1,2]=o*(-0.117434466077)*x_ref[2]**(o-1)+(-0.670292588633)
        ref[2,1,0,0]=o*(0.888629811684)*x_ref[0]**(o-1)+(0.35826389662)
        ref[2,1,0,1]=o*(0.00390435387028)*x_ref[1]**(o-1)+(-0.0937518531166)
        ref[2,1,0,2]=o*(-0.365569888759)*x_ref[2]**(o-1)+(0.380035526283)
        ref[2,1,1,0]=o*(0.138275666033)*x_ref[0]**(o-1)+(-0.437710809963)
        ref[2,1,1,1]=o*(0.773451227027)*x_ref[1]**(o-1)+(0.834016138485)
        ref[2,1,1,2]=o*(0.847339165612)*x_ref[2]**(o-1)+(-0.417687340903)
        ref[3,0,0,0]=o*(-0.298714836243)*x_ref[0]**(o-1)+(-0.268961434956)
        ref[3,0,0,1]=o*(0.232096942083)*x_ref[1]**(o-1)+(-0.455570990604)
        ref[3,0,0,2]=o*(-0.294542554349)*x_ref[2]**(o-1)+(-0.37112817156)
        ref[3,0,1,0]=o*(0.0903365333358)*x_ref[0]**(o-1)+(0.338265717129)
        ref[3,0,1,1]=o*(-0.755237281599)*x_ref[1]**(o-1)+(-0.608535543682)
        ref[3,0,1,2]=o*(0.812136572153)*x_ref[2]**(o-1)+(-0.146674314466)
        ref[3,1,0,0]=o*(0.159422014459)*x_ref[0]**(o-1)+(0.899761817668)
        ref[3,1,0,1]=o*(0.467507279621)*x_ref[1]**(o-1)+(0.47028740641)
        ref[3,1,0,2]=o*(-0.905453092566)*x_ref[2]**(o-1)+(0.325443171334)
        ref[3,1,1,0]=o*(0.706113787474)*x_ref[0]**(o-1)+(0.411358047385)
        ref[3,1,1,1]=o*(0.710178001185)*x_ref[1]**(o-1)+(-0.248170072927)
        ref[3,1,1,2]=o*(0.2228478152)*x_ref[2]**(o-1)+(-0.6845238748)
        ref[4,0,0,0]=o*(-0.810987300482)*x_ref[0]**(o-1)+(-0.20061683347)
        ref[4,0,0,1]=o*(-0.362480203096)*x_ref[1]**(o-1)+(0.23493442788)
        ref[4,0,0,2]=o*(-0.0262576869803)*x_ref[2]**(o-1)+(0.40114062378)
        ref[4,0,1,0]=o*(-0.0377982138529)*x_ref[0]**(o-1)+(-0.844585963856)
        ref[4,0,1,1]=o*(-0.94360590097)*x_ref[1]**(o-1)+(-0.775666510211)
        ref[4,0,1,2]=o*(-0.484314539768)*x_ref[2]**(o-1)+(0.472661289406)
        ref[4,1,0,0]=o*(0.579937359489)*x_ref[0]**(o-1)+(0.384020744083)
        ref[4,1,0,1]=o*(-0.303096661906)*x_ref[1]**(o-1)+(-0.0640353004314)
        ref[4,1,0,2]=o*(0.693425296881)*x_ref[2]**(o-1)+(0.410980796125)
        ref[4,1,1,0]=o*(0.152139667717)*x_ref[0]**(o-1)+(-0.49610371397)
        ref[4,1,1,1]=o*(-0.884008900347)*x_ref[1]**(o-1)+(-0.364570486388)
        ref[4,1,1,2]=o*(0.126918854811)*x_ref[2]**(o-1)+(0.409453971802)
        ref[5,0,0,0]=o*(0.409834559571)*x_ref[0]**(o-1)+(-0.347724104753)
        ref[5,0,0,1]=o*(-0.263327417846)*x_ref[1]**(o-1)+(0.18147743546)
        ref[5,0,0,2]=o*(-0.399848371177)*x_ref[2]**(o-1)+(0.928317631431)
        ref[5,0,1,0]=o*(-0.686702422025)*x_ref[0]**(o-1)+(-0.918530462662)
        ref[5,0,1,1]=o*(0.478936304167)*x_ref[1]**(o-1)+(-0.641691106861)
        ref[5,0,1,2]=o*(-0.582780732375)*x_ref[2]**(o-1)+(0.30255037752)
        ref[5,1,0,0]=o*(0.50568688101)*x_ref[0]**(o-1)+(0.378682510558)
        ref[5,1,0,1]=o*(0.59801824354)*x_ref[1]**(o-1)+(-0.316028163905)
        ref[5,1,0,2]=o*(-0.554966057648)*x_ref[2]**(o-1)+(0.637313154931)
        ref[5,1,1,0]=o*(0.300318472719)*x_ref[0]**(o-1)+(-0.794010312167)
        ref[5,1,1,1]=o*(-0.314402790698)*x_ref[1]**(o-1)+(0.991870648498)
        ref[5,1,1,2]=o*(0.949603731589)*x_ref[2]**(o-1)+(-0.302054056398)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.306947418999)*x[0]+(-0.706616694784)*x[1]
        ref[0]=(0.306947418999)
        ref[1]=(-0.706616694784)
      else:
        arg=(0.490435692707)*x[0]+(0.929248719763)*x[1]+(0.269868131113)*x[2]
        ref[0]=(0.490435692707)
        ref[1]=(0.929248719763)
        ref[2]=(0.269868131113)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(-0.882633673888)*x[0]+(-0.790592442848)*x[1]
        arg[1]=(1.55495669126)*x[0]+(0.496011926182)*x[1]
        ref[0,0]=(-0.882633673888)
        ref[0,1]=(-0.790592442848)
        ref[1,0]=(1.55495669126)
        ref[1,1]=(0.496011926182)
      else:
        arg[0]=(0.683098278161)*x[0]+(-0.151590511238)*x[1]+(0.54461031868)*x[2]
        arg[1]=(0.59998040214)*x[0]+(-0.995466442084)*x[1]+(-1.09468062911)*x[2]
        ref[0,0]=(0.683098278161)
        ref[0,1]=(-0.151590511238)
        ref[0,2]=(0.54461031868)
        ref[1,0]=(0.59998040214)
        ref[1,1]=(-0.995466442084)
        ref[1,2]=(-1.09468062911)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(-0.159129528541)*x[0]+(0.107835972384)*x[1]
        arg[0,1]=(-1.52388770934)*x[0]+(0.262089610596)*x[1]
        arg[0,2]=(0.505454501555)*x[0]+(-0.247061440744)*x[1]
        arg[0,3]=(-0.556075420202)*x[0]+(0.702144110506)*x[1]
        arg[0,4]=(0.810518335626)*x[0]+(-0.76077949525)*x[1]
        arg[1,0]=(-0.491052732808)*x[0]+(-0.272913467279)*x[1]
        arg[1,1]=(0.0141908236388)*x[0]+(1.10868804645)*x[1]
        arg[1,2]=(0.719028425382)*x[0]+(-0.544780305018)*x[1]
        arg[1,3]=(-1.15474920716)*x[0]+(0.888461325396)*x[1]
        arg[1,4]=(-0.842901893766)*x[0]+(-0.465916012282)*x[1]
        arg[2,0]=(1.24606386746)*x[0]+(0.817235825831)*x[1]
        arg[2,1]=(0.400861923494)*x[0]+(1.24545704982)*x[1]
        arg[2,2]=(0.656546253691)*x[0]+(-0.0269228973404)*x[1]
        arg[2,3]=(-0.590512343874)*x[0]+(-0.0654952556025)*x[1]
        arg[2,4]=(0.806342618281)*x[0]+(-0.183166204195)*x[1]
        arg[3,0]=(0.637045776935)*x[0]+(-0.512820906995)*x[1]
        arg[3,1]=(-0.596216711833)*x[0]+(-0.221853749777)*x[1]
        arg[3,2]=(0.113235739927)*x[0]+(-0.210641618992)*x[1]
        arg[3,3]=(-1.11423980423)*x[0]+(-1.46748285012)*x[1]
        arg[3,4]=(0.573260999643)*x[0]+(0.55016627172)*x[1]
        ref[0,0,0]=(-0.159129528541)
        ref[0,0,1]=(0.107835972384)
        ref[0,1,0]=(-1.52388770934)
        ref[0,1,1]=(0.262089610596)
        ref[0,2,0]=(0.505454501555)
        ref[0,2,1]=(-0.247061440744)
        ref[0,3,0]=(-0.556075420202)
        ref[0,3,1]=(0.702144110506)
        ref[0,4,0]=(0.810518335626)
        ref[0,4,1]=(-0.76077949525)
        ref[1,0,0]=(-0.491052732808)
        ref[1,0,1]=(-0.272913467279)
        ref[1,1,0]=(0.0141908236388)
        ref[1,1,1]=(1.10868804645)
        ref[1,2,0]=(0.719028425382)
        ref[1,2,1]=(-0.544780305018)
        ref[1,3,0]=(-1.15474920716)
        ref[1,3,1]=(0.888461325396)
        ref[1,4,0]=(-0.842901893766)
        ref[1,4,1]=(-0.465916012282)
        ref[2,0,0]=(1.24606386746)
        ref[2,0,1]=(0.817235825831)
        ref[2,1,0]=(0.400861923494)
        ref[2,1,1]=(1.24545704982)
        ref[2,2,0]=(0.656546253691)
        ref[2,2,1]=(-0.0269228973404)
        ref[2,3,0]=(-0.590512343874)
        ref[2,3,1]=(-0.0654952556025)
        ref[2,4,0]=(0.806342618281)
        ref[2,4,1]=(-0.183166204195)
        ref[3,0,0]=(0.637045776935)
        ref[3,0,1]=(-0.512820906995)
        ref[3,1,0]=(-0.596216711833)
        ref[3,1,1]=(-0.221853749777)
        ref[3,2,0]=(0.113235739927)
        ref[3,2,1]=(-0.210641618992)
        ref[3,3,0]=(-1.11423980423)
        ref[3,3,1]=(-1.46748285012)
        ref[3,4,0]=(0.573260999643)
        ref[3,4,1]=(0.55016627172)
      else:
        arg[0,0]=(-0.025505130975)*x[0]+(-0.128352022583)*x[1]+(-0.0645809876948)*x[2]
        arg[0,1]=(-0.974556985555)*x[0]+(0.503751568036)*x[1]+(-0.524784840232)*x[2]
        arg[0,2]=(-1.23653778531)*x[0]+(-0.73883453445)*x[1]+(-1.59259101746)*x[2]
        arg[0,3]=(-0.543656268618)*x[0]+(0.110486603472)*x[1]+(-0.636246757745)*x[2]
        arg[0,4]=(-0.566088225133)*x[0]+(-0.272577812471)*x[1]+(-0.282075405014)*x[2]
        arg[1,0]=(-0.28252305722)*x[0]+(0.497103425073)*x[1]+(0.997942367464)*x[2]
        arg[1,1]=(-0.444059543356)*x[0]+(-0.149004039444)*x[1]+(-0.871853047384)*x[2]
        arg[1,2]=(-0.610830496789)*x[0]+(0.196494475826)*x[1]+(0.0123852343883)*x[2]
        arg[1,3]=(-0.327903465165)*x[0]+(0.523560519595)*x[1]+(-0.409961704581)*x[2]
        arg[1,4]=(0.633897214746)*x[0]+(-0.9032002551)*x[1]+(0.624042996391)*x[2]
        arg[2,0]=(0.469489049636)*x[0]+(1.46158418286)*x[1]+(-0.538453674545)*x[2]
        arg[2,1]=(0.0488906165423)*x[0]+(0.483867458959)*x[1]+(0.0419643463366)*x[2]
        arg[2,2]=(-1.89716754038)*x[0]+(-0.577554008519)*x[1]+(-0.0328835832126)*x[2]
        arg[2,3]=(0.507329501469)*x[0]+(0.354939444351)*x[1]+(0.0136766029313)*x[2]
        arg[2,4]=(-0.313182267444)*x[0]+(-1.08684309178)*x[1]+(-1.39365968958)*x[2]
        arg[3,0]=(0.272322829309)*x[0]+(-0.233645276231)*x[1]+(0.491500838791)*x[2]
        arg[3,1]=(1.27603407856)*x[0]+(-0.709429989875)*x[1]+(-0.998371438244)*x[2]
        arg[3,2]=(0.637972716248)*x[0]+(-1.37896009762)*x[1]+(0.496830616786)*x[2]
        arg[3,3]=(-1.67735443481)*x[0]+(-0.741884420811)*x[1]+(1.23125805904)*x[2]
        arg[3,4]=(-0.593290763881)*x[0]+(-0.881909104701)*x[1]+(-1.0425499934)*x[2]
        ref[0,0,0]=(-0.025505130975)
        ref[0,0,1]=(-0.128352022583)
        ref[0,0,2]=(-0.0645809876948)
        ref[0,1,0]=(-0.974556985555)
        ref[0,1,1]=(0.503751568036)
        ref[0,1,2]=(-0.524784840232)
        ref[0,2,0]=(-1.23653778531)
        ref[0,2,1]=(-0.73883453445)
        ref[0,2,2]=(-1.59259101746)
        ref[0,3,0]=(-0.543656268618)
        ref[0,3,1]=(0.110486603472)
        ref[0,3,2]=(-0.636246757745)
        ref[0,4,0]=(-0.566088225133)
        ref[0,4,1]=(-0.272577812471)
        ref[0,4,2]=(-0.282075405014)
        ref[1,0,0]=(-0.28252305722)
        ref[1,0,1]=(0.497103425073)
        ref[1,0,2]=(0.997942367464)
        ref[1,1,0]=(-0.444059543356)
        ref[1,1,1]=(-0.149004039444)
        ref[1,1,2]=(-0.871853047384)
        ref[1,2,0]=(-0.610830496789)
        ref[1,2,1]=(0.196494475826)
        ref[1,2,2]=(0.0123852343883)
        ref[1,3,0]=(-0.327903465165)
        ref[1,3,1]=(0.523560519595)
        ref[1,3,2]=(-0.409961704581)
        ref[1,4,0]=(0.633897214746)
        ref[1,4,1]=(-0.9032002551)
        ref[1,4,2]=(0.624042996391)
        ref[2,0,0]=(0.469489049636)
        ref[2,0,1]=(1.46158418286)
        ref[2,0,2]=(-0.538453674545)
        ref[2,1,0]=(0.0488906165423)
        ref[2,1,1]=(0.483867458959)
        ref[2,1,2]=(0.0419643463366)
        ref[2,2,0]=(-1.89716754038)
        ref[2,2,1]=(-0.577554008519)
        ref[2,2,2]=(-0.0328835832126)
        ref[2,3,0]=(0.507329501469)
        ref[2,3,1]=(0.354939444351)
        ref[2,3,2]=(0.0136766029313)
        ref[2,4,0]=(-0.313182267444)
        ref[2,4,1]=(-1.08684309178)
        ref[2,4,2]=(-1.39365968958)
        ref[3,0,0]=(0.272322829309)
        ref[3,0,1]=(-0.233645276231)
        ref[3,0,2]=(0.491500838791)
        ref[3,1,0]=(1.27603407856)
        ref[3,1,1]=(-0.709429989875)
        ref[3,1,2]=(-0.998371438244)
        ref[3,2,0]=(0.637972716248)
        ref[3,2,1]=(-1.37896009762)
        ref[3,2,2]=(0.496830616786)
        ref[3,3,0]=(-1.67735443481)
        ref[3,3,1]=(-0.741884420811)
        ref[3,3,2]=(1.23125805904)
        ref[3,4,0]=(-0.593290763881)
        ref[3,4,1]=(-0.881909104701)
        ref[3,4,2]=(-1.0425499934)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromData_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.289868084377)*x[0]+(-1.636093365)*x[1]
        arg[0,0,1]=(0.841764493453)*x[0]+(-0.397262590373)*x[1]
        arg[0,1,0]=(0.318610649633)*x[0]+(1.59837795884)*x[1]
        arg[0,1,1]=(1.41408600658)*x[0]+(0.212012530707)*x[1]
        arg[1,0,0]=(-1.13663878903)*x[0]+(-0.535752609596)*x[1]
        arg[1,0,1]=(-0.795140440626)*x[0]+(-0.733456054749)*x[1]
        arg[1,1,0]=(-0.174874940569)*x[0]+(0.304037654801)*x[1]
        arg[1,1,1]=(0.835374268658)*x[0]+(0.645365790264)*x[1]
        arg[2,0,0]=(0.684064169293)*x[0]+(-0.580502209076)*x[1]
        arg[2,0,1]=(0.342542841673)*x[0]+(-0.620912562797)*x[1]
        arg[2,1,0]=(-0.457226288553)*x[0]+(-0.163180645461)*x[1]
        arg[2,1,1]=(-0.494067356015)*x[0]+(-0.604667785982)*x[1]
        arg[3,0,0]=(-0.224173319974)*x[0]+(-0.288566962407)*x[1]
        arg[3,0,1]=(-0.83578982053)*x[0]+(0.290663773612)*x[1]
        arg[3,1,0]=(0.700494058094)*x[0]+(0.244036699451)*x[1]
        arg[3,1,1]=(0.960756120912)*x[0]+(-0.129549309953)*x[1]
        arg[4,0,0]=(0.942292060296)*x[0]+(-0.148922577041)*x[1]
        arg[4,0,1]=(-0.363876552144)*x[0]+(0.903847614766)*x[1]
        arg[4,1,0]=(-1.91719369833)*x[0]+(0.961392595186)*x[1]
        arg[4,1,1]=(-0.141662097711)*x[0]+(-0.695061685931)*x[1]
        arg[5,0,0]=(0.416693171023)*x[0]+(1.04455773845)*x[1]
        arg[5,0,1]=(0.325327980312)*x[0]+(-1.01452792883)*x[1]
        arg[5,1,0]=(-1.43970903355)*x[0]+(-1.04382682561)*x[1]
        arg[5,1,1]=(-0.969700314248)*x[0]+(-0.286024748854)*x[1]
        ref[0,0,0,0]=(0.289868084377)
        ref[0,0,0,1]=(-1.636093365)
        ref[0,0,1,0]=(0.841764493453)
        ref[0,0,1,1]=(-0.397262590373)
        ref[0,1,0,0]=(0.318610649633)
        ref[0,1,0,1]=(1.59837795884)
        ref[0,1,1,0]=(1.41408600658)
        ref[0,1,1,1]=(0.212012530707)
        ref[1,0,0,0]=(-1.13663878903)
        ref[1,0,0,1]=(-0.535752609596)
        ref[1,0,1,0]=(-0.795140440626)
        ref[1,0,1,1]=(-0.733456054749)
        ref[1,1,0,0]=(-0.174874940569)
        ref[1,1,0,1]=(0.304037654801)
        ref[1,1,1,0]=(0.835374268658)
        ref[1,1,1,1]=(0.645365790264)
        ref[2,0,0,0]=(0.684064169293)
        ref[2,0,0,1]=(-0.580502209076)
        ref[2,0,1,0]=(0.342542841673)
        ref[2,0,1,1]=(-0.620912562797)
        ref[2,1,0,0]=(-0.457226288553)
        ref[2,1,0,1]=(-0.163180645461)
        ref[2,1,1,0]=(-0.494067356015)
        ref[2,1,1,1]=(-0.604667785982)
        ref[3,0,0,0]=(-0.224173319974)
        ref[3,0,0,1]=(-0.288566962407)
        ref[3,0,1,0]=(-0.83578982053)
        ref[3,0,1,1]=(0.290663773612)
        ref[3,1,0,0]=(0.700494058094)
        ref[3,1,0,1]=(0.244036699451)
        ref[3,1,1,0]=(0.960756120912)
        ref[3,1,1,1]=(-0.129549309953)
        ref[4,0,0,0]=(0.942292060296)
        ref[4,0,0,1]=(-0.148922577041)
        ref[4,0,1,0]=(-0.363876552144)
        ref[4,0,1,1]=(0.903847614766)
        ref[4,1,0,0]=(-1.91719369833)
        ref[4,1,0,1]=(0.961392595186)
        ref[4,1,1,0]=(-0.141662097711)
        ref[4,1,1,1]=(-0.695061685931)
        ref[5,0,0,0]=(0.416693171023)
        ref[5,0,0,1]=(1.04455773845)
        ref[5,0,1,0]=(0.325327980312)
        ref[5,0,1,1]=(-1.01452792883)
        ref[5,1,0,0]=(-1.43970903355)
        ref[5,1,0,1]=(-1.04382682561)
        ref[5,1,1,0]=(-0.969700314248)
        ref[5,1,1,1]=(-0.286024748854)
      else:
        arg[0,0,0]=(-1.52443210214)*x[0]+(-1.48020118993)*x[1]+(1.2552138343)*x[2]
        arg[0,0,1]=(-0.102900544448)*x[0]+(-1.14209442568)*x[1]+(-0.975626338621)*x[2]
        arg[0,1,0]=(0.909668629294)*x[0]+(1.29127341353)*x[1]+(-1.65221956404)*x[2]
        arg[0,1,1]=(-0.00309732749698)*x[0]+(0.0561682749786)*x[1]+(0.330039911431)*x[2]
        arg[1,0,0]=(0.966608417982)*x[0]+(-0.181702539284)*x[1]+(0.377393548129)*x[2]
        arg[1,0,1]=(0.0273333293331)*x[0]+(0.745172228806)*x[1]+(0.756302500232)*x[2]
        arg[1,1,0]=(-0.550382204645)*x[0]+(0.531191986475)*x[1]+(-1.02269665633)*x[2]
        arg[1,1,1]=(-0.928522491259)*x[0]+(-1.25241213648)*x[1]+(0.635412990933)*x[2]
        arg[2,0,0]=(-0.355234026557)*x[0]+(-1.69834232334)*x[1]+(1.17827811215)*x[2]
        arg[2,0,1]=(-0.905805855166)*x[0]+(1.4023187683)*x[1]+(-0.570168366306)*x[2]
        arg[2,1,0]=(0.550150523384)*x[0]+(-1.59933962526)*x[1]+(-0.388203251081)*x[2]
        arg[2,1,1]=(0.138470563927)*x[0]+(0.245233545344)*x[1]+(-0.293840556681)*x[2]
        arg[3,0,0]=(1.19700673733)*x[0]+(-1.04510591446)*x[1]+(1.03589008728)*x[2]
        arg[3,0,1]=(0.713948123924)*x[0]+(-1.42841558036)*x[1]+(1.07248428525)*x[2]
        arg[3,1,0]=(0.11223781122)*x[0]+(-0.00982612208261)*x[1]+(-0.263153847134)*x[2]
        arg[3,1,1]=(1.33011049869)*x[0]+(0.691016997799)*x[1]+(-0.0547947379786)*x[2]
        arg[4,0,0]=(1.0577224608)*x[0]+(-0.263034881475)*x[1]+(-0.854540775969)*x[2]
        arg[4,0,1]=(0.686363734714)*x[0]+(0.198120868875)*x[1]+(1.46326635417)*x[2]
        arg[4,1,0]=(-0.745244187008)*x[0]+(1.31766298118)*x[1]+(1.51544532829)*x[2]
        arg[4,1,1]=(0.878390723411)*x[0]+(-0.427741582253)*x[1]+(0.0324341706939)*x[2]
        arg[5,0,0]=(-0.445960121294)*x[0]+(-0.215668362178)*x[1]+(0.147632419682)*x[2]
        arg[5,0,1]=(-0.0781270285912)*x[0]+(0.782990026347)*x[1]+(-1.28046463036)*x[2]
        arg[5,1,0]=(-0.385003656622)*x[0]+(-1.02087438188)*x[1]+(-0.594357838151)*x[2]
        arg[5,1,1]=(-0.676669731714)*x[0]+(-0.28685220691)*x[1]+(0.335774697674)*x[2]
        ref[0,0,0,0]=(-1.52443210214)
        ref[0,0,0,1]=(-1.48020118993)
        ref[0,0,0,2]=(1.2552138343)
        ref[0,0,1,0]=(-0.102900544448)
        ref[0,0,1,1]=(-1.14209442568)
        ref[0,0,1,2]=(-0.975626338621)
        ref[0,1,0,0]=(0.909668629294)
        ref[0,1,0,1]=(1.29127341353)
        ref[0,1,0,2]=(-1.65221956404)
        ref[0,1,1,0]=(-0.00309732749698)
        ref[0,1,1,1]=(0.0561682749786)
        ref[0,1,1,2]=(0.330039911431)
        ref[1,0,0,0]=(0.966608417982)
        ref[1,0,0,1]=(-0.181702539284)
        ref[1,0,0,2]=(0.377393548129)
        ref[1,0,1,0]=(0.0273333293331)
        ref[1,0,1,1]=(0.745172228806)
        ref[1,0,1,2]=(0.756302500232)
        ref[1,1,0,0]=(-0.550382204645)
        ref[1,1,0,1]=(0.531191986475)
        ref[1,1,0,2]=(-1.02269665633)
        ref[1,1,1,0]=(-0.928522491259)
        ref[1,1,1,1]=(-1.25241213648)
        ref[1,1,1,2]=(0.635412990933)
        ref[2,0,0,0]=(-0.355234026557)
        ref[2,0,0,1]=(-1.69834232334)
        ref[2,0,0,2]=(1.17827811215)
        ref[2,0,1,0]=(-0.905805855166)
        ref[2,0,1,1]=(1.4023187683)
        ref[2,0,1,2]=(-0.570168366306)
        ref[2,1,0,0]=(0.550150523384)
        ref[2,1,0,1]=(-1.59933962526)
        ref[2,1,0,2]=(-0.388203251081)
        ref[2,1,1,0]=(0.138470563927)
        ref[2,1,1,1]=(0.245233545344)
        ref[2,1,1,2]=(-0.293840556681)
        ref[3,0,0,0]=(1.19700673733)
        ref[3,0,0,1]=(-1.04510591446)
        ref[3,0,0,2]=(1.03589008728)
        ref[3,0,1,0]=(0.713948123924)
        ref[3,0,1,1]=(-1.42841558036)
        ref[3,0,1,2]=(1.07248428525)
        ref[3,1,0,0]=(0.11223781122)
        ref[3,1,0,1]=(-0.00982612208261)
        ref[3,1,0,2]=(-0.263153847134)
        ref[3,1,1,0]=(1.33011049869)
        ref[3,1,1,1]=(0.691016997799)
        ref[3,1,1,2]=(-0.0547947379786)
        ref[4,0,0,0]=(1.0577224608)
        ref[4,0,0,1]=(-0.263034881475)
        ref[4,0,0,2]=(-0.854540775969)
        ref[4,0,1,0]=(0.686363734714)
        ref[4,0,1,1]=(0.198120868875)
        ref[4,0,1,2]=(1.46326635417)
        ref[4,1,0,0]=(-0.745244187008)
        ref[4,1,0,1]=(1.31766298118)
        ref[4,1,0,2]=(1.51544532829)
        ref[4,1,1,0]=(0.878390723411)
        ref[4,1,1,1]=(-0.427741582253)
        ref[4,1,1,2]=(0.0324341706939)
        ref[5,0,0,0]=(-0.445960121294)
        ref[5,0,0,1]=(-0.215668362178)
        ref[5,0,0,2]=(0.147632419682)
        ref[5,0,1,0]=(-0.0781270285912)
        ref[5,0,1,1]=(0.782990026347)
        ref[5,0,1,2]=(-1.28046463036)
        ref[5,1,0,0]=(-0.385003656622)
        ref[5,1,0,1]=(-1.02087438188)
        ref[5,1,0,2]=(-0.594357838151)
        ref[5,1,1,0]=(-0.676669731714)
        ref[5,1,1,1]=(-0.28685220691)
        ref[5,1,1,2]=(0.335774697674)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(0.729541999217)*x[0]**o+(-0.0840038177686)*x[0]+(-0.843340387423)*x[1]**o+(0.835228033597)*x[1]
        ref[0]=o*(0.729541999217)*x_ref[0]**(o-1)+(-0.0840038177686)
        ref[1]=o*(-0.843340387423)*x_ref[1]**(o-1)+(0.835228033597)
      else:
        s=(-0.842281311478)*x[0]**o+(-0.814605655879)*x[0]+(0.626451534537)*x[1]**o+(-0.933916049385)*x[1]+(0.665647219119)*x[2]**o+(-0.320674717559)*x[2]
        ref[0]=o*(-0.842281311478)*x_ref[0]**(o-1)+(-0.814605655879)
        ref[1]=o*(0.626451534537)*x_ref[1]**(o-1)+(-0.933916049385)
        ref[2]=o*(0.665647219119)*x_ref[2]**(o-1)+(-0.320674717559)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(0.439352379619)*x[0]**o+(0.147328198635)*x[0]+(0.247834811224)*x[1]**o+(-0.464888499837)*x[1]
        s[1]=(0.468286938618)*x[0]**o+(-0.37473605363)*x[0]+(-0.957221570057)*x[1]**o+(0.192131525732)*x[1]
        ref[0,0]=o*(0.439352379619)*x_ref[0]**(o-1)+(0.147328198635)
        ref[0,1]=o*(0.247834811224)*x_ref[1]**(o-1)+(-0.464888499837)
        ref[1,0]=o*(0.468286938618)*x_ref[0]**(o-1)+(-0.37473605363)
        ref[1,1]=o*(-0.957221570057)*x_ref[1]**(o-1)+(0.192131525732)
      else:
        s[0]=(-0.608854640717)*x[0]**o+(-0.185932852919)*x[0]+(0.845083724014)*x[1]**o+(0.674307303063)*x[1]+(-0.981577175928)*x[2]**o+(0.59694635612)*x[2]
        s[1]=(0.229588079023)*x[0]**o+(0.0251610523352)*x[0]+(0.120319529556)*x[1]**o+(-0.6189763968)*x[1]+(-0.630398590893)*x[2]**o+(-0.675207219617)*x[2]
        ref[0,0]=o*(-0.608854640717)*x_ref[0]**(o-1)+(-0.185932852919)
        ref[0,1]=o*(0.845083724014)*x_ref[1]**(o-1)+(0.674307303063)
        ref[0,2]=o*(-0.981577175928)*x_ref[2]**(o-1)+(0.59694635612)
        ref[1,0]=o*(0.229588079023)*x_ref[0]**(o-1)+(0.0251610523352)
        ref[1,1]=o*(0.120319529556)*x_ref[1]**(o-1)+(-0.6189763968)
        ref[1,2]=o*(-0.630398590893)*x_ref[2]**(o-1)+(-0.675207219617)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(0.047995114526)*x[0]**o+(-0.0882500144924)*x[0]+(-0.418291362721)*x[1]**o+(0.76104926053)*x[1]
        s[0,1]=(-0.862451726051)*x[0]**o+(-0.752156684628)*x[0]+(0.0539876744263)*x[1]**o+(0.0136018280853)*x[1]
        s[0,2]=(0.356154299906)*x[0]**o+(-0.119273405197)*x[0]+(-0.55202199349)*x[1]**o+(0.976767610299)*x[1]
        s[0,3]=(0.26210854969)*x[0]**o+(0.492516191788)*x[0]+(-0.187803726963)*x[1]**o+(0.331043415981)*x[1]
        s[0,4]=(0.995092330192)*x[0]**o+(0.798072438804)*x[0]+(-0.851959660211)*x[1]**o+(0.376241209687)*x[1]
        s[1,0]=(-0.819203501556)*x[0]**o+(0.158244838297)*x[0]+(-0.0854093261543)*x[1]**o+(-0.734166609629)*x[1]
        s[1,1]=(0.953095931566)*x[0]**o+(0.245967282177)*x[0]+(0.024143077003)*x[1]**o+(0.591611742804)*x[1]
        s[1,2]=(0.515929639772)*x[0]**o+(0.0656789332058)*x[0]+(-0.486542111002)*x[1]**o+(-0.35357048557)*x[1]
        s[1,3]=(0.687461558204)*x[0]**o+(-0.885516846762)*x[0]+(-0.837556168903)*x[1]**o+(-0.263453643201)*x[1]
        s[1,4]=(0.202647080146)*x[0]**o+(0.0998694048742)*x[0]+(0.963315271661)*x[1]**o+(0.0738433857728)*x[1]
        s[2,0]=(-0.431227566486)*x[0]**o+(-0.811861069902)*x[0]+(0.207189408046)*x[1]**o+(-0.843636004903)*x[1]
        s[2,1]=(-0.947866812956)*x[0]**o+(-0.779542963233)*x[0]+(0.788757232024)*x[1]**o+(-0.798061295304)*x[1]
        s[2,2]=(-0.316894005317)*x[0]**o+(-0.0766086555356)*x[0]+(-0.321413016846)*x[1]**o+(-0.586742246307)*x[1]
        s[2,3]=(-0.366402163737)*x[0]**o+(0.906207257774)*x[0]+(0.42214475079)*x[1]**o+(-0.927560770588)*x[1]
        s[2,4]=(-0.355651171461)*x[0]**o+(0.636115063757)*x[0]+(0.425219309267)*x[1]**o+(0.461939146758)*x[1]
        s[3,0]=(-0.0691712814483)*x[0]**o+(0.221346711903)*x[0]+(0.223896511845)*x[1]**o+(0.407991412109)*x[1]
        s[3,1]=(-0.437261446252)*x[0]**o+(0.0175743759667)*x[0]+(-0.937854235512)*x[1]**o+(0.814464696622)*x[1]
        s[3,2]=(-0.246296303859)*x[0]**o+(0.290577742331)*x[0]+(0.648443639897)*x[1]**o+(-0.233763313065)*x[1]
        s[3,3]=(-0.574728457793)*x[0]**o+(-0.544796515995)*x[0]+(-0.411409144577)*x[1]**o+(-0.491277131741)*x[1]
        s[3,4]=(0.894563379439)*x[0]**o+(-0.495844199423)*x[0]+(-0.580716302019)*x[1]**o+(-0.0192249355836)*x[1]
        ref[0,0,0]=o*(0.047995114526)*x_ref[0]**(o-1)+(-0.0882500144924)
        ref[0,0,1]=o*(-0.418291362721)*x_ref[1]**(o-1)+(0.76104926053)
        ref[0,1,0]=o*(-0.862451726051)*x_ref[0]**(o-1)+(-0.752156684628)
        ref[0,1,1]=o*(0.0539876744263)*x_ref[1]**(o-1)+(0.0136018280853)
        ref[0,2,0]=o*(0.356154299906)*x_ref[0]**(o-1)+(-0.119273405197)
        ref[0,2,1]=o*(-0.55202199349)*x_ref[1]**(o-1)+(0.976767610299)
        ref[0,3,0]=o*(0.26210854969)*x_ref[0]**(o-1)+(0.492516191788)
        ref[0,3,1]=o*(-0.187803726963)*x_ref[1]**(o-1)+(0.331043415981)
        ref[0,4,0]=o*(0.995092330192)*x_ref[0]**(o-1)+(0.798072438804)
        ref[0,4,1]=o*(-0.851959660211)*x_ref[1]**(o-1)+(0.376241209687)
        ref[1,0,0]=o*(-0.819203501556)*x_ref[0]**(o-1)+(0.158244838297)
        ref[1,0,1]=o*(-0.0854093261543)*x_ref[1]**(o-1)+(-0.734166609629)
        ref[1,1,0]=o*(0.953095931566)*x_ref[0]**(o-1)+(0.245967282177)
        ref[1,1,1]=o*(0.024143077003)*x_ref[1]**(o-1)+(0.591611742804)
        ref[1,2,0]=o*(0.515929639772)*x_ref[0]**(o-1)+(0.0656789332058)
        ref[1,2,1]=o*(-0.486542111002)*x_ref[1]**(o-1)+(-0.35357048557)
        ref[1,3,0]=o*(0.687461558204)*x_ref[0]**(o-1)+(-0.885516846762)
        ref[1,3,1]=o*(-0.837556168903)*x_ref[1]**(o-1)+(-0.263453643201)
        ref[1,4,0]=o*(0.202647080146)*x_ref[0]**(o-1)+(0.0998694048742)
        ref[1,4,1]=o*(0.963315271661)*x_ref[1]**(o-1)+(0.0738433857728)
        ref[2,0,0]=o*(-0.431227566486)*x_ref[0]**(o-1)+(-0.811861069902)
        ref[2,0,1]=o*(0.207189408046)*x_ref[1]**(o-1)+(-0.843636004903)
        ref[2,1,0]=o*(-0.947866812956)*x_ref[0]**(o-1)+(-0.779542963233)
        ref[2,1,1]=o*(0.788757232024)*x_ref[1]**(o-1)+(-0.798061295304)
        ref[2,2,0]=o*(-0.316894005317)*x_ref[0]**(o-1)+(-0.0766086555356)
        ref[2,2,1]=o*(-0.321413016846)*x_ref[1]**(o-1)+(-0.586742246307)
        ref[2,3,0]=o*(-0.366402163737)*x_ref[0]**(o-1)+(0.906207257774)
        ref[2,3,1]=o*(0.42214475079)*x_ref[1]**(o-1)+(-0.927560770588)
        ref[2,4,0]=o*(-0.355651171461)*x_ref[0]**(o-1)+(0.636115063757)
        ref[2,4,1]=o*(0.425219309267)*x_ref[1]**(o-1)+(0.461939146758)
        ref[3,0,0]=o*(-0.0691712814483)*x_ref[0]**(o-1)+(0.221346711903)
        ref[3,0,1]=o*(0.223896511845)*x_ref[1]**(o-1)+(0.407991412109)
        ref[3,1,0]=o*(-0.437261446252)*x_ref[0]**(o-1)+(0.0175743759667)
        ref[3,1,1]=o*(-0.937854235512)*x_ref[1]**(o-1)+(0.814464696622)
        ref[3,2,0]=o*(-0.246296303859)*x_ref[0]**(o-1)+(0.290577742331)
        ref[3,2,1]=o*(0.648443639897)*x_ref[1]**(o-1)+(-0.233763313065)
        ref[3,3,0]=o*(-0.574728457793)*x_ref[0]**(o-1)+(-0.544796515995)
        ref[3,3,1]=o*(-0.411409144577)*x_ref[1]**(o-1)+(-0.491277131741)
        ref[3,4,0]=o*(0.894563379439)*x_ref[0]**(o-1)+(-0.495844199423)
        ref[3,4,1]=o*(-0.580716302019)*x_ref[1]**(o-1)+(-0.0192249355836)
      else:
        s[0,0]=(-0.440629362137)*x[0]**o+(0.432027111899)*x[0]+(0.485612378024)*x[1]**o+(0.100195330045)*x[1]+(-0.107489415991)*x[2]**o+(-0.871419715951)*x[2]
        s[0,1]=(-0.998817226455)*x[0]**o+(-0.27667660331)*x[0]+(-0.867725500303)*x[1]**o+(0.936977636906)*x[1]+(0.525970908002)*x[2]**o+(-0.279717686524)*x[2]
        s[0,2]=(-0.422100254422)*x[0]**o+(0.554292080667)*x[0]+(-0.0240387239116)*x[1]**o+(0.899626314131)*x[1]+(-0.982259001765)*x[2]**o+(-0.171863457765)*x[2]
        s[0,3]=(-0.683481609192)*x[0]**o+(0.604674984874)*x[0]+(0.707470056964)*x[1]**o+(0.775025878411)*x[1]+(0.370390201812)*x[2]**o+(-0.59247534281)*x[2]
        s[0,4]=(-0.435112832975)*x[0]**o+(-0.448385079313)*x[0]+(-0.467168230746)*x[1]**o+(0.824665416362)*x[1]+(-0.375723812297)*x[2]**o+(0.219591728252)*x[2]
        s[1,0]=(-0.946577267946)*x[0]**o+(-0.235619974774)*x[0]+(-0.440845837468)*x[1]**o+(0.523173708473)*x[1]+(0.138768169193)*x[2]**o+(0.0800449024418)*x[2]
        s[1,1]=(0.856208167581)*x[0]**o+(-0.949001152315)*x[0]+(0.603732417952)*x[1]**o+(-0.144434407904)*x[1]+(0.771914944319)*x[2]**o+(0.295663032072)*x[2]
        s[1,2]=(-0.0748077749478)*x[0]**o+(-0.800653291967)*x[0]+(-0.723295002911)*x[1]**o+(-0.459397931378)*x[1]+(-0.680567962158)*x[2]**o+(-0.397991544426)*x[2]
        s[1,3]=(-0.160866462235)*x[0]**o+(-0.269568432554)*x[0]+(0.760053321601)*x[1]**o+(0.636712875038)*x[1]+(0.718827472409)*x[2]**o+(-0.285961313882)*x[2]
        s[1,4]=(-0.192019161878)*x[0]**o+(0.376965303206)*x[0]+(-0.196459950888)*x[1]**o+(-0.816226430578)*x[1]+(0.627440208737)*x[2]**o+(0.846061231487)*x[2]
        s[2,0]=(-0.726210859697)*x[0]**o+(-0.931805040577)*x[0]+(-0.330082314232)*x[1]**o+(-0.594241678324)*x[1]+(-0.660189952658)*x[2]**o+(-0.788716966781)*x[2]
        s[2,1]=(-0.434348461759)*x[0]**o+(0.386897792713)*x[0]+(0.0471151132814)*x[1]**o+(-0.399299502588)*x[1]+(-0.412695129309)*x[2]**o+(-0.286460071055)*x[2]
        s[2,2]=(-0.702766222291)*x[0]**o+(-0.296328795371)*x[0]+(-0.569776274584)*x[1]**o+(-0.369361432195)*x[1]+(-0.308516249924)*x[2]**o+(0.025646183412)*x[2]
        s[2,3]=(-0.286989129847)*x[0]**o+(-0.152361831045)*x[0]+(-0.909624633862)*x[1]**o+(-0.920451186077)*x[1]+(-0.375390879331)*x[2]**o+(-0.905199847241)*x[2]
        s[2,4]=(0.619800447118)*x[0]**o+(-0.27317497769)*x[0]+(-0.0136479991947)*x[1]**o+(0.141634912432)*x[1]+(-0.61405995454)*x[2]**o+(-0.505857399048)*x[2]
        s[3,0]=(-0.782882873567)*x[0]**o+(-0.7736979883)*x[0]+(-0.322501480607)*x[1]**o+(0.839395743431)*x[1]+(-0.434294403981)*x[2]**o+(0.542823987177)*x[2]
        s[3,1]=(-0.802044187937)*x[0]**o+(-0.442612586193)*x[0]+(0.436047557305)*x[1]**o+(0.497708094931)*x[1]+(0.642169738987)*x[2]**o+(0.944050667638)*x[2]
        s[3,2]=(0.557014549515)*x[0]**o+(0.491428899905)*x[0]+(0.983181819191)*x[1]**o+(0.132058074766)*x[1]+(-0.260405939651)*x[2]**o+(0.101577990826)*x[2]
        s[3,3]=(0.595058474104)*x[0]**o+(-0.822604538462)*x[0]+(-0.723088531137)*x[1]**o+(-0.313808088359)*x[1]+(0.559816139446)*x[2]**o+(-0.513647272314)*x[2]
        s[3,4]=(-0.87608199975)*x[0]**o+(0.0585891509732)*x[0]+(-0.194566629493)*x[1]**o+(0.278612435937)*x[1]+(0.170683503576)*x[2]**o+(0.936525425446)*x[2]
        ref[0,0,0]=o*(-0.440629362137)*x_ref[0]**(o-1)+(0.432027111899)
        ref[0,0,1]=o*(0.485612378024)*x_ref[1]**(o-1)+(0.100195330045)
        ref[0,0,2]=o*(-0.107489415991)*x_ref[2]**(o-1)+(-0.871419715951)
        ref[0,1,0]=o*(-0.998817226455)*x_ref[0]**(o-1)+(-0.27667660331)
        ref[0,1,1]=o*(-0.867725500303)*x_ref[1]**(o-1)+(0.936977636906)
        ref[0,1,2]=o*(0.525970908002)*x_ref[2]**(o-1)+(-0.279717686524)
        ref[0,2,0]=o*(-0.422100254422)*x_ref[0]**(o-1)+(0.554292080667)
        ref[0,2,1]=o*(-0.0240387239116)*x_ref[1]**(o-1)+(0.899626314131)
        ref[0,2,2]=o*(-0.982259001765)*x_ref[2]**(o-1)+(-0.171863457765)
        ref[0,3,0]=o*(-0.683481609192)*x_ref[0]**(o-1)+(0.604674984874)
        ref[0,3,1]=o*(0.707470056964)*x_ref[1]**(o-1)+(0.775025878411)
        ref[0,3,2]=o*(0.370390201812)*x_ref[2]**(o-1)+(-0.59247534281)
        ref[0,4,0]=o*(-0.435112832975)*x_ref[0]**(o-1)+(-0.448385079313)
        ref[0,4,1]=o*(-0.467168230746)*x_ref[1]**(o-1)+(0.824665416362)
        ref[0,4,2]=o*(-0.375723812297)*x_ref[2]**(o-1)+(0.219591728252)
        ref[1,0,0]=o*(-0.946577267946)*x_ref[0]**(o-1)+(-0.235619974774)
        ref[1,0,1]=o*(-0.440845837468)*x_ref[1]**(o-1)+(0.523173708473)
        ref[1,0,2]=o*(0.138768169193)*x_ref[2]**(o-1)+(0.0800449024418)
        ref[1,1,0]=o*(0.856208167581)*x_ref[0]**(o-1)+(-0.949001152315)
        ref[1,1,1]=o*(0.603732417952)*x_ref[1]**(o-1)+(-0.144434407904)
        ref[1,1,2]=o*(0.771914944319)*x_ref[2]**(o-1)+(0.295663032072)
        ref[1,2,0]=o*(-0.0748077749478)*x_ref[0]**(o-1)+(-0.800653291967)
        ref[1,2,1]=o*(-0.723295002911)*x_ref[1]**(o-1)+(-0.459397931378)
        ref[1,2,2]=o*(-0.680567962158)*x_ref[2]**(o-1)+(-0.397991544426)
        ref[1,3,0]=o*(-0.160866462235)*x_ref[0]**(o-1)+(-0.269568432554)
        ref[1,3,1]=o*(0.760053321601)*x_ref[1]**(o-1)+(0.636712875038)
        ref[1,3,2]=o*(0.718827472409)*x_ref[2]**(o-1)+(-0.285961313882)
        ref[1,4,0]=o*(-0.192019161878)*x_ref[0]**(o-1)+(0.376965303206)
        ref[1,4,1]=o*(-0.196459950888)*x_ref[1]**(o-1)+(-0.816226430578)
        ref[1,4,2]=o*(0.627440208737)*x_ref[2]**(o-1)+(0.846061231487)
        ref[2,0,0]=o*(-0.726210859697)*x_ref[0]**(o-1)+(-0.931805040577)
        ref[2,0,1]=o*(-0.330082314232)*x_ref[1]**(o-1)+(-0.594241678324)
        ref[2,0,2]=o*(-0.660189952658)*x_ref[2]**(o-1)+(-0.788716966781)
        ref[2,1,0]=o*(-0.434348461759)*x_ref[0]**(o-1)+(0.386897792713)
        ref[2,1,1]=o*(0.0471151132814)*x_ref[1]**(o-1)+(-0.399299502588)
        ref[2,1,2]=o*(-0.412695129309)*x_ref[2]**(o-1)+(-0.286460071055)
        ref[2,2,0]=o*(-0.702766222291)*x_ref[0]**(o-1)+(-0.296328795371)
        ref[2,2,1]=o*(-0.569776274584)*x_ref[1]**(o-1)+(-0.369361432195)
        ref[2,2,2]=o*(-0.308516249924)*x_ref[2]**(o-1)+(0.025646183412)
        ref[2,3,0]=o*(-0.286989129847)*x_ref[0]**(o-1)+(-0.152361831045)
        ref[2,3,1]=o*(-0.909624633862)*x_ref[1]**(o-1)+(-0.920451186077)
        ref[2,3,2]=o*(-0.375390879331)*x_ref[2]**(o-1)+(-0.905199847241)
        ref[2,4,0]=o*(0.619800447118)*x_ref[0]**(o-1)+(-0.27317497769)
        ref[2,4,1]=o*(-0.0136479991947)*x_ref[1]**(o-1)+(0.141634912432)
        ref[2,4,2]=o*(-0.61405995454)*x_ref[2]**(o-1)+(-0.505857399048)
        ref[3,0,0]=o*(-0.782882873567)*x_ref[0]**(o-1)+(-0.7736979883)
        ref[3,0,1]=o*(-0.322501480607)*x_ref[1]**(o-1)+(0.839395743431)
        ref[3,0,2]=o*(-0.434294403981)*x_ref[2]**(o-1)+(0.542823987177)
        ref[3,1,0]=o*(-0.802044187937)*x_ref[0]**(o-1)+(-0.442612586193)
        ref[3,1,1]=o*(0.436047557305)*x_ref[1]**(o-1)+(0.497708094931)
        ref[3,1,2]=o*(0.642169738987)*x_ref[2]**(o-1)+(0.944050667638)
        ref[3,2,0]=o*(0.557014549515)*x_ref[0]**(o-1)+(0.491428899905)
        ref[3,2,1]=o*(0.983181819191)*x_ref[1]**(o-1)+(0.132058074766)
        ref[3,2,2]=o*(-0.260405939651)*x_ref[2]**(o-1)+(0.101577990826)
        ref[3,3,0]=o*(0.595058474104)*x_ref[0]**(o-1)+(-0.822604538462)
        ref[3,3,1]=o*(-0.723088531137)*x_ref[1]**(o-1)+(-0.313808088359)
        ref[3,3,2]=o*(0.559816139446)*x_ref[2]**(o-1)+(-0.513647272314)
        ref[3,4,0]=o*(-0.87608199975)*x_ref[0]**(o-1)+(0.0585891509732)
        ref[3,4,1]=o*(-0.194566629493)*x_ref[1]**(o-1)+(0.278612435937)
        ref[3,4,2]=o*(0.170683503576)*x_ref[2]**(o-1)+(0.936525425446)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnBoundary

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(0.212897121743)*x[0]**o+(0.270129409854)*x[0]+(0.187351601416)*x[1]**o+(0.681503494742)*x[1]
        s[0,0,1]=(0.0979281898609)*x[0]**o+(0.469261780546)*x[0]+(0.285691941306)*x[1]**o+(0.605427118235)*x[1]
        s[0,1,0]=(0.798192631806)*x[0]**o+(0.710948168289)*x[0]+(0.37314849797)*x[1]**o+(0.101332891852)*x[1]
        s[0,1,1]=(0.670619373787)*x[0]**o+(0.87986446998)*x[0]+(0.273598886571)*x[1]**o+(0.642775771189)*x[1]
        s[1,0,0]=(-0.579525230101)*x[0]**o+(-0.336522843918)*x[0]+(0.794313044824)*x[1]**o+(0.138149528558)*x[1]
        s[1,0,1]=(-0.790589960141)*x[0]**o+(-0.519541468607)*x[0]+(0.047053031477)*x[1]**o+(-0.376948328317)*x[1]
        s[1,1,0]=(-0.63652515985)*x[0]**o+(-0.796241202497)*x[0]+(0.961598412032)*x[1]**o+(0.392696716004)*x[1]
        s[1,1,1]=(-0.406921118202)*x[0]**o+(-0.117551313946)*x[0]+(-0.666279462502)*x[1]**o+(-0.0899789554615)*x[1]
        s[2,0,0]=(-0.863791811378)*x[0]**o+(0.594940266664)*x[0]+(0.872448531721)*x[1]**o+(0.874689552083)*x[1]
        s[2,0,1]=(0.243777114221)*x[0]**o+(-0.776695107306)*x[0]+(0.794794829454)*x[1]**o+(-0.318628386313)*x[1]
        s[2,1,0]=(0.0962259662597)*x[0]**o+(0.541353121994)*x[0]+(-0.672755845501)*x[1]**o+(-0.257046721225)*x[1]
        s[2,1,1]=(-0.943502231769)*x[0]**o+(-0.202236730464)*x[0]+(-0.411084369491)*x[1]**o+(0.954831689569)*x[1]
        s[3,0,0]=(0.768277437177)*x[0]**o+(0.641045872586)*x[0]+(0.456435914145)*x[1]**o+(-0.538634781112)*x[1]
        s[3,0,1]=(0.0107901515277)*x[0]**o+(0.204809134773)*x[0]+(0.632781493458)*x[1]**o+(0.813936796774)*x[1]
        s[3,1,0]=(0.187196185344)*x[0]**o+(-0.974329803149)*x[0]+(-0.131567139248)*x[1]**o+(-0.205725336514)*x[1]
        s[3,1,1]=(0.747378585446)*x[0]**o+(0.126887766052)*x[0]+(-0.660302189752)*x[1]**o+(0.227362395796)*x[1]
        s[4,0,0]=(0.822029556554)*x[0]**o+(0.742977721062)*x[0]+(0.972349490061)*x[1]**o+(0.307748083079)*x[1]
        s[4,0,1]=(-0.0347009705896)*x[0]**o+(0.506556900045)*x[0]+(-0.700430813955)*x[1]**o+(0.606413581865)*x[1]
        s[4,1,0]=(-0.69868976773)*x[0]**o+(0.447214222886)*x[0]+(0.290522797177)*x[1]**o+(0.139281488147)*x[1]
        s[4,1,1]=(0.850722242552)*x[0]**o+(0.578613819769)*x[0]+(-0.983680277805)*x[1]**o+(-0.0737991679361)*x[1]
        s[5,0,0]=(0.164023891553)*x[0]**o+(-0.398812116857)*x[0]+(0.754040638026)*x[1]**o+(0.890632418705)*x[1]
        s[5,0,1]=(0.176036561413)*x[0]**o+(0.551905509271)*x[0]+(0.584521803718)*x[1]**o+(0.359816759406)*x[1]
        s[5,1,0]=(0.728503623092)*x[0]**o+(0.448628087199)*x[0]+(0.7693890417)*x[1]**o+(-0.148028432439)*x[1]
        s[5,1,1]=(-0.974113865308)*x[0]**o+(-0.271026924938)*x[0]+(0.0918858163816)*x[1]**o+(0.441895253556)*x[1]
        ref[0,0,0,0]=o*(0.212897121743)*x_ref[0]**(o-1)+(0.270129409854)
        ref[0,0,0,1]=o*(0.187351601416)*x_ref[1]**(o-1)+(0.681503494742)
        ref[0,0,1,0]=o*(0.0979281898609)*x_ref[0]**(o-1)+(0.469261780546)
        ref[0,0,1,1]=o*(0.285691941306)*x_ref[1]**(o-1)+(0.605427118235)
        ref[0,1,0,0]=o*(0.798192631806)*x_ref[0]**(o-1)+(0.710948168289)
        ref[0,1,0,1]=o*(0.37314849797)*x_ref[1]**(o-1)+(0.101332891852)
        ref[0,1,1,0]=o*(0.670619373787)*x_ref[0]**(o-1)+(0.87986446998)
        ref[0,1,1,1]=o*(0.273598886571)*x_ref[1]**(o-1)+(0.642775771189)
        ref[1,0,0,0]=o*(-0.579525230101)*x_ref[0]**(o-1)+(-0.336522843918)
        ref[1,0,0,1]=o*(0.794313044824)*x_ref[1]**(o-1)+(0.138149528558)
        ref[1,0,1,0]=o*(-0.790589960141)*x_ref[0]**(o-1)+(-0.519541468607)
        ref[1,0,1,1]=o*(0.047053031477)*x_ref[1]**(o-1)+(-0.376948328317)
        ref[1,1,0,0]=o*(-0.63652515985)*x_ref[0]**(o-1)+(-0.796241202497)
        ref[1,1,0,1]=o*(0.961598412032)*x_ref[1]**(o-1)+(0.392696716004)
        ref[1,1,1,0]=o*(-0.406921118202)*x_ref[0]**(o-1)+(-0.117551313946)
        ref[1,1,1,1]=o*(-0.666279462502)*x_ref[1]**(o-1)+(-0.0899789554615)
        ref[2,0,0,0]=o*(-0.863791811378)*x_ref[0]**(o-1)+(0.594940266664)
        ref[2,0,0,1]=o*(0.872448531721)*x_ref[1]**(o-1)+(0.874689552083)
        ref[2,0,1,0]=o*(0.243777114221)*x_ref[0]**(o-1)+(-0.776695107306)
        ref[2,0,1,1]=o*(0.794794829454)*x_ref[1]**(o-1)+(-0.318628386313)
        ref[2,1,0,0]=o*(0.0962259662597)*x_ref[0]**(o-1)+(0.541353121994)
        ref[2,1,0,1]=o*(-0.672755845501)*x_ref[1]**(o-1)+(-0.257046721225)
        ref[2,1,1,0]=o*(-0.943502231769)*x_ref[0]**(o-1)+(-0.202236730464)
        ref[2,1,1,1]=o*(-0.411084369491)*x_ref[1]**(o-1)+(0.954831689569)
        ref[3,0,0,0]=o*(0.768277437177)*x_ref[0]**(o-1)+(0.641045872586)
        ref[3,0,0,1]=o*(0.456435914145)*x_ref[1]**(o-1)+(-0.538634781112)
        ref[3,0,1,0]=o*(0.0107901515277)*x_ref[0]**(o-1)+(0.204809134773)
        ref[3,0,1,1]=o*(0.632781493458)*x_ref[1]**(o-1)+(0.813936796774)
        ref[3,1,0,0]=o*(0.187196185344)*x_ref[0]**(o-1)+(-0.974329803149)
        ref[3,1,0,1]=o*(-0.131567139248)*x_ref[1]**(o-1)+(-0.205725336514)
        ref[3,1,1,0]=o*(0.747378585446)*x_ref[0]**(o-1)+(0.126887766052)
        ref[3,1,1,1]=o*(-0.660302189752)*x_ref[1]**(o-1)+(0.227362395796)
        ref[4,0,0,0]=o*(0.822029556554)*x_ref[0]**(o-1)+(0.742977721062)
        ref[4,0,0,1]=o*(0.972349490061)*x_ref[1]**(o-1)+(0.307748083079)
        ref[4,0,1,0]=o*(-0.0347009705896)*x_ref[0]**(o-1)+(0.506556900045)
        ref[4,0,1,1]=o*(-0.700430813955)*x_ref[1]**(o-1)+(0.606413581865)
        ref[4,1,0,0]=o*(-0.69868976773)*x_ref[0]**(o-1)+(0.447214222886)
        ref[4,1,0,1]=o*(0.290522797177)*x_ref[1]**(o-1)+(0.139281488147)
        ref[4,1,1,0]=o*(0.850722242552)*x_ref[0]**(o-1)+(0.578613819769)
        ref[4,1,1,1]=o*(-0.983680277805)*x_ref[1]**(o-1)+(-0.0737991679361)
        ref[5,0,0,0]=o*(0.164023891553)*x_ref[0]**(o-1)+(-0.398812116857)
        ref[5,0,0,1]=o*(0.754040638026)*x_ref[1]**(o-1)+(0.890632418705)
        ref[5,0,1,0]=o*(0.176036561413)*x_ref[0]**(o-1)+(0.551905509271)
        ref[5,0,1,1]=o*(0.584521803718)*x_ref[1]**(o-1)+(0.359816759406)
        ref[5,1,0,0]=o*(0.728503623092)*x_ref[0]**(o-1)+(0.448628087199)
        ref[5,1,0,1]=o*(0.7693890417)*x_ref[1]**(o-1)+(-0.148028432439)
        ref[5,1,1,0]=o*(-0.974113865308)*x_ref[0]**(o-1)+(-0.271026924938)
        ref[5,1,1,1]=o*(0.0918858163816)*x_ref[1]**(o-1)+(0.441895253556)
      else:
        s[0,0,0]=(0.902798077985)*x[0]**o+(-0.513564836003)*x[0]+(-0.56740021175)*x[1]**o+(-0.987494297109)*x[1]+(0.701885375414)*x[2]**o+(0.457818844785)*x[2]
        s[0,0,1]=(0.961682822532)*x[0]**o+(-0.155805753312)*x[0]+(0.664632247096)*x[1]**o+(-0.416626235035)*x[1]+(-0.710160165264)*x[2]**o+(0.604159028896)*x[2]
        s[0,1,0]=(-0.331535871964)*x[0]**o+(-0.417629864265)*x[0]+(0.206294208748)*x[1]**o+(-0.259792550744)*x[1]+(-0.125585762102)*x[2]**o+(-0.893437959215)*x[2]
        s[0,1,1]=(0.614124081239)*x[0]**o+(-0.974461795616)*x[0]+(-0.978571310051)*x[1]**o+(-0.696753351954)*x[1]+(-0.125579053404)*x[2]**o+(0.744152004821)*x[2]
        s[1,0,0]=(0.470195589624)*x[0]**o+(-0.543298404217)*x[0]+(-0.050519561506)*x[1]**o+(-0.140360629835)*x[1]+(0.198214376652)*x[2]**o+(0.424647243144)*x[2]
        s[1,0,1]=(0.726479572534)*x[0]**o+(0.553604934856)*x[0]+(0.0319217924147)*x[1]**o+(0.281723632246)*x[1]+(-0.525936361143)*x[2]**o+(0.0826305292145)*x[2]
        s[1,1,0]=(0.731149931727)*x[0]**o+(-0.792038038336)*x[0]+(0.376591980524)*x[1]**o+(-0.533851270214)*x[1]+(0.228328372658)*x[2]**o+(-0.685994122324)*x[2]
        s[1,1,1]=(0.0316092245143)*x[0]**o+(0.272078804647)*x[0]+(0.232701533258)*x[1]**o+(0.484166193421)*x[1]+(0.810979214906)*x[2]**o+(-0.678008492162)*x[2]
        s[2,0,0]=(-0.25934895114)*x[0]**o+(0.855703849413)*x[0]+(0.435458381315)*x[1]**o+(0.287983708847)*x[1]+(0.637280806162)*x[2]**o+(-0.871379201278)*x[2]
        s[2,0,1]=(-0.0628315253456)*x[0]**o+(-0.456689468581)*x[0]+(-0.990061219179)*x[1]**o+(0.103941195754)*x[1]+(0.683984409836)*x[2]**o+(-0.786055311041)*x[2]
        s[2,1,0]=(0.574774054041)*x[0]**o+(0.861386252917)*x[0]+(-0.817046727565)*x[1]**o+(-0.132779923567)*x[1]+(0.230879541156)*x[2]**o+(-0.774875301646)*x[2]
        s[2,1,1]=(-0.549231428363)*x[0]**o+(0.640633896033)*x[0]+(-0.0935356199455)*x[1]**o+(-0.139090953413)*x[1]+(0.00853390900484)*x[2]**o+(-0.974008998234)*x[2]
        s[3,0,0]=(-0.318959630087)*x[0]**o+(0.572260168906)*x[0]+(-0.715323370515)*x[1]**o+(-0.29409167385)*x[1]+(-0.417828539621)*x[2]**o+(-0.527658924511)*x[2]
        s[3,0,1]=(0.662794455331)*x[0]**o+(0.655652283888)*x[0]+(0.314776154296)*x[1]**o+(0.568698535574)*x[1]+(-0.715089514092)*x[2]**o+(-0.976898245896)*x[2]
        s[3,1,0]=(0.775469693327)*x[0]**o+(0.894695158486)*x[0]+(-0.0845263659865)*x[1]**o+(0.613321238688)*x[1]+(-0.261167781047)*x[2]**o+(-0.858407379125)*x[2]
        s[3,1,1]=(0.879739525497)*x[0]**o+(-0.196410556198)*x[0]+(0.245451670145)*x[1]**o+(0.881860540375)*x[1]+(-0.406601916222)*x[2]**o+(-0.698825194269)*x[2]
        s[4,0,0]=(-0.295318870536)*x[0]**o+(-0.386975265135)*x[0]+(-0.4694457277)*x[1]**o+(0.381202263202)*x[1]+(-0.246058013597)*x[2]**o+(-0.117116349193)*x[2]
        s[4,0,1]=(-0.52750487839)*x[0]**o+(0.239477947116)*x[0]+(0.415068508509)*x[1]**o+(0.499147016759)*x[1]+(-0.757947686224)*x[2]**o+(0.0356840223308)*x[2]
        s[4,1,0]=(-0.503519047063)*x[0]**o+(-0.983884111712)*x[0]+(0.289499262273)*x[1]**o+(0.477655179172)*x[1]+(0.267544491427)*x[2]**o+(0.577972060216)*x[2]
        s[4,1,1]=(-0.765677873271)*x[0]**o+(-0.574403742889)*x[0]+(0.0365362593269)*x[1]**o+(0.718127942002)*x[1]+(-0.882868921566)*x[2]**o+(-0.866965724039)*x[2]
        s[5,0,0]=(0.477311133484)*x[0]**o+(0.970292462756)*x[0]+(0.400262807291)*x[1]**o+(0.839779920106)*x[1]+(0.91075067745)*x[2]**o+(-0.171648787827)*x[2]
        s[5,0,1]=(-0.14817999498)*x[0]**o+(-0.284074361404)*x[0]+(-0.809114317075)*x[1]**o+(-0.421481538417)*x[1]+(0.617793146872)*x[2]**o+(0.808487061398)*x[2]
        s[5,1,0]=(-0.750064834677)*x[0]**o+(0.595717210851)*x[0]+(0.499697404346)*x[1]**o+(-0.890435534805)*x[1]+(-0.705182209377)*x[2]**o+(-0.831416292443)*x[2]
        s[5,1,1]=(-0.93237665803)*x[0]**o+(-0.608748654097)*x[0]+(-0.163402758239)*x[1]**o+(0.762304956717)*x[1]+(-0.236439076616)*x[2]**o+(-0.827173574464)*x[2]
        ref[0,0,0,0]=o*(0.902798077985)*x_ref[0]**(o-1)+(-0.513564836003)
        ref[0,0,0,1]=o*(-0.56740021175)*x_ref[1]**(o-1)+(-0.987494297109)
        ref[0,0,0,2]=o*(0.701885375414)*x_ref[2]**(o-1)+(0.457818844785)
        ref[0,0,1,0]=o*(0.961682822532)*x_ref[0]**(o-1)+(-0.155805753312)
        ref[0,0,1,1]=o*(0.664632247096)*x_ref[1]**(o-1)+(-0.416626235035)
        ref[0,0,1,2]=o*(-0.710160165264)*x_ref[2]**(o-1)+(0.604159028896)
        ref[0,1,0,0]=o*(-0.331535871964)*x_ref[0]**(o-1)+(-0.417629864265)
        ref[0,1,0,1]=o*(0.206294208748)*x_ref[1]**(o-1)+(-0.259792550744)
        ref[0,1,0,2]=o*(-0.125585762102)*x_ref[2]**(o-1)+(-0.893437959215)
        ref[0,1,1,0]=o*(0.614124081239)*x_ref[0]**(o-1)+(-0.974461795616)
        ref[0,1,1,1]=o*(-0.978571310051)*x_ref[1]**(o-1)+(-0.696753351954)
        ref[0,1,1,2]=o*(-0.125579053404)*x_ref[2]**(o-1)+(0.744152004821)
        ref[1,0,0,0]=o*(0.470195589624)*x_ref[0]**(o-1)+(-0.543298404217)
        ref[1,0,0,1]=o*(-0.050519561506)*x_ref[1]**(o-1)+(-0.140360629835)
        ref[1,0,0,2]=o*(0.198214376652)*x_ref[2]**(o-1)+(0.424647243144)
        ref[1,0,1,0]=o*(0.726479572534)*x_ref[0]**(o-1)+(0.553604934856)
        ref[1,0,1,1]=o*(0.0319217924147)*x_ref[1]**(o-1)+(0.281723632246)
        ref[1,0,1,2]=o*(-0.525936361143)*x_ref[2]**(o-1)+(0.0826305292145)
        ref[1,1,0,0]=o*(0.731149931727)*x_ref[0]**(o-1)+(-0.792038038336)
        ref[1,1,0,1]=o*(0.376591980524)*x_ref[1]**(o-1)+(-0.533851270214)
        ref[1,1,0,2]=o*(0.228328372658)*x_ref[2]**(o-1)+(-0.685994122324)
        ref[1,1,1,0]=o*(0.0316092245143)*x_ref[0]**(o-1)+(0.272078804647)
        ref[1,1,1,1]=o*(0.232701533258)*x_ref[1]**(o-1)+(0.484166193421)
        ref[1,1,1,2]=o*(0.810979214906)*x_ref[2]**(o-1)+(-0.678008492162)
        ref[2,0,0,0]=o*(-0.25934895114)*x_ref[0]**(o-1)+(0.855703849413)
        ref[2,0,0,1]=o*(0.435458381315)*x_ref[1]**(o-1)+(0.287983708847)
        ref[2,0,0,2]=o*(0.637280806162)*x_ref[2]**(o-1)+(-0.871379201278)
        ref[2,0,1,0]=o*(-0.0628315253456)*x_ref[0]**(o-1)+(-0.456689468581)
        ref[2,0,1,1]=o*(-0.990061219179)*x_ref[1]**(o-1)+(0.103941195754)
        ref[2,0,1,2]=o*(0.683984409836)*x_ref[2]**(o-1)+(-0.786055311041)
        ref[2,1,0,0]=o*(0.574774054041)*x_ref[0]**(o-1)+(0.861386252917)
        ref[2,1,0,1]=o*(-0.817046727565)*x_ref[1]**(o-1)+(-0.132779923567)
        ref[2,1,0,2]=o*(0.230879541156)*x_ref[2]**(o-1)+(-0.774875301646)
        ref[2,1,1,0]=o*(-0.549231428363)*x_ref[0]**(o-1)+(0.640633896033)
        ref[2,1,1,1]=o*(-0.0935356199455)*x_ref[1]**(o-1)+(-0.139090953413)
        ref[2,1,1,2]=o*(0.00853390900484)*x_ref[2]**(o-1)+(-0.974008998234)
        ref[3,0,0,0]=o*(-0.318959630087)*x_ref[0]**(o-1)+(0.572260168906)
        ref[3,0,0,1]=o*(-0.715323370515)*x_ref[1]**(o-1)+(-0.29409167385)
        ref[3,0,0,2]=o*(-0.417828539621)*x_ref[2]**(o-1)+(-0.527658924511)
        ref[3,0,1,0]=o*(0.662794455331)*x_ref[0]**(o-1)+(0.655652283888)
        ref[3,0,1,1]=o*(0.314776154296)*x_ref[1]**(o-1)+(0.568698535574)
        ref[3,0,1,2]=o*(-0.715089514092)*x_ref[2]**(o-1)+(-0.976898245896)
        ref[3,1,0,0]=o*(0.775469693327)*x_ref[0]**(o-1)+(0.894695158486)
        ref[3,1,0,1]=o*(-0.0845263659865)*x_ref[1]**(o-1)+(0.613321238688)
        ref[3,1,0,2]=o*(-0.261167781047)*x_ref[2]**(o-1)+(-0.858407379125)
        ref[3,1,1,0]=o*(0.879739525497)*x_ref[0]**(o-1)+(-0.196410556198)
        ref[3,1,1,1]=o*(0.245451670145)*x_ref[1]**(o-1)+(0.881860540375)
        ref[3,1,1,2]=o*(-0.406601916222)*x_ref[2]**(o-1)+(-0.698825194269)
        ref[4,0,0,0]=o*(-0.295318870536)*x_ref[0]**(o-1)+(-0.386975265135)
        ref[4,0,0,1]=o*(-0.4694457277)*x_ref[1]**(o-1)+(0.381202263202)
        ref[4,0,0,2]=o*(-0.246058013597)*x_ref[2]**(o-1)+(-0.117116349193)
        ref[4,0,1,0]=o*(-0.52750487839)*x_ref[0]**(o-1)+(0.239477947116)
        ref[4,0,1,1]=o*(0.415068508509)*x_ref[1]**(o-1)+(0.499147016759)
        ref[4,0,1,2]=o*(-0.757947686224)*x_ref[2]**(o-1)+(0.0356840223308)
        ref[4,1,0,0]=o*(-0.503519047063)*x_ref[0]**(o-1)+(-0.983884111712)
        ref[4,1,0,1]=o*(0.289499262273)*x_ref[1]**(o-1)+(0.477655179172)
        ref[4,1,0,2]=o*(0.267544491427)*x_ref[2]**(o-1)+(0.577972060216)
        ref[4,1,1,0]=o*(-0.765677873271)*x_ref[0]**(o-1)+(-0.574403742889)
        ref[4,1,1,1]=o*(0.0365362593269)*x_ref[1]**(o-1)+(0.718127942002)
        ref[4,1,1,2]=o*(-0.882868921566)*x_ref[2]**(o-1)+(-0.866965724039)
        ref[5,0,0,0]=o*(0.477311133484)*x_ref[0]**(o-1)+(0.970292462756)
        ref[5,0,0,1]=o*(0.400262807291)*x_ref[1]**(o-1)+(0.839779920106)
        ref[5,0,0,2]=o*(0.91075067745)*x_ref[2]**(o-1)+(-0.171648787827)
        ref[5,0,1,0]=o*(-0.14817999498)*x_ref[0]**(o-1)+(-0.284074361404)
        ref[5,0,1,1]=o*(-0.809114317075)*x_ref[1]**(o-1)+(-0.421481538417)
        ref[5,0,1,2]=o*(0.617793146872)*x_ref[2]**(o-1)+(0.808487061398)
        ref[5,1,0,0]=o*(-0.750064834677)*x_ref[0]**(o-1)+(0.595717210851)
        ref[5,1,0,1]=o*(0.499697404346)*x_ref[1]**(o-1)+(-0.890435534805)
        ref[5,1,0,2]=o*(-0.705182209377)*x_ref[2]**(o-1)+(-0.831416292443)
        ref[5,1,1,0]=o*(-0.93237665803)*x_ref[0]**(o-1)+(-0.608748654097)
        ref[5,1,1,1]=o*(-0.163402758239)*x_ref[1]**(o-1)+(0.762304956717)
        ref[5,1,1,2]=o*(-0.236439076616)*x_ref[2]**(o-1)+(-0.827173574464)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_Solution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(0.293125312175)*x[0]**o+(0.376150381261)*x[0]+(0.252430693686)*x[1]**o+(0.150428455322)*x[1]
        ref[0]=o*(0.293125312175)*x_ref[0]**(o-1)+(0.376150381261)
        ref[1]=o*(0.252430693686)*x_ref[1]**(o-1)+(0.150428455322)
      else:
        s=(0.978180509747)*x[0]**o+(0.768503254374)*x[0]+(0.113267806213)*x[1]**o+(-0.997552294934)*x[1]+(-0.643998032917)*x[2]**o+(-0.17168440847)*x[2]
        ref[0]=o*(0.978180509747)*x_ref[0]**(o-1)+(0.768503254374)
        ref[1]=o*(0.113267806213)*x_ref[1]**(o-1)+(-0.997552294934)
        ref[2]=o*(-0.643998032917)*x_ref[2]**(o-1)+(-0.17168440847)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_Solution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-0.138895230208)*x[0]**o+(-0.448856094505)*x[0]+(-0.82305383921)*x[1]**o+(-0.161535603589)*x[1]
        s[1]=(-0.302535177393)*x[0]**o+(0.811653356478)*x[0]+(0.05548155455)*x[1]**o+(-0.343903467756)*x[1]
        ref[0,0]=o*(-0.138895230208)*x_ref[0]**(o-1)+(-0.448856094505)
        ref[0,1]=o*(-0.82305383921)*x_ref[1]**(o-1)+(-0.161535603589)
        ref[1,0]=o*(-0.302535177393)*x_ref[0]**(o-1)+(0.811653356478)
        ref[1,1]=o*(0.05548155455)*x_ref[1]**(o-1)+(-0.343903467756)
      else:
        s[0]=(0.583525061796)*x[0]**o+(-0.891145747091)*x[0]+(-0.469656381595)*x[1]**o+(-0.0103398578248)*x[1]+(0.0970809480199)*x[2]**o+(0.652357321835)*x[2]
        s[1]=(-0.488885199473)*x[0]**o+(0.481806213481)*x[0]+(-0.7328445706)*x[1]**o+(0.28590334803)*x[1]+(0.044964568194)*x[2]**o+(0.474397408351)*x[2]
        ref[0,0]=o*(0.583525061796)*x_ref[0]**(o-1)+(-0.891145747091)
        ref[0,1]=o*(-0.469656381595)*x_ref[1]**(o-1)+(-0.0103398578248)
        ref[0,2]=o*(0.0970809480199)*x_ref[2]**(o-1)+(0.652357321835)
        ref[1,0]=o*(-0.488885199473)*x_ref[0]**(o-1)+(0.481806213481)
        ref[1,1]=o*(-0.7328445706)*x_ref[1]**(o-1)+(0.28590334803)
        ref[1,2]=o*(0.044964568194)*x_ref[2]**(o-1)+(0.474397408351)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_Solution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(0.872000208895)*x[0]**o+(-0.304556916188)*x[0]+(0.534581283951)*x[1]**o+(-0.626579480196)*x[1]
        s[0,1]=(-0.240150296068)*x[0]**o+(-0.31754292824)*x[0]+(-0.0574070276326)*x[1]**o+(-0.616687559393)*x[1]
        s[0,2]=(0.570345724046)*x[0]**o+(0.110952065807)*x[0]+(0.997553898152)*x[1]**o+(-0.503380742681)*x[1]
        s[0,3]=(0.872704383137)*x[0]**o+(0.686594842527)*x[0]+(0.798635469075)*x[1]**o+(0.43649341733)*x[1]
        s[0,4]=(-0.236636103417)*x[0]**o+(0.0762117276629)*x[0]+(-0.774027674603)*x[1]**o+(0.823651416506)*x[1]
        s[1,0]=(0.922041581692)*x[0]**o+(-0.284368621571)*x[0]+(-0.71200852665)*x[1]**o+(0.661348856406)*x[1]
        s[1,1]=(-0.402436007071)*x[0]**o+(-0.436850834963)*x[0]+(0.62748269836)*x[1]**o+(0.504691317707)*x[1]
        s[1,2]=(-0.793104721592)*x[0]**o+(-0.00597773372911)*x[0]+(0.0410611356405)*x[1]**o+(0.169129450548)*x[1]
        s[1,3]=(0.821521972958)*x[0]**o+(-0.784664003887)*x[0]+(-0.880383627011)*x[1]**o+(0.127311373905)*x[1]
        s[1,4]=(0.775700618787)*x[0]**o+(-0.837475890825)*x[0]+(0.426581954939)*x[1]**o+(0.404905797587)*x[1]
        s[2,0]=(-0.100956366427)*x[0]**o+(0.0933662209553)*x[0]+(-0.680046458225)*x[1]**o+(-0.145587503687)*x[1]
        s[2,1]=(0.166159597084)*x[0]**o+(-0.900241170518)*x[0]+(-0.168407179398)*x[1]**o+(-0.82352508068)*x[1]
        s[2,2]=(-0.476621892618)*x[0]**o+(-0.422712025977)*x[0]+(0.298151628461)*x[1]**o+(0.862589525974)*x[1]
        s[2,3]=(-0.0148783218305)*x[0]**o+(0.203140203381)*x[0]+(0.19407097983)*x[1]**o+(-0.772615096404)*x[1]
        s[2,4]=(0.656255800409)*x[0]**o+(-0.946330057363)*x[0]+(-0.257965999122)*x[1]**o+(0.71359373028)*x[1]
        s[3,0]=(-0.214762058983)*x[0]**o+(0.51144571871)*x[0]+(-0.147282047629)*x[1]**o+(0.709339363468)*x[1]
        s[3,1]=(-0.9112564909)*x[0]**o+(-0.900437328847)*x[0]+(-0.975324195939)*x[1]**o+(0.202889107529)*x[1]
        s[3,2]=(0.753787529389)*x[0]**o+(0.0630834387277)*x[0]+(-0.759168264562)*x[1]**o+(0.697873996051)*x[1]
        s[3,3]=(-0.0335165829084)*x[0]**o+(0.274748931927)*x[0]+(0.0686458601464)*x[1]**o+(-0.117608157399)*x[1]
        s[3,4]=(0.853158371839)*x[0]**o+(-0.166315314677)*x[0]+(0.789241330781)*x[1]**o+(-0.108867830466)*x[1]
        ref[0,0,0]=o*(0.872000208895)*x_ref[0]**(o-1)+(-0.304556916188)
        ref[0,0,1]=o*(0.534581283951)*x_ref[1]**(o-1)+(-0.626579480196)
        ref[0,1,0]=o*(-0.240150296068)*x_ref[0]**(o-1)+(-0.31754292824)
        ref[0,1,1]=o*(-0.0574070276326)*x_ref[1]**(o-1)+(-0.616687559393)
        ref[0,2,0]=o*(0.570345724046)*x_ref[0]**(o-1)+(0.110952065807)
        ref[0,2,1]=o*(0.997553898152)*x_ref[1]**(o-1)+(-0.503380742681)
        ref[0,3,0]=o*(0.872704383137)*x_ref[0]**(o-1)+(0.686594842527)
        ref[0,3,1]=o*(0.798635469075)*x_ref[1]**(o-1)+(0.43649341733)
        ref[0,4,0]=o*(-0.236636103417)*x_ref[0]**(o-1)+(0.0762117276629)
        ref[0,4,1]=o*(-0.774027674603)*x_ref[1]**(o-1)+(0.823651416506)
        ref[1,0,0]=o*(0.922041581692)*x_ref[0]**(o-1)+(-0.284368621571)
        ref[1,0,1]=o*(-0.71200852665)*x_ref[1]**(o-1)+(0.661348856406)
        ref[1,1,0]=o*(-0.402436007071)*x_ref[0]**(o-1)+(-0.436850834963)
        ref[1,1,1]=o*(0.62748269836)*x_ref[1]**(o-1)+(0.504691317707)
        ref[1,2,0]=o*(-0.793104721592)*x_ref[0]**(o-1)+(-0.00597773372911)
        ref[1,2,1]=o*(0.0410611356405)*x_ref[1]**(o-1)+(0.169129450548)
        ref[1,3,0]=o*(0.821521972958)*x_ref[0]**(o-1)+(-0.784664003887)
        ref[1,3,1]=o*(-0.880383627011)*x_ref[1]**(o-1)+(0.127311373905)
        ref[1,4,0]=o*(0.775700618787)*x_ref[0]**(o-1)+(-0.837475890825)
        ref[1,4,1]=o*(0.426581954939)*x_ref[1]**(o-1)+(0.404905797587)
        ref[2,0,0]=o*(-0.100956366427)*x_ref[0]**(o-1)+(0.0933662209553)
        ref[2,0,1]=o*(-0.680046458225)*x_ref[1]**(o-1)+(-0.145587503687)
        ref[2,1,0]=o*(0.166159597084)*x_ref[0]**(o-1)+(-0.900241170518)
        ref[2,1,1]=o*(-0.168407179398)*x_ref[1]**(o-1)+(-0.82352508068)
        ref[2,2,0]=o*(-0.476621892618)*x_ref[0]**(o-1)+(-0.422712025977)
        ref[2,2,1]=o*(0.298151628461)*x_ref[1]**(o-1)+(0.862589525974)
        ref[2,3,0]=o*(-0.0148783218305)*x_ref[0]**(o-1)+(0.203140203381)
        ref[2,3,1]=o*(0.19407097983)*x_ref[1]**(o-1)+(-0.772615096404)
        ref[2,4,0]=o*(0.656255800409)*x_ref[0]**(o-1)+(-0.946330057363)
        ref[2,4,1]=o*(-0.257965999122)*x_ref[1]**(o-1)+(0.71359373028)
        ref[3,0,0]=o*(-0.214762058983)*x_ref[0]**(o-1)+(0.51144571871)
        ref[3,0,1]=o*(-0.147282047629)*x_ref[1]**(o-1)+(0.709339363468)
        ref[3,1,0]=o*(-0.9112564909)*x_ref[0]**(o-1)+(-0.900437328847)
        ref[3,1,1]=o*(-0.975324195939)*x_ref[1]**(o-1)+(0.202889107529)
        ref[3,2,0]=o*(0.753787529389)*x_ref[0]**(o-1)+(0.0630834387277)
        ref[3,2,1]=o*(-0.759168264562)*x_ref[1]**(o-1)+(0.697873996051)
        ref[3,3,0]=o*(-0.0335165829084)*x_ref[0]**(o-1)+(0.274748931927)
        ref[3,3,1]=o*(0.0686458601464)*x_ref[1]**(o-1)+(-0.117608157399)
        ref[3,4,0]=o*(0.853158371839)*x_ref[0]**(o-1)+(-0.166315314677)
        ref[3,4,1]=o*(0.789241330781)*x_ref[1]**(o-1)+(-0.108867830466)
      else:
        s[0,0]=(0.110594722699)*x[0]**o+(-0.980877918241)*x[0]+(-0.515559287698)*x[1]**o+(-0.434426926239)*x[1]+(-0.0366559310163)*x[2]**o+(0.387597823386)*x[2]
        s[0,1]=(-0.661423535056)*x[0]**o+(0.361082618968)*x[0]+(-0.614579461592)*x[1]**o+(0.212089227265)*x[1]+(-0.409309067892)*x[2]**o+(-0.237106482925)*x[2]
        s[0,2]=(0.704845609334)*x[0]**o+(-0.682094657708)*x[0]+(0.0483054658314)*x[1]**o+(0.992561055244)*x[1]+(-0.676784605979)*x[2]**o+(-0.992707421428)*x[2]
        s[0,3]=(0.901583311581)*x[0]**o+(-0.751695552218)*x[0]+(-0.869549394358)*x[1]**o+(-0.889541184356)*x[1]+(-0.969435364186)*x[2]**o+(0.72152104042)*x[2]
        s[0,4]=(-0.105522466219)*x[0]**o+(0.230764909205)*x[0]+(-0.714498630414)*x[1]**o+(-0.715271005406)*x[1]+(0.0748854473277)*x[2]**o+(0.0678300049229)*x[2]
        s[1,0]=(-0.275856624456)*x[0]**o+(-0.876662969004)*x[0]+(0.681719113093)*x[1]**o+(-0.24943399785)*x[1]+(0.0837599776409)*x[2]**o+(-0.0572825122918)*x[2]
        s[1,1]=(0.359136507147)*x[0]**o+(0.663934928768)*x[0]+(0.669380381609)*x[1]**o+(0.716889420418)*x[1]+(0.0903945351303)*x[2]**o+(-0.975420985116)*x[2]
        s[1,2]=(0.284213351844)*x[0]**o+(0.634377813314)*x[0]+(-0.0935851210685)*x[1]**o+(-0.195280560003)*x[1]+(0.379637016222)*x[2]**o+(0.57302910168)*x[2]
        s[1,3]=(-0.370451421268)*x[0]**o+(-0.619498493655)*x[0]+(0.386199258196)*x[1]**o+(0.150857936022)*x[1]+(0.123336255712)*x[2]**o+(0.0144448266576)*x[2]
        s[1,4]=(-0.517413398717)*x[0]**o+(-0.952688078253)*x[0]+(-0.146422080083)*x[1]**o+(0.0871413294299)*x[1]+(0.027398040628)*x[2]**o+(0.391317414872)*x[2]
        s[2,0]=(-0.126511587518)*x[0]**o+(0.696693700404)*x[0]+(0.408515262838)*x[1]**o+(-0.251009002512)*x[1]+(-0.641227451468)*x[2]**o+(0.679579864261)*x[2]
        s[2,1]=(0.527972863795)*x[0]**o+(-0.796977004243)*x[0]+(0.596836552415)*x[1]**o+(-0.810757416401)*x[1]+(-0.282708831988)*x[2]**o+(0.127311583541)*x[2]
        s[2,2]=(-0.777216458022)*x[0]**o+(-0.676149863396)*x[0]+(0.696096143251)*x[1]**o+(-0.725078530289)*x[1]+(-0.244393979264)*x[2]**o+(-0.0585093928601)*x[2]
        s[2,3]=(0.312124516125)*x[0]**o+(0.733713522534)*x[0]+(0.706643983792)*x[1]**o+(-0.361913672386)*x[1]+(-0.0131736734016)*x[2]**o+(-0.530500138249)*x[2]
        s[2,4]=(-0.399862024703)*x[0]**o+(-0.98706730829)*x[0]+(0.90279618711)*x[1]**o+(-0.120842398107)*x[1]+(-0.621221270703)*x[2]**o+(-0.44680972674)*x[2]
        s[3,0]=(0.060963938467)*x[0]**o+(0.409545603066)*x[0]+(-0.399416656677)*x[1]**o+(-0.154729705297)*x[1]+(-0.821106571182)*x[2]**o+(0.917110134569)*x[2]
        s[3,1]=(0.395083986916)*x[0]**o+(0.957423333841)*x[0]+(-0.753576884181)*x[1]**o+(0.402825662464)*x[1]+(0.444980287919)*x[2]**o+(-0.793575717385)*x[2]
        s[3,2]=(0.519344966169)*x[0]**o+(-0.919203821647)*x[0]+(0.472250030015)*x[1]**o+(0.912498896282)*x[1]+(0.30696323239)*x[2]**o+(-0.742821847869)*x[2]
        s[3,3]=(-0.762199299359)*x[0]**o+(0.245025069538)*x[0]+(-0.576731219257)*x[1]**o+(-0.818632810068)*x[1]+(0.295773945963)*x[2]**o+(-0.0803897317676)*x[2]
        s[3,4]=(-0.339788378435)*x[0]**o+(-0.498108849772)*x[0]+(-0.779105108948)*x[1]**o+(-0.31350292532)*x[1]+(0.576582365303)*x[2]**o+(0.733406974144)*x[2]
        ref[0,0,0]=o*(0.110594722699)*x_ref[0]**(o-1)+(-0.980877918241)
        ref[0,0,1]=o*(-0.515559287698)*x_ref[1]**(o-1)+(-0.434426926239)
        ref[0,0,2]=o*(-0.0366559310163)*x_ref[2]**(o-1)+(0.387597823386)
        ref[0,1,0]=o*(-0.661423535056)*x_ref[0]**(o-1)+(0.361082618968)
        ref[0,1,1]=o*(-0.614579461592)*x_ref[1]**(o-1)+(0.212089227265)
        ref[0,1,2]=o*(-0.409309067892)*x_ref[2]**(o-1)+(-0.237106482925)
        ref[0,2,0]=o*(0.704845609334)*x_ref[0]**(o-1)+(-0.682094657708)
        ref[0,2,1]=o*(0.0483054658314)*x_ref[1]**(o-1)+(0.992561055244)
        ref[0,2,2]=o*(-0.676784605979)*x_ref[2]**(o-1)+(-0.992707421428)
        ref[0,3,0]=o*(0.901583311581)*x_ref[0]**(o-1)+(-0.751695552218)
        ref[0,3,1]=o*(-0.869549394358)*x_ref[1]**(o-1)+(-0.889541184356)
        ref[0,3,2]=o*(-0.969435364186)*x_ref[2]**(o-1)+(0.72152104042)
        ref[0,4,0]=o*(-0.105522466219)*x_ref[0]**(o-1)+(0.230764909205)
        ref[0,4,1]=o*(-0.714498630414)*x_ref[1]**(o-1)+(-0.715271005406)
        ref[0,4,2]=o*(0.0748854473277)*x_ref[2]**(o-1)+(0.0678300049229)
        ref[1,0,0]=o*(-0.275856624456)*x_ref[0]**(o-1)+(-0.876662969004)
        ref[1,0,1]=o*(0.681719113093)*x_ref[1]**(o-1)+(-0.24943399785)
        ref[1,0,2]=o*(0.0837599776409)*x_ref[2]**(o-1)+(-0.0572825122918)
        ref[1,1,0]=o*(0.359136507147)*x_ref[0]**(o-1)+(0.663934928768)
        ref[1,1,1]=o*(0.669380381609)*x_ref[1]**(o-1)+(0.716889420418)
        ref[1,1,2]=o*(0.0903945351303)*x_ref[2]**(o-1)+(-0.975420985116)
        ref[1,2,0]=o*(0.284213351844)*x_ref[0]**(o-1)+(0.634377813314)
        ref[1,2,1]=o*(-0.0935851210685)*x_ref[1]**(o-1)+(-0.195280560003)
        ref[1,2,2]=o*(0.379637016222)*x_ref[2]**(o-1)+(0.57302910168)
        ref[1,3,0]=o*(-0.370451421268)*x_ref[0]**(o-1)+(-0.619498493655)
        ref[1,3,1]=o*(0.386199258196)*x_ref[1]**(o-1)+(0.150857936022)
        ref[1,3,2]=o*(0.123336255712)*x_ref[2]**(o-1)+(0.0144448266576)
        ref[1,4,0]=o*(-0.517413398717)*x_ref[0]**(o-1)+(-0.952688078253)
        ref[1,4,1]=o*(-0.146422080083)*x_ref[1]**(o-1)+(0.0871413294299)
        ref[1,4,2]=o*(0.027398040628)*x_ref[2]**(o-1)+(0.391317414872)
        ref[2,0,0]=o*(-0.126511587518)*x_ref[0]**(o-1)+(0.696693700404)
        ref[2,0,1]=o*(0.408515262838)*x_ref[1]**(o-1)+(-0.251009002512)
        ref[2,0,2]=o*(-0.641227451468)*x_ref[2]**(o-1)+(0.679579864261)
        ref[2,1,0]=o*(0.527972863795)*x_ref[0]**(o-1)+(-0.796977004243)
        ref[2,1,1]=o*(0.596836552415)*x_ref[1]**(o-1)+(-0.810757416401)
        ref[2,1,2]=o*(-0.282708831988)*x_ref[2]**(o-1)+(0.127311583541)
        ref[2,2,0]=o*(-0.777216458022)*x_ref[0]**(o-1)+(-0.676149863396)
        ref[2,2,1]=o*(0.696096143251)*x_ref[1]**(o-1)+(-0.725078530289)
        ref[2,2,2]=o*(-0.244393979264)*x_ref[2]**(o-1)+(-0.0585093928601)
        ref[2,3,0]=o*(0.312124516125)*x_ref[0]**(o-1)+(0.733713522534)
        ref[2,3,1]=o*(0.706643983792)*x_ref[1]**(o-1)+(-0.361913672386)
        ref[2,3,2]=o*(-0.0131736734016)*x_ref[2]**(o-1)+(-0.530500138249)
        ref[2,4,0]=o*(-0.399862024703)*x_ref[0]**(o-1)+(-0.98706730829)
        ref[2,4,1]=o*(0.90279618711)*x_ref[1]**(o-1)+(-0.120842398107)
        ref[2,4,2]=o*(-0.621221270703)*x_ref[2]**(o-1)+(-0.44680972674)
        ref[3,0,0]=o*(0.060963938467)*x_ref[0]**(o-1)+(0.409545603066)
        ref[3,0,1]=o*(-0.399416656677)*x_ref[1]**(o-1)+(-0.154729705297)
        ref[3,0,2]=o*(-0.821106571182)*x_ref[2]**(o-1)+(0.917110134569)
        ref[3,1,0]=o*(0.395083986916)*x_ref[0]**(o-1)+(0.957423333841)
        ref[3,1,1]=o*(-0.753576884181)*x_ref[1]**(o-1)+(0.402825662464)
        ref[3,1,2]=o*(0.444980287919)*x_ref[2]**(o-1)+(-0.793575717385)
        ref[3,2,0]=o*(0.519344966169)*x_ref[0]**(o-1)+(-0.919203821647)
        ref[3,2,1]=o*(0.472250030015)*x_ref[1]**(o-1)+(0.912498896282)
        ref[3,2,2]=o*(0.30696323239)*x_ref[2]**(o-1)+(-0.742821847869)
        ref[3,3,0]=o*(-0.762199299359)*x_ref[0]**(o-1)+(0.245025069538)
        ref[3,3,1]=o*(-0.576731219257)*x_ref[1]**(o-1)+(-0.818632810068)
        ref[3,3,2]=o*(0.295773945963)*x_ref[2]**(o-1)+(-0.0803897317676)
        ref[3,4,0]=o*(-0.339788378435)*x_ref[0]**(o-1)+(-0.498108849772)
        ref[3,4,1]=o*(-0.779105108948)*x_ref[1]**(o-1)+(-0.31350292532)
        ref[3,4,2]=o*(0.576582365303)*x_ref[2]**(o-1)+(0.733406974144)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_Solution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnBoundary

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(-0.259416702848)*x[0]**o+(-0.245749999215)*x[0]+(-0.832153732959)*x[1]**o+(-0.739170215675)*x[1]
        s[0,0,1]=(0.348837228856)*x[0]**o+(-0.666178442607)*x[0]+(-0.849566479561)*x[1]**o+(-0.602086600784)*x[1]
        s[0,1,0]=(-0.155423946179)*x[0]**o+(0.236260314596)*x[0]+(-0.161071268117)*x[1]**o+(-0.86073460521)*x[1]
        s[0,1,1]=(0.00159453654506)*x[0]**o+(0.854588501463)*x[0]+(-0.932772016744)*x[1]**o+(-0.241490278915)*x[1]
        s[1,0,0]=(0.954888979422)*x[0]**o+(-0.0656825754869)*x[0]+(-0.685117910338)*x[1]**o+(0.329351311251)*x[1]
        s[1,0,1]=(0.653313879148)*x[0]**o+(-0.100353950439)*x[0]+(-0.427779024915)*x[1]**o+(0.541043842928)*x[1]
        s[1,1,0]=(-0.529344191036)*x[0]**o+(0.927248256927)*x[0]+(0.637824503976)*x[1]**o+(-0.510873834148)*x[1]
        s[1,1,1]=(0.392461722459)*x[0]**o+(0.867028086856)*x[0]+(-0.0972014158405)*x[1]**o+(0.930607205251)*x[1]
        s[2,0,0]=(-0.896743306281)*x[0]**o+(-0.44962668492)*x[0]+(0.510004368477)*x[1]**o+(-0.218091766014)*x[1]
        s[2,0,1]=(0.236477487758)*x[0]**o+(0.868982620792)*x[0]+(0.596196651626)*x[1]**o+(0.362649185465)*x[1]
        s[2,1,0]=(0.959619355116)*x[0]**o+(-0.502578509326)*x[0]+(-0.903069740877)*x[1]**o+(0.389137844229)*x[1]
        s[2,1,1]=(-0.683715298632)*x[0]**o+(0.577696755527)*x[0]+(-0.306714659414)*x[1]**o+(-0.72219199497)*x[1]
        s[3,0,0]=(-0.266756580775)*x[0]**o+(-0.360900565587)*x[0]+(-0.0715666567511)*x[1]**o+(-0.576677423431)*x[1]
        s[3,0,1]=(0.234720540152)*x[0]**o+(0.174728976827)*x[0]+(-0.347025720807)*x[1]**o+(-0.42072768341)*x[1]
        s[3,1,0]=(-0.470982762526)*x[0]**o+(-0.177781625128)*x[0]+(-0.0706858877364)*x[1]**o+(-0.722096785258)*x[1]
        s[3,1,1]=(0.598814426535)*x[0]**o+(0.767055301394)*x[0]+(0.229632024426)*x[1]**o+(0.944250372458)*x[1]
        s[4,0,0]=(0.451029698166)*x[0]**o+(-0.0341544883586)*x[0]+(0.785553686295)*x[1]**o+(0.455034664029)*x[1]
        s[4,0,1]=(-0.477486417869)*x[0]**o+(0.509646735364)*x[0]+(0.857098988263)*x[1]**o+(-0.330863877708)*x[1]
        s[4,1,0]=(-0.582320009575)*x[0]**o+(0.469724725179)*x[0]+(-0.482992293774)*x[1]**o+(-0.306261026308)*x[1]
        s[4,1,1]=(0.635452311265)*x[0]**o+(-0.795606745931)*x[0]+(-0.659604106287)*x[1]**o+(-0.0576280668882)*x[1]
        s[5,0,0]=(-0.621743078369)*x[0]**o+(0.889286951305)*x[0]+(-0.487280887249)*x[1]**o+(-0.377618071831)*x[1]
        s[5,0,1]=(0.558391219866)*x[0]**o+(-0.265622963303)*x[0]+(-0.0801965105564)*x[1]**o+(0.800983693747)*x[1]
        s[5,1,0]=(-0.291431222644)*x[0]**o+(-0.259327626357)*x[0]+(0.597600388624)*x[1]**o+(-0.890810042322)*x[1]
        s[5,1,1]=(-0.391398128176)*x[0]**o+(0.994837784671)*x[0]+(-0.467189874705)*x[1]**o+(0.626474390794)*x[1]
        ref[0,0,0,0]=o*(-0.259416702848)*x_ref[0]**(o-1)+(-0.245749999215)
        ref[0,0,0,1]=o*(-0.832153732959)*x_ref[1]**(o-1)+(-0.739170215675)
        ref[0,0,1,0]=o*(0.348837228856)*x_ref[0]**(o-1)+(-0.666178442607)
        ref[0,0,1,1]=o*(-0.849566479561)*x_ref[1]**(o-1)+(-0.602086600784)
        ref[0,1,0,0]=o*(-0.155423946179)*x_ref[0]**(o-1)+(0.236260314596)
        ref[0,1,0,1]=o*(-0.161071268117)*x_ref[1]**(o-1)+(-0.86073460521)
        ref[0,1,1,0]=o*(0.00159453654506)*x_ref[0]**(o-1)+(0.854588501463)
        ref[0,1,1,1]=o*(-0.932772016744)*x_ref[1]**(o-1)+(-0.241490278915)
        ref[1,0,0,0]=o*(0.954888979422)*x_ref[0]**(o-1)+(-0.0656825754869)
        ref[1,0,0,1]=o*(-0.685117910338)*x_ref[1]**(o-1)+(0.329351311251)
        ref[1,0,1,0]=o*(0.653313879148)*x_ref[0]**(o-1)+(-0.100353950439)
        ref[1,0,1,1]=o*(-0.427779024915)*x_ref[1]**(o-1)+(0.541043842928)
        ref[1,1,0,0]=o*(-0.529344191036)*x_ref[0]**(o-1)+(0.927248256927)
        ref[1,1,0,1]=o*(0.637824503976)*x_ref[1]**(o-1)+(-0.510873834148)
        ref[1,1,1,0]=o*(0.392461722459)*x_ref[0]**(o-1)+(0.867028086856)
        ref[1,1,1,1]=o*(-0.0972014158405)*x_ref[1]**(o-1)+(0.930607205251)
        ref[2,0,0,0]=o*(-0.896743306281)*x_ref[0]**(o-1)+(-0.44962668492)
        ref[2,0,0,1]=o*(0.510004368477)*x_ref[1]**(o-1)+(-0.218091766014)
        ref[2,0,1,0]=o*(0.236477487758)*x_ref[0]**(o-1)+(0.868982620792)
        ref[2,0,1,1]=o*(0.596196651626)*x_ref[1]**(o-1)+(0.362649185465)
        ref[2,1,0,0]=o*(0.959619355116)*x_ref[0]**(o-1)+(-0.502578509326)
        ref[2,1,0,1]=o*(-0.903069740877)*x_ref[1]**(o-1)+(0.389137844229)
        ref[2,1,1,0]=o*(-0.683715298632)*x_ref[0]**(o-1)+(0.577696755527)
        ref[2,1,1,1]=o*(-0.306714659414)*x_ref[1]**(o-1)+(-0.72219199497)
        ref[3,0,0,0]=o*(-0.266756580775)*x_ref[0]**(o-1)+(-0.360900565587)
        ref[3,0,0,1]=o*(-0.0715666567511)*x_ref[1]**(o-1)+(-0.576677423431)
        ref[3,0,1,0]=o*(0.234720540152)*x_ref[0]**(o-1)+(0.174728976827)
        ref[3,0,1,1]=o*(-0.347025720807)*x_ref[1]**(o-1)+(-0.42072768341)
        ref[3,1,0,0]=o*(-0.470982762526)*x_ref[0]**(o-1)+(-0.177781625128)
        ref[3,1,0,1]=o*(-0.0706858877364)*x_ref[1]**(o-1)+(-0.722096785258)
        ref[3,1,1,0]=o*(0.598814426535)*x_ref[0]**(o-1)+(0.767055301394)
        ref[3,1,1,1]=o*(0.229632024426)*x_ref[1]**(o-1)+(0.944250372458)
        ref[4,0,0,0]=o*(0.451029698166)*x_ref[0]**(o-1)+(-0.0341544883586)
        ref[4,0,0,1]=o*(0.785553686295)*x_ref[1]**(o-1)+(0.455034664029)
        ref[4,0,1,0]=o*(-0.477486417869)*x_ref[0]**(o-1)+(0.509646735364)
        ref[4,0,1,1]=o*(0.857098988263)*x_ref[1]**(o-1)+(-0.330863877708)
        ref[4,1,0,0]=o*(-0.582320009575)*x_ref[0]**(o-1)+(0.469724725179)
        ref[4,1,0,1]=o*(-0.482992293774)*x_ref[1]**(o-1)+(-0.306261026308)
        ref[4,1,1,0]=o*(0.635452311265)*x_ref[0]**(o-1)+(-0.795606745931)
        ref[4,1,1,1]=o*(-0.659604106287)*x_ref[1]**(o-1)+(-0.0576280668882)
        ref[5,0,0,0]=o*(-0.621743078369)*x_ref[0]**(o-1)+(0.889286951305)
        ref[5,0,0,1]=o*(-0.487280887249)*x_ref[1]**(o-1)+(-0.377618071831)
        ref[5,0,1,0]=o*(0.558391219866)*x_ref[0]**(o-1)+(-0.265622963303)
        ref[5,0,1,1]=o*(-0.0801965105564)*x_ref[1]**(o-1)+(0.800983693747)
        ref[5,1,0,0]=o*(-0.291431222644)*x_ref[0]**(o-1)+(-0.259327626357)
        ref[5,1,0,1]=o*(0.597600388624)*x_ref[1]**(o-1)+(-0.890810042322)
        ref[5,1,1,0]=o*(-0.391398128176)*x_ref[0]**(o-1)+(0.994837784671)
        ref[5,1,1,1]=o*(-0.467189874705)*x_ref[1]**(o-1)+(0.626474390794)
      else:
        s[0,0,0]=(-0.283421054619)*x[0]**o+(-0.389803426219)*x[0]+(-0.641735725139)*x[1]**o+(-0.184182767783)*x[1]+(0.559369811956)*x[2]**o+(0.4130246739)*x[2]
        s[0,0,1]=(-0.685739480994)*x[0]**o+(-0.412746444255)*x[0]+(-0.977924434029)*x[1]**o+(0.866683883992)*x[1]+(-0.104721288552)*x[2]**o+(-0.854137553522)*x[2]
        s[0,1,0]=(0.326677121892)*x[0]**o+(0.0346511145836)*x[0]+(-0.583479722363)*x[1]**o+(0.552232008446)*x[1]+(-0.66426015414)*x[2]**o+(-0.0282350207962)*x[2]
        s[0,1,1]=(-0.743104988438)*x[0]**o+(-0.250100474341)*x[0]+(-0.0100118927398)*x[1]**o+(0.421549551364)*x[1]+(0.774348452339)*x[2]**o+(0.0114324989752)*x[2]
        s[1,0,0]=(-0.969248079823)*x[0]**o+(0.554289530783)*x[0]+(-0.437222589525)*x[1]**o+(-0.454550411233)*x[1]+(-0.555157485811)*x[2]**o+(0.360201196386)*x[2]
        s[1,0,1]=(0.428483060047)*x[0]**o+(-0.305500955239)*x[0]+(-0.918692317879)*x[1]**o+(-0.0749149504003)*x[1]+(-0.146230161925)*x[2]**o+(-0.328660463631)*x[2]
        s[1,1,0]=(-0.534394777023)*x[0]**o+(-0.0160564112453)*x[0]+(-0.446201680182)*x[1]**o+(-0.457243622333)*x[1]+(0.316031457633)*x[2]**o+(-0.0867540461561)*x[2]
        s[1,1,1]=(-0.180636289042)*x[0]**o+(0.409910302887)*x[0]+(-0.261132577936)*x[1]**o+(0.976758759795)*x[1]+(-0.298504887785)*x[2]**o+(0.0720200683864)*x[2]
        s[2,0,0]=(-0.965162583973)*x[0]**o+(-0.885802239228)*x[0]+(-0.166151347797)*x[1]**o+(0.968122595961)*x[1]+(0.580364754552)*x[2]**o+(0.213039816836)*x[2]
        s[2,0,1]=(0.7871160079)*x[0]**o+(-0.235526954906)*x[0]+(0.496553426537)*x[1]**o+(-0.0239289077236)*x[1]+(-0.633193916071)*x[2]**o+(-0.777984393332)*x[2]
        s[2,1,0]=(-0.79465182095)*x[0]**o+(-0.0880694356168)*x[0]+(-0.686736039005)*x[1]**o+(-0.221174710075)*x[1]+(0.0208981523074)*x[2]**o+(-0.961469223363)*x[2]
        s[2,1,1]=(-0.455839585127)*x[0]**o+(0.941828964284)*x[0]+(0.998331788392)*x[1]**o+(0.0750455958592)*x[1]+(0.608504253916)*x[2]**o+(-0.374386910681)*x[2]
        s[3,0,0]=(-0.909949427027)*x[0]**o+(-0.396086474642)*x[0]+(0.899299670063)*x[1]**o+(0.141272919633)*x[1]+(0.53792064575)*x[2]**o+(0.595764269338)*x[2]
        s[3,0,1]=(-0.49521850368)*x[0]**o+(0.207120861953)*x[0]+(0.569903370263)*x[1]**o+(0.588491719962)*x[1]+(0.452965587121)*x[2]**o+(-0.628229661128)*x[2]
        s[3,1,0]=(-0.875095641635)*x[0]**o+(0.11799580621)*x[0]+(0.109152019439)*x[1]**o+(-0.941762743205)*x[1]+(-0.124413788962)*x[2]**o+(-0.733044880598)*x[2]
        s[3,1,1]=(0.691739414808)*x[0]**o+(-0.0580142383494)*x[0]+(-0.625563645068)*x[1]**o+(-0.459983356734)*x[1]+(0.743764207387)*x[2]**o+(0.200950835048)*x[2]
        s[4,0,0]=(-0.686339571296)*x[0]**o+(0.310431821345)*x[0]+(0.0697719589995)*x[1]**o+(0.413649564597)*x[1]+(0.311083457053)*x[2]**o+(-0.764323862328)*x[2]
        s[4,0,1]=(0.82709146654)*x[0]**o+(-0.958833756078)*x[0]+(-0.293388295126)*x[1]**o+(0.789172794162)*x[1]+(-0.47291926184)*x[2]**o+(0.447003729661)*x[2]
        s[4,1,0]=(-0.968741249623)*x[0]**o+(-0.977865313489)*x[0]+(0.777352281599)*x[1]**o+(-0.0177223674634)*x[1]+(-0.437430561766)*x[2]**o+(0.403327933356)*x[2]
        s[4,1,1]=(0.873657912127)*x[0]**o+(-0.432188278068)*x[0]+(-0.294192343439)*x[1]**o+(-0.199868940744)*x[1]+(0.379614508084)*x[2]**o+(0.610834295156)*x[2]
        s[5,0,0]=(-0.452716736875)*x[0]**o+(0.298248314499)*x[0]+(0.850779531393)*x[1]**o+(-0.024084377803)*x[1]+(-0.106948635789)*x[2]**o+(0.926343375096)*x[2]
        s[5,0,1]=(-0.22629592934)*x[0]**o+(-0.481026079587)*x[0]+(0.713198238543)*x[1]**o+(-0.290540996335)*x[1]+(-0.775028431788)*x[2]**o+(0.839104261372)*x[2]
        s[5,1,0]=(0.938919479885)*x[0]**o+(-0.833254411673)*x[0]+(-0.0920737395198)*x[1]**o+(-0.863263173274)*x[1]+(-0.326022820082)*x[2]**o+(-0.162067090943)*x[2]
        s[5,1,1]=(0.800986633012)*x[0]**o+(-0.102366666332)*x[0]+(-0.35704808806)*x[1]**o+(-0.710763760013)*x[1]+(0.249411990506)*x[2]**o+(0.569232273165)*x[2]
        ref[0,0,0,0]=o*(-0.283421054619)*x_ref[0]**(o-1)+(-0.389803426219)
        ref[0,0,0,1]=o*(-0.641735725139)*x_ref[1]**(o-1)+(-0.184182767783)
        ref[0,0,0,2]=o*(0.559369811956)*x_ref[2]**(o-1)+(0.4130246739)
        ref[0,0,1,0]=o*(-0.685739480994)*x_ref[0]**(o-1)+(-0.412746444255)
        ref[0,0,1,1]=o*(-0.977924434029)*x_ref[1]**(o-1)+(0.866683883992)
        ref[0,0,1,2]=o*(-0.104721288552)*x_ref[2]**(o-1)+(-0.854137553522)
        ref[0,1,0,0]=o*(0.326677121892)*x_ref[0]**(o-1)+(0.0346511145836)
        ref[0,1,0,1]=o*(-0.583479722363)*x_ref[1]**(o-1)+(0.552232008446)
        ref[0,1,0,2]=o*(-0.66426015414)*x_ref[2]**(o-1)+(-0.0282350207962)
        ref[0,1,1,0]=o*(-0.743104988438)*x_ref[0]**(o-1)+(-0.250100474341)
        ref[0,1,1,1]=o*(-0.0100118927398)*x_ref[1]**(o-1)+(0.421549551364)
        ref[0,1,1,2]=o*(0.774348452339)*x_ref[2]**(o-1)+(0.0114324989752)
        ref[1,0,0,0]=o*(-0.969248079823)*x_ref[0]**(o-1)+(0.554289530783)
        ref[1,0,0,1]=o*(-0.437222589525)*x_ref[1]**(o-1)+(-0.454550411233)
        ref[1,0,0,2]=o*(-0.555157485811)*x_ref[2]**(o-1)+(0.360201196386)
        ref[1,0,1,0]=o*(0.428483060047)*x_ref[0]**(o-1)+(-0.305500955239)
        ref[1,0,1,1]=o*(-0.918692317879)*x_ref[1]**(o-1)+(-0.0749149504003)
        ref[1,0,1,2]=o*(-0.146230161925)*x_ref[2]**(o-1)+(-0.328660463631)
        ref[1,1,0,0]=o*(-0.534394777023)*x_ref[0]**(o-1)+(-0.0160564112453)
        ref[1,1,0,1]=o*(-0.446201680182)*x_ref[1]**(o-1)+(-0.457243622333)
        ref[1,1,0,2]=o*(0.316031457633)*x_ref[2]**(o-1)+(-0.0867540461561)
        ref[1,1,1,0]=o*(-0.180636289042)*x_ref[0]**(o-1)+(0.409910302887)
        ref[1,1,1,1]=o*(-0.261132577936)*x_ref[1]**(o-1)+(0.976758759795)
        ref[1,1,1,2]=o*(-0.298504887785)*x_ref[2]**(o-1)+(0.0720200683864)
        ref[2,0,0,0]=o*(-0.965162583973)*x_ref[0]**(o-1)+(-0.885802239228)
        ref[2,0,0,1]=o*(-0.166151347797)*x_ref[1]**(o-1)+(0.968122595961)
        ref[2,0,0,2]=o*(0.580364754552)*x_ref[2]**(o-1)+(0.213039816836)
        ref[2,0,1,0]=o*(0.7871160079)*x_ref[0]**(o-1)+(-0.235526954906)
        ref[2,0,1,1]=o*(0.496553426537)*x_ref[1]**(o-1)+(-0.0239289077236)
        ref[2,0,1,2]=o*(-0.633193916071)*x_ref[2]**(o-1)+(-0.777984393332)
        ref[2,1,0,0]=o*(-0.79465182095)*x_ref[0]**(o-1)+(-0.0880694356168)
        ref[2,1,0,1]=o*(-0.686736039005)*x_ref[1]**(o-1)+(-0.221174710075)
        ref[2,1,0,2]=o*(0.0208981523074)*x_ref[2]**(o-1)+(-0.961469223363)
        ref[2,1,1,0]=o*(-0.455839585127)*x_ref[0]**(o-1)+(0.941828964284)
        ref[2,1,1,1]=o*(0.998331788392)*x_ref[1]**(o-1)+(0.0750455958592)
        ref[2,1,1,2]=o*(0.608504253916)*x_ref[2]**(o-1)+(-0.374386910681)
        ref[3,0,0,0]=o*(-0.909949427027)*x_ref[0]**(o-1)+(-0.396086474642)
        ref[3,0,0,1]=o*(0.899299670063)*x_ref[1]**(o-1)+(0.141272919633)
        ref[3,0,0,2]=o*(0.53792064575)*x_ref[2]**(o-1)+(0.595764269338)
        ref[3,0,1,0]=o*(-0.49521850368)*x_ref[0]**(o-1)+(0.207120861953)
        ref[3,0,1,1]=o*(0.569903370263)*x_ref[1]**(o-1)+(0.588491719962)
        ref[3,0,1,2]=o*(0.452965587121)*x_ref[2]**(o-1)+(-0.628229661128)
        ref[3,1,0,0]=o*(-0.875095641635)*x_ref[0]**(o-1)+(0.11799580621)
        ref[3,1,0,1]=o*(0.109152019439)*x_ref[1]**(o-1)+(-0.941762743205)
        ref[3,1,0,2]=o*(-0.124413788962)*x_ref[2]**(o-1)+(-0.733044880598)
        ref[3,1,1,0]=o*(0.691739414808)*x_ref[0]**(o-1)+(-0.0580142383494)
        ref[3,1,1,1]=o*(-0.625563645068)*x_ref[1]**(o-1)+(-0.459983356734)
        ref[3,1,1,2]=o*(0.743764207387)*x_ref[2]**(o-1)+(0.200950835048)
        ref[4,0,0,0]=o*(-0.686339571296)*x_ref[0]**(o-1)+(0.310431821345)
        ref[4,0,0,1]=o*(0.0697719589995)*x_ref[1]**(o-1)+(0.413649564597)
        ref[4,0,0,2]=o*(0.311083457053)*x_ref[2]**(o-1)+(-0.764323862328)
        ref[4,0,1,0]=o*(0.82709146654)*x_ref[0]**(o-1)+(-0.958833756078)
        ref[4,0,1,1]=o*(-0.293388295126)*x_ref[1]**(o-1)+(0.789172794162)
        ref[4,0,1,2]=o*(-0.47291926184)*x_ref[2]**(o-1)+(0.447003729661)
        ref[4,1,0,0]=o*(-0.968741249623)*x_ref[0]**(o-1)+(-0.977865313489)
        ref[4,1,0,1]=o*(0.777352281599)*x_ref[1]**(o-1)+(-0.0177223674634)
        ref[4,1,0,2]=o*(-0.437430561766)*x_ref[2]**(o-1)+(0.403327933356)
        ref[4,1,1,0]=o*(0.873657912127)*x_ref[0]**(o-1)+(-0.432188278068)
        ref[4,1,1,1]=o*(-0.294192343439)*x_ref[1]**(o-1)+(-0.199868940744)
        ref[4,1,1,2]=o*(0.379614508084)*x_ref[2]**(o-1)+(0.610834295156)
        ref[5,0,0,0]=o*(-0.452716736875)*x_ref[0]**(o-1)+(0.298248314499)
        ref[5,0,0,1]=o*(0.850779531393)*x_ref[1]**(o-1)+(-0.024084377803)
        ref[5,0,0,2]=o*(-0.106948635789)*x_ref[2]**(o-1)+(0.926343375096)
        ref[5,0,1,0]=o*(-0.22629592934)*x_ref[0]**(o-1)+(-0.481026079587)
        ref[5,0,1,1]=o*(0.713198238543)*x_ref[1]**(o-1)+(-0.290540996335)
        ref[5,0,1,2]=o*(-0.775028431788)*x_ref[2]**(o-1)+(0.839104261372)
        ref[5,1,0,0]=o*(0.938919479885)*x_ref[0]**(o-1)+(-0.833254411673)
        ref[5,1,0,1]=o*(-0.0920737395198)*x_ref[1]**(o-1)+(-0.863263173274)
        ref[5,1,0,2]=o*(-0.326022820082)*x_ref[2]**(o-1)+(-0.162067090943)
        ref[5,1,1,0]=o*(0.800986633012)*x_ref[0]**(o-1)+(-0.102366666332)
        ref[5,1,1,1]=o*(-0.35704808806)*x_ref[1]**(o-1)+(-0.710763760013)
        ref[5,1,1,2]=o*(0.249411990506)*x_ref[2]**(o-1)+(0.569232273165)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(-0.049981434374)*x[0]+(1.21186502577)*x[1]
        ref[0]=(-0.049981434374)
        ref[1]=(1.21186502577)
      else:
        s=(-0.0752432283484)*x[0]+(0.11438092577)*x[1]+(-0.434888190035)*x[2]
        ref[0]=(-0.0752432283484)
        ref[1]=(0.11438092577)
        ref[2]=(-0.434888190035)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-0.456351387646)*x[0]+(-0.116715426711)*x[1]
        s[1]=(-0.854853163245)*x[0]+(-0.00664827097294)*x[1]
        ref[0,0]=(-0.456351387646)
        ref[0,1]=(-0.116715426711)
        ref[1,0]=(-0.854853163245)
        ref[1,1]=(-0.00664827097294)
      else:
        s[0]=(0.623100837308)*x[0]+(0.266907813705)*x[1]+(1.38575183924)*x[2]
        s[1]=(-1.48702785688)*x[0]+(-1.42426212001)*x[1]+(0.317785468787)*x[2]
        ref[0,0]=(0.623100837308)
        ref[0,1]=(0.266907813705)
        ref[0,2]=(1.38575183924)
        ref[1,0]=(-1.48702785688)
        ref[1,1]=(-1.42426212001)
        ref[1,2]=(0.317785468787)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-1.0789465623)*x[0]+(-0.347959175817)*x[1]
        s[0,1]=(-0.551011467115)*x[0]+(1.35264465045)*x[1]
        s[0,2]=(-0.570905806915)*x[0]+(0.0584374344724)*x[1]
        s[0,3]=(0.596777443685)*x[0]+(0.414694389615)*x[1]
        s[0,4]=(0.611144733018)*x[0]+(-0.758856666701)*x[1]
        s[1,0]=(-0.0733659967272)*x[0]+(1.27900296295)*x[1]
        s[1,1]=(-0.305565660896)*x[0]+(0.9434988738)*x[1]
        s[1,2]=(-0.992776824928)*x[0]+(-0.120817150952)*x[1]
        s[1,3]=(0.0902201920474)*x[0]+(1.04097295319)*x[1]
        s[1,4]=(-1.06448209062)*x[0]+(1.13868467732)*x[1]
        s[2,0]=(0.855203060995)*x[0]+(0.707160314719)*x[1]
        s[2,1]=(0.792799717854)*x[0]+(-0.36484734497)*x[1]
        s[2,2]=(-1.14542452528)*x[0]+(0.98847021504)*x[1]
        s[2,3]=(0.145237440613)*x[0]+(0.214714794234)*x[1]
        s[2,4]=(0.179556206154)*x[0]+(-1.21107721861)*x[1]
        s[3,0]=(0.700250733001)*x[0]+(1.25331090966)*x[1]
        s[3,1]=(0.258700850981)*x[0]+(-0.637474578328)*x[1]
        s[3,2]=(0.382709435533)*x[0]+(1.29575763411)*x[1]
        s[3,3]=(-0.254008873764)*x[0]+(-1.54340970006)*x[1]
        s[3,4]=(-0.658082774987)*x[0]+(0.647639696672)*x[1]
        ref[0,0,0]=(-1.0789465623)
        ref[0,0,1]=(-0.347959175817)
        ref[0,1,0]=(-0.551011467115)
        ref[0,1,1]=(1.35264465045)
        ref[0,2,0]=(-0.570905806915)
        ref[0,2,1]=(0.0584374344724)
        ref[0,3,0]=(0.596777443685)
        ref[0,3,1]=(0.414694389615)
        ref[0,4,0]=(0.611144733018)
        ref[0,4,1]=(-0.758856666701)
        ref[1,0,0]=(-0.0733659967272)
        ref[1,0,1]=(1.27900296295)
        ref[1,1,0]=(-0.305565660896)
        ref[1,1,1]=(0.9434988738)
        ref[1,2,0]=(-0.992776824928)
        ref[1,2,1]=(-0.120817150952)
        ref[1,3,0]=(0.0902201920474)
        ref[1,3,1]=(1.04097295319)
        ref[1,4,0]=(-1.06448209062)
        ref[1,4,1]=(1.13868467732)
        ref[2,0,0]=(0.855203060995)
        ref[2,0,1]=(0.707160314719)
        ref[2,1,0]=(0.792799717854)
        ref[2,1,1]=(-0.36484734497)
        ref[2,2,0]=(-1.14542452528)
        ref[2,2,1]=(0.98847021504)
        ref[2,3,0]=(0.145237440613)
        ref[2,3,1]=(0.214714794234)
        ref[2,4,0]=(0.179556206154)
        ref[2,4,1]=(-1.21107721861)
        ref[3,0,0]=(0.700250733001)
        ref[3,0,1]=(1.25331090966)
        ref[3,1,0]=(0.258700850981)
        ref[3,1,1]=(-0.637474578328)
        ref[3,2,0]=(0.382709435533)
        ref[3,2,1]=(1.29575763411)
        ref[3,3,0]=(-0.254008873764)
        ref[3,3,1]=(-1.54340970006)
        ref[3,4,0]=(-0.658082774987)
        ref[3,4,1]=(0.647639696672)
      else:
        s[0,0]=(1.12878816262)*x[0]+(-1.74114589021)*x[1]+(0.248765786072)*x[2]
        s[0,1]=(1.72583176211)*x[0]+(-1.23114549996)*x[1]+(-0.203157732085)*x[2]
        s[0,2]=(-0.422314546839)*x[0]+(0.224260123741)*x[1]+(0.171252253031)*x[2]
        s[0,3]=(-0.870712689882)*x[0]+(-0.555793590179)*x[1]+(0.290927600809)*x[2]
        s[0,4]=(-0.920833142524)*x[0]+(-0.0497652513943)*x[1]+(-0.39718342747)*x[2]
        s[1,0]=(-0.727450597273)*x[0]+(1.09323195342)*x[1]+(0.298478430357)*x[2]
        s[1,1]=(0.12608256775)*x[0]+(-0.459788156475)*x[1]+(1.13249234657)*x[2]
        s[1,2]=(0.898608507221)*x[0]+(-0.46334527476)*x[1]+(-0.445291041098)*x[2]
        s[1,3]=(-0.327616894595)*x[0]+(-0.288577792837)*x[1]+(1.26565355504)*x[2]
        s[1,4]=(0.0630186390647)*x[0]+(-0.383734001362)*x[1]+(-0.116975162517)*x[2]
        s[2,0]=(-0.309394005751)*x[0]+(-0.12474002694)*x[1]+(0.699555331484)*x[2]
        s[2,1]=(0.997752898742)*x[0]+(-0.183982572346)*x[1]+(1.22982190192)*x[2]
        s[2,2]=(1.03496586697)*x[0]+(-0.097256212804)*x[1]+(1.42052511301)*x[2]
        s[2,3]=(0.614378729663)*x[0]+(0.154397435133)*x[1]+(-0.863004330742)*x[2]
        s[2,4]=(1.20904264903)*x[0]+(-0.452388361293)*x[1]+(-1.13286356474)*x[2]
        s[3,0]=(-0.812538381038)*x[0]+(0.00308372111735)*x[1]+(-0.117937095444)*x[2]
        s[3,1]=(0.45479320042)*x[0]+(-0.45927716926)*x[1]+(0.4787228586)*x[2]
        s[3,2]=(-0.487685328452)*x[0]+(0.871241301367)*x[1]+(0.78769505788)*x[2]
        s[3,3]=(0.860788048428)*x[0]+(1.39676274038)*x[1]+(0.407326483464)*x[2]
        s[3,4]=(0.00409247820271)*x[0]+(0.44466332801)*x[1]+(-0.66721280275)*x[2]
        ref[0,0,0]=(1.12878816262)
        ref[0,0,1]=(-1.74114589021)
        ref[0,0,2]=(0.248765786072)
        ref[0,1,0]=(1.72583176211)
        ref[0,1,1]=(-1.23114549996)
        ref[0,1,2]=(-0.203157732085)
        ref[0,2,0]=(-0.422314546839)
        ref[0,2,1]=(0.224260123741)
        ref[0,2,2]=(0.171252253031)
        ref[0,3,0]=(-0.870712689882)
        ref[0,3,1]=(-0.555793590179)
        ref[0,3,2]=(0.290927600809)
        ref[0,4,0]=(-0.920833142524)
        ref[0,4,1]=(-0.0497652513943)
        ref[0,4,2]=(-0.39718342747)
        ref[1,0,0]=(-0.727450597273)
        ref[1,0,1]=(1.09323195342)
        ref[1,0,2]=(0.298478430357)
        ref[1,1,0]=(0.12608256775)
        ref[1,1,1]=(-0.459788156475)
        ref[1,1,2]=(1.13249234657)
        ref[1,2,0]=(0.898608507221)
        ref[1,2,1]=(-0.46334527476)
        ref[1,2,2]=(-0.445291041098)
        ref[1,3,0]=(-0.327616894595)
        ref[1,3,1]=(-0.288577792837)
        ref[1,3,2]=(1.26565355504)
        ref[1,4,0]=(0.0630186390647)
        ref[1,4,1]=(-0.383734001362)
        ref[1,4,2]=(-0.116975162517)
        ref[2,0,0]=(-0.309394005751)
        ref[2,0,1]=(-0.12474002694)
        ref[2,0,2]=(0.699555331484)
        ref[2,1,0]=(0.997752898742)
        ref[2,1,1]=(-0.183982572346)
        ref[2,1,2]=(1.22982190192)
        ref[2,2,0]=(1.03496586697)
        ref[2,2,1]=(-0.097256212804)
        ref[2,2,2]=(1.42052511301)
        ref[2,3,0]=(0.614378729663)
        ref[2,3,1]=(0.154397435133)
        ref[2,3,2]=(-0.863004330742)
        ref[2,4,0]=(1.20904264903)
        ref[2,4,1]=(-0.452388361293)
        ref[2,4,2]=(-1.13286356474)
        ref[3,0,0]=(-0.812538381038)
        ref[3,0,1]=(0.00308372111735)
        ref[3,0,2]=(-0.117937095444)
        ref[3,1,0]=(0.45479320042)
        ref[3,1,1]=(-0.45927716926)
        ref[3,1,2]=(0.4787228586)
        ref[3,2,0]=(-0.487685328452)
        ref[3,2,1]=(0.871241301367)
        ref[3,2,2]=(0.78769505788)
        ref[3,3,0]=(0.860788048428)
        ref[3,3,1]=(1.39676274038)
        ref[3,3,2]=(0.407326483464)
        ref[3,4,0]=(0.00409247820271)
        ref[3,4,1]=(0.44466332801)
        ref[3,4,2]=(-0.66721280275)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnBoundary_fromSymbol_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnBoundary

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnBoundary
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnBoundary(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(-0.905736881137)*x[0]+(0.694861875477)*x[1]
        s[0,0,1]=(-1.45890910436)*x[0]+(-1.52565465047)*x[1]
        s[0,1,0]=(-0.312122938001)*x[0]+(-0.868878770447)*x[1]
        s[0,1,1]=(1.54725692119)*x[0]+(0.536122055612)*x[1]
        s[1,0,0]=(0.196190980599)*x[0]+(0.328328643332)*x[1]
        s[1,0,1]=(-1.08863159071)*x[0]+(-1.33920996273)*x[1]
        s[1,1,0]=(1.73274170273)*x[0]+(-0.958793175994)*x[1]
        s[1,1,1]=(0.182836505159)*x[0]+(-0.121541234518)*x[1]
        s[2,0,0]=(0.144461277784)*x[0]+(1.83781976673)*x[1]
        s[2,0,1]=(-0.194587892421)*x[0]+(-1.27090147949)*x[1]
        s[2,1,0]=(0.379488182396)*x[0]+(0.030493966182)*x[1]
        s[2,1,1]=(1.09003510354)*x[0]+(-0.454578719663)*x[1]
        s[3,0,0]=(1.58446081096)*x[0]+(-0.52113508443)*x[1]
        s[3,0,1]=(-1.33593796269)*x[0]+(-0.165961948897)*x[1]
        s[3,1,0]=(0.377402371367)*x[0]+(-0.0184973476961)*x[1]
        s[3,1,1]=(0.764313855665)*x[0]+(0.294443818887)*x[1]
        s[4,0,0]=(-0.180639063236)*x[0]+(1.75864081648)*x[1]
        s[4,0,1]=(-1.62662138708)*x[0]+(1.81611541058)*x[1]
        s[4,1,0]=(1.37678767999)*x[0]+(-0.271115982236)*x[1]
        s[4,1,1]=(1.32861834819)*x[0]+(0.768596947238)*x[1]
        s[5,0,0]=(1.39342920577)*x[0]+(0.155666506926)*x[1]
        s[5,0,1]=(0.0397474261373)*x[0]+(0.921852245407)*x[1]
        s[5,1,0]=(-0.950337694161)*x[0]+(-0.011042822071)*x[1]
        s[5,1,1]=(0.0369412335225)*x[0]+(-0.473468894798)*x[1]
        ref[0,0,0,0]=(-0.905736881137)
        ref[0,0,0,1]=(0.694861875477)
        ref[0,0,1,0]=(-1.45890910436)
        ref[0,0,1,1]=(-1.52565465047)
        ref[0,1,0,0]=(-0.312122938001)
        ref[0,1,0,1]=(-0.868878770447)
        ref[0,1,1,0]=(1.54725692119)
        ref[0,1,1,1]=(0.536122055612)
        ref[1,0,0,0]=(0.196190980599)
        ref[1,0,0,1]=(0.328328643332)
        ref[1,0,1,0]=(-1.08863159071)
        ref[1,0,1,1]=(-1.33920996273)
        ref[1,1,0,0]=(1.73274170273)
        ref[1,1,0,1]=(-0.958793175994)
        ref[1,1,1,0]=(0.182836505159)
        ref[1,1,1,1]=(-0.121541234518)
        ref[2,0,0,0]=(0.144461277784)
        ref[2,0,0,1]=(1.83781976673)
        ref[2,0,1,0]=(-0.194587892421)
        ref[2,0,1,1]=(-1.27090147949)
        ref[2,1,0,0]=(0.379488182396)
        ref[2,1,0,1]=(0.030493966182)
        ref[2,1,1,0]=(1.09003510354)
        ref[2,1,1,1]=(-0.454578719663)
        ref[3,0,0,0]=(1.58446081096)
        ref[3,0,0,1]=(-0.52113508443)
        ref[3,0,1,0]=(-1.33593796269)
        ref[3,0,1,1]=(-0.165961948897)
        ref[3,1,0,0]=(0.377402371367)
        ref[3,1,0,1]=(-0.0184973476961)
        ref[3,1,1,0]=(0.764313855665)
        ref[3,1,1,1]=(0.294443818887)
        ref[4,0,0,0]=(-0.180639063236)
        ref[4,0,0,1]=(1.75864081648)
        ref[4,0,1,0]=(-1.62662138708)
        ref[4,0,1,1]=(1.81611541058)
        ref[4,1,0,0]=(1.37678767999)
        ref[4,1,0,1]=(-0.271115982236)
        ref[4,1,1,0]=(1.32861834819)
        ref[4,1,1,1]=(0.768596947238)
        ref[5,0,0,0]=(1.39342920577)
        ref[5,0,0,1]=(0.155666506926)
        ref[5,0,1,0]=(0.0397474261373)
        ref[5,0,1,1]=(0.921852245407)
        ref[5,1,0,0]=(-0.950337694161)
        ref[5,1,0,1]=(-0.011042822071)
        ref[5,1,1,0]=(0.0369412335225)
        ref[5,1,1,1]=(-0.473468894798)
      else:
        s[0,0,0]=(0.0887916493027)*x[0]+(-0.648868378605)*x[1]+(-0.0728819090295)*x[2]
        s[0,0,1]=(-1.41771256969)*x[0]+(-1.5907790724)*x[1]+(-0.208960186234)*x[2]
        s[0,1,0]=(-0.846039306108)*x[0]+(0.451942850498)*x[1]+(-0.305613220999)*x[2]
        s[0,1,1]=(-0.990248401344)*x[0]+(0.934658804462)*x[1]+(0.703927399604)*x[2]
        s[1,0,0]=(0.0172966310708)*x[0]+(-0.097716216369)*x[1]+(0.564328624475)*x[2]
        s[1,0,1]=(-0.285571273779)*x[0]+(-0.478508810269)*x[1]+(0.713694990763)*x[2]
        s[1,1,0]=(-1.72203517221)*x[0]+(0.90209571161)*x[1]+(0.0404190111547)*x[2]
        s[1,1,1]=(0.662367771483)*x[0]+(0.683618857708)*x[1]+(0.220237165119)*x[2]
        s[2,0,0]=(-1.23109104652)*x[0]+(-0.344954703402)*x[1]+(-0.845700366118)*x[2]
        s[2,0,1]=(-1.78196237278)*x[0]+(0.352288083535)*x[1]+(1.02993741657)*x[2]
        s[2,1,0]=(-0.101867429012)*x[0]+(-0.810130865002)*x[1]+(0.682007840621)*x[2]
        s[2,1,1]=(0.424977434864)*x[0]+(-0.193692196905)*x[1]+(1.40079084873)*x[2]
        s[3,0,0]=(0.471393445911)*x[0]+(-0.56961804428)*x[1]+(1.1096657312)*x[2]
        s[3,0,1]=(1.09919079441)*x[0]+(1.82571072835)*x[1]+(0.604299398913)*x[2]
        s[3,1,0]=(0.155938760923)*x[0]+(0.841141932215)*x[1]+(0.558240114855)*x[2]
        s[3,1,1]=(-0.0697992380617)*x[0]+(1.28687270053)*x[1]+(-1.65036825798)*x[2]
        s[4,0,0]=(-0.497902210966)*x[0]+(0.495675372467)*x[1]+(1.4729295959)*x[2]
        s[4,0,1]=(-0.278468085457)*x[0]+(0.515340965551)*x[1]+(-0.233864738508)*x[2]
        s[4,1,0]=(0.574455672589)*x[0]+(-1.41224801693)*x[1]+(-0.0851508668768)*x[2]
        s[4,1,1]=(-0.392015012986)*x[0]+(0.211411943089)*x[1]+(0.175695876916)*x[2]
        s[5,0,0]=(-1.3317854233)*x[0]+(1.30129857885)*x[1]+(-0.96126616548)*x[2]
        s[5,0,1]=(-1.00763984246)*x[0]+(0.252485810112)*x[1]+(0.0349533247409)*x[2]
        s[5,1,0]=(1.23304668416)*x[0]+(0.978792435109)*x[1]+(0.0784889665787)*x[2]
        s[5,1,1]=(-0.164813552675)*x[0]+(0.363900322694)*x[1]+(-0.388851362667)*x[2]
        ref[0,0,0,0]=(0.0887916493027)
        ref[0,0,0,1]=(-0.648868378605)
        ref[0,0,0,2]=(-0.0728819090295)
        ref[0,0,1,0]=(-1.41771256969)
        ref[0,0,1,1]=(-1.5907790724)
        ref[0,0,1,2]=(-0.208960186234)
        ref[0,1,0,0]=(-0.846039306108)
        ref[0,1,0,1]=(0.451942850498)
        ref[0,1,0,2]=(-0.305613220999)
        ref[0,1,1,0]=(-0.990248401344)
        ref[0,1,1,1]=(0.934658804462)
        ref[0,1,1,2]=(0.703927399604)
        ref[1,0,0,0]=(0.0172966310708)
        ref[1,0,0,1]=(-0.097716216369)
        ref[1,0,0,2]=(0.564328624475)
        ref[1,0,1,0]=(-0.285571273779)
        ref[1,0,1,1]=(-0.478508810269)
        ref[1,0,1,2]=(0.713694990763)
        ref[1,1,0,0]=(-1.72203517221)
        ref[1,1,0,1]=(0.90209571161)
        ref[1,1,0,2]=(0.0404190111547)
        ref[1,1,1,0]=(0.662367771483)
        ref[1,1,1,1]=(0.683618857708)
        ref[1,1,1,2]=(0.220237165119)
        ref[2,0,0,0]=(-1.23109104652)
        ref[2,0,0,1]=(-0.344954703402)
        ref[2,0,0,2]=(-0.845700366118)
        ref[2,0,1,0]=(-1.78196237278)
        ref[2,0,1,1]=(0.352288083535)
        ref[2,0,1,2]=(1.02993741657)
        ref[2,1,0,0]=(-0.101867429012)
        ref[2,1,0,1]=(-0.810130865002)
        ref[2,1,0,2]=(0.682007840621)
        ref[2,1,1,0]=(0.424977434864)
        ref[2,1,1,1]=(-0.193692196905)
        ref[2,1,1,2]=(1.40079084873)
        ref[3,0,0,0]=(0.471393445911)
        ref[3,0,0,1]=(-0.56961804428)
        ref[3,0,0,2]=(1.1096657312)
        ref[3,0,1,0]=(1.09919079441)
        ref[3,0,1,1]=(1.82571072835)
        ref[3,0,1,2]=(0.604299398913)
        ref[3,1,0,0]=(0.155938760923)
        ref[3,1,0,1]=(0.841141932215)
        ref[3,1,0,2]=(0.558240114855)
        ref[3,1,1,0]=(-0.0697992380617)
        ref[3,1,1,1]=(1.28687270053)
        ref[3,1,1,2]=(-1.65036825798)
        ref[4,0,0,0]=(-0.497902210966)
        ref[4,0,0,1]=(0.495675372467)
        ref[4,0,0,2]=(1.4729295959)
        ref[4,0,1,0]=(-0.278468085457)
        ref[4,0,1,1]=(0.515340965551)
        ref[4,0,1,2]=(-0.233864738508)
        ref[4,1,0,0]=(0.574455672589)
        ref[4,1,0,1]=(-1.41224801693)
        ref[4,1,0,2]=(-0.0851508668768)
        ref[4,1,1,0]=(-0.392015012986)
        ref[4,1,1,1]=(0.211411943089)
        ref[4,1,1,2]=(0.175695876916)
        ref[5,0,0,0]=(-1.3317854233)
        ref[5,0,0,1]=(1.30129857885)
        ref[5,0,0,2]=(-0.96126616548)
        ref[5,0,1,0]=(-1.00763984246)
        ref[5,0,1,1]=(0.252485810112)
        ref[5,0,1,2]=(0.0349533247409)
        ref[5,1,0,0]=(1.23304668416)
        ref[5,1,0,1]=(0.978792435109)
        ref[5,1,0,2]=(0.0784889665787)
        ref[5,1,1,0]=(-0.164813552675)
        ref[5,1,1,1]=(0.363900322694)
        ref[5,1,1,2]=(-0.388851362667)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(-0.447987377779)*x[0]**o+(-0.3185298109)*x[0]+(0.748689324197)*x[1]**o+(-0.979369398128)*x[1]
        ref[0]=o*(-0.447987377779)*x_ref[0]**(o-1)+(-0.3185298109)
        ref[1]=o*(0.748689324197)*x_ref[1]**(o-1)+(-0.979369398128)
      else:
        arg=(-0.991175677257)*x[0]**o+(0.486310659385)*x[0]+(0.366862476014)*x[1]**o+(0.718311286349)*x[1]+(-0.593137377946)*x[2]**o+(-0.98259729892)*x[2]
        ref[0]=o*(-0.991175677257)*x_ref[0]**(o-1)+(0.486310659385)
        ref[1]=o*(0.366862476014)*x_ref[1]**(o-1)+(0.718311286349)
        ref[2]=o*(-0.593137377946)*x_ref[2]**(o-1)+(-0.98259729892)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(0.532427358862)*x[0]**o+(-0.699829406888)*x[0]+(-0.378181075858)*x[1]**o+(-0.163897932934)*x[1]
        arg[1]=(0.76393225396)*x[0]**o+(0.87331212216)*x[0]+(0.0261520274749)*x[1]**o+(-0.475078274702)*x[1]
        ref[0,0]=o*(0.532427358862)*x_ref[0]**(o-1)+(-0.699829406888)
        ref[0,1]=o*(-0.378181075858)*x_ref[1]**(o-1)+(-0.163897932934)
        ref[1,0]=o*(0.76393225396)*x_ref[0]**(o-1)+(0.87331212216)
        ref[1,1]=o*(0.0261520274749)*x_ref[1]**(o-1)+(-0.475078274702)
      else:
        arg[0]=(-0.559640148983)*x[0]**o+(0.868360358061)*x[0]+(0.148807680806)*x[1]**o+(-0.488426629736)*x[1]+(0.99381766343)*x[2]**o+(-0.0241703848022)*x[2]
        arg[1]=(-0.00270447073555)*x[0]**o+(0.599732416474)*x[0]+(-0.455449579349)*x[1]**o+(-0.791088816655)*x[1]+(0.850362671968)*x[2]**o+(-0.180726138889)*x[2]
        ref[0,0]=o*(-0.559640148983)*x_ref[0]**(o-1)+(0.868360358061)
        ref[0,1]=o*(0.148807680806)*x_ref[1]**(o-1)+(-0.488426629736)
        ref[0,2]=o*(0.99381766343)*x_ref[2]**(o-1)+(-0.0241703848022)
        ref[1,0]=o*(-0.00270447073555)*x_ref[0]**(o-1)+(0.599732416474)
        ref[1,1]=o*(-0.455449579349)*x_ref[1]**(o-1)+(-0.791088816655)
        ref[1,2]=o*(0.850362671968)*x_ref[2]**(o-1)+(-0.180726138889)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.157399152858)*x[0]**o+(0.00598352783814)*x[0]+(-0.904853822462)*x[1]**o+(0.767645769461)*x[1]
        arg[0,1]=(0.764556091331)*x[0]**o+(-0.167733604181)*x[0]+(0.723254547109)*x[1]**o+(-0.863633737324)*x[1]
        arg[0,2]=(0.480913138549)*x[0]**o+(0.505712705322)*x[0]+(-0.295398027463)*x[1]**o+(-0.0497846093953)*x[1]
        arg[0,3]=(-0.957208239652)*x[0]**o+(0.608346818502)*x[0]+(-0.194623401251)*x[1]**o+(0.670671588806)*x[1]
        arg[0,4]=(-0.179165159786)*x[0]**o+(-0.146090255471)*x[0]+(-0.413009197676)*x[1]**o+(-0.168508218849)*x[1]
        arg[1,0]=(0.659914628278)*x[0]**o+(0.123177996909)*x[0]+(0.713971230628)*x[1]**o+(-0.687569461154)*x[1]
        arg[1,1]=(0.857554477911)*x[0]**o+(0.119604916634)*x[0]+(-0.123185856515)*x[1]**o+(0.968800869965)*x[1]
        arg[1,2]=(0.566596883167)*x[0]**o+(-0.667227639224)*x[0]+(0.29838343622)*x[1]**o+(0.0172896834006)*x[1]
        arg[1,3]=(0.340418732306)*x[0]**o+(-0.115031635126)*x[0]+(0.212495048781)*x[1]**o+(-0.690939141829)*x[1]
        arg[1,4]=(-0.513225187356)*x[0]**o+(0.975159534619)*x[0]+(0.159694719764)*x[1]**o+(-0.441973185517)*x[1]
        arg[2,0]=(0.00598247134499)*x[0]**o+(-0.680866157243)*x[0]+(0.198740044836)*x[1]**o+(-0.776778848701)*x[1]
        arg[2,1]=(0.385572341196)*x[0]**o+(-0.911229388405)*x[0]+(-0.869563350649)*x[1]**o+(-0.453073292811)*x[1]
        arg[2,2]=(-0.678405510051)*x[0]**o+(0.570159849365)*x[0]+(-0.998909274112)*x[1]**o+(-0.56867397999)*x[1]
        arg[2,3]=(0.592650344218)*x[0]**o+(-0.990760992864)*x[0]+(0.54832364584)*x[1]**o+(-0.62848423403)*x[1]
        arg[2,4]=(-0.267222595774)*x[0]**o+(-0.398631721649)*x[0]+(-0.139351142788)*x[1]**o+(-0.973211734322)*x[1]
        arg[3,0]=(-0.748270220449)*x[0]**o+(-0.432648285296)*x[0]+(-0.572322019432)*x[1]**o+(-0.361258377472)*x[1]
        arg[3,1]=(-0.872970937458)*x[0]**o+(-0.412714429527)*x[0]+(0.28965384698)*x[1]**o+(0.0899128505144)*x[1]
        arg[3,2]=(-0.448552675711)*x[0]**o+(-0.0531593149976)*x[0]+(-0.445359129375)*x[1]**o+(-0.357551800127)*x[1]
        arg[3,3]=(-0.120676057603)*x[0]**o+(-0.736959379114)*x[0]+(-0.437089829553)*x[1]**o+(-0.272117257464)*x[1]
        arg[3,4]=(0.342279309395)*x[0]**o+(0.182206506048)*x[0]+(0.843948330758)*x[1]**o+(0.165354303251)*x[1]
        ref[0,0,0]=o*(0.157399152858)*x_ref[0]**(o-1)+(0.00598352783814)
        ref[0,0,1]=o*(-0.904853822462)*x_ref[1]**(o-1)+(0.767645769461)
        ref[0,1,0]=o*(0.764556091331)*x_ref[0]**(o-1)+(-0.167733604181)
        ref[0,1,1]=o*(0.723254547109)*x_ref[1]**(o-1)+(-0.863633737324)
        ref[0,2,0]=o*(0.480913138549)*x_ref[0]**(o-1)+(0.505712705322)
        ref[0,2,1]=o*(-0.295398027463)*x_ref[1]**(o-1)+(-0.0497846093953)
        ref[0,3,0]=o*(-0.957208239652)*x_ref[0]**(o-1)+(0.608346818502)
        ref[0,3,1]=o*(-0.194623401251)*x_ref[1]**(o-1)+(0.670671588806)
        ref[0,4,0]=o*(-0.179165159786)*x_ref[0]**(o-1)+(-0.146090255471)
        ref[0,4,1]=o*(-0.413009197676)*x_ref[1]**(o-1)+(-0.168508218849)
        ref[1,0,0]=o*(0.659914628278)*x_ref[0]**(o-1)+(0.123177996909)
        ref[1,0,1]=o*(0.713971230628)*x_ref[1]**(o-1)+(-0.687569461154)
        ref[1,1,0]=o*(0.857554477911)*x_ref[0]**(o-1)+(0.119604916634)
        ref[1,1,1]=o*(-0.123185856515)*x_ref[1]**(o-1)+(0.968800869965)
        ref[1,2,0]=o*(0.566596883167)*x_ref[0]**(o-1)+(-0.667227639224)
        ref[1,2,1]=o*(0.29838343622)*x_ref[1]**(o-1)+(0.0172896834006)
        ref[1,3,0]=o*(0.340418732306)*x_ref[0]**(o-1)+(-0.115031635126)
        ref[1,3,1]=o*(0.212495048781)*x_ref[1]**(o-1)+(-0.690939141829)
        ref[1,4,0]=o*(-0.513225187356)*x_ref[0]**(o-1)+(0.975159534619)
        ref[1,4,1]=o*(0.159694719764)*x_ref[1]**(o-1)+(-0.441973185517)
        ref[2,0,0]=o*(0.00598247134499)*x_ref[0]**(o-1)+(-0.680866157243)
        ref[2,0,1]=o*(0.198740044836)*x_ref[1]**(o-1)+(-0.776778848701)
        ref[2,1,0]=o*(0.385572341196)*x_ref[0]**(o-1)+(-0.911229388405)
        ref[2,1,1]=o*(-0.869563350649)*x_ref[1]**(o-1)+(-0.453073292811)
        ref[2,2,0]=o*(-0.678405510051)*x_ref[0]**(o-1)+(0.570159849365)
        ref[2,2,1]=o*(-0.998909274112)*x_ref[1]**(o-1)+(-0.56867397999)
        ref[2,3,0]=o*(0.592650344218)*x_ref[0]**(o-1)+(-0.990760992864)
        ref[2,3,1]=o*(0.54832364584)*x_ref[1]**(o-1)+(-0.62848423403)
        ref[2,4,0]=o*(-0.267222595774)*x_ref[0]**(o-1)+(-0.398631721649)
        ref[2,4,1]=o*(-0.139351142788)*x_ref[1]**(o-1)+(-0.973211734322)
        ref[3,0,0]=o*(-0.748270220449)*x_ref[0]**(o-1)+(-0.432648285296)
        ref[3,0,1]=o*(-0.572322019432)*x_ref[1]**(o-1)+(-0.361258377472)
        ref[3,1,0]=o*(-0.872970937458)*x_ref[0]**(o-1)+(-0.412714429527)
        ref[3,1,1]=o*(0.28965384698)*x_ref[1]**(o-1)+(0.0899128505144)
        ref[3,2,0]=o*(-0.448552675711)*x_ref[0]**(o-1)+(-0.0531593149976)
        ref[3,2,1]=o*(-0.445359129375)*x_ref[1]**(o-1)+(-0.357551800127)
        ref[3,3,0]=o*(-0.120676057603)*x_ref[0]**(o-1)+(-0.736959379114)
        ref[3,3,1]=o*(-0.437089829553)*x_ref[1]**(o-1)+(-0.272117257464)
        ref[3,4,0]=o*(0.342279309395)*x_ref[0]**(o-1)+(0.182206506048)
        ref[3,4,1]=o*(0.843948330758)*x_ref[1]**(o-1)+(0.165354303251)
      else:
        arg[0,0]=(-0.912611504385)*x[0]**o+(0.730660242466)*x[0]+(-0.807306513948)*x[1]**o+(-0.611619910819)*x[1]+(-0.567616988907)*x[2]**o+(0.554411283236)*x[2]
        arg[0,1]=(-0.900956431107)*x[0]**o+(-0.731441474835)*x[0]+(0.366905510731)*x[1]**o+(0.444763254457)*x[1]+(0.223337203463)*x[2]**o+(0.0823258304577)*x[2]
        arg[0,2]=(-0.300262400629)*x[0]**o+(0.781835992318)*x[0]+(-0.961025746467)*x[1]**o+(-0.0255420888548)*x[1]+(-0.195336914392)*x[2]**o+(0.631006440014)*x[2]
        arg[0,3]=(-0.0362225627667)*x[0]**o+(-0.258309391935)*x[0]+(0.915114590957)*x[1]**o+(-0.0261151730116)*x[1]+(-0.0359136191693)*x[2]**o+(0.34837541797)*x[2]
        arg[0,4]=(0.718483283111)*x[0]**o+(-0.981945434022)*x[0]+(0.715616160215)*x[1]**o+(-0.213673997408)*x[1]+(0.703864386687)*x[2]**o+(-0.258970624794)*x[2]
        arg[1,0]=(0.562339421788)*x[0]**o+(-0.469800316995)*x[0]+(-0.58860202695)*x[1]**o+(0.592493291759)*x[1]+(-0.0747446509827)*x[2]**o+(0.459846703357)*x[2]
        arg[1,1]=(-0.739792007188)*x[0]**o+(0.69804646711)*x[0]+(0.685574577582)*x[1]**o+(0.34906822136)*x[1]+(-0.346626103556)*x[2]**o+(-0.186290616908)*x[2]
        arg[1,2]=(0.605479936712)*x[0]**o+(0.23811484281)*x[0]+(-0.18270059933)*x[1]**o+(-0.883573478283)*x[1]+(0.558417469124)*x[2]**o+(0.0921284647122)*x[2]
        arg[1,3]=(0.829453952054)*x[0]**o+(0.0943225421949)*x[0]+(-0.377472410614)*x[1]**o+(0.422596289908)*x[1]+(0.992700203574)*x[2]**o+(0.954704595957)*x[2]
        arg[1,4]=(0.713437745608)*x[0]**o+(-0.90755469394)*x[0]+(-0.116969245983)*x[1]**o+(-0.615609779318)*x[1]+(-0.631014272933)*x[2]**o+(0.196556707186)*x[2]
        arg[2,0]=(-0.643142569205)*x[0]**o+(-0.522571508238)*x[0]+(-0.221094875426)*x[1]**o+(0.00263621704394)*x[1]+(-0.346088170378)*x[2]**o+(-0.323346603492)*x[2]
        arg[2,1]=(0.121192120404)*x[0]**o+(-0.910581465748)*x[0]+(0.661403514322)*x[1]**o+(0.314356472557)*x[1]+(0.740349932503)*x[2]**o+(0.397923840477)*x[2]
        arg[2,2]=(0.712887835251)*x[0]**o+(0.802827824977)*x[0]+(0.225275507294)*x[1]**o+(0.00655056099106)*x[1]+(-0.0211189465513)*x[2]**o+(-0.672450969446)*x[2]
        arg[2,3]=(0.220976204507)*x[0]**o+(0.384529933174)*x[0]+(-0.824967564367)*x[1]**o+(0.382079183434)*x[1]+(0.975192346085)*x[2]**o+(-0.845325222223)*x[2]
        arg[2,4]=(-0.316551069119)*x[0]**o+(0.194934627874)*x[0]+(0.192096230967)*x[1]**o+(-0.423775967466)*x[1]+(-0.669140845203)*x[2]**o+(0.367813824992)*x[2]
        arg[3,0]=(-0.361410077778)*x[0]**o+(0.377521588398)*x[0]+(-0.795093364568)*x[1]**o+(0.475257686757)*x[1]+(-0.996619080341)*x[2]**o+(-0.909105543506)*x[2]
        arg[3,1]=(-0.324100979259)*x[0]**o+(-0.950807456193)*x[0]+(-0.141687301441)*x[1]**o+(0.153568029515)*x[1]+(-0.698514966417)*x[2]**o+(0.312395968777)*x[2]
        arg[3,2]=(-0.997783460035)*x[0]**o+(0.328724967881)*x[0]+(-0.561572087716)*x[1]**o+(-0.0148890799876)*x[1]+(0.236142454998)*x[2]**o+(-0.36513107554)*x[2]
        arg[3,3]=(0.750818510719)*x[0]**o+(-0.484598204959)*x[0]+(-0.599436804638)*x[1]**o+(-0.236232976078)*x[1]+(-0.0789148183785)*x[2]**o+(-0.74437164566)*x[2]
        arg[3,4]=(-0.730664688591)*x[0]**o+(-0.94753100979)*x[0]+(-0.671463334034)*x[1]**o+(-0.139992464354)*x[1]+(0.286757519111)*x[2]**o+(0.512453551537)*x[2]
        ref[0,0,0]=o*(-0.912611504385)*x_ref[0]**(o-1)+(0.730660242466)
        ref[0,0,1]=o*(-0.807306513948)*x_ref[1]**(o-1)+(-0.611619910819)
        ref[0,0,2]=o*(-0.567616988907)*x_ref[2]**(o-1)+(0.554411283236)
        ref[0,1,0]=o*(-0.900956431107)*x_ref[0]**(o-1)+(-0.731441474835)
        ref[0,1,1]=o*(0.366905510731)*x_ref[1]**(o-1)+(0.444763254457)
        ref[0,1,2]=o*(0.223337203463)*x_ref[2]**(o-1)+(0.0823258304577)
        ref[0,2,0]=o*(-0.300262400629)*x_ref[0]**(o-1)+(0.781835992318)
        ref[0,2,1]=o*(-0.961025746467)*x_ref[1]**(o-1)+(-0.0255420888548)
        ref[0,2,2]=o*(-0.195336914392)*x_ref[2]**(o-1)+(0.631006440014)
        ref[0,3,0]=o*(-0.0362225627667)*x_ref[0]**(o-1)+(-0.258309391935)
        ref[0,3,1]=o*(0.915114590957)*x_ref[1]**(o-1)+(-0.0261151730116)
        ref[0,3,2]=o*(-0.0359136191693)*x_ref[2]**(o-1)+(0.34837541797)
        ref[0,4,0]=o*(0.718483283111)*x_ref[0]**(o-1)+(-0.981945434022)
        ref[0,4,1]=o*(0.715616160215)*x_ref[1]**(o-1)+(-0.213673997408)
        ref[0,4,2]=o*(0.703864386687)*x_ref[2]**(o-1)+(-0.258970624794)
        ref[1,0,0]=o*(0.562339421788)*x_ref[0]**(o-1)+(-0.469800316995)
        ref[1,0,1]=o*(-0.58860202695)*x_ref[1]**(o-1)+(0.592493291759)
        ref[1,0,2]=o*(-0.0747446509827)*x_ref[2]**(o-1)+(0.459846703357)
        ref[1,1,0]=o*(-0.739792007188)*x_ref[0]**(o-1)+(0.69804646711)
        ref[1,1,1]=o*(0.685574577582)*x_ref[1]**(o-1)+(0.34906822136)
        ref[1,1,2]=o*(-0.346626103556)*x_ref[2]**(o-1)+(-0.186290616908)
        ref[1,2,0]=o*(0.605479936712)*x_ref[0]**(o-1)+(0.23811484281)
        ref[1,2,1]=o*(-0.18270059933)*x_ref[1]**(o-1)+(-0.883573478283)
        ref[1,2,2]=o*(0.558417469124)*x_ref[2]**(o-1)+(0.0921284647122)
        ref[1,3,0]=o*(0.829453952054)*x_ref[0]**(o-1)+(0.0943225421949)
        ref[1,3,1]=o*(-0.377472410614)*x_ref[1]**(o-1)+(0.422596289908)
        ref[1,3,2]=o*(0.992700203574)*x_ref[2]**(o-1)+(0.954704595957)
        ref[1,4,0]=o*(0.713437745608)*x_ref[0]**(o-1)+(-0.90755469394)
        ref[1,4,1]=o*(-0.116969245983)*x_ref[1]**(o-1)+(-0.615609779318)
        ref[1,4,2]=o*(-0.631014272933)*x_ref[2]**(o-1)+(0.196556707186)
        ref[2,0,0]=o*(-0.643142569205)*x_ref[0]**(o-1)+(-0.522571508238)
        ref[2,0,1]=o*(-0.221094875426)*x_ref[1]**(o-1)+(0.00263621704394)
        ref[2,0,2]=o*(-0.346088170378)*x_ref[2]**(o-1)+(-0.323346603492)
        ref[2,1,0]=o*(0.121192120404)*x_ref[0]**(o-1)+(-0.910581465748)
        ref[2,1,1]=o*(0.661403514322)*x_ref[1]**(o-1)+(0.314356472557)
        ref[2,1,2]=o*(0.740349932503)*x_ref[2]**(o-1)+(0.397923840477)
        ref[2,2,0]=o*(0.712887835251)*x_ref[0]**(o-1)+(0.802827824977)
        ref[2,2,1]=o*(0.225275507294)*x_ref[1]**(o-1)+(0.00655056099106)
        ref[2,2,2]=o*(-0.0211189465513)*x_ref[2]**(o-1)+(-0.672450969446)
        ref[2,3,0]=o*(0.220976204507)*x_ref[0]**(o-1)+(0.384529933174)
        ref[2,3,1]=o*(-0.824967564367)*x_ref[1]**(o-1)+(0.382079183434)
        ref[2,3,2]=o*(0.975192346085)*x_ref[2]**(o-1)+(-0.845325222223)
        ref[2,4,0]=o*(-0.316551069119)*x_ref[0]**(o-1)+(0.194934627874)
        ref[2,4,1]=o*(0.192096230967)*x_ref[1]**(o-1)+(-0.423775967466)
        ref[2,4,2]=o*(-0.669140845203)*x_ref[2]**(o-1)+(0.367813824992)
        ref[3,0,0]=o*(-0.361410077778)*x_ref[0]**(o-1)+(0.377521588398)
        ref[3,0,1]=o*(-0.795093364568)*x_ref[1]**(o-1)+(0.475257686757)
        ref[3,0,2]=o*(-0.996619080341)*x_ref[2]**(o-1)+(-0.909105543506)
        ref[3,1,0]=o*(-0.324100979259)*x_ref[0]**(o-1)+(-0.950807456193)
        ref[3,1,1]=o*(-0.141687301441)*x_ref[1]**(o-1)+(0.153568029515)
        ref[3,1,2]=o*(-0.698514966417)*x_ref[2]**(o-1)+(0.312395968777)
        ref[3,2,0]=o*(-0.997783460035)*x_ref[0]**(o-1)+(0.328724967881)
        ref[3,2,1]=o*(-0.561572087716)*x_ref[1]**(o-1)+(-0.0148890799876)
        ref[3,2,2]=o*(0.236142454998)*x_ref[2]**(o-1)+(-0.36513107554)
        ref[3,3,0]=o*(0.750818510719)*x_ref[0]**(o-1)+(-0.484598204959)
        ref[3,3,1]=o*(-0.599436804638)*x_ref[1]**(o-1)+(-0.236232976078)
        ref[3,3,2]=o*(-0.0789148183785)*x_ref[2]**(o-1)+(-0.74437164566)
        ref[3,4,0]=o*(-0.730664688591)*x_ref[0]**(o-1)+(-0.94753100979)
        ref[3,4,1]=o*(-0.671463334034)*x_ref[1]**(o-1)+(-0.139992464354)
        ref[3,4,2]=o*(0.286757519111)*x_ref[2]**(o-1)+(0.512453551537)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.467597203998)*x[0]**o+(-0.878331243959)*x[0]+(-0.971530784104)*x[1]**o+(0.685854853102)*x[1]
        arg[0,0,1]=(0.291345615954)*x[0]**o+(-0.745469654319)*x[0]+(0.976621664002)*x[1]**o+(-0.881452217847)*x[1]
        arg[0,1,0]=(0.537843295475)*x[0]**o+(0.489619951145)*x[0]+(0.77330251637)*x[1]**o+(0.998031266089)*x[1]
        arg[0,1,1]=(0.355984068681)*x[0]**o+(-0.814720548776)*x[0]+(0.495564264626)*x[1]**o+(0.525926194911)*x[1]
        arg[1,0,0]=(0.0459062782507)*x[0]**o+(0.745363380399)*x[0]+(0.254962338793)*x[1]**o+(-0.818268107226)*x[1]
        arg[1,0,1]=(0.806972777032)*x[0]**o+(0.65759411882)*x[0]+(-0.714015350868)*x[1]**o+(0.785611067194)*x[1]
        arg[1,1,0]=(0.576206375389)*x[0]**o+(-0.502513595266)*x[0]+(0.258287392463)*x[1]**o+(0.0897418205816)*x[1]
        arg[1,1,1]=(-0.854645709831)*x[0]**o+(0.48910569315)*x[0]+(0.684503579045)*x[1]**o+(0.156890859871)*x[1]
        arg[2,0,0]=(-0.535650648427)*x[0]**o+(-0.189186476574)*x[0]+(-0.62891575537)*x[1]**o+(-0.37603690255)*x[1]
        arg[2,0,1]=(-0.153001902814)*x[0]**o+(0.028214773063)*x[0]+(-0.605102549169)*x[1]**o+(-0.566991398262)*x[1]
        arg[2,1,0]=(0.607976055886)*x[0]**o+(-0.247395663109)*x[0]+(0.424340230656)*x[1]**o+(0.210489427749)*x[1]
        arg[2,1,1]=(-0.513543937157)*x[0]**o+(0.345931529219)*x[0]+(0.893744279358)*x[1]**o+(-0.519602594857)*x[1]
        arg[3,0,0]=(-0.618812192169)*x[0]**o+(-0.897898654184)*x[0]+(-0.717700928924)*x[1]**o+(-0.21348885325)*x[1]
        arg[3,0,1]=(-0.582829504396)*x[0]**o+(-0.0726162868757)*x[0]+(0.366457797377)*x[1]**o+(0.479006714526)*x[1]
        arg[3,1,0]=(0.929143108169)*x[0]**o+(-0.302254589362)*x[0]+(-0.518817476772)*x[1]**o+(0.854860903894)*x[1]
        arg[3,1,1]=(-0.815422381361)*x[0]**o+(-0.183407261786)*x[0]+(0.841334455272)*x[1]**o+(-0.560841747647)*x[1]
        arg[4,0,0]=(0.746229089137)*x[0]**o+(-0.00173525360161)*x[0]+(0.729473923491)*x[1]**o+(-0.0152936558265)*x[1]
        arg[4,0,1]=(-0.0474071267025)*x[0]**o+(-0.380505263812)*x[0]+(0.166181839511)*x[1]**o+(-0.421069915995)*x[1]
        arg[4,1,0]=(-0.826801927705)*x[0]**o+(0.704799677183)*x[0]+(-0.0346961982898)*x[1]**o+(-0.401235214163)*x[1]
        arg[4,1,1]=(-0.973646144788)*x[0]**o+(0.469976655077)*x[0]+(-0.458846284633)*x[1]**o+(0.818397008807)*x[1]
        arg[5,0,0]=(0.155460716472)*x[0]**o+(-0.509095443426)*x[0]+(-0.0942934981524)*x[1]**o+(0.754087972651)*x[1]
        arg[5,0,1]=(-0.584172835053)*x[0]**o+(-0.904579020559)*x[0]+(0.156301832106)*x[1]**o+(0.169995805721)*x[1]
        arg[5,1,0]=(-0.424977437614)*x[0]**o+(0.244566550647)*x[0]+(-0.474400097866)*x[1]**o+(-0.315912223349)*x[1]
        arg[5,1,1]=(0.764961378837)*x[0]**o+(-0.83633430067)*x[0]+(-0.446378328981)*x[1]**o+(-0.278460992776)*x[1]
        ref[0,0,0,0]=o*(0.467597203998)*x_ref[0]**(o-1)+(-0.878331243959)
        ref[0,0,0,1]=o*(-0.971530784104)*x_ref[1]**(o-1)+(0.685854853102)
        ref[0,0,1,0]=o*(0.291345615954)*x_ref[0]**(o-1)+(-0.745469654319)
        ref[0,0,1,1]=o*(0.976621664002)*x_ref[1]**(o-1)+(-0.881452217847)
        ref[0,1,0,0]=o*(0.537843295475)*x_ref[0]**(o-1)+(0.489619951145)
        ref[0,1,0,1]=o*(0.77330251637)*x_ref[1]**(o-1)+(0.998031266089)
        ref[0,1,1,0]=o*(0.355984068681)*x_ref[0]**(o-1)+(-0.814720548776)
        ref[0,1,1,1]=o*(0.495564264626)*x_ref[1]**(o-1)+(0.525926194911)
        ref[1,0,0,0]=o*(0.0459062782507)*x_ref[0]**(o-1)+(0.745363380399)
        ref[1,0,0,1]=o*(0.254962338793)*x_ref[1]**(o-1)+(-0.818268107226)
        ref[1,0,1,0]=o*(0.806972777032)*x_ref[0]**(o-1)+(0.65759411882)
        ref[1,0,1,1]=o*(-0.714015350868)*x_ref[1]**(o-1)+(0.785611067194)
        ref[1,1,0,0]=o*(0.576206375389)*x_ref[0]**(o-1)+(-0.502513595266)
        ref[1,1,0,1]=o*(0.258287392463)*x_ref[1]**(o-1)+(0.0897418205816)
        ref[1,1,1,0]=o*(-0.854645709831)*x_ref[0]**(o-1)+(0.48910569315)
        ref[1,1,1,1]=o*(0.684503579045)*x_ref[1]**(o-1)+(0.156890859871)
        ref[2,0,0,0]=o*(-0.535650648427)*x_ref[0]**(o-1)+(-0.189186476574)
        ref[2,0,0,1]=o*(-0.62891575537)*x_ref[1]**(o-1)+(-0.37603690255)
        ref[2,0,1,0]=o*(-0.153001902814)*x_ref[0]**(o-1)+(0.028214773063)
        ref[2,0,1,1]=o*(-0.605102549169)*x_ref[1]**(o-1)+(-0.566991398262)
        ref[2,1,0,0]=o*(0.607976055886)*x_ref[0]**(o-1)+(-0.247395663109)
        ref[2,1,0,1]=o*(0.424340230656)*x_ref[1]**(o-1)+(0.210489427749)
        ref[2,1,1,0]=o*(-0.513543937157)*x_ref[0]**(o-1)+(0.345931529219)
        ref[2,1,1,1]=o*(0.893744279358)*x_ref[1]**(o-1)+(-0.519602594857)
        ref[3,0,0,0]=o*(-0.618812192169)*x_ref[0]**(o-1)+(-0.897898654184)
        ref[3,0,0,1]=o*(-0.717700928924)*x_ref[1]**(o-1)+(-0.21348885325)
        ref[3,0,1,0]=o*(-0.582829504396)*x_ref[0]**(o-1)+(-0.0726162868757)
        ref[3,0,1,1]=o*(0.366457797377)*x_ref[1]**(o-1)+(0.479006714526)
        ref[3,1,0,0]=o*(0.929143108169)*x_ref[0]**(o-1)+(-0.302254589362)
        ref[3,1,0,1]=o*(-0.518817476772)*x_ref[1]**(o-1)+(0.854860903894)
        ref[3,1,1,0]=o*(-0.815422381361)*x_ref[0]**(o-1)+(-0.183407261786)
        ref[3,1,1,1]=o*(0.841334455272)*x_ref[1]**(o-1)+(-0.560841747647)
        ref[4,0,0,0]=o*(0.746229089137)*x_ref[0]**(o-1)+(-0.00173525360161)
        ref[4,0,0,1]=o*(0.729473923491)*x_ref[1]**(o-1)+(-0.0152936558265)
        ref[4,0,1,0]=o*(-0.0474071267025)*x_ref[0]**(o-1)+(-0.380505263812)
        ref[4,0,1,1]=o*(0.166181839511)*x_ref[1]**(o-1)+(-0.421069915995)
        ref[4,1,0,0]=o*(-0.826801927705)*x_ref[0]**(o-1)+(0.704799677183)
        ref[4,1,0,1]=o*(-0.0346961982898)*x_ref[1]**(o-1)+(-0.401235214163)
        ref[4,1,1,0]=o*(-0.973646144788)*x_ref[0]**(o-1)+(0.469976655077)
        ref[4,1,1,1]=o*(-0.458846284633)*x_ref[1]**(o-1)+(0.818397008807)
        ref[5,0,0,0]=o*(0.155460716472)*x_ref[0]**(o-1)+(-0.509095443426)
        ref[5,0,0,1]=o*(-0.0942934981524)*x_ref[1]**(o-1)+(0.754087972651)
        ref[5,0,1,0]=o*(-0.584172835053)*x_ref[0]**(o-1)+(-0.904579020559)
        ref[5,0,1,1]=o*(0.156301832106)*x_ref[1]**(o-1)+(0.169995805721)
        ref[5,1,0,0]=o*(-0.424977437614)*x_ref[0]**(o-1)+(0.244566550647)
        ref[5,1,0,1]=o*(-0.474400097866)*x_ref[1]**(o-1)+(-0.315912223349)
        ref[5,1,1,0]=o*(0.764961378837)*x_ref[0]**(o-1)+(-0.83633430067)
        ref[5,1,1,1]=o*(-0.446378328981)*x_ref[1]**(o-1)+(-0.278460992776)
      else:
        arg[0,0,0]=(0.723756735151)*x[0]**o+(0.738121670547)*x[0]+(0.384835073242)*x[1]**o+(-0.997944909714)*x[1]+(0.271533052097)*x[2]**o+(-0.667680363953)*x[2]
        arg[0,0,1]=(-0.279804914835)*x[0]**o+(0.789671404386)*x[0]+(-0.823187173328)*x[1]**o+(-0.0126377581755)*x[1]+(-0.942836469998)*x[2]**o+(0.416417451133)*x[2]
        arg[0,1,0]=(-0.69035514237)*x[0]**o+(0.388349204037)*x[0]+(0.807201832597)*x[1]**o+(-0.969007115064)*x[1]+(0.280506744137)*x[2]**o+(0.228554540968)*x[2]
        arg[0,1,1]=(0.893542584763)*x[0]**o+(-0.755974692532)*x[0]+(0.675321004205)*x[1]**o+(0.670278291297)*x[1]+(0.92092687885)*x[2]**o+(-0.516288388724)*x[2]
        arg[1,0,0]=(0.503764409596)*x[0]**o+(-0.39410032918)*x[0]+(0.532408717712)*x[1]**o+(0.0658355614843)*x[1]+(-0.533534889451)*x[2]**o+(0.846333211477)*x[2]
        arg[1,0,1]=(0.520531780859)*x[0]**o+(0.869039672332)*x[0]+(-0.706342144586)*x[1]**o+(0.0665768341658)*x[1]+(-0.909079295867)*x[2]**o+(-0.34153327843)*x[2]
        arg[1,1,0]=(-0.873546169914)*x[0]**o+(-0.554907283387)*x[0]+(-0.0560665557101)*x[1]**o+(0.436703623389)*x[1]+(0.730437022736)*x[2]**o+(0.100904171105)*x[2]
        arg[1,1,1]=(0.845958886681)*x[0]**o+(0.376444128389)*x[0]+(-0.393744308499)*x[1]**o+(-0.0940537397734)*x[1]+(0.178796464778)*x[2]**o+(-0.584448595407)*x[2]
        arg[2,0,0]=(0.000704382305339)*x[0]**o+(-0.836800712787)*x[0]+(0.671931504433)*x[1]**o+(0.263280364406)*x[1]+(-0.746980015754)*x[2]**o+(-0.985058787575)*x[2]
        arg[2,0,1]=(-0.540690929008)*x[0]**o+(0.656899216804)*x[0]+(-0.608036845804)*x[1]**o+(0.224943400248)*x[1]+(-0.312449005326)*x[2]**o+(-0.621458231634)*x[2]
        arg[2,1,0]=(0.440432866893)*x[0]**o+(0.972046189647)*x[0]+(0.060785199375)*x[1]**o+(0.304756432986)*x[1]+(-0.473510049103)*x[2]**o+(0.3707166351)*x[2]
        arg[2,1,1]=(0.96344472567)*x[0]**o+(-0.153932665404)*x[0]+(-0.43646142206)*x[1]**o+(0.4838463484)*x[1]+(0.613286612579)*x[2]**o+(0.84521461472)*x[2]
        arg[3,0,0]=(0.65147393118)*x[0]**o+(-0.886665762467)*x[0]+(-0.266000665973)*x[1]**o+(0.897979405808)*x[1]+(0.699333158084)*x[2]**o+(-0.460865970247)*x[2]
        arg[3,0,1]=(0.870253308112)*x[0]**o+(-0.248736315721)*x[0]+(-0.816719773596)*x[1]**o+(-0.89378202899)*x[1]+(0.524350309915)*x[2]**o+(0.107325872954)*x[2]
        arg[3,1,0]=(-0.152250686624)*x[0]**o+(-0.89784066484)*x[0]+(-0.327207891694)*x[1]**o+(0.346548492907)*x[1]+(0.409288642845)*x[2]**o+(-0.627349664194)*x[2]
        arg[3,1,1]=(0.398337202036)*x[0]**o+(0.307156588584)*x[0]+(0.0567088869624)*x[1]**o+(-0.132313990308)*x[1]+(-0.361821356587)*x[2]**o+(0.913518325149)*x[2]
        arg[4,0,0]=(0.184289428296)*x[0]**o+(0.138095407277)*x[0]+(0.514405012603)*x[1]**o+(0.590757249119)*x[1]+(-0.984116206238)*x[2]**o+(-0.176561783123)*x[2]
        arg[4,0,1]=(-0.804189448075)*x[0]**o+(0.662750787102)*x[0]+(0.361634380444)*x[1]**o+(-0.682665313256)*x[1]+(-0.0738989964344)*x[2]**o+(0.8870747144)*x[2]
        arg[4,1,0]=(-0.28290153618)*x[0]**o+(-0.942107675992)*x[0]+(0.308140792703)*x[1]**o+(0.686659531002)*x[1]+(0.789553636322)*x[2]**o+(0.587377542884)*x[2]
        arg[4,1,1]=(0.6137979501)*x[0]**o+(-0.564031937362)*x[0]+(-0.116407590432)*x[1]**o+(-0.119100735459)*x[1]+(0.673631378916)*x[2]**o+(0.766413057635)*x[2]
        arg[5,0,0]=(-0.871242033478)*x[0]**o+(0.823859447959)*x[0]+(-0.0506075089356)*x[1]**o+(-0.901254358367)*x[1]+(0.936710991394)*x[2]**o+(0.328438496312)*x[2]
        arg[5,0,1]=(-0.768255700059)*x[0]**o+(0.199623934067)*x[0]+(-0.0715921959057)*x[1]**o+(-0.542435290562)*x[1]+(-0.278962068381)*x[2]**o+(0.784363143932)*x[2]
        arg[5,1,0]=(0.897130313615)*x[0]**o+(-0.519033315355)*x[0]+(0.223176381444)*x[1]**o+(0.495645921147)*x[1]+(-0.0957696173909)*x[2]**o+(-0.768307051074)*x[2]
        arg[5,1,1]=(-0.944161779454)*x[0]**o+(0.430097328631)*x[0]+(0.86626977715)*x[1]**o+(-0.675612908116)*x[1]+(0.506821683353)*x[2]**o+(0.386559021354)*x[2]
        ref[0,0,0,0]=o*(0.723756735151)*x_ref[0]**(o-1)+(0.738121670547)
        ref[0,0,0,1]=o*(0.384835073242)*x_ref[1]**(o-1)+(-0.997944909714)
        ref[0,0,0,2]=o*(0.271533052097)*x_ref[2]**(o-1)+(-0.667680363953)
        ref[0,0,1,0]=o*(-0.279804914835)*x_ref[0]**(o-1)+(0.789671404386)
        ref[0,0,1,1]=o*(-0.823187173328)*x_ref[1]**(o-1)+(-0.0126377581755)
        ref[0,0,1,2]=o*(-0.942836469998)*x_ref[2]**(o-1)+(0.416417451133)
        ref[0,1,0,0]=o*(-0.69035514237)*x_ref[0]**(o-1)+(0.388349204037)
        ref[0,1,0,1]=o*(0.807201832597)*x_ref[1]**(o-1)+(-0.969007115064)
        ref[0,1,0,2]=o*(0.280506744137)*x_ref[2]**(o-1)+(0.228554540968)
        ref[0,1,1,0]=o*(0.893542584763)*x_ref[0]**(o-1)+(-0.755974692532)
        ref[0,1,1,1]=o*(0.675321004205)*x_ref[1]**(o-1)+(0.670278291297)
        ref[0,1,1,2]=o*(0.92092687885)*x_ref[2]**(o-1)+(-0.516288388724)
        ref[1,0,0,0]=o*(0.503764409596)*x_ref[0]**(o-1)+(-0.39410032918)
        ref[1,0,0,1]=o*(0.532408717712)*x_ref[1]**(o-1)+(0.0658355614843)
        ref[1,0,0,2]=o*(-0.533534889451)*x_ref[2]**(o-1)+(0.846333211477)
        ref[1,0,1,0]=o*(0.520531780859)*x_ref[0]**(o-1)+(0.869039672332)
        ref[1,0,1,1]=o*(-0.706342144586)*x_ref[1]**(o-1)+(0.0665768341658)
        ref[1,0,1,2]=o*(-0.909079295867)*x_ref[2]**(o-1)+(-0.34153327843)
        ref[1,1,0,0]=o*(-0.873546169914)*x_ref[0]**(o-1)+(-0.554907283387)
        ref[1,1,0,1]=o*(-0.0560665557101)*x_ref[1]**(o-1)+(0.436703623389)
        ref[1,1,0,2]=o*(0.730437022736)*x_ref[2]**(o-1)+(0.100904171105)
        ref[1,1,1,0]=o*(0.845958886681)*x_ref[0]**(o-1)+(0.376444128389)
        ref[1,1,1,1]=o*(-0.393744308499)*x_ref[1]**(o-1)+(-0.0940537397734)
        ref[1,1,1,2]=o*(0.178796464778)*x_ref[2]**(o-1)+(-0.584448595407)
        ref[2,0,0,0]=o*(0.000704382305339)*x_ref[0]**(o-1)+(-0.836800712787)
        ref[2,0,0,1]=o*(0.671931504433)*x_ref[1]**(o-1)+(0.263280364406)
        ref[2,0,0,2]=o*(-0.746980015754)*x_ref[2]**(o-1)+(-0.985058787575)
        ref[2,0,1,0]=o*(-0.540690929008)*x_ref[0]**(o-1)+(0.656899216804)
        ref[2,0,1,1]=o*(-0.608036845804)*x_ref[1]**(o-1)+(0.224943400248)
        ref[2,0,1,2]=o*(-0.312449005326)*x_ref[2]**(o-1)+(-0.621458231634)
        ref[2,1,0,0]=o*(0.440432866893)*x_ref[0]**(o-1)+(0.972046189647)
        ref[2,1,0,1]=o*(0.060785199375)*x_ref[1]**(o-1)+(0.304756432986)
        ref[2,1,0,2]=o*(-0.473510049103)*x_ref[2]**(o-1)+(0.3707166351)
        ref[2,1,1,0]=o*(0.96344472567)*x_ref[0]**(o-1)+(-0.153932665404)
        ref[2,1,1,1]=o*(-0.43646142206)*x_ref[1]**(o-1)+(0.4838463484)
        ref[2,1,1,2]=o*(0.613286612579)*x_ref[2]**(o-1)+(0.84521461472)
        ref[3,0,0,0]=o*(0.65147393118)*x_ref[0]**(o-1)+(-0.886665762467)
        ref[3,0,0,1]=o*(-0.266000665973)*x_ref[1]**(o-1)+(0.897979405808)
        ref[3,0,0,2]=o*(0.699333158084)*x_ref[2]**(o-1)+(-0.460865970247)
        ref[3,0,1,0]=o*(0.870253308112)*x_ref[0]**(o-1)+(-0.248736315721)
        ref[3,0,1,1]=o*(-0.816719773596)*x_ref[1]**(o-1)+(-0.89378202899)
        ref[3,0,1,2]=o*(0.524350309915)*x_ref[2]**(o-1)+(0.107325872954)
        ref[3,1,0,0]=o*(-0.152250686624)*x_ref[0]**(o-1)+(-0.89784066484)
        ref[3,1,0,1]=o*(-0.327207891694)*x_ref[1]**(o-1)+(0.346548492907)
        ref[3,1,0,2]=o*(0.409288642845)*x_ref[2]**(o-1)+(-0.627349664194)
        ref[3,1,1,0]=o*(0.398337202036)*x_ref[0]**(o-1)+(0.307156588584)
        ref[3,1,1,1]=o*(0.0567088869624)*x_ref[1]**(o-1)+(-0.132313990308)
        ref[3,1,1,2]=o*(-0.361821356587)*x_ref[2]**(o-1)+(0.913518325149)
        ref[4,0,0,0]=o*(0.184289428296)*x_ref[0]**(o-1)+(0.138095407277)
        ref[4,0,0,1]=o*(0.514405012603)*x_ref[1]**(o-1)+(0.590757249119)
        ref[4,0,0,2]=o*(-0.984116206238)*x_ref[2]**(o-1)+(-0.176561783123)
        ref[4,0,1,0]=o*(-0.804189448075)*x_ref[0]**(o-1)+(0.662750787102)
        ref[4,0,1,1]=o*(0.361634380444)*x_ref[1]**(o-1)+(-0.682665313256)
        ref[4,0,1,2]=o*(-0.0738989964344)*x_ref[2]**(o-1)+(0.8870747144)
        ref[4,1,0,0]=o*(-0.28290153618)*x_ref[0]**(o-1)+(-0.942107675992)
        ref[4,1,0,1]=o*(0.308140792703)*x_ref[1]**(o-1)+(0.686659531002)
        ref[4,1,0,2]=o*(0.789553636322)*x_ref[2]**(o-1)+(0.587377542884)
        ref[4,1,1,0]=o*(0.6137979501)*x_ref[0]**(o-1)+(-0.564031937362)
        ref[4,1,1,1]=o*(-0.116407590432)*x_ref[1]**(o-1)+(-0.119100735459)
        ref[4,1,1,2]=o*(0.673631378916)*x_ref[2]**(o-1)+(0.766413057635)
        ref[5,0,0,0]=o*(-0.871242033478)*x_ref[0]**(o-1)+(0.823859447959)
        ref[5,0,0,1]=o*(-0.0506075089356)*x_ref[1]**(o-1)+(-0.901254358367)
        ref[5,0,0,2]=o*(0.936710991394)*x_ref[2]**(o-1)+(0.328438496312)
        ref[5,0,1,0]=o*(-0.768255700059)*x_ref[0]**(o-1)+(0.199623934067)
        ref[5,0,1,1]=o*(-0.0715921959057)*x_ref[1]**(o-1)+(-0.542435290562)
        ref[5,0,1,2]=o*(-0.278962068381)*x_ref[2]**(o-1)+(0.784363143932)
        ref[5,1,0,0]=o*(0.897130313615)*x_ref[0]**(o-1)+(-0.519033315355)
        ref[5,1,0,1]=o*(0.223176381444)*x_ref[1]**(o-1)+(0.495645921147)
        ref[5,1,0,2]=o*(-0.0957696173909)*x_ref[2]**(o-1)+(-0.768307051074)
        ref[5,1,1,0]=o*(-0.944161779454)*x_ref[0]**(o-1)+(0.430097328631)
        ref[5,1,1,1]=o*(0.86626977715)*x_ref[1]**(o-1)+(-0.675612908116)
        ref[5,1,1,2]=o*(0.506821683353)*x_ref[2]**(o-1)+(0.386559021354)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_Solution_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.54415545025)*x[0]**o+(0.979947366774)*x[0]+(-0.405934730304)*x[1]**o+(0.424994268397)*x[1]
        ref[0]=o*(0.54415545025)*x_ref[0]**(o-1)+(0.979947366774)
        ref[1]=o*(-0.405934730304)*x_ref[1]**(o-1)+(0.424994268397)
      else:
        arg=(-0.0240792232301)*x[0]**o+(0.33156704088)*x[0]+(-0.051539264252)*x[1]**o+(-0.886370693155)*x[1]+(-0.954475798211)*x[2]**o+(0.238073928589)*x[2]
        ref[0]=o*(-0.0240792232301)*x_ref[0]**(o-1)+(0.33156704088)
        ref[1]=o*(-0.051539264252)*x_ref[1]**(o-1)+(-0.886370693155)
        ref[2]=o*(-0.954475798211)*x_ref[2]**(o-1)+(0.238073928589)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_Solution_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(-0.526471606132)*x[0]**o+(-0.355534153967)*x[0]+(-0.792258102571)*x[1]**o+(0.386283553167)*x[1]
        arg[1]=(-0.892924864905)*x[0]**o+(0.19218757952)*x[0]+(0.00248964495987)*x[1]**o+(-0.687070938997)*x[1]
        ref[0,0]=o*(-0.526471606132)*x_ref[0]**(o-1)+(-0.355534153967)
        ref[0,1]=o*(-0.792258102571)*x_ref[1]**(o-1)+(0.386283553167)
        ref[1,0]=o*(-0.892924864905)*x_ref[0]**(o-1)+(0.19218757952)
        ref[1,1]=o*(0.00248964495987)*x_ref[1]**(o-1)+(-0.687070938997)
      else:
        arg[0]=(-0.254013984725)*x[0]**o+(0.126174108068)*x[0]+(-0.967653739084)*x[1]**o+(-0.524294999327)*x[1]+(0.374454913375)*x[2]**o+(0.783768839592)*x[2]
        arg[1]=(0.862328996944)*x[0]**o+(-0.0100272707295)*x[0]+(0.163524617753)*x[1]**o+(-0.19251370258)*x[1]+(0.889557068195)*x[2]**o+(0.573248942406)*x[2]
        ref[0,0]=o*(-0.254013984725)*x_ref[0]**(o-1)+(0.126174108068)
        ref[0,1]=o*(-0.967653739084)*x_ref[1]**(o-1)+(-0.524294999327)
        ref[0,2]=o*(0.374454913375)*x_ref[2]**(o-1)+(0.783768839592)
        ref[1,0]=o*(0.862328996944)*x_ref[0]**(o-1)+(-0.0100272707295)
        ref[1,1]=o*(0.163524617753)*x_ref[1]**(o-1)+(-0.19251370258)
        ref[1,2]=o*(0.889557068195)*x_ref[2]**(o-1)+(0.573248942406)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_Solution_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.712410724071)*x[0]**o+(0.642832165006)*x[0]+(0.409613677638)*x[1]**o+(-0.940707375829)*x[1]
        arg[0,1]=(-0.192677448978)*x[0]**o+(0.928105399392)*x[0]+(-0.0976390111113)*x[1]**o+(0.152541825282)*x[1]
        arg[0,2]=(-0.555865920622)*x[0]**o+(0.187618737934)*x[0]+(-0.400398722616)*x[1]**o+(0.132335647294)*x[1]
        arg[0,3]=(-0.0984345355899)*x[0]**o+(-0.136251593387)*x[0]+(0.820900167194)*x[1]**o+(-0.54323976155)*x[1]
        arg[0,4]=(-0.718763327727)*x[0]**o+(-0.993678837401)*x[0]+(0.0282625285716)*x[1]**o+(0.480464124636)*x[1]
        arg[1,0]=(-0.1635372419)*x[0]**o+(0.97173720053)*x[0]+(0.0423190406144)*x[1]**o+(-0.607779321237)*x[1]
        arg[1,1]=(-0.59220466746)*x[0]**o+(-0.329625880847)*x[0]+(0.176412343254)*x[1]**o+(0.955769019385)*x[1]
        arg[1,2]=(-0.516421195901)*x[0]**o+(0.147037193899)*x[0]+(0.247835053631)*x[1]**o+(-0.877986653535)*x[1]
        arg[1,3]=(-0.317266388999)*x[0]**o+(0.864393749347)*x[0]+(-0.957863705756)*x[1]**o+(-0.884975429798)*x[1]
        arg[1,4]=(0.540121554391)*x[0]**o+(0.808050078272)*x[0]+(0.703557587067)*x[1]**o+(-0.0976121077766)*x[1]
        arg[2,0]=(0.23658022222)*x[0]**o+(0.122038637852)*x[0]+(0.411570045798)*x[1]**o+(-0.434531687414)*x[1]
        arg[2,1]=(-0.378365306249)*x[0]**o+(0.511747532394)*x[0]+(0.586326813286)*x[1]**o+(0.699918966936)*x[1]
        arg[2,2]=(0.445092669694)*x[0]**o+(0.637517787944)*x[0]+(-0.668779388847)*x[1]**o+(0.487635262236)*x[1]
        arg[2,3]=(-0.232265851556)*x[0]**o+(0.391449220433)*x[0]+(0.647177607766)*x[1]**o+(0.207062996634)*x[1]
        arg[2,4]=(0.338412227828)*x[0]**o+(0.0205801366652)*x[0]+(-0.492628796478)*x[1]**o+(-0.683459852092)*x[1]
        arg[3,0]=(0.584296838468)*x[0]**o+(-0.598793253755)*x[0]+(0.707319426212)*x[1]**o+(0.678834769735)*x[1]
        arg[3,1]=(0.801295300134)*x[0]**o+(0.0494871119593)*x[0]+(0.378929822492)*x[1]**o+(-0.536309789421)*x[1]
        arg[3,2]=(-0.761535984131)*x[0]**o+(0.121584094596)*x[0]+(-0.00655849155175)*x[1]**o+(0.321872124523)*x[1]
        arg[3,3]=(0.384633290815)*x[0]**o+(-0.710356674518)*x[0]+(0.962059942069)*x[1]**o+(-0.593059919585)*x[1]
        arg[3,4]=(-0.608988807286)*x[0]**o+(-0.0776468065145)*x[0]+(-0.701400144867)*x[1]**o+(0.643928611178)*x[1]
        ref[0,0,0]=o*(0.712410724071)*x_ref[0]**(o-1)+(0.642832165006)
        ref[0,0,1]=o*(0.409613677638)*x_ref[1]**(o-1)+(-0.940707375829)
        ref[0,1,0]=o*(-0.192677448978)*x_ref[0]**(o-1)+(0.928105399392)
        ref[0,1,1]=o*(-0.0976390111113)*x_ref[1]**(o-1)+(0.152541825282)
        ref[0,2,0]=o*(-0.555865920622)*x_ref[0]**(o-1)+(0.187618737934)
        ref[0,2,1]=o*(-0.400398722616)*x_ref[1]**(o-1)+(0.132335647294)
        ref[0,3,0]=o*(-0.0984345355899)*x_ref[0]**(o-1)+(-0.136251593387)
        ref[0,3,1]=o*(0.820900167194)*x_ref[1]**(o-1)+(-0.54323976155)
        ref[0,4,0]=o*(-0.718763327727)*x_ref[0]**(o-1)+(-0.993678837401)
        ref[0,4,1]=o*(0.0282625285716)*x_ref[1]**(o-1)+(0.480464124636)
        ref[1,0,0]=o*(-0.1635372419)*x_ref[0]**(o-1)+(0.97173720053)
        ref[1,0,1]=o*(0.0423190406144)*x_ref[1]**(o-1)+(-0.607779321237)
        ref[1,1,0]=o*(-0.59220466746)*x_ref[0]**(o-1)+(-0.329625880847)
        ref[1,1,1]=o*(0.176412343254)*x_ref[1]**(o-1)+(0.955769019385)
        ref[1,2,0]=o*(-0.516421195901)*x_ref[0]**(o-1)+(0.147037193899)
        ref[1,2,1]=o*(0.247835053631)*x_ref[1]**(o-1)+(-0.877986653535)
        ref[1,3,0]=o*(-0.317266388999)*x_ref[0]**(o-1)+(0.864393749347)
        ref[1,3,1]=o*(-0.957863705756)*x_ref[1]**(o-1)+(-0.884975429798)
        ref[1,4,0]=o*(0.540121554391)*x_ref[0]**(o-1)+(0.808050078272)
        ref[1,4,1]=o*(0.703557587067)*x_ref[1]**(o-1)+(-0.0976121077766)
        ref[2,0,0]=o*(0.23658022222)*x_ref[0]**(o-1)+(0.122038637852)
        ref[2,0,1]=o*(0.411570045798)*x_ref[1]**(o-1)+(-0.434531687414)
        ref[2,1,0]=o*(-0.378365306249)*x_ref[0]**(o-1)+(0.511747532394)
        ref[2,1,1]=o*(0.586326813286)*x_ref[1]**(o-1)+(0.699918966936)
        ref[2,2,0]=o*(0.445092669694)*x_ref[0]**(o-1)+(0.637517787944)
        ref[2,2,1]=o*(-0.668779388847)*x_ref[1]**(o-1)+(0.487635262236)
        ref[2,3,0]=o*(-0.232265851556)*x_ref[0]**(o-1)+(0.391449220433)
        ref[2,3,1]=o*(0.647177607766)*x_ref[1]**(o-1)+(0.207062996634)
        ref[2,4,0]=o*(0.338412227828)*x_ref[0]**(o-1)+(0.0205801366652)
        ref[2,4,1]=o*(-0.492628796478)*x_ref[1]**(o-1)+(-0.683459852092)
        ref[3,0,0]=o*(0.584296838468)*x_ref[0]**(o-1)+(-0.598793253755)
        ref[3,0,1]=o*(0.707319426212)*x_ref[1]**(o-1)+(0.678834769735)
        ref[3,1,0]=o*(0.801295300134)*x_ref[0]**(o-1)+(0.0494871119593)
        ref[3,1,1]=o*(0.378929822492)*x_ref[1]**(o-1)+(-0.536309789421)
        ref[3,2,0]=o*(-0.761535984131)*x_ref[0]**(o-1)+(0.121584094596)
        ref[3,2,1]=o*(-0.00655849155175)*x_ref[1]**(o-1)+(0.321872124523)
        ref[3,3,0]=o*(0.384633290815)*x_ref[0]**(o-1)+(-0.710356674518)
        ref[3,3,1]=o*(0.962059942069)*x_ref[1]**(o-1)+(-0.593059919585)
        ref[3,4,0]=o*(-0.608988807286)*x_ref[0]**(o-1)+(-0.0776468065145)
        ref[3,4,1]=o*(-0.701400144867)*x_ref[1]**(o-1)+(0.643928611178)
      else:
        arg[0,0]=(-0.514546772198)*x[0]**o+(0.679859064768)*x[0]+(-0.494037106077)*x[1]**o+(-0.0598645161488)*x[1]+(-0.543474311879)*x[2]**o+(0.597237276677)*x[2]
        arg[0,1]=(0.0826513727579)*x[0]**o+(0.870535937411)*x[0]+(-0.194047768119)*x[1]**o+(-0.111616761775)*x[1]+(0.697073558803)*x[2]**o+(-0.170433075843)*x[2]
        arg[0,2]=(0.608560200938)*x[0]**o+(-0.28991661304)*x[0]+(0.929121366615)*x[1]**o+(0.445280468492)*x[1]+(-0.0671026162019)*x[2]**o+(-0.835086989851)*x[2]
        arg[0,3]=(-0.256476478337)*x[0]**o+(-0.857686365148)*x[0]+(-0.309306419219)*x[1]**o+(0.750579112592)*x[1]+(0.758254577714)*x[2]**o+(0.108972886739)*x[2]
        arg[0,4]=(0.189540467853)*x[0]**o+(-0.639906129587)*x[0]+(0.1086564431)*x[1]**o+(-0.254754163159)*x[1]+(-0.595415956315)*x[2]**o+(0.416643698623)*x[2]
        arg[1,0]=(0.649640741159)*x[0]**o+(-0.715604744977)*x[0]+(0.144698127223)*x[1]**o+(0.84058008507)*x[1]+(0.00226738664623)*x[2]**o+(0.143092105366)*x[2]
        arg[1,1]=(0.30428097785)*x[0]**o+(0.172630542192)*x[0]+(0.645118113075)*x[1]**o+(-0.394468022223)*x[1]+(0.731670923192)*x[2]**o+(-0.676021495379)*x[2]
        arg[1,2]=(0.56459927889)*x[0]**o+(-0.624980053566)*x[0]+(-0.524836958708)*x[1]**o+(0.282862320474)*x[1]+(0.99070455422)*x[2]**o+(0.000265746399286)*x[2]
        arg[1,3]=(-0.251929813217)*x[0]**o+(0.00685246758491)*x[0]+(-0.252595929082)*x[1]**o+(-0.997558334417)*x[1]+(-0.431329146194)*x[2]**o+(0.0685298495116)*x[2]
        arg[1,4]=(-0.850398225165)*x[0]**o+(-0.752363025861)*x[0]+(-0.669448553729)*x[1]**o+(0.809247179374)*x[1]+(-0.927467807251)*x[2]**o+(-0.498094160268)*x[2]
        arg[2,0]=(0.541736859663)*x[0]**o+(-0.651273876855)*x[0]+(-0.679670779769)*x[1]**o+(0.669564679419)*x[1]+(-0.825048237017)*x[2]**o+(-0.247744537755)*x[2]
        arg[2,1]=(0.909016713138)*x[0]**o+(-0.794124179572)*x[0]+(0.887294650854)*x[1]**o+(-0.198933351435)*x[1]+(-0.819671062456)*x[2]**o+(0.287455634612)*x[2]
        arg[2,2]=(-0.469337238665)*x[0]**o+(0.787828984218)*x[0]+(0.916042829702)*x[1]**o+(-0.475983675757)*x[1]+(-0.350660319046)*x[2]**o+(0.944222119413)*x[2]
        arg[2,3]=(-0.194629035155)*x[0]**o+(0.452058614199)*x[0]+(-0.565150768916)*x[1]**o+(-0.967642852138)*x[1]+(-0.345332973443)*x[2]**o+(-0.238359110833)*x[2]
        arg[2,4]=(-0.744197369952)*x[0]**o+(-0.0161450929106)*x[0]+(0.946555120156)*x[1]**o+(-0.336314723492)*x[1]+(0.212936909808)*x[2]**o+(-0.900582293569)*x[2]
        arg[3,0]=(0.90736518985)*x[0]**o+(-0.866096443075)*x[0]+(0.440227521532)*x[1]**o+(-0.545983384676)*x[1]+(0.433167375756)*x[2]**o+(-0.913060961228)*x[2]
        arg[3,1]=(0.33547032327)*x[0]**o+(0.766388218896)*x[0]+(-0.386141806114)*x[1]**o+(0.28471049668)*x[1]+(0.389347155974)*x[2]**o+(0.211663215285)*x[2]
        arg[3,2]=(0.193757801099)*x[0]**o+(0.0145439587225)*x[0]+(0.575506295918)*x[1]**o+(-0.678317336021)*x[1]+(0.64603157052)*x[2]**o+(-0.876667949279)*x[2]
        arg[3,3]=(-0.0518002857411)*x[0]**o+(-0.540021971724)*x[0]+(-0.490275636747)*x[1]**o+(-0.849147647677)*x[1]+(-0.0132783508877)*x[2]**o+(0.0859860768541)*x[2]
        arg[3,4]=(-0.332675003425)*x[0]**o+(-0.757986125506)*x[0]+(-0.487001539705)*x[1]**o+(0.898881577697)*x[1]+(0.56557767007)*x[2]**o+(0.181594113977)*x[2]
        ref[0,0,0]=o*(-0.514546772198)*x_ref[0]**(o-1)+(0.679859064768)
        ref[0,0,1]=o*(-0.494037106077)*x_ref[1]**(o-1)+(-0.0598645161488)
        ref[0,0,2]=o*(-0.543474311879)*x_ref[2]**(o-1)+(0.597237276677)
        ref[0,1,0]=o*(0.0826513727579)*x_ref[0]**(o-1)+(0.870535937411)
        ref[0,1,1]=o*(-0.194047768119)*x_ref[1]**(o-1)+(-0.111616761775)
        ref[0,1,2]=o*(0.697073558803)*x_ref[2]**(o-1)+(-0.170433075843)
        ref[0,2,0]=o*(0.608560200938)*x_ref[0]**(o-1)+(-0.28991661304)
        ref[0,2,1]=o*(0.929121366615)*x_ref[1]**(o-1)+(0.445280468492)
        ref[0,2,2]=o*(-0.0671026162019)*x_ref[2]**(o-1)+(-0.835086989851)
        ref[0,3,0]=o*(-0.256476478337)*x_ref[0]**(o-1)+(-0.857686365148)
        ref[0,3,1]=o*(-0.309306419219)*x_ref[1]**(o-1)+(0.750579112592)
        ref[0,3,2]=o*(0.758254577714)*x_ref[2]**(o-1)+(0.108972886739)
        ref[0,4,0]=o*(0.189540467853)*x_ref[0]**(o-1)+(-0.639906129587)
        ref[0,4,1]=o*(0.1086564431)*x_ref[1]**(o-1)+(-0.254754163159)
        ref[0,4,2]=o*(-0.595415956315)*x_ref[2]**(o-1)+(0.416643698623)
        ref[1,0,0]=o*(0.649640741159)*x_ref[0]**(o-1)+(-0.715604744977)
        ref[1,0,1]=o*(0.144698127223)*x_ref[1]**(o-1)+(0.84058008507)
        ref[1,0,2]=o*(0.00226738664623)*x_ref[2]**(o-1)+(0.143092105366)
        ref[1,1,0]=o*(0.30428097785)*x_ref[0]**(o-1)+(0.172630542192)
        ref[1,1,1]=o*(0.645118113075)*x_ref[1]**(o-1)+(-0.394468022223)
        ref[1,1,2]=o*(0.731670923192)*x_ref[2]**(o-1)+(-0.676021495379)
        ref[1,2,0]=o*(0.56459927889)*x_ref[0]**(o-1)+(-0.624980053566)
        ref[1,2,1]=o*(-0.524836958708)*x_ref[1]**(o-1)+(0.282862320474)
        ref[1,2,2]=o*(0.99070455422)*x_ref[2]**(o-1)+(0.000265746399286)
        ref[1,3,0]=o*(-0.251929813217)*x_ref[0]**(o-1)+(0.00685246758491)
        ref[1,3,1]=o*(-0.252595929082)*x_ref[1]**(o-1)+(-0.997558334417)
        ref[1,3,2]=o*(-0.431329146194)*x_ref[2]**(o-1)+(0.0685298495116)
        ref[1,4,0]=o*(-0.850398225165)*x_ref[0]**(o-1)+(-0.752363025861)
        ref[1,4,1]=o*(-0.669448553729)*x_ref[1]**(o-1)+(0.809247179374)
        ref[1,4,2]=o*(-0.927467807251)*x_ref[2]**(o-1)+(-0.498094160268)
        ref[2,0,0]=o*(0.541736859663)*x_ref[0]**(o-1)+(-0.651273876855)
        ref[2,0,1]=o*(-0.679670779769)*x_ref[1]**(o-1)+(0.669564679419)
        ref[2,0,2]=o*(-0.825048237017)*x_ref[2]**(o-1)+(-0.247744537755)
        ref[2,1,0]=o*(0.909016713138)*x_ref[0]**(o-1)+(-0.794124179572)
        ref[2,1,1]=o*(0.887294650854)*x_ref[1]**(o-1)+(-0.198933351435)
        ref[2,1,2]=o*(-0.819671062456)*x_ref[2]**(o-1)+(0.287455634612)
        ref[2,2,0]=o*(-0.469337238665)*x_ref[0]**(o-1)+(0.787828984218)
        ref[2,2,1]=o*(0.916042829702)*x_ref[1]**(o-1)+(-0.475983675757)
        ref[2,2,2]=o*(-0.350660319046)*x_ref[2]**(o-1)+(0.944222119413)
        ref[2,3,0]=o*(-0.194629035155)*x_ref[0]**(o-1)+(0.452058614199)
        ref[2,3,1]=o*(-0.565150768916)*x_ref[1]**(o-1)+(-0.967642852138)
        ref[2,3,2]=o*(-0.345332973443)*x_ref[2]**(o-1)+(-0.238359110833)
        ref[2,4,0]=o*(-0.744197369952)*x_ref[0]**(o-1)+(-0.0161450929106)
        ref[2,4,1]=o*(0.946555120156)*x_ref[1]**(o-1)+(-0.336314723492)
        ref[2,4,2]=o*(0.212936909808)*x_ref[2]**(o-1)+(-0.900582293569)
        ref[3,0,0]=o*(0.90736518985)*x_ref[0]**(o-1)+(-0.866096443075)
        ref[3,0,1]=o*(0.440227521532)*x_ref[1]**(o-1)+(-0.545983384676)
        ref[3,0,2]=o*(0.433167375756)*x_ref[2]**(o-1)+(-0.913060961228)
        ref[3,1,0]=o*(0.33547032327)*x_ref[0]**(o-1)+(0.766388218896)
        ref[3,1,1]=o*(-0.386141806114)*x_ref[1]**(o-1)+(0.28471049668)
        ref[3,1,2]=o*(0.389347155974)*x_ref[2]**(o-1)+(0.211663215285)
        ref[3,2,0]=o*(0.193757801099)*x_ref[0]**(o-1)+(0.0145439587225)
        ref[3,2,1]=o*(0.575506295918)*x_ref[1]**(o-1)+(-0.678317336021)
        ref[3,2,2]=o*(0.64603157052)*x_ref[2]**(o-1)+(-0.876667949279)
        ref[3,3,0]=o*(-0.0518002857411)*x_ref[0]**(o-1)+(-0.540021971724)
        ref[3,3,1]=o*(-0.490275636747)*x_ref[1]**(o-1)+(-0.849147647677)
        ref[3,3,2]=o*(-0.0132783508877)*x_ref[2]**(o-1)+(0.0859860768541)
        ref[3,4,0]=o*(-0.332675003425)*x_ref[0]**(o-1)+(-0.757986125506)
        ref[3,4,1]=o*(-0.487001539705)*x_ref[1]**(o-1)+(0.898881577697)
        ref[3,4,2]=o*(0.56557767007)*x_ref[2]**(o-1)+(0.181594113977)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_Solution_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.568278554396)*x[0]**o+(0.714635312506)*x[0]+(-0.121000061881)*x[1]**o+(0.650923087629)*x[1]
        arg[0,0,1]=(0.610070747198)*x[0]**o+(-0.17228586298)*x[0]+(-0.763207252556)*x[1]**o+(-0.417620736844)*x[1]
        arg[0,1,0]=(0.953437717333)*x[0]**o+(-0.877858891638)*x[0]+(-0.629855255168)*x[1]**o+(0.138168708132)*x[1]
        arg[0,1,1]=(-0.676346259275)*x[0]**o+(0.810400719592)*x[0]+(0.252517037374)*x[1]**o+(-0.0253025825974)*x[1]
        arg[1,0,0]=(0.0354009852553)*x[0]**o+(-0.930486981217)*x[0]+(0.515533244848)*x[1]**o+(0.39357313927)*x[1]
        arg[1,0,1]=(4.954730054e-05)*x[0]**o+(0.902841279458)*x[0]+(0.0974175050415)*x[1]**o+(-0.283224733511)*x[1]
        arg[1,1,0]=(-0.3695113121)*x[0]**o+(-0.425976895152)*x[0]+(-0.752863101988)*x[1]**o+(-0.135026977845)*x[1]
        arg[1,1,1]=(-0.627750038208)*x[0]**o+(-0.682825202306)*x[0]+(0.598327522753)*x[1]**o+(0.0402698525348)*x[1]
        arg[2,0,0]=(0.95982907811)*x[0]**o+(-0.786158711751)*x[0]+(0.6974717418)*x[1]**o+(-0.548248895713)*x[1]
        arg[2,0,1]=(-0.21063630362)*x[0]**o+(-0.979628903483)*x[0]+(0.514851452559)*x[1]**o+(-0.294218784425)*x[1]
        arg[2,1,0]=(-0.446140926476)*x[0]**o+(0.658918134389)*x[0]+(-0.166087456007)*x[1]**o+(0.328044805625)*x[1]
        arg[2,1,1]=(0.937161634589)*x[0]**o+(0.594322457074)*x[0]+(0.992336676032)*x[1]**o+(-0.499637100315)*x[1]
        arg[3,0,0]=(0.767677974163)*x[0]**o+(-0.820615663298)*x[0]+(0.558185245925)*x[1]**o+(-0.763525476816)*x[1]
        arg[3,0,1]=(-0.866581629552)*x[0]**o+(0.589993777037)*x[0]+(-0.0704817160146)*x[1]**o+(-0.897469280048)*x[1]
        arg[3,1,0]=(-0.290118027748)*x[0]**o+(0.211790364383)*x[0]+(-0.0688758465892)*x[1]**o+(0.777490292219)*x[1]
        arg[3,1,1]=(-0.969418722549)*x[0]**o+(-0.46884683812)*x[0]+(0.826696594862)*x[1]**o+(-0.926802811507)*x[1]
        arg[4,0,0]=(-0.230285931083)*x[0]**o+(0.905695021426)*x[0]+(-0.581906633624)*x[1]**o+(-0.69277147014)*x[1]
        arg[4,0,1]=(-0.251350536276)*x[0]**o+(0.352877501605)*x[0]+(0.290432460788)*x[1]**o+(0.614218150117)*x[1]
        arg[4,1,0]=(-0.475014635407)*x[0]**o+(0.86786497963)*x[0]+(-0.763349511499)*x[1]**o+(0.817847286727)*x[1]
        arg[4,1,1]=(0.0079711463132)*x[0]**o+(-0.20685339926)*x[0]+(0.377467915936)*x[1]**o+(-0.209268733968)*x[1]
        arg[5,0,0]=(0.795790630791)*x[0]**o+(0.0661201279192)*x[0]+(0.932665258262)*x[1]**o+(-0.4785884914)*x[1]
        arg[5,0,1]=(0.929422646068)*x[0]**o+(0.775378282324)*x[0]+(0.297482039582)*x[1]**o+(-0.700872789842)*x[1]
        arg[5,1,0]=(0.678688297204)*x[0]**o+(0.365975847321)*x[0]+(-0.565261107289)*x[1]**o+(0.0317556604619)*x[1]
        arg[5,1,1]=(-0.0231297032408)*x[0]**o+(-0.985865541949)*x[0]+(0.733821736669)*x[1]**o+(0.603255951212)*x[1]
        ref[0,0,0,0]=o*(0.568278554396)*x_ref[0]**(o-1)+(0.714635312506)
        ref[0,0,0,1]=o*(-0.121000061881)*x_ref[1]**(o-1)+(0.650923087629)
        ref[0,0,1,0]=o*(0.610070747198)*x_ref[0]**(o-1)+(-0.17228586298)
        ref[0,0,1,1]=o*(-0.763207252556)*x_ref[1]**(o-1)+(-0.417620736844)
        ref[0,1,0,0]=o*(0.953437717333)*x_ref[0]**(o-1)+(-0.877858891638)
        ref[0,1,0,1]=o*(-0.629855255168)*x_ref[1]**(o-1)+(0.138168708132)
        ref[0,1,1,0]=o*(-0.676346259275)*x_ref[0]**(o-1)+(0.810400719592)
        ref[0,1,1,1]=o*(0.252517037374)*x_ref[1]**(o-1)+(-0.0253025825974)
        ref[1,0,0,0]=o*(0.0354009852553)*x_ref[0]**(o-1)+(-0.930486981217)
        ref[1,0,0,1]=o*(0.515533244848)*x_ref[1]**(o-1)+(0.39357313927)
        ref[1,0,1,0]=o*(4.954730054e-05)*x_ref[0]**(o-1)+(0.902841279458)
        ref[1,0,1,1]=o*(0.0974175050415)*x_ref[1]**(o-1)+(-0.283224733511)
        ref[1,1,0,0]=o*(-0.3695113121)*x_ref[0]**(o-1)+(-0.425976895152)
        ref[1,1,0,1]=o*(-0.752863101988)*x_ref[1]**(o-1)+(-0.135026977845)
        ref[1,1,1,0]=o*(-0.627750038208)*x_ref[0]**(o-1)+(-0.682825202306)
        ref[1,1,1,1]=o*(0.598327522753)*x_ref[1]**(o-1)+(0.0402698525348)
        ref[2,0,0,0]=o*(0.95982907811)*x_ref[0]**(o-1)+(-0.786158711751)
        ref[2,0,0,1]=o*(0.6974717418)*x_ref[1]**(o-1)+(-0.548248895713)
        ref[2,0,1,0]=o*(-0.21063630362)*x_ref[0]**(o-1)+(-0.979628903483)
        ref[2,0,1,1]=o*(0.514851452559)*x_ref[1]**(o-1)+(-0.294218784425)
        ref[2,1,0,0]=o*(-0.446140926476)*x_ref[0]**(o-1)+(0.658918134389)
        ref[2,1,0,1]=o*(-0.166087456007)*x_ref[1]**(o-1)+(0.328044805625)
        ref[2,1,1,0]=o*(0.937161634589)*x_ref[0]**(o-1)+(0.594322457074)
        ref[2,1,1,1]=o*(0.992336676032)*x_ref[1]**(o-1)+(-0.499637100315)
        ref[3,0,0,0]=o*(0.767677974163)*x_ref[0]**(o-1)+(-0.820615663298)
        ref[3,0,0,1]=o*(0.558185245925)*x_ref[1]**(o-1)+(-0.763525476816)
        ref[3,0,1,0]=o*(-0.866581629552)*x_ref[0]**(o-1)+(0.589993777037)
        ref[3,0,1,1]=o*(-0.0704817160146)*x_ref[1]**(o-1)+(-0.897469280048)
        ref[3,1,0,0]=o*(-0.290118027748)*x_ref[0]**(o-1)+(0.211790364383)
        ref[3,1,0,1]=o*(-0.0688758465892)*x_ref[1]**(o-1)+(0.777490292219)
        ref[3,1,1,0]=o*(-0.969418722549)*x_ref[0]**(o-1)+(-0.46884683812)
        ref[3,1,1,1]=o*(0.826696594862)*x_ref[1]**(o-1)+(-0.926802811507)
        ref[4,0,0,0]=o*(-0.230285931083)*x_ref[0]**(o-1)+(0.905695021426)
        ref[4,0,0,1]=o*(-0.581906633624)*x_ref[1]**(o-1)+(-0.69277147014)
        ref[4,0,1,0]=o*(-0.251350536276)*x_ref[0]**(o-1)+(0.352877501605)
        ref[4,0,1,1]=o*(0.290432460788)*x_ref[1]**(o-1)+(0.614218150117)
        ref[4,1,0,0]=o*(-0.475014635407)*x_ref[0]**(o-1)+(0.86786497963)
        ref[4,1,0,1]=o*(-0.763349511499)*x_ref[1]**(o-1)+(0.817847286727)
        ref[4,1,1,0]=o*(0.0079711463132)*x_ref[0]**(o-1)+(-0.20685339926)
        ref[4,1,1,1]=o*(0.377467915936)*x_ref[1]**(o-1)+(-0.209268733968)
        ref[5,0,0,0]=o*(0.795790630791)*x_ref[0]**(o-1)+(0.0661201279192)
        ref[5,0,0,1]=o*(0.932665258262)*x_ref[1]**(o-1)+(-0.4785884914)
        ref[5,0,1,0]=o*(0.929422646068)*x_ref[0]**(o-1)+(0.775378282324)
        ref[5,0,1,1]=o*(0.297482039582)*x_ref[1]**(o-1)+(-0.700872789842)
        ref[5,1,0,0]=o*(0.678688297204)*x_ref[0]**(o-1)+(0.365975847321)
        ref[5,1,0,1]=o*(-0.565261107289)*x_ref[1]**(o-1)+(0.0317556604619)
        ref[5,1,1,0]=o*(-0.0231297032408)*x_ref[0]**(o-1)+(-0.985865541949)
        ref[5,1,1,1]=o*(0.733821736669)*x_ref[1]**(o-1)+(0.603255951212)
      else:
        arg[0,0,0]=(-0.211459759219)*x[0]**o+(-0.577684864446)*x[0]+(-0.391603126843)*x[1]**o+(0.260321825768)*x[1]+(-0.314038207978)*x[2]**o+(-0.981440041663)*x[2]
        arg[0,0,1]=(-0.876053365684)*x[0]**o+(-0.194899445893)*x[0]+(0.346950377505)*x[1]**o+(0.571865696578)*x[1]+(0.632901527485)*x[2]**o+(0.832258490904)*x[2]
        arg[0,1,0]=(-0.0779003885155)*x[0]**o+(0.583384314998)*x[0]+(-0.257262737021)*x[1]**o+(0.456730130081)*x[1]+(0.262812418811)*x[2]**o+(0.0815640391979)*x[2]
        arg[0,1,1]=(0.087484387098)*x[0]**o+(-0.415375968565)*x[0]+(0.31138114792)*x[1]**o+(0.832138685168)*x[1]+(0.552625436456)*x[2]**o+(-0.0969172211154)*x[2]
        arg[1,0,0]=(0.721326796741)*x[0]**o+(-0.556644260079)*x[0]+(0.14718294664)*x[1]**o+(0.688425309252)*x[1]+(-0.16480505764)*x[2]**o+(-0.914914176523)*x[2]
        arg[1,0,1]=(0.0932763269908)*x[0]**o+(0.359036469617)*x[0]+(0.568509073358)*x[1]**o+(-0.42133310351)*x[1]+(0.576833556667)*x[2]**o+(0.44466763296)*x[2]
        arg[1,1,0]=(0.564028751408)*x[0]**o+(-0.314840429631)*x[0]+(-0.910523044917)*x[1]**o+(-0.0377714078758)*x[1]+(0.0125836031881)*x[2]**o+(0.602273699833)*x[2]
        arg[1,1,1]=(0.135282471986)*x[0]**o+(0.163613895979)*x[0]+(0.115685034139)*x[1]**o+(-0.687078382924)*x[1]+(0.406385459521)*x[2]**o+(-0.401846794432)*x[2]
        arg[2,0,0]=(0.815695969791)*x[0]**o+(0.312205723135)*x[0]+(0.993404535838)*x[1]**o+(0.101946422158)*x[1]+(-0.331818829998)*x[2]**o+(-0.0034480605816)*x[2]
        arg[2,0,1]=(0.638646208966)*x[0]**o+(0.265838992948)*x[0]+(0.156594972273)*x[1]**o+(0.935292984535)*x[1]+(-0.930522319399)*x[2]**o+(0.540679813135)*x[2]
        arg[2,1,0]=(-0.778823826824)*x[0]**o+(0.435399707656)*x[0]+(0.123031900278)*x[1]**o+(-0.132556439303)*x[1]+(-0.29114590778)*x[2]**o+(-0.277636472779)*x[2]
        arg[2,1,1]=(-0.200541347963)*x[0]**o+(-0.526841282198)*x[0]+(0.670718267305)*x[1]**o+(0.0777161510281)*x[1]+(0.847335718393)*x[2]**o+(0.167185849891)*x[2]
        arg[3,0,0]=(0.481112023661)*x[0]**o+(-0.703558873662)*x[0]+(0.0661746324247)*x[1]**o+(0.0628113595423)*x[1]+(0.804110728888)*x[2]**o+(0.517297444342)*x[2]
        arg[3,0,1]=(-0.44648091284)*x[0]**o+(-0.976332452987)*x[0]+(-0.886297355627)*x[1]**o+(-0.910033293533)*x[1]+(0.946007442337)*x[2]**o+(-0.586006699603)*x[2]
        arg[3,1,0]=(0.686532047098)*x[0]**o+(0.647146535444)*x[0]+(-0.424413819624)*x[1]**o+(-0.266078497115)*x[1]+(-0.656118336723)*x[2]**o+(0.902145487914)*x[2]
        arg[3,1,1]=(-0.0562438759603)*x[0]**o+(0.600872472135)*x[0]+(-0.162016187788)*x[1]**o+(-0.685387926)*x[1]+(-0.899318041513)*x[2]**o+(0.459743174318)*x[2]
        arg[4,0,0]=(-0.923373905806)*x[0]**o+(-0.0340303642214)*x[0]+(-0.798971449517)*x[1]**o+(-0.45521271974)*x[1]+(-0.354501811953)*x[2]**o+(0.0668579007274)*x[2]
        arg[4,0,1]=(0.411397784181)*x[0]**o+(0.112609440102)*x[0]+(0.352899973694)*x[1]**o+(-0.0728024007714)*x[1]+(0.50804391825)*x[2]**o+(0.748548958571)*x[2]
        arg[4,1,0]=(0.875890044031)*x[0]**o+(0.674204747948)*x[0]+(-0.879286517401)*x[1]**o+(-0.00338161978492)*x[1]+(-0.372790489717)*x[2]**o+(0.480822881409)*x[2]
        arg[4,1,1]=(-0.224827091498)*x[0]**o+(0.854170572245)*x[0]+(-0.670467931784)*x[1]**o+(0.85225464592)*x[1]+(0.41885719338)*x[2]**o+(-0.623296073831)*x[2]
        arg[5,0,0]=(-0.662704253172)*x[0]**o+(0.690656552406)*x[0]+(-0.812436958497)*x[1]**o+(0.928013493065)*x[1]+(0.763792541097)*x[2]**o+(-0.430084528987)*x[2]
        arg[5,0,1]=(0.451167682598)*x[0]**o+(0.373015986015)*x[0]+(0.73334610852)*x[1]**o+(0.44892130407)*x[1]+(0.820233215547)*x[2]**o+(0.863864357936)*x[2]
        arg[5,1,0]=(-0.700840074185)*x[0]**o+(-0.637964737375)*x[0]+(0.0532062256138)*x[1]**o+(-0.902662868597)*x[1]+(-0.91668008633)*x[2]**o+(0.00253116545509)*x[2]
        arg[5,1,1]=(0.0461834200484)*x[0]**o+(0.102406795193)*x[0]+(0.599142154957)*x[1]**o+(0.374585801545)*x[1]+(-0.444968156109)*x[2]**o+(-0.932860816729)*x[2]
        ref[0,0,0,0]=o*(-0.211459759219)*x_ref[0]**(o-1)+(-0.577684864446)
        ref[0,0,0,1]=o*(-0.391603126843)*x_ref[1]**(o-1)+(0.260321825768)
        ref[0,0,0,2]=o*(-0.314038207978)*x_ref[2]**(o-1)+(-0.981440041663)
        ref[0,0,1,0]=o*(-0.876053365684)*x_ref[0]**(o-1)+(-0.194899445893)
        ref[0,0,1,1]=o*(0.346950377505)*x_ref[1]**(o-1)+(0.571865696578)
        ref[0,0,1,2]=o*(0.632901527485)*x_ref[2]**(o-1)+(0.832258490904)
        ref[0,1,0,0]=o*(-0.0779003885155)*x_ref[0]**(o-1)+(0.583384314998)
        ref[0,1,0,1]=o*(-0.257262737021)*x_ref[1]**(o-1)+(0.456730130081)
        ref[0,1,0,2]=o*(0.262812418811)*x_ref[2]**(o-1)+(0.0815640391979)
        ref[0,1,1,0]=o*(0.087484387098)*x_ref[0]**(o-1)+(-0.415375968565)
        ref[0,1,1,1]=o*(0.31138114792)*x_ref[1]**(o-1)+(0.832138685168)
        ref[0,1,1,2]=o*(0.552625436456)*x_ref[2]**(o-1)+(-0.0969172211154)
        ref[1,0,0,0]=o*(0.721326796741)*x_ref[0]**(o-1)+(-0.556644260079)
        ref[1,0,0,1]=o*(0.14718294664)*x_ref[1]**(o-1)+(0.688425309252)
        ref[1,0,0,2]=o*(-0.16480505764)*x_ref[2]**(o-1)+(-0.914914176523)
        ref[1,0,1,0]=o*(0.0932763269908)*x_ref[0]**(o-1)+(0.359036469617)
        ref[1,0,1,1]=o*(0.568509073358)*x_ref[1]**(o-1)+(-0.42133310351)
        ref[1,0,1,2]=o*(0.576833556667)*x_ref[2]**(o-1)+(0.44466763296)
        ref[1,1,0,0]=o*(0.564028751408)*x_ref[0]**(o-1)+(-0.314840429631)
        ref[1,1,0,1]=o*(-0.910523044917)*x_ref[1]**(o-1)+(-0.0377714078758)
        ref[1,1,0,2]=o*(0.0125836031881)*x_ref[2]**(o-1)+(0.602273699833)
        ref[1,1,1,0]=o*(0.135282471986)*x_ref[0]**(o-1)+(0.163613895979)
        ref[1,1,1,1]=o*(0.115685034139)*x_ref[1]**(o-1)+(-0.687078382924)
        ref[1,1,1,2]=o*(0.406385459521)*x_ref[2]**(o-1)+(-0.401846794432)
        ref[2,0,0,0]=o*(0.815695969791)*x_ref[0]**(o-1)+(0.312205723135)
        ref[2,0,0,1]=o*(0.993404535838)*x_ref[1]**(o-1)+(0.101946422158)
        ref[2,0,0,2]=o*(-0.331818829998)*x_ref[2]**(o-1)+(-0.0034480605816)
        ref[2,0,1,0]=o*(0.638646208966)*x_ref[0]**(o-1)+(0.265838992948)
        ref[2,0,1,1]=o*(0.156594972273)*x_ref[1]**(o-1)+(0.935292984535)
        ref[2,0,1,2]=o*(-0.930522319399)*x_ref[2]**(o-1)+(0.540679813135)
        ref[2,1,0,0]=o*(-0.778823826824)*x_ref[0]**(o-1)+(0.435399707656)
        ref[2,1,0,1]=o*(0.123031900278)*x_ref[1]**(o-1)+(-0.132556439303)
        ref[2,1,0,2]=o*(-0.29114590778)*x_ref[2]**(o-1)+(-0.277636472779)
        ref[2,1,1,0]=o*(-0.200541347963)*x_ref[0]**(o-1)+(-0.526841282198)
        ref[2,1,1,1]=o*(0.670718267305)*x_ref[1]**(o-1)+(0.0777161510281)
        ref[2,1,1,2]=o*(0.847335718393)*x_ref[2]**(o-1)+(0.167185849891)
        ref[3,0,0,0]=o*(0.481112023661)*x_ref[0]**(o-1)+(-0.703558873662)
        ref[3,0,0,1]=o*(0.0661746324247)*x_ref[1]**(o-1)+(0.0628113595423)
        ref[3,0,0,2]=o*(0.804110728888)*x_ref[2]**(o-1)+(0.517297444342)
        ref[3,0,1,0]=o*(-0.44648091284)*x_ref[0]**(o-1)+(-0.976332452987)
        ref[3,0,1,1]=o*(-0.886297355627)*x_ref[1]**(o-1)+(-0.910033293533)
        ref[3,0,1,2]=o*(0.946007442337)*x_ref[2]**(o-1)+(-0.586006699603)
        ref[3,1,0,0]=o*(0.686532047098)*x_ref[0]**(o-1)+(0.647146535444)
        ref[3,1,0,1]=o*(-0.424413819624)*x_ref[1]**(o-1)+(-0.266078497115)
        ref[3,1,0,2]=o*(-0.656118336723)*x_ref[2]**(o-1)+(0.902145487914)
        ref[3,1,1,0]=o*(-0.0562438759603)*x_ref[0]**(o-1)+(0.600872472135)
        ref[3,1,1,1]=o*(-0.162016187788)*x_ref[1]**(o-1)+(-0.685387926)
        ref[3,1,1,2]=o*(-0.899318041513)*x_ref[2]**(o-1)+(0.459743174318)
        ref[4,0,0,0]=o*(-0.923373905806)*x_ref[0]**(o-1)+(-0.0340303642214)
        ref[4,0,0,1]=o*(-0.798971449517)*x_ref[1]**(o-1)+(-0.45521271974)
        ref[4,0,0,2]=o*(-0.354501811953)*x_ref[2]**(o-1)+(0.0668579007274)
        ref[4,0,1,0]=o*(0.411397784181)*x_ref[0]**(o-1)+(0.112609440102)
        ref[4,0,1,1]=o*(0.352899973694)*x_ref[1]**(o-1)+(-0.0728024007714)
        ref[4,0,1,2]=o*(0.50804391825)*x_ref[2]**(o-1)+(0.748548958571)
        ref[4,1,0,0]=o*(0.875890044031)*x_ref[0]**(o-1)+(0.674204747948)
        ref[4,1,0,1]=o*(-0.879286517401)*x_ref[1]**(o-1)+(-0.00338161978492)
        ref[4,1,0,2]=o*(-0.372790489717)*x_ref[2]**(o-1)+(0.480822881409)
        ref[4,1,1,0]=o*(-0.224827091498)*x_ref[0]**(o-1)+(0.854170572245)
        ref[4,1,1,1]=o*(-0.670467931784)*x_ref[1]**(o-1)+(0.85225464592)
        ref[4,1,1,2]=o*(0.41885719338)*x_ref[2]**(o-1)+(-0.623296073831)
        ref[5,0,0,0]=o*(-0.662704253172)*x_ref[0]**(o-1)+(0.690656552406)
        ref[5,0,0,1]=o*(-0.812436958497)*x_ref[1]**(o-1)+(0.928013493065)
        ref[5,0,0,2]=o*(0.763792541097)*x_ref[2]**(o-1)+(-0.430084528987)
        ref[5,0,1,0]=o*(0.451167682598)*x_ref[0]**(o-1)+(0.373015986015)
        ref[5,0,1,1]=o*(0.73334610852)*x_ref[1]**(o-1)+(0.44892130407)
        ref[5,0,1,2]=o*(0.820233215547)*x_ref[2]**(o-1)+(0.863864357936)
        ref[5,1,0,0]=o*(-0.700840074185)*x_ref[0]**(o-1)+(-0.637964737375)
        ref[5,1,0,1]=o*(0.0532062256138)*x_ref[1]**(o-1)+(-0.902662868597)
        ref[5,1,0,2]=o*(-0.91668008633)*x_ref[2]**(o-1)+(0.00253116545509)
        ref[5,1,1,0]=o*(0.0461834200484)*x_ref[0]**(o-1)+(0.102406795193)
        ref[5,1,1,1]=o*(0.599142154957)*x_ref[1]**(o-1)+(0.374585801545)
        ref[5,1,1,2]=o*(-0.444968156109)*x_ref[2]**(o-1)+(-0.932860816729)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(1.37238770251)*x[0]+(-1.43917937019)*x[1]
        ref[0]=(1.37238770251)
        ref[1]=(-1.43917937019)
      else:
        arg=(0.951563810847)*x[0]+(-1.91408943437)*x[1]+(0.233861671105)*x[2]
        ref[0]=(0.951563810847)
        ref[1]=(-1.91408943437)
        ref[2]=(0.233861671105)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(1.42921344972)*x[0]+(-0.911436505176)*x[1]
        arg[1]=(1.25688300316)*x[0]+(0.0536640238292)*x[1]
        ref[0,0]=(1.42921344972)
        ref[0,1]=(-0.911436505176)
        ref[1,0]=(1.25688300316)
        ref[1,1]=(0.0536640238292)
      else:
        arg[0]=(-1.57773112011)*x[0]+(-0.697311790617)*x[1]+(-0.480770363787)*x[2]
        arg[1]=(-0.136063655594)*x[0]+(0.882253548646)*x[1]+(1.35773570995)*x[2]
        ref[0,0]=(-1.57773112011)
        ref[0,1]=(-0.697311790617)
        ref[0,2]=(-0.480770363787)
        ref[1,0]=(-0.136063655594)
        ref[1,1]=(0.882253548646)
        ref[1,2]=(1.35773570995)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.448247291087)*x[0]+(-0.00880442943882)*x[1]
        arg[0,1]=(-0.59784234455)*x[0]+(-0.94951606979)*x[1]
        arg[0,2]=(1.38316656933)*x[0]+(-0.124817047005)*x[1]
        arg[0,3]=(-0.0748469893414)*x[0]+(1.44145142047)*x[1]
        arg[0,4]=(1.81133385456)*x[0]+(-0.518406894403)*x[1]
        arg[1,0]=(-0.65460152624)*x[0]+(-0.350858526434)*x[1]
        arg[1,1]=(0.924058009558)*x[0]+(-0.40973995895)*x[1]
        arg[1,2]=(-0.299794705178)*x[0]+(-0.924557696915)*x[1]
        arg[1,3]=(-0.608513627169)*x[0]+(-0.141936714389)*x[1]
        arg[1,4]=(0.469099778997)*x[0]+(0.754132353456)*x[1]
        arg[2,0]=(-0.627098551951)*x[0]+(0.476865448119)*x[1]
        arg[2,1]=(-1.03564375134)*x[0]+(-0.280009187543)*x[1]
        arg[2,2]=(0.475083576156)*x[0]+(0.220248066616)*x[1]
        arg[2,3]=(0.0420499398173)*x[0]+(0.0808105284548)*x[1]
        arg[2,4]=(0.368173655662)*x[0]+(-0.58266909961)*x[1]
        arg[3,0]=(0.450851110298)*x[0]+(0.0844590226087)*x[1]
        arg[3,1]=(0.508010554654)*x[0]+(0.797109833792)*x[1]
        arg[3,2]=(0.711479388001)*x[0]+(1.12829906729)*x[1]
        arg[3,3]=(0.0588799697153)*x[0]+(-0.991874826409)*x[1]
        arg[3,4]=(0.743446045536)*x[0]+(0.65754450588)*x[1]
        ref[0,0,0]=(0.448247291087)
        ref[0,0,1]=(-0.00880442943882)
        ref[0,1,0]=(-0.59784234455)
        ref[0,1,1]=(-0.94951606979)
        ref[0,2,0]=(1.38316656933)
        ref[0,2,1]=(-0.124817047005)
        ref[0,3,0]=(-0.0748469893414)
        ref[0,3,1]=(1.44145142047)
        ref[0,4,0]=(1.81133385456)
        ref[0,4,1]=(-0.518406894403)
        ref[1,0,0]=(-0.65460152624)
        ref[1,0,1]=(-0.350858526434)
        ref[1,1,0]=(0.924058009558)
        ref[1,1,1]=(-0.40973995895)
        ref[1,2,0]=(-0.299794705178)
        ref[1,2,1]=(-0.924557696915)
        ref[1,3,0]=(-0.608513627169)
        ref[1,3,1]=(-0.141936714389)
        ref[1,4,0]=(0.469099778997)
        ref[1,4,1]=(0.754132353456)
        ref[2,0,0]=(-0.627098551951)
        ref[2,0,1]=(0.476865448119)
        ref[2,1,0]=(-1.03564375134)
        ref[2,1,1]=(-0.280009187543)
        ref[2,2,0]=(0.475083576156)
        ref[2,2,1]=(0.220248066616)
        ref[2,3,0]=(0.0420499398173)
        ref[2,3,1]=(0.0808105284548)
        ref[2,4,0]=(0.368173655662)
        ref[2,4,1]=(-0.58266909961)
        ref[3,0,0]=(0.450851110298)
        ref[3,0,1]=(0.0844590226087)
        ref[3,1,0]=(0.508010554654)
        ref[3,1,1]=(0.797109833792)
        ref[3,2,0]=(0.711479388001)
        ref[3,2,1]=(1.12829906729)
        ref[3,3,0]=(0.0588799697153)
        ref[3,3,1]=(-0.991874826409)
        ref[3,4,0]=(0.743446045536)
        ref[3,4,1]=(0.65754450588)
      else:
        arg[0,0]=(-0.43386387868)*x[0]+(0.321105491776)*x[1]+(0.384206679414)*x[2]
        arg[0,1]=(0.604698878149)*x[0]+(0.594375439325)*x[1]+(0.162832272176)*x[2]
        arg[0,2]=(-0.332194829416)*x[0]+(0.600821281937)*x[1]+(0.493622302813)*x[2]
        arg[0,3]=(0.846367268698)*x[0]+(-1.32744832381)*x[1]+(0.00466654421944)*x[2]
        arg[0,4]=(0.385111950936)*x[0]+(-0.176705693397)*x[1]+(0.461732370075)*x[2]
        arg[1,0]=(-0.14529643778)*x[0]+(1.15329219838)*x[1]+(0.157842247326)*x[2]
        arg[1,1]=(0.00817149012591)*x[0]+(-0.703898404732)*x[1]+(-1.14419500663)*x[2]
        arg[1,2]=(-0.124155034423)*x[0]+(0.906000496919)*x[1]+(-0.466071596735)*x[2]
        arg[1,3]=(0.413190740147)*x[0]+(0.968639404637)*x[1]+(-1.25413312698)*x[2]
        arg[1,4]=(0.521974966379)*x[0]+(0.936384991187)*x[1]+(-0.0630547476157)*x[2]
        arg[2,0]=(-0.334976510608)*x[0]+(-0.268364721371)*x[1]+(0.806974769679)*x[2]
        arg[2,1]=(-0.0672705162033)*x[0]+(0.459808873839)*x[1]+(0.0725634327358)*x[2]
        arg[2,2]=(0.142418012401)*x[0]+(-0.400301432498)*x[1]+(-1.37021128371)*x[2]
        arg[2,3]=(-1.60617980561)*x[0]+(0.0686943218654)*x[1]+(0.647509287658)*x[2]
        arg[2,4]=(0.0102366197695)*x[0]+(-1.24104511219)*x[1]+(-0.739463479584)*x[2]
        arg[3,0]=(-0.425526939568)*x[0]+(-0.946421307227)*x[1]+(0.133101457377)*x[2]
        arg[3,1]=(1.07183638389)*x[0]+(-1.21405997903)*x[1]+(-0.962984008606)*x[2]
        arg[3,2]=(-0.913456686897)*x[0]+(0.907233128077)*x[1]+(0.581609247137)*x[2]
        arg[3,3]=(-0.729544885457)*x[0]+(-0.433435638004)*x[1]+(0.357011166494)*x[2]
        arg[3,4]=(1.21906931308)*x[0]+(0.322487716786)*x[1]+(1.05602783674)*x[2]
        ref[0,0,0]=(-0.43386387868)
        ref[0,0,1]=(0.321105491776)
        ref[0,0,2]=(0.384206679414)
        ref[0,1,0]=(0.604698878149)
        ref[0,1,1]=(0.594375439325)
        ref[0,1,2]=(0.162832272176)
        ref[0,2,0]=(-0.332194829416)
        ref[0,2,1]=(0.600821281937)
        ref[0,2,2]=(0.493622302813)
        ref[0,3,0]=(0.846367268698)
        ref[0,3,1]=(-1.32744832381)
        ref[0,3,2]=(0.00466654421944)
        ref[0,4,0]=(0.385111950936)
        ref[0,4,1]=(-0.176705693397)
        ref[0,4,2]=(0.461732370075)
        ref[1,0,0]=(-0.14529643778)
        ref[1,0,1]=(1.15329219838)
        ref[1,0,2]=(0.157842247326)
        ref[1,1,0]=(0.00817149012591)
        ref[1,1,1]=(-0.703898404732)
        ref[1,1,2]=(-1.14419500663)
        ref[1,2,0]=(-0.124155034423)
        ref[1,2,1]=(0.906000496919)
        ref[1,2,2]=(-0.466071596735)
        ref[1,3,0]=(0.413190740147)
        ref[1,3,1]=(0.968639404637)
        ref[1,3,2]=(-1.25413312698)
        ref[1,4,0]=(0.521974966379)
        ref[1,4,1]=(0.936384991187)
        ref[1,4,2]=(-0.0630547476157)
        ref[2,0,0]=(-0.334976510608)
        ref[2,0,1]=(-0.268364721371)
        ref[2,0,2]=(0.806974769679)
        ref[2,1,0]=(-0.0672705162033)
        ref[2,1,1]=(0.459808873839)
        ref[2,1,2]=(0.0725634327358)
        ref[2,2,0]=(0.142418012401)
        ref[2,2,1]=(-0.400301432498)
        ref[2,2,2]=(-1.37021128371)
        ref[2,3,0]=(-1.60617980561)
        ref[2,3,1]=(0.0686943218654)
        ref[2,3,2]=(0.647509287658)
        ref[2,4,0]=(0.0102366197695)
        ref[2,4,1]=(-1.24104511219)
        ref[2,4,2]=(-0.739463479584)
        ref[3,0,0]=(-0.425526939568)
        ref[3,0,1]=(-0.946421307227)
        ref[3,0,2]=(0.133101457377)
        ref[3,1,0]=(1.07183638389)
        ref[3,1,1]=(-1.21405997903)
        ref[3,1,2]=(-0.962984008606)
        ref[3,2,0]=(-0.913456686897)
        ref[3,2,1]=(0.907233128077)
        ref[3,2,2]=(0.581609247137)
        ref[3,3,0]=(-0.729544885457)
        ref[3,3,1]=(-0.433435638004)
        ref[3,3,2]=(0.357011166494)
        ref[3,4,0]=(1.21906931308)
        ref[3,4,1]=(0.322487716786)
        ref[3,4,2]=(1.05602783674)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromData_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(-0.287546203823)*x[0]+(0.390321729967)*x[1]
        arg[0,0,1]=(-0.112653571553)*x[0]+(-0.359753186922)*x[1]
        arg[0,1,0]=(0.00656985674969)*x[0]+(-0.397210304393)*x[1]
        arg[0,1,1]=(-0.825698431533)*x[0]+(-1.20994477496)*x[1]
        arg[1,0,0]=(0.0456789352898)*x[0]+(0.201178709355)*x[1]
        arg[1,0,1]=(0.216619650199)*x[0]+(-0.684237394127)*x[1]
        arg[1,1,0]=(-0.452605086273)*x[0]+(0.383220784575)*x[1]
        arg[1,1,1]=(-0.385315869703)*x[0]+(-1.25937320051)*x[1]
        arg[2,0,0]=(-0.546290546777)*x[0]+(0.0659124729108)*x[1]
        arg[2,0,1]=(0.23413834434)*x[0]+(0.241510050424)*x[1]
        arg[2,1,0]=(-0.541097368124)*x[0]+(0.458682016611)*x[1]
        arg[2,1,1]=(0.314030173817)*x[0]+(0.083613884286)*x[1]
        arg[3,0,0]=(0.862005271666)*x[0]+(0.858693755091)*x[1]
        arg[3,0,1]=(-1.14220805291)*x[0]+(0.609875693913)*x[1]
        arg[3,1,0]=(-0.847069360014)*x[0]+(0.240069314456)*x[1]
        arg[3,1,1]=(0.480596211718)*x[0]+(-1.40901297384)*x[1]
        arg[4,0,0]=(-1.38036653523)*x[0]+(-0.0732955000278)*x[1]
        arg[4,0,1]=(0.0716061704803)*x[0]+(0.180127379412)*x[1]
        arg[4,1,0]=(1.26959959862)*x[0]+(-1.38131896436)*x[1]
        arg[4,1,1]=(0.204280361123)*x[0]+(0.532611514369)*x[1]
        arg[5,0,0]=(0.209536293545)*x[0]+(-0.303994906788)*x[1]
        arg[5,0,1]=(1.41150162289)*x[0]+(1.32515735407)*x[1]
        arg[5,1,0]=(1.59736027384)*x[0]+(-0.711055564868)*x[1]
        arg[5,1,1]=(-1.31799658024)*x[0]+(0.829209493108)*x[1]
        ref[0,0,0,0]=(-0.287546203823)
        ref[0,0,0,1]=(0.390321729967)
        ref[0,0,1,0]=(-0.112653571553)
        ref[0,0,1,1]=(-0.359753186922)
        ref[0,1,0,0]=(0.00656985674969)
        ref[0,1,0,1]=(-0.397210304393)
        ref[0,1,1,0]=(-0.825698431533)
        ref[0,1,1,1]=(-1.20994477496)
        ref[1,0,0,0]=(0.0456789352898)
        ref[1,0,0,1]=(0.201178709355)
        ref[1,0,1,0]=(0.216619650199)
        ref[1,0,1,1]=(-0.684237394127)
        ref[1,1,0,0]=(-0.452605086273)
        ref[1,1,0,1]=(0.383220784575)
        ref[1,1,1,0]=(-0.385315869703)
        ref[1,1,1,1]=(-1.25937320051)
        ref[2,0,0,0]=(-0.546290546777)
        ref[2,0,0,1]=(0.0659124729108)
        ref[2,0,1,0]=(0.23413834434)
        ref[2,0,1,1]=(0.241510050424)
        ref[2,1,0,0]=(-0.541097368124)
        ref[2,1,0,1]=(0.458682016611)
        ref[2,1,1,0]=(0.314030173817)
        ref[2,1,1,1]=(0.083613884286)
        ref[3,0,0,0]=(0.862005271666)
        ref[3,0,0,1]=(0.858693755091)
        ref[3,0,1,0]=(-1.14220805291)
        ref[3,0,1,1]=(0.609875693913)
        ref[3,1,0,0]=(-0.847069360014)
        ref[3,1,0,1]=(0.240069314456)
        ref[3,1,1,0]=(0.480596211718)
        ref[3,1,1,1]=(-1.40901297384)
        ref[4,0,0,0]=(-1.38036653523)
        ref[4,0,0,1]=(-0.0732955000278)
        ref[4,0,1,0]=(0.0716061704803)
        ref[4,0,1,1]=(0.180127379412)
        ref[4,1,0,0]=(1.26959959862)
        ref[4,1,0,1]=(-1.38131896436)
        ref[4,1,1,0]=(0.204280361123)
        ref[4,1,1,1]=(0.532611514369)
        ref[5,0,0,0]=(0.209536293545)
        ref[5,0,0,1]=(-0.303994906788)
        ref[5,0,1,0]=(1.41150162289)
        ref[5,0,1,1]=(1.32515735407)
        ref[5,1,0,0]=(1.59736027384)
        ref[5,1,0,1]=(-0.711055564868)
        ref[5,1,1,0]=(-1.31799658024)
        ref[5,1,1,1]=(0.829209493108)
      else:
        arg[0,0,0]=(0.832267408258)*x[0]+(-1.1995239623)*x[1]+(-1.81276973398)*x[2]
        arg[0,0,1]=(-0.0125232856194)*x[0]+(0.122543918666)*x[1]+(-1.12411286836)*x[2]
        arg[0,1,0]=(0.985611388383)*x[0]+(-1.17217207383)*x[1]+(-0.231241872108)*x[2]
        arg[0,1,1]=(0.625494139449)*x[0]+(0.784802683192)*x[1]+(0.612764525973)*x[2]
        arg[1,0,0]=(0.327644975022)*x[0]+(0.0552951801276)*x[1]+(-0.806887445103)*x[2]
        arg[1,0,1]=(0.194338798022)*x[0]+(0.799902026341)*x[1]+(1.70164249741)*x[2]
        arg[1,1,0]=(0.890832636865)*x[0]+(0.223899365292)*x[1]+(-0.283094526824)*x[2]
        arg[1,1,1]=(-0.122108330088)*x[0]+(-0.293413695547)*x[1]+(-0.371581852879)*x[2]
        arg[2,0,0]=(-0.469341678297)*x[0]+(0.152856292978)*x[1]+(0.765861314481)*x[2]
        arg[2,0,1]=(0.249219162734)*x[0]+(0.319622173697)*x[1]+(-0.182998471546)*x[2]
        arg[2,1,0]=(0.39687496584)*x[0]+(0.137084411978)*x[1]+(-0.34707250854)*x[2]
        arg[2,1,1]=(-0.382391798519)*x[0]+(0.755317411547)*x[1]+(0.424204162929)*x[2]
        arg[3,0,0]=(1.12637976255)*x[0]+(0.11632178776)*x[1]+(-0.615547388072)*x[2]
        arg[3,0,1]=(-0.819303259446)*x[0]+(0.916951216368)*x[1]+(-0.572792050441)*x[2]
        arg[3,1,0]=(0.194642055711)*x[0]+(0.949663114037)*x[1]+(-0.403001914682)*x[2]
        arg[3,1,1]=(0.902547242635)*x[0]+(-1.04027936291)*x[1]+(-1.78463515221)*x[2]
        arg[4,0,0]=(0.59060036737)*x[0]+(-0.580905638676)*x[1]+(-0.486098556884)*x[2]
        arg[4,0,1]=(-0.330634605524)*x[0]+(-0.758140973629)*x[1]+(-0.192282397672)*x[2]
        arg[4,1,0]=(1.40502801336)*x[0]+(0.199036161455)*x[1]+(-0.558660947885)*x[2]
        arg[4,1,1]=(-0.155588274273)*x[0]+(-0.57050736529)*x[1]+(1.1998664442)*x[2]
        arg[5,0,0]=(-0.754680865929)*x[0]+(1.29040984028)*x[1]+(-1.83778974463)*x[2]
        arg[5,0,1]=(0.274692501647)*x[0]+(0.368546080921)*x[1]+(-0.446376269232)*x[2]
        arg[5,1,0]=(-0.758704372861)*x[0]+(1.75555227426)*x[1]+(-0.13664688871)*x[2]
        arg[5,1,1]=(-0.568468068187)*x[0]+(-0.320218561544)*x[1]+(-0.827795466031)*x[2]
        ref[0,0,0,0]=(0.832267408258)
        ref[0,0,0,1]=(-1.1995239623)
        ref[0,0,0,2]=(-1.81276973398)
        ref[0,0,1,0]=(-0.0125232856194)
        ref[0,0,1,1]=(0.122543918666)
        ref[0,0,1,2]=(-1.12411286836)
        ref[0,1,0,0]=(0.985611388383)
        ref[0,1,0,1]=(-1.17217207383)
        ref[0,1,0,2]=(-0.231241872108)
        ref[0,1,1,0]=(0.625494139449)
        ref[0,1,1,1]=(0.784802683192)
        ref[0,1,1,2]=(0.612764525973)
        ref[1,0,0,0]=(0.327644975022)
        ref[1,0,0,1]=(0.0552951801276)
        ref[1,0,0,2]=(-0.806887445103)
        ref[1,0,1,0]=(0.194338798022)
        ref[1,0,1,1]=(0.799902026341)
        ref[1,0,1,2]=(1.70164249741)
        ref[1,1,0,0]=(0.890832636865)
        ref[1,1,0,1]=(0.223899365292)
        ref[1,1,0,2]=(-0.283094526824)
        ref[1,1,1,0]=(-0.122108330088)
        ref[1,1,1,1]=(-0.293413695547)
        ref[1,1,1,2]=(-0.371581852879)
        ref[2,0,0,0]=(-0.469341678297)
        ref[2,0,0,1]=(0.152856292978)
        ref[2,0,0,2]=(0.765861314481)
        ref[2,0,1,0]=(0.249219162734)
        ref[2,0,1,1]=(0.319622173697)
        ref[2,0,1,2]=(-0.182998471546)
        ref[2,1,0,0]=(0.39687496584)
        ref[2,1,0,1]=(0.137084411978)
        ref[2,1,0,2]=(-0.34707250854)
        ref[2,1,1,0]=(-0.382391798519)
        ref[2,1,1,1]=(0.755317411547)
        ref[2,1,1,2]=(0.424204162929)
        ref[3,0,0,0]=(1.12637976255)
        ref[3,0,0,1]=(0.11632178776)
        ref[3,0,0,2]=(-0.615547388072)
        ref[3,0,1,0]=(-0.819303259446)
        ref[3,0,1,1]=(0.916951216368)
        ref[3,0,1,2]=(-0.572792050441)
        ref[3,1,0,0]=(0.194642055711)
        ref[3,1,0,1]=(0.949663114037)
        ref[3,1,0,2]=(-0.403001914682)
        ref[3,1,1,0]=(0.902547242635)
        ref[3,1,1,1]=(-1.04027936291)
        ref[3,1,1,2]=(-1.78463515221)
        ref[4,0,0,0]=(0.59060036737)
        ref[4,0,0,1]=(-0.580905638676)
        ref[4,0,0,2]=(-0.486098556884)
        ref[4,0,1,0]=(-0.330634605524)
        ref[4,0,1,1]=(-0.758140973629)
        ref[4,0,1,2]=(-0.192282397672)
        ref[4,1,0,0]=(1.40502801336)
        ref[4,1,0,1]=(0.199036161455)
        ref[4,1,0,2]=(-0.558660947885)
        ref[4,1,1,0]=(-0.155588274273)
        ref[4,1,1,1]=(-0.57050736529)
        ref[4,1,1,2]=(1.1998664442)
        ref[5,0,0,0]=(-0.754680865929)
        ref[5,0,0,1]=(1.29040984028)
        ref[5,0,0,2]=(-1.83778974463)
        ref[5,0,1,0]=(0.274692501647)
        ref[5,0,1,1]=(0.368546080921)
        ref[5,0,1,2]=(-0.446376269232)
        ref[5,1,0,0]=(-0.758704372861)
        ref[5,1,0,1]=(1.75555227426)
        ref[5,1,0,2]=(-0.13664688871)
        ref[5,1,1,0]=(-0.568468068187)
        ref[5,1,1,1]=(-0.320218561544)
        ref[5,1,1,2]=(-0.827795466031)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(-0.132000741495)*x[0]**o+(0.122399178026)*x[0]+(-0.285047923022)*x[1]**o+(0.665814814322)*x[1]
        ref[0]=o*(-0.132000741495)*x_ref[0]**(o-1)+(0.122399178026)
        ref[1]=o*(-0.285047923022)*x_ref[1]**(o-1)+(0.665814814322)
      else:
        s=(0.596417375474)*x[0]**o+(0.780542320679)*x[0]+(-0.59348113736)*x[1]**o+(0.755472585752)*x[1]+(-0.423796298696)*x[2]**o+(0.917578429027)*x[2]
        ref[0]=o*(0.596417375474)*x_ref[0]**(o-1)+(0.780542320679)
        ref[1]=o*(-0.59348113736)*x_ref[1]**(o-1)+(0.755472585752)
        ref[2]=o*(-0.423796298696)*x_ref[2]**(o-1)+(0.917578429027)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(0.624689355591)*x[0]**o+(-0.747728245047)*x[0]+(0.692787021065)*x[1]**o+(-0.70629082384)*x[1]
        s[1]=(-0.225695886421)*x[0]**o+(-0.444535961493)*x[0]+(0.235690936232)*x[1]**o+(-0.970876426657)*x[1]
        ref[0,0]=o*(0.624689355591)*x_ref[0]**(o-1)+(-0.747728245047)
        ref[0,1]=o*(0.692787021065)*x_ref[1]**(o-1)+(-0.70629082384)
        ref[1,0]=o*(-0.225695886421)*x_ref[0]**(o-1)+(-0.444535961493)
        ref[1,1]=o*(0.235690936232)*x_ref[1]**(o-1)+(-0.970876426657)
      else:
        s[0]=(-0.459906225365)*x[0]**o+(-0.976920232334)*x[0]+(-0.359230869877)*x[1]**o+(0.99442848994)*x[1]+(-0.462181187731)*x[2]**o+(-0.272763004354)*x[2]
        s[1]=(-0.384545997957)*x[0]**o+(0.206838344134)*x[0]+(0.827958420952)*x[1]**o+(0.851604767316)*x[1]+(0.180277208362)*x[2]**o+(0.276165244173)*x[2]
        ref[0,0]=o*(-0.459906225365)*x_ref[0]**(o-1)+(-0.976920232334)
        ref[0,1]=o*(-0.359230869877)*x_ref[1]**(o-1)+(0.99442848994)
        ref[0,2]=o*(-0.462181187731)*x_ref[2]**(o-1)+(-0.272763004354)
        ref[1,0]=o*(-0.384545997957)*x_ref[0]**(o-1)+(0.206838344134)
        ref[1,1]=o*(0.827958420952)*x_ref[1]**(o-1)+(0.851604767316)
        ref[1,2]=o*(0.180277208362)*x_ref[2]**(o-1)+(0.276165244173)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.866700100162)*x[0]**o+(-0.443253975067)*x[0]+(0.930660789831)*x[1]**o+(0.348981739779)*x[1]
        s[0,1]=(0.595655533809)*x[0]**o+(0.425701794417)*x[0]+(-0.700204056577)*x[1]**o+(-0.606084182043)*x[1]
        s[0,2]=(-0.0975376318378)*x[0]**o+(0.0352659915524)*x[0]+(0.336096329457)*x[1]**o+(-0.604536128515)*x[1]
        s[0,3]=(0.932694885424)*x[0]**o+(0.848315864182)*x[0]+(0.294198667412)*x[1]**o+(-0.548590122662)*x[1]
        s[0,4]=(-0.464671727588)*x[0]**o+(-0.479615042615)*x[0]+(-0.205470141615)*x[1]**o+(-0.771280534115)*x[1]
        s[1,0]=(0.459832819849)*x[0]**o+(-0.703780783428)*x[0]+(0.101094024974)*x[1]**o+(-0.504757888238)*x[1]
        s[1,1]=(-0.74483211902)*x[0]**o+(0.467112390979)*x[0]+(-0.956618977211)*x[1]**o+(0.455481886754)*x[1]
        s[1,2]=(0.0976209987456)*x[0]**o+(0.44469736085)*x[0]+(-0.213220033441)*x[1]**o+(0.0448880653868)*x[1]
        s[1,3]=(0.18795879454)*x[0]**o+(0.603296276978)*x[0]+(-0.915713437955)*x[1]**o+(0.911772973549)*x[1]
        s[1,4]=(-0.960678163557)*x[0]**o+(0.000798715245087)*x[0]+(-0.195050046209)*x[1]**o+(0.55429412919)*x[1]
        s[2,0]=(-0.885615347975)*x[0]**o+(-0.0757793285493)*x[0]+(0.643863139156)*x[1]**o+(-0.617158285199)*x[1]
        s[2,1]=(0.232668453484)*x[0]**o+(0.586242977718)*x[0]+(-0.728810607608)*x[1]**o+(0.826248720042)*x[1]
        s[2,2]=(-0.893353803021)*x[0]**o+(-0.510393964603)*x[0]+(0.851185573516)*x[1]**o+(0.821075933157)*x[1]
        s[2,3]=(0.567570646968)*x[0]**o+(0.282673304306)*x[0]+(0.636861243255)*x[1]**o+(0.308681123745)*x[1]
        s[2,4]=(0.843072247533)*x[0]**o+(-0.302083248085)*x[0]+(-0.147818607759)*x[1]**o+(-0.796766854695)*x[1]
        s[3,0]=(-0.000711103721221)*x[0]**o+(0.730198459281)*x[0]+(0.395333992473)*x[1]**o+(0.743896557243)*x[1]
        s[3,1]=(0.615705307589)*x[0]**o+(0.74607803139)*x[0]+(0.837364825996)*x[1]**o+(0.362527888693)*x[1]
        s[3,2]=(-0.431332008116)*x[0]**o+(-0.5449015623)*x[0]+(0.0435062014388)*x[1]**o+(-0.408079384098)*x[1]
        s[3,3]=(-0.887047605579)*x[0]**o+(-0.966245172182)*x[0]+(-0.457094377191)*x[1]**o+(0.934841781784)*x[1]
        s[3,4]=(-0.6212484366)*x[0]**o+(0.99908421004)*x[0]+(0.75098732282)*x[1]**o+(-0.0868062878539)*x[1]
        ref[0,0,0]=o*(-0.866700100162)*x_ref[0]**(o-1)+(-0.443253975067)
        ref[0,0,1]=o*(0.930660789831)*x_ref[1]**(o-1)+(0.348981739779)
        ref[0,1,0]=o*(0.595655533809)*x_ref[0]**(o-1)+(0.425701794417)
        ref[0,1,1]=o*(-0.700204056577)*x_ref[1]**(o-1)+(-0.606084182043)
        ref[0,2,0]=o*(-0.0975376318378)*x_ref[0]**(o-1)+(0.0352659915524)
        ref[0,2,1]=o*(0.336096329457)*x_ref[1]**(o-1)+(-0.604536128515)
        ref[0,3,0]=o*(0.932694885424)*x_ref[0]**(o-1)+(0.848315864182)
        ref[0,3,1]=o*(0.294198667412)*x_ref[1]**(o-1)+(-0.548590122662)
        ref[0,4,0]=o*(-0.464671727588)*x_ref[0]**(o-1)+(-0.479615042615)
        ref[0,4,1]=o*(-0.205470141615)*x_ref[1]**(o-1)+(-0.771280534115)
        ref[1,0,0]=o*(0.459832819849)*x_ref[0]**(o-1)+(-0.703780783428)
        ref[1,0,1]=o*(0.101094024974)*x_ref[1]**(o-1)+(-0.504757888238)
        ref[1,1,0]=o*(-0.74483211902)*x_ref[0]**(o-1)+(0.467112390979)
        ref[1,1,1]=o*(-0.956618977211)*x_ref[1]**(o-1)+(0.455481886754)
        ref[1,2,0]=o*(0.0976209987456)*x_ref[0]**(o-1)+(0.44469736085)
        ref[1,2,1]=o*(-0.213220033441)*x_ref[1]**(o-1)+(0.0448880653868)
        ref[1,3,0]=o*(0.18795879454)*x_ref[0]**(o-1)+(0.603296276978)
        ref[1,3,1]=o*(-0.915713437955)*x_ref[1]**(o-1)+(0.911772973549)
        ref[1,4,0]=o*(-0.960678163557)*x_ref[0]**(o-1)+(0.000798715245087)
        ref[1,4,1]=o*(-0.195050046209)*x_ref[1]**(o-1)+(0.55429412919)
        ref[2,0,0]=o*(-0.885615347975)*x_ref[0]**(o-1)+(-0.0757793285493)
        ref[2,0,1]=o*(0.643863139156)*x_ref[1]**(o-1)+(-0.617158285199)
        ref[2,1,0]=o*(0.232668453484)*x_ref[0]**(o-1)+(0.586242977718)
        ref[2,1,1]=o*(-0.728810607608)*x_ref[1]**(o-1)+(0.826248720042)
        ref[2,2,0]=o*(-0.893353803021)*x_ref[0]**(o-1)+(-0.510393964603)
        ref[2,2,1]=o*(0.851185573516)*x_ref[1]**(o-1)+(0.821075933157)
        ref[2,3,0]=o*(0.567570646968)*x_ref[0]**(o-1)+(0.282673304306)
        ref[2,3,1]=o*(0.636861243255)*x_ref[1]**(o-1)+(0.308681123745)
        ref[2,4,0]=o*(0.843072247533)*x_ref[0]**(o-1)+(-0.302083248085)
        ref[2,4,1]=o*(-0.147818607759)*x_ref[1]**(o-1)+(-0.796766854695)
        ref[3,0,0]=o*(-0.000711103721221)*x_ref[0]**(o-1)+(0.730198459281)
        ref[3,0,1]=o*(0.395333992473)*x_ref[1]**(o-1)+(0.743896557243)
        ref[3,1,0]=o*(0.615705307589)*x_ref[0]**(o-1)+(0.74607803139)
        ref[3,1,1]=o*(0.837364825996)*x_ref[1]**(o-1)+(0.362527888693)
        ref[3,2,0]=o*(-0.431332008116)*x_ref[0]**(o-1)+(-0.5449015623)
        ref[3,2,1]=o*(0.0435062014388)*x_ref[1]**(o-1)+(-0.408079384098)
        ref[3,3,0]=o*(-0.887047605579)*x_ref[0]**(o-1)+(-0.966245172182)
        ref[3,3,1]=o*(-0.457094377191)*x_ref[1]**(o-1)+(0.934841781784)
        ref[3,4,0]=o*(-0.6212484366)*x_ref[0]**(o-1)+(0.99908421004)
        ref[3,4,1]=o*(0.75098732282)*x_ref[1]**(o-1)+(-0.0868062878539)
      else:
        s[0,0]=(0.729942219527)*x[0]**o+(-0.721160545053)*x[0]+(0.426397843912)*x[1]**o+(-0.213185647354)*x[1]+(0.728447138266)*x[2]**o+(-0.607791661013)*x[2]
        s[0,1]=(0.667616392653)*x[0]**o+(0.848051730251)*x[0]+(0.121550076489)*x[1]**o+(0.0843862117633)*x[1]+(-0.509323081526)*x[2]**o+(0.736521833786)*x[2]
        s[0,2]=(0.830127288575)*x[0]**o+(0.964772646621)*x[0]+(0.913688863179)*x[1]**o+(0.957018200531)*x[1]+(-0.694170056751)*x[2]**o+(0.105973113953)*x[2]
        s[0,3]=(-0.235173218805)*x[0]**o+(0.858875579758)*x[0]+(0.823162706883)*x[1]**o+(0.108717821259)*x[1]+(0.80411364975)*x[2]**o+(0.0348079894361)*x[2]
        s[0,4]=(0.78867654833)*x[0]**o+(-0.0191953378129)*x[0]+(-0.0840244773387)*x[1]**o+(0.614156921824)*x[1]+(-0.0190397891394)*x[2]**o+(0.750918932533)*x[2]
        s[1,0]=(-0.0931449972666)*x[0]**o+(0.887179037493)*x[0]+(0.163173866494)*x[1]**o+(-0.0429615650925)*x[1]+(0.246231141028)*x[2]**o+(0.835506100749)*x[2]
        s[1,1]=(-0.0644771805334)*x[0]**o+(-0.447016488171)*x[0]+(0.525187872112)*x[1]**o+(0.0698248427183)*x[1]+(0.206184560671)*x[2]**o+(0.0760145857359)*x[2]
        s[1,2]=(-0.468079677328)*x[0]**o+(0.209734412741)*x[0]+(-0.76390490599)*x[1]**o+(-0.890555632144)*x[1]+(0.0940465019231)*x[2]**o+(-0.4911374279)*x[2]
        s[1,3]=(0.0219043704096)*x[0]**o+(0.843668836143)*x[0]+(-0.496594214362)*x[1]**o+(-0.698887537236)*x[1]+(0.739801576727)*x[2]**o+(-0.283969520066)*x[2]
        s[1,4]=(0.626836103474)*x[0]**o+(-0.209145555082)*x[0]+(0.0527420557385)*x[1]**o+(0.447276924763)*x[1]+(0.753404625572)*x[2]**o+(-0.964517776982)*x[2]
        s[2,0]=(0.208209713508)*x[0]**o+(0.666027366366)*x[0]+(0.648558221549)*x[1]**o+(-0.867196856985)*x[1]+(-0.386920813405)*x[2]**o+(-0.859803466402)*x[2]
        s[2,1]=(0.192327689645)*x[0]**o+(0.706632402773)*x[0]+(-0.917135230541)*x[1]**o+(-0.518142383283)*x[1]+(0.63345047167)*x[2]**o+(0.452536991007)*x[2]
        s[2,2]=(-0.216559791626)*x[0]**o+(0.280416285835)*x[0]+(0.880532961859)*x[1]**o+(-0.685211600885)*x[1]+(0.435667186231)*x[2]**o+(0.632733331589)*x[2]
        s[2,3]=(0.52338353111)*x[0]**o+(-0.865976270688)*x[0]+(0.598776819058)*x[1]**o+(-0.404416433163)*x[1]+(-0.538779785754)*x[2]**o+(-0.708928887004)*x[2]
        s[2,4]=(0.523035959616)*x[0]**o+(0.732324929631)*x[0]+(0.213261893733)*x[1]**o+(0.620185443057)*x[1]+(0.984821746408)*x[2]**o+(0.358075460145)*x[2]
        s[3,0]=(-0.2094567637)*x[0]**o+(0.0635506980721)*x[0]+(0.540179140495)*x[1]**o+(-0.178193714382)*x[1]+(0.114963963742)*x[2]**o+(-0.232785400122)*x[2]
        s[3,1]=(0.581234387125)*x[0]**o+(-0.800223513435)*x[0]+(-0.580041308558)*x[1]**o+(-0.468466479829)*x[1]+(0.66171049066)*x[2]**o+(0.00411361715063)*x[2]
        s[3,2]=(0.972539025242)*x[0]**o+(-0.640993915582)*x[0]+(0.418443080441)*x[1]**o+(0.608840732702)*x[1]+(0.979209906273)*x[2]**o+(-0.984684975101)*x[2]
        s[3,3]=(0.80136860876)*x[0]**o+(0.526110649659)*x[0]+(-0.307964128679)*x[1]**o+(-0.162612676576)*x[1]+(-0.68486706357)*x[2]**o+(-0.234358375142)*x[2]
        s[3,4]=(0.146116143734)*x[0]**o+(0.581210816708)*x[0]+(-0.152105642806)*x[1]**o+(0.97096072826)*x[1]+(-0.0416344321982)*x[2]**o+(-0.933814919317)*x[2]
        ref[0,0,0]=o*(0.729942219527)*x_ref[0]**(o-1)+(-0.721160545053)
        ref[0,0,1]=o*(0.426397843912)*x_ref[1]**(o-1)+(-0.213185647354)
        ref[0,0,2]=o*(0.728447138266)*x_ref[2]**(o-1)+(-0.607791661013)
        ref[0,1,0]=o*(0.667616392653)*x_ref[0]**(o-1)+(0.848051730251)
        ref[0,1,1]=o*(0.121550076489)*x_ref[1]**(o-1)+(0.0843862117633)
        ref[0,1,2]=o*(-0.509323081526)*x_ref[2]**(o-1)+(0.736521833786)
        ref[0,2,0]=o*(0.830127288575)*x_ref[0]**(o-1)+(0.964772646621)
        ref[0,2,1]=o*(0.913688863179)*x_ref[1]**(o-1)+(0.957018200531)
        ref[0,2,2]=o*(-0.694170056751)*x_ref[2]**(o-1)+(0.105973113953)
        ref[0,3,0]=o*(-0.235173218805)*x_ref[0]**(o-1)+(0.858875579758)
        ref[0,3,1]=o*(0.823162706883)*x_ref[1]**(o-1)+(0.108717821259)
        ref[0,3,2]=o*(0.80411364975)*x_ref[2]**(o-1)+(0.0348079894361)
        ref[0,4,0]=o*(0.78867654833)*x_ref[0]**(o-1)+(-0.0191953378129)
        ref[0,4,1]=o*(-0.0840244773387)*x_ref[1]**(o-1)+(0.614156921824)
        ref[0,4,2]=o*(-0.0190397891394)*x_ref[2]**(o-1)+(0.750918932533)
        ref[1,0,0]=o*(-0.0931449972666)*x_ref[0]**(o-1)+(0.887179037493)
        ref[1,0,1]=o*(0.163173866494)*x_ref[1]**(o-1)+(-0.0429615650925)
        ref[1,0,2]=o*(0.246231141028)*x_ref[2]**(o-1)+(0.835506100749)
        ref[1,1,0]=o*(-0.0644771805334)*x_ref[0]**(o-1)+(-0.447016488171)
        ref[1,1,1]=o*(0.525187872112)*x_ref[1]**(o-1)+(0.0698248427183)
        ref[1,1,2]=o*(0.206184560671)*x_ref[2]**(o-1)+(0.0760145857359)
        ref[1,2,0]=o*(-0.468079677328)*x_ref[0]**(o-1)+(0.209734412741)
        ref[1,2,1]=o*(-0.76390490599)*x_ref[1]**(o-1)+(-0.890555632144)
        ref[1,2,2]=o*(0.0940465019231)*x_ref[2]**(o-1)+(-0.4911374279)
        ref[1,3,0]=o*(0.0219043704096)*x_ref[0]**(o-1)+(0.843668836143)
        ref[1,3,1]=o*(-0.496594214362)*x_ref[1]**(o-1)+(-0.698887537236)
        ref[1,3,2]=o*(0.739801576727)*x_ref[2]**(o-1)+(-0.283969520066)
        ref[1,4,0]=o*(0.626836103474)*x_ref[0]**(o-1)+(-0.209145555082)
        ref[1,4,1]=o*(0.0527420557385)*x_ref[1]**(o-1)+(0.447276924763)
        ref[1,4,2]=o*(0.753404625572)*x_ref[2]**(o-1)+(-0.964517776982)
        ref[2,0,0]=o*(0.208209713508)*x_ref[0]**(o-1)+(0.666027366366)
        ref[2,0,1]=o*(0.648558221549)*x_ref[1]**(o-1)+(-0.867196856985)
        ref[2,0,2]=o*(-0.386920813405)*x_ref[2]**(o-1)+(-0.859803466402)
        ref[2,1,0]=o*(0.192327689645)*x_ref[0]**(o-1)+(0.706632402773)
        ref[2,1,1]=o*(-0.917135230541)*x_ref[1]**(o-1)+(-0.518142383283)
        ref[2,1,2]=o*(0.63345047167)*x_ref[2]**(o-1)+(0.452536991007)
        ref[2,2,0]=o*(-0.216559791626)*x_ref[0]**(o-1)+(0.280416285835)
        ref[2,2,1]=o*(0.880532961859)*x_ref[1]**(o-1)+(-0.685211600885)
        ref[2,2,2]=o*(0.435667186231)*x_ref[2]**(o-1)+(0.632733331589)
        ref[2,3,0]=o*(0.52338353111)*x_ref[0]**(o-1)+(-0.865976270688)
        ref[2,3,1]=o*(0.598776819058)*x_ref[1]**(o-1)+(-0.404416433163)
        ref[2,3,2]=o*(-0.538779785754)*x_ref[2]**(o-1)+(-0.708928887004)
        ref[2,4,0]=o*(0.523035959616)*x_ref[0]**(o-1)+(0.732324929631)
        ref[2,4,1]=o*(0.213261893733)*x_ref[1]**(o-1)+(0.620185443057)
        ref[2,4,2]=o*(0.984821746408)*x_ref[2]**(o-1)+(0.358075460145)
        ref[3,0,0]=o*(-0.2094567637)*x_ref[0]**(o-1)+(0.0635506980721)
        ref[3,0,1]=o*(0.540179140495)*x_ref[1]**(o-1)+(-0.178193714382)
        ref[3,0,2]=o*(0.114963963742)*x_ref[2]**(o-1)+(-0.232785400122)
        ref[3,1,0]=o*(0.581234387125)*x_ref[0]**(o-1)+(-0.800223513435)
        ref[3,1,1]=o*(-0.580041308558)*x_ref[1]**(o-1)+(-0.468466479829)
        ref[3,1,2]=o*(0.66171049066)*x_ref[2]**(o-1)+(0.00411361715063)
        ref[3,2,0]=o*(0.972539025242)*x_ref[0]**(o-1)+(-0.640993915582)
        ref[3,2,1]=o*(0.418443080441)*x_ref[1]**(o-1)+(0.608840732702)
        ref[3,2,2]=o*(0.979209906273)*x_ref[2]**(o-1)+(-0.984684975101)
        ref[3,3,0]=o*(0.80136860876)*x_ref[0]**(o-1)+(0.526110649659)
        ref[3,3,1]=o*(-0.307964128679)*x_ref[1]**(o-1)+(-0.162612676576)
        ref[3,3,2]=o*(-0.68486706357)*x_ref[2]**(o-1)+(-0.234358375142)
        ref[3,4,0]=o*(0.146116143734)*x_ref[0]**(o-1)+(0.581210816708)
        ref[3,4,1]=o*(-0.152105642806)*x_ref[1]**(o-1)+(0.97096072826)
        ref[3,4,2]=o*(-0.0416344321982)*x_ref[2]**(o-1)+(-0.933814919317)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnContactZero

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(0.210810831144)*x[0]**o+(0.993748550706)*x[0]+(0.225093899339)*x[1]**o+(-0.306898024507)*x[1]
        s[0,0,1]=(0.945391291392)*x[0]**o+(-0.34733930643)*x[0]+(0.523085690915)*x[1]**o+(-0.332680309461)*x[1]
        s[0,1,0]=(0.372088608669)*x[0]**o+(0.276443856788)*x[0]+(-0.439514323588)*x[1]**o+(0.985453767485)*x[1]
        s[0,1,1]=(-0.967561100768)*x[0]**o+(0.591908531375)*x[0]+(0.288385284239)*x[1]**o+(-0.422883693702)*x[1]
        s[1,0,0]=(-0.735303276087)*x[0]**o+(0.540176339329)*x[0]+(0.124141197609)*x[1]**o+(0.17505950278)*x[1]
        s[1,0,1]=(0.799321447619)*x[0]**o+(-0.521267395747)*x[0]+(-0.388235024602)*x[1]**o+(0.0783682529975)*x[1]
        s[1,1,0]=(-0.7923799998)*x[0]**o+(-0.779345662449)*x[0]+(0.507399627325)*x[1]**o+(-0.668039939194)*x[1]
        s[1,1,1]=(0.360260485497)*x[0]**o+(0.639639208398)*x[0]+(0.275791805772)*x[1]**o+(-0.923288698445)*x[1]
        s[2,0,0]=(0.338586096766)*x[0]**o+(-0.862613705959)*x[0]+(0.0321867760579)*x[1]**o+(0.418774919375)*x[1]
        s[2,0,1]=(0.0363215417361)*x[0]**o+(0.994712078504)*x[0]+(-0.260614790561)*x[1]**o+(-0.969097035084)*x[1]
        s[2,1,0]=(0.375366661281)*x[0]**o+(0.456874530834)*x[0]+(0.429399840953)*x[1]**o+(0.688205075709)*x[1]
        s[2,1,1]=(-0.918074889111)*x[0]**o+(-0.716561240269)*x[0]+(-0.477398945222)*x[1]**o+(-0.223142905734)*x[1]
        s[3,0,0]=(-0.420424618942)*x[0]**o+(-0.702691949655)*x[0]+(-0.389998593814)*x[1]**o+(0.778091583668)*x[1]
        s[3,0,1]=(-0.500317522801)*x[0]**o+(-0.906158794184)*x[0]+(-0.942667332637)*x[1]**o+(-0.38695660361)*x[1]
        s[3,1,0]=(0.652359792164)*x[0]**o+(0.663033146373)*x[0]+(-0.0863743948576)*x[1]**o+(-0.310130231197)*x[1]
        s[3,1,1]=(0.132520829002)*x[0]**o+(-0.692607399006)*x[0]+(0.484454939316)*x[1]**o+(0.848314808163)*x[1]
        s[4,0,0]=(-0.0372302792179)*x[0]**o+(-0.208111754532)*x[0]+(-0.84060197077)*x[1]**o+(-0.999842431749)*x[1]
        s[4,0,1]=(0.522677717768)*x[0]**o+(-0.796530255947)*x[0]+(-0.758152917507)*x[1]**o+(-0.748249123242)*x[1]
        s[4,1,0]=(-0.9338587977)*x[0]**o+(0.033736711901)*x[0]+(-0.521414748153)*x[1]**o+(-0.27924576252)*x[1]
        s[4,1,1]=(-0.728280335859)*x[0]**o+(0.0052784852763)*x[0]+(0.668426662412)*x[1]**o+(-0.539548867925)*x[1]
        s[5,0,0]=(0.183081849687)*x[0]**o+(0.867616703079)*x[0]+(-0.44917069636)*x[1]**o+(-0.422840947463)*x[1]
        s[5,0,1]=(0.598683594731)*x[0]**o+(-0.185366147497)*x[0]+(-0.133722684999)*x[1]**o+(-0.374233145702)*x[1]
        s[5,1,0]=(-0.4661027909)*x[0]**o+(-0.658486427256)*x[0]+(0.494385097276)*x[1]**o+(0.746131625723)*x[1]
        s[5,1,1]=(0.881329425205)*x[0]**o+(0.0663586900787)*x[0]+(0.638121309568)*x[1]**o+(-0.392008079426)*x[1]
        ref[0,0,0,0]=o*(0.210810831144)*x_ref[0]**(o-1)+(0.993748550706)
        ref[0,0,0,1]=o*(0.225093899339)*x_ref[1]**(o-1)+(-0.306898024507)
        ref[0,0,1,0]=o*(0.945391291392)*x_ref[0]**(o-1)+(-0.34733930643)
        ref[0,0,1,1]=o*(0.523085690915)*x_ref[1]**(o-1)+(-0.332680309461)
        ref[0,1,0,0]=o*(0.372088608669)*x_ref[0]**(o-1)+(0.276443856788)
        ref[0,1,0,1]=o*(-0.439514323588)*x_ref[1]**(o-1)+(0.985453767485)
        ref[0,1,1,0]=o*(-0.967561100768)*x_ref[0]**(o-1)+(0.591908531375)
        ref[0,1,1,1]=o*(0.288385284239)*x_ref[1]**(o-1)+(-0.422883693702)
        ref[1,0,0,0]=o*(-0.735303276087)*x_ref[0]**(o-1)+(0.540176339329)
        ref[1,0,0,1]=o*(0.124141197609)*x_ref[1]**(o-1)+(0.17505950278)
        ref[1,0,1,0]=o*(0.799321447619)*x_ref[0]**(o-1)+(-0.521267395747)
        ref[1,0,1,1]=o*(-0.388235024602)*x_ref[1]**(o-1)+(0.0783682529975)
        ref[1,1,0,0]=o*(-0.7923799998)*x_ref[0]**(o-1)+(-0.779345662449)
        ref[1,1,0,1]=o*(0.507399627325)*x_ref[1]**(o-1)+(-0.668039939194)
        ref[1,1,1,0]=o*(0.360260485497)*x_ref[0]**(o-1)+(0.639639208398)
        ref[1,1,1,1]=o*(0.275791805772)*x_ref[1]**(o-1)+(-0.923288698445)
        ref[2,0,0,0]=o*(0.338586096766)*x_ref[0]**(o-1)+(-0.862613705959)
        ref[2,0,0,1]=o*(0.0321867760579)*x_ref[1]**(o-1)+(0.418774919375)
        ref[2,0,1,0]=o*(0.0363215417361)*x_ref[0]**(o-1)+(0.994712078504)
        ref[2,0,1,1]=o*(-0.260614790561)*x_ref[1]**(o-1)+(-0.969097035084)
        ref[2,1,0,0]=o*(0.375366661281)*x_ref[0]**(o-1)+(0.456874530834)
        ref[2,1,0,1]=o*(0.429399840953)*x_ref[1]**(o-1)+(0.688205075709)
        ref[2,1,1,0]=o*(-0.918074889111)*x_ref[0]**(o-1)+(-0.716561240269)
        ref[2,1,1,1]=o*(-0.477398945222)*x_ref[1]**(o-1)+(-0.223142905734)
        ref[3,0,0,0]=o*(-0.420424618942)*x_ref[0]**(o-1)+(-0.702691949655)
        ref[3,0,0,1]=o*(-0.389998593814)*x_ref[1]**(o-1)+(0.778091583668)
        ref[3,0,1,0]=o*(-0.500317522801)*x_ref[0]**(o-1)+(-0.906158794184)
        ref[3,0,1,1]=o*(-0.942667332637)*x_ref[1]**(o-1)+(-0.38695660361)
        ref[3,1,0,0]=o*(0.652359792164)*x_ref[0]**(o-1)+(0.663033146373)
        ref[3,1,0,1]=o*(-0.0863743948576)*x_ref[1]**(o-1)+(-0.310130231197)
        ref[3,1,1,0]=o*(0.132520829002)*x_ref[0]**(o-1)+(-0.692607399006)
        ref[3,1,1,1]=o*(0.484454939316)*x_ref[1]**(o-1)+(0.848314808163)
        ref[4,0,0,0]=o*(-0.0372302792179)*x_ref[0]**(o-1)+(-0.208111754532)
        ref[4,0,0,1]=o*(-0.84060197077)*x_ref[1]**(o-1)+(-0.999842431749)
        ref[4,0,1,0]=o*(0.522677717768)*x_ref[0]**(o-1)+(-0.796530255947)
        ref[4,0,1,1]=o*(-0.758152917507)*x_ref[1]**(o-1)+(-0.748249123242)
        ref[4,1,0,0]=o*(-0.9338587977)*x_ref[0]**(o-1)+(0.033736711901)
        ref[4,1,0,1]=o*(-0.521414748153)*x_ref[1]**(o-1)+(-0.27924576252)
        ref[4,1,1,0]=o*(-0.728280335859)*x_ref[0]**(o-1)+(0.0052784852763)
        ref[4,1,1,1]=o*(0.668426662412)*x_ref[1]**(o-1)+(-0.539548867925)
        ref[5,0,0,0]=o*(0.183081849687)*x_ref[0]**(o-1)+(0.867616703079)
        ref[5,0,0,1]=o*(-0.44917069636)*x_ref[1]**(o-1)+(-0.422840947463)
        ref[5,0,1,0]=o*(0.598683594731)*x_ref[0]**(o-1)+(-0.185366147497)
        ref[5,0,1,1]=o*(-0.133722684999)*x_ref[1]**(o-1)+(-0.374233145702)
        ref[5,1,0,0]=o*(-0.4661027909)*x_ref[0]**(o-1)+(-0.658486427256)
        ref[5,1,0,1]=o*(0.494385097276)*x_ref[1]**(o-1)+(0.746131625723)
        ref[5,1,1,0]=o*(0.881329425205)*x_ref[0]**(o-1)+(0.0663586900787)
        ref[5,1,1,1]=o*(0.638121309568)*x_ref[1]**(o-1)+(-0.392008079426)
      else:
        s[0,0,0]=(0.495604153512)*x[0]**o+(-0.546051759361)*x[0]+(0.985443531442)*x[1]**o+(-0.394922383292)*x[1]+(-0.122301738852)*x[2]**o+(-0.221144495446)*x[2]
        s[0,0,1]=(-0.164179695077)*x[0]**o+(-0.488047064324)*x[0]+(0.556965694466)*x[1]**o+(-0.470423249373)*x[1]+(-0.625307475886)*x[2]**o+(-0.999651290798)*x[2]
        s[0,1,0]=(-0.858044039365)*x[0]**o+(-0.932289002735)*x[0]+(-0.343121624834)*x[1]**o+(-0.0210069830662)*x[1]+(0.951213562883)*x[2]**o+(-0.647040549286)*x[2]
        s[0,1,1]=(-0.680293757762)*x[0]**o+(0.820233518831)*x[0]+(0.0489418677095)*x[1]**o+(-0.852104985889)*x[1]+(0.960135497008)*x[2]**o+(-0.46075359959)*x[2]
        s[1,0,0]=(0.827213065477)*x[0]**o+(0.195435158962)*x[0]+(-0.0408345903614)*x[1]**o+(0.146957170071)*x[1]+(-0.423482853682)*x[2]**o+(0.113246501514)*x[2]
        s[1,0,1]=(-0.920613863373)*x[0]**o+(0.933412308922)*x[0]+(0.258934140982)*x[1]**o+(-0.689643171121)*x[1]+(0.893192051888)*x[2]**o+(-0.471852670906)*x[2]
        s[1,1,0]=(-0.981601898267)*x[0]**o+(-0.516390752771)*x[0]+(0.608397090998)*x[1]**o+(0.335529495102)*x[1]+(-0.0746490251171)*x[2]**o+(-0.50249402227)*x[2]
        s[1,1,1]=(0.367749783351)*x[0]**o+(-0.611995716855)*x[0]+(-0.980913863186)*x[1]**o+(0.299812200148)*x[1]+(0.562250470266)*x[2]**o+(0.0542265856797)*x[2]
        s[2,0,0]=(-0.317633103186)*x[0]**o+(-0.175141419305)*x[0]+(-0.114479468171)*x[1]**o+(-0.117966705382)*x[1]+(-0.983395580005)*x[2]**o+(-0.588457148786)*x[2]
        s[2,0,1]=(-0.45007739654)*x[0]**o+(-0.941613604155)*x[0]+(0.597714724696)*x[1]**o+(0.992095144994)*x[1]+(0.681322168708)*x[2]**o+(0.656828773187)*x[2]
        s[2,1,0]=(0.372959242179)*x[0]**o+(-0.266039538769)*x[0]+(0.420734431733)*x[1]**o+(0.530880738131)*x[1]+(0.593665348543)*x[2]**o+(-0.502919021867)*x[2]
        s[2,1,1]=(0.741984988727)*x[0]**o+(-0.662109553439)*x[0]+(-0.01222805343)*x[1]**o+(-0.261877080281)*x[1]+(0.584778610634)*x[2]**o+(0.248969331325)*x[2]
        s[3,0,0]=(-0.767798213786)*x[0]**o+(0.56387037017)*x[0]+(0.545042362526)*x[1]**o+(0.127002206725)*x[1]+(0.123826212114)*x[2]**o+(0.03202953512)*x[2]
        s[3,0,1]=(-0.54234471198)*x[0]**o+(-0.844655061807)*x[0]+(0.909493468686)*x[1]**o+(-0.601003138714)*x[1]+(-0.822776025243)*x[2]**o+(-0.569619092404)*x[2]
        s[3,1,0]=(-0.749598491666)*x[0]**o+(0.146640505619)*x[0]+(-0.782827623949)*x[1]**o+(0.0795239577275)*x[1]+(0.98951419773)*x[2]**o+(-0.878832103203)*x[2]
        s[3,1,1]=(0.917489698949)*x[0]**o+(0.791885047319)*x[0]+(0.415646018849)*x[1]**o+(0.194622530403)*x[1]+(0.123045865981)*x[2]**o+(-0.864537623753)*x[2]
        s[4,0,0]=(0.993338538326)*x[0]**o+(-0.130375655736)*x[0]+(0.088857735361)*x[1]**o+(-0.565025291359)*x[1]+(-0.543615061477)*x[2]**o+(0.509734903091)*x[2]
        s[4,0,1]=(-0.874483507391)*x[0]**o+(-0.993080113589)*x[0]+(0.269443230092)*x[1]**o+(-0.445853491314)*x[1]+(-0.765796954415)*x[2]**o+(-0.981106922583)*x[2]
        s[4,1,0]=(-0.650170302308)*x[0]**o+(0.222814951659)*x[0]+(0.553055011394)*x[1]**o+(-0.359146840173)*x[1]+(0.887910478865)*x[2]**o+(-0.446130800509)*x[2]
        s[4,1,1]=(0.512373070036)*x[0]**o+(0.427326569369)*x[0]+(0.311737845037)*x[1]**o+(0.998455706258)*x[1]+(-0.868170359085)*x[2]**o+(-0.924351117942)*x[2]
        s[5,0,0]=(0.129707961614)*x[0]**o+(0.668313579165)*x[0]+(-0.73474211614)*x[1]**o+(0.702827908609)*x[1]+(-0.0226884665962)*x[2]**o+(-0.00740206443655)*x[2]
        s[5,0,1]=(-0.113099473775)*x[0]**o+(0.655719358276)*x[0]+(0.0162829520583)*x[1]**o+(0.133582158275)*x[1]+(0.169685631206)*x[2]**o+(0.507126023907)*x[2]
        s[5,1,0]=(-0.0754735940537)*x[0]**o+(0.294940113895)*x[0]+(-0.98735456969)*x[1]**o+(0.401871193336)*x[1]+(-0.0770486468616)*x[2]**o+(-0.0168685832006)*x[2]
        s[5,1,1]=(0.971769998957)*x[0]**o+(-0.454726501195)*x[0]+(0.835505309792)*x[1]**o+(0.775091315278)*x[1]+(0.632907414827)*x[2]**o+(-0.10388782338)*x[2]
        ref[0,0,0,0]=o*(0.495604153512)*x_ref[0]**(o-1)+(-0.546051759361)
        ref[0,0,0,1]=o*(0.985443531442)*x_ref[1]**(o-1)+(-0.394922383292)
        ref[0,0,0,2]=o*(-0.122301738852)*x_ref[2]**(o-1)+(-0.221144495446)
        ref[0,0,1,0]=o*(-0.164179695077)*x_ref[0]**(o-1)+(-0.488047064324)
        ref[0,0,1,1]=o*(0.556965694466)*x_ref[1]**(o-1)+(-0.470423249373)
        ref[0,0,1,2]=o*(-0.625307475886)*x_ref[2]**(o-1)+(-0.999651290798)
        ref[0,1,0,0]=o*(-0.858044039365)*x_ref[0]**(o-1)+(-0.932289002735)
        ref[0,1,0,1]=o*(-0.343121624834)*x_ref[1]**(o-1)+(-0.0210069830662)
        ref[0,1,0,2]=o*(0.951213562883)*x_ref[2]**(o-1)+(-0.647040549286)
        ref[0,1,1,0]=o*(-0.680293757762)*x_ref[0]**(o-1)+(0.820233518831)
        ref[0,1,1,1]=o*(0.0489418677095)*x_ref[1]**(o-1)+(-0.852104985889)
        ref[0,1,1,2]=o*(0.960135497008)*x_ref[2]**(o-1)+(-0.46075359959)
        ref[1,0,0,0]=o*(0.827213065477)*x_ref[0]**(o-1)+(0.195435158962)
        ref[1,0,0,1]=o*(-0.0408345903614)*x_ref[1]**(o-1)+(0.146957170071)
        ref[1,0,0,2]=o*(-0.423482853682)*x_ref[2]**(o-1)+(0.113246501514)
        ref[1,0,1,0]=o*(-0.920613863373)*x_ref[0]**(o-1)+(0.933412308922)
        ref[1,0,1,1]=o*(0.258934140982)*x_ref[1]**(o-1)+(-0.689643171121)
        ref[1,0,1,2]=o*(0.893192051888)*x_ref[2]**(o-1)+(-0.471852670906)
        ref[1,1,0,0]=o*(-0.981601898267)*x_ref[0]**(o-1)+(-0.516390752771)
        ref[1,1,0,1]=o*(0.608397090998)*x_ref[1]**(o-1)+(0.335529495102)
        ref[1,1,0,2]=o*(-0.0746490251171)*x_ref[2]**(o-1)+(-0.50249402227)
        ref[1,1,1,0]=o*(0.367749783351)*x_ref[0]**(o-1)+(-0.611995716855)
        ref[1,1,1,1]=o*(-0.980913863186)*x_ref[1]**(o-1)+(0.299812200148)
        ref[1,1,1,2]=o*(0.562250470266)*x_ref[2]**(o-1)+(0.0542265856797)
        ref[2,0,0,0]=o*(-0.317633103186)*x_ref[0]**(o-1)+(-0.175141419305)
        ref[2,0,0,1]=o*(-0.114479468171)*x_ref[1]**(o-1)+(-0.117966705382)
        ref[2,0,0,2]=o*(-0.983395580005)*x_ref[2]**(o-1)+(-0.588457148786)
        ref[2,0,1,0]=o*(-0.45007739654)*x_ref[0]**(o-1)+(-0.941613604155)
        ref[2,0,1,1]=o*(0.597714724696)*x_ref[1]**(o-1)+(0.992095144994)
        ref[2,0,1,2]=o*(0.681322168708)*x_ref[2]**(o-1)+(0.656828773187)
        ref[2,1,0,0]=o*(0.372959242179)*x_ref[0]**(o-1)+(-0.266039538769)
        ref[2,1,0,1]=o*(0.420734431733)*x_ref[1]**(o-1)+(0.530880738131)
        ref[2,1,0,2]=o*(0.593665348543)*x_ref[2]**(o-1)+(-0.502919021867)
        ref[2,1,1,0]=o*(0.741984988727)*x_ref[0]**(o-1)+(-0.662109553439)
        ref[2,1,1,1]=o*(-0.01222805343)*x_ref[1]**(o-1)+(-0.261877080281)
        ref[2,1,1,2]=o*(0.584778610634)*x_ref[2]**(o-1)+(0.248969331325)
        ref[3,0,0,0]=o*(-0.767798213786)*x_ref[0]**(o-1)+(0.56387037017)
        ref[3,0,0,1]=o*(0.545042362526)*x_ref[1]**(o-1)+(0.127002206725)
        ref[3,0,0,2]=o*(0.123826212114)*x_ref[2]**(o-1)+(0.03202953512)
        ref[3,0,1,0]=o*(-0.54234471198)*x_ref[0]**(o-1)+(-0.844655061807)
        ref[3,0,1,1]=o*(0.909493468686)*x_ref[1]**(o-1)+(-0.601003138714)
        ref[3,0,1,2]=o*(-0.822776025243)*x_ref[2]**(o-1)+(-0.569619092404)
        ref[3,1,0,0]=o*(-0.749598491666)*x_ref[0]**(o-1)+(0.146640505619)
        ref[3,1,0,1]=o*(-0.782827623949)*x_ref[1]**(o-1)+(0.0795239577275)
        ref[3,1,0,2]=o*(0.98951419773)*x_ref[2]**(o-1)+(-0.878832103203)
        ref[3,1,1,0]=o*(0.917489698949)*x_ref[0]**(o-1)+(0.791885047319)
        ref[3,1,1,1]=o*(0.415646018849)*x_ref[1]**(o-1)+(0.194622530403)
        ref[3,1,1,2]=o*(0.123045865981)*x_ref[2]**(o-1)+(-0.864537623753)
        ref[4,0,0,0]=o*(0.993338538326)*x_ref[0]**(o-1)+(-0.130375655736)
        ref[4,0,0,1]=o*(0.088857735361)*x_ref[1]**(o-1)+(-0.565025291359)
        ref[4,0,0,2]=o*(-0.543615061477)*x_ref[2]**(o-1)+(0.509734903091)
        ref[4,0,1,0]=o*(-0.874483507391)*x_ref[0]**(o-1)+(-0.993080113589)
        ref[4,0,1,1]=o*(0.269443230092)*x_ref[1]**(o-1)+(-0.445853491314)
        ref[4,0,1,2]=o*(-0.765796954415)*x_ref[2]**(o-1)+(-0.981106922583)
        ref[4,1,0,0]=o*(-0.650170302308)*x_ref[0]**(o-1)+(0.222814951659)
        ref[4,1,0,1]=o*(0.553055011394)*x_ref[1]**(o-1)+(-0.359146840173)
        ref[4,1,0,2]=o*(0.887910478865)*x_ref[2]**(o-1)+(-0.446130800509)
        ref[4,1,1,0]=o*(0.512373070036)*x_ref[0]**(o-1)+(0.427326569369)
        ref[4,1,1,1]=o*(0.311737845037)*x_ref[1]**(o-1)+(0.998455706258)
        ref[4,1,1,2]=o*(-0.868170359085)*x_ref[2]**(o-1)+(-0.924351117942)
        ref[5,0,0,0]=o*(0.129707961614)*x_ref[0]**(o-1)+(0.668313579165)
        ref[5,0,0,1]=o*(-0.73474211614)*x_ref[1]**(o-1)+(0.702827908609)
        ref[5,0,0,2]=o*(-0.0226884665962)*x_ref[2]**(o-1)+(-0.00740206443655)
        ref[5,0,1,0]=o*(-0.113099473775)*x_ref[0]**(o-1)+(0.655719358276)
        ref[5,0,1,1]=o*(0.0162829520583)*x_ref[1]**(o-1)+(0.133582158275)
        ref[5,0,1,2]=o*(0.169685631206)*x_ref[2]**(o-1)+(0.507126023907)
        ref[5,1,0,0]=o*(-0.0754735940537)*x_ref[0]**(o-1)+(0.294940113895)
        ref[5,1,0,1]=o*(-0.98735456969)*x_ref[1]**(o-1)+(0.401871193336)
        ref[5,1,0,2]=o*(-0.0770486468616)*x_ref[2]**(o-1)+(-0.0168685832006)
        ref[5,1,1,0]=o*(0.971769998957)*x_ref[0]**(o-1)+(-0.454726501195)
        ref[5,1,1,1]=o*(0.835505309792)*x_ref[1]**(o-1)+(0.775091315278)
        ref[5,1,1,2]=o*(0.632907414827)*x_ref[2]**(o-1)+(-0.10388782338)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_Solution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(0.143576812018)*x[0]**o+(0.772046830562)*x[0]+(0.799382081787)*x[1]**o+(-0.689145149202)*x[1]
        ref[0]=o*(0.143576812018)*x_ref[0]**(o-1)+(0.772046830562)
        ref[1]=o*(0.799382081787)*x_ref[1]**(o-1)+(-0.689145149202)
      else:
        s=(-0.921622979189)*x[0]**o+(-0.35132068829)*x[0]+(-0.668419889938)*x[1]**o+(-0.25240554797)*x[1]+(-0.266863972981)*x[2]**o+(0.59405466698)*x[2]
        ref[0]=o*(-0.921622979189)*x_ref[0]**(o-1)+(-0.35132068829)
        ref[1]=o*(-0.668419889938)*x_ref[1]**(o-1)+(-0.25240554797)
        ref[2]=o*(-0.266863972981)*x_ref[2]**(o-1)+(0.59405466698)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_Solution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(0.572981720293)*x[0]**o+(-0.305280287068)*x[0]+(-0.552369316063)*x[1]**o+(-0.917368778197)*x[1]
        s[1]=(0.310389604089)*x[0]**o+(-0.316385112396)*x[0]+(0.713272118168)*x[1]**o+(0.856686290785)*x[1]
        ref[0,0]=o*(0.572981720293)*x_ref[0]**(o-1)+(-0.305280287068)
        ref[0,1]=o*(-0.552369316063)*x_ref[1]**(o-1)+(-0.917368778197)
        ref[1,0]=o*(0.310389604089)*x_ref[0]**(o-1)+(-0.316385112396)
        ref[1,1]=o*(0.713272118168)*x_ref[1]**(o-1)+(0.856686290785)
      else:
        s[0]=(-0.132099402207)*x[0]**o+(0.587263843257)*x[0]+(-0.326050434166)*x[1]**o+(0.873048232418)*x[1]+(-0.141344874565)*x[2]**o+(0.274084100427)*x[2]
        s[1]=(0.372494974451)*x[0]**o+(-0.482077621852)*x[0]+(-0.022004253515)*x[1]**o+(0.874572230513)*x[1]+(0.8369124866)*x[2]**o+(-0.979759147043)*x[2]
        ref[0,0]=o*(-0.132099402207)*x_ref[0]**(o-1)+(0.587263843257)
        ref[0,1]=o*(-0.326050434166)*x_ref[1]**(o-1)+(0.873048232418)
        ref[0,2]=o*(-0.141344874565)*x_ref[2]**(o-1)+(0.274084100427)
        ref[1,0]=o*(0.372494974451)*x_ref[0]**(o-1)+(-0.482077621852)
        ref[1,1]=o*(-0.022004253515)*x_ref[1]**(o-1)+(0.874572230513)
        ref[1,2]=o*(0.8369124866)*x_ref[2]**(o-1)+(-0.979759147043)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_Solution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.993111549259)*x[0]**o+(0.958601813395)*x[0]+(0.985388059548)*x[1]**o+(-0.570742940525)*x[1]
        s[0,1]=(-0.223411180873)*x[0]**o+(0.480695178439)*x[0]+(0.0161612686521)*x[1]**o+(0.400987902598)*x[1]
        s[0,2]=(0.775656253974)*x[0]**o+(-0.191138960618)*x[0]+(-0.446251149518)*x[1]**o+(0.432178603961)*x[1]
        s[0,3]=(0.827622744839)*x[0]**o+(0.0366172895102)*x[0]+(0.347810808477)*x[1]**o+(-0.688818913998)*x[1]
        s[0,4]=(0.837082711466)*x[0]**o+(0.376527432997)*x[0]+(0.17741245651)*x[1]**o+(0.872147279603)*x[1]
        s[1,0]=(-0.590137160663)*x[0]**o+(-0.0703615079757)*x[0]+(0.229861545725)*x[1]**o+(0.0809472412982)*x[1]
        s[1,1]=(0.0223830240489)*x[0]**o+(0.228842693495)*x[0]+(-0.557074035399)*x[1]**o+(0.500538497902)*x[1]
        s[1,2]=(0.872181981766)*x[0]**o+(0.790601719428)*x[0]+(0.983055567067)*x[1]**o+(-0.353849465384)*x[1]
        s[1,3]=(0.037040061131)*x[0]**o+(0.293981509756)*x[0]+(-0.279061759005)*x[1]**o+(-0.362644845866)*x[1]
        s[1,4]=(0.695941674104)*x[0]**o+(-0.51481315942)*x[0]+(0.765262082274)*x[1]**o+(-0.813116917911)*x[1]
        s[2,0]=(-0.579924169032)*x[0]**o+(0.529857498501)*x[0]+(-0.485940906658)*x[1]**o+(0.559056145345)*x[1]
        s[2,1]=(0.604856738274)*x[0]**o+(-0.440825061381)*x[0]+(-0.0838758185405)*x[1]**o+(0.0188329882604)*x[1]
        s[2,2]=(0.118585827905)*x[0]**o+(0.618367201987)*x[0]+(0.352157918285)*x[1]**o+(0.253890253557)*x[1]
        s[2,3]=(-0.372665302477)*x[0]**o+(0.718734712755)*x[0]+(-0.487897528386)*x[1]**o+(0.808964263735)*x[1]
        s[2,4]=(0.776070811457)*x[0]**o+(-0.675210963521)*x[0]+(0.0331035702593)*x[1]**o+(-0.703100978257)*x[1]
        s[3,0]=(0.144238364778)*x[0]**o+(0.855900329896)*x[0]+(-0.291688407398)*x[1]**o+(-0.308539252205)*x[1]
        s[3,1]=(-0.57873830064)*x[0]**o+(-0.0982142438835)*x[0]+(0.249356200194)*x[1]**o+(-0.156027166502)*x[1]
        s[3,2]=(-0.70772301011)*x[0]**o+(0.615393644935)*x[0]+(-0.1313826883)*x[1]**o+(0.265287078264)*x[1]
        s[3,3]=(-0.671189805427)*x[0]**o+(-0.561302098778)*x[0]+(0.129817024131)*x[1]**o+(-0.738582319997)*x[1]
        s[3,4]=(-0.154389666509)*x[0]**o+(0.119040072318)*x[0]+(-0.113706823809)*x[1]**o+(0.0124037512924)*x[1]
        ref[0,0,0]=o*(-0.993111549259)*x_ref[0]**(o-1)+(0.958601813395)
        ref[0,0,1]=o*(0.985388059548)*x_ref[1]**(o-1)+(-0.570742940525)
        ref[0,1,0]=o*(-0.223411180873)*x_ref[0]**(o-1)+(0.480695178439)
        ref[0,1,1]=o*(0.0161612686521)*x_ref[1]**(o-1)+(0.400987902598)
        ref[0,2,0]=o*(0.775656253974)*x_ref[0]**(o-1)+(-0.191138960618)
        ref[0,2,1]=o*(-0.446251149518)*x_ref[1]**(o-1)+(0.432178603961)
        ref[0,3,0]=o*(0.827622744839)*x_ref[0]**(o-1)+(0.0366172895102)
        ref[0,3,1]=o*(0.347810808477)*x_ref[1]**(o-1)+(-0.688818913998)
        ref[0,4,0]=o*(0.837082711466)*x_ref[0]**(o-1)+(0.376527432997)
        ref[0,4,1]=o*(0.17741245651)*x_ref[1]**(o-1)+(0.872147279603)
        ref[1,0,0]=o*(-0.590137160663)*x_ref[0]**(o-1)+(-0.0703615079757)
        ref[1,0,1]=o*(0.229861545725)*x_ref[1]**(o-1)+(0.0809472412982)
        ref[1,1,0]=o*(0.0223830240489)*x_ref[0]**(o-1)+(0.228842693495)
        ref[1,1,1]=o*(-0.557074035399)*x_ref[1]**(o-1)+(0.500538497902)
        ref[1,2,0]=o*(0.872181981766)*x_ref[0]**(o-1)+(0.790601719428)
        ref[1,2,1]=o*(0.983055567067)*x_ref[1]**(o-1)+(-0.353849465384)
        ref[1,3,0]=o*(0.037040061131)*x_ref[0]**(o-1)+(0.293981509756)
        ref[1,3,1]=o*(-0.279061759005)*x_ref[1]**(o-1)+(-0.362644845866)
        ref[1,4,0]=o*(0.695941674104)*x_ref[0]**(o-1)+(-0.51481315942)
        ref[1,4,1]=o*(0.765262082274)*x_ref[1]**(o-1)+(-0.813116917911)
        ref[2,0,0]=o*(-0.579924169032)*x_ref[0]**(o-1)+(0.529857498501)
        ref[2,0,1]=o*(-0.485940906658)*x_ref[1]**(o-1)+(0.559056145345)
        ref[2,1,0]=o*(0.604856738274)*x_ref[0]**(o-1)+(-0.440825061381)
        ref[2,1,1]=o*(-0.0838758185405)*x_ref[1]**(o-1)+(0.0188329882604)
        ref[2,2,0]=o*(0.118585827905)*x_ref[0]**(o-1)+(0.618367201987)
        ref[2,2,1]=o*(0.352157918285)*x_ref[1]**(o-1)+(0.253890253557)
        ref[2,3,0]=o*(-0.372665302477)*x_ref[0]**(o-1)+(0.718734712755)
        ref[2,3,1]=o*(-0.487897528386)*x_ref[1]**(o-1)+(0.808964263735)
        ref[2,4,0]=o*(0.776070811457)*x_ref[0]**(o-1)+(-0.675210963521)
        ref[2,4,1]=o*(0.0331035702593)*x_ref[1]**(o-1)+(-0.703100978257)
        ref[3,0,0]=o*(0.144238364778)*x_ref[0]**(o-1)+(0.855900329896)
        ref[3,0,1]=o*(-0.291688407398)*x_ref[1]**(o-1)+(-0.308539252205)
        ref[3,1,0]=o*(-0.57873830064)*x_ref[0]**(o-1)+(-0.0982142438835)
        ref[3,1,1]=o*(0.249356200194)*x_ref[1]**(o-1)+(-0.156027166502)
        ref[3,2,0]=o*(-0.70772301011)*x_ref[0]**(o-1)+(0.615393644935)
        ref[3,2,1]=o*(-0.1313826883)*x_ref[1]**(o-1)+(0.265287078264)
        ref[3,3,0]=o*(-0.671189805427)*x_ref[0]**(o-1)+(-0.561302098778)
        ref[3,3,1]=o*(0.129817024131)*x_ref[1]**(o-1)+(-0.738582319997)
        ref[3,4,0]=o*(-0.154389666509)*x_ref[0]**(o-1)+(0.119040072318)
        ref[3,4,1]=o*(-0.113706823809)*x_ref[1]**(o-1)+(0.0124037512924)
      else:
        s[0,0]=(-0.829816450667)*x[0]**o+(-0.147235008007)*x[0]+(0.492783189082)*x[1]**o+(-0.512635666132)*x[1]+(0.890224791682)*x[2]**o+(-0.956119232758)*x[2]
        s[0,1]=(0.674209146363)*x[0]**o+(-0.922409931962)*x[0]+(-0.328441886277)*x[1]**o+(0.981094102408)*x[1]+(0.481174182835)*x[2]**o+(-0.44590959358)*x[2]
        s[0,2]=(0.695494078474)*x[0]**o+(-0.0618250391783)*x[0]+(0.731471533841)*x[1]**o+(-0.71550566694)*x[1]+(-0.239535873248)*x[2]**o+(-0.763157808991)*x[2]
        s[0,3]=(0.754158913667)*x[0]**o+(-0.603448930533)*x[0]+(-0.200959580291)*x[1]**o+(0.298079100922)*x[1]+(0.15701085915)*x[2]**o+(0.18247341435)*x[2]
        s[0,4]=(0.894484225202)*x[0]**o+(0.908683878491)*x[0]+(0.452273398852)*x[1]**o+(0.446075531002)*x[1]+(-0.527120277613)*x[2]**o+(0.0825220159349)*x[2]
        s[1,0]=(0.1117942579)*x[0]**o+(0.616938000848)*x[0]+(-0.490920496055)*x[1]**o+(-0.46576972952)*x[1]+(-0.0234475725539)*x[2]**o+(-0.762964610488)*x[2]
        s[1,1]=(0.10779128676)*x[0]**o+(0.323623835098)*x[0]+(-0.56638095467)*x[1]**o+(-0.485758771921)*x[1]+(0.149606176158)*x[2]**o+(0.0163417655889)*x[2]
        s[1,2]=(-0.220849737003)*x[0]**o+(-0.269143304567)*x[0]+(0.53654939437)*x[1]**o+(0.434383033636)*x[1]+(0.474884241083)*x[2]**o+(-0.0619940742667)*x[2]
        s[1,3]=(0.789745098309)*x[0]**o+(-0.882265656942)*x[0]+(-0.513103080365)*x[1]**o+(0.461829232085)*x[1]+(-0.762923723193)*x[2]**o+(0.300345919163)*x[2]
        s[1,4]=(0.225139496075)*x[0]**o+(0.254192406789)*x[0]+(-0.984611398843)*x[1]**o+(-0.519021894131)*x[1]+(0.916659347214)*x[2]**o+(0.466927379869)*x[2]
        s[2,0]=(-0.404728214636)*x[0]**o+(-0.0890438316072)*x[0]+(-0.97035417582)*x[1]**o+(0.202361572805)*x[1]+(-0.540497194191)*x[2]**o+(-0.80807606235)*x[2]
        s[2,1]=(0.140494227071)*x[0]**o+(0.757504635086)*x[0]+(0.831217423619)*x[1]**o+(-0.647503683145)*x[1]+(0.821831665921)*x[2]**o+(-0.121451056151)*x[2]
        s[2,2]=(-0.962347494034)*x[0]**o+(0.633512101597)*x[0]+(-0.828226238758)*x[1]**o+(0.968353578898)*x[1]+(-0.553755153946)*x[2]**o+(0.938911535056)*x[2]
        s[2,3]=(0.450492204938)*x[0]**o+(-0.475913651564)*x[0]+(-0.341560341273)*x[1]**o+(-0.923252138473)*x[1]+(0.17946107137)*x[2]**o+(0.337986869404)*x[2]
        s[2,4]=(0.217063428863)*x[0]**o+(0.702651458761)*x[0]+(-0.769522744816)*x[1]**o+(-0.231379966769)*x[1]+(-0.0579749690283)*x[2]**o+(-0.766607638409)*x[2]
        s[3,0]=(0.681151302876)*x[0]**o+(-0.29704479144)*x[0]+(0.537446794047)*x[1]**o+(0.872410938876)*x[1]+(-0.934271483068)*x[2]**o+(0.270440171512)*x[2]
        s[3,1]=(0.530874723279)*x[0]**o+(0.739974626875)*x[0]+(-0.240867894838)*x[1]**o+(0.625808519502)*x[1]+(0.747357445736)*x[2]**o+(-0.242935065692)*x[2]
        s[3,2]=(0.682623726875)*x[0]**o+(-0.34894979966)*x[0]+(-0.307826595564)*x[1]**o+(-0.869693179146)*x[1]+(-0.814910983419)*x[2]**o+(-0.98110829358)*x[2]
        s[3,3]=(0.232395211532)*x[0]**o+(0.504566395286)*x[0]+(-0.029022506301)*x[1]**o+(0.897710188132)*x[1]+(-0.107215395289)*x[2]**o+(-0.541445668914)*x[2]
        s[3,4]=(0.916061625636)*x[0]**o+(-0.39003337702)*x[0]+(0.926535863586)*x[1]**o+(0.585922306493)*x[1]+(-0.761902914251)*x[2]**o+(0.489922931455)*x[2]
        ref[0,0,0]=o*(-0.829816450667)*x_ref[0]**(o-1)+(-0.147235008007)
        ref[0,0,1]=o*(0.492783189082)*x_ref[1]**(o-1)+(-0.512635666132)
        ref[0,0,2]=o*(0.890224791682)*x_ref[2]**(o-1)+(-0.956119232758)
        ref[0,1,0]=o*(0.674209146363)*x_ref[0]**(o-1)+(-0.922409931962)
        ref[0,1,1]=o*(-0.328441886277)*x_ref[1]**(o-1)+(0.981094102408)
        ref[0,1,2]=o*(0.481174182835)*x_ref[2]**(o-1)+(-0.44590959358)
        ref[0,2,0]=o*(0.695494078474)*x_ref[0]**(o-1)+(-0.0618250391783)
        ref[0,2,1]=o*(0.731471533841)*x_ref[1]**(o-1)+(-0.71550566694)
        ref[0,2,2]=o*(-0.239535873248)*x_ref[2]**(o-1)+(-0.763157808991)
        ref[0,3,0]=o*(0.754158913667)*x_ref[0]**(o-1)+(-0.603448930533)
        ref[0,3,1]=o*(-0.200959580291)*x_ref[1]**(o-1)+(0.298079100922)
        ref[0,3,2]=o*(0.15701085915)*x_ref[2]**(o-1)+(0.18247341435)
        ref[0,4,0]=o*(0.894484225202)*x_ref[0]**(o-1)+(0.908683878491)
        ref[0,4,1]=o*(0.452273398852)*x_ref[1]**(o-1)+(0.446075531002)
        ref[0,4,2]=o*(-0.527120277613)*x_ref[2]**(o-1)+(0.0825220159349)
        ref[1,0,0]=o*(0.1117942579)*x_ref[0]**(o-1)+(0.616938000848)
        ref[1,0,1]=o*(-0.490920496055)*x_ref[1]**(o-1)+(-0.46576972952)
        ref[1,0,2]=o*(-0.0234475725539)*x_ref[2]**(o-1)+(-0.762964610488)
        ref[1,1,0]=o*(0.10779128676)*x_ref[0]**(o-1)+(0.323623835098)
        ref[1,1,1]=o*(-0.56638095467)*x_ref[1]**(o-1)+(-0.485758771921)
        ref[1,1,2]=o*(0.149606176158)*x_ref[2]**(o-1)+(0.0163417655889)
        ref[1,2,0]=o*(-0.220849737003)*x_ref[0]**(o-1)+(-0.269143304567)
        ref[1,2,1]=o*(0.53654939437)*x_ref[1]**(o-1)+(0.434383033636)
        ref[1,2,2]=o*(0.474884241083)*x_ref[2]**(o-1)+(-0.0619940742667)
        ref[1,3,0]=o*(0.789745098309)*x_ref[0]**(o-1)+(-0.882265656942)
        ref[1,3,1]=o*(-0.513103080365)*x_ref[1]**(o-1)+(0.461829232085)
        ref[1,3,2]=o*(-0.762923723193)*x_ref[2]**(o-1)+(0.300345919163)
        ref[1,4,0]=o*(0.225139496075)*x_ref[0]**(o-1)+(0.254192406789)
        ref[1,4,1]=o*(-0.984611398843)*x_ref[1]**(o-1)+(-0.519021894131)
        ref[1,4,2]=o*(0.916659347214)*x_ref[2]**(o-1)+(0.466927379869)
        ref[2,0,0]=o*(-0.404728214636)*x_ref[0]**(o-1)+(-0.0890438316072)
        ref[2,0,1]=o*(-0.97035417582)*x_ref[1]**(o-1)+(0.202361572805)
        ref[2,0,2]=o*(-0.540497194191)*x_ref[2]**(o-1)+(-0.80807606235)
        ref[2,1,0]=o*(0.140494227071)*x_ref[0]**(o-1)+(0.757504635086)
        ref[2,1,1]=o*(0.831217423619)*x_ref[1]**(o-1)+(-0.647503683145)
        ref[2,1,2]=o*(0.821831665921)*x_ref[2]**(o-1)+(-0.121451056151)
        ref[2,2,0]=o*(-0.962347494034)*x_ref[0]**(o-1)+(0.633512101597)
        ref[2,2,1]=o*(-0.828226238758)*x_ref[1]**(o-1)+(0.968353578898)
        ref[2,2,2]=o*(-0.553755153946)*x_ref[2]**(o-1)+(0.938911535056)
        ref[2,3,0]=o*(0.450492204938)*x_ref[0]**(o-1)+(-0.475913651564)
        ref[2,3,1]=o*(-0.341560341273)*x_ref[1]**(o-1)+(-0.923252138473)
        ref[2,3,2]=o*(0.17946107137)*x_ref[2]**(o-1)+(0.337986869404)
        ref[2,4,0]=o*(0.217063428863)*x_ref[0]**(o-1)+(0.702651458761)
        ref[2,4,1]=o*(-0.769522744816)*x_ref[1]**(o-1)+(-0.231379966769)
        ref[2,4,2]=o*(-0.0579749690283)*x_ref[2]**(o-1)+(-0.766607638409)
        ref[3,0,0]=o*(0.681151302876)*x_ref[0]**(o-1)+(-0.29704479144)
        ref[3,0,1]=o*(0.537446794047)*x_ref[1]**(o-1)+(0.872410938876)
        ref[3,0,2]=o*(-0.934271483068)*x_ref[2]**(o-1)+(0.270440171512)
        ref[3,1,0]=o*(0.530874723279)*x_ref[0]**(o-1)+(0.739974626875)
        ref[3,1,1]=o*(-0.240867894838)*x_ref[1]**(o-1)+(0.625808519502)
        ref[3,1,2]=o*(0.747357445736)*x_ref[2]**(o-1)+(-0.242935065692)
        ref[3,2,0]=o*(0.682623726875)*x_ref[0]**(o-1)+(-0.34894979966)
        ref[3,2,1]=o*(-0.307826595564)*x_ref[1]**(o-1)+(-0.869693179146)
        ref[3,2,2]=o*(-0.814910983419)*x_ref[2]**(o-1)+(-0.98110829358)
        ref[3,3,0]=o*(0.232395211532)*x_ref[0]**(o-1)+(0.504566395286)
        ref[3,3,1]=o*(-0.029022506301)*x_ref[1]**(o-1)+(0.897710188132)
        ref[3,3,2]=o*(-0.107215395289)*x_ref[2]**(o-1)+(-0.541445668914)
        ref[3,4,0]=o*(0.916061625636)*x_ref[0]**(o-1)+(-0.39003337702)
        ref[3,4,1]=o*(0.926535863586)*x_ref[1]**(o-1)+(0.585922306493)
        ref[3,4,2]=o*(-0.761902914251)*x_ref[2]**(o-1)+(0.489922931455)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_Solution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnContactZero

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(-0.401271003072)*x[0]**o+(0.110662634074)*x[0]+(0.00658452640581)*x[1]**o+(0.0961174317738)*x[1]
        s[0,0,1]=(-0.697194977122)*x[0]**o+(-0.202095576104)*x[0]+(0.533118580807)*x[1]**o+(-0.806666747117)*x[1]
        s[0,1,0]=(0.330322436592)*x[0]**o+(-0.476215030667)*x[0]+(0.435516874614)*x[1]**o+(-0.305867365755)*x[1]
        s[0,1,1]=(0.663350700331)*x[0]**o+(0.719421457458)*x[0]+(0.56853576783)*x[1]**o+(-0.63138691405)*x[1]
        s[1,0,0]=(-0.330411596581)*x[0]**o+(0.562930649846)*x[0]+(0.372532798726)*x[1]**o+(-0.444620881121)*x[1]
        s[1,0,1]=(-0.128926814439)*x[0]**o+(-0.60950153677)*x[0]+(-0.958182145974)*x[1]**o+(0.355162970063)*x[1]
        s[1,1,0]=(0.197818586294)*x[0]**o+(0.821517517641)*x[0]+(-0.701366738238)*x[1]**o+(-0.506092465749)*x[1]
        s[1,1,1]=(0.0313418487908)*x[0]**o+(0.161293069084)*x[0]+(0.18801678809)*x[1]**o+(0.691344434767)*x[1]
        s[2,0,0]=(-0.684508001816)*x[0]**o+(-0.341824405415)*x[0]+(-0.51105537282)*x[1]**o+(-0.291070626075)*x[1]
        s[2,0,1]=(0.401725066632)*x[0]**o+(0.279867637006)*x[0]+(-0.899862170932)*x[1]**o+(-0.442022413224)*x[1]
        s[2,1,0]=(0.185395646678)*x[0]**o+(0.0999907785823)*x[0]+(-0.577244369816)*x[1]**o+(-0.0346150541428)*x[1]
        s[2,1,1]=(0.216201017349)*x[0]**o+(-0.295200102743)*x[0]+(-0.306163867778)*x[1]**o+(0.0910745810644)*x[1]
        s[3,0,0]=(0.804134508197)*x[0]**o+(-0.213041659269)*x[0]+(0.157574172841)*x[1]**o+(0.296960896944)*x[1]
        s[3,0,1]=(0.268965957593)*x[0]**o+(0.0238464096944)*x[0]+(-0.00156155375937)*x[1]**o+(0.958073421842)*x[1]
        s[3,1,0]=(0.517287095459)*x[0]**o+(-0.0687040369948)*x[0]+(0.801953753488)*x[1]**o+(0.521595036445)*x[1]
        s[3,1,1]=(0.175159770635)*x[0]**o+(-0.736749683511)*x[0]+(-0.630382453304)*x[1]**o+(0.188706240505)*x[1]
        s[4,0,0]=(-0.724712993645)*x[0]**o+(-0.387274725616)*x[0]+(0.694395156995)*x[1]**o+(-0.401125937857)*x[1]
        s[4,0,1]=(-0.86282575637)*x[0]**o+(-0.966750714134)*x[0]+(0.130551499076)*x[1]**o+(-0.50519607351)*x[1]
        s[4,1,0]=(0.721837471072)*x[0]**o+(0.780750959264)*x[0]+(0.642470119645)*x[1]**o+(-0.158180439909)*x[1]
        s[4,1,1]=(0.451682933961)*x[0]**o+(-0.802341009866)*x[0]+(-0.106997197799)*x[1]**o+(0.212654933949)*x[1]
        s[5,0,0]=(0.437602747572)*x[0]**o+(0.420962577059)*x[0]+(0.977375479522)*x[1]**o+(-0.57876475638)*x[1]
        s[5,0,1]=(-0.653922496012)*x[0]**o+(-0.197873016501)*x[0]+(-0.494086552357)*x[1]**o+(-0.879089855341)*x[1]
        s[5,1,0]=(-0.466463766139)*x[0]**o+(-0.0287797105685)*x[0]+(0.163811113598)*x[1]**o+(-0.752758839578)*x[1]
        s[5,1,1]=(-0.442295358061)*x[0]**o+(-0.928365763003)*x[0]+(-0.998523766886)*x[1]**o+(-0.210043550397)*x[1]
        ref[0,0,0,0]=o*(-0.401271003072)*x_ref[0]**(o-1)+(0.110662634074)
        ref[0,0,0,1]=o*(0.00658452640581)*x_ref[1]**(o-1)+(0.0961174317738)
        ref[0,0,1,0]=o*(-0.697194977122)*x_ref[0]**(o-1)+(-0.202095576104)
        ref[0,0,1,1]=o*(0.533118580807)*x_ref[1]**(o-1)+(-0.806666747117)
        ref[0,1,0,0]=o*(0.330322436592)*x_ref[0]**(o-1)+(-0.476215030667)
        ref[0,1,0,1]=o*(0.435516874614)*x_ref[1]**(o-1)+(-0.305867365755)
        ref[0,1,1,0]=o*(0.663350700331)*x_ref[0]**(o-1)+(0.719421457458)
        ref[0,1,1,1]=o*(0.56853576783)*x_ref[1]**(o-1)+(-0.63138691405)
        ref[1,0,0,0]=o*(-0.330411596581)*x_ref[0]**(o-1)+(0.562930649846)
        ref[1,0,0,1]=o*(0.372532798726)*x_ref[1]**(o-1)+(-0.444620881121)
        ref[1,0,1,0]=o*(-0.128926814439)*x_ref[0]**(o-1)+(-0.60950153677)
        ref[1,0,1,1]=o*(-0.958182145974)*x_ref[1]**(o-1)+(0.355162970063)
        ref[1,1,0,0]=o*(0.197818586294)*x_ref[0]**(o-1)+(0.821517517641)
        ref[1,1,0,1]=o*(-0.701366738238)*x_ref[1]**(o-1)+(-0.506092465749)
        ref[1,1,1,0]=o*(0.0313418487908)*x_ref[0]**(o-1)+(0.161293069084)
        ref[1,1,1,1]=o*(0.18801678809)*x_ref[1]**(o-1)+(0.691344434767)
        ref[2,0,0,0]=o*(-0.684508001816)*x_ref[0]**(o-1)+(-0.341824405415)
        ref[2,0,0,1]=o*(-0.51105537282)*x_ref[1]**(o-1)+(-0.291070626075)
        ref[2,0,1,0]=o*(0.401725066632)*x_ref[0]**(o-1)+(0.279867637006)
        ref[2,0,1,1]=o*(-0.899862170932)*x_ref[1]**(o-1)+(-0.442022413224)
        ref[2,1,0,0]=o*(0.185395646678)*x_ref[0]**(o-1)+(0.0999907785823)
        ref[2,1,0,1]=o*(-0.577244369816)*x_ref[1]**(o-1)+(-0.0346150541428)
        ref[2,1,1,0]=o*(0.216201017349)*x_ref[0]**(o-1)+(-0.295200102743)
        ref[2,1,1,1]=o*(-0.306163867778)*x_ref[1]**(o-1)+(0.0910745810644)
        ref[3,0,0,0]=o*(0.804134508197)*x_ref[0]**(o-1)+(-0.213041659269)
        ref[3,0,0,1]=o*(0.157574172841)*x_ref[1]**(o-1)+(0.296960896944)
        ref[3,0,1,0]=o*(0.268965957593)*x_ref[0]**(o-1)+(0.0238464096944)
        ref[3,0,1,1]=o*(-0.00156155375937)*x_ref[1]**(o-1)+(0.958073421842)
        ref[3,1,0,0]=o*(0.517287095459)*x_ref[0]**(o-1)+(-0.0687040369948)
        ref[3,1,0,1]=o*(0.801953753488)*x_ref[1]**(o-1)+(0.521595036445)
        ref[3,1,1,0]=o*(0.175159770635)*x_ref[0]**(o-1)+(-0.736749683511)
        ref[3,1,1,1]=o*(-0.630382453304)*x_ref[1]**(o-1)+(0.188706240505)
        ref[4,0,0,0]=o*(-0.724712993645)*x_ref[0]**(o-1)+(-0.387274725616)
        ref[4,0,0,1]=o*(0.694395156995)*x_ref[1]**(o-1)+(-0.401125937857)
        ref[4,0,1,0]=o*(-0.86282575637)*x_ref[0]**(o-1)+(-0.966750714134)
        ref[4,0,1,1]=o*(0.130551499076)*x_ref[1]**(o-1)+(-0.50519607351)
        ref[4,1,0,0]=o*(0.721837471072)*x_ref[0]**(o-1)+(0.780750959264)
        ref[4,1,0,1]=o*(0.642470119645)*x_ref[1]**(o-1)+(-0.158180439909)
        ref[4,1,1,0]=o*(0.451682933961)*x_ref[0]**(o-1)+(-0.802341009866)
        ref[4,1,1,1]=o*(-0.106997197799)*x_ref[1]**(o-1)+(0.212654933949)
        ref[5,0,0,0]=o*(0.437602747572)*x_ref[0]**(o-1)+(0.420962577059)
        ref[5,0,0,1]=o*(0.977375479522)*x_ref[1]**(o-1)+(-0.57876475638)
        ref[5,0,1,0]=o*(-0.653922496012)*x_ref[0]**(o-1)+(-0.197873016501)
        ref[5,0,1,1]=o*(-0.494086552357)*x_ref[1]**(o-1)+(-0.879089855341)
        ref[5,1,0,0]=o*(-0.466463766139)*x_ref[0]**(o-1)+(-0.0287797105685)
        ref[5,1,0,1]=o*(0.163811113598)*x_ref[1]**(o-1)+(-0.752758839578)
        ref[5,1,1,0]=o*(-0.442295358061)*x_ref[0]**(o-1)+(-0.928365763003)
        ref[5,1,1,1]=o*(-0.998523766886)*x_ref[1]**(o-1)+(-0.210043550397)
      else:
        s[0,0,0]=(-0.130526786389)*x[0]**o+(-0.798097445808)*x[0]+(-0.679305651671)*x[1]**o+(-0.805797697874)*x[1]+(0.344947047592)*x[2]**o+(-0.835073945341)*x[2]
        s[0,0,1]=(-0.725780665135)*x[0]**o+(-0.427130507741)*x[0]+(-0.172129968106)*x[1]**o+(-0.329971568167)*x[1]+(0.430421618441)*x[2]**o+(0.850034235311)*x[2]
        s[0,1,0]=(-0.0894725266496)*x[0]**o+(-0.599803400866)*x[0]+(-0.689863844979)*x[1]**o+(-0.433762379607)*x[1]+(0.0585705966933)*x[2]**o+(0.932652014579)*x[2]
        s[0,1,1]=(0.351726580485)*x[0]**o+(-0.46650217284)*x[0]+(-0.389405597178)*x[1]**o+(0.702473795612)*x[1]+(0.971136943329)*x[2]**o+(-0.149952798522)*x[2]
        s[1,0,0]=(-0.687968216558)*x[0]**o+(0.918982435037)*x[0]+(-0.425841096866)*x[1]**o+(0.738050157283)*x[1]+(-0.468164706689)*x[2]**o+(0.524190937704)*x[2]
        s[1,0,1]=(-0.0190626564569)*x[0]**o+(0.158516496015)*x[0]+(-0.591775293572)*x[1]**o+(0.0791152697184)*x[1]+(-0.661850377953)*x[2]**o+(-0.705879414238)*x[2]
        s[1,1,0]=(-0.538932477038)*x[0]**o+(0.781931047594)*x[0]+(-0.799541079517)*x[1]**o+(0.218777285901)*x[1]+(-0.475448704708)*x[2]**o+(-0.655013532097)*x[2]
        s[1,1,1]=(0.0320772665819)*x[0]**o+(-0.577577235436)*x[0]+(-0.736321547926)*x[1]**o+(-0.133681853862)*x[1]+(-0.0573985073549)*x[2]**o+(0.955212063412)*x[2]
        s[2,0,0]=(-0.257879955226)*x[0]**o+(-0.994024413493)*x[0]+(-0.679188188792)*x[1]**o+(-0.410885730889)*x[1]+(0.704555870926)*x[2]**o+(0.518649077753)*x[2]
        s[2,0,1]=(-0.901488792722)*x[0]**o+(-0.222487929076)*x[0]+(0.165342576493)*x[1]**o+(-0.850214182574)*x[1]+(0.294760812505)*x[2]**o+(-0.0831507413484)*x[2]
        s[2,1,0]=(0.316904380947)*x[0]**o+(0.627318211545)*x[0]+(-0.216902145108)*x[1]**o+(-0.673577316246)*x[1]+(0.122931487815)*x[2]**o+(-0.0949502423641)*x[2]
        s[2,1,1]=(-0.602869040889)*x[0]**o+(0.190451027649)*x[0]+(0.367827882092)*x[1]**o+(0.686234993984)*x[1]+(0.653140976608)*x[2]**o+(-0.168486517196)*x[2]
        s[3,0,0]=(0.271612350046)*x[0]**o+(-0.827115599685)*x[0]+(-0.586600506988)*x[1]**o+(0.128300770664)*x[1]+(-0.922582907477)*x[2]**o+(0.334699215375)*x[2]
        s[3,0,1]=(-0.595897268553)*x[0]**o+(0.425141939316)*x[0]+(0.713120162361)*x[1]**o+(-0.680621044232)*x[1]+(0.749485690034)*x[2]**o+(0.209547675753)*x[2]
        s[3,1,0]=(-0.530398143666)*x[0]**o+(0.137850234083)*x[0]+(0.953276619653)*x[1]**o+(-0.578161670579)*x[1]+(0.371898896542)*x[2]**o+(-0.381331753222)*x[2]
        s[3,1,1]=(0.822298482068)*x[0]**o+(-0.405836518978)*x[0]+(-0.647621688423)*x[1]**o+(-0.672131868147)*x[1]+(-0.438867520359)*x[2]**o+(-0.423328072541)*x[2]
        s[4,0,0]=(0.132863753285)*x[0]**o+(0.397422994959)*x[0]+(-0.804707213822)*x[1]**o+(0.536531749119)*x[1]+(0.411705453279)*x[2]**o+(-0.169385048425)*x[2]
        s[4,0,1]=(0.0701228685651)*x[0]**o+(0.639241932031)*x[0]+(-0.638730875998)*x[1]**o+(-0.922035920621)*x[1]+(-0.113168863437)*x[2]**o+(0.813287574357)*x[2]
        s[4,1,0]=(0.100082349838)*x[0]**o+(0.133955906808)*x[0]+(-0.928623633632)*x[1]**o+(-0.424742167549)*x[1]+(0.0239194885597)*x[2]**o+(-0.672806207969)*x[2]
        s[4,1,1]=(0.829725063543)*x[0]**o+(0.678552027954)*x[0]+(-0.812625405832)*x[1]**o+(-0.810345951883)*x[1]+(-0.211595232946)*x[2]**o+(-0.984554474963)*x[2]
        s[5,0,0]=(0.339493504495)*x[0]**o+(-0.903993357652)*x[0]+(-0.440233624866)*x[1]**o+(-0.430746451761)*x[1]+(0.111254680616)*x[2]**o+(0.709038943317)*x[2]
        s[5,0,1]=(0.931029457116)*x[0]**o+(-0.785398109537)*x[0]+(-0.326970114573)*x[1]**o+(0.0384958937297)*x[1]+(-0.896259053345)*x[2]**o+(-0.277237800601)*x[2]
        s[5,1,0]=(0.608509355178)*x[0]**o+(0.585955903578)*x[0]+(0.267506079769)*x[1]**o+(0.812314541749)*x[1]+(-0.283432880004)*x[2]**o+(0.909390413963)*x[2]
        s[5,1,1]=(0.23175779421)*x[0]**o+(-0.614072594905)*x[0]+(-0.979433217533)*x[1]**o+(-0.928308978862)*x[1]+(0.252162852495)*x[2]**o+(-0.395771235106)*x[2]
        ref[0,0,0,0]=o*(-0.130526786389)*x_ref[0]**(o-1)+(-0.798097445808)
        ref[0,0,0,1]=o*(-0.679305651671)*x_ref[1]**(o-1)+(-0.805797697874)
        ref[0,0,0,2]=o*(0.344947047592)*x_ref[2]**(o-1)+(-0.835073945341)
        ref[0,0,1,0]=o*(-0.725780665135)*x_ref[0]**(o-1)+(-0.427130507741)
        ref[0,0,1,1]=o*(-0.172129968106)*x_ref[1]**(o-1)+(-0.329971568167)
        ref[0,0,1,2]=o*(0.430421618441)*x_ref[2]**(o-1)+(0.850034235311)
        ref[0,1,0,0]=o*(-0.0894725266496)*x_ref[0]**(o-1)+(-0.599803400866)
        ref[0,1,0,1]=o*(-0.689863844979)*x_ref[1]**(o-1)+(-0.433762379607)
        ref[0,1,0,2]=o*(0.0585705966933)*x_ref[2]**(o-1)+(0.932652014579)
        ref[0,1,1,0]=o*(0.351726580485)*x_ref[0]**(o-1)+(-0.46650217284)
        ref[0,1,1,1]=o*(-0.389405597178)*x_ref[1]**(o-1)+(0.702473795612)
        ref[0,1,1,2]=o*(0.971136943329)*x_ref[2]**(o-1)+(-0.149952798522)
        ref[1,0,0,0]=o*(-0.687968216558)*x_ref[0]**(o-1)+(0.918982435037)
        ref[1,0,0,1]=o*(-0.425841096866)*x_ref[1]**(o-1)+(0.738050157283)
        ref[1,0,0,2]=o*(-0.468164706689)*x_ref[2]**(o-1)+(0.524190937704)
        ref[1,0,1,0]=o*(-0.0190626564569)*x_ref[0]**(o-1)+(0.158516496015)
        ref[1,0,1,1]=o*(-0.591775293572)*x_ref[1]**(o-1)+(0.0791152697184)
        ref[1,0,1,2]=o*(-0.661850377953)*x_ref[2]**(o-1)+(-0.705879414238)
        ref[1,1,0,0]=o*(-0.538932477038)*x_ref[0]**(o-1)+(0.781931047594)
        ref[1,1,0,1]=o*(-0.799541079517)*x_ref[1]**(o-1)+(0.218777285901)
        ref[1,1,0,2]=o*(-0.475448704708)*x_ref[2]**(o-1)+(-0.655013532097)
        ref[1,1,1,0]=o*(0.0320772665819)*x_ref[0]**(o-1)+(-0.577577235436)
        ref[1,1,1,1]=o*(-0.736321547926)*x_ref[1]**(o-1)+(-0.133681853862)
        ref[1,1,1,2]=o*(-0.0573985073549)*x_ref[2]**(o-1)+(0.955212063412)
        ref[2,0,0,0]=o*(-0.257879955226)*x_ref[0]**(o-1)+(-0.994024413493)
        ref[2,0,0,1]=o*(-0.679188188792)*x_ref[1]**(o-1)+(-0.410885730889)
        ref[2,0,0,2]=o*(0.704555870926)*x_ref[2]**(o-1)+(0.518649077753)
        ref[2,0,1,0]=o*(-0.901488792722)*x_ref[0]**(o-1)+(-0.222487929076)
        ref[2,0,1,1]=o*(0.165342576493)*x_ref[1]**(o-1)+(-0.850214182574)
        ref[2,0,1,2]=o*(0.294760812505)*x_ref[2]**(o-1)+(-0.0831507413484)
        ref[2,1,0,0]=o*(0.316904380947)*x_ref[0]**(o-1)+(0.627318211545)
        ref[2,1,0,1]=o*(-0.216902145108)*x_ref[1]**(o-1)+(-0.673577316246)
        ref[2,1,0,2]=o*(0.122931487815)*x_ref[2]**(o-1)+(-0.0949502423641)
        ref[2,1,1,0]=o*(-0.602869040889)*x_ref[0]**(o-1)+(0.190451027649)
        ref[2,1,1,1]=o*(0.367827882092)*x_ref[1]**(o-1)+(0.686234993984)
        ref[2,1,1,2]=o*(0.653140976608)*x_ref[2]**(o-1)+(-0.168486517196)
        ref[3,0,0,0]=o*(0.271612350046)*x_ref[0]**(o-1)+(-0.827115599685)
        ref[3,0,0,1]=o*(-0.586600506988)*x_ref[1]**(o-1)+(0.128300770664)
        ref[3,0,0,2]=o*(-0.922582907477)*x_ref[2]**(o-1)+(0.334699215375)
        ref[3,0,1,0]=o*(-0.595897268553)*x_ref[0]**(o-1)+(0.425141939316)
        ref[3,0,1,1]=o*(0.713120162361)*x_ref[1]**(o-1)+(-0.680621044232)
        ref[3,0,1,2]=o*(0.749485690034)*x_ref[2]**(o-1)+(0.209547675753)
        ref[3,1,0,0]=o*(-0.530398143666)*x_ref[0]**(o-1)+(0.137850234083)
        ref[3,1,0,1]=o*(0.953276619653)*x_ref[1]**(o-1)+(-0.578161670579)
        ref[3,1,0,2]=o*(0.371898896542)*x_ref[2]**(o-1)+(-0.381331753222)
        ref[3,1,1,0]=o*(0.822298482068)*x_ref[0]**(o-1)+(-0.405836518978)
        ref[3,1,1,1]=o*(-0.647621688423)*x_ref[1]**(o-1)+(-0.672131868147)
        ref[3,1,1,2]=o*(-0.438867520359)*x_ref[2]**(o-1)+(-0.423328072541)
        ref[4,0,0,0]=o*(0.132863753285)*x_ref[0]**(o-1)+(0.397422994959)
        ref[4,0,0,1]=o*(-0.804707213822)*x_ref[1]**(o-1)+(0.536531749119)
        ref[4,0,0,2]=o*(0.411705453279)*x_ref[2]**(o-1)+(-0.169385048425)
        ref[4,0,1,0]=o*(0.0701228685651)*x_ref[0]**(o-1)+(0.639241932031)
        ref[4,0,1,1]=o*(-0.638730875998)*x_ref[1]**(o-1)+(-0.922035920621)
        ref[4,0,1,2]=o*(-0.113168863437)*x_ref[2]**(o-1)+(0.813287574357)
        ref[4,1,0,0]=o*(0.100082349838)*x_ref[0]**(o-1)+(0.133955906808)
        ref[4,1,0,1]=o*(-0.928623633632)*x_ref[1]**(o-1)+(-0.424742167549)
        ref[4,1,0,2]=o*(0.0239194885597)*x_ref[2]**(o-1)+(-0.672806207969)
        ref[4,1,1,0]=o*(0.829725063543)*x_ref[0]**(o-1)+(0.678552027954)
        ref[4,1,1,1]=o*(-0.812625405832)*x_ref[1]**(o-1)+(-0.810345951883)
        ref[4,1,1,2]=o*(-0.211595232946)*x_ref[2]**(o-1)+(-0.984554474963)
        ref[5,0,0,0]=o*(0.339493504495)*x_ref[0]**(o-1)+(-0.903993357652)
        ref[5,0,0,1]=o*(-0.440233624866)*x_ref[1]**(o-1)+(-0.430746451761)
        ref[5,0,0,2]=o*(0.111254680616)*x_ref[2]**(o-1)+(0.709038943317)
        ref[5,0,1,0]=o*(0.931029457116)*x_ref[0]**(o-1)+(-0.785398109537)
        ref[5,0,1,1]=o*(-0.326970114573)*x_ref[1]**(o-1)+(0.0384958937297)
        ref[5,0,1,2]=o*(-0.896259053345)*x_ref[2]**(o-1)+(-0.277237800601)
        ref[5,1,0,0]=o*(0.608509355178)*x_ref[0]**(o-1)+(0.585955903578)
        ref[5,1,0,1]=o*(0.267506079769)*x_ref[1]**(o-1)+(0.812314541749)
        ref[5,1,0,2]=o*(-0.283432880004)*x_ref[2]**(o-1)+(0.909390413963)
        ref[5,1,1,0]=o*(0.23175779421)*x_ref[0]**(o-1)+(-0.614072594905)
        ref[5,1,1,1]=o*(-0.979433217533)*x_ref[1]**(o-1)+(-0.928308978862)
        ref[5,1,1,2]=o*(0.252162852495)*x_ref[2]**(o-1)+(-0.395771235106)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(0.435083239326)*x[0]+(-0.691333040625)*x[1]
        ref[0]=(0.435083239326)
        ref[1]=(-0.691333040625)
      else:
        s=(-0.845744322657)*x[0]+(1.16954436275)*x[1]+(-0.314198264294)*x[2]
        ref[0]=(-0.845744322657)
        ref[1]=(1.16954436275)
        ref[2]=(-0.314198264294)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-1.56901548345)*x[0]+(-1.12088095812)*x[1]
        s[1]=(0.376788177601)*x[0]+(-0.143805721474)*x[1]
        ref[0,0]=(-1.56901548345)
        ref[0,1]=(-1.12088095812)
        ref[1,0]=(0.376788177601)
        ref[1,1]=(-0.143805721474)
      else:
        s[0]=(-1.22983775782)*x[0]+(0.425438687122)*x[1]+(-0.209028867995)*x[2]
        s[1]=(-0.970298435902)*x[0]+(1.179109977)*x[1]+(-0.139193691146)*x[2]
        ref[0,0]=(-1.22983775782)
        ref[0,1]=(0.425438687122)
        ref[0,2]=(-0.209028867995)
        ref[1,0]=(-0.970298435902)
        ref[1,1]=(1.179109977)
        ref[1,2]=(-0.139193691146)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.227103956711)*x[0]+(-1.30307121808)*x[1]
        s[0,1]=(-0.706864797391)*x[0]+(-1.31928070332)*x[1]
        s[0,2]=(0.634642484639)*x[0]+(0.585731207147)*x[1]
        s[0,3]=(0.431900787729)*x[0]+(0.569282604392)*x[1]
        s[0,4]=(0.0340323913824)*x[0]+(-1.60115889253)*x[1]
        s[1,0]=(0.207234615543)*x[0]+(-0.026497432384)*x[1]
        s[1,1]=(0.401346730679)*x[0]+(0.45537938848)*x[1]
        s[1,2]=(-0.823742908589)*x[0]+(-0.644194821889)*x[1]
        s[1,3]=(-0.949631217459)*x[0]+(-0.32798097587)*x[1]
        s[1,4]=(0.080942942672)*x[0]+(0.155277152998)*x[1]
        s[2,0]=(0.554034527738)*x[0]+(-0.830836696374)*x[1]
        s[2,1]=(0.0740776979829)*x[0]+(-1.03972607973)*x[1]
        s[2,2]=(1.3414358663)*x[0]+(1.09045231286)*x[1]
        s[2,3]=(0.704268712291)*x[0]+(1.42775320769)*x[1]
        s[2,4]=(0.886813956436)*x[0]+(-0.516119087351)*x[1]
        s[3,0]=(0.128480826214)*x[0]+(-0.461671413746)*x[1]
        s[3,1]=(0.179829027295)*x[0]+(-0.832871937244)*x[1]
        s[3,2]=(0.378675852865)*x[0]+(-0.186442070411)*x[1]
        s[3,3]=(-0.445016424955)*x[0]+(-1.4956101833)*x[1]
        s[3,4]=(-0.753080545152)*x[0]+(-0.990468924099)*x[1]
        ref[0,0,0]=(-0.227103956711)
        ref[0,0,1]=(-1.30307121808)
        ref[0,1,0]=(-0.706864797391)
        ref[0,1,1]=(-1.31928070332)
        ref[0,2,0]=(0.634642484639)
        ref[0,2,1]=(0.585731207147)
        ref[0,3,0]=(0.431900787729)
        ref[0,3,1]=(0.569282604392)
        ref[0,4,0]=(0.0340323913824)
        ref[0,4,1]=(-1.60115889253)
        ref[1,0,0]=(0.207234615543)
        ref[1,0,1]=(-0.026497432384)
        ref[1,1,0]=(0.401346730679)
        ref[1,1,1]=(0.45537938848)
        ref[1,2,0]=(-0.823742908589)
        ref[1,2,1]=(-0.644194821889)
        ref[1,3,0]=(-0.949631217459)
        ref[1,3,1]=(-0.32798097587)
        ref[1,4,0]=(0.080942942672)
        ref[1,4,1]=(0.155277152998)
        ref[2,0,0]=(0.554034527738)
        ref[2,0,1]=(-0.830836696374)
        ref[2,1,0]=(0.0740776979829)
        ref[2,1,1]=(-1.03972607973)
        ref[2,2,0]=(1.3414358663)
        ref[2,2,1]=(1.09045231286)
        ref[2,3,0]=(0.704268712291)
        ref[2,3,1]=(1.42775320769)
        ref[2,4,0]=(0.886813956436)
        ref[2,4,1]=(-0.516119087351)
        ref[3,0,0]=(0.128480826214)
        ref[3,0,1]=(-0.461671413746)
        ref[3,1,0]=(0.179829027295)
        ref[3,1,1]=(-0.832871937244)
        ref[3,2,0]=(0.378675852865)
        ref[3,2,1]=(-0.186442070411)
        ref[3,3,0]=(-0.445016424955)
        ref[3,3,1]=(-1.4956101833)
        ref[3,4,0]=(-0.753080545152)
        ref[3,4,1]=(-0.990468924099)
      else:
        s[0,0]=(-1.70799712078)*x[0]+(-0.446362335826)*x[1]+(-0.263476523401)*x[2]
        s[0,1]=(-0.736145268076)*x[0]+(0.646755267112)*x[1]+(0.447221049824)*x[2]
        s[0,2]=(-0.642101757164)*x[0]+(-0.611769559201)*x[1]+(0.264550006471)*x[2]
        s[0,3]=(-0.676996071184)*x[0]+(-0.590821452023)*x[1]+(1.24075002019)*x[2]
        s[0,4]=(1.02823294921)*x[0]+(-0.888741194341)*x[1]+(-0.523239815445)*x[2]
        s[1,0]=(-0.59574377001)*x[0]+(-0.191278786974)*x[1]+(0.159150016923)*x[2]
        s[1,1]=(0.969247182713)*x[0]+(-1.28235270295)*x[1]+(0.849611232483)*x[2]
        s[1,2]=(-0.435529899282)*x[0]+(0.12900241589)*x[1]+(-0.0181780583503)*x[2]
        s[1,3]=(0.57112270455)*x[0]+(-0.991550186645)*x[1]+(0.00643683318083)*x[2]
        s[1,4]=(0.252122977044)*x[0]+(-1.26873100076)*x[1]+(-0.372881623479)*x[2]
        s[2,0]=(0.0976854139907)*x[0]+(-0.464484842151)*x[1]+(-0.695497231127)*x[2]
        s[2,1]=(-0.227165085737)*x[0]+(0.188692778493)*x[1]+(-1.51388182618)*x[2]
        s[2,2]=(0.962466954525)*x[0]+(-0.101670728061)*x[1]+(1.23116858758)*x[2]
        s[2,3]=(-0.609963828043)*x[0]+(-0.775332931826)*x[1]+(0.656264967614)*x[2]
        s[2,4]=(-1.54897910822)*x[0]+(-1.00555194316)*x[1]+(-0.812320917814)*x[2]
        s[3,0]=(-0.616002842225)*x[0]+(0.118716870548)*x[1]+(0.255205330827)*x[2]
        s[3,1]=(-0.26445657759)*x[0]+(0.447308749134)*x[1]+(0.220730408993)*x[2]
        s[3,2]=(-1.85693156269)*x[0]+(1.36352248787)*x[1]+(-0.0517488277821)*x[2]
        s[3,3]=(1.14523233511)*x[0]+(-1.34499926349)*x[1]+(0.228859653657)*x[2]
        s[3,4]=(-0.079222973052)*x[0]+(1.47684264227)*x[1]+(-0.530005798807)*x[2]
        ref[0,0,0]=(-1.70799712078)
        ref[0,0,1]=(-0.446362335826)
        ref[0,0,2]=(-0.263476523401)
        ref[0,1,0]=(-0.736145268076)
        ref[0,1,1]=(0.646755267112)
        ref[0,1,2]=(0.447221049824)
        ref[0,2,0]=(-0.642101757164)
        ref[0,2,1]=(-0.611769559201)
        ref[0,2,2]=(0.264550006471)
        ref[0,3,0]=(-0.676996071184)
        ref[0,3,1]=(-0.590821452023)
        ref[0,3,2]=(1.24075002019)
        ref[0,4,0]=(1.02823294921)
        ref[0,4,1]=(-0.888741194341)
        ref[0,4,2]=(-0.523239815445)
        ref[1,0,0]=(-0.59574377001)
        ref[1,0,1]=(-0.191278786974)
        ref[1,0,2]=(0.159150016923)
        ref[1,1,0]=(0.969247182713)
        ref[1,1,1]=(-1.28235270295)
        ref[1,1,2]=(0.849611232483)
        ref[1,2,0]=(-0.435529899282)
        ref[1,2,1]=(0.12900241589)
        ref[1,2,2]=(-0.0181780583503)
        ref[1,3,0]=(0.57112270455)
        ref[1,3,1]=(-0.991550186645)
        ref[1,3,2]=(0.00643683318083)
        ref[1,4,0]=(0.252122977044)
        ref[1,4,1]=(-1.26873100076)
        ref[1,4,2]=(-0.372881623479)
        ref[2,0,0]=(0.0976854139907)
        ref[2,0,1]=(-0.464484842151)
        ref[2,0,2]=(-0.695497231127)
        ref[2,1,0]=(-0.227165085737)
        ref[2,1,1]=(0.188692778493)
        ref[2,1,2]=(-1.51388182618)
        ref[2,2,0]=(0.962466954525)
        ref[2,2,1]=(-0.101670728061)
        ref[2,2,2]=(1.23116858758)
        ref[2,3,0]=(-0.609963828043)
        ref[2,3,1]=(-0.775332931826)
        ref[2,3,2]=(0.656264967614)
        ref[2,4,0]=(-1.54897910822)
        ref[2,4,1]=(-1.00555194316)
        ref[2,4,2]=(-0.812320917814)
        ref[3,0,0]=(-0.616002842225)
        ref[3,0,1]=(0.118716870548)
        ref[3,0,2]=(0.255205330827)
        ref[3,1,0]=(-0.26445657759)
        ref[3,1,1]=(0.447308749134)
        ref[3,1,2]=(0.220730408993)
        ref[3,2,0]=(-1.85693156269)
        ref[3,2,1]=(1.36352248787)
        ref[3,2,2]=(-0.0517488277821)
        ref[3,3,0]=(1.14523233511)
        ref[3,3,1]=(-1.34499926349)
        ref[3,3,2]=(0.228859653657)
        ref[3,4,0]=(-0.079222973052)
        ref[3,4,1]=(1.47684264227)
        ref[3,4,2]=(-0.530005798807)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactZero_fromSymbol_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnContactZero

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactZero
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactZero(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(1.49153517734)*x[0]+(-0.579975803933)*x[1]
        s[0,0,1]=(-0.696469728625)*x[0]+(1.21538948965)*x[1]
        s[0,1,0]=(-0.0991175021321)*x[0]+(-1.24138963759)*x[1]
        s[0,1,1]=(0.720869772304)*x[0]+(0.693983413462)*x[1]
        s[1,0,0]=(0.539658773124)*x[0]+(0.558956410162)*x[1]
        s[1,0,1]=(0.219371791063)*x[0]+(-0.0645808851409)*x[1]
        s[1,1,0]=(-0.982429431088)*x[0]+(0.765912701256)*x[1]
        s[1,1,1]=(0.409666526322)*x[0]+(-0.667562489533)*x[1]
        s[2,0,0]=(-1.00270035018)*x[0]+(-0.159198118098)*x[1]
        s[2,0,1]=(1.17972133138)*x[0]+(0.921797063108)*x[1]
        s[2,1,0]=(1.4726821986)*x[0]+(0.2041326504)*x[1]
        s[2,1,1]=(0.365688842529)*x[0]+(0.293751041397)*x[1]
        s[3,0,0]=(-0.485937426896)*x[0]+(-0.0722100496386)*x[1]
        s[3,0,1]=(0.937772100531)*x[0]+(-0.57987183111)*x[1]
        s[3,1,0]=(1.16518206513)*x[0]+(-0.715128236725)*x[1]
        s[3,1,1]=(0.130107225088)*x[0]+(-0.0702897307647)*x[1]
        s[4,0,0]=(-0.396052259681)*x[0]+(0.618983002296)*x[1]
        s[4,0,1]=(0.10948716533)*x[0]+(-0.413031012862)*x[1]
        s[4,1,0]=(1.30735893111)*x[0]+(-1.10958529012)*x[1]
        s[4,1,1]=(0.250657387621)*x[0]+(1.45183909124)*x[1]
        s[5,0,0]=(0.0301234829293)*x[0]+(0.374132370619)*x[1]
        s[5,0,1]=(-0.0915198655839)*x[0]+(0.933624705533)*x[1]
        s[5,1,0]=(1.1572487942)*x[0]+(-0.00851123614571)*x[1]
        s[5,1,1]=(0.761078997709)*x[0]+(1.60352507361)*x[1]
        ref[0,0,0,0]=(1.49153517734)
        ref[0,0,0,1]=(-0.579975803933)
        ref[0,0,1,0]=(-0.696469728625)
        ref[0,0,1,1]=(1.21538948965)
        ref[0,1,0,0]=(-0.0991175021321)
        ref[0,1,0,1]=(-1.24138963759)
        ref[0,1,1,0]=(0.720869772304)
        ref[0,1,1,1]=(0.693983413462)
        ref[1,0,0,0]=(0.539658773124)
        ref[1,0,0,1]=(0.558956410162)
        ref[1,0,1,0]=(0.219371791063)
        ref[1,0,1,1]=(-0.0645808851409)
        ref[1,1,0,0]=(-0.982429431088)
        ref[1,1,0,1]=(0.765912701256)
        ref[1,1,1,0]=(0.409666526322)
        ref[1,1,1,1]=(-0.667562489533)
        ref[2,0,0,0]=(-1.00270035018)
        ref[2,0,0,1]=(-0.159198118098)
        ref[2,0,1,0]=(1.17972133138)
        ref[2,0,1,1]=(0.921797063108)
        ref[2,1,0,0]=(1.4726821986)
        ref[2,1,0,1]=(0.2041326504)
        ref[2,1,1,0]=(0.365688842529)
        ref[2,1,1,1]=(0.293751041397)
        ref[3,0,0,0]=(-0.485937426896)
        ref[3,0,0,1]=(-0.0722100496386)
        ref[3,0,1,0]=(0.937772100531)
        ref[3,0,1,1]=(-0.57987183111)
        ref[3,1,0,0]=(1.16518206513)
        ref[3,1,0,1]=(-0.715128236725)
        ref[3,1,1,0]=(0.130107225088)
        ref[3,1,1,1]=(-0.0702897307647)
        ref[4,0,0,0]=(-0.396052259681)
        ref[4,0,0,1]=(0.618983002296)
        ref[4,0,1,0]=(0.10948716533)
        ref[4,0,1,1]=(-0.413031012862)
        ref[4,1,0,0]=(1.30735893111)
        ref[4,1,0,1]=(-1.10958529012)
        ref[4,1,1,0]=(0.250657387621)
        ref[4,1,1,1]=(1.45183909124)
        ref[5,0,0,0]=(0.0301234829293)
        ref[5,0,0,1]=(0.374132370619)
        ref[5,0,1,0]=(-0.0915198655839)
        ref[5,0,1,1]=(0.933624705533)
        ref[5,1,0,0]=(1.1572487942)
        ref[5,1,0,1]=(-0.00851123614571)
        ref[5,1,1,0]=(0.761078997709)
        ref[5,1,1,1]=(1.60352507361)
      else:
        s[0,0,0]=(1.16204910106)*x[0]+(1.21138322906)*x[1]+(-0.0524201871512)*x[2]
        s[0,0,1]=(-1.62418470618)*x[0]+(0.862850207692)*x[1]+(-0.287954408686)*x[2]
        s[0,1,0]=(-0.560096422291)*x[0]+(-0.3064736255)*x[1]+(-0.104600769051)*x[2]
        s[0,1,1]=(-1.41163310088)*x[0]+(-0.234279745635)*x[1]+(-1.22939949417)*x[2]
        s[1,0,0]=(0.21959990013)*x[0]+(0.40893057141)*x[1]+(0.643102887922)*x[2]
        s[1,0,1]=(-0.191194957197)*x[0]+(1.47353348334)*x[1]+(0.732969151984)*x[2]
        s[1,1,0]=(-1.19345990561)*x[0]+(-0.336674594448)*x[1]+(-0.0578613018881)*x[2]
        s[1,1,1]=(1.6232908613)*x[0]+(-0.107926586217)*x[1]+(0.235855060031)*x[2]
        s[2,0,0]=(0.820509328296)*x[0]+(0.547288169297)*x[1]+(-1.55487561435)*x[2]
        s[2,0,1]=(0.0893134152711)*x[0]+(0.161241646611)*x[1]+(-0.214358478289)*x[2]
        s[2,1,0]=(-1.12660016765)*x[0]+(1.53125870766)*x[1]+(0.697333670681)*x[2]
        s[2,1,1]=(-0.822208944906)*x[0]+(0.361159545618)*x[1]+(-0.0753065880934)*x[2]
        s[3,0,0]=(0.371298368343)*x[0]+(-0.935563626025)*x[1]+(1.32294571078)*x[2]
        s[3,0,1]=(0.228437335618)*x[0]+(1.00946312467)*x[1]+(-0.353871040012)*x[2]
        s[3,1,0]=(0.315905225539)*x[0]+(-1.02555884678)*x[1]+(0.388333892139)*x[2]
        s[3,1,1]=(1.23848230316)*x[0]+(1.02037500431)*x[1]+(0.158105617744)*x[2]
        s[4,0,0]=(-1.45272742631)*x[0]+(0.543388885954)*x[1]+(0.182106047094)*x[2]
        s[4,0,1]=(-0.351765522363)*x[0]+(-0.281592529507)*x[1]+(-0.324592486431)*x[2]
        s[4,1,0]=(-0.0890034165869)*x[0]+(-0.000670251305565)*x[1]+(1.39235380789)*x[2]
        s[4,1,1]=(-0.127096612653)*x[0]+(0.454493346168)*x[1]+(-0.360338313101)*x[2]
        s[5,0,0]=(-0.96052998866)*x[0]+(-0.0674238906685)*x[1]+(-1.63834268246)*x[2]
        s[5,0,1]=(-0.462036588746)*x[0]+(1.1804169499)*x[1]+(1.13779511332)*x[2]
        s[5,1,0]=(0.0863661479908)*x[0]+(0.0691347259375)*x[1]+(0.625219063907)*x[2]
        s[5,1,1]=(0.50049088687)*x[0]+(-0.438895013688)*x[1]+(-0.419695143786)*x[2]
        ref[0,0,0,0]=(1.16204910106)
        ref[0,0,0,1]=(1.21138322906)
        ref[0,0,0,2]=(-0.0524201871512)
        ref[0,0,1,0]=(-1.62418470618)
        ref[0,0,1,1]=(0.862850207692)
        ref[0,0,1,2]=(-0.287954408686)
        ref[0,1,0,0]=(-0.560096422291)
        ref[0,1,0,1]=(-0.3064736255)
        ref[0,1,0,2]=(-0.104600769051)
        ref[0,1,1,0]=(-1.41163310088)
        ref[0,1,1,1]=(-0.234279745635)
        ref[0,1,1,2]=(-1.22939949417)
        ref[1,0,0,0]=(0.21959990013)
        ref[1,0,0,1]=(0.40893057141)
        ref[1,0,0,2]=(0.643102887922)
        ref[1,0,1,0]=(-0.191194957197)
        ref[1,0,1,1]=(1.47353348334)
        ref[1,0,1,2]=(0.732969151984)
        ref[1,1,0,0]=(-1.19345990561)
        ref[1,1,0,1]=(-0.336674594448)
        ref[1,1,0,2]=(-0.0578613018881)
        ref[1,1,1,0]=(1.6232908613)
        ref[1,1,1,1]=(-0.107926586217)
        ref[1,1,1,2]=(0.235855060031)
        ref[2,0,0,0]=(0.820509328296)
        ref[2,0,0,1]=(0.547288169297)
        ref[2,0,0,2]=(-1.55487561435)
        ref[2,0,1,0]=(0.0893134152711)
        ref[2,0,1,1]=(0.161241646611)
        ref[2,0,1,2]=(-0.214358478289)
        ref[2,1,0,0]=(-1.12660016765)
        ref[2,1,0,1]=(1.53125870766)
        ref[2,1,0,2]=(0.697333670681)
        ref[2,1,1,0]=(-0.822208944906)
        ref[2,1,1,1]=(0.361159545618)
        ref[2,1,1,2]=(-0.0753065880934)
        ref[3,0,0,0]=(0.371298368343)
        ref[3,0,0,1]=(-0.935563626025)
        ref[3,0,0,2]=(1.32294571078)
        ref[3,0,1,0]=(0.228437335618)
        ref[3,0,1,1]=(1.00946312467)
        ref[3,0,1,2]=(-0.353871040012)
        ref[3,1,0,0]=(0.315905225539)
        ref[3,1,0,1]=(-1.02555884678)
        ref[3,1,0,2]=(0.388333892139)
        ref[3,1,1,0]=(1.23848230316)
        ref[3,1,1,1]=(1.02037500431)
        ref[3,1,1,2]=(0.158105617744)
        ref[4,0,0,0]=(-1.45272742631)
        ref[4,0,0,1]=(0.543388885954)
        ref[4,0,0,2]=(0.182106047094)
        ref[4,0,1,0]=(-0.351765522363)
        ref[4,0,1,1]=(-0.281592529507)
        ref[4,0,1,2]=(-0.324592486431)
        ref[4,1,0,0]=(-0.0890034165869)
        ref[4,1,0,1]=(-0.000670251305565)
        ref[4,1,0,2]=(1.39235380789)
        ref[4,1,1,0]=(-0.127096612653)
        ref[4,1,1,1]=(0.454493346168)
        ref[4,1,1,2]=(-0.360338313101)
        ref[5,0,0,0]=(-0.96052998866)
        ref[5,0,0,1]=(-0.0674238906685)
        ref[5,0,0,2]=(-1.63834268246)
        ref[5,0,1,0]=(-0.462036588746)
        ref[5,0,1,1]=(1.1804169499)
        ref[5,0,1,2]=(1.13779511332)
        ref[5,1,0,0]=(0.0863661479908)
        ref[5,1,0,1]=(0.0691347259375)
        ref[5,1,0,2]=(0.625219063907)
        ref[5,1,1,0]=(0.50049088687)
        ref[5,1,1,1]=(-0.438895013688)
        ref[5,1,1,2]=(-0.419695143786)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(-0.169375355906)*x[0]**o+(0.270029734958)*x[0]+(-0.19196016538)*x[1]**o+(0.426264369437)*x[1]
        ref[0]=o*(-0.169375355906)*x_ref[0]**(o-1)+(0.270029734958)
        ref[1]=o*(-0.19196016538)*x_ref[1]**(o-1)+(0.426264369437)
      else:
        arg=(0.00913595455019)*x[0]**o+(-0.561918629059)*x[0]+(0.0164102679759)*x[1]**o+(0.20749162111)*x[1]+(0.588703418401)*x[2]**o+(0.841289333498)*x[2]
        ref[0]=o*(0.00913595455019)*x_ref[0]**(o-1)+(-0.561918629059)
        ref[1]=o*(0.0164102679759)*x_ref[1]**(o-1)+(0.20749162111)
        ref[2]=o*(0.588703418401)*x_ref[2]**(o-1)+(0.841289333498)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(-0.290031175706)*x[0]**o+(0.690121137589)*x[0]+(0.916232953272)*x[1]**o+(0.427227803135)*x[1]
        arg[1]=(0.0325792679154)*x[0]**o+(0.773157737135)*x[0]+(-0.0443953478357)*x[1]**o+(0.772028975294)*x[1]
        ref[0,0]=o*(-0.290031175706)*x_ref[0]**(o-1)+(0.690121137589)
        ref[0,1]=o*(0.916232953272)*x_ref[1]**(o-1)+(0.427227803135)
        ref[1,0]=o*(0.0325792679154)*x_ref[0]**(o-1)+(0.773157737135)
        ref[1,1]=o*(-0.0443953478357)*x_ref[1]**(o-1)+(0.772028975294)
      else:
        arg[0]=(-0.119338345858)*x[0]**o+(-0.866134437839)*x[0]+(-0.727685742079)*x[1]**o+(0.465666609669)*x[1]+(-0.351266733199)*x[2]**o+(-0.960631632698)*x[2]
        arg[1]=(-0.731037524737)*x[0]**o+(0.415975622707)*x[0]+(-0.86639696362)*x[1]**o+(0.914277406921)*x[1]+(0.627502485514)*x[2]**o+(-0.855013681276)*x[2]
        ref[0,0]=o*(-0.119338345858)*x_ref[0]**(o-1)+(-0.866134437839)
        ref[0,1]=o*(-0.727685742079)*x_ref[1]**(o-1)+(0.465666609669)
        ref[0,2]=o*(-0.351266733199)*x_ref[2]**(o-1)+(-0.960631632698)
        ref[1,0]=o*(-0.731037524737)*x_ref[0]**(o-1)+(0.415975622707)
        ref[1,1]=o*(-0.86639696362)*x_ref[1]**(o-1)+(0.914277406921)
        ref[1,2]=o*(0.627502485514)*x_ref[2]**(o-1)+(-0.855013681276)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.148320408183)*x[0]**o+(-0.340902870434)*x[0]+(-0.0856445410272)*x[1]**o+(0.220499304831)*x[1]
        arg[0,1]=(0.915892845602)*x[0]**o+(-0.04770770327)*x[0]+(0.482403170451)*x[1]**o+(-0.639478756575)*x[1]
        arg[0,2]=(-0.109204159071)*x[0]**o+(0.641607024805)*x[0]+(-0.409310547283)*x[1]**o+(0.202984386731)*x[1]
        arg[0,3]=(0.436833770493)*x[0]**o+(-0.200611791892)*x[0]+(-0.74814554517)*x[1]**o+(0.571881526754)*x[1]
        arg[0,4]=(0.704812299415)*x[0]**o+(0.688151134045)*x[0]+(0.486135712907)*x[1]**o+(0.955314240096)*x[1]
        arg[1,0]=(-0.731790373321)*x[0]**o+(-0.711258122556)*x[0]+(-0.961514666684)*x[1]**o+(0.726573978492)*x[1]
        arg[1,1]=(0.975372389889)*x[0]**o+(0.5026238435)*x[0]+(0.948955767945)*x[1]**o+(-0.780842035663)*x[1]
        arg[1,2]=(0.742383399984)*x[0]**o+(-0.729678661652)*x[0]+(-0.815499612514)*x[1]**o+(-0.12280674993)*x[1]
        arg[1,3]=(0.323809901662)*x[0]**o+(-0.441906205977)*x[0]+(-0.308989501913)*x[1]**o+(-0.549353671447)*x[1]
        arg[1,4]=(0.711285710752)*x[0]**o+(0.297823778866)*x[0]+(0.645185023747)*x[1]**o+(0.825620074525)*x[1]
        arg[2,0]=(-0.373175217644)*x[0]**o+(-0.25651286112)*x[0]+(-0.46193047583)*x[1]**o+(-0.359820938943)*x[1]
        arg[2,1]=(-0.406101756283)*x[0]**o+(-0.38896428223)*x[0]+(-0.993257693721)*x[1]**o+(-0.910326366305)*x[1]
        arg[2,2]=(0.517566718504)*x[0]**o+(-0.582940900248)*x[0]+(-0.381600156082)*x[1]**o+(0.466575604699)*x[1]
        arg[2,3]=(0.323944380062)*x[0]**o+(-0.99359065412)*x[0]+(0.069389014076)*x[1]**o+(0.960192708612)*x[1]
        arg[2,4]=(-0.741362989132)*x[0]**o+(0.978137520347)*x[0]+(-0.398259900603)*x[1]**o+(-0.224949732925)*x[1]
        arg[3,0]=(-0.540235240193)*x[0]**o+(0.761488584116)*x[0]+(-0.100229643779)*x[1]**o+(-0.168724555964)*x[1]
        arg[3,1]=(0.565068220879)*x[0]**o+(-0.778936552173)*x[0]+(-0.933478028833)*x[1]**o+(-0.274446893155)*x[1]
        arg[3,2]=(-0.198878845493)*x[0]**o+(0.97185846381)*x[0]+(0.0345948289236)*x[1]**o+(0.359375885935)*x[1]
        arg[3,3]=(-0.815426880937)*x[0]**o+(-0.0734806259357)*x[0]+(-0.0452925239934)*x[1]**o+(0.976167480949)*x[1]
        arg[3,4]=(0.374670688698)*x[0]**o+(-0.427666745858)*x[0]+(-0.631640994091)*x[1]**o+(-0.312455066404)*x[1]
        ref[0,0,0]=o*(0.148320408183)*x_ref[0]**(o-1)+(-0.340902870434)
        ref[0,0,1]=o*(-0.0856445410272)*x_ref[1]**(o-1)+(0.220499304831)
        ref[0,1,0]=o*(0.915892845602)*x_ref[0]**(o-1)+(-0.04770770327)
        ref[0,1,1]=o*(0.482403170451)*x_ref[1]**(o-1)+(-0.639478756575)
        ref[0,2,0]=o*(-0.109204159071)*x_ref[0]**(o-1)+(0.641607024805)
        ref[0,2,1]=o*(-0.409310547283)*x_ref[1]**(o-1)+(0.202984386731)
        ref[0,3,0]=o*(0.436833770493)*x_ref[0]**(o-1)+(-0.200611791892)
        ref[0,3,1]=o*(-0.74814554517)*x_ref[1]**(o-1)+(0.571881526754)
        ref[0,4,0]=o*(0.704812299415)*x_ref[0]**(o-1)+(0.688151134045)
        ref[0,4,1]=o*(0.486135712907)*x_ref[1]**(o-1)+(0.955314240096)
        ref[1,0,0]=o*(-0.731790373321)*x_ref[0]**(o-1)+(-0.711258122556)
        ref[1,0,1]=o*(-0.961514666684)*x_ref[1]**(o-1)+(0.726573978492)
        ref[1,1,0]=o*(0.975372389889)*x_ref[0]**(o-1)+(0.5026238435)
        ref[1,1,1]=o*(0.948955767945)*x_ref[1]**(o-1)+(-0.780842035663)
        ref[1,2,0]=o*(0.742383399984)*x_ref[0]**(o-1)+(-0.729678661652)
        ref[1,2,1]=o*(-0.815499612514)*x_ref[1]**(o-1)+(-0.12280674993)
        ref[1,3,0]=o*(0.323809901662)*x_ref[0]**(o-1)+(-0.441906205977)
        ref[1,3,1]=o*(-0.308989501913)*x_ref[1]**(o-1)+(-0.549353671447)
        ref[1,4,0]=o*(0.711285710752)*x_ref[0]**(o-1)+(0.297823778866)
        ref[1,4,1]=o*(0.645185023747)*x_ref[1]**(o-1)+(0.825620074525)
        ref[2,0,0]=o*(-0.373175217644)*x_ref[0]**(o-1)+(-0.25651286112)
        ref[2,0,1]=o*(-0.46193047583)*x_ref[1]**(o-1)+(-0.359820938943)
        ref[2,1,0]=o*(-0.406101756283)*x_ref[0]**(o-1)+(-0.38896428223)
        ref[2,1,1]=o*(-0.993257693721)*x_ref[1]**(o-1)+(-0.910326366305)
        ref[2,2,0]=o*(0.517566718504)*x_ref[0]**(o-1)+(-0.582940900248)
        ref[2,2,1]=o*(-0.381600156082)*x_ref[1]**(o-1)+(0.466575604699)
        ref[2,3,0]=o*(0.323944380062)*x_ref[0]**(o-1)+(-0.99359065412)
        ref[2,3,1]=o*(0.069389014076)*x_ref[1]**(o-1)+(0.960192708612)
        ref[2,4,0]=o*(-0.741362989132)*x_ref[0]**(o-1)+(0.978137520347)
        ref[2,4,1]=o*(-0.398259900603)*x_ref[1]**(o-1)+(-0.224949732925)
        ref[3,0,0]=o*(-0.540235240193)*x_ref[0]**(o-1)+(0.761488584116)
        ref[3,0,1]=o*(-0.100229643779)*x_ref[1]**(o-1)+(-0.168724555964)
        ref[3,1,0]=o*(0.565068220879)*x_ref[0]**(o-1)+(-0.778936552173)
        ref[3,1,1]=o*(-0.933478028833)*x_ref[1]**(o-1)+(-0.274446893155)
        ref[3,2,0]=o*(-0.198878845493)*x_ref[0]**(o-1)+(0.97185846381)
        ref[3,2,1]=o*(0.0345948289236)*x_ref[1]**(o-1)+(0.359375885935)
        ref[3,3,0]=o*(-0.815426880937)*x_ref[0]**(o-1)+(-0.0734806259357)
        ref[3,3,1]=o*(-0.0452925239934)*x_ref[1]**(o-1)+(0.976167480949)
        ref[3,4,0]=o*(0.374670688698)*x_ref[0]**(o-1)+(-0.427666745858)
        ref[3,4,1]=o*(-0.631640994091)*x_ref[1]**(o-1)+(-0.312455066404)
      else:
        arg[0,0]=(0.284398400678)*x[0]**o+(0.219396164435)*x[0]+(0.220563761332)*x[1]**o+(0.167554964517)*x[1]+(0.234139558431)*x[2]**o+(-0.462262273341)*x[2]
        arg[0,1]=(0.161107248226)*x[0]**o+(0.23981806792)*x[0]+(-0.365265066245)*x[1]**o+(0.280522162689)*x[1]+(0.0813974911438)*x[2]**o+(-0.43305486384)*x[2]
        arg[0,2]=(0.813480874845)*x[0]**o+(0.600760069636)*x[0]+(-0.133815038485)*x[1]**o+(-0.954192097752)*x[1]+(-0.60756978514)*x[2]**o+(0.669710363926)*x[2]
        arg[0,3]=(-0.760542897936)*x[0]**o+(0.869702837484)*x[0]+(0.568626088907)*x[1]**o+(0.272054244422)*x[1]+(-0.0415999983147)*x[2]**o+(0.446199878551)*x[2]
        arg[0,4]=(0.0453200557409)*x[0]**o+(0.990444244175)*x[0]+(0.134265180195)*x[1]**o+(0.156166931353)*x[1]+(-0.787964274948)*x[2]**o+(0.0116920503615)*x[2]
        arg[1,0]=(-0.826245054647)*x[0]**o+(0.203727421041)*x[0]+(0.435254937068)*x[1]**o+(-0.271957510058)*x[1]+(0.24056400787)*x[2]**o+(-0.270322614397)*x[2]
        arg[1,1]=(-0.423339337474)*x[0]**o+(0.272439137387)*x[0]+(-0.0736213619539)*x[1]**o+(-0.776123259153)*x[1]+(-0.751736227059)*x[2]**o+(0.944253810697)*x[2]
        arg[1,2]=(0.189348519506)*x[0]**o+(-0.599085006375)*x[0]+(0.511802349511)*x[1]**o+(-0.309756999526)*x[1]+(-0.753093308971)*x[2]**o+(-0.109878524762)*x[2]
        arg[1,3]=(0.273889782311)*x[0]**o+(0.284416273071)*x[0]+(-0.793016836976)*x[1]**o+(0.584657111427)*x[1]+(0.202246448215)*x[2]**o+(0.669336280646)*x[2]
        arg[1,4]=(-0.310062687494)*x[0]**o+(-0.0558492819571)*x[0]+(0.661043054703)*x[1]**o+(0.708531199864)*x[1]+(0.0490202348501)*x[2]**o+(0.732983691308)*x[2]
        arg[2,0]=(0.967228638923)*x[0]**o+(-0.816725187456)*x[0]+(0.836005904943)*x[1]**o+(-0.618363868727)*x[1]+(-0.977101150283)*x[2]**o+(-0.960030792428)*x[2]
        arg[2,1]=(0.536503091036)*x[0]**o+(-0.786194077149)*x[0]+(-0.337609174718)*x[1]**o+(0.787326702105)*x[1]+(0.989900210061)*x[2]**o+(0.67077581859)*x[2]
        arg[2,2]=(-0.732242113661)*x[0]**o+(-0.565641876648)*x[0]+(0.175986347852)*x[1]**o+(0.862449074966)*x[1]+(0.0257656069443)*x[2]**o+(0.824927753427)*x[2]
        arg[2,3]=(-0.863272499797)*x[0]**o+(-0.817781186551)*x[0]+(0.168931269996)*x[1]**o+(-0.530060186715)*x[1]+(-0.516801368376)*x[2]**o+(-0.570137941882)*x[2]
        arg[2,4]=(-0.675287850319)*x[0]**o+(-0.672701614891)*x[0]+(-0.19851266374)*x[1]**o+(-0.0494587000627)*x[1]+(0.518006592112)*x[2]**o+(0.0337938303974)*x[2]
        arg[3,0]=(-0.175683006965)*x[0]**o+(-0.843980579113)*x[0]+(0.903358518604)*x[1]**o+(0.962156465407)*x[1]+(-0.0887392353523)*x[2]**o+(0.524587238729)*x[2]
        arg[3,1]=(0.0622433182846)*x[0]**o+(-0.756701969275)*x[0]+(0.721836266349)*x[1]**o+(0.457673032865)*x[1]+(0.704951904865)*x[2]**o+(0.781015828813)*x[2]
        arg[3,2]=(-0.457057269128)*x[0]**o+(-0.880403805028)*x[0]+(0.103553852578)*x[1]**o+(-0.807061998574)*x[1]+(-0.0352722677587)*x[2]**o+(0.0527948564177)*x[2]
        arg[3,3]=(0.161459807817)*x[0]**o+(0.698509459014)*x[0]+(-0.596487730094)*x[1]**o+(-0.906646770174)*x[1]+(0.567036380682)*x[2]**o+(0.490123167386)*x[2]
        arg[3,4]=(-0.668686195082)*x[0]**o+(0.911485638627)*x[0]+(-0.856948411336)*x[1]**o+(0.0348927535379)*x[1]+(0.17649505057)*x[2]**o+(-0.778920185271)*x[2]
        ref[0,0,0]=o*(0.284398400678)*x_ref[0]**(o-1)+(0.219396164435)
        ref[0,0,1]=o*(0.220563761332)*x_ref[1]**(o-1)+(0.167554964517)
        ref[0,0,2]=o*(0.234139558431)*x_ref[2]**(o-1)+(-0.462262273341)
        ref[0,1,0]=o*(0.161107248226)*x_ref[0]**(o-1)+(0.23981806792)
        ref[0,1,1]=o*(-0.365265066245)*x_ref[1]**(o-1)+(0.280522162689)
        ref[0,1,2]=o*(0.0813974911438)*x_ref[2]**(o-1)+(-0.43305486384)
        ref[0,2,0]=o*(0.813480874845)*x_ref[0]**(o-1)+(0.600760069636)
        ref[0,2,1]=o*(-0.133815038485)*x_ref[1]**(o-1)+(-0.954192097752)
        ref[0,2,2]=o*(-0.60756978514)*x_ref[2]**(o-1)+(0.669710363926)
        ref[0,3,0]=o*(-0.760542897936)*x_ref[0]**(o-1)+(0.869702837484)
        ref[0,3,1]=o*(0.568626088907)*x_ref[1]**(o-1)+(0.272054244422)
        ref[0,3,2]=o*(-0.0415999983147)*x_ref[2]**(o-1)+(0.446199878551)
        ref[0,4,0]=o*(0.0453200557409)*x_ref[0]**(o-1)+(0.990444244175)
        ref[0,4,1]=o*(0.134265180195)*x_ref[1]**(o-1)+(0.156166931353)
        ref[0,4,2]=o*(-0.787964274948)*x_ref[2]**(o-1)+(0.0116920503615)
        ref[1,0,0]=o*(-0.826245054647)*x_ref[0]**(o-1)+(0.203727421041)
        ref[1,0,1]=o*(0.435254937068)*x_ref[1]**(o-1)+(-0.271957510058)
        ref[1,0,2]=o*(0.24056400787)*x_ref[2]**(o-1)+(-0.270322614397)
        ref[1,1,0]=o*(-0.423339337474)*x_ref[0]**(o-1)+(0.272439137387)
        ref[1,1,1]=o*(-0.0736213619539)*x_ref[1]**(o-1)+(-0.776123259153)
        ref[1,1,2]=o*(-0.751736227059)*x_ref[2]**(o-1)+(0.944253810697)
        ref[1,2,0]=o*(0.189348519506)*x_ref[0]**(o-1)+(-0.599085006375)
        ref[1,2,1]=o*(0.511802349511)*x_ref[1]**(o-1)+(-0.309756999526)
        ref[1,2,2]=o*(-0.753093308971)*x_ref[2]**(o-1)+(-0.109878524762)
        ref[1,3,0]=o*(0.273889782311)*x_ref[0]**(o-1)+(0.284416273071)
        ref[1,3,1]=o*(-0.793016836976)*x_ref[1]**(o-1)+(0.584657111427)
        ref[1,3,2]=o*(0.202246448215)*x_ref[2]**(o-1)+(0.669336280646)
        ref[1,4,0]=o*(-0.310062687494)*x_ref[0]**(o-1)+(-0.0558492819571)
        ref[1,4,1]=o*(0.661043054703)*x_ref[1]**(o-1)+(0.708531199864)
        ref[1,4,2]=o*(0.0490202348501)*x_ref[2]**(o-1)+(0.732983691308)
        ref[2,0,0]=o*(0.967228638923)*x_ref[0]**(o-1)+(-0.816725187456)
        ref[2,0,1]=o*(0.836005904943)*x_ref[1]**(o-1)+(-0.618363868727)
        ref[2,0,2]=o*(-0.977101150283)*x_ref[2]**(o-1)+(-0.960030792428)
        ref[2,1,0]=o*(0.536503091036)*x_ref[0]**(o-1)+(-0.786194077149)
        ref[2,1,1]=o*(-0.337609174718)*x_ref[1]**(o-1)+(0.787326702105)
        ref[2,1,2]=o*(0.989900210061)*x_ref[2]**(o-1)+(0.67077581859)
        ref[2,2,0]=o*(-0.732242113661)*x_ref[0]**(o-1)+(-0.565641876648)
        ref[2,2,1]=o*(0.175986347852)*x_ref[1]**(o-1)+(0.862449074966)
        ref[2,2,2]=o*(0.0257656069443)*x_ref[2]**(o-1)+(0.824927753427)
        ref[2,3,0]=o*(-0.863272499797)*x_ref[0]**(o-1)+(-0.817781186551)
        ref[2,3,1]=o*(0.168931269996)*x_ref[1]**(o-1)+(-0.530060186715)
        ref[2,3,2]=o*(-0.516801368376)*x_ref[2]**(o-1)+(-0.570137941882)
        ref[2,4,0]=o*(-0.675287850319)*x_ref[0]**(o-1)+(-0.672701614891)
        ref[2,4,1]=o*(-0.19851266374)*x_ref[1]**(o-1)+(-0.0494587000627)
        ref[2,4,2]=o*(0.518006592112)*x_ref[2]**(o-1)+(0.0337938303974)
        ref[3,0,0]=o*(-0.175683006965)*x_ref[0]**(o-1)+(-0.843980579113)
        ref[3,0,1]=o*(0.903358518604)*x_ref[1]**(o-1)+(0.962156465407)
        ref[3,0,2]=o*(-0.0887392353523)*x_ref[2]**(o-1)+(0.524587238729)
        ref[3,1,0]=o*(0.0622433182846)*x_ref[0]**(o-1)+(-0.756701969275)
        ref[3,1,1]=o*(0.721836266349)*x_ref[1]**(o-1)+(0.457673032865)
        ref[3,1,2]=o*(0.704951904865)*x_ref[2]**(o-1)+(0.781015828813)
        ref[3,2,0]=o*(-0.457057269128)*x_ref[0]**(o-1)+(-0.880403805028)
        ref[3,2,1]=o*(0.103553852578)*x_ref[1]**(o-1)+(-0.807061998574)
        ref[3,2,2]=o*(-0.0352722677587)*x_ref[2]**(o-1)+(0.0527948564177)
        ref[3,3,0]=o*(0.161459807817)*x_ref[0]**(o-1)+(0.698509459014)
        ref[3,3,1]=o*(-0.596487730094)*x_ref[1]**(o-1)+(-0.906646770174)
        ref[3,3,2]=o*(0.567036380682)*x_ref[2]**(o-1)+(0.490123167386)
        ref[3,4,0]=o*(-0.668686195082)*x_ref[0]**(o-1)+(0.911485638627)
        ref[3,4,1]=o*(-0.856948411336)*x_ref[1]**(o-1)+(0.0348927535379)
        ref[3,4,2]=o*(0.17649505057)*x_ref[2]**(o-1)+(-0.778920185271)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.366719126165)*x[0]**o+(0.273305723392)*x[0]+(0.508134048679)*x[1]**o+(-0.0895788966541)*x[1]
        arg[0,0,1]=(-0.911986850385)*x[0]**o+(-0.98503317507)*x[0]+(-0.310897248279)*x[1]**o+(0.015206007134)*x[1]
        arg[0,1,0]=(-0.0827324676842)*x[0]**o+(0.566620026269)*x[0]+(-0.0581063189367)*x[1]**o+(0.379530936223)*x[1]
        arg[0,1,1]=(0.223247684076)*x[0]**o+(0.511247996036)*x[0]+(-0.904638808138)*x[1]**o+(-0.253982863496)*x[1]
        arg[1,0,0]=(-0.117040630362)*x[0]**o+(0.720200175398)*x[0]+(0.316014562047)*x[1]**o+(-0.88437304478)*x[1]
        arg[1,0,1]=(0.521261471788)*x[0]**o+(0.866618380963)*x[0]+(0.376866254345)*x[1]**o+(0.0905522236713)*x[1]
        arg[1,1,0]=(-0.0907011175214)*x[0]**o+(0.925809501719)*x[0]+(0.29066676347)*x[1]**o+(-0.77392365917)*x[1]
        arg[1,1,1]=(0.410922874646)*x[0]**o+(-0.801953959211)*x[0]+(-0.911104174539)*x[1]**o+(-0.640661859542)*x[1]
        arg[2,0,0]=(-0.449471274267)*x[0]**o+(0.8111872512)*x[0]+(0.0498814189394)*x[1]**o+(0.683703882124)*x[1]
        arg[2,0,1]=(-0.192396495147)*x[0]**o+(0.893457442524)*x[0]+(-0.946936565887)*x[1]**o+(-0.0290255758634)*x[1]
        arg[2,1,0]=(0.90847535637)*x[0]**o+(-0.517929281823)*x[0]+(0.389994692606)*x[1]**o+(-0.601708219886)*x[1]
        arg[2,1,1]=(0.401910281699)*x[0]**o+(0.485033224067)*x[0]+(-0.362139392478)*x[1]**o+(-0.740542640224)*x[1]
        arg[3,0,0]=(0.195815356554)*x[0]**o+(-0.584270182199)*x[0]+(-0.773247762709)*x[1]**o+(0.974109226972)*x[1]
        arg[3,0,1]=(0.516821334505)*x[0]**o+(-0.667535261235)*x[0]+(-0.687554420634)*x[1]**o+(-0.826211449593)*x[1]
        arg[3,1,0]=(-0.886684033283)*x[0]**o+(0.833394822235)*x[0]+(-0.509561014765)*x[1]**o+(-0.934990250803)*x[1]
        arg[3,1,1]=(-0.279505984235)*x[0]**o+(0.629210321924)*x[0]+(-0.245033518843)*x[1]**o+(0.148437993524)*x[1]
        arg[4,0,0]=(-0.120914130766)*x[0]**o+(-0.70386339291)*x[0]+(-0.37739143589)*x[1]**o+(-0.604979315802)*x[1]
        arg[4,0,1]=(-0.259492475213)*x[0]**o+(0.628922768093)*x[0]+(-0.973387886178)*x[1]**o+(0.285217747252)*x[1]
        arg[4,1,0]=(-0.986163107858)*x[0]**o+(-0.85082996164)*x[0]+(-0.560402256475)*x[1]**o+(-0.468278543242)*x[1]
        arg[4,1,1]=(0.370258762453)*x[0]**o+(0.870396552858)*x[0]+(0.57205142923)*x[1]**o+(0.332787259857)*x[1]
        arg[5,0,0]=(-0.570453853889)*x[0]**o+(0.253977538115)*x[0]+(0.628545140288)*x[1]**o+(-0.766550576107)*x[1]
        arg[5,0,1]=(-0.626776709555)*x[0]**o+(0.593526092433)*x[0]+(0.824052315861)*x[1]**o+(-0.409883522469)*x[1]
        arg[5,1,0]=(0.285256467088)*x[0]**o+(-0.808675657802)*x[0]+(-0.818251043807)*x[1]**o+(0.378756627769)*x[1]
        arg[5,1,1]=(-0.810805592247)*x[0]**o+(-0.879886206051)*x[0]+(0.378171206533)*x[1]**o+(0.478469089448)*x[1]
        ref[0,0,0,0]=o*(0.366719126165)*x_ref[0]**(o-1)+(0.273305723392)
        ref[0,0,0,1]=o*(0.508134048679)*x_ref[1]**(o-1)+(-0.0895788966541)
        ref[0,0,1,0]=o*(-0.911986850385)*x_ref[0]**(o-1)+(-0.98503317507)
        ref[0,0,1,1]=o*(-0.310897248279)*x_ref[1]**(o-1)+(0.015206007134)
        ref[0,1,0,0]=o*(-0.0827324676842)*x_ref[0]**(o-1)+(0.566620026269)
        ref[0,1,0,1]=o*(-0.0581063189367)*x_ref[1]**(o-1)+(0.379530936223)
        ref[0,1,1,0]=o*(0.223247684076)*x_ref[0]**(o-1)+(0.511247996036)
        ref[0,1,1,1]=o*(-0.904638808138)*x_ref[1]**(o-1)+(-0.253982863496)
        ref[1,0,0,0]=o*(-0.117040630362)*x_ref[0]**(o-1)+(0.720200175398)
        ref[1,0,0,1]=o*(0.316014562047)*x_ref[1]**(o-1)+(-0.88437304478)
        ref[1,0,1,0]=o*(0.521261471788)*x_ref[0]**(o-1)+(0.866618380963)
        ref[1,0,1,1]=o*(0.376866254345)*x_ref[1]**(o-1)+(0.0905522236713)
        ref[1,1,0,0]=o*(-0.0907011175214)*x_ref[0]**(o-1)+(0.925809501719)
        ref[1,1,0,1]=o*(0.29066676347)*x_ref[1]**(o-1)+(-0.77392365917)
        ref[1,1,1,0]=o*(0.410922874646)*x_ref[0]**(o-1)+(-0.801953959211)
        ref[1,1,1,1]=o*(-0.911104174539)*x_ref[1]**(o-1)+(-0.640661859542)
        ref[2,0,0,0]=o*(-0.449471274267)*x_ref[0]**(o-1)+(0.8111872512)
        ref[2,0,0,1]=o*(0.0498814189394)*x_ref[1]**(o-1)+(0.683703882124)
        ref[2,0,1,0]=o*(-0.192396495147)*x_ref[0]**(o-1)+(0.893457442524)
        ref[2,0,1,1]=o*(-0.946936565887)*x_ref[1]**(o-1)+(-0.0290255758634)
        ref[2,1,0,0]=o*(0.90847535637)*x_ref[0]**(o-1)+(-0.517929281823)
        ref[2,1,0,1]=o*(0.389994692606)*x_ref[1]**(o-1)+(-0.601708219886)
        ref[2,1,1,0]=o*(0.401910281699)*x_ref[0]**(o-1)+(0.485033224067)
        ref[2,1,1,1]=o*(-0.362139392478)*x_ref[1]**(o-1)+(-0.740542640224)
        ref[3,0,0,0]=o*(0.195815356554)*x_ref[0]**(o-1)+(-0.584270182199)
        ref[3,0,0,1]=o*(-0.773247762709)*x_ref[1]**(o-1)+(0.974109226972)
        ref[3,0,1,0]=o*(0.516821334505)*x_ref[0]**(o-1)+(-0.667535261235)
        ref[3,0,1,1]=o*(-0.687554420634)*x_ref[1]**(o-1)+(-0.826211449593)
        ref[3,1,0,0]=o*(-0.886684033283)*x_ref[0]**(o-1)+(0.833394822235)
        ref[3,1,0,1]=o*(-0.509561014765)*x_ref[1]**(o-1)+(-0.934990250803)
        ref[3,1,1,0]=o*(-0.279505984235)*x_ref[0]**(o-1)+(0.629210321924)
        ref[3,1,1,1]=o*(-0.245033518843)*x_ref[1]**(o-1)+(0.148437993524)
        ref[4,0,0,0]=o*(-0.120914130766)*x_ref[0]**(o-1)+(-0.70386339291)
        ref[4,0,0,1]=o*(-0.37739143589)*x_ref[1]**(o-1)+(-0.604979315802)
        ref[4,0,1,0]=o*(-0.259492475213)*x_ref[0]**(o-1)+(0.628922768093)
        ref[4,0,1,1]=o*(-0.973387886178)*x_ref[1]**(o-1)+(0.285217747252)
        ref[4,1,0,0]=o*(-0.986163107858)*x_ref[0]**(o-1)+(-0.85082996164)
        ref[4,1,0,1]=o*(-0.560402256475)*x_ref[1]**(o-1)+(-0.468278543242)
        ref[4,1,1,0]=o*(0.370258762453)*x_ref[0]**(o-1)+(0.870396552858)
        ref[4,1,1,1]=o*(0.57205142923)*x_ref[1]**(o-1)+(0.332787259857)
        ref[5,0,0,0]=o*(-0.570453853889)*x_ref[0]**(o-1)+(0.253977538115)
        ref[5,0,0,1]=o*(0.628545140288)*x_ref[1]**(o-1)+(-0.766550576107)
        ref[5,0,1,0]=o*(-0.626776709555)*x_ref[0]**(o-1)+(0.593526092433)
        ref[5,0,1,1]=o*(0.824052315861)*x_ref[1]**(o-1)+(-0.409883522469)
        ref[5,1,0,0]=o*(0.285256467088)*x_ref[0]**(o-1)+(-0.808675657802)
        ref[5,1,0,1]=o*(-0.818251043807)*x_ref[1]**(o-1)+(0.378756627769)
        ref[5,1,1,0]=o*(-0.810805592247)*x_ref[0]**(o-1)+(-0.879886206051)
        ref[5,1,1,1]=o*(0.378171206533)*x_ref[1]**(o-1)+(0.478469089448)
      else:
        arg[0,0,0]=(0.99032561737)*x[0]**o+(0.0664709329455)*x[0]+(0.118470702946)*x[1]**o+(0.339805181064)*x[1]+(-0.288819936068)*x[2]**o+(0.500626113335)*x[2]
        arg[0,0,1]=(-0.736833023385)*x[0]**o+(-0.160433791202)*x[0]+(-0.159295012314)*x[1]**o+(-0.0515197665154)*x[1]+(-0.199553046759)*x[2]**o+(0.912767397035)*x[2]
        arg[0,1,0]=(0.263643352646)*x[0]**o+(-0.408521561602)*x[0]+(-0.690441644678)*x[1]**o+(0.514925086967)*x[1]+(-0.321785011214)*x[2]**o+(-0.192767636106)*x[2]
        arg[0,1,1]=(-0.00679573309711)*x[0]**o+(-0.0919830030966)*x[0]+(0.0194635540782)*x[1]**o+(0.0364274479874)*x[1]+(0.324767149157)*x[2]**o+(-0.930770951272)*x[2]
        arg[1,0,0]=(0.129524159454)*x[0]**o+(-0.747948168258)*x[0]+(0.748091879992)*x[1]**o+(0.0701365933978)*x[1]+(-0.227595193537)*x[2]**o+(-0.515988222581)*x[2]
        arg[1,0,1]=(-0.369843455974)*x[0]**o+(0.902965907161)*x[0]+(0.841050267135)*x[1]**o+(0.985297243316)*x[1]+(-0.96057678523)*x[2]**o+(0.149329555515)*x[2]
        arg[1,1,0]=(-0.530918169849)*x[0]**o+(0.574734874263)*x[0]+(-0.56424658789)*x[1]**o+(-0.756154171146)*x[1]+(-0.181750429769)*x[2]**o+(-0.270972276027)*x[2]
        arg[1,1,1]=(0.18184543511)*x[0]**o+(0.810253164883)*x[0]+(-0.0289547932926)*x[1]**o+(0.690366471619)*x[1]+(0.862616271239)*x[2]**o+(0.157705360996)*x[2]
        arg[2,0,0]=(-0.732811475459)*x[0]**o+(-0.720788617286)*x[0]+(-0.72285785154)*x[1]**o+(-0.764360626538)*x[1]+(0.979115834974)*x[2]**o+(0.430570190112)*x[2]
        arg[2,0,1]=(-0.602364948602)*x[0]**o+(-0.313871272033)*x[0]+(0.931476652796)*x[1]**o+(-0.553237167378)*x[1]+(0.273773142735)*x[2]**o+(0.732796238419)*x[2]
        arg[2,1,0]=(0.723724167325)*x[0]**o+(-0.411330362765)*x[0]+(0.415411259564)*x[1]**o+(0.596006586583)*x[1]+(0.588177039382)*x[2]**o+(-0.365406082278)*x[2]
        arg[2,1,1]=(0.0622006916856)*x[0]**o+(0.583807018004)*x[0]+(0.292401319183)*x[1]**o+(-0.202393075873)*x[1]+(-0.544886623341)*x[2]**o+(-0.269087712755)*x[2]
        arg[3,0,0]=(-0.543339583883)*x[0]**o+(-0.594218090249)*x[0]+(0.463226896714)*x[1]**o+(0.613466907584)*x[1]+(0.147935164587)*x[2]**o+(0.696530808607)*x[2]
        arg[3,0,1]=(0.338109512519)*x[0]**o+(0.281428380284)*x[0]+(0.0445095482602)*x[1]**o+(0.898143737155)*x[1]+(0.0465131079784)*x[2]**o+(-0.311801195497)*x[2]
        arg[3,1,0]=(0.489699597199)*x[0]**o+(0.198461296558)*x[0]+(0.87785894323)*x[1]**o+(0.916226820395)*x[1]+(-0.473685913201)*x[2]**o+(-0.496145627682)*x[2]
        arg[3,1,1]=(0.249814020596)*x[0]**o+(-0.894315482252)*x[0]+(-0.778776373134)*x[1]**o+(0.760727700644)*x[1]+(0.743775735588)*x[2]**o+(-0.689040985439)*x[2]
        arg[4,0,0]=(-0.825052728563)*x[0]**o+(0.522046869865)*x[0]+(0.333964173928)*x[1]**o+(-0.76926539114)*x[1]+(0.412352181661)*x[2]**o+(-0.0067772174596)*x[2]
        arg[4,0,1]=(-0.478610156432)*x[0]**o+(0.750576911314)*x[0]+(-0.531813749953)*x[1]**o+(0.355951176778)*x[1]+(-0.852853671607)*x[2]**o+(0.980221079923)*x[2]
        arg[4,1,0]=(-0.641389506244)*x[0]**o+(0.881787042426)*x[0]+(-0.304080099649)*x[1]**o+(0.38448900132)*x[1]+(-0.047930997317)*x[2]**o+(-0.276038511441)*x[2]
        arg[4,1,1]=(0.606877338216)*x[0]**o+(0.693205674961)*x[0]+(-0.731785947563)*x[1]**o+(0.980888111857)*x[1]+(0.355758103413)*x[2]**o+(-0.493780352941)*x[2]
        arg[5,0,0]=(-0.542680086594)*x[0]**o+(-0.335712421489)*x[0]+(0.196257902892)*x[1]**o+(-0.923381865562)*x[1]+(0.396049043788)*x[2]**o+(0.231195219983)*x[2]
        arg[5,0,1]=(0.224328300764)*x[0]**o+(0.306254705923)*x[0]+(-0.298262471524)*x[1]**o+(0.318537412793)*x[1]+(-0.0971742408716)*x[2]**o+(-0.374440507273)*x[2]
        arg[5,1,0]=(-0.408985188836)*x[0]**o+(-0.932478279672)*x[0]+(0.700313488604)*x[1]**o+(0.259720889362)*x[1]+(0.862207003532)*x[2]**o+(0.646109275237)*x[2]
        arg[5,1,1]=(-0.0341740340851)*x[0]**o+(0.742119475866)*x[0]+(0.310640405448)*x[1]**o+(-0.295841203899)*x[1]+(-0.778064951853)*x[2]**o+(-0.847637829972)*x[2]
        ref[0,0,0,0]=o*(0.99032561737)*x_ref[0]**(o-1)+(0.0664709329455)
        ref[0,0,0,1]=o*(0.118470702946)*x_ref[1]**(o-1)+(0.339805181064)
        ref[0,0,0,2]=o*(-0.288819936068)*x_ref[2]**(o-1)+(0.500626113335)
        ref[0,0,1,0]=o*(-0.736833023385)*x_ref[0]**(o-1)+(-0.160433791202)
        ref[0,0,1,1]=o*(-0.159295012314)*x_ref[1]**(o-1)+(-0.0515197665154)
        ref[0,0,1,2]=o*(-0.199553046759)*x_ref[2]**(o-1)+(0.912767397035)
        ref[0,1,0,0]=o*(0.263643352646)*x_ref[0]**(o-1)+(-0.408521561602)
        ref[0,1,0,1]=o*(-0.690441644678)*x_ref[1]**(o-1)+(0.514925086967)
        ref[0,1,0,2]=o*(-0.321785011214)*x_ref[2]**(o-1)+(-0.192767636106)
        ref[0,1,1,0]=o*(-0.00679573309711)*x_ref[0]**(o-1)+(-0.0919830030966)
        ref[0,1,1,1]=o*(0.0194635540782)*x_ref[1]**(o-1)+(0.0364274479874)
        ref[0,1,1,2]=o*(0.324767149157)*x_ref[2]**(o-1)+(-0.930770951272)
        ref[1,0,0,0]=o*(0.129524159454)*x_ref[0]**(o-1)+(-0.747948168258)
        ref[1,0,0,1]=o*(0.748091879992)*x_ref[1]**(o-1)+(0.0701365933978)
        ref[1,0,0,2]=o*(-0.227595193537)*x_ref[2]**(o-1)+(-0.515988222581)
        ref[1,0,1,0]=o*(-0.369843455974)*x_ref[0]**(o-1)+(0.902965907161)
        ref[1,0,1,1]=o*(0.841050267135)*x_ref[1]**(o-1)+(0.985297243316)
        ref[1,0,1,2]=o*(-0.96057678523)*x_ref[2]**(o-1)+(0.149329555515)
        ref[1,1,0,0]=o*(-0.530918169849)*x_ref[0]**(o-1)+(0.574734874263)
        ref[1,1,0,1]=o*(-0.56424658789)*x_ref[1]**(o-1)+(-0.756154171146)
        ref[1,1,0,2]=o*(-0.181750429769)*x_ref[2]**(o-1)+(-0.270972276027)
        ref[1,1,1,0]=o*(0.18184543511)*x_ref[0]**(o-1)+(0.810253164883)
        ref[1,1,1,1]=o*(-0.0289547932926)*x_ref[1]**(o-1)+(0.690366471619)
        ref[1,1,1,2]=o*(0.862616271239)*x_ref[2]**(o-1)+(0.157705360996)
        ref[2,0,0,0]=o*(-0.732811475459)*x_ref[0]**(o-1)+(-0.720788617286)
        ref[2,0,0,1]=o*(-0.72285785154)*x_ref[1]**(o-1)+(-0.764360626538)
        ref[2,0,0,2]=o*(0.979115834974)*x_ref[2]**(o-1)+(0.430570190112)
        ref[2,0,1,0]=o*(-0.602364948602)*x_ref[0]**(o-1)+(-0.313871272033)
        ref[2,0,1,1]=o*(0.931476652796)*x_ref[1]**(o-1)+(-0.553237167378)
        ref[2,0,1,2]=o*(0.273773142735)*x_ref[2]**(o-1)+(0.732796238419)
        ref[2,1,0,0]=o*(0.723724167325)*x_ref[0]**(o-1)+(-0.411330362765)
        ref[2,1,0,1]=o*(0.415411259564)*x_ref[1]**(o-1)+(0.596006586583)
        ref[2,1,0,2]=o*(0.588177039382)*x_ref[2]**(o-1)+(-0.365406082278)
        ref[2,1,1,0]=o*(0.0622006916856)*x_ref[0]**(o-1)+(0.583807018004)
        ref[2,1,1,1]=o*(0.292401319183)*x_ref[1]**(o-1)+(-0.202393075873)
        ref[2,1,1,2]=o*(-0.544886623341)*x_ref[2]**(o-1)+(-0.269087712755)
        ref[3,0,0,0]=o*(-0.543339583883)*x_ref[0]**(o-1)+(-0.594218090249)
        ref[3,0,0,1]=o*(0.463226896714)*x_ref[1]**(o-1)+(0.613466907584)
        ref[3,0,0,2]=o*(0.147935164587)*x_ref[2]**(o-1)+(0.696530808607)
        ref[3,0,1,0]=o*(0.338109512519)*x_ref[0]**(o-1)+(0.281428380284)
        ref[3,0,1,1]=o*(0.0445095482602)*x_ref[1]**(o-1)+(0.898143737155)
        ref[3,0,1,2]=o*(0.0465131079784)*x_ref[2]**(o-1)+(-0.311801195497)
        ref[3,1,0,0]=o*(0.489699597199)*x_ref[0]**(o-1)+(0.198461296558)
        ref[3,1,0,1]=o*(0.87785894323)*x_ref[1]**(o-1)+(0.916226820395)
        ref[3,1,0,2]=o*(-0.473685913201)*x_ref[2]**(o-1)+(-0.496145627682)
        ref[3,1,1,0]=o*(0.249814020596)*x_ref[0]**(o-1)+(-0.894315482252)
        ref[3,1,1,1]=o*(-0.778776373134)*x_ref[1]**(o-1)+(0.760727700644)
        ref[3,1,1,2]=o*(0.743775735588)*x_ref[2]**(o-1)+(-0.689040985439)
        ref[4,0,0,0]=o*(-0.825052728563)*x_ref[0]**(o-1)+(0.522046869865)
        ref[4,0,0,1]=o*(0.333964173928)*x_ref[1]**(o-1)+(-0.76926539114)
        ref[4,0,0,2]=o*(0.412352181661)*x_ref[2]**(o-1)+(-0.0067772174596)
        ref[4,0,1,0]=o*(-0.478610156432)*x_ref[0]**(o-1)+(0.750576911314)
        ref[4,0,1,1]=o*(-0.531813749953)*x_ref[1]**(o-1)+(0.355951176778)
        ref[4,0,1,2]=o*(-0.852853671607)*x_ref[2]**(o-1)+(0.980221079923)
        ref[4,1,0,0]=o*(-0.641389506244)*x_ref[0]**(o-1)+(0.881787042426)
        ref[4,1,0,1]=o*(-0.304080099649)*x_ref[1]**(o-1)+(0.38448900132)
        ref[4,1,0,2]=o*(-0.047930997317)*x_ref[2]**(o-1)+(-0.276038511441)
        ref[4,1,1,0]=o*(0.606877338216)*x_ref[0]**(o-1)+(0.693205674961)
        ref[4,1,1,1]=o*(-0.731785947563)*x_ref[1]**(o-1)+(0.980888111857)
        ref[4,1,1,2]=o*(0.355758103413)*x_ref[2]**(o-1)+(-0.493780352941)
        ref[5,0,0,0]=o*(-0.542680086594)*x_ref[0]**(o-1)+(-0.335712421489)
        ref[5,0,0,1]=o*(0.196257902892)*x_ref[1]**(o-1)+(-0.923381865562)
        ref[5,0,0,2]=o*(0.396049043788)*x_ref[2]**(o-1)+(0.231195219983)
        ref[5,0,1,0]=o*(0.224328300764)*x_ref[0]**(o-1)+(0.306254705923)
        ref[5,0,1,1]=o*(-0.298262471524)*x_ref[1]**(o-1)+(0.318537412793)
        ref[5,0,1,2]=o*(-0.0971742408716)*x_ref[2]**(o-1)+(-0.374440507273)
        ref[5,1,0,0]=o*(-0.408985188836)*x_ref[0]**(o-1)+(-0.932478279672)
        ref[5,1,0,1]=o*(0.700313488604)*x_ref[1]**(o-1)+(0.259720889362)
        ref[5,1,0,2]=o*(0.862207003532)*x_ref[2]**(o-1)+(0.646109275237)
        ref[5,1,1,0]=o*(-0.0341740340851)*x_ref[0]**(o-1)+(0.742119475866)
        ref[5,1,1,1]=o*(0.310640405448)*x_ref[1]**(o-1)+(-0.295841203899)
        ref[5,1,1,2]=o*(-0.778064951853)*x_ref[2]**(o-1)+(-0.847637829972)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_Solution_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(-0.188926722839)*x[0]**o+(0.0528015322778)*x[0]+(0.394368405707)*x[1]**o+(0.573648619197)*x[1]
        ref[0]=o*(-0.188926722839)*x_ref[0]**(o-1)+(0.0528015322778)
        ref[1]=o*(0.394368405707)*x_ref[1]**(o-1)+(0.573648619197)
      else:
        arg=(0.208843709667)*x[0]**o+(-0.461780133723)*x[0]+(0.15028897973)*x[1]**o+(-0.594920423887)*x[1]+(0.517629763426)*x[2]**o+(0.403396285863)*x[2]
        ref[0]=o*(0.208843709667)*x_ref[0]**(o-1)+(-0.461780133723)
        ref[1]=o*(0.15028897973)*x_ref[1]**(o-1)+(-0.594920423887)
        ref[2]=o*(0.517629763426)*x_ref[2]**(o-1)+(0.403396285863)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_Solution_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(0.321445299816)*x[0]**o+(-0.133016832047)*x[0]+(0.663051729844)*x[1]**o+(-0.688058231943)*x[1]
        arg[1]=(-0.0269450330081)*x[0]**o+(0.0944332164606)*x[0]+(-0.285657276114)*x[1]**o+(-0.00151309619508)*x[1]
        ref[0,0]=o*(0.321445299816)*x_ref[0]**(o-1)+(-0.133016832047)
        ref[0,1]=o*(0.663051729844)*x_ref[1]**(o-1)+(-0.688058231943)
        ref[1,0]=o*(-0.0269450330081)*x_ref[0]**(o-1)+(0.0944332164606)
        ref[1,1]=o*(-0.285657276114)*x_ref[1]**(o-1)+(-0.00151309619508)
      else:
        arg[0]=(-0.779418963504)*x[0]**o+(-0.66017852882)*x[0]+(0.0796746454991)*x[1]**o+(-0.559782816375)*x[1]+(0.903645344893)*x[2]**o+(0.752370056114)*x[2]
        arg[1]=(-0.789198080015)*x[0]**o+(-0.61428352272)*x[0]+(-0.0678314090236)*x[1]**o+(-0.592189717525)*x[1]+(0.289759368386)*x[2]**o+(-0.612628874512)*x[2]
        ref[0,0]=o*(-0.779418963504)*x_ref[0]**(o-1)+(-0.66017852882)
        ref[0,1]=o*(0.0796746454991)*x_ref[1]**(o-1)+(-0.559782816375)
        ref[0,2]=o*(0.903645344893)*x_ref[2]**(o-1)+(0.752370056114)
        ref[1,0]=o*(-0.789198080015)*x_ref[0]**(o-1)+(-0.61428352272)
        ref[1,1]=o*(-0.0678314090236)*x_ref[1]**(o-1)+(-0.592189717525)
        ref[1,2]=o*(0.289759368386)*x_ref[2]**(o-1)+(-0.612628874512)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_Solution_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(-0.23566716053)*x[0]**o+(-0.72341376636)*x[0]+(0.972511874619)*x[1]**o+(-0.915617397257)*x[1]
        arg[0,1]=(-0.767927641628)*x[0]**o+(0.381522882363)*x[0]+(0.147312331507)*x[1]**o+(0.593669546711)*x[1]
        arg[0,2]=(0.735354496752)*x[0]**o+(0.0328129903288)*x[0]+(-0.113236521952)*x[1]**o+(0.486761746739)*x[1]
        arg[0,3]=(-0.324209941994)*x[0]**o+(-0.235510827792)*x[0]+(0.167116943517)*x[1]**o+(0.0751459244008)*x[1]
        arg[0,4]=(-0.880038149806)*x[0]**o+(0.250698509807)*x[0]+(-0.249975000596)*x[1]**o+(-0.597287763096)*x[1]
        arg[1,0]=(0.0776176376816)*x[0]**o+(0.719231364575)*x[0]+(-0.573766708326)*x[1]**o+(-0.0657431038913)*x[1]
        arg[1,1]=(0.214586176047)*x[0]**o+(-0.542584637828)*x[0]+(-0.649916769602)*x[1]**o+(0.360674473897)*x[1]
        arg[1,2]=(-0.131191309002)*x[0]**o+(0.00956079049513)*x[0]+(-0.0399067337815)*x[1]**o+(-0.870803424616)*x[1]
        arg[1,3]=(-0.604243786872)*x[0]**o+(0.439677657963)*x[0]+(0.749342339715)*x[1]**o+(0.772192804507)*x[1]
        arg[1,4]=(0.461907488239)*x[0]**o+(-0.957858912937)*x[0]+(0.915893716197)*x[1]**o+(-0.858798101783)*x[1]
        arg[2,0]=(0.922598387398)*x[0]**o+(-0.194676923002)*x[0]+(-0.724972013231)*x[1]**o+(-0.83198174562)*x[1]
        arg[2,1]=(0.62648959348)*x[0]**o+(-0.968390708088)*x[0]+(0.955519507666)*x[1]**o+(0.0140489471727)*x[1]
        arg[2,2]=(-0.488249561275)*x[0]**o+(-0.354607683897)*x[0]+(-0.781278758499)*x[1]**o+(-0.206598205965)*x[1]
        arg[2,3]=(-0.503987693598)*x[0]**o+(0.581909066959)*x[0]+(0.133400791996)*x[1]**o+(-0.234595457546)*x[1]
        arg[2,4]=(-0.768789727431)*x[0]**o+(0.669013649323)*x[0]+(-0.618484878747)*x[1]**o+(-0.287461699457)*x[1]
        arg[3,0]=(0.125603852132)*x[0]**o+(0.83276119445)*x[0]+(-0.643188775199)*x[1]**o+(0.228300434999)*x[1]
        arg[3,1]=(0.645892506866)*x[0]**o+(0.701922167913)*x[0]+(-0.283958147744)*x[1]**o+(-0.781197564279)*x[1]
        arg[3,2]=(-0.0995754594857)*x[0]**o+(-0.106281614694)*x[0]+(0.00912723779796)*x[1]**o+(0.841448365384)*x[1]
        arg[3,3]=(-0.664740577186)*x[0]**o+(0.100401840489)*x[0]+(0.334300978415)*x[1]**o+(-0.383639183037)*x[1]
        arg[3,4]=(0.949394733501)*x[0]**o+(-0.0768203586407)*x[0]+(0.715238033192)*x[1]**o+(-0.175178433047)*x[1]
        ref[0,0,0]=o*(-0.23566716053)*x_ref[0]**(o-1)+(-0.72341376636)
        ref[0,0,1]=o*(0.972511874619)*x_ref[1]**(o-1)+(-0.915617397257)
        ref[0,1,0]=o*(-0.767927641628)*x_ref[0]**(o-1)+(0.381522882363)
        ref[0,1,1]=o*(0.147312331507)*x_ref[1]**(o-1)+(0.593669546711)
        ref[0,2,0]=o*(0.735354496752)*x_ref[0]**(o-1)+(0.0328129903288)
        ref[0,2,1]=o*(-0.113236521952)*x_ref[1]**(o-1)+(0.486761746739)
        ref[0,3,0]=o*(-0.324209941994)*x_ref[0]**(o-1)+(-0.235510827792)
        ref[0,3,1]=o*(0.167116943517)*x_ref[1]**(o-1)+(0.0751459244008)
        ref[0,4,0]=o*(-0.880038149806)*x_ref[0]**(o-1)+(0.250698509807)
        ref[0,4,1]=o*(-0.249975000596)*x_ref[1]**(o-1)+(-0.597287763096)
        ref[1,0,0]=o*(0.0776176376816)*x_ref[0]**(o-1)+(0.719231364575)
        ref[1,0,1]=o*(-0.573766708326)*x_ref[1]**(o-1)+(-0.0657431038913)
        ref[1,1,0]=o*(0.214586176047)*x_ref[0]**(o-1)+(-0.542584637828)
        ref[1,1,1]=o*(-0.649916769602)*x_ref[1]**(o-1)+(0.360674473897)
        ref[1,2,0]=o*(-0.131191309002)*x_ref[0]**(o-1)+(0.00956079049513)
        ref[1,2,1]=o*(-0.0399067337815)*x_ref[1]**(o-1)+(-0.870803424616)
        ref[1,3,0]=o*(-0.604243786872)*x_ref[0]**(o-1)+(0.439677657963)
        ref[1,3,1]=o*(0.749342339715)*x_ref[1]**(o-1)+(0.772192804507)
        ref[1,4,0]=o*(0.461907488239)*x_ref[0]**(o-1)+(-0.957858912937)
        ref[1,4,1]=o*(0.915893716197)*x_ref[1]**(o-1)+(-0.858798101783)
        ref[2,0,0]=o*(0.922598387398)*x_ref[0]**(o-1)+(-0.194676923002)
        ref[2,0,1]=o*(-0.724972013231)*x_ref[1]**(o-1)+(-0.83198174562)
        ref[2,1,0]=o*(0.62648959348)*x_ref[0]**(o-1)+(-0.968390708088)
        ref[2,1,1]=o*(0.955519507666)*x_ref[1]**(o-1)+(0.0140489471727)
        ref[2,2,0]=o*(-0.488249561275)*x_ref[0]**(o-1)+(-0.354607683897)
        ref[2,2,1]=o*(-0.781278758499)*x_ref[1]**(o-1)+(-0.206598205965)
        ref[2,3,0]=o*(-0.503987693598)*x_ref[0]**(o-1)+(0.581909066959)
        ref[2,3,1]=o*(0.133400791996)*x_ref[1]**(o-1)+(-0.234595457546)
        ref[2,4,0]=o*(-0.768789727431)*x_ref[0]**(o-1)+(0.669013649323)
        ref[2,4,1]=o*(-0.618484878747)*x_ref[1]**(o-1)+(-0.287461699457)
        ref[3,0,0]=o*(0.125603852132)*x_ref[0]**(o-1)+(0.83276119445)
        ref[3,0,1]=o*(-0.643188775199)*x_ref[1]**(o-1)+(0.228300434999)
        ref[3,1,0]=o*(0.645892506866)*x_ref[0]**(o-1)+(0.701922167913)
        ref[3,1,1]=o*(-0.283958147744)*x_ref[1]**(o-1)+(-0.781197564279)
        ref[3,2,0]=o*(-0.0995754594857)*x_ref[0]**(o-1)+(-0.106281614694)
        ref[3,2,1]=o*(0.00912723779796)*x_ref[1]**(o-1)+(0.841448365384)
        ref[3,3,0]=o*(-0.664740577186)*x_ref[0]**(o-1)+(0.100401840489)
        ref[3,3,1]=o*(0.334300978415)*x_ref[1]**(o-1)+(-0.383639183037)
        ref[3,4,0]=o*(0.949394733501)*x_ref[0]**(o-1)+(-0.0768203586407)
        ref[3,4,1]=o*(0.715238033192)*x_ref[1]**(o-1)+(-0.175178433047)
      else:
        arg[0,0]=(0.697509098917)*x[0]**o+(-0.571983680004)*x[0]+(0.456254556306)*x[1]**o+(0.407076527516)*x[1]+(-0.379511349609)*x[2]**o+(0.37799055755)*x[2]
        arg[0,1]=(-0.543310012054)*x[0]**o+(0.622613643381)*x[0]+(0.899028609397)*x[1]**o+(0.0358870746022)*x[1]+(0.923875380698)*x[2]**o+(-0.79605331054)*x[2]
        arg[0,2]=(0.613316685189)*x[0]**o+(0.308568047177)*x[0]+(0.0817110033202)*x[1]**o+(0.631167179752)*x[1]+(0.527259723046)*x[2]**o+(-0.44240882282)*x[2]
        arg[0,3]=(0.831261835833)*x[0]**o+(-0.0869775296331)*x[0]+(0.30622781536)*x[1]**o+(0.633056041347)*x[1]+(0.631243241273)*x[2]**o+(0.100112313541)*x[2]
        arg[0,4]=(-0.997030704248)*x[0]**o+(-0.374466395678)*x[0]+(0.0194535973217)*x[1]**o+(0.816505299829)*x[1]+(-0.412869831136)*x[2]**o+(-0.943976805293)*x[2]
        arg[1,0]=(0.555404162574)*x[0]**o+(-0.335389786458)*x[0]+(0.644585507787)*x[1]**o+(0.917280812233)*x[1]+(0.417410132456)*x[2]**o+(-0.26505427144)*x[2]
        arg[1,1]=(0.781185373116)*x[0]**o+(-0.852319927495)*x[0]+(-0.442528270016)*x[1]**o+(-0.538132919634)*x[1]+(-0.604047417588)*x[2]**o+(0.727395882535)*x[2]
        arg[1,2]=(-0.272462727471)*x[0]**o+(-0.834077558378)*x[0]+(0.763269297137)*x[1]**o+(-0.823180222291)*x[1]+(-0.162146758865)*x[2]**o+(0.595529366226)*x[2]
        arg[1,3]=(-0.0468429326976)*x[0]**o+(-0.179116342871)*x[0]+(-0.640563576973)*x[1]**o+(0.914070705704)*x[1]+(0.725297040984)*x[2]**o+(0.870302256055)*x[2]
        arg[1,4]=(-0.0632444730547)*x[0]**o+(-0.266315658984)*x[0]+(0.533681589116)*x[1]**o+(0.709939511175)*x[1]+(-0.60554532679)*x[2]**o+(0.915224044125)*x[2]
        arg[2,0]=(0.23330035938)*x[0]**o+(-0.385419740264)*x[0]+(0.120424890588)*x[1]**o+(0.591983224766)*x[1]+(0.925564960339)*x[2]**o+(-0.602528014193)*x[2]
        arg[2,1]=(0.786024569139)*x[0]**o+(0.619287163829)*x[0]+(-0.722187904611)*x[1]**o+(0.275352886478)*x[1]+(0.723591624164)*x[2]**o+(0.0909486746072)*x[2]
        arg[2,2]=(0.766293557291)*x[0]**o+(0.0610694643295)*x[0]+(0.375714644104)*x[1]**o+(-0.772092520637)*x[1]+(0.775058332825)*x[2]**o+(0.533525926942)*x[2]
        arg[2,3]=(-0.67254491898)*x[0]**o+(-0.0926113197516)*x[0]+(-0.615891770107)*x[1]**o+(-0.616600504392)*x[1]+(-0.808251600122)*x[2]**o+(-0.602309670223)*x[2]
        arg[2,4]=(0.80242562495)*x[0]**o+(0.359171734464)*x[0]+(-0.560256436586)*x[1]**o+(-0.420334736194)*x[1]+(0.871043977034)*x[2]**o+(0.156212055829)*x[2]
        arg[3,0]=(-0.0569856826934)*x[0]**o+(-0.381868544897)*x[0]+(-0.396013644801)*x[1]**o+(0.695329212849)*x[1]+(0.201188831017)*x[2]**o+(0.471078018432)*x[2]
        arg[3,1]=(0.28457474179)*x[0]**o+(-0.623305572154)*x[0]+(-0.442659858168)*x[1]**o+(0.725900635371)*x[1]+(-0.908206119008)*x[2]**o+(-0.190223696293)*x[2]
        arg[3,2]=(0.568043480074)*x[0]**o+(0.942235524274)*x[0]+(-0.720727900911)*x[1]**o+(0.771808109591)*x[1]+(-0.538996050264)*x[2]**o+(-0.641448383256)*x[2]
        arg[3,3]=(0.00707362989382)*x[0]**o+(0.139812417833)*x[0]+(-0.179986304531)*x[1]**o+(-0.546332565953)*x[1]+(-0.687783685855)*x[2]**o+(0.292513389166)*x[2]
        arg[3,4]=(0.657315930332)*x[0]**o+(0.0252304793386)*x[0]+(0.540737656651)*x[1]**o+(0.832327802479)*x[1]+(-0.822641904799)*x[2]**o+(-0.599972412377)*x[2]
        ref[0,0,0]=o*(0.697509098917)*x_ref[0]**(o-1)+(-0.571983680004)
        ref[0,0,1]=o*(0.456254556306)*x_ref[1]**(o-1)+(0.407076527516)
        ref[0,0,2]=o*(-0.379511349609)*x_ref[2]**(o-1)+(0.37799055755)
        ref[0,1,0]=o*(-0.543310012054)*x_ref[0]**(o-1)+(0.622613643381)
        ref[0,1,1]=o*(0.899028609397)*x_ref[1]**(o-1)+(0.0358870746022)
        ref[0,1,2]=o*(0.923875380698)*x_ref[2]**(o-1)+(-0.79605331054)
        ref[0,2,0]=o*(0.613316685189)*x_ref[0]**(o-1)+(0.308568047177)
        ref[0,2,1]=o*(0.0817110033202)*x_ref[1]**(o-1)+(0.631167179752)
        ref[0,2,2]=o*(0.527259723046)*x_ref[2]**(o-1)+(-0.44240882282)
        ref[0,3,0]=o*(0.831261835833)*x_ref[0]**(o-1)+(-0.0869775296331)
        ref[0,3,1]=o*(0.30622781536)*x_ref[1]**(o-1)+(0.633056041347)
        ref[0,3,2]=o*(0.631243241273)*x_ref[2]**(o-1)+(0.100112313541)
        ref[0,4,0]=o*(-0.997030704248)*x_ref[0]**(o-1)+(-0.374466395678)
        ref[0,4,1]=o*(0.0194535973217)*x_ref[1]**(o-1)+(0.816505299829)
        ref[0,4,2]=o*(-0.412869831136)*x_ref[2]**(o-1)+(-0.943976805293)
        ref[1,0,0]=o*(0.555404162574)*x_ref[0]**(o-1)+(-0.335389786458)
        ref[1,0,1]=o*(0.644585507787)*x_ref[1]**(o-1)+(0.917280812233)
        ref[1,0,2]=o*(0.417410132456)*x_ref[2]**(o-1)+(-0.26505427144)
        ref[1,1,0]=o*(0.781185373116)*x_ref[0]**(o-1)+(-0.852319927495)
        ref[1,1,1]=o*(-0.442528270016)*x_ref[1]**(o-1)+(-0.538132919634)
        ref[1,1,2]=o*(-0.604047417588)*x_ref[2]**(o-1)+(0.727395882535)
        ref[1,2,0]=o*(-0.272462727471)*x_ref[0]**(o-1)+(-0.834077558378)
        ref[1,2,1]=o*(0.763269297137)*x_ref[1]**(o-1)+(-0.823180222291)
        ref[1,2,2]=o*(-0.162146758865)*x_ref[2]**(o-1)+(0.595529366226)
        ref[1,3,0]=o*(-0.0468429326976)*x_ref[0]**(o-1)+(-0.179116342871)
        ref[1,3,1]=o*(-0.640563576973)*x_ref[1]**(o-1)+(0.914070705704)
        ref[1,3,2]=o*(0.725297040984)*x_ref[2]**(o-1)+(0.870302256055)
        ref[1,4,0]=o*(-0.0632444730547)*x_ref[0]**(o-1)+(-0.266315658984)
        ref[1,4,1]=o*(0.533681589116)*x_ref[1]**(o-1)+(0.709939511175)
        ref[1,4,2]=o*(-0.60554532679)*x_ref[2]**(o-1)+(0.915224044125)
        ref[2,0,0]=o*(0.23330035938)*x_ref[0]**(o-1)+(-0.385419740264)
        ref[2,0,1]=o*(0.120424890588)*x_ref[1]**(o-1)+(0.591983224766)
        ref[2,0,2]=o*(0.925564960339)*x_ref[2]**(o-1)+(-0.602528014193)
        ref[2,1,0]=o*(0.786024569139)*x_ref[0]**(o-1)+(0.619287163829)
        ref[2,1,1]=o*(-0.722187904611)*x_ref[1]**(o-1)+(0.275352886478)
        ref[2,1,2]=o*(0.723591624164)*x_ref[2]**(o-1)+(0.0909486746072)
        ref[2,2,0]=o*(0.766293557291)*x_ref[0]**(o-1)+(0.0610694643295)
        ref[2,2,1]=o*(0.375714644104)*x_ref[1]**(o-1)+(-0.772092520637)
        ref[2,2,2]=o*(0.775058332825)*x_ref[2]**(o-1)+(0.533525926942)
        ref[2,3,0]=o*(-0.67254491898)*x_ref[0]**(o-1)+(-0.0926113197516)
        ref[2,3,1]=o*(-0.615891770107)*x_ref[1]**(o-1)+(-0.616600504392)
        ref[2,3,2]=o*(-0.808251600122)*x_ref[2]**(o-1)+(-0.602309670223)
        ref[2,4,0]=o*(0.80242562495)*x_ref[0]**(o-1)+(0.359171734464)
        ref[2,4,1]=o*(-0.560256436586)*x_ref[1]**(o-1)+(-0.420334736194)
        ref[2,4,2]=o*(0.871043977034)*x_ref[2]**(o-1)+(0.156212055829)
        ref[3,0,0]=o*(-0.0569856826934)*x_ref[0]**(o-1)+(-0.381868544897)
        ref[3,0,1]=o*(-0.396013644801)*x_ref[1]**(o-1)+(0.695329212849)
        ref[3,0,2]=o*(0.201188831017)*x_ref[2]**(o-1)+(0.471078018432)
        ref[3,1,0]=o*(0.28457474179)*x_ref[0]**(o-1)+(-0.623305572154)
        ref[3,1,1]=o*(-0.442659858168)*x_ref[1]**(o-1)+(0.725900635371)
        ref[3,1,2]=o*(-0.908206119008)*x_ref[2]**(o-1)+(-0.190223696293)
        ref[3,2,0]=o*(0.568043480074)*x_ref[0]**(o-1)+(0.942235524274)
        ref[3,2,1]=o*(-0.720727900911)*x_ref[1]**(o-1)+(0.771808109591)
        ref[3,2,2]=o*(-0.538996050264)*x_ref[2]**(o-1)+(-0.641448383256)
        ref[3,3,0]=o*(0.00707362989382)*x_ref[0]**(o-1)+(0.139812417833)
        ref[3,3,1]=o*(-0.179986304531)*x_ref[1]**(o-1)+(-0.546332565953)
        ref[3,3,2]=o*(-0.687783685855)*x_ref[2]**(o-1)+(0.292513389166)
        ref[3,4,0]=o*(0.657315930332)*x_ref[0]**(o-1)+(0.0252304793386)
        ref[3,4,1]=o*(0.540737656651)*x_ref[1]**(o-1)+(0.832327802479)
        ref[3,4,2]=o*(-0.822641904799)*x_ref[2]**(o-1)+(-0.599972412377)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_Solution_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.711259674136)*x[0]**o+(0.597099394118)*x[0]+(0.656676641605)*x[1]**o+(0.800065074626)*x[1]
        arg[0,0,1]=(0.410575880869)*x[0]**o+(0.0290305819624)*x[0]+(-0.746442034948)*x[1]**o+(0.074826200729)*x[1]
        arg[0,1,0]=(0.478073638149)*x[0]**o+(0.856920711223)*x[0]+(0.517173340088)*x[1]**o+(-0.677846282063)*x[1]
        arg[0,1,1]=(0.285231489647)*x[0]**o+(0.0756593965609)*x[0]+(-0.355221676478)*x[1]**o+(-0.520564308221)*x[1]
        arg[1,0,0]=(-0.368777104698)*x[0]**o+(0.474996103371)*x[0]+(0.675654207136)*x[1]**o+(-0.0324979517659)*x[1]
        arg[1,0,1]=(0.498857835281)*x[0]**o+(-0.73836840989)*x[0]+(0.362789682422)*x[1]**o+(0.315425076703)*x[1]
        arg[1,1,0]=(-0.325384820094)*x[0]**o+(-0.895297521761)*x[0]+(0.563090918504)*x[1]**o+(0.589834648825)*x[1]
        arg[1,1,1]=(0.0378060061714)*x[0]**o+(-0.429064920806)*x[0]+(-0.467324629077)*x[1]**o+(0.938161415082)*x[1]
        arg[2,0,0]=(-0.527827738902)*x[0]**o+(-0.534425169092)*x[0]+(-0.185111533531)*x[1]**o+(-0.810076656622)*x[1]
        arg[2,0,1]=(-0.221712302033)*x[0]**o+(0.883619587624)*x[0]+(-0.972912188123)*x[1]**o+(0.0780565750992)*x[1]
        arg[2,1,0]=(-0.752942706408)*x[0]**o+(-0.153790659605)*x[0]+(-0.398384592556)*x[1]**o+(0.657319049074)*x[1]
        arg[2,1,1]=(0.428492876383)*x[0]**o+(0.427090189076)*x[0]+(-0.017400284896)*x[1]**o+(-0.730635641841)*x[1]
        arg[3,0,0]=(-0.644602330168)*x[0]**o+(0.706532342264)*x[0]+(-0.64532460698)*x[1]**o+(0.850059843173)*x[1]
        arg[3,0,1]=(-0.63066688687)*x[0]**o+(0.578132047851)*x[0]+(0.413335880906)*x[1]**o+(0.611233278281)*x[1]
        arg[3,1,0]=(-0.247378556309)*x[0]**o+(-0.631688468936)*x[0]+(-0.898130068425)*x[1]**o+(0.147210661251)*x[1]
        arg[3,1,1]=(0.979026126394)*x[0]**o+(-0.231003559285)*x[0]+(-0.884530953901)*x[1]**o+(-0.453907922804)*x[1]
        arg[4,0,0]=(-0.584910281652)*x[0]**o+(-0.808929690751)*x[0]+(0.661854511996)*x[1]**o+(0.262336033771)*x[1]
        arg[4,0,1]=(0.32006961919)*x[0]**o+(0.407637671852)*x[0]+(-0.36617527544)*x[1]**o+(-0.28786191714)*x[1]
        arg[4,1,0]=(0.718670448416)*x[0]**o+(-0.836956284868)*x[0]+(0.694744974874)*x[1]**o+(-0.176920245996)*x[1]
        arg[4,1,1]=(-0.892867770142)*x[0]**o+(-0.439240069099)*x[0]+(0.960956271989)*x[1]**o+(-0.559541152716)*x[1]
        arg[5,0,0]=(-0.159459484106)*x[0]**o+(0.497366075466)*x[0]+(0.776343693655)*x[1]**o+(0.326882397775)*x[1]
        arg[5,0,1]=(-0.769197598992)*x[0]**o+(-0.155931232816)*x[0]+(0.306889959757)*x[1]**o+(0.283798117232)*x[1]
        arg[5,1,0]=(0.329987736778)*x[0]**o+(-0.181917315586)*x[0]+(0.896508353752)*x[1]**o+(0.505276687831)*x[1]
        arg[5,1,1]=(-0.805264678584)*x[0]**o+(0.1541429191)*x[0]+(0.759370357364)*x[1]**o+(-0.858941373648)*x[1]
        ref[0,0,0,0]=o*(0.711259674136)*x_ref[0]**(o-1)+(0.597099394118)
        ref[0,0,0,1]=o*(0.656676641605)*x_ref[1]**(o-1)+(0.800065074626)
        ref[0,0,1,0]=o*(0.410575880869)*x_ref[0]**(o-1)+(0.0290305819624)
        ref[0,0,1,1]=o*(-0.746442034948)*x_ref[1]**(o-1)+(0.074826200729)
        ref[0,1,0,0]=o*(0.478073638149)*x_ref[0]**(o-1)+(0.856920711223)
        ref[0,1,0,1]=o*(0.517173340088)*x_ref[1]**(o-1)+(-0.677846282063)
        ref[0,1,1,0]=o*(0.285231489647)*x_ref[0]**(o-1)+(0.0756593965609)
        ref[0,1,1,1]=o*(-0.355221676478)*x_ref[1]**(o-1)+(-0.520564308221)
        ref[1,0,0,0]=o*(-0.368777104698)*x_ref[0]**(o-1)+(0.474996103371)
        ref[1,0,0,1]=o*(0.675654207136)*x_ref[1]**(o-1)+(-0.0324979517659)
        ref[1,0,1,0]=o*(0.498857835281)*x_ref[0]**(o-1)+(-0.73836840989)
        ref[1,0,1,1]=o*(0.362789682422)*x_ref[1]**(o-1)+(0.315425076703)
        ref[1,1,0,0]=o*(-0.325384820094)*x_ref[0]**(o-1)+(-0.895297521761)
        ref[1,1,0,1]=o*(0.563090918504)*x_ref[1]**(o-1)+(0.589834648825)
        ref[1,1,1,0]=o*(0.0378060061714)*x_ref[0]**(o-1)+(-0.429064920806)
        ref[1,1,1,1]=o*(-0.467324629077)*x_ref[1]**(o-1)+(0.938161415082)
        ref[2,0,0,0]=o*(-0.527827738902)*x_ref[0]**(o-1)+(-0.534425169092)
        ref[2,0,0,1]=o*(-0.185111533531)*x_ref[1]**(o-1)+(-0.810076656622)
        ref[2,0,1,0]=o*(-0.221712302033)*x_ref[0]**(o-1)+(0.883619587624)
        ref[2,0,1,1]=o*(-0.972912188123)*x_ref[1]**(o-1)+(0.0780565750992)
        ref[2,1,0,0]=o*(-0.752942706408)*x_ref[0]**(o-1)+(-0.153790659605)
        ref[2,1,0,1]=o*(-0.398384592556)*x_ref[1]**(o-1)+(0.657319049074)
        ref[2,1,1,0]=o*(0.428492876383)*x_ref[0]**(o-1)+(0.427090189076)
        ref[2,1,1,1]=o*(-0.017400284896)*x_ref[1]**(o-1)+(-0.730635641841)
        ref[3,0,0,0]=o*(-0.644602330168)*x_ref[0]**(o-1)+(0.706532342264)
        ref[3,0,0,1]=o*(-0.64532460698)*x_ref[1]**(o-1)+(0.850059843173)
        ref[3,0,1,0]=o*(-0.63066688687)*x_ref[0]**(o-1)+(0.578132047851)
        ref[3,0,1,1]=o*(0.413335880906)*x_ref[1]**(o-1)+(0.611233278281)
        ref[3,1,0,0]=o*(-0.247378556309)*x_ref[0]**(o-1)+(-0.631688468936)
        ref[3,1,0,1]=o*(-0.898130068425)*x_ref[1]**(o-1)+(0.147210661251)
        ref[3,1,1,0]=o*(0.979026126394)*x_ref[0]**(o-1)+(-0.231003559285)
        ref[3,1,1,1]=o*(-0.884530953901)*x_ref[1]**(o-1)+(-0.453907922804)
        ref[4,0,0,0]=o*(-0.584910281652)*x_ref[0]**(o-1)+(-0.808929690751)
        ref[4,0,0,1]=o*(0.661854511996)*x_ref[1]**(o-1)+(0.262336033771)
        ref[4,0,1,0]=o*(0.32006961919)*x_ref[0]**(o-1)+(0.407637671852)
        ref[4,0,1,1]=o*(-0.36617527544)*x_ref[1]**(o-1)+(-0.28786191714)
        ref[4,1,0,0]=o*(0.718670448416)*x_ref[0]**(o-1)+(-0.836956284868)
        ref[4,1,0,1]=o*(0.694744974874)*x_ref[1]**(o-1)+(-0.176920245996)
        ref[4,1,1,0]=o*(-0.892867770142)*x_ref[0]**(o-1)+(-0.439240069099)
        ref[4,1,1,1]=o*(0.960956271989)*x_ref[1]**(o-1)+(-0.559541152716)
        ref[5,0,0,0]=o*(-0.159459484106)*x_ref[0]**(o-1)+(0.497366075466)
        ref[5,0,0,1]=o*(0.776343693655)*x_ref[1]**(o-1)+(0.326882397775)
        ref[5,0,1,0]=o*(-0.769197598992)*x_ref[0]**(o-1)+(-0.155931232816)
        ref[5,0,1,1]=o*(0.306889959757)*x_ref[1]**(o-1)+(0.283798117232)
        ref[5,1,0,0]=o*(0.329987736778)*x_ref[0]**(o-1)+(-0.181917315586)
        ref[5,1,0,1]=o*(0.896508353752)*x_ref[1]**(o-1)+(0.505276687831)
        ref[5,1,1,0]=o*(-0.805264678584)*x_ref[0]**(o-1)+(0.1541429191)
        ref[5,1,1,1]=o*(0.759370357364)*x_ref[1]**(o-1)+(-0.858941373648)
      else:
        arg[0,0,0]=(0.168268053227)*x[0]**o+(-0.693455720059)*x[0]+(-0.929660815724)*x[1]**o+(0.986095168154)*x[1]+(0.736239785757)*x[2]**o+(-0.852231596742)*x[2]
        arg[0,0,1]=(-0.246755690586)*x[0]**o+(0.374568513964)*x[0]+(-0.964930789849)*x[1]**o+(0.911595670675)*x[1]+(-0.450825843592)*x[2]**o+(0.109918389584)*x[2]
        arg[0,1,0]=(-0.733872890764)*x[0]**o+(-0.673737586895)*x[0]+(0.948528017502)*x[1]**o+(0.00135698010622)*x[1]+(0.960702320728)*x[2]**o+(-0.0223793346126)*x[2]
        arg[0,1,1]=(0.117470384547)*x[0]**o+(0.390065805504)*x[0]+(0.116939897886)*x[1]**o+(0.201756470627)*x[1]+(0.649311190776)*x[2]**o+(-0.388330674246)*x[2]
        arg[1,0,0]=(0.848074231014)*x[0]**o+(-0.431699971504)*x[0]+(0.956477578677)*x[1]**o+(0.522633753414)*x[1]+(0.147733403055)*x[2]**o+(0.136817362225)*x[2]
        arg[1,0,1]=(0.482934543775)*x[0]**o+(-0.358181242578)*x[0]+(-0.013088278343)*x[1]**o+(0.002654195003)*x[1]+(0.960898421715)*x[2]**o+(0.23166323571)*x[2]
        arg[1,1,0]=(-0.60469206115)*x[0]**o+(-0.449073005118)*x[0]+(-0.0774626329204)*x[1]**o+(-0.135772353437)*x[1]+(-0.796309060217)*x[2]**o+(-0.0601212417342)*x[2]
        arg[1,1,1]=(0.41742915222)*x[0]**o+(-0.907531578792)*x[0]+(-0.998018453394)*x[1]**o+(0.38863222527)*x[1]+(-0.941909949653)*x[2]**o+(-0.962025400733)*x[2]
        arg[2,0,0]=(0.677803680186)*x[0]**o+(0.493757303449)*x[0]+(-0.700353467324)*x[1]**o+(0.713489396377)*x[1]+(-0.147276750564)*x[2]**o+(-0.666815984705)*x[2]
        arg[2,0,1]=(-0.196166170445)*x[0]**o+(-0.776357160477)*x[0]+(0.531757851468)*x[1]**o+(-0.0951663105473)*x[1]+(0.296695659682)*x[2]**o+(0.132047740242)*x[2]
        arg[2,1,0]=(0.89703218788)*x[0]**o+(0.446461958293)*x[0]+(0.849781349832)*x[1]**o+(0.495003438762)*x[1]+(0.200866318394)*x[2]**o+(-0.239158244355)*x[2]
        arg[2,1,1]=(0.699816693)*x[0]**o+(-0.498016262468)*x[0]+(0.467212425781)*x[1]**o+(0.507210685133)*x[1]+(0.872000089805)*x[2]**o+(-0.608415132584)*x[2]
        arg[3,0,0]=(-0.858779999521)*x[0]**o+(-0.934307938564)*x[0]+(0.998531969194)*x[1]**o+(-0.10694369616)*x[1]+(0.565515051636)*x[2]**o+(-0.340328286843)*x[2]
        arg[3,0,1]=(-0.734447160975)*x[0]**o+(0.592969337009)*x[0]+(0.769648460523)*x[1]**o+(0.939994123398)*x[1]+(-0.14168879251)*x[2]**o+(-0.151602759825)*x[2]
        arg[3,1,0]=(-0.204447368694)*x[0]**o+(-0.149512701586)*x[0]+(0.496643987821)*x[1]**o+(0.137154021271)*x[1]+(-0.207451973465)*x[2]**o+(0.976289933313)*x[2]
        arg[3,1,1]=(-0.498939396392)*x[0]**o+(-0.388761371521)*x[0]+(0.918876234523)*x[1]**o+(0.326334103437)*x[1]+(0.135801853065)*x[2]**o+(-0.513268577694)*x[2]
        arg[4,0,0]=(0.383369953978)*x[0]**o+(0.262190952188)*x[0]+(0.226913840907)*x[1]**o+(0.625767074123)*x[1]+(0.0736409418752)*x[2]**o+(-0.681643359069)*x[2]
        arg[4,0,1]=(-0.00395633017219)*x[0]**o+(0.103598757494)*x[0]+(0.245388867438)*x[1]**o+(0.0199139065324)*x[1]+(-0.85935209669)*x[2]**o+(0.780770429677)*x[2]
        arg[4,1,0]=(0.93284113054)*x[0]**o+(0.192867707515)*x[0]+(0.354258046046)*x[1]**o+(0.0244899514488)*x[1]+(-0.00723308587137)*x[2]**o+(0.724287748378)*x[2]
        arg[4,1,1]=(-0.701870704251)*x[0]**o+(0.29146856048)*x[0]+(-0.677358067691)*x[1]**o+(-0.055827889309)*x[1]+(0.96248585097)*x[2]**o+(0.100526700803)*x[2]
        arg[5,0,0]=(-0.582058132348)*x[0]**o+(0.5354038569)*x[0]+(-0.608415656952)*x[1]**o+(0.700352801694)*x[1]+(-0.705438310252)*x[2]**o+(0.969824711925)*x[2]
        arg[5,0,1]=(-0.573326444971)*x[0]**o+(0.00490482707944)*x[0]+(0.300312254171)*x[1]**o+(-0.620154697788)*x[1]+(-0.0703788860867)*x[2]**o+(-0.608567609941)*x[2]
        arg[5,1,0]=(0.346782282755)*x[0]**o+(-0.022146949553)*x[0]+(0.548359292626)*x[1]**o+(0.314315074761)*x[1]+(0.164808336191)*x[2]**o+(-0.983018613943)*x[2]
        arg[5,1,1]=(-0.357126808896)*x[0]**o+(0.547191129837)*x[0]+(-0.0128153418859)*x[1]**o+(-0.199507147279)*x[1]+(-0.637546467191)*x[2]**o+(0.65056997574)*x[2]
        ref[0,0,0,0]=o*(0.168268053227)*x_ref[0]**(o-1)+(-0.693455720059)
        ref[0,0,0,1]=o*(-0.929660815724)*x_ref[1]**(o-1)+(0.986095168154)
        ref[0,0,0,2]=o*(0.736239785757)*x_ref[2]**(o-1)+(-0.852231596742)
        ref[0,0,1,0]=o*(-0.246755690586)*x_ref[0]**(o-1)+(0.374568513964)
        ref[0,0,1,1]=o*(-0.964930789849)*x_ref[1]**(o-1)+(0.911595670675)
        ref[0,0,1,2]=o*(-0.450825843592)*x_ref[2]**(o-1)+(0.109918389584)
        ref[0,1,0,0]=o*(-0.733872890764)*x_ref[0]**(o-1)+(-0.673737586895)
        ref[0,1,0,1]=o*(0.948528017502)*x_ref[1]**(o-1)+(0.00135698010622)
        ref[0,1,0,2]=o*(0.960702320728)*x_ref[2]**(o-1)+(-0.0223793346126)
        ref[0,1,1,0]=o*(0.117470384547)*x_ref[0]**(o-1)+(0.390065805504)
        ref[0,1,1,1]=o*(0.116939897886)*x_ref[1]**(o-1)+(0.201756470627)
        ref[0,1,1,2]=o*(0.649311190776)*x_ref[2]**(o-1)+(-0.388330674246)
        ref[1,0,0,0]=o*(0.848074231014)*x_ref[0]**(o-1)+(-0.431699971504)
        ref[1,0,0,1]=o*(0.956477578677)*x_ref[1]**(o-1)+(0.522633753414)
        ref[1,0,0,2]=o*(0.147733403055)*x_ref[2]**(o-1)+(0.136817362225)
        ref[1,0,1,0]=o*(0.482934543775)*x_ref[0]**(o-1)+(-0.358181242578)
        ref[1,0,1,1]=o*(-0.013088278343)*x_ref[1]**(o-1)+(0.002654195003)
        ref[1,0,1,2]=o*(0.960898421715)*x_ref[2]**(o-1)+(0.23166323571)
        ref[1,1,0,0]=o*(-0.60469206115)*x_ref[0]**(o-1)+(-0.449073005118)
        ref[1,1,0,1]=o*(-0.0774626329204)*x_ref[1]**(o-1)+(-0.135772353437)
        ref[1,1,0,2]=o*(-0.796309060217)*x_ref[2]**(o-1)+(-0.0601212417342)
        ref[1,1,1,0]=o*(0.41742915222)*x_ref[0]**(o-1)+(-0.907531578792)
        ref[1,1,1,1]=o*(-0.998018453394)*x_ref[1]**(o-1)+(0.38863222527)
        ref[1,1,1,2]=o*(-0.941909949653)*x_ref[2]**(o-1)+(-0.962025400733)
        ref[2,0,0,0]=o*(0.677803680186)*x_ref[0]**(o-1)+(0.493757303449)
        ref[2,0,0,1]=o*(-0.700353467324)*x_ref[1]**(o-1)+(0.713489396377)
        ref[2,0,0,2]=o*(-0.147276750564)*x_ref[2]**(o-1)+(-0.666815984705)
        ref[2,0,1,0]=o*(-0.196166170445)*x_ref[0]**(o-1)+(-0.776357160477)
        ref[2,0,1,1]=o*(0.531757851468)*x_ref[1]**(o-1)+(-0.0951663105473)
        ref[2,0,1,2]=o*(0.296695659682)*x_ref[2]**(o-1)+(0.132047740242)
        ref[2,1,0,0]=o*(0.89703218788)*x_ref[0]**(o-1)+(0.446461958293)
        ref[2,1,0,1]=o*(0.849781349832)*x_ref[1]**(o-1)+(0.495003438762)
        ref[2,1,0,2]=o*(0.200866318394)*x_ref[2]**(o-1)+(-0.239158244355)
        ref[2,1,1,0]=o*(0.699816693)*x_ref[0]**(o-1)+(-0.498016262468)
        ref[2,1,1,1]=o*(0.467212425781)*x_ref[1]**(o-1)+(0.507210685133)
        ref[2,1,1,2]=o*(0.872000089805)*x_ref[2]**(o-1)+(-0.608415132584)
        ref[3,0,0,0]=o*(-0.858779999521)*x_ref[0]**(o-1)+(-0.934307938564)
        ref[3,0,0,1]=o*(0.998531969194)*x_ref[1]**(o-1)+(-0.10694369616)
        ref[3,0,0,2]=o*(0.565515051636)*x_ref[2]**(o-1)+(-0.340328286843)
        ref[3,0,1,0]=o*(-0.734447160975)*x_ref[0]**(o-1)+(0.592969337009)
        ref[3,0,1,1]=o*(0.769648460523)*x_ref[1]**(o-1)+(0.939994123398)
        ref[3,0,1,2]=o*(-0.14168879251)*x_ref[2]**(o-1)+(-0.151602759825)
        ref[3,1,0,0]=o*(-0.204447368694)*x_ref[0]**(o-1)+(-0.149512701586)
        ref[3,1,0,1]=o*(0.496643987821)*x_ref[1]**(o-1)+(0.137154021271)
        ref[3,1,0,2]=o*(-0.207451973465)*x_ref[2]**(o-1)+(0.976289933313)
        ref[3,1,1,0]=o*(-0.498939396392)*x_ref[0]**(o-1)+(-0.388761371521)
        ref[3,1,1,1]=o*(0.918876234523)*x_ref[1]**(o-1)+(0.326334103437)
        ref[3,1,1,2]=o*(0.135801853065)*x_ref[2]**(o-1)+(-0.513268577694)
        ref[4,0,0,0]=o*(0.383369953978)*x_ref[0]**(o-1)+(0.262190952188)
        ref[4,0,0,1]=o*(0.226913840907)*x_ref[1]**(o-1)+(0.625767074123)
        ref[4,0,0,2]=o*(0.0736409418752)*x_ref[2]**(o-1)+(-0.681643359069)
        ref[4,0,1,0]=o*(-0.00395633017219)*x_ref[0]**(o-1)+(0.103598757494)
        ref[4,0,1,1]=o*(0.245388867438)*x_ref[1]**(o-1)+(0.0199139065324)
        ref[4,0,1,2]=o*(-0.85935209669)*x_ref[2]**(o-1)+(0.780770429677)
        ref[4,1,0,0]=o*(0.93284113054)*x_ref[0]**(o-1)+(0.192867707515)
        ref[4,1,0,1]=o*(0.354258046046)*x_ref[1]**(o-1)+(0.0244899514488)
        ref[4,1,0,2]=o*(-0.00723308587137)*x_ref[2]**(o-1)+(0.724287748378)
        ref[4,1,1,0]=o*(-0.701870704251)*x_ref[0]**(o-1)+(0.29146856048)
        ref[4,1,1,1]=o*(-0.677358067691)*x_ref[1]**(o-1)+(-0.055827889309)
        ref[4,1,1,2]=o*(0.96248585097)*x_ref[2]**(o-1)+(0.100526700803)
        ref[5,0,0,0]=o*(-0.582058132348)*x_ref[0]**(o-1)+(0.5354038569)
        ref[5,0,0,1]=o*(-0.608415656952)*x_ref[1]**(o-1)+(0.700352801694)
        ref[5,0,0,2]=o*(-0.705438310252)*x_ref[2]**(o-1)+(0.969824711925)
        ref[5,0,1,0]=o*(-0.573326444971)*x_ref[0]**(o-1)+(0.00490482707944)
        ref[5,0,1,1]=o*(0.300312254171)*x_ref[1]**(o-1)+(-0.620154697788)
        ref[5,0,1,2]=o*(-0.0703788860867)*x_ref[2]**(o-1)+(-0.608567609941)
        ref[5,1,0,0]=o*(0.346782282755)*x_ref[0]**(o-1)+(-0.022146949553)
        ref[5,1,0,1]=o*(0.548359292626)*x_ref[1]**(o-1)+(0.314315074761)
        ref[5,1,0,2]=o*(0.164808336191)*x_ref[2]**(o-1)+(-0.983018613943)
        ref[5,1,1,0]=o*(-0.357126808896)*x_ref[0]**(o-1)+(0.547191129837)
        ref[5,1,1,1]=o*(-0.0128153418859)*x_ref[1]**(o-1)+(-0.199507147279)
        ref[5,1,1,2]=o*(-0.637546467191)*x_ref[2]**(o-1)+(0.65056997574)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        arg=(0.694260485776)*x[0]+(1.46246375886)*x[1]
        ref[0]=(0.694260485776)
        ref[1]=(1.46246375886)
      else:
        arg=(-1.10912081576)*x[0]+(1.19790363484)*x[1]+(0.555862453192)*x[2]
        ref[0]=(-1.10912081576)
        ref[1]=(1.19790363484)
        ref[2]=(0.555862453192)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        arg[0]=(-0.0963683715208)*x[0]+(-0.985421300426)*x[1]
        arg[1]=(0.50107481561)*x[0]+(0.296191075154)*x[1]
        ref[0,0]=(-0.0963683715208)
        ref[0,1]=(-0.985421300426)
        ref[1,0]=(0.50107481561)
        ref[1,1]=(0.296191075154)
      else:
        arg[0]=(0.790729361248)*x[0]+(0.3673431791)*x[1]+(0.031915702612)*x[2]
        arg[1]=(-0.218629391175)*x[0]+(-0.0619831001578)*x[1]+(-1.46460054046)*x[2]
        ref[0,0]=(0.790729361248)
        ref[0,1]=(0.3673431791)
        ref[0,2]=(0.031915702612)
        ref[1,0]=(-0.218629391175)
        ref[1,1]=(-0.0619831001578)
        ref[1,2]=(-1.46460054046)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        arg[0,0]=(0.102266041928)*x[0]+(0.962985129019)*x[1]
        arg[0,1]=(1.22474578409)*x[0]+(-0.211640772922)*x[1]
        arg[0,2]=(-0.51306749275)*x[0]+(0.652502950912)*x[1]
        arg[0,3]=(1.89516926008)*x[0]+(0.317996805009)*x[1]
        arg[0,4]=(0.562531430083)*x[0]+(-0.194650166716)*x[1]
        arg[1,0]=(0.344353002434)*x[0]+(-0.830671914713)*x[1]
        arg[1,1]=(0.984363231775)*x[0]+(-0.0773767796506)*x[1]
        arg[1,2]=(-0.893978692143)*x[0]+(1.43362006873)*x[1]
        arg[1,3]=(0.603459290036)*x[0]+(-0.527471281229)*x[1]
        arg[1,4]=(-0.768879816113)*x[0]+(0.670739267079)*x[1]
        arg[2,0]=(0.466692398942)*x[0]+(-0.315362658981)*x[1]
        arg[2,1]=(1.30065290708)*x[0]+(-0.202369755569)*x[1]
        arg[2,2]=(-0.114571246331)*x[0]+(1.30250121342)*x[1]
        arg[2,3]=(-0.243608494456)*x[0]+(-0.103398411275)*x[1]
        arg[2,4]=(-0.262568543724)*x[0]+(-0.23979204654)*x[1]
        arg[3,0]=(0.0334727960327)*x[0]+(-0.24547366383)*x[1]
        arg[3,1]=(0.829837477348)*x[0]+(-0.416646135702)*x[1]
        arg[3,2]=(1.43081322579)*x[0]+(0.574724874607)*x[1]
        arg[3,3]=(1.16303985686)*x[0]+(-0.915348714324)*x[1]
        arg[3,4]=(0.773764690591)*x[0]+(0.28049189996)*x[1]
        ref[0,0,0]=(0.102266041928)
        ref[0,0,1]=(0.962985129019)
        ref[0,1,0]=(1.22474578409)
        ref[0,1,1]=(-0.211640772922)
        ref[0,2,0]=(-0.51306749275)
        ref[0,2,1]=(0.652502950912)
        ref[0,3,0]=(1.89516926008)
        ref[0,3,1]=(0.317996805009)
        ref[0,4,0]=(0.562531430083)
        ref[0,4,1]=(-0.194650166716)
        ref[1,0,0]=(0.344353002434)
        ref[1,0,1]=(-0.830671914713)
        ref[1,1,0]=(0.984363231775)
        ref[1,1,1]=(-0.0773767796506)
        ref[1,2,0]=(-0.893978692143)
        ref[1,2,1]=(1.43362006873)
        ref[1,3,0]=(0.603459290036)
        ref[1,3,1]=(-0.527471281229)
        ref[1,4,0]=(-0.768879816113)
        ref[1,4,1]=(0.670739267079)
        ref[2,0,0]=(0.466692398942)
        ref[2,0,1]=(-0.315362658981)
        ref[2,1,0]=(1.30065290708)
        ref[2,1,1]=(-0.202369755569)
        ref[2,2,0]=(-0.114571246331)
        ref[2,2,1]=(1.30250121342)
        ref[2,3,0]=(-0.243608494456)
        ref[2,3,1]=(-0.103398411275)
        ref[2,4,0]=(-0.262568543724)
        ref[2,4,1]=(-0.23979204654)
        ref[3,0,0]=(0.0334727960327)
        ref[3,0,1]=(-0.24547366383)
        ref[3,1,0]=(0.829837477348)
        ref[3,1,1]=(-0.416646135702)
        ref[3,2,0]=(1.43081322579)
        ref[3,2,1]=(0.574724874607)
        ref[3,3,0]=(1.16303985686)
        ref[3,3,1]=(-0.915348714324)
        ref[3,4,0]=(0.773764690591)
        ref[3,4,1]=(0.28049189996)
      else:
        arg[0,0]=(-0.998409457516)*x[0]+(0.374200474533)*x[1]+(-0.397603453862)*x[2]
        arg[0,1]=(-1.48600938216)*x[0]+(1.46358462866)*x[1]+(-0.393381462291)*x[2]
        arg[0,2]=(1.08201727329)*x[0]+(0.065185376372)*x[1]+(-1.32483264357)*x[2]
        arg[0,3]=(-0.518441162)*x[0]+(0.364373161676)*x[1]+(-1.25875574919)*x[2]
        arg[0,4]=(-0.836980279478)*x[0]+(1.21655914685)*x[1]+(0.1586084291)*x[2]
        arg[1,0]=(0.760774732939)*x[0]+(0.515414129191)*x[1]+(-1.50192024303)*x[2]
        arg[1,1]=(-0.653360330499)*x[0]+(1.71417096347)*x[1]+(-0.169129173291)*x[2]
        arg[1,2]=(1.07221333767)*x[0]+(-1.07638348405)*x[1]+(1.13393461135)*x[2]
        arg[1,3]=(0.847567825055)*x[0]+(-0.0298335468796)*x[1]+(0.45122717832)*x[2]
        arg[1,4]=(-0.108027217492)*x[0]+(-1.12654142913)*x[1]+(-0.781718943065)*x[2]
        arg[2,0]=(0.408863322164)*x[0]+(0.100914804776)*x[1]+(-0.471567638444)*x[2]
        arg[2,1]=(-1.42194256762)*x[0]+(-0.348217894465)*x[1]+(-0.830561377367)*x[2]
        arg[2,2]=(1.36876795155)*x[0]+(0.125252389466)*x[1]+(0.00641454191902)*x[2]
        arg[2,3]=(0.135243193372)*x[0]+(-1.04394510102)*x[1]+(0.0223029076973)*x[2]
        arg[2,4]=(-0.969785158394)*x[0]+(-0.48178611106)*x[1]+(-0.0556576599006)*x[2]
        arg[3,0]=(1.39484073703)*x[0]+(-1.0132109886)*x[1]+(0.0205156989927)*x[2]
        arg[3,1]=(-0.92783313898)*x[0]+(-1.27904129731)*x[1]+(-0.817768402689)*x[2]
        arg[3,2]=(1.21718392423)*x[0]+(-0.984091647405)*x[1]+(0.458009888947)*x[2]
        arg[3,3]=(-0.812990754761)*x[0]+(-0.104941245044)*x[1]+(-0.996531826869)*x[2]
        arg[3,4]=(-0.28581988131)*x[0]+(-1.24321114539)*x[1]+(0.408464222517)*x[2]
        ref[0,0,0]=(-0.998409457516)
        ref[0,0,1]=(0.374200474533)
        ref[0,0,2]=(-0.397603453862)
        ref[0,1,0]=(-1.48600938216)
        ref[0,1,1]=(1.46358462866)
        ref[0,1,2]=(-0.393381462291)
        ref[0,2,0]=(1.08201727329)
        ref[0,2,1]=(0.065185376372)
        ref[0,2,2]=(-1.32483264357)
        ref[0,3,0]=(-0.518441162)
        ref[0,3,1]=(0.364373161676)
        ref[0,3,2]=(-1.25875574919)
        ref[0,4,0]=(-0.836980279478)
        ref[0,4,1]=(1.21655914685)
        ref[0,4,2]=(0.1586084291)
        ref[1,0,0]=(0.760774732939)
        ref[1,0,1]=(0.515414129191)
        ref[1,0,2]=(-1.50192024303)
        ref[1,1,0]=(-0.653360330499)
        ref[1,1,1]=(1.71417096347)
        ref[1,1,2]=(-0.169129173291)
        ref[1,2,0]=(1.07221333767)
        ref[1,2,1]=(-1.07638348405)
        ref[1,2,2]=(1.13393461135)
        ref[1,3,0]=(0.847567825055)
        ref[1,3,1]=(-0.0298335468796)
        ref[1,3,2]=(0.45122717832)
        ref[1,4,0]=(-0.108027217492)
        ref[1,4,1]=(-1.12654142913)
        ref[1,4,2]=(-0.781718943065)
        ref[2,0,0]=(0.408863322164)
        ref[2,0,1]=(0.100914804776)
        ref[2,0,2]=(-0.471567638444)
        ref[2,1,0]=(-1.42194256762)
        ref[2,1,1]=(-0.348217894465)
        ref[2,1,2]=(-0.830561377367)
        ref[2,2,0]=(1.36876795155)
        ref[2,2,1]=(0.125252389466)
        ref[2,2,2]=(0.00641454191902)
        ref[2,3,0]=(0.135243193372)
        ref[2,3,1]=(-1.04394510102)
        ref[2,3,2]=(0.0223029076973)
        ref[2,4,0]=(-0.969785158394)
        ref[2,4,1]=(-0.48178611106)
        ref[2,4,2]=(-0.0556576599006)
        ref[3,0,0]=(1.39484073703)
        ref[3,0,1]=(-1.0132109886)
        ref[3,0,2]=(0.0205156989927)
        ref[3,1,0]=(-0.92783313898)
        ref[3,1,1]=(-1.27904129731)
        ref[3,1,2]=(-0.817768402689)
        ref[3,2,0]=(1.21718392423)
        ref[3,2,1]=(-0.984091647405)
        ref[3,2,2]=(0.458009888947)
        ref[3,3,0]=(-0.812990754761)
        ref[3,3,1]=(-0.104941245044)
        ref[3,3,2]=(-0.996531826869)
        ref[3,4,0]=(-0.28581988131)
        ref[3,4,1]=(-1.24321114539)
        ref[3,4,2]=(0.408464222517)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromData_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Data on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        arg[0,0,0]=(0.39712204981)*x[0]+(-1.36315938849)*x[1]
        arg[0,0,1]=(0.654450268666)*x[0]+(-0.198258834351)*x[1]
        arg[0,1,0]=(0.21357757124)*x[0]+(0.193878132191)*x[1]
        arg[0,1,1]=(0.0762258436603)*x[0]+(-0.33284111684)*x[1]
        arg[1,0,0]=(-0.264232939297)*x[0]+(-0.726336076701)*x[1]
        arg[1,0,1]=(-0.179928817534)*x[0]+(-0.723247805844)*x[1]
        arg[1,1,0]=(0.923289681593)*x[0]+(0.986763135255)*x[1]
        arg[1,1,1]=(0.065387254507)*x[0]+(-0.710965008545)*x[1]
        arg[2,0,0]=(0.759853961917)*x[0]+(0.24486573839)*x[1]
        arg[2,0,1]=(-0.318336679378)*x[0]+(0.39328274922)*x[1]
        arg[2,1,0]=(-1.562818948)*x[0]+(-0.891340974738)*x[1]
        arg[2,1,1]=(0.0508006116584)*x[0]+(1.17654134987)*x[1]
        arg[3,0,0]=(-0.155883472458)*x[0]+(0.248809866836)*x[1]
        arg[3,0,1]=(0.287794710222)*x[0]+(-1.72525392296)*x[1]
        arg[3,1,0]=(0.00665202042795)*x[0]+(-0.0996395796968)*x[1]
        arg[3,1,1]=(-0.19809021298)*x[0]+(0.487549616652)*x[1]
        arg[4,0,0]=(0.764163773078)*x[0]+(-0.898694486894)*x[1]
        arg[4,0,1]=(-0.213042355119)*x[0]+(0.708925705544)*x[1]
        arg[4,1,0]=(1.55505564031)*x[0]+(-0.545746649289)*x[1]
        arg[4,1,1]=(-1.31623592165)*x[0]+(0.948772953354)*x[1]
        arg[5,0,0]=(0.221103671977)*x[0]+(0.866067107464)*x[1]
        arg[5,0,1]=(-0.0979530612779)*x[0]+(-0.371623102578)*x[1]
        arg[5,1,0]=(-0.348963169972)*x[0]+(-0.692055450872)*x[1]
        arg[5,1,1]=(-0.584053243695)*x[0]+(-0.487768032842)*x[1]
        ref[0,0,0,0]=(0.39712204981)
        ref[0,0,0,1]=(-1.36315938849)
        ref[0,0,1,0]=(0.654450268666)
        ref[0,0,1,1]=(-0.198258834351)
        ref[0,1,0,0]=(0.21357757124)
        ref[0,1,0,1]=(0.193878132191)
        ref[0,1,1,0]=(0.0762258436603)
        ref[0,1,1,1]=(-0.33284111684)
        ref[1,0,0,0]=(-0.264232939297)
        ref[1,0,0,1]=(-0.726336076701)
        ref[1,0,1,0]=(-0.179928817534)
        ref[1,0,1,1]=(-0.723247805844)
        ref[1,1,0,0]=(0.923289681593)
        ref[1,1,0,1]=(0.986763135255)
        ref[1,1,1,0]=(0.065387254507)
        ref[1,1,1,1]=(-0.710965008545)
        ref[2,0,0,0]=(0.759853961917)
        ref[2,0,0,1]=(0.24486573839)
        ref[2,0,1,0]=(-0.318336679378)
        ref[2,0,1,1]=(0.39328274922)
        ref[2,1,0,0]=(-1.562818948)
        ref[2,1,0,1]=(-0.891340974738)
        ref[2,1,1,0]=(0.0508006116584)
        ref[2,1,1,1]=(1.17654134987)
        ref[3,0,0,0]=(-0.155883472458)
        ref[3,0,0,1]=(0.248809866836)
        ref[3,0,1,0]=(0.287794710222)
        ref[3,0,1,1]=(-1.72525392296)
        ref[3,1,0,0]=(0.00665202042795)
        ref[3,1,0,1]=(-0.0996395796968)
        ref[3,1,1,0]=(-0.19809021298)
        ref[3,1,1,1]=(0.487549616652)
        ref[4,0,0,0]=(0.764163773078)
        ref[4,0,0,1]=(-0.898694486894)
        ref[4,0,1,0]=(-0.213042355119)
        ref[4,0,1,1]=(0.708925705544)
        ref[4,1,0,0]=(1.55505564031)
        ref[4,1,0,1]=(-0.545746649289)
        ref[4,1,1,0]=(-1.31623592165)
        ref[4,1,1,1]=(0.948772953354)
        ref[5,0,0,0]=(0.221103671977)
        ref[5,0,0,1]=(0.866067107464)
        ref[5,0,1,0]=(-0.0979530612779)
        ref[5,0,1,1]=(-0.371623102578)
        ref[5,1,0,0]=(-0.348963169972)
        ref[5,1,0,1]=(-0.692055450872)
        ref[5,1,1,0]=(-0.584053243695)
        ref[5,1,1,1]=(-0.487768032842)
      else:
        arg[0,0,0]=(-1.45023987007)*x[0]+(0.138479134523)*x[1]+(1.46404607112)*x[2]
        arg[0,0,1]=(-0.647908832568)*x[0]+(-0.503758830859)*x[1]+(1.23196203665)*x[2]
        arg[0,1,0]=(-0.0108286161243)*x[0]+(0.565615928686)*x[1]+(-0.357789821636)*x[2]
        arg[0,1,1]=(0.648224572901)*x[0]+(0.775857442933)*x[1]+(0.960991462312)*x[2]
        arg[1,0,0]=(0.340590670624)*x[0]+(0.0357759349963)*x[1]+(0.358139256621)*x[2]
        arg[1,0,1]=(0.569789735109)*x[0]+(1.40678949618)*x[1]+(-0.965577726422)*x[2]
        arg[1,1,0]=(-0.758717082212)*x[0]+(0.612968081377)*x[1]+(-0.417988159948)*x[2]
        arg[1,1,1]=(0.969867032567)*x[0]+(-0.0700234825891)*x[1]+(1.53879850558)*x[2]
        arg[2,0,0]=(-1.02952648125)*x[0]+(0.108642437375)*x[1]+(0.251073184196)*x[2]
        arg[2,0,1]=(0.794766888909)*x[0]+(1.50591346365)*x[1]+(-0.36870578891)*x[2]
        arg[2,1,0]=(-0.534487055503)*x[0]+(-1.09061679233)*x[1]+(0.799342633685)*x[2]
        arg[2,1,1]=(0.0435889213805)*x[0]+(-0.209888628166)*x[1]+(1.34633215915)*x[2]
        arg[3,0,0]=(-0.0344682106376)*x[0]+(-0.92386569455)*x[1]+(-0.551250384619)*x[2]
        arg[3,0,1]=(-0.168599962689)*x[0]+(0.204634495314)*x[1]+(-0.65426520271)*x[2]
        arg[3,1,0]=(-1.61759210628)*x[0]+(-0.5922211067)*x[1]+(-0.139092780207)*x[2]
        arg[3,1,1]=(-0.13862300062)*x[0]+(-1.45951050222)*x[1]+(0.300904423579)*x[2]
        arg[4,0,0]=(0.629590770742)*x[0]+(-0.217150209985)*x[1]+(-0.140384227583)*x[2]
        arg[4,0,1]=(-0.0461635416119)*x[0]+(0.525692990183)*x[1]+(-1.89728167146)*x[2]
        arg[4,1,0]=(-0.130297059668)*x[0]+(-0.138816250007)*x[1]+(1.26805054232)*x[2]
        arg[4,1,1]=(0.742488751566)*x[0]+(0.659272799907)*x[1]+(-0.370877917078)*x[2]
        arg[5,0,0]=(-0.521350561164)*x[0]+(-0.213669151076)*x[1]+(0.00949381597317)*x[2]
        arg[5,0,1]=(-0.951547526648)*x[0]+(-0.388340895795)*x[1]+(0.741997603334)*x[2]
        arg[5,1,0]=(-0.332922940005)*x[0]+(1.74852940259)*x[1]+(-0.484189519128)*x[2]
        arg[5,1,1]=(0.418660109098)*x[0]+(-0.690728767024)*x[1]+(-0.675947375912)*x[2]
        ref[0,0,0,0]=(-1.45023987007)
        ref[0,0,0,1]=(0.138479134523)
        ref[0,0,0,2]=(1.46404607112)
        ref[0,0,1,0]=(-0.647908832568)
        ref[0,0,1,1]=(-0.503758830859)
        ref[0,0,1,2]=(1.23196203665)
        ref[0,1,0,0]=(-0.0108286161243)
        ref[0,1,0,1]=(0.565615928686)
        ref[0,1,0,2]=(-0.357789821636)
        ref[0,1,1,0]=(0.648224572901)
        ref[0,1,1,1]=(0.775857442933)
        ref[0,1,1,2]=(0.960991462312)
        ref[1,0,0,0]=(0.340590670624)
        ref[1,0,0,1]=(0.0357759349963)
        ref[1,0,0,2]=(0.358139256621)
        ref[1,0,1,0]=(0.569789735109)
        ref[1,0,1,1]=(1.40678949618)
        ref[1,0,1,2]=(-0.965577726422)
        ref[1,1,0,0]=(-0.758717082212)
        ref[1,1,0,1]=(0.612968081377)
        ref[1,1,0,2]=(-0.417988159948)
        ref[1,1,1,0]=(0.969867032567)
        ref[1,1,1,1]=(-0.0700234825891)
        ref[1,1,1,2]=(1.53879850558)
        ref[2,0,0,0]=(-1.02952648125)
        ref[2,0,0,1]=(0.108642437375)
        ref[2,0,0,2]=(0.251073184196)
        ref[2,0,1,0]=(0.794766888909)
        ref[2,0,1,1]=(1.50591346365)
        ref[2,0,1,2]=(-0.36870578891)
        ref[2,1,0,0]=(-0.534487055503)
        ref[2,1,0,1]=(-1.09061679233)
        ref[2,1,0,2]=(0.799342633685)
        ref[2,1,1,0]=(0.0435889213805)
        ref[2,1,1,1]=(-0.209888628166)
        ref[2,1,1,2]=(1.34633215915)
        ref[3,0,0,0]=(-0.0344682106376)
        ref[3,0,0,1]=(-0.92386569455)
        ref[3,0,0,2]=(-0.551250384619)
        ref[3,0,1,0]=(-0.168599962689)
        ref[3,0,1,1]=(0.204634495314)
        ref[3,0,1,2]=(-0.65426520271)
        ref[3,1,0,0]=(-1.61759210628)
        ref[3,1,0,1]=(-0.5922211067)
        ref[3,1,0,2]=(-0.139092780207)
        ref[3,1,1,0]=(-0.13862300062)
        ref[3,1,1,1]=(-1.45951050222)
        ref[3,1,1,2]=(0.300904423579)
        ref[4,0,0,0]=(0.629590770742)
        ref[4,0,0,1]=(-0.217150209985)
        ref[4,0,0,2]=(-0.140384227583)
        ref[4,0,1,0]=(-0.0461635416119)
        ref[4,0,1,1]=(0.525692990183)
        ref[4,0,1,2]=(-1.89728167146)
        ref[4,1,0,0]=(-0.130297059668)
        ref[4,1,0,1]=(-0.138816250007)
        ref[4,1,0,2]=(1.26805054232)
        ref[4,1,1,0]=(0.742488751566)
        ref[4,1,1,1]=(0.659272799907)
        ref[4,1,1,2]=(-0.370877917078)
        ref[5,0,0,0]=(-0.521350561164)
        ref[5,0,0,1]=(-0.213669151076)
        ref[5,0,0,2]=(0.00949381597317)
        ref[5,0,1,0]=(-0.951547526648)
        ref[5,0,1,1]=(-0.388340895795)
        ref[5,0,1,2]=(0.741997603334)
        ref[5,1,0,0]=(-0.332922940005)
        ref[5,1,0,1]=(1.74852940259)
        ref[5,1,0,2]=(-0.484189519128)
        ref[5,1,1,0]=(0.418660109098)
        ref[5,1,1,1]=(-0.690728767024)
        ref[5,1,1,2]=(-0.675947375912)
      res=grad(arg,where=w_ref)
      self.failUnless(isinstance(res,Data),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(res-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(-0.149491618448)*x[0]**o+(-0.419584280113)*x[0]+(-0.0503569168892)*x[1]**o+(-0.490263902194)*x[1]
        ref[0]=o*(-0.149491618448)*x_ref[0]**(o-1)+(-0.419584280113)
        ref[1]=o*(-0.0503569168892)*x_ref[1]**(o-1)+(-0.490263902194)
      else:
        s=(-0.757365066356)*x[0]**o+(-0.051930048541)*x[0]+(0.384778052543)*x[1]**o+(-0.305544758353)*x[1]+(-0.462618121798)*x[2]**o+(-0.424504978394)*x[2]
        ref[0]=o*(-0.757365066356)*x_ref[0]**(o-1)+(-0.051930048541)
        ref[1]=o*(0.384778052543)*x_ref[1]**(o-1)+(-0.305544758353)
        ref[2]=o*(-0.462618121798)*x_ref[2]**(o-1)+(-0.424504978394)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-0.923338270579)*x[0]**o+(0.803299589693)*x[0]+(-0.0850750563669)*x[1]**o+(0.965911232881)*x[1]
        s[1]=(-0.183491365698)*x[0]**o+(-0.842618551859)*x[0]+(0.712774298035)*x[1]**o+(-0.104669018361)*x[1]
        ref[0,0]=o*(-0.923338270579)*x_ref[0]**(o-1)+(0.803299589693)
        ref[0,1]=o*(-0.0850750563669)*x_ref[1]**(o-1)+(0.965911232881)
        ref[1,0]=o*(-0.183491365698)*x_ref[0]**(o-1)+(-0.842618551859)
        ref[1,1]=o*(0.712774298035)*x_ref[1]**(o-1)+(-0.104669018361)
      else:
        s[0]=(0.522068862618)*x[0]**o+(-0.928491651715)*x[0]+(-0.056593136934)*x[1]**o+(-0.00345895910273)*x[1]+(-0.313948793745)*x[2]**o+(0.555562844396)*x[2]
        s[1]=(0.0381288968852)*x[0]**o+(-0.226585510125)*x[0]+(-0.483387509698)*x[1]**o+(-0.0276908054388)*x[1]+(-0.535521100811)*x[2]**o+(0.0628178579102)*x[2]
        ref[0,0]=o*(0.522068862618)*x_ref[0]**(o-1)+(-0.928491651715)
        ref[0,1]=o*(-0.056593136934)*x_ref[1]**(o-1)+(-0.00345895910273)
        ref[0,2]=o*(-0.313948793745)*x_ref[2]**(o-1)+(0.555562844396)
        ref[1,0]=o*(0.0381288968852)*x_ref[0]**(o-1)+(-0.226585510125)
        ref[1,1]=o*(-0.483387509698)*x_ref[1]**(o-1)+(-0.0276908054388)
        ref[1,2]=o*(-0.535521100811)*x_ref[2]**(o-1)+(0.0628178579102)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.0438013069888)*x[0]**o+(-0.962692066069)*x[0]+(0.398086110381)*x[1]**o+(0.943207722394)*x[1]
        s[0,1]=(-0.834074575881)*x[0]**o+(0.984008650691)*x[0]+(-0.16037316175)*x[1]**o+(0.377982608876)*x[1]
        s[0,2]=(-0.245264047174)*x[0]**o+(-0.541684401688)*x[0]+(0.826167130517)*x[1]**o+(0.30004870121)*x[1]
        s[0,3]=(0.126658708414)*x[0]**o+(0.647586365584)*x[0]+(0.258184629361)*x[1]**o+(-0.808198823815)*x[1]
        s[0,4]=(-0.0303747201021)*x[0]**o+(-0.095123002442)*x[0]+(-0.033747901785)*x[1]**o+(-0.0503016700716)*x[1]
        s[1,0]=(0.680161896488)*x[0]**o+(0.106001120727)*x[0]+(-0.983896702986)*x[1]**o+(0.298572049969)*x[1]
        s[1,1]=(-0.215100953009)*x[0]**o+(0.778768869339)*x[0]+(0.887004074512)*x[1]**o+(0.441037801242)*x[1]
        s[1,2]=(-0.892563680898)*x[0]**o+(0.087087180763)*x[0]+(0.16490400964)*x[1]**o+(0.641654994831)*x[1]
        s[1,3]=(0.735567594275)*x[0]**o+(0.143078234647)*x[0]+(-0.741664410771)*x[1]**o+(-0.37591452739)*x[1]
        s[1,4]=(-0.0739884625591)*x[0]**o+(0.745076950828)*x[0]+(0.432379987995)*x[1]**o+(-0.0687199383234)*x[1]
        s[2,0]=(-0.885674457439)*x[0]**o+(-0.456184815781)*x[0]+(0.994806374374)*x[1]**o+(-0.31107028169)*x[1]
        s[2,1]=(0.987856338645)*x[0]**o+(-0.568662820963)*x[0]+(-0.742199948211)*x[1]**o+(0.658035428735)*x[1]
        s[2,2]=(-0.17580106245)*x[0]**o+(-0.589665223227)*x[0]+(0.580399510219)*x[1]**o+(-0.155064144488)*x[1]
        s[2,3]=(-0.913915914987)*x[0]**o+(0.3569536228)*x[0]+(0.23235960166)*x[1]**o+(-0.847113665947)*x[1]
        s[2,4]=(0.0909806665742)*x[0]**o+(-0.643246933435)*x[0]+(-0.480053101714)*x[1]**o+(0.336898095124)*x[1]
        s[3,0]=(-0.944997214199)*x[0]**o+(0.0242583099745)*x[0]+(-0.0537207940075)*x[1]**o+(-0.985424066301)*x[1]
        s[3,1]=(0.685233610656)*x[0]**o+(0.869977880645)*x[0]+(0.28306562014)*x[1]**o+(-0.144951426405)*x[1]
        s[3,2]=(-0.0432942460834)*x[0]**o+(0.706443143255)*x[0]+(-0.880454998397)*x[1]**o+(0.612846993665)*x[1]
        s[3,3]=(0.79137204642)*x[0]**o+(-0.534256675007)*x[0]+(-0.323548658904)*x[1]**o+(0.667614029523)*x[1]
        s[3,4]=(0.0642269065087)*x[0]**o+(0.299466531576)*x[0]+(-0.563060543682)*x[1]**o+(-0.820583826087)*x[1]
        ref[0,0,0]=o*(-0.0438013069888)*x_ref[0]**(o-1)+(-0.962692066069)
        ref[0,0,1]=o*(0.398086110381)*x_ref[1]**(o-1)+(0.943207722394)
        ref[0,1,0]=o*(-0.834074575881)*x_ref[0]**(o-1)+(0.984008650691)
        ref[0,1,1]=o*(-0.16037316175)*x_ref[1]**(o-1)+(0.377982608876)
        ref[0,2,0]=o*(-0.245264047174)*x_ref[0]**(o-1)+(-0.541684401688)
        ref[0,2,1]=o*(0.826167130517)*x_ref[1]**(o-1)+(0.30004870121)
        ref[0,3,0]=o*(0.126658708414)*x_ref[0]**(o-1)+(0.647586365584)
        ref[0,3,1]=o*(0.258184629361)*x_ref[1]**(o-1)+(-0.808198823815)
        ref[0,4,0]=o*(-0.0303747201021)*x_ref[0]**(o-1)+(-0.095123002442)
        ref[0,4,1]=o*(-0.033747901785)*x_ref[1]**(o-1)+(-0.0503016700716)
        ref[1,0,0]=o*(0.680161896488)*x_ref[0]**(o-1)+(0.106001120727)
        ref[1,0,1]=o*(-0.983896702986)*x_ref[1]**(o-1)+(0.298572049969)
        ref[1,1,0]=o*(-0.215100953009)*x_ref[0]**(o-1)+(0.778768869339)
        ref[1,1,1]=o*(0.887004074512)*x_ref[1]**(o-1)+(0.441037801242)
        ref[1,2,0]=o*(-0.892563680898)*x_ref[0]**(o-1)+(0.087087180763)
        ref[1,2,1]=o*(0.16490400964)*x_ref[1]**(o-1)+(0.641654994831)
        ref[1,3,0]=o*(0.735567594275)*x_ref[0]**(o-1)+(0.143078234647)
        ref[1,3,1]=o*(-0.741664410771)*x_ref[1]**(o-1)+(-0.37591452739)
        ref[1,4,0]=o*(-0.0739884625591)*x_ref[0]**(o-1)+(0.745076950828)
        ref[1,4,1]=o*(0.432379987995)*x_ref[1]**(o-1)+(-0.0687199383234)
        ref[2,0,0]=o*(-0.885674457439)*x_ref[0]**(o-1)+(-0.456184815781)
        ref[2,0,1]=o*(0.994806374374)*x_ref[1]**(o-1)+(-0.31107028169)
        ref[2,1,0]=o*(0.987856338645)*x_ref[0]**(o-1)+(-0.568662820963)
        ref[2,1,1]=o*(-0.742199948211)*x_ref[1]**(o-1)+(0.658035428735)
        ref[2,2,0]=o*(-0.17580106245)*x_ref[0]**(o-1)+(-0.589665223227)
        ref[2,2,1]=o*(0.580399510219)*x_ref[1]**(o-1)+(-0.155064144488)
        ref[2,3,0]=o*(-0.913915914987)*x_ref[0]**(o-1)+(0.3569536228)
        ref[2,3,1]=o*(0.23235960166)*x_ref[1]**(o-1)+(-0.847113665947)
        ref[2,4,0]=o*(0.0909806665742)*x_ref[0]**(o-1)+(-0.643246933435)
        ref[2,4,1]=o*(-0.480053101714)*x_ref[1]**(o-1)+(0.336898095124)
        ref[3,0,0]=o*(-0.944997214199)*x_ref[0]**(o-1)+(0.0242583099745)
        ref[3,0,1]=o*(-0.0537207940075)*x_ref[1]**(o-1)+(-0.985424066301)
        ref[3,1,0]=o*(0.685233610656)*x_ref[0]**(o-1)+(0.869977880645)
        ref[3,1,1]=o*(0.28306562014)*x_ref[1]**(o-1)+(-0.144951426405)
        ref[3,2,0]=o*(-0.0432942460834)*x_ref[0]**(o-1)+(0.706443143255)
        ref[3,2,1]=o*(-0.880454998397)*x_ref[1]**(o-1)+(0.612846993665)
        ref[3,3,0]=o*(0.79137204642)*x_ref[0]**(o-1)+(-0.534256675007)
        ref[3,3,1]=o*(-0.323548658904)*x_ref[1]**(o-1)+(0.667614029523)
        ref[3,4,0]=o*(0.0642269065087)*x_ref[0]**(o-1)+(0.299466531576)
        ref[3,4,1]=o*(-0.563060543682)*x_ref[1]**(o-1)+(-0.820583826087)
      else:
        s[0,0]=(0.554048013549)*x[0]**o+(0.628547931484)*x[0]+(-0.087120818445)*x[1]**o+(0.105429960285)*x[1]+(0.221041961114)*x[2]**o+(-0.617484121819)*x[2]
        s[0,1]=(-0.554948686776)*x[0]**o+(-0.271548517185)*x[0]+(0.167744163287)*x[1]**o+(-0.281562288124)*x[1]+(0.0995920439425)*x[2]**o+(0.952925293565)*x[2]
        s[0,2]=(-0.233604089512)*x[0]**o+(-0.395317021862)*x[0]+(-0.148631539093)*x[1]**o+(0.566615423332)*x[1]+(-0.851305702162)*x[2]**o+(0.522170109012)*x[2]
        s[0,3]=(0.33041096125)*x[0]**o+(0.531550689883)*x[0]+(0.43601483601)*x[1]**o+(0.508994516005)*x[1]+(0.848624945097)*x[2]**o+(0.367985533319)*x[2]
        s[0,4]=(0.452749219251)*x[0]**o+(-0.174905238359)*x[0]+(0.156533271339)*x[1]**o+(0.238697207856)*x[1]+(-0.287482388632)*x[2]**o+(-0.30704613609)*x[2]
        s[1,0]=(0.731135831652)*x[0]**o+(0.240028680462)*x[0]+(0.994673716713)*x[1]**o+(-0.14275472627)*x[1]+(0.0105619030307)*x[2]**o+(0.709488861006)*x[2]
        s[1,1]=(-0.494857482432)*x[0]**o+(-0.659820603466)*x[0]+(0.771064201278)*x[1]**o+(0.840663673162)*x[1]+(-0.141911130141)*x[2]**o+(-0.889454650127)*x[2]
        s[1,2]=(-0.492412677213)*x[0]**o+(0.432517067517)*x[0]+(0.239327954605)*x[1]**o+(-0.437437759354)*x[1]+(-0.188157683846)*x[2]**o+(-0.490906503638)*x[2]
        s[1,3]=(-0.313081049716)*x[0]**o+(-0.934448134549)*x[0]+(0.666459048562)*x[1]**o+(0.947256512054)*x[1]+(-0.710248833935)*x[2]**o+(-0.796385160956)*x[2]
        s[1,4]=(0.997217607294)*x[0]**o+(0.939841022657)*x[0]+(-0.857321524031)*x[1]**o+(-0.134948519166)*x[1]+(-0.383752839014)*x[2]**o+(-0.0694045288726)*x[2]
        s[2,0]=(0.884993378314)*x[0]**o+(-0.305179802237)*x[0]+(0.43264887709)*x[1]**o+(0.281387756518)*x[1]+(-0.887582464922)*x[2]**o+(-0.46966538775)*x[2]
        s[2,1]=(0.640836781354)*x[0]**o+(0.822302879707)*x[0]+(-0.78092397026)*x[1]**o+(-0.977840224136)*x[1]+(0.368581385054)*x[2]**o+(0.657227564549)*x[2]
        s[2,2]=(-0.148123980628)*x[0]**o+(-0.69167854219)*x[0]+(-0.93156581239)*x[1]**o+(-0.79482831934)*x[1]+(-0.816815232666)*x[2]**o+(0.0127598824004)*x[2]
        s[2,3]=(-0.610703986086)*x[0]**o+(0.274872054308)*x[0]+(0.0215106382843)*x[1]**o+(0.72724816172)*x[1]+(-0.915709139681)*x[2]**o+(0.321703565556)*x[2]
        s[2,4]=(0.381549090843)*x[0]**o+(-0.962121232421)*x[0]+(-0.897209804063)*x[1]**o+(-0.766441490629)*x[1]+(-0.741441127879)*x[2]**o+(-0.142615155341)*x[2]
        s[3,0]=(0.893922704275)*x[0]**o+(-0.683229796558)*x[0]+(0.900359565899)*x[1]**o+(0.785771212984)*x[1]+(0.216603036961)*x[2]**o+(0.144463289025)*x[2]
        s[3,1]=(0.360659657586)*x[0]**o+(-0.207597777231)*x[0]+(-0.350428345153)*x[1]**o+(-0.159358793155)*x[1]+(0.373616042827)*x[2]**o+(-0.0155120388232)*x[2]
        s[3,2]=(0.335734139009)*x[0]**o+(0.0880595596639)*x[0]+(-0.618682099923)*x[1]**o+(-0.409019944145)*x[1]+(0.56154653361)*x[2]**o+(-0.384031273173)*x[2]
        s[3,3]=(0.738466863893)*x[0]**o+(-0.305503217774)*x[0]+(-0.133472928746)*x[1]**o+(0.803290264921)*x[1]+(-0.919787049033)*x[2]**o+(0.138860079244)*x[2]
        s[3,4]=(0.0312193600407)*x[0]**o+(0.340894051514)*x[0]+(0.100198716313)*x[1]**o+(-0.196988878013)*x[1]+(0.0825369961302)*x[2]**o+(-0.652573275397)*x[2]
        ref[0,0,0]=o*(0.554048013549)*x_ref[0]**(o-1)+(0.628547931484)
        ref[0,0,1]=o*(-0.087120818445)*x_ref[1]**(o-1)+(0.105429960285)
        ref[0,0,2]=o*(0.221041961114)*x_ref[2]**(o-1)+(-0.617484121819)
        ref[0,1,0]=o*(-0.554948686776)*x_ref[0]**(o-1)+(-0.271548517185)
        ref[0,1,1]=o*(0.167744163287)*x_ref[1]**(o-1)+(-0.281562288124)
        ref[0,1,2]=o*(0.0995920439425)*x_ref[2]**(o-1)+(0.952925293565)
        ref[0,2,0]=o*(-0.233604089512)*x_ref[0]**(o-1)+(-0.395317021862)
        ref[0,2,1]=o*(-0.148631539093)*x_ref[1]**(o-1)+(0.566615423332)
        ref[0,2,2]=o*(-0.851305702162)*x_ref[2]**(o-1)+(0.522170109012)
        ref[0,3,0]=o*(0.33041096125)*x_ref[0]**(o-1)+(0.531550689883)
        ref[0,3,1]=o*(0.43601483601)*x_ref[1]**(o-1)+(0.508994516005)
        ref[0,3,2]=o*(0.848624945097)*x_ref[2]**(o-1)+(0.367985533319)
        ref[0,4,0]=o*(0.452749219251)*x_ref[0]**(o-1)+(-0.174905238359)
        ref[0,4,1]=o*(0.156533271339)*x_ref[1]**(o-1)+(0.238697207856)
        ref[0,4,2]=o*(-0.287482388632)*x_ref[2]**(o-1)+(-0.30704613609)
        ref[1,0,0]=o*(0.731135831652)*x_ref[0]**(o-1)+(0.240028680462)
        ref[1,0,1]=o*(0.994673716713)*x_ref[1]**(o-1)+(-0.14275472627)
        ref[1,0,2]=o*(0.0105619030307)*x_ref[2]**(o-1)+(0.709488861006)
        ref[1,1,0]=o*(-0.494857482432)*x_ref[0]**(o-1)+(-0.659820603466)
        ref[1,1,1]=o*(0.771064201278)*x_ref[1]**(o-1)+(0.840663673162)
        ref[1,1,2]=o*(-0.141911130141)*x_ref[2]**(o-1)+(-0.889454650127)
        ref[1,2,0]=o*(-0.492412677213)*x_ref[0]**(o-1)+(0.432517067517)
        ref[1,2,1]=o*(0.239327954605)*x_ref[1]**(o-1)+(-0.437437759354)
        ref[1,2,2]=o*(-0.188157683846)*x_ref[2]**(o-1)+(-0.490906503638)
        ref[1,3,0]=o*(-0.313081049716)*x_ref[0]**(o-1)+(-0.934448134549)
        ref[1,3,1]=o*(0.666459048562)*x_ref[1]**(o-1)+(0.947256512054)
        ref[1,3,2]=o*(-0.710248833935)*x_ref[2]**(o-1)+(-0.796385160956)
        ref[1,4,0]=o*(0.997217607294)*x_ref[0]**(o-1)+(0.939841022657)
        ref[1,4,1]=o*(-0.857321524031)*x_ref[1]**(o-1)+(-0.134948519166)
        ref[1,4,2]=o*(-0.383752839014)*x_ref[2]**(o-1)+(-0.0694045288726)
        ref[2,0,0]=o*(0.884993378314)*x_ref[0]**(o-1)+(-0.305179802237)
        ref[2,0,1]=o*(0.43264887709)*x_ref[1]**(o-1)+(0.281387756518)
        ref[2,0,2]=o*(-0.887582464922)*x_ref[2]**(o-1)+(-0.46966538775)
        ref[2,1,0]=o*(0.640836781354)*x_ref[0]**(o-1)+(0.822302879707)
        ref[2,1,1]=o*(-0.78092397026)*x_ref[1]**(o-1)+(-0.977840224136)
        ref[2,1,2]=o*(0.368581385054)*x_ref[2]**(o-1)+(0.657227564549)
        ref[2,2,0]=o*(-0.148123980628)*x_ref[0]**(o-1)+(-0.69167854219)
        ref[2,2,1]=o*(-0.93156581239)*x_ref[1]**(o-1)+(-0.79482831934)
        ref[2,2,2]=o*(-0.816815232666)*x_ref[2]**(o-1)+(0.0127598824004)
        ref[2,3,0]=o*(-0.610703986086)*x_ref[0]**(o-1)+(0.274872054308)
        ref[2,3,1]=o*(0.0215106382843)*x_ref[1]**(o-1)+(0.72724816172)
        ref[2,3,2]=o*(-0.915709139681)*x_ref[2]**(o-1)+(0.321703565556)
        ref[2,4,0]=o*(0.381549090843)*x_ref[0]**(o-1)+(-0.962121232421)
        ref[2,4,1]=o*(-0.897209804063)*x_ref[1]**(o-1)+(-0.766441490629)
        ref[2,4,2]=o*(-0.741441127879)*x_ref[2]**(o-1)+(-0.142615155341)
        ref[3,0,0]=o*(0.893922704275)*x_ref[0]**(o-1)+(-0.683229796558)
        ref[3,0,1]=o*(0.900359565899)*x_ref[1]**(o-1)+(0.785771212984)
        ref[3,0,2]=o*(0.216603036961)*x_ref[2]**(o-1)+(0.144463289025)
        ref[3,1,0]=o*(0.360659657586)*x_ref[0]**(o-1)+(-0.207597777231)
        ref[3,1,1]=o*(-0.350428345153)*x_ref[1]**(o-1)+(-0.159358793155)
        ref[3,1,2]=o*(0.373616042827)*x_ref[2]**(o-1)+(-0.0155120388232)
        ref[3,2,0]=o*(0.335734139009)*x_ref[0]**(o-1)+(0.0880595596639)
        ref[3,2,1]=o*(-0.618682099923)*x_ref[1]**(o-1)+(-0.409019944145)
        ref[3,2,2]=o*(0.56154653361)*x_ref[2]**(o-1)+(-0.384031273173)
        ref[3,3,0]=o*(0.738466863893)*x_ref[0]**(o-1)+(-0.305503217774)
        ref[3,3,1]=o*(-0.133472928746)*x_ref[1]**(o-1)+(0.803290264921)
        ref[3,3,2]=o*(-0.919787049033)*x_ref[2]**(o-1)+(0.138860079244)
        ref[3,4,0]=o*(0.0312193600407)*x_ref[0]**(o-1)+(0.340894051514)
        ref[3,4,1]=o*(0.100198716313)*x_ref[1]**(o-1)+(-0.196988878013)
        ref[3,4,2]=o*(0.0825369961302)*x_ref[2]**(o-1)+(-0.652573275397)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ContinuousFunction_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnContactOne

      assumptions: ContinuousFunction(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ContinuousFunction(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(-0.178576436338)*x[0]**o+(0.548880215769)*x[0]+(-0.318815466914)*x[1]**o+(-0.798063605205)*x[1]
        s[0,0,1]=(-0.822727567562)*x[0]**o+(-0.947988410328)*x[0]+(0.756740500537)*x[1]**o+(0.997703924729)*x[1]
        s[0,1,0]=(0.145493259882)*x[0]**o+(0.512878926373)*x[0]+(0.188564032293)*x[1]**o+(0.900204838942)*x[1]
        s[0,1,1]=(-0.88128289676)*x[0]**o+(0.833100847964)*x[0]+(-0.419907100559)*x[1]**o+(-0.461899797784)*x[1]
        s[1,0,0]=(-0.185721953771)*x[0]**o+(0.0783345782049)*x[0]+(-0.939442057638)*x[1]**o+(-0.320245477333)*x[1]
        s[1,0,1]=(0.410922982405)*x[0]**o+(0.398440443266)*x[0]+(0.768185628746)*x[1]**o+(0.256153329651)*x[1]
        s[1,1,0]=(-0.526878655538)*x[0]**o+(-0.658168532232)*x[0]+(0.69953069671)*x[1]**o+(-0.916587227061)*x[1]
        s[1,1,1]=(0.872254289223)*x[0]**o+(-0.804299235664)*x[0]+(-0.245503808339)*x[1]**o+(-0.894388559613)*x[1]
        s[2,0,0]=(0.917787084987)*x[0]**o+(-0.826075775004)*x[0]+(0.755866825722)*x[1]**o+(0.212054055974)*x[1]
        s[2,0,1]=(0.722119407968)*x[0]**o+(-0.357088696868)*x[0]+(0.033293020384)*x[1]**o+(-0.383269284911)*x[1]
        s[2,1,0]=(0.856304318608)*x[0]**o+(-0.918845722628)*x[0]+(-0.17232500803)*x[1]**o+(0.859254907185)*x[1]
        s[2,1,1]=(0.440452546297)*x[0]**o+(0.0912337401501)*x[0]+(0.76436338959)*x[1]**o+(-0.628986501066)*x[1]
        s[3,0,0]=(-0.583286304487)*x[0]**o+(0.102129275171)*x[0]+(-0.811858544156)*x[1]**o+(-0.521643540274)*x[1]
        s[3,0,1]=(0.682705489393)*x[0]**o+(0.722776291806)*x[0]+(-0.0417392890997)*x[1]**o+(0.487556285425)*x[1]
        s[3,1,0]=(-0.958268636176)*x[0]**o+(-0.666213997791)*x[0]+(-0.702747133353)*x[1]**o+(0.465173353165)*x[1]
        s[3,1,1]=(-0.919518552212)*x[0]**o+(0.607551779709)*x[0]+(0.4478984898)*x[1]**o+(0.0217822207015)*x[1]
        s[4,0,0]=(-0.625448546192)*x[0]**o+(0.513680244128)*x[0]+(0.0190646155266)*x[1]**o+(0.0155037658268)*x[1]
        s[4,0,1]=(-0.573453340974)*x[0]**o+(0.452807235507)*x[0]+(0.902938708535)*x[1]**o+(0.123632055082)*x[1]
        s[4,1,0]=(0.760888494849)*x[0]**o+(-0.488658748567)*x[0]+(0.949883579341)*x[1]**o+(-0.205749942866)*x[1]
        s[4,1,1]=(-0.2860871769)*x[0]**o+(0.614822186727)*x[0]+(0.118313781134)*x[1]**o+(0.448320553312)*x[1]
        s[5,0,0]=(0.671714056383)*x[0]**o+(-0.441343906973)*x[0]+(0.235137729851)*x[1]**o+(0.0696929938911)*x[1]
        s[5,0,1]=(0.114159304365)*x[0]**o+(0.562991557608)*x[0]+(0.00444483447333)*x[1]**o+(0.434809595495)*x[1]
        s[5,1,0]=(0.0360353162225)*x[0]**o+(-0.366777208182)*x[0]+(-0.668602224156)*x[1]**o+(0.449496848779)*x[1]
        s[5,1,1]=(-0.982227533448)*x[0]**o+(-0.704480676355)*x[0]+(-0.187844946341)*x[1]**o+(0.0975753620283)*x[1]
        ref[0,0,0,0]=o*(-0.178576436338)*x_ref[0]**(o-1)+(0.548880215769)
        ref[0,0,0,1]=o*(-0.318815466914)*x_ref[1]**(o-1)+(-0.798063605205)
        ref[0,0,1,0]=o*(-0.822727567562)*x_ref[0]**(o-1)+(-0.947988410328)
        ref[0,0,1,1]=o*(0.756740500537)*x_ref[1]**(o-1)+(0.997703924729)
        ref[0,1,0,0]=o*(0.145493259882)*x_ref[0]**(o-1)+(0.512878926373)
        ref[0,1,0,1]=o*(0.188564032293)*x_ref[1]**(o-1)+(0.900204838942)
        ref[0,1,1,0]=o*(-0.88128289676)*x_ref[0]**(o-1)+(0.833100847964)
        ref[0,1,1,1]=o*(-0.419907100559)*x_ref[1]**(o-1)+(-0.461899797784)
        ref[1,0,0,0]=o*(-0.185721953771)*x_ref[0]**(o-1)+(0.0783345782049)
        ref[1,0,0,1]=o*(-0.939442057638)*x_ref[1]**(o-1)+(-0.320245477333)
        ref[1,0,1,0]=o*(0.410922982405)*x_ref[0]**(o-1)+(0.398440443266)
        ref[1,0,1,1]=o*(0.768185628746)*x_ref[1]**(o-1)+(0.256153329651)
        ref[1,1,0,0]=o*(-0.526878655538)*x_ref[0]**(o-1)+(-0.658168532232)
        ref[1,1,0,1]=o*(0.69953069671)*x_ref[1]**(o-1)+(-0.916587227061)
        ref[1,1,1,0]=o*(0.872254289223)*x_ref[0]**(o-1)+(-0.804299235664)
        ref[1,1,1,1]=o*(-0.245503808339)*x_ref[1]**(o-1)+(-0.894388559613)
        ref[2,0,0,0]=o*(0.917787084987)*x_ref[0]**(o-1)+(-0.826075775004)
        ref[2,0,0,1]=o*(0.755866825722)*x_ref[1]**(o-1)+(0.212054055974)
        ref[2,0,1,0]=o*(0.722119407968)*x_ref[0]**(o-1)+(-0.357088696868)
        ref[2,0,1,1]=o*(0.033293020384)*x_ref[1]**(o-1)+(-0.383269284911)
        ref[2,1,0,0]=o*(0.856304318608)*x_ref[0]**(o-1)+(-0.918845722628)
        ref[2,1,0,1]=o*(-0.17232500803)*x_ref[1]**(o-1)+(0.859254907185)
        ref[2,1,1,0]=o*(0.440452546297)*x_ref[0]**(o-1)+(0.0912337401501)
        ref[2,1,1,1]=o*(0.76436338959)*x_ref[1]**(o-1)+(-0.628986501066)
        ref[3,0,0,0]=o*(-0.583286304487)*x_ref[0]**(o-1)+(0.102129275171)
        ref[3,0,0,1]=o*(-0.811858544156)*x_ref[1]**(o-1)+(-0.521643540274)
        ref[3,0,1,0]=o*(0.682705489393)*x_ref[0]**(o-1)+(0.722776291806)
        ref[3,0,1,1]=o*(-0.0417392890997)*x_ref[1]**(o-1)+(0.487556285425)
        ref[3,1,0,0]=o*(-0.958268636176)*x_ref[0]**(o-1)+(-0.666213997791)
        ref[3,1,0,1]=o*(-0.702747133353)*x_ref[1]**(o-1)+(0.465173353165)
        ref[3,1,1,0]=o*(-0.919518552212)*x_ref[0]**(o-1)+(0.607551779709)
        ref[3,1,1,1]=o*(0.4478984898)*x_ref[1]**(o-1)+(0.0217822207015)
        ref[4,0,0,0]=o*(-0.625448546192)*x_ref[0]**(o-1)+(0.513680244128)
        ref[4,0,0,1]=o*(0.0190646155266)*x_ref[1]**(o-1)+(0.0155037658268)
        ref[4,0,1,0]=o*(-0.573453340974)*x_ref[0]**(o-1)+(0.452807235507)
        ref[4,0,1,1]=o*(0.902938708535)*x_ref[1]**(o-1)+(0.123632055082)
        ref[4,1,0,0]=o*(0.760888494849)*x_ref[0]**(o-1)+(-0.488658748567)
        ref[4,1,0,1]=o*(0.949883579341)*x_ref[1]**(o-1)+(-0.205749942866)
        ref[4,1,1,0]=o*(-0.2860871769)*x_ref[0]**(o-1)+(0.614822186727)
        ref[4,1,1,1]=o*(0.118313781134)*x_ref[1]**(o-1)+(0.448320553312)
        ref[5,0,0,0]=o*(0.671714056383)*x_ref[0]**(o-1)+(-0.441343906973)
        ref[5,0,0,1]=o*(0.235137729851)*x_ref[1]**(o-1)+(0.0696929938911)
        ref[5,0,1,0]=o*(0.114159304365)*x_ref[0]**(o-1)+(0.562991557608)
        ref[5,0,1,1]=o*(0.00444483447333)*x_ref[1]**(o-1)+(0.434809595495)
        ref[5,1,0,0]=o*(0.0360353162225)*x_ref[0]**(o-1)+(-0.366777208182)
        ref[5,1,0,1]=o*(-0.668602224156)*x_ref[1]**(o-1)+(0.449496848779)
        ref[5,1,1,0]=o*(-0.982227533448)*x_ref[0]**(o-1)+(-0.704480676355)
        ref[5,1,1,1]=o*(-0.187844946341)*x_ref[1]**(o-1)+(0.0975753620283)
      else:
        s[0,0,0]=(0.983153853699)*x[0]**o+(0.877999648347)*x[0]+(0.673605473153)*x[1]**o+(0.469503898589)*x[1]+(-0.069158689944)*x[2]**o+(-0.861916140555)*x[2]
        s[0,0,1]=(-0.553610878092)*x[0]**o+(0.0506456195871)*x[0]+(-0.474818319583)*x[1]**o+(0.578919616336)*x[1]+(0.264746159866)*x[2]**o+(-0.433622198203)*x[2]
        s[0,1,0]=(0.666034530743)*x[0]**o+(0.546828305775)*x[0]+(-0.512009992229)*x[1]**o+(-0.476398683846)*x[1]+(-0.570551384835)*x[2]**o+(-0.133446991616)*x[2]
        s[0,1,1]=(0.539382416391)*x[0]**o+(-0.278692810377)*x[0]+(0.10726626544)*x[1]**o+(-0.966085403104)*x[1]+(-0.658134958165)*x[2]**o+(0.924604577895)*x[2]
        s[1,0,0]=(-0.330421615628)*x[0]**o+(0.724947570665)*x[0]+(0.34637731641)*x[1]**o+(0.39702161282)*x[1]+(0.931725860392)*x[2]**o+(-0.673326580823)*x[2]
        s[1,0,1]=(0.353966196399)*x[0]**o+(0.472639435387)*x[0]+(-0.328174031243)*x[1]**o+(0.640610221795)*x[1]+(-0.900613354552)*x[2]**o+(0.796468730393)*x[2]
        s[1,1,0]=(0.754328288128)*x[0]**o+(-0.846972319862)*x[0]+(0.845142974251)*x[1]**o+(0.144707523269)*x[1]+(-0.135529271924)*x[2]**o+(0.232438947532)*x[2]
        s[1,1,1]=(0.0826879113034)*x[0]**o+(-0.532753089482)*x[0]+(-0.617867675502)*x[1]**o+(0.327150779323)*x[1]+(-0.773918767657)*x[2]**o+(0.0695419192896)*x[2]
        s[2,0,0]=(0.861666752281)*x[0]**o+(-0.369904662594)*x[0]+(-0.809447635327)*x[1]**o+(0.314495362669)*x[1]+(0.672158503953)*x[2]**o+(0.779729363207)*x[2]
        s[2,0,1]=(0.784251939885)*x[0]**o+(-0.657779846806)*x[0]+(-0.694796642388)*x[1]**o+(0.549290583812)*x[1]+(0.452712301324)*x[2]**o+(0.0965361955733)*x[2]
        s[2,1,0]=(0.526035829224)*x[0]**o+(-0.5285468198)*x[0]+(0.426231604453)*x[1]**o+(-0.89107298075)*x[1]+(0.365149699988)*x[2]**o+(0.87436690224)*x[2]
        s[2,1,1]=(-0.516537342331)*x[0]**o+(-0.793927917391)*x[0]+(0.795130846095)*x[1]**o+(0.782928826071)*x[1]+(-0.874002864146)*x[2]**o+(0.465526006676)*x[2]
        s[3,0,0]=(-0.861917370502)*x[0]**o+(-0.0636266572453)*x[0]+(-0.0140222042452)*x[1]**o+(0.143759402339)*x[1]+(-0.247983260546)*x[2]**o+(-0.596358912223)*x[2]
        s[3,0,1]=(0.120302367516)*x[0]**o+(-0.701350969734)*x[0]+(-0.775100614072)*x[1]**o+(-0.248023481318)*x[1]+(0.849345512002)*x[2]**o+(0.542529986112)*x[2]
        s[3,1,0]=(-0.347014578244)*x[0]**o+(0.611296458158)*x[0]+(-0.11214501466)*x[1]**o+(0.516100884048)*x[1]+(-0.746366893941)*x[2]**o+(-0.429950357634)*x[2]
        s[3,1,1]=(-0.154199420675)*x[0]**o+(-0.533525033722)*x[0]+(-0.305802182284)*x[1]**o+(0.0249510778534)*x[1]+(0.511832901845)*x[2]**o+(0.865423961695)*x[2]
        s[4,0,0]=(0.270951033321)*x[0]**o+(0.293153287275)*x[0]+(0.499008893086)*x[1]**o+(0.401454188898)*x[1]+(-0.0659433492694)*x[2]**o+(0.0822124121616)*x[2]
        s[4,0,1]=(-0.770956381696)*x[0]**o+(0.962572964564)*x[0]+(-0.173527764809)*x[1]**o+(-0.764724502533)*x[1]+(0.686939133626)*x[2]**o+(0.589061927699)*x[2]
        s[4,1,0]=(0.856144070276)*x[0]**o+(-0.970851254884)*x[0]+(-0.200238695073)*x[1]**o+(0.961653891428)*x[1]+(-0.921215646185)*x[2]**o+(-0.927582743302)*x[2]
        s[4,1,1]=(0.518201773728)*x[0]**o+(0.403940302766)*x[0]+(-0.0333026733014)*x[1]**o+(0.602796446678)*x[1]+(0.956622086807)*x[2]**o+(0.445065392727)*x[2]
        s[5,0,0]=(0.847162899069)*x[0]**o+(-0.11079738914)*x[0]+(0.815117104026)*x[1]**o+(-0.0126064617312)*x[1]+(0.434649696776)*x[2]**o+(-0.925434721648)*x[2]
        s[5,0,1]=(0.827068835777)*x[0]**o+(0.267176529776)*x[0]+(-0.954551141359)*x[1]**o+(-0.847951054931)*x[1]+(0.939843025231)*x[2]**o+(-0.405674486263)*x[2]
        s[5,1,0]=(0.303863917444)*x[0]**o+(0.33377358223)*x[0]+(0.160136648003)*x[1]**o+(0.557340036308)*x[1]+(0.348362672822)*x[2]**o+(-0.719624087847)*x[2]
        s[5,1,1]=(-0.61009211312)*x[0]**o+(0.948776841387)*x[0]+(0.0348157372912)*x[1]**o+(0.415543380004)*x[1]+(-0.104796276752)*x[2]**o+(0.109481954783)*x[2]
        ref[0,0,0,0]=o*(0.983153853699)*x_ref[0]**(o-1)+(0.877999648347)
        ref[0,0,0,1]=o*(0.673605473153)*x_ref[1]**(o-1)+(0.469503898589)
        ref[0,0,0,2]=o*(-0.069158689944)*x_ref[2]**(o-1)+(-0.861916140555)
        ref[0,0,1,0]=o*(-0.553610878092)*x_ref[0]**(o-1)+(0.0506456195871)
        ref[0,0,1,1]=o*(-0.474818319583)*x_ref[1]**(o-1)+(0.578919616336)
        ref[0,0,1,2]=o*(0.264746159866)*x_ref[2]**(o-1)+(-0.433622198203)
        ref[0,1,0,0]=o*(0.666034530743)*x_ref[0]**(o-1)+(0.546828305775)
        ref[0,1,0,1]=o*(-0.512009992229)*x_ref[1]**(o-1)+(-0.476398683846)
        ref[0,1,0,2]=o*(-0.570551384835)*x_ref[2]**(o-1)+(-0.133446991616)
        ref[0,1,1,0]=o*(0.539382416391)*x_ref[0]**(o-1)+(-0.278692810377)
        ref[0,1,1,1]=o*(0.10726626544)*x_ref[1]**(o-1)+(-0.966085403104)
        ref[0,1,1,2]=o*(-0.658134958165)*x_ref[2]**(o-1)+(0.924604577895)
        ref[1,0,0,0]=o*(-0.330421615628)*x_ref[0]**(o-1)+(0.724947570665)
        ref[1,0,0,1]=o*(0.34637731641)*x_ref[1]**(o-1)+(0.39702161282)
        ref[1,0,0,2]=o*(0.931725860392)*x_ref[2]**(o-1)+(-0.673326580823)
        ref[1,0,1,0]=o*(0.353966196399)*x_ref[0]**(o-1)+(0.472639435387)
        ref[1,0,1,1]=o*(-0.328174031243)*x_ref[1]**(o-1)+(0.640610221795)
        ref[1,0,1,2]=o*(-0.900613354552)*x_ref[2]**(o-1)+(0.796468730393)
        ref[1,1,0,0]=o*(0.754328288128)*x_ref[0]**(o-1)+(-0.846972319862)
        ref[1,1,0,1]=o*(0.845142974251)*x_ref[1]**(o-1)+(0.144707523269)
        ref[1,1,0,2]=o*(-0.135529271924)*x_ref[2]**(o-1)+(0.232438947532)
        ref[1,1,1,0]=o*(0.0826879113034)*x_ref[0]**(o-1)+(-0.532753089482)
        ref[1,1,1,1]=o*(-0.617867675502)*x_ref[1]**(o-1)+(0.327150779323)
        ref[1,1,1,2]=o*(-0.773918767657)*x_ref[2]**(o-1)+(0.0695419192896)
        ref[2,0,0,0]=o*(0.861666752281)*x_ref[0]**(o-1)+(-0.369904662594)
        ref[2,0,0,1]=o*(-0.809447635327)*x_ref[1]**(o-1)+(0.314495362669)
        ref[2,0,0,2]=o*(0.672158503953)*x_ref[2]**(o-1)+(0.779729363207)
        ref[2,0,1,0]=o*(0.784251939885)*x_ref[0]**(o-1)+(-0.657779846806)
        ref[2,0,1,1]=o*(-0.694796642388)*x_ref[1]**(o-1)+(0.549290583812)
        ref[2,0,1,2]=o*(0.452712301324)*x_ref[2]**(o-1)+(0.0965361955733)
        ref[2,1,0,0]=o*(0.526035829224)*x_ref[0]**(o-1)+(-0.5285468198)
        ref[2,1,0,1]=o*(0.426231604453)*x_ref[1]**(o-1)+(-0.89107298075)
        ref[2,1,0,2]=o*(0.365149699988)*x_ref[2]**(o-1)+(0.87436690224)
        ref[2,1,1,0]=o*(-0.516537342331)*x_ref[0]**(o-1)+(-0.793927917391)
        ref[2,1,1,1]=o*(0.795130846095)*x_ref[1]**(o-1)+(0.782928826071)
        ref[2,1,1,2]=o*(-0.874002864146)*x_ref[2]**(o-1)+(0.465526006676)
        ref[3,0,0,0]=o*(-0.861917370502)*x_ref[0]**(o-1)+(-0.0636266572453)
        ref[3,0,0,1]=o*(-0.0140222042452)*x_ref[1]**(o-1)+(0.143759402339)
        ref[3,0,0,2]=o*(-0.247983260546)*x_ref[2]**(o-1)+(-0.596358912223)
        ref[3,0,1,0]=o*(0.120302367516)*x_ref[0]**(o-1)+(-0.701350969734)
        ref[3,0,1,1]=o*(-0.775100614072)*x_ref[1]**(o-1)+(-0.248023481318)
        ref[3,0,1,2]=o*(0.849345512002)*x_ref[2]**(o-1)+(0.542529986112)
        ref[3,1,0,0]=o*(-0.347014578244)*x_ref[0]**(o-1)+(0.611296458158)
        ref[3,1,0,1]=o*(-0.11214501466)*x_ref[1]**(o-1)+(0.516100884048)
        ref[3,1,0,2]=o*(-0.746366893941)*x_ref[2]**(o-1)+(-0.429950357634)
        ref[3,1,1,0]=o*(-0.154199420675)*x_ref[0]**(o-1)+(-0.533525033722)
        ref[3,1,1,1]=o*(-0.305802182284)*x_ref[1]**(o-1)+(0.0249510778534)
        ref[3,1,1,2]=o*(0.511832901845)*x_ref[2]**(o-1)+(0.865423961695)
        ref[4,0,0,0]=o*(0.270951033321)*x_ref[0]**(o-1)+(0.293153287275)
        ref[4,0,0,1]=o*(0.499008893086)*x_ref[1]**(o-1)+(0.401454188898)
        ref[4,0,0,2]=o*(-0.0659433492694)*x_ref[2]**(o-1)+(0.0822124121616)
        ref[4,0,1,0]=o*(-0.770956381696)*x_ref[0]**(o-1)+(0.962572964564)
        ref[4,0,1,1]=o*(-0.173527764809)*x_ref[1]**(o-1)+(-0.764724502533)
        ref[4,0,1,2]=o*(0.686939133626)*x_ref[2]**(o-1)+(0.589061927699)
        ref[4,1,0,0]=o*(0.856144070276)*x_ref[0]**(o-1)+(-0.970851254884)
        ref[4,1,0,1]=o*(-0.200238695073)*x_ref[1]**(o-1)+(0.961653891428)
        ref[4,1,0,2]=o*(-0.921215646185)*x_ref[2]**(o-1)+(-0.927582743302)
        ref[4,1,1,0]=o*(0.518201773728)*x_ref[0]**(o-1)+(0.403940302766)
        ref[4,1,1,1]=o*(-0.0333026733014)*x_ref[1]**(o-1)+(0.602796446678)
        ref[4,1,1,2]=o*(0.956622086807)*x_ref[2]**(o-1)+(0.445065392727)
        ref[5,0,0,0]=o*(0.847162899069)*x_ref[0]**(o-1)+(-0.11079738914)
        ref[5,0,0,1]=o*(0.815117104026)*x_ref[1]**(o-1)+(-0.0126064617312)
        ref[5,0,0,2]=o*(0.434649696776)*x_ref[2]**(o-1)+(-0.925434721648)
        ref[5,0,1,0]=o*(0.827068835777)*x_ref[0]**(o-1)+(0.267176529776)
        ref[5,0,1,1]=o*(-0.954551141359)*x_ref[1]**(o-1)+(-0.847951054931)
        ref[5,0,1,2]=o*(0.939843025231)*x_ref[2]**(o-1)+(-0.405674486263)
        ref[5,1,0,0]=o*(0.303863917444)*x_ref[0]**(o-1)+(0.33377358223)
        ref[5,1,0,1]=o*(0.160136648003)*x_ref[1]**(o-1)+(0.557340036308)
        ref[5,1,0,2]=o*(0.348362672822)*x_ref[2]**(o-1)+(-0.719624087847)
        ref[5,1,1,0]=o*(-0.61009211312)*x_ref[0]**(o-1)+(0.948776841387)
        ref[5,1,1,1]=o*(0.0348157372912)*x_ref[1]**(o-1)+(0.415543380004)
        ref[5,1,1,2]=o*(-0.104796276752)*x_ref[2]**(o-1)+(0.109481954783)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_Solution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(0.875674079407)*x[0]**o+(-0.108360259885)*x[0]+(0.875125430202)*x[1]**o+(0.552749512786)*x[1]
        ref[0]=o*(0.875674079407)*x_ref[0]**(o-1)+(-0.108360259885)
        ref[1]=o*(0.875125430202)*x_ref[1]**(o-1)+(0.552749512786)
      else:
        s=(0.0715819443551)*x[0]**o+(-0.619431747175)*x[0]+(-0.369266459921)*x[1]**o+(-0.105717390052)*x[1]+(-0.0432478189165)*x[2]**o+(0.725545839252)*x[2]
        ref[0]=o*(0.0715819443551)*x_ref[0]**(o-1)+(-0.619431747175)
        ref[1]=o*(-0.369266459921)*x_ref[1]**(o-1)+(-0.105717390052)
        ref[2]=o*(-0.0432478189165)*x_ref[2]**(o-1)+(0.725545839252)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_Solution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(-0.626220139204)*x[0]**o+(0.729385849716)*x[0]+(-0.182106069322)*x[1]**o+(0.00285725500104)*x[1]
        s[1]=(-0.315419266082)*x[0]**o+(0.152806559812)*x[0]+(0.193255632909)*x[1]**o+(0.0415291248123)*x[1]
        ref[0,0]=o*(-0.626220139204)*x_ref[0]**(o-1)+(0.729385849716)
        ref[0,1]=o*(-0.182106069322)*x_ref[1]**(o-1)+(0.00285725500104)
        ref[1,0]=o*(-0.315419266082)*x_ref[0]**(o-1)+(0.152806559812)
        ref[1,1]=o*(0.193255632909)*x_ref[1]**(o-1)+(0.0415291248123)
      else:
        s[0]=(0.378833186935)*x[0]**o+(0.334764252787)*x[0]+(0.335440021844)*x[1]**o+(0.0418556980547)*x[1]+(-0.355548870692)*x[2]**o+(0.188469092541)*x[2]
        s[1]=(0.554815928082)*x[0]**o+(-0.245327666469)*x[0]+(-0.807150174696)*x[1]**o+(-0.0186528579571)*x[1]+(-0.644067730056)*x[2]**o+(-0.56385913942)*x[2]
        ref[0,0]=o*(0.378833186935)*x_ref[0]**(o-1)+(0.334764252787)
        ref[0,1]=o*(0.335440021844)*x_ref[1]**(o-1)+(0.0418556980547)
        ref[0,2]=o*(-0.355548870692)*x_ref[2]**(o-1)+(0.188469092541)
        ref[1,0]=o*(0.554815928082)*x_ref[0]**(o-1)+(-0.245327666469)
        ref[1,1]=o*(-0.807150174696)*x_ref[1]**(o-1)+(-0.0186528579571)
        ref[1,2]=o*(-0.644067730056)*x_ref[2]**(o-1)+(-0.56385913942)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_Solution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(-0.169259870335)*x[0]**o+(-0.219393962977)*x[0]+(-0.377170386042)*x[1]**o+(-0.298077349995)*x[1]
        s[0,1]=(0.260540461556)*x[0]**o+(-0.00323982683281)*x[0]+(-0.238801075348)*x[1]**o+(-0.512630151171)*x[1]
        s[0,2]=(0.417777690389)*x[0]**o+(0.76705549948)*x[0]+(0.411966415931)*x[1]**o+(0.634271298164)*x[1]
        s[0,3]=(-0.514577227559)*x[0]**o+(-0.449963426549)*x[0]+(-0.400962023711)*x[1]**o+(-0.980313307287)*x[1]
        s[0,4]=(0.210149387291)*x[0]**o+(0.339419881455)*x[0]+(-0.122433722312)*x[1]**o+(-0.52322566908)*x[1]
        s[1,0]=(-0.456855849349)*x[0]**o+(-0.759902063915)*x[0]+(-0.743965861438)*x[1]**o+(-0.331770868496)*x[1]
        s[1,1]=(0.0972196005334)*x[0]**o+(-0.69511305009)*x[0]+(0.402041128045)*x[1]**o+(-0.924200483761)*x[1]
        s[1,2]=(-0.368298482402)*x[0]**o+(-0.351904909828)*x[0]+(-0.29784981961)*x[1]**o+(-0.0850625471026)*x[1]
        s[1,3]=(-0.79959026688)*x[0]**o+(-0.143869612796)*x[0]+(0.545276895212)*x[1]**o+(0.0277273177848)*x[1]
        s[1,4]=(-0.786210582915)*x[0]**o+(0.17248521577)*x[0]+(0.682847252483)*x[1]**o+(0.975158490563)*x[1]
        s[2,0]=(-0.00180696139571)*x[0]**o+(0.0644626145328)*x[0]+(-0.332784099857)*x[1]**o+(-0.62718290936)*x[1]
        s[2,1]=(0.529388118928)*x[0]**o+(0.679837615948)*x[0]+(-0.800039234078)*x[1]**o+(0.762585600198)*x[1]
        s[2,2]=(0.202108406753)*x[0]**o+(0.602440423874)*x[0]+(-0.544751041557)*x[1]**o+(-0.479387390671)*x[1]
        s[2,3]=(0.339973882877)*x[0]**o+(0.465854524429)*x[0]+(0.318692368851)*x[1]**o+(0.869234081961)*x[1]
        s[2,4]=(0.337044733833)*x[0]**o+(-0.401620568253)*x[0]+(-0.0302231005328)*x[1]**o+(0.218919539213)*x[1]
        s[3,0]=(-0.961845777661)*x[0]**o+(-0.509480342678)*x[0]+(0.970831236524)*x[1]**o+(-0.234720318489)*x[1]
        s[3,1]=(0.266147738115)*x[0]**o+(-0.0146288256163)*x[0]+(0.38625117249)*x[1]**o+(-0.449526886565)*x[1]
        s[3,2]=(-0.0829643094057)*x[0]**o+(-0.31837766369)*x[0]+(0.868932473361)*x[1]**o+(0.0753845710061)*x[1]
        s[3,3]=(-0.311549181378)*x[0]**o+(-0.0704226477679)*x[0]+(-0.80469940492)*x[1]**o+(0.17810271607)*x[1]
        s[3,4]=(0.496421938706)*x[0]**o+(-0.94316161479)*x[0]+(-0.759730393246)*x[1]**o+(0.857927191642)*x[1]
        ref[0,0,0]=o*(-0.169259870335)*x_ref[0]**(o-1)+(-0.219393962977)
        ref[0,0,1]=o*(-0.377170386042)*x_ref[1]**(o-1)+(-0.298077349995)
        ref[0,1,0]=o*(0.260540461556)*x_ref[0]**(o-1)+(-0.00323982683281)
        ref[0,1,1]=o*(-0.238801075348)*x_ref[1]**(o-1)+(-0.512630151171)
        ref[0,2,0]=o*(0.417777690389)*x_ref[0]**(o-1)+(0.76705549948)
        ref[0,2,1]=o*(0.411966415931)*x_ref[1]**(o-1)+(0.634271298164)
        ref[0,3,0]=o*(-0.514577227559)*x_ref[0]**(o-1)+(-0.449963426549)
        ref[0,3,1]=o*(-0.400962023711)*x_ref[1]**(o-1)+(-0.980313307287)
        ref[0,4,0]=o*(0.210149387291)*x_ref[0]**(o-1)+(0.339419881455)
        ref[0,4,1]=o*(-0.122433722312)*x_ref[1]**(o-1)+(-0.52322566908)
        ref[1,0,0]=o*(-0.456855849349)*x_ref[0]**(o-1)+(-0.759902063915)
        ref[1,0,1]=o*(-0.743965861438)*x_ref[1]**(o-1)+(-0.331770868496)
        ref[1,1,0]=o*(0.0972196005334)*x_ref[0]**(o-1)+(-0.69511305009)
        ref[1,1,1]=o*(0.402041128045)*x_ref[1]**(o-1)+(-0.924200483761)
        ref[1,2,0]=o*(-0.368298482402)*x_ref[0]**(o-1)+(-0.351904909828)
        ref[1,2,1]=o*(-0.29784981961)*x_ref[1]**(o-1)+(-0.0850625471026)
        ref[1,3,0]=o*(-0.79959026688)*x_ref[0]**(o-1)+(-0.143869612796)
        ref[1,3,1]=o*(0.545276895212)*x_ref[1]**(o-1)+(0.0277273177848)
        ref[1,4,0]=o*(-0.786210582915)*x_ref[0]**(o-1)+(0.17248521577)
        ref[1,4,1]=o*(0.682847252483)*x_ref[1]**(o-1)+(0.975158490563)
        ref[2,0,0]=o*(-0.00180696139571)*x_ref[0]**(o-1)+(0.0644626145328)
        ref[2,0,1]=o*(-0.332784099857)*x_ref[1]**(o-1)+(-0.62718290936)
        ref[2,1,0]=o*(0.529388118928)*x_ref[0]**(o-1)+(0.679837615948)
        ref[2,1,1]=o*(-0.800039234078)*x_ref[1]**(o-1)+(0.762585600198)
        ref[2,2,0]=o*(0.202108406753)*x_ref[0]**(o-1)+(0.602440423874)
        ref[2,2,1]=o*(-0.544751041557)*x_ref[1]**(o-1)+(-0.479387390671)
        ref[2,3,0]=o*(0.339973882877)*x_ref[0]**(o-1)+(0.465854524429)
        ref[2,3,1]=o*(0.318692368851)*x_ref[1]**(o-1)+(0.869234081961)
        ref[2,4,0]=o*(0.337044733833)*x_ref[0]**(o-1)+(-0.401620568253)
        ref[2,4,1]=o*(-0.0302231005328)*x_ref[1]**(o-1)+(0.218919539213)
        ref[3,0,0]=o*(-0.961845777661)*x_ref[0]**(o-1)+(-0.509480342678)
        ref[3,0,1]=o*(0.970831236524)*x_ref[1]**(o-1)+(-0.234720318489)
        ref[3,1,0]=o*(0.266147738115)*x_ref[0]**(o-1)+(-0.0146288256163)
        ref[3,1,1]=o*(0.38625117249)*x_ref[1]**(o-1)+(-0.449526886565)
        ref[3,2,0]=o*(-0.0829643094057)*x_ref[0]**(o-1)+(-0.31837766369)
        ref[3,2,1]=o*(0.868932473361)*x_ref[1]**(o-1)+(0.0753845710061)
        ref[3,3,0]=o*(-0.311549181378)*x_ref[0]**(o-1)+(-0.0704226477679)
        ref[3,3,1]=o*(-0.80469940492)*x_ref[1]**(o-1)+(0.17810271607)
        ref[3,4,0]=o*(0.496421938706)*x_ref[0]**(o-1)+(-0.94316161479)
        ref[3,4,1]=o*(-0.759730393246)*x_ref[1]**(o-1)+(0.857927191642)
      else:
        s[0,0]=(0.323269202132)*x[0]**o+(-0.0941675978056)*x[0]+(0.573540368658)*x[1]**o+(-0.476661689561)*x[1]+(-0.332358000871)*x[2]**o+(-0.817017744339)*x[2]
        s[0,1]=(0.116142610738)*x[0]**o+(0.0212217636606)*x[0]+(0.494731157541)*x[1]**o+(0.295191373453)*x[1]+(0.0528301662295)*x[2]**o+(-0.444651733146)*x[2]
        s[0,2]=(0.456064446338)*x[0]**o+(-0.69428330869)*x[0]+(0.677929037713)*x[1]**o+(-0.320468300843)*x[1]+(-0.87760608927)*x[2]**o+(-0.659457899497)*x[2]
        s[0,3]=(-0.189428313133)*x[0]**o+(-0.799817301777)*x[0]+(0.100831997136)*x[1]**o+(-0.113782495668)*x[1]+(0.455358915627)*x[2]**o+(-0.708374606976)*x[2]
        s[0,4]=(-0.118907620954)*x[0]**o+(-0.353855451309)*x[0]+(-0.773766114927)*x[1]**o+(-0.845133073805)*x[1]+(0.803289878128)*x[2]**o+(-0.852839704894)*x[2]
        s[1,0]=(-0.887023265539)*x[0]**o+(-0.792304610398)*x[0]+(0.0362402407711)*x[1]**o+(-0.260378118021)*x[1]+(0.142912579168)*x[2]**o+(0.544143870337)*x[2]
        s[1,1]=(0.805678954301)*x[0]**o+(0.701112598554)*x[0]+(0.922879760039)*x[1]**o+(-0.219024852502)*x[1]+(0.365922209323)*x[2]**o+(-0.420665475533)*x[2]
        s[1,2]=(0.832254579623)*x[0]**o+(-0.413462011593)*x[0]+(0.0852114474998)*x[1]**o+(-0.0932078507511)*x[1]+(-0.248076148787)*x[2]**o+(-0.428017096895)*x[2]
        s[1,3]=(-0.4967053049)*x[0]**o+(-0.50471234025)*x[0]+(-0.117548830517)*x[1]**o+(0.81561414915)*x[1]+(0.61128237476)*x[2]**o+(0.695201350291)*x[2]
        s[1,4]=(0.0281073079277)*x[0]**o+(0.62841659852)*x[0]+(0.685439649725)*x[1]**o+(-0.093589324186)*x[1]+(-0.848012915274)*x[2]**o+(-0.800065648129)*x[2]
        s[2,0]=(-0.35245094908)*x[0]**o+(0.40394009353)*x[0]+(-0.420215110026)*x[1]**o+(0.488912100088)*x[1]+(0.679732915429)*x[2]**o+(-0.362263037628)*x[2]
        s[2,1]=(-0.515442192308)*x[0]**o+(0.634797288073)*x[0]+(0.461169879242)*x[1]**o+(-0.51743910056)*x[1]+(-0.227585094451)*x[2]**o+(0.00407235369734)*x[2]
        s[2,2]=(-0.442867477277)*x[0]**o+(-0.212399902385)*x[0]+(-0.768565150664)*x[1]**o+(-0.398107108767)*x[1]+(-0.23802726279)*x[2]**o+(-0.838176628616)*x[2]
        s[2,3]=(0.491473254552)*x[0]**o+(0.00763471198539)*x[0]+(0.255444615913)*x[1]**o+(-0.655565675326)*x[1]+(0.324558324765)*x[2]**o+(-0.224946422831)*x[2]
        s[2,4]=(0.880395740489)*x[0]**o+(0.940871214043)*x[0]+(0.708978280722)*x[1]**o+(0.448470774528)*x[1]+(0.37065402316)*x[2]**o+(0.761394343858)*x[2]
        s[3,0]=(-0.455887951889)*x[0]**o+(0.00570480201782)*x[0]+(0.413555793704)*x[1]**o+(-0.313434157216)*x[1]+(0.339744130043)*x[2]**o+(-0.105392254622)*x[2]
        s[3,1]=(0.0528573842143)*x[0]**o+(-0.11565565)*x[0]+(-0.0443876403016)*x[1]**o+(-0.716723173535)*x[1]+(0.100057602497)*x[2]**o+(-0.891795165388)*x[2]
        s[3,2]=(-0.317795319526)*x[0]**o+(0.210753288047)*x[0]+(-0.666306164291)*x[1]**o+(-0.561602279575)*x[1]+(0.55557323269)*x[2]**o+(-0.479408955582)*x[2]
        s[3,3]=(0.49345832209)*x[0]**o+(-0.0684540951119)*x[0]+(0.69792572139)*x[1]**o+(-0.941053746122)*x[1]+(0.127906327934)*x[2]**o+(0.97752169437)*x[2]
        s[3,4]=(-0.553212311288)*x[0]**o+(0.718429728418)*x[0]+(0.179731047542)*x[1]**o+(0.169591114318)*x[1]+(0.402679892192)*x[2]**o+(0.0690728029503)*x[2]
        ref[0,0,0]=o*(0.323269202132)*x_ref[0]**(o-1)+(-0.0941675978056)
        ref[0,0,1]=o*(0.573540368658)*x_ref[1]**(o-1)+(-0.476661689561)
        ref[0,0,2]=o*(-0.332358000871)*x_ref[2]**(o-1)+(-0.817017744339)
        ref[0,1,0]=o*(0.116142610738)*x_ref[0]**(o-1)+(0.0212217636606)
        ref[0,1,1]=o*(0.494731157541)*x_ref[1]**(o-1)+(0.295191373453)
        ref[0,1,2]=o*(0.0528301662295)*x_ref[2]**(o-1)+(-0.444651733146)
        ref[0,2,0]=o*(0.456064446338)*x_ref[0]**(o-1)+(-0.69428330869)
        ref[0,2,1]=o*(0.677929037713)*x_ref[1]**(o-1)+(-0.320468300843)
        ref[0,2,2]=o*(-0.87760608927)*x_ref[2]**(o-1)+(-0.659457899497)
        ref[0,3,0]=o*(-0.189428313133)*x_ref[0]**(o-1)+(-0.799817301777)
        ref[0,3,1]=o*(0.100831997136)*x_ref[1]**(o-1)+(-0.113782495668)
        ref[0,3,2]=o*(0.455358915627)*x_ref[2]**(o-1)+(-0.708374606976)
        ref[0,4,0]=o*(-0.118907620954)*x_ref[0]**(o-1)+(-0.353855451309)
        ref[0,4,1]=o*(-0.773766114927)*x_ref[1]**(o-1)+(-0.845133073805)
        ref[0,4,2]=o*(0.803289878128)*x_ref[2]**(o-1)+(-0.852839704894)
        ref[1,0,0]=o*(-0.887023265539)*x_ref[0]**(o-1)+(-0.792304610398)
        ref[1,0,1]=o*(0.0362402407711)*x_ref[1]**(o-1)+(-0.260378118021)
        ref[1,0,2]=o*(0.142912579168)*x_ref[2]**(o-1)+(0.544143870337)
        ref[1,1,0]=o*(0.805678954301)*x_ref[0]**(o-1)+(0.701112598554)
        ref[1,1,1]=o*(0.922879760039)*x_ref[1]**(o-1)+(-0.219024852502)
        ref[1,1,2]=o*(0.365922209323)*x_ref[2]**(o-1)+(-0.420665475533)
        ref[1,2,0]=o*(0.832254579623)*x_ref[0]**(o-1)+(-0.413462011593)
        ref[1,2,1]=o*(0.0852114474998)*x_ref[1]**(o-1)+(-0.0932078507511)
        ref[1,2,2]=o*(-0.248076148787)*x_ref[2]**(o-1)+(-0.428017096895)
        ref[1,3,0]=o*(-0.4967053049)*x_ref[0]**(o-1)+(-0.50471234025)
        ref[1,3,1]=o*(-0.117548830517)*x_ref[1]**(o-1)+(0.81561414915)
        ref[1,3,2]=o*(0.61128237476)*x_ref[2]**(o-1)+(0.695201350291)
        ref[1,4,0]=o*(0.0281073079277)*x_ref[0]**(o-1)+(0.62841659852)
        ref[1,4,1]=o*(0.685439649725)*x_ref[1]**(o-1)+(-0.093589324186)
        ref[1,4,2]=o*(-0.848012915274)*x_ref[2]**(o-1)+(-0.800065648129)
        ref[2,0,0]=o*(-0.35245094908)*x_ref[0]**(o-1)+(0.40394009353)
        ref[2,0,1]=o*(-0.420215110026)*x_ref[1]**(o-1)+(0.488912100088)
        ref[2,0,2]=o*(0.679732915429)*x_ref[2]**(o-1)+(-0.362263037628)
        ref[2,1,0]=o*(-0.515442192308)*x_ref[0]**(o-1)+(0.634797288073)
        ref[2,1,1]=o*(0.461169879242)*x_ref[1]**(o-1)+(-0.51743910056)
        ref[2,1,2]=o*(-0.227585094451)*x_ref[2]**(o-1)+(0.00407235369734)
        ref[2,2,0]=o*(-0.442867477277)*x_ref[0]**(o-1)+(-0.212399902385)
        ref[2,2,1]=o*(-0.768565150664)*x_ref[1]**(o-1)+(-0.398107108767)
        ref[2,2,2]=o*(-0.23802726279)*x_ref[2]**(o-1)+(-0.838176628616)
        ref[2,3,0]=o*(0.491473254552)*x_ref[0]**(o-1)+(0.00763471198539)
        ref[2,3,1]=o*(0.255444615913)*x_ref[1]**(o-1)+(-0.655565675326)
        ref[2,3,2]=o*(0.324558324765)*x_ref[2]**(o-1)+(-0.224946422831)
        ref[2,4,0]=o*(0.880395740489)*x_ref[0]**(o-1)+(0.940871214043)
        ref[2,4,1]=o*(0.708978280722)*x_ref[1]**(o-1)+(0.448470774528)
        ref[2,4,2]=o*(0.37065402316)*x_ref[2]**(o-1)+(0.761394343858)
        ref[3,0,0]=o*(-0.455887951889)*x_ref[0]**(o-1)+(0.00570480201782)
        ref[3,0,1]=o*(0.413555793704)*x_ref[1]**(o-1)+(-0.313434157216)
        ref[3,0,2]=o*(0.339744130043)*x_ref[2]**(o-1)+(-0.105392254622)
        ref[3,1,0]=o*(0.0528573842143)*x_ref[0]**(o-1)+(-0.11565565)
        ref[3,1,1]=o*(-0.0443876403016)*x_ref[1]**(o-1)+(-0.716723173535)
        ref[3,1,2]=o*(0.100057602497)*x_ref[2]**(o-1)+(-0.891795165388)
        ref[3,2,0]=o*(-0.317795319526)*x_ref[0]**(o-1)+(0.210753288047)
        ref[3,2,1]=o*(-0.666306164291)*x_ref[1]**(o-1)+(-0.561602279575)
        ref[3,2,2]=o*(0.55557323269)*x_ref[2]**(o-1)+(-0.479408955582)
        ref[3,3,0]=o*(0.49345832209)*x_ref[0]**(o-1)+(-0.0684540951119)
        ref[3,3,1]=o*(0.69792572139)*x_ref[1]**(o-1)+(-0.941053746122)
        ref[3,3,2]=o*(0.127906327934)*x_ref[2]**(o-1)+(0.97752169437)
        ref[3,4,0]=o*(-0.553212311288)*x_ref[0]**(o-1)+(0.718429728418)
        ref[3,4,1]=o*(0.179731047542)*x_ref[1]**(o-1)+(0.169591114318)
        ref[3,4,2]=o*(0.402679892192)*x_ref[2]**(o-1)+(0.0690728029503)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_Solution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnContactOne

      assumptions: Solution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=self.order
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=Solution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(0.64178693834)*x[0]**o+(0.436828658021)*x[0]+(0.525622010733)*x[1]**o+(-0.0947845294558)*x[1]
        s[0,0,1]=(0.960929069825)*x[0]**o+(-0.0925500837249)*x[0]+(0.516628691912)*x[1]**o+(-0.713433036463)*x[1]
        s[0,1,0]=(-0.130010775216)*x[0]**o+(-0.569868353102)*x[0]+(-0.834642447971)*x[1]**o+(-0.262937552972)*x[1]
        s[0,1,1]=(-0.720926391535)*x[0]**o+(0.803576593732)*x[0]+(-0.613803785285)*x[1]**o+(0.713012726555)*x[1]
        s[1,0,0]=(-0.960850249593)*x[0]**o+(-0.891033054973)*x[0]+(0.750989994686)*x[1]**o+(0.983245329088)*x[1]
        s[1,0,1]=(-0.383882505108)*x[0]**o+(0.980533529745)*x[0]+(0.891761213135)*x[1]**o+(0.758837665244)*x[1]
        s[1,1,0]=(0.933866632845)*x[0]**o+(0.618830180361)*x[0]+(0.083925621148)*x[1]**o+(-0.681925439524)*x[1]
        s[1,1,1]=(0.344074931746)*x[0]**o+(-0.0411811037823)*x[0]+(0.582962923539)*x[1]**o+(0.242279633347)*x[1]
        s[2,0,0]=(0.0949732595833)*x[0]**o+(0.947484666339)*x[0]+(-0.856377492747)*x[1]**o+(0.0911692318532)*x[1]
        s[2,0,1]=(-0.294511041595)*x[0]**o+(0.252889321608)*x[0]+(-0.204790616562)*x[1]**o+(0.318333561489)*x[1]
        s[2,1,0]=(0.252492478572)*x[0]**o+(-0.594109481282)*x[0]+(-0.0260393414988)*x[1]**o+(0.563948256582)*x[1]
        s[2,1,1]=(-0.714450749502)*x[0]**o+(0.302407929025)*x[0]+(0.147817927373)*x[1]**o+(-0.830954899815)*x[1]
        s[3,0,0]=(0.56545292458)*x[0]**o+(0.486566855088)*x[0]+(0.990278375714)*x[1]**o+(0.229104000835)*x[1]
        s[3,0,1]=(-0.734062795067)*x[0]**o+(-0.191169476406)*x[0]+(-0.251242465039)*x[1]**o+(0.390333958806)*x[1]
        s[3,1,0]=(-0.337774363178)*x[0]**o+(0.700342293089)*x[0]+(-0.836836760567)*x[1]**o+(-0.0429509469196)*x[1]
        s[3,1,1]=(0.8888799528)*x[0]**o+(0.225714398328)*x[0]+(0.622017922629)*x[1]**o+(-0.614413552831)*x[1]
        s[4,0,0]=(0.882570398452)*x[0]**o+(-0.0550944535693)*x[0]+(-0.674688995642)*x[1]**o+(0.489860414323)*x[1]
        s[4,0,1]=(0.192190815605)*x[0]**o+(0.615603974895)*x[0]+(-0.713940642233)*x[1]**o+(0.692854992944)*x[1]
        s[4,1,0]=(0.383266832431)*x[0]**o+(0.294686738948)*x[0]+(0.119658392209)*x[1]**o+(-0.550041082523)*x[1]
        s[4,1,1]=(-0.0639894922603)*x[0]**o+(0.0322835841591)*x[0]+(-0.148146549294)*x[1]**o+(-0.472048255747)*x[1]
        s[5,0,0]=(-0.596603356022)*x[0]**o+(0.0764697562663)*x[0]+(0.23065037103)*x[1]**o+(-0.993102200263)*x[1]
        s[5,0,1]=(-0.268998655952)*x[0]**o+(0.911781569559)*x[0]+(-0.424230615868)*x[1]**o+(-0.196872693015)*x[1]
        s[5,1,0]=(-0.145090787501)*x[0]**o+(0.694829120617)*x[0]+(-0.972729923357)*x[1]**o+(-0.737541664159)*x[1]
        s[5,1,1]=(-0.196228029528)*x[0]**o+(-0.385307212434)*x[0]+(-0.793635672028)*x[1]**o+(-0.547670068083)*x[1]
        ref[0,0,0,0]=o*(0.64178693834)*x_ref[0]**(o-1)+(0.436828658021)
        ref[0,0,0,1]=o*(0.525622010733)*x_ref[1]**(o-1)+(-0.0947845294558)
        ref[0,0,1,0]=o*(0.960929069825)*x_ref[0]**(o-1)+(-0.0925500837249)
        ref[0,0,1,1]=o*(0.516628691912)*x_ref[1]**(o-1)+(-0.713433036463)
        ref[0,1,0,0]=o*(-0.130010775216)*x_ref[0]**(o-1)+(-0.569868353102)
        ref[0,1,0,1]=o*(-0.834642447971)*x_ref[1]**(o-1)+(-0.262937552972)
        ref[0,1,1,0]=o*(-0.720926391535)*x_ref[0]**(o-1)+(0.803576593732)
        ref[0,1,1,1]=o*(-0.613803785285)*x_ref[1]**(o-1)+(0.713012726555)
        ref[1,0,0,0]=o*(-0.960850249593)*x_ref[0]**(o-1)+(-0.891033054973)
        ref[1,0,0,1]=o*(0.750989994686)*x_ref[1]**(o-1)+(0.983245329088)
        ref[1,0,1,0]=o*(-0.383882505108)*x_ref[0]**(o-1)+(0.980533529745)
        ref[1,0,1,1]=o*(0.891761213135)*x_ref[1]**(o-1)+(0.758837665244)
        ref[1,1,0,0]=o*(0.933866632845)*x_ref[0]**(o-1)+(0.618830180361)
        ref[1,1,0,1]=o*(0.083925621148)*x_ref[1]**(o-1)+(-0.681925439524)
        ref[1,1,1,0]=o*(0.344074931746)*x_ref[0]**(o-1)+(-0.0411811037823)
        ref[1,1,1,1]=o*(0.582962923539)*x_ref[1]**(o-1)+(0.242279633347)
        ref[2,0,0,0]=o*(0.0949732595833)*x_ref[0]**(o-1)+(0.947484666339)
        ref[2,0,0,1]=o*(-0.856377492747)*x_ref[1]**(o-1)+(0.0911692318532)
        ref[2,0,1,0]=o*(-0.294511041595)*x_ref[0]**(o-1)+(0.252889321608)
        ref[2,0,1,1]=o*(-0.204790616562)*x_ref[1]**(o-1)+(0.318333561489)
        ref[2,1,0,0]=o*(0.252492478572)*x_ref[0]**(o-1)+(-0.594109481282)
        ref[2,1,0,1]=o*(-0.0260393414988)*x_ref[1]**(o-1)+(0.563948256582)
        ref[2,1,1,0]=o*(-0.714450749502)*x_ref[0]**(o-1)+(0.302407929025)
        ref[2,1,1,1]=o*(0.147817927373)*x_ref[1]**(o-1)+(-0.830954899815)
        ref[3,0,0,0]=o*(0.56545292458)*x_ref[0]**(o-1)+(0.486566855088)
        ref[3,0,0,1]=o*(0.990278375714)*x_ref[1]**(o-1)+(0.229104000835)
        ref[3,0,1,0]=o*(-0.734062795067)*x_ref[0]**(o-1)+(-0.191169476406)
        ref[3,0,1,1]=o*(-0.251242465039)*x_ref[1]**(o-1)+(0.390333958806)
        ref[3,1,0,0]=o*(-0.337774363178)*x_ref[0]**(o-1)+(0.700342293089)
        ref[3,1,0,1]=o*(-0.836836760567)*x_ref[1]**(o-1)+(-0.0429509469196)
        ref[3,1,1,0]=o*(0.8888799528)*x_ref[0]**(o-1)+(0.225714398328)
        ref[3,1,1,1]=o*(0.622017922629)*x_ref[1]**(o-1)+(-0.614413552831)
        ref[4,0,0,0]=o*(0.882570398452)*x_ref[0]**(o-1)+(-0.0550944535693)
        ref[4,0,0,1]=o*(-0.674688995642)*x_ref[1]**(o-1)+(0.489860414323)
        ref[4,0,1,0]=o*(0.192190815605)*x_ref[0]**(o-1)+(0.615603974895)
        ref[4,0,1,1]=o*(-0.713940642233)*x_ref[1]**(o-1)+(0.692854992944)
        ref[4,1,0,0]=o*(0.383266832431)*x_ref[0]**(o-1)+(0.294686738948)
        ref[4,1,0,1]=o*(0.119658392209)*x_ref[1]**(o-1)+(-0.550041082523)
        ref[4,1,1,0]=o*(-0.0639894922603)*x_ref[0]**(o-1)+(0.0322835841591)
        ref[4,1,1,1]=o*(-0.148146549294)*x_ref[1]**(o-1)+(-0.472048255747)
        ref[5,0,0,0]=o*(-0.596603356022)*x_ref[0]**(o-1)+(0.0764697562663)
        ref[5,0,0,1]=o*(0.23065037103)*x_ref[1]**(o-1)+(-0.993102200263)
        ref[5,0,1,0]=o*(-0.268998655952)*x_ref[0]**(o-1)+(0.911781569559)
        ref[5,0,1,1]=o*(-0.424230615868)*x_ref[1]**(o-1)+(-0.196872693015)
        ref[5,1,0,0]=o*(-0.145090787501)*x_ref[0]**(o-1)+(0.694829120617)
        ref[5,1,0,1]=o*(-0.972729923357)*x_ref[1]**(o-1)+(-0.737541664159)
        ref[5,1,1,0]=o*(-0.196228029528)*x_ref[0]**(o-1)+(-0.385307212434)
        ref[5,1,1,1]=o*(-0.793635672028)*x_ref[1]**(o-1)+(-0.547670068083)
      else:
        s[0,0,0]=(0.130537344403)*x[0]**o+(-0.716585435036)*x[0]+(0.885628707489)*x[1]**o+(0.359657295083)*x[1]+(0.849414417001)*x[2]**o+(0.417004569061)*x[2]
        s[0,0,1]=(0.582291844761)*x[0]**o+(0.515724457456)*x[0]+(0.768535647866)*x[1]**o+(0.34108474273)*x[1]+(-0.620508267743)*x[2]**o+(-0.342013446761)*x[2]
        s[0,1,0]=(-0.531235123931)*x[0]**o+(-0.765634705075)*x[0]+(0.228864105339)*x[1]**o+(-0.491530876451)*x[1]+(0.521065315283)*x[2]**o+(-0.951623087256)*x[2]
        s[0,1,1]=(0.0716827639786)*x[0]**o+(-0.16499705145)*x[0]+(-0.0190243436099)*x[1]**o+(-0.926607070761)*x[1]+(-0.55142315912)*x[2]**o+(-0.0794842630428)*x[2]
        s[1,0,0]=(0.182139977684)*x[0]**o+(-0.0362484111368)*x[0]+(-0.752143193872)*x[1]**o+(-0.316455062654)*x[1]+(0.269718723768)*x[2]**o+(-0.313902463376)*x[2]
        s[1,0,1]=(0.743368204514)*x[0]**o+(-0.822345231625)*x[0]+(0.814851367707)*x[1]**o+(0.702205919957)*x[1]+(-0.0503255941307)*x[2]**o+(-0.0318030472244)*x[2]
        s[1,1,0]=(0.022342448883)*x[0]**o+(-0.352009543909)*x[0]+(0.5204277493)*x[1]**o+(-0.741699265227)*x[1]+(0.00608894949938)*x[2]**o+(0.965930515392)*x[2]
        s[1,1,1]=(-0.0920262487111)*x[0]**o+(0.249857266149)*x[0]+(0.916353890515)*x[1]**o+(-0.0594616510094)*x[1]+(-0.402620394698)*x[2]**o+(-0.00864935399915)*x[2]
        s[2,0,0]=(-0.944378332174)*x[0]**o+(0.501614469906)*x[0]+(0.829832603587)*x[1]**o+(0.4202031628)*x[1]+(0.886338738184)*x[2]**o+(0.811714471885)*x[2]
        s[2,0,1]=(0.0413505829692)*x[0]**o+(-0.59249386093)*x[0]+(0.478645406371)*x[1]**o+(0.221389337839)*x[1]+(0.18016770891)*x[2]**o+(-0.783010309878)*x[2]
        s[2,1,0]=(0.641325174447)*x[0]**o+(0.859809801095)*x[0]+(0.238917443521)*x[1]**o+(0.169387212912)*x[1]+(0.118386087343)*x[2]**o+(0.7091562331)*x[2]
        s[2,1,1]=(0.683767548268)*x[0]**o+(-0.488504930782)*x[0]+(0.421423574907)*x[1]**o+(0.677076626099)*x[1]+(-0.0955208633306)*x[2]**o+(0.545750792826)*x[2]
        s[3,0,0]=(-0.925067175669)*x[0]**o+(0.550204660551)*x[0]+(0.435686889479)*x[1]**o+(-0.171725370784)*x[1]+(0.182097753276)*x[2]**o+(0.493662375098)*x[2]
        s[3,0,1]=(-0.719237805296)*x[0]**o+(0.669817079155)*x[0]+(0.660680613106)*x[1]**o+(-0.729927483007)*x[1]+(-0.162704346009)*x[2]**o+(-0.559206291015)*x[2]
        s[3,1,0]=(0.129735268583)*x[0]**o+(-0.411853842222)*x[0]+(0.045438376206)*x[1]**o+(0.327804746872)*x[1]+(-0.639433216582)*x[2]**o+(0.451106136717)*x[2]
        s[3,1,1]=(-0.811557092293)*x[0]**o+(-0.818758274715)*x[0]+(-0.712815291675)*x[1]**o+(0.729038274951)*x[1]+(-0.826837009476)*x[2]**o+(0.340025404977)*x[2]
        s[4,0,0]=(-0.507284842259)*x[0]**o+(0.457554461786)*x[0]+(0.419345933038)*x[1]**o+(-0.7773529718)*x[1]+(-0.626475804952)*x[2]**o+(-0.784196320861)*x[2]
        s[4,0,1]=(-0.0340250322306)*x[0]**o+(-0.0936499769437)*x[0]+(-0.777584776075)*x[1]**o+(-0.435876632622)*x[1]+(0.999336374444)*x[2]**o+(-0.247149214414)*x[2]
        s[4,1,0]=(0.21620967013)*x[0]**o+(0.213039866961)*x[0]+(0.83049354428)*x[1]**o+(0.651430926943)*x[1]+(0.201648695549)*x[2]**o+(-0.609802970877)*x[2]
        s[4,1,1]=(0.842001670092)*x[0]**o+(-0.868487783326)*x[0]+(-0.288512200338)*x[1]**o+(-0.654831485218)*x[1]+(-0.111859725689)*x[2]**o+(0.728195130453)*x[2]
        s[5,0,0]=(0.473856201092)*x[0]**o+(0.377649949188)*x[0]+(0.511638340284)*x[1]**o+(-0.150021940198)*x[1]+(-0.801655915671)*x[2]**o+(-0.603617347175)*x[2]
        s[5,0,1]=(0.945961549464)*x[0]**o+(0.40151064288)*x[0]+(0.151039821252)*x[1]**o+(0.977148741848)*x[1]+(0.0729651283448)*x[2]**o+(0.365625847237)*x[2]
        s[5,1,0]=(0.613037024504)*x[0]**o+(-0.743080801009)*x[0]+(-0.518736037968)*x[1]**o+(0.240273029617)*x[1]+(0.437464780338)*x[2]**o+(0.897940669321)*x[2]
        s[5,1,1]=(-0.149245273038)*x[0]**o+(-0.387037171901)*x[0]+(0.0606843165198)*x[1]**o+(-0.713188961184)*x[1]+(0.622672840108)*x[2]**o+(-0.579757019852)*x[2]
        ref[0,0,0,0]=o*(0.130537344403)*x_ref[0]**(o-1)+(-0.716585435036)
        ref[0,0,0,1]=o*(0.885628707489)*x_ref[1]**(o-1)+(0.359657295083)
        ref[0,0,0,2]=o*(0.849414417001)*x_ref[2]**(o-1)+(0.417004569061)
        ref[0,0,1,0]=o*(0.582291844761)*x_ref[0]**(o-1)+(0.515724457456)
        ref[0,0,1,1]=o*(0.768535647866)*x_ref[1]**(o-1)+(0.34108474273)
        ref[0,0,1,2]=o*(-0.620508267743)*x_ref[2]**(o-1)+(-0.342013446761)
        ref[0,1,0,0]=o*(-0.531235123931)*x_ref[0]**(o-1)+(-0.765634705075)
        ref[0,1,0,1]=o*(0.228864105339)*x_ref[1]**(o-1)+(-0.491530876451)
        ref[0,1,0,2]=o*(0.521065315283)*x_ref[2]**(o-1)+(-0.951623087256)
        ref[0,1,1,0]=o*(0.0716827639786)*x_ref[0]**(o-1)+(-0.16499705145)
        ref[0,1,1,1]=o*(-0.0190243436099)*x_ref[1]**(o-1)+(-0.926607070761)
        ref[0,1,1,2]=o*(-0.55142315912)*x_ref[2]**(o-1)+(-0.0794842630428)
        ref[1,0,0,0]=o*(0.182139977684)*x_ref[0]**(o-1)+(-0.0362484111368)
        ref[1,0,0,1]=o*(-0.752143193872)*x_ref[1]**(o-1)+(-0.316455062654)
        ref[1,0,0,2]=o*(0.269718723768)*x_ref[2]**(o-1)+(-0.313902463376)
        ref[1,0,1,0]=o*(0.743368204514)*x_ref[0]**(o-1)+(-0.822345231625)
        ref[1,0,1,1]=o*(0.814851367707)*x_ref[1]**(o-1)+(0.702205919957)
        ref[1,0,1,2]=o*(-0.0503255941307)*x_ref[2]**(o-1)+(-0.0318030472244)
        ref[1,1,0,0]=o*(0.022342448883)*x_ref[0]**(o-1)+(-0.352009543909)
        ref[1,1,0,1]=o*(0.5204277493)*x_ref[1]**(o-1)+(-0.741699265227)
        ref[1,1,0,2]=o*(0.00608894949938)*x_ref[2]**(o-1)+(0.965930515392)
        ref[1,1,1,0]=o*(-0.0920262487111)*x_ref[0]**(o-1)+(0.249857266149)
        ref[1,1,1,1]=o*(0.916353890515)*x_ref[1]**(o-1)+(-0.0594616510094)
        ref[1,1,1,2]=o*(-0.402620394698)*x_ref[2]**(o-1)+(-0.00864935399915)
        ref[2,0,0,0]=o*(-0.944378332174)*x_ref[0]**(o-1)+(0.501614469906)
        ref[2,0,0,1]=o*(0.829832603587)*x_ref[1]**(o-1)+(0.4202031628)
        ref[2,0,0,2]=o*(0.886338738184)*x_ref[2]**(o-1)+(0.811714471885)
        ref[2,0,1,0]=o*(0.0413505829692)*x_ref[0]**(o-1)+(-0.59249386093)
        ref[2,0,1,1]=o*(0.478645406371)*x_ref[1]**(o-1)+(0.221389337839)
        ref[2,0,1,2]=o*(0.18016770891)*x_ref[2]**(o-1)+(-0.783010309878)
        ref[2,1,0,0]=o*(0.641325174447)*x_ref[0]**(o-1)+(0.859809801095)
        ref[2,1,0,1]=o*(0.238917443521)*x_ref[1]**(o-1)+(0.169387212912)
        ref[2,1,0,2]=o*(0.118386087343)*x_ref[2]**(o-1)+(0.7091562331)
        ref[2,1,1,0]=o*(0.683767548268)*x_ref[0]**(o-1)+(-0.488504930782)
        ref[2,1,1,1]=o*(0.421423574907)*x_ref[1]**(o-1)+(0.677076626099)
        ref[2,1,1,2]=o*(-0.0955208633306)*x_ref[2]**(o-1)+(0.545750792826)
        ref[3,0,0,0]=o*(-0.925067175669)*x_ref[0]**(o-1)+(0.550204660551)
        ref[3,0,0,1]=o*(0.435686889479)*x_ref[1]**(o-1)+(-0.171725370784)
        ref[3,0,0,2]=o*(0.182097753276)*x_ref[2]**(o-1)+(0.493662375098)
        ref[3,0,1,0]=o*(-0.719237805296)*x_ref[0]**(o-1)+(0.669817079155)
        ref[3,0,1,1]=o*(0.660680613106)*x_ref[1]**(o-1)+(-0.729927483007)
        ref[3,0,1,2]=o*(-0.162704346009)*x_ref[2]**(o-1)+(-0.559206291015)
        ref[3,1,0,0]=o*(0.129735268583)*x_ref[0]**(o-1)+(-0.411853842222)
        ref[3,1,0,1]=o*(0.045438376206)*x_ref[1]**(o-1)+(0.327804746872)
        ref[3,1,0,2]=o*(-0.639433216582)*x_ref[2]**(o-1)+(0.451106136717)
        ref[3,1,1,0]=o*(-0.811557092293)*x_ref[0]**(o-1)+(-0.818758274715)
        ref[3,1,1,1]=o*(-0.712815291675)*x_ref[1]**(o-1)+(0.729038274951)
        ref[3,1,1,2]=o*(-0.826837009476)*x_ref[2]**(o-1)+(0.340025404977)
        ref[4,0,0,0]=o*(-0.507284842259)*x_ref[0]**(o-1)+(0.457554461786)
        ref[4,0,0,1]=o*(0.419345933038)*x_ref[1]**(o-1)+(-0.7773529718)
        ref[4,0,0,2]=o*(-0.626475804952)*x_ref[2]**(o-1)+(-0.784196320861)
        ref[4,0,1,0]=o*(-0.0340250322306)*x_ref[0]**(o-1)+(-0.0936499769437)
        ref[4,0,1,1]=o*(-0.777584776075)*x_ref[1]**(o-1)+(-0.435876632622)
        ref[4,0,1,2]=o*(0.999336374444)*x_ref[2]**(o-1)+(-0.247149214414)
        ref[4,1,0,0]=o*(0.21620967013)*x_ref[0]**(o-1)+(0.213039866961)
        ref[4,1,0,1]=o*(0.83049354428)*x_ref[1]**(o-1)+(0.651430926943)
        ref[4,1,0,2]=o*(0.201648695549)*x_ref[2]**(o-1)+(-0.609802970877)
        ref[4,1,1,0]=o*(0.842001670092)*x_ref[0]**(o-1)+(-0.868487783326)
        ref[4,1,1,1]=o*(-0.288512200338)*x_ref[1]**(o-1)+(-0.654831485218)
        ref[4,1,1,2]=o*(-0.111859725689)*x_ref[2]**(o-1)+(0.728195130453)
        ref[5,0,0,0]=o*(0.473856201092)*x_ref[0]**(o-1)+(0.377649949188)
        ref[5,0,0,1]=o*(0.511638340284)*x_ref[1]**(o-1)+(-0.150021940198)
        ref[5,0,0,2]=o*(-0.801655915671)*x_ref[2]**(o-1)+(-0.603617347175)
        ref[5,0,1,0]=o*(0.945961549464)*x_ref[0]**(o-1)+(0.40151064288)
        ref[5,0,1,1]=o*(0.151039821252)*x_ref[1]**(o-1)+(0.977148741848)
        ref[5,0,1,2]=o*(0.0729651283448)*x_ref[2]**(o-1)+(0.365625847237)
        ref[5,1,0,0]=o*(0.613037024504)*x_ref[0]**(o-1)+(-0.743080801009)
        ref[5,1,0,1]=o*(-0.518736037968)*x_ref[1]**(o-1)+(0.240273029617)
        ref[5,1,0,2]=o*(0.437464780338)*x_ref[2]**(o-1)+(0.897940669321)
        ref[5,1,1,0]=o*(-0.149245273038)*x_ref[0]**(o-1)+(-0.387037171901)
        ref[5,1,1,1]=o*(0.0606843165198)*x_ref[1]**(o-1)+(-0.713188961184)
        ref[5,1,1,2]=o*(0.622672840108)*x_ref[2]**(o-1)+(-0.579757019852)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank0(self):
      """
      tests gradient for rank 0 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(),dim=dim)
      s=Data(0,(),w)
      ref=Data(0,()+(dim,),w_ref)
      if dim==2:
        s=(1.05116031237)*x[0]+(-0.156242880188)*x[1]
        ref[0]=(1.05116031237)
        ref[1]=(-0.156242880188)
      else:
        s=(-0.978032091964)*x[0]+(0.994143533164)*x[1]+(1.36141912157)*x[2]
        ref[0]=(-0.978032091964)
        ref[1]=(0.994143533164)
        ref[2]=(1.36141912157)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),()+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank1(self):
      """
      tests gradient for rank 1 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(2,),dim=dim)
      s=Data(0,(2,),w)
      ref=Data(0,(2,)+(dim,),w_ref)
      if dim==2:
        s[0]=(0.908181468063)*x[0]+(0.383654148719)*x[1]
        s[1]=(0.996727924056)*x[0]+(1.13801031707)*x[1]
        ref[0,0]=(0.908181468063)
        ref[0,1]=(0.383654148719)
        ref[1,0]=(0.996727924056)
        ref[1,1]=(1.13801031707)
      else:
        s[0]=(-0.431683467168)*x[0]+(-0.610893064868)*x[1]+(-0.39989804071)*x[2]
        s[1]=(0.820400856313)*x[0]+(0.790210621031)*x[1]+(-0.0581477423106)*x[2]
        ref[0,0]=(-0.431683467168)
        ref[0,1]=(-0.610893064868)
        ref[0,2]=(-0.39989804071)
        ref[1,0]=(0.820400856313)
        ref[1,1]=(0.790210621031)
        ref[1,2]=(-0.0581477423106)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(2,)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank2(self):
      """
      tests gradient for rank 2 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(4, 5),dim=dim)
      s=Data(0,(4, 5),w)
      ref=Data(0,(4, 5)+(dim,),w_ref)
      if dim==2:
        s[0,0]=(0.202521929549)*x[0]+(1.24388265835)*x[1]
        s[0,1]=(0.466921175909)*x[0]+(0.0938124013357)*x[1]
        s[0,2]=(-0.337565182967)*x[0]+(-0.66213972177)*x[1]
        s[0,3]=(-1.1265817109)*x[0]+(1.45099893506)*x[1]
        s[0,4]=(1.85945279233)*x[0]+(0.614232583853)*x[1]
        s[1,0]=(0.773998701601)*x[0]+(1.3572752273)*x[1]
        s[1,1]=(1.503889482)*x[0]+(-1.22986193243)*x[1]
        s[1,2]=(1.17229177208)*x[0]+(-1.005468476)*x[1]
        s[1,3]=(-1.27864883602)*x[0]+(0.27430357882)*x[1]
        s[1,4]=(-0.0170497525828)*x[0]+(-1.07936325294)*x[1]
        s[2,0]=(-0.172836979766)*x[0]+(0.481503531609)*x[1]
        s[2,1]=(0.240407365629)*x[0]+(-1.2996101353)*x[1]
        s[2,2]=(-1.35821876592)*x[0]+(1.06176151561)*x[1]
        s[2,3]=(-1.93289948536)*x[0]+(1.7647044408)*x[1]
        s[2,4]=(-1.16491431281)*x[0]+(0.483870146591)*x[1]
        s[3,0]=(0.646925654514)*x[0]+(-0.079632957461)*x[1]
        s[3,1]=(0.93955736882)*x[0]+(-0.314382763761)*x[1]
        s[3,2]=(0.903199444521)*x[0]+(-0.675377265588)*x[1]
        s[3,3]=(-0.373383381553)*x[0]+(0.140227745605)*x[1]
        s[3,4]=(0.199285967708)*x[0]+(0.440148792869)*x[1]
        ref[0,0,0]=(0.202521929549)
        ref[0,0,1]=(1.24388265835)
        ref[0,1,0]=(0.466921175909)
        ref[0,1,1]=(0.0938124013357)
        ref[0,2,0]=(-0.337565182967)
        ref[0,2,1]=(-0.66213972177)
        ref[0,3,0]=(-1.1265817109)
        ref[0,3,1]=(1.45099893506)
        ref[0,4,0]=(1.85945279233)
        ref[0,4,1]=(0.614232583853)
        ref[1,0,0]=(0.773998701601)
        ref[1,0,1]=(1.3572752273)
        ref[1,1,0]=(1.503889482)
        ref[1,1,1]=(-1.22986193243)
        ref[1,2,0]=(1.17229177208)
        ref[1,2,1]=(-1.005468476)
        ref[1,3,0]=(-1.27864883602)
        ref[1,3,1]=(0.27430357882)
        ref[1,4,0]=(-0.0170497525828)
        ref[1,4,1]=(-1.07936325294)
        ref[2,0,0]=(-0.172836979766)
        ref[2,0,1]=(0.481503531609)
        ref[2,1,0]=(0.240407365629)
        ref[2,1,1]=(-1.2996101353)
        ref[2,2,0]=(-1.35821876592)
        ref[2,2,1]=(1.06176151561)
        ref[2,3,0]=(-1.93289948536)
        ref[2,3,1]=(1.7647044408)
        ref[2,4,0]=(-1.16491431281)
        ref[2,4,1]=(0.483870146591)
        ref[3,0,0]=(0.646925654514)
        ref[3,0,1]=(-0.079632957461)
        ref[3,1,0]=(0.93955736882)
        ref[3,1,1]=(-0.314382763761)
        ref[3,2,0]=(0.903199444521)
        ref[3,2,1]=(-0.675377265588)
        ref[3,3,0]=(-0.373383381553)
        ref[3,3,1]=(0.140227745605)
        ref[3,4,0]=(0.199285967708)
        ref[3,4,1]=(0.440148792869)
      else:
        s[0,0]=(-0.454164125322)*x[0]+(-0.522669711039)*x[1]+(-1.69156961037)*x[2]
        s[0,1]=(1.02678975575)*x[0]+(-0.627069283778)*x[1]+(0.755190616163)*x[2]
        s[0,2]=(0.689068203494)*x[0]+(-0.677393706098)*x[1]+(-0.822365020628)*x[2]
        s[0,3]=(0.488491352905)*x[0]+(1.19039296387)*x[1]+(0.293029595575)*x[2]
        s[0,4]=(1.3254184285)*x[0]+(-0.67206171589)*x[1]+(1.95627951713)*x[2]
        s[1,0]=(-1.01024336678)*x[0]+(0.553509575201)*x[1]+(0.206480917751)*x[2]
        s[1,1]=(-0.679488104614)*x[0]+(0.561501215346)*x[1]+(-0.157738070792)*x[2]
        s[1,2]=(1.09058998896)*x[0]+(0.358786992535)*x[1]+(-0.866813461522)*x[2]
        s[1,3]=(0.945307210944)*x[0]+(-0.592121399828)*x[1]+(-1.23798843507)*x[2]
        s[1,4]=(-0.334377129623)*x[0]+(0.282409196274)*x[1]+(1.11154300742)*x[2]
        s[2,0]=(0.31913061339)*x[0]+(1.47252246089)*x[1]+(-0.0516509049482)*x[2]
        s[2,1]=(-0.889919147968)*x[0]+(0.750571626982)*x[1]+(1.44049343766)*x[2]
        s[2,2]=(-0.648407056167)*x[0]+(-0.961481146656)*x[1]+(0.747319150361)*x[2]
        s[2,3]=(1.49042928912)*x[0]+(1.31212422706)*x[1]+(0.510609313139)*x[2]
        s[2,4]=(-0.812306629075)*x[0]+(1.27041274415)*x[1]+(0.740119854826)*x[2]
        s[3,0]=(-1.11671812457)*x[0]+(0.382559318776)*x[1]+(-0.12879810898)*x[2]
        s[3,1]=(0.253402604664)*x[0]+(0.433299751265)*x[1]+(-0.282468707216)*x[2]
        s[3,2]=(1.32928877441)*x[0]+(-1.62629303652)*x[1]+(1.09372049629)*x[2]
        s[3,3]=(-1.20558999975)*x[0]+(-0.25798278657)*x[1]+(-0.0869196687657)*x[2]
        s[3,4]=(-1.31791924188)*x[0]+(0.0386230359027)*x[1]+(0.00644144564451)*x[2]
        ref[0,0,0]=(-0.454164125322)
        ref[0,0,1]=(-0.522669711039)
        ref[0,0,2]=(-1.69156961037)
        ref[0,1,0]=(1.02678975575)
        ref[0,1,1]=(-0.627069283778)
        ref[0,1,2]=(0.755190616163)
        ref[0,2,0]=(0.689068203494)
        ref[0,2,1]=(-0.677393706098)
        ref[0,2,2]=(-0.822365020628)
        ref[0,3,0]=(0.488491352905)
        ref[0,3,1]=(1.19039296387)
        ref[0,3,2]=(0.293029595575)
        ref[0,4,0]=(1.3254184285)
        ref[0,4,1]=(-0.67206171589)
        ref[0,4,2]=(1.95627951713)
        ref[1,0,0]=(-1.01024336678)
        ref[1,0,1]=(0.553509575201)
        ref[1,0,2]=(0.206480917751)
        ref[1,1,0]=(-0.679488104614)
        ref[1,1,1]=(0.561501215346)
        ref[1,1,2]=(-0.157738070792)
        ref[1,2,0]=(1.09058998896)
        ref[1,2,1]=(0.358786992535)
        ref[1,2,2]=(-0.866813461522)
        ref[1,3,0]=(0.945307210944)
        ref[1,3,1]=(-0.592121399828)
        ref[1,3,2]=(-1.23798843507)
        ref[1,4,0]=(-0.334377129623)
        ref[1,4,1]=(0.282409196274)
        ref[1,4,2]=(1.11154300742)
        ref[2,0,0]=(0.31913061339)
        ref[2,0,1]=(1.47252246089)
        ref[2,0,2]=(-0.0516509049482)
        ref[2,1,0]=(-0.889919147968)
        ref[2,1,1]=(0.750571626982)
        ref[2,1,2]=(1.44049343766)
        ref[2,2,0]=(-0.648407056167)
        ref[2,2,1]=(-0.961481146656)
        ref[2,2,2]=(0.747319150361)
        ref[2,3,0]=(1.49042928912)
        ref[2,3,1]=(1.31212422706)
        ref[2,3,2]=(0.510609313139)
        ref[2,4,0]=(-0.812306629075)
        ref[2,4,1]=(1.27041274415)
        ref[2,4,2]=(0.740119854826)
        ref[3,0,0]=(-1.11671812457)
        ref[3,0,1]=(0.382559318776)
        ref[3,0,2]=(-0.12879810898)
        ref[3,1,0]=(0.253402604664)
        ref[3,1,1]=(0.433299751265)
        ref[3,1,2]=(-0.282468707216)
        ref[3,2,0]=(1.32928877441)
        ref[3,2,1]=(-1.62629303652)
        ref[3,2,2]=(1.09372049629)
        ref[3,3,0]=(-1.20558999975)
        ref[3,3,1]=(-0.25798278657)
        ref[3,3,2]=(-0.0869196687657)
        ref[3,4,0]=(-1.31791924188)
        ref[3,4,1]=(0.0386230359027)
        ref[3,4,2]=(0.00644144564451)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(4, 5)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
   #+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   def test_grad_onFunctionOnContactOne_fromSymbol_ReducedSolution_rank3(self):
      """
      tests gradient for rank 3 Symbol on the FunctionOnContactOne

      assumptions: ReducedSolution(self.domain) exists
                   self.domain supports gardient on FunctionOnContactOne
      """
      o=1
      dim=self.domain.getDim()
      w_ref=FunctionOnContactOne(self.domain)
      x_ref=w_ref.getX()
      w=ReducedSolution(self.domain)
      x=w.getX()
      arg=Symbol(shape=(6, 2, 2),dim=dim)
      s=Data(0,(6, 2, 2),w)
      ref=Data(0,(6, 2, 2)+(dim,),w_ref)
      if dim==2:
        s[0,0,0]=(-0.500249599152)*x[0]+(1.67754131181)*x[1]
        s[0,0,1]=(1.1446224976)*x[0]+(0.293592946461)*x[1]
        s[0,1,0]=(0.662825578178)*x[0]+(0.778202393248)*x[1]
        s[0,1,1]=(1.120980772)*x[0]+(0.95813878487)*x[1]
        s[1,0,0]=(-0.462148842008)*x[0]+(-1.63817011088)*x[1]
        s[1,0,1]=(1.49522487924)*x[0]+(1.17105843575)*x[1]
        s[1,1,0]=(0.0273404170297)*x[0]+(-0.60627667625)*x[1]
        s[1,1,1]=(0.328333508501)*x[0]+(-0.487743429505)*x[1]
        s[2,0,0]=(0.690757853756)*x[0]+(0.415349096316)*x[1]
        s[2,0,1]=(-1.76899408416)*x[0]+(0.338928282096)*x[1]
        s[2,1,0]=(-1.65374086962)*x[0]+(0.666255100879)*x[1]
        s[2,1,1]=(0.845913196898)*x[0]+(0.524414663858)*x[1]
        s[3,0,0]=(-0.0489138005056)*x[0]+(-0.306296688032)*x[1]
        s[3,0,1]=(-0.619051141066)*x[0]+(0.399377559544)*x[1]
        s[3,1,0]=(0.407991784518)*x[0]+(-1.14997392594)*x[1]
        s[3,1,1]=(-0.115512243924)*x[0]+(0.296839190724)*x[1]
        s[4,0,0]=(1.45399807861)*x[0]+(-0.807761883642)*x[1]
        s[4,0,1]=(0.639797195198)*x[0]+(1.35664991322)*x[1]
        s[4,1,0]=(-0.884543551657)*x[0]+(0.702070741415)*x[1]
        s[4,1,1]=(-0.280174966716)*x[0]+(0.0172627474218)*x[1]
        s[5,0,0]=(0.235198909788)*x[0]+(0.0707623144647)*x[1]
        s[5,0,1]=(0.670946179418)*x[0]+(0.746509554365)*x[1]
        s[5,1,0]=(1.20081036792)*x[0]+(0.158928139216)*x[1]
        s[5,1,1]=(1.06402047834)*x[0]+(-0.567749347509)*x[1]
        ref[0,0,0,0]=(-0.500249599152)
        ref[0,0,0,1]=(1.67754131181)
        ref[0,0,1,0]=(1.1446224976)
        ref[0,0,1,1]=(0.293592946461)
        ref[0,1,0,0]=(0.662825578178)
        ref[0,1,0,1]=(0.778202393248)
        ref[0,1,1,0]=(1.120980772)
        ref[0,1,1,1]=(0.95813878487)
        ref[1,0,0,0]=(-0.462148842008)
        ref[1,0,0,1]=(-1.63817011088)
        ref[1,0,1,0]=(1.49522487924)
        ref[1,0,1,1]=(1.17105843575)
        ref[1,1,0,0]=(0.0273404170297)
        ref[1,1,0,1]=(-0.60627667625)
        ref[1,1,1,0]=(0.328333508501)
        ref[1,1,1,1]=(-0.487743429505)
        ref[2,0,0,0]=(0.690757853756)
        ref[2,0,0,1]=(0.415349096316)
        ref[2,0,1,0]=(-1.76899408416)
        ref[2,0,1,1]=(0.338928282096)
        ref[2,1,0,0]=(-1.65374086962)
        ref[2,1,0,1]=(0.666255100879)
        ref[2,1,1,0]=(0.845913196898)
        ref[2,1,1,1]=(0.524414663858)
        ref[3,0,0,0]=(-0.0489138005056)
        ref[3,0,0,1]=(-0.306296688032)
        ref[3,0,1,0]=(-0.619051141066)
        ref[3,0,1,1]=(0.399377559544)
        ref[3,1,0,0]=(0.407991784518)
        ref[3,1,0,1]=(-1.14997392594)
        ref[3,1,1,0]=(-0.115512243924)
        ref[3,1,1,1]=(0.296839190724)
        ref[4,0,0,0]=(1.45399807861)
        ref[4,0,0,1]=(-0.807761883642)
        ref[4,0,1,0]=(0.639797195198)
        ref[4,0,1,1]=(1.35664991322)
        ref[4,1,0,0]=(-0.884543551657)
        ref[4,1,0,1]=(0.702070741415)
        ref[4,1,1,0]=(-0.280174966716)
        ref[4,1,1,1]=(0.0172627474218)
        ref[5,0,0,0]=(0.235198909788)
        ref[5,0,0,1]=(0.0707623144647)
        ref[5,0,1,0]=(0.670946179418)
        ref[5,0,1,1]=(0.746509554365)
        ref[5,1,0,0]=(1.20081036792)
        ref[5,1,0,1]=(0.158928139216)
        ref[5,1,1,0]=(1.06402047834)
        ref[5,1,1,1]=(-0.567749347509)
      else:
        s[0,0,0]=(-0.709307825835)*x[0]+(-0.212632569057)*x[1]+(-1.36262175379)*x[2]
        s[0,0,1]=(1.26136861771)*x[0]+(-0.247247821335)*x[1]+(0.952472163507)*x[2]
        s[0,1,0]=(-0.313562941587)*x[0]+(0.335230615547)*x[1]+(0.633669942964)*x[2]
        s[0,1,1]=(0.543435495949)*x[0]+(-0.278928766765)*x[1]+(-0.560857410629)*x[2]
        s[1,0,0]=(-0.228999374753)*x[0]+(0.627231691819)*x[1]+(-0.110282807377)*x[2]
        s[1,0,1]=(-0.183700669251)*x[0]+(0.361641358769)*x[1]+(-0.565719344787)*x[2]
        s[1,1,0]=(0.0392225368869)*x[0]+(0.530481764326)*x[1]+(-1.16647413286)*x[2]
        s[1,1,1]=(1.10307486886)*x[0]+(1.62013473483)*x[1]+(1.08663406043)*x[2]
        s[2,0,0]=(0.418269374961)*x[0]+(-0.881366670214)*x[1]+(-0.19081724529)*x[2]
        s[2,0,1]=(-0.888542773287)*x[0]+(0.973322751168)*x[1]+(-0.678806455499)*x[2]
        s[2,1,0]=(0.203680986809)*x[0]+(-0.64202022526)*x[1]+(-0.342367020762)*x[2]
        s[2,1,1]=(-0.984982113825)*x[0]+(1.52327025412)*x[1]+(-1.16664161507)*x[2]
        s[3,0,0]=(-0.430857332595)*x[0]+(1.37801740474)*x[1]+(1.47536591267)*x[2]
        s[3,0,1]=(-1.49872232697)*x[0]+(0.679321175644)*x[1]+(0.233255377135)*x[2]
        s[3,1,0]=(0.00673347423284)*x[0]+(-0.659736891512)*x[1]+(-1.24483031223)*x[2]
        s[3,1,1]=(-1.35939956697)*x[0]+(-1.05370704987)*x[1]+(0.974871664002)*x[2]
        s[4,0,0]=(-1.56401623595)*x[0]+(0.0396404235057)*x[1]+(0.529626464189)*x[2]
        s[4,0,1]=(-0.903524096133)*x[0]+(-0.0504449605469)*x[1]+(-0.38093760213)*x[2]
        s[4,1,0]=(-0.570517363798)*x[0]+(1.50697108327)*x[1]+(0.45722182765)*x[2]
        s[4,1,1]=(0.855238285486)*x[0]+(-1.19608277327)*x[1]+(-0.454258653189)*x[2]
        s[5,0,0]=(0.264880357574)*x[0]+(-0.137240568006)*x[1]+(-1.43157116771)*x[2]
        s[5,0,1]=(1.42099564204)*x[0]+(-0.584391783811)*x[1]+(-0.194445105527)*x[2]
        s[5,1,0]=(-1.41719313241)*x[0]+(1.18436247042)*x[1]+(0.774373387123)*x[2]
        s[5,1,1]=(0.894745586845)*x[0]+(0.272141343375)*x[1]+(-0.563792436747)*x[2]
        ref[0,0,0,0]=(-0.709307825835)
        ref[0,0,0,1]=(-0.212632569057)
        ref[0,0,0,2]=(-1.36262175379)
        ref[0,0,1,0]=(1.26136861771)
        ref[0,0,1,1]=(-0.247247821335)
        ref[0,0,1,2]=(0.952472163507)
        ref[0,1,0,0]=(-0.313562941587)
        ref[0,1,0,1]=(0.335230615547)
        ref[0,1,0,2]=(0.633669942964)
        ref[0,1,1,0]=(0.543435495949)
        ref[0,1,1,1]=(-0.278928766765)
        ref[0,1,1,2]=(-0.560857410629)
        ref[1,0,0,0]=(-0.228999374753)
        ref[1,0,0,1]=(0.627231691819)
        ref[1,0,0,2]=(-0.110282807377)
        ref[1,0,1,0]=(-0.183700669251)
        ref[1,0,1,1]=(0.361641358769)
        ref[1,0,1,2]=(-0.565719344787)
        ref[1,1,0,0]=(0.0392225368869)
        ref[1,1,0,1]=(0.530481764326)
        ref[1,1,0,2]=(-1.16647413286)
        ref[1,1,1,0]=(1.10307486886)
        ref[1,1,1,1]=(1.62013473483)
        ref[1,1,1,2]=(1.08663406043)
        ref[2,0,0,0]=(0.418269374961)
        ref[2,0,0,1]=(-0.881366670214)
        ref[2,0,0,2]=(-0.19081724529)
        ref[2,0,1,0]=(-0.888542773287)
        ref[2,0,1,1]=(0.973322751168)
        ref[2,0,1,2]=(-0.678806455499)
        ref[2,1,0,0]=(0.203680986809)
        ref[2,1,0,1]=(-0.64202022526)
        ref[2,1,0,2]=(-0.342367020762)
        ref[2,1,1,0]=(-0.984982113825)
        ref[2,1,1,1]=(1.52327025412)
        ref[2,1,1,2]=(-1.16664161507)
        ref[3,0,0,0]=(-0.430857332595)
        ref[3,0,0,1]=(1.37801740474)
        ref[3,0,0,2]=(1.47536591267)
        ref[3,0,1,0]=(-1.49872232697)
        ref[3,0,1,1]=(0.679321175644)
        ref[3,0,1,2]=(0.233255377135)
        ref[3,1,0,0]=(0.00673347423284)
        ref[3,1,0,1]=(-0.659736891512)
        ref[3,1,0,2]=(-1.24483031223)
        ref[3,1,1,0]=(-1.35939956697)
        ref[3,1,1,1]=(-1.05370704987)
        ref[3,1,1,2]=(0.974871664002)
        ref[4,0,0,0]=(-1.56401623595)
        ref[4,0,0,1]=(0.0396404235057)
        ref[4,0,0,2]=(0.529626464189)
        ref[4,0,1,0]=(-0.903524096133)
        ref[4,0,1,1]=(-0.0504449605469)
        ref[4,0,1,2]=(-0.38093760213)
        ref[4,1,0,0]=(-0.570517363798)
        ref[4,1,0,1]=(1.50697108327)
        ref[4,1,0,2]=(0.45722182765)
        ref[4,1,1,0]=(0.855238285486)
        ref[4,1,1,1]=(-1.19608277327)
        ref[4,1,1,2]=(-0.454258653189)
        ref[5,0,0,0]=(0.264880357574)
        ref[5,0,0,1]=(-0.137240568006)
        ref[5,0,0,2]=(-1.43157116771)
        ref[5,0,1,0]=(1.42099564204)
        ref[5,0,1,1]=(-0.584391783811)
        ref[5,0,1,2]=(-0.194445105527)
        ref[5,1,0,0]=(-1.41719313241)
        ref[5,1,0,1]=(1.18436247042)
        ref[5,1,0,2]=(0.774373387123)
        ref[5,1,1,0]=(0.894745586845)
        ref[5,1,1,1]=(0.272141343375)
        ref[5,1,1,2]=(-0.563792436747)
      res=grad(arg,where=w_ref)
      sub=res.substitute({arg:s})
      self.failUnless(isinstance(res,Symbol),"wrong type of result.")
      self.failUnlessEqual(res.getShape(),(6, 2, 2)+(dim,),"wrong shape of result.")
      self.failUnless(Lsup(sub-ref)<=self.RES_TOL*Lsup(ref),"wrong result")
