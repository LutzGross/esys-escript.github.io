# Scons configuration file for finley

#
# set appropriate defaults for configuration variables
esysroot=str(Dir('./..').abspath)
execfile(str(File(esysroot+"/scons/esys_options.py")))

solver_libs=mkl_libs+scsl_libs+umfpack_libs
solver_lib_paths=[mkl_lib_path,scsl_lib_path,umfpack_lib_path]

Export(["python_path"])
Export(["boost_path"])
Export(["papi_path"])
Export(["cxx"])
Export(["cc"])
Export(["cxx_flags"])
Export(["cc_flags"])
Export(["boost_lib_path"])
Export(["boost_lib"])
Export(["sys_libs"])
Export(["solver_libs"])
Export(["solver_lib_paths"])
Export(["papi_libs"])
Export(["papi_lib_path"])
Export(["libinstall"])
Export(["pyinstall"])
Export(["incinstall"])

#
# set and export library directories

libdir = Dir(str(esysroot) + '/finley/lib')
Export(["libdir"])
libdir2 = Dir(str(esysroot) + '/lib')
Export(["libdir2"])

#
# set and export python directories

pydir = Dir(str(esysroot) + '/finley/lib/py_src')
Export(["pydir"])
pydir2 = Dir(str(esysroot) + '/esys/finley')
Export(["pydir2"])
if pyinstall != None:
  pyinstall = Dir(str(pyinstall) + '/finley')
  Export(["pyinstall"])

#
# set and export include directories

incdir = Dir(str(esysroot) + '/finley/inc')
Export(["incdir"])
incdir2 = Dir(str(esysroot) + '/inc')
Export(["incdir2"])
if incinstall != None:
  Export(["incinstall"])

#
# print out build configuration for this module

print "Build configuration for module: finley"
print "              cc: ", cc
print "        cc_flags: ", cc_flags
print "             cxx: ", cxx
print "       cxx_flags: ", cxx_flags

#
# call the SConscript to do the actual build

SConscript(dirs=['src'], build_dir='obj', duplicate=0)
SConscript(dirs=['py_src'], build_dir='obj/py_src', duplicate=0)
print solver_libs
SConscript(dirs=['test/MeshAdapter'], build_dir='obj/test/MeshAdapter', duplicate=0)
